# v0.3.1a Design Specification: Reward System

## Overview

**Version:** 0.3.1a
**Parent:** v0.3.1 (Quest Rewards & NPCs)
**Prerequisites:** v0.3.0 Complete (Quest Foundation)
**Status:** Design Complete
**Estimated Unit Tests:** ~25

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [User Stories](#4-user-stories)
5. [Data Models](#5-data-models)
6. [Configuration Schemas](#6-configuration-schemas)
7. [Service Specifications](#7-service-specifications)
8. [User-Facing Changes](#8-user-facing-changes)
9. [Logging Requirements](#9-logging-requirements)
10. [Unit Test Specifications](#10-unit-test-specifications)
11. [Use Cases](#11-use-cases)
12. [Acceptance Criteria](#12-acceptance-criteria)
13. [Deliverable Checklist](#13-deliverable-checklist)
14. [Dependencies](#14-dependencies)
15. [Future Considerations](#15-future-considerations)

---

## 1. Executive Summary

This phase establishes the quest reward data model that enables quests to grant meaningful rewards upon completion. The QuestReward and RewardEntry value objects form the core of the reward system, with RewardType providing categorization for XP, gold, items, and reputation rewards. Rewards are configured in quest definitions and displayed in the quest journal.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Value Objects** | QuestReward, RewardEntry |
| **Enums** | RewardType |
| **Definition Updates** | QuestDefinition with Rewards property |
| **DTO Updates** | QuestDetailDto with reward display |
| **Configuration** | quests.json reward entries |
| **Tests** | ~25 new unit tests |

### Architectural Significance

This version establishes the **reward definition pattern** that will be extended throughout future versions:
- Rewards as value objects attached to quest definitions
- Multiple reward types within a single quest
- Choice rewards allowing player selection
- Foundation for reward distribution (v0.3.1c), NPC rewards (v0.3.1b), and quest chains (v0.3.2)

---

## 2. Feature Overview

```
v0.3.1a Features
├── QuestReward Value Object
│   ├── Entries collection (IReadOnlyList<RewardEntry>)
│   ├── TotalXP calculated property
│   ├── TotalGold calculated property
│   ├── ItemRewards filtered collection
│   ├── ReputationRewards filtered collection
│   ├── HasRewards boolean property
│   └── GetDisplayString() formatting method
├── RewardEntry Value Object
│   ├── Type (RewardType enum)
│   ├── Amount (int for XP, gold, quantity)
│   ├── TargetId (item ID, faction ID)
│   ├── DisplayName (optional override)
│   ├── IsChoice (player picks one)
│   └── ChoiceGroup (groups choice rewards)
├── RewardType Enum
│   ├── XP (experience points)
│   ├── Gold (currency)
│   ├── Item (item rewards)
│   ├── Reputation (faction standing)
│   └── Unlock (future use)
├── QuestDefinition Updates
│   ├── Rewards property (QuestReward)
│   └── BonusRewards property (optional objectives)
└── Quest Journal Updates
    └── Reward display in quest detail view
```

---

## 3. Architecture Diagrams

### 3.1 Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         PRESENTATION LAYER                              │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                    IGameRenderer (updated)                       │   │
│  ├─────────────────────────────────────────────────────────────────┤   │
│  │ RenderQuestDetailAsync(QuestDetailDto)  // shows rewards        │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                         APPLICATION LAYER                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                    QuestDetailDto (updated)                      │   │
│  ├─────────────────────────────────────────────────────────────────┤   │
│  │ + Rewards: RewardDisplayDto                          // NEW     │   │
│  │ + BonusRewards: RewardDisplayDto?                    // NEW     │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                    RewardDisplayDto (new)                        │   │
│  ├─────────────────────────────────────────────────────────────────┤   │
│  │ + XP: int                                                        │   │
│  │ + Gold: int                                                      │   │
│  │ + Items: IReadOnlyList<ItemRewardDto>                           │   │
│  │ + ReputationChanges: IReadOnlyList<ReputationRewardDto>         │   │
│  │ + ChoiceGroups: IReadOnlyList<RewardChoiceGroupDto>             │   │
│  │ + DisplayString: string                                          │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           DOMAIN LAYER                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  VALUE OBJECTS                                                          │
│  ┌────────────────────────┐  ┌────────────────────────┐                │
│  │      QuestReward       │  │     RewardEntry        │                │
│  ├────────────────────────┤  ├────────────────────────┤                │
│  │ + Entries: List        │  │ + Type: RewardType     │                │
│  │ + TotalXP: int         │  │ + Amount: int          │                │
│  │ + TotalGold: int       │  │ + TargetId: string     │                │
│  │ + ItemRewards: IEnum   │  │ + DisplayName: string? │                │
│  │ + ReputationRewards    │  │ + IsChoice: bool       │                │
│  │ + HasRewards: bool     │  │ + ChoiceGroup: string? │                │
│  │ + GetDisplayString()   │  ├────────────────────────┤                │
│  ├────────────────────────┤  │ + XP(amount): static   │                │
│  │ + Empty: static        │  │ + Gold(amount): static │                │
│  │ + Create(entries)      │  │ + Item(...): static    │                │
│  │ + Simple(xp, gold)     │  │ + Reputation(...): stat│                │
│  │ + WithEntry(entry)     │  │ + ChoiceItem(...): stat│                │
│  └────────────────────────┘  └────────────────────────┘                │
│                                                                         │
│  ENUMS                                                                  │
│  ┌────────────────────────┐                                            │
│  │      RewardType        │                                            │
│  ├────────────────────────┤                                            │
│  │ XP                     │                                            │
│  │ Gold                   │                                            │
│  │ Item                   │                                            │
│  │ Reputation             │                                            │
│  │ Unlock                 │                                            │
│  └────────────────────────┘                                            │
│                                                                         │
│  DEFINITION UPDATES                                                     │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                    QuestDefinition (updated)                     │   │
│  ├─────────────────────────────────────────────────────────────────┤   │
│  │ + Rewards: QuestReward                               // NEW     │   │
│  │ + BonusRewards: QuestReward?                         // NEW     │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                        INFRASTRUCTURE LAYER                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Configuration Files:                                                   │
│  └── config/quests.json (updated with rewards)                         │
│                                                                         │
│  DTOs for Deserialization:                                              │
│  ├── RewardConfigDto                                                   │
│  └── RewardEntryDto                                                    │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.2 Reward Composition

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        QUEST REWARD COMPOSITION                         │
└─────────────────────────────────────────────────────────────────────────┘

    ┌───────────────────────────────────────────────────────────────┐
    │                       QuestReward                              │
    │                   (value object)                               │
    ├───────────────────────────────────────────────────────────────┤
    │                                                               │
    │  Entries Collection:                                          │
    │  ┌─────────────────────────────────────────────────────────┐  │
    │  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │  │
    │  │  │ RewardEntry │ │ RewardEntry │ │ RewardEntry │  ...   │  │
    │  │  │  Type: XP   │ │ Type: Gold  │ │ Type: Item  │        │  │
    │  │  │ Amount: 50  │ │ Amount: 25  │ │ TargetId:   │        │  │
    │  │  │             │ │             │ │ "iron-sword"│        │  │
    │  │  └─────────────┘ └─────────────┘ └─────────────┘        │  │
    │  └─────────────────────────────────────────────────────────┘  │
    │                                                               │
    │  Calculated Properties:                                       │
    │  ├── TotalXP: 50                                             │
    │  ├── TotalGold: 25                                           │
    │  ├── ItemRewards: [iron-sword]                               │
    │  └── ReputationRewards: []                                   │
    │                                                               │
    │  Display: "50 XP, 25 gold, Iron Sword"                       │
    │                                                               │
    └───────────────────────────────────────────────────────────────┘
```

### 3.3 Choice Reward Flow

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         CHOICE REWARD PATTERN                           │
└─────────────────────────────────────────────────────────────────────────┘

    Quest: "A Dangerous Errand"

    Rewards:
    ┌─────────────────────────────────────────────────────────────────┐
    │  Standard Rewards (always granted):                              │
    │  ├── RewardEntry { Type: XP, Amount: 100 }                      │
    │  └── RewardEntry { Type: Gold, Amount: 30 }                     │
    │                                                                  │
    │  Choice Rewards (player picks ONE from group "weapon"):          │
    │  ├── RewardEntry { Type: Item, TargetId: "iron-sword",          │
    │  │                 IsChoice: true, ChoiceGroup: "weapon" }      │
    │  ├── RewardEntry { Type: Item, TargetId: "iron-axe",            │
    │  │                 IsChoice: true, ChoiceGroup: "weapon" }      │
    │  └── RewardEntry { Type: Item, TargetId: "iron-mace",           │
    │                    IsChoice: true, ChoiceGroup: "weapon" }      │
    └─────────────────────────────────────────────────────────────────┘

    Display in Journal:
    ┌─────────────────────────────────────────────────────────────────┐
    │  REWARDS                                                        │
    │  • 100 XP                                                       │
    │  • 30 gold                                                      │
    │  • Choice of: Iron Sword, Iron Axe, or Iron Mace               │
    └─────────────────────────────────────────────────────────────────┘
```

### 3.4 Reward in Quest Definition

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    QUEST DEFINITION WITH REWARDS                        │
└─────────────────────────────────────────────────────────────────────────┘

    ┌───────────────────────────────────────────────────────────────┐
    │                    QuestDefinition                             │
    ├───────────────────────────────────────────────────────────────┤
    │  Id: "goblin-menace"                                          │
    │  Name: "The Goblin Menace"                                    │
    │  Description: "Clear the dungeon entrance..."                 │
    │                                                               │
    │  Objectives:                                                  │
    │  ├── ObjectiveDefinition (Kill 5 Goblins)                    │
    │  └── ObjectiveDefinition (optional: Kill Goblin Chief)       │
    │                                                               │
    │  Rewards: QuestReward                        ◄── NEW          │
    │  ├── 50 XP                                                   │
    │  ├── 25 Gold                                                 │
    │  └── +100 City Guard Reputation                              │
    │                                                               │
    │  BonusRewards: QuestReward?                  ◄── NEW          │
    │  └── +50 XP (for optional objective)                         │
    │                                                               │
    └───────────────────────────────────────────────────────────────┘
```

---

## 4. User Stories

### US-3.1a-1: Define Quest Rewards
**As a** game designer
**I want to** configure rewards in quest definitions
**So that** quests grant meaningful compensation on completion

**Acceptance Criteria:**
- Rewards can include XP, gold, items, and reputation
- Multiple reward entries can be combined
- Rewards are defined in quests.json configuration
- Invalid reward configurations produce clear errors

### US-3.1a-2: View Quest Rewards
**As a** player
**I want to** see what rewards a quest will grant
**So that** I can decide which quests to prioritize

**Acceptance Criteria:**
- Quest journal displays rewards in quest detail view
- XP and gold totals are clearly shown
- Item rewards show item names
- Reputation rewards show faction and amount

### US-3.1a-3: Configure Choice Rewards
**As a** game designer
**I want to** offer reward choices
**So that** players can select rewards matching their playstyle

**Acceptance Criteria:**
- Choice rewards are grouped by choiceGroup
- Player must pick one from each group
- Journal shows "Choice of: X, Y, or Z" format
- Non-choice rewards are granted automatically

### US-3.1a-4: Track Bonus Rewards
**As a** game designer
**I want to** define bonus rewards for optional objectives
**So that** players are rewarded for extra effort

**Acceptance Criteria:**
- BonusRewards property on QuestDefinition
- Bonus rewards display separately in journal
- Bonus rewards only granted when optional objectives complete

### US-3.1a-5: Calculate Reward Totals
**As a** game system
**I want to** calculate total XP and gold
**So that** rewards can be displayed and granted efficiently

**Acceptance Criteria:**
- TotalXP sums all XP reward entries
- TotalGold sums all gold reward entries
- ItemRewards returns filtered collection
- ReputationRewards returns filtered collection

---

## 5. Data Models

### 5.1 QuestReward Value Object

```csharp
namespace RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Represents rewards granted upon quest completion.
/// </summary>
/// <remarks>
/// QuestReward is a value object that aggregates multiple RewardEntry
/// instances into a single reward bundle. It provides calculated properties
/// for totals and filtering by reward type.
/// </remarks>
public class QuestReward
{
    /// <summary>
    /// Gets the individual reward entries.
    /// </summary>
    /// <remarks>
    /// Entries are stored in the order they were added.
    /// </remarks>
    public IReadOnlyList<RewardEntry> Entries { get; private set; } = Array.Empty<RewardEntry>();

    /// <summary>
    /// Gets the total XP reward.
    /// </summary>
    /// <remarks>
    /// Sums all entries where Type is RewardType.XP.
    /// </remarks>
    public int TotalXP => Entries
        .Where(e => e.Type == RewardType.XP)
        .Sum(e => e.Amount);

    /// <summary>
    /// Gets the total gold reward.
    /// </summary>
    /// <remarks>
    /// Sums all entries where Type is RewardType.Gold.
    /// </remarks>
    public int TotalGold => Entries
        .Where(e => e.Type == RewardType.Gold)
        .Sum(e => e.Amount);

    /// <summary>
    /// Gets item reward entries.
    /// </summary>
    /// <remarks>
    /// Returns all entries where Type is RewardType.Item.
    /// </remarks>
    public IEnumerable<RewardEntry> ItemRewards => Entries
        .Where(e => e.Type == RewardType.Item);

    /// <summary>
    /// Gets reputation reward entries.
    /// </summary>
    /// <remarks>
    /// Returns all entries where Type is RewardType.Reputation.
    /// Reputation can be positive or negative.
    /// </remarks>
    public IEnumerable<RewardEntry> ReputationRewards => Entries
        .Where(e => e.Type == RewardType.Reputation);

    /// <summary>
    /// Gets choice reward entries.
    /// </summary>
    /// <remarks>
    /// Returns all entries where IsChoice is true.
    /// </remarks>
    public IEnumerable<RewardEntry> ChoiceRewards => Entries
        .Where(e => e.IsChoice);

    /// <summary>
    /// Gets non-choice (guaranteed) reward entries.
    /// </summary>
    /// <remarks>
    /// Returns all entries where IsChoice is false.
    /// </remarks>
    public IEnumerable<RewardEntry> GuaranteedRewards => Entries
        .Where(e => !e.IsChoice);

    /// <summary>
    /// Gets whether there are any rewards.
    /// </summary>
    public bool HasRewards => Entries.Count > 0;

    /// <summary>
    /// Gets whether there are any choice rewards.
    /// </summary>
    public bool HasChoices => Entries.Any(e => e.IsChoice);

    /// <summary>
    /// Gets the distinct choice group IDs.
    /// </summary>
    public IEnumerable<string> ChoiceGroups => Entries
        .Where(e => e.IsChoice && !string.IsNullOrEmpty(e.ChoiceGroup))
        .Select(e => e.ChoiceGroup!)
        .Distinct();

    /// <summary>
    /// Private constructor for factory methods.
    /// </summary>
    private QuestReward() { }

    /// <summary>
    /// Gets an empty reward with no entries.
    /// </summary>
    public static QuestReward Empty => new() { Entries = Array.Empty<RewardEntry>() };

    /// <summary>
    /// Creates a quest reward from a collection of entries.
    /// </summary>
    /// <param name="entries">The reward entries.</param>
    /// <returns>A new QuestReward instance.</returns>
    /// <exception cref="ArgumentNullException">Thrown if entries is null.</exception>
    public static QuestReward Create(IEnumerable<RewardEntry> entries)
    {
        ArgumentNullException.ThrowIfNull(entries);

        return new QuestReward
        {
            Entries = entries.ToList()
        };
    }

    /// <summary>
    /// Creates a simple XP and gold reward.
    /// </summary>
    /// <param name="xp">XP amount (ignored if 0 or negative).</param>
    /// <param name="gold">Gold amount (ignored if 0 or negative).</param>
    /// <returns>A new QuestReward with XP and/or gold entries.</returns>
    public static QuestReward Simple(int xp, int gold)
    {
        var entries = new List<RewardEntry>();

        if (xp > 0)
            entries.Add(RewardEntry.XP(xp));
        if (gold > 0)
            entries.Add(RewardEntry.Gold(gold));

        return new QuestReward { Entries = entries };
    }

    /// <summary>
    /// Creates a new reward with an additional entry.
    /// </summary>
    /// <param name="entry">The entry to add.</param>
    /// <returns>A new QuestReward with the entry appended.</returns>
    /// <remarks>
    /// QuestReward is immutable; this returns a new instance.
    /// </remarks>
    public QuestReward WithEntry(RewardEntry entry)
    {
        var entries = Entries.ToList();
        entries.Add(entry);
        return new QuestReward { Entries = entries };
    }

    /// <summary>
    /// Gets choices for a specific group.
    /// </summary>
    /// <param name="groupId">The choice group ID.</param>
    /// <returns>Entries in the specified choice group.</returns>
    public IEnumerable<RewardEntry> GetChoicesForGroup(string groupId)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(groupId);

        return Entries.Where(e =>
            e.IsChoice &&
            e.ChoiceGroup?.Equals(groupId, StringComparison.OrdinalIgnoreCase) == true);
    }

    /// <summary>
    /// Gets a formatted display string for the rewards.
    /// </summary>
    /// <returns>A comma-separated string of reward descriptions.</returns>
    /// <remarks>
    /// Choice rewards are grouped as "Choice of: X, Y, or Z".
    /// </remarks>
    public string GetDisplayString()
    {
        var parts = new List<string>();

        // Add XP total
        if (TotalXP > 0)
            parts.Add($"{TotalXP} XP");

        // Add gold total
        if (TotalGold > 0)
            parts.Add($"{TotalGold} gold");

        // Add guaranteed item rewards
        foreach (var item in ItemRewards.Where(i => !i.IsChoice))
        {
            var name = item.DisplayName ?? item.TargetId;
            if (item.Amount > 1)
                parts.Add($"{item.Amount}x {name}");
            else
                parts.Add(name);
        }

        // Add reputation rewards
        foreach (var rep in ReputationRewards)
        {
            var sign = rep.Amount >= 0 ? "+" : "";
            var name = rep.DisplayName ?? rep.TargetId;
            parts.Add($"{sign}{rep.Amount} {name} reputation");
        }

        // Add choice groups
        foreach (var groupId in ChoiceGroups)
        {
            var choices = GetChoicesForGroup(groupId)
                .Select(c => c.DisplayName ?? c.TargetId)
                .ToList();

            if (choices.Count > 0)
            {
                var choiceStr = choices.Count == 2
                    ? $"{choices[0]} or {choices[1]}"
                    : string.Join(", ", choices.Take(choices.Count - 1)) + $", or {choices.Last()}";
                parts.Add($"Choice of: {choiceStr}");
            }
        }

        return parts.Count > 0 ? string.Join(", ", parts) : "None";
    }

    /// <summary>
    /// Gets a multi-line display string for detailed views.
    /// </summary>
    /// <returns>A bulleted list of reward descriptions.</returns>
    public string GetDetailedDisplayString()
    {
        var lines = new List<string>();

        if (TotalXP > 0)
            lines.Add($"  \u2022 {TotalXP} XP");

        if (TotalGold > 0)
            lines.Add($"  \u2022 {TotalGold} gold");

        foreach (var item in ItemRewards.Where(i => !i.IsChoice))
        {
            var name = item.DisplayName ?? item.TargetId;
            if (item.Amount > 1)
                lines.Add($"  \u2022 {item.Amount}x {name}");
            else
                lines.Add($"  \u2022 {name}");
        }

        foreach (var rep in ReputationRewards)
        {
            var sign = rep.Amount >= 0 ? "+" : "";
            var name = rep.DisplayName ?? rep.TargetId;
            lines.Add($"  \u2022 {sign}{rep.Amount} {name} reputation");
        }

        foreach (var groupId in ChoiceGroups)
        {
            var choices = GetChoicesForGroup(groupId)
                .Select(c => c.DisplayName ?? c.TargetId)
                .ToList();

            if (choices.Count > 0)
            {
                var choiceStr = string.Join(", ", choices);
                lines.Add($"  \u2022 Choice of: {choiceStr}");
            }
        }

        return lines.Count > 0 ? string.Join("\n", lines) : "  \u2022 None";
    }
}
```

### 5.2 RewardEntry Value Object

```csharp
namespace RuneAndRust.Domain.ValueObjects;

/// <summary>
/// A single reward entry within a quest reward.
/// </summary>
/// <remarks>
/// RewardEntry is a readonly record struct representing one component of a
/// quest reward. Entries can be XP, gold, items, or reputation changes.
/// Choice entries allow the player to pick one from a group.
/// </remarks>
public readonly record struct RewardEntry
{
    /// <summary>
    /// Gets the reward type.
    /// </summary>
    public RewardType Type { get; init; }

    /// <summary>
    /// Gets the amount for this reward.
    /// </summary>
    /// <remarks>
    /// For XP and Gold: the amount granted.
    /// For Items: the quantity.
    /// For Reputation: the change amount (can be negative).
    /// </remarks>
    public int Amount { get; init; }

    /// <summary>
    /// Gets the target ID for this reward.
    /// </summary>
    /// <remarks>
    /// For Items: the item definition ID.
    /// For Reputation: the faction ID.
    /// Empty for XP and Gold.
    /// </remarks>
    public string TargetId { get; init; }

    /// <summary>
    /// Gets the display name override.
    /// </summary>
    /// <remarks>
    /// When set, used instead of looking up the name from definitions.
    /// Useful for configuration-time localization.
    /// </remarks>
    public string? DisplayName { get; init; }

    /// <summary>
    /// Gets whether this is a choice reward.
    /// </summary>
    /// <remarks>
    /// When true, player must choose one entry from the ChoiceGroup.
    /// When false, reward is granted automatically.
    /// </remarks>
    public bool IsChoice { get; init; }

    /// <summary>
    /// Gets the choice group ID.
    /// </summary>
    /// <remarks>
    /// All entries with the same ChoiceGroup form a selection set.
    /// Player picks one entry from each group.
    /// </remarks>
    public string? ChoiceGroup { get; init; }

    /// <summary>
    /// Creates an XP reward entry.
    /// </summary>
    /// <param name="amount">The XP amount to grant.</param>
    /// <returns>A new RewardEntry for XP.</returns>
    /// <exception cref="ArgumentOutOfRangeException">Thrown if amount is not positive.</exception>
    public static RewardEntry XP(int amount)
    {
        ArgumentOutOfRangeException.ThrowIfNegativeOrZero(amount);

        return new RewardEntry
        {
            Type = RewardType.XP,
            Amount = amount,
            TargetId = string.Empty
        };
    }

    /// <summary>
    /// Creates a gold reward entry.
    /// </summary>
    /// <param name="amount">The gold amount to grant.</param>
    /// <returns>A new RewardEntry for gold.</returns>
    /// <exception cref="ArgumentOutOfRangeException">Thrown if amount is not positive.</exception>
    public static RewardEntry Gold(int amount)
    {
        ArgumentOutOfRangeException.ThrowIfNegativeOrZero(amount);

        return new RewardEntry
        {
            Type = RewardType.Gold,
            Amount = amount,
            TargetId = string.Empty
        };
    }

    /// <summary>
    /// Creates an item reward entry.
    /// </summary>
    /// <param name="itemId">The item definition ID.</param>
    /// <param name="quantity">The quantity to grant (default 1).</param>
    /// <param name="displayName">Optional display name override.</param>
    /// <returns>A new RewardEntry for an item.</returns>
    /// <exception cref="ArgumentException">Thrown if itemId is null or empty.</exception>
    /// <exception cref="ArgumentOutOfRangeException">Thrown if quantity is not positive.</exception>
    public static RewardEntry Item(string itemId, int quantity = 1, string? displayName = null)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(itemId);
        ArgumentOutOfRangeException.ThrowIfNegativeOrZero(quantity);

        return new RewardEntry
        {
            Type = RewardType.Item,
            Amount = quantity,
            TargetId = itemId.ToLowerInvariant(),
            DisplayName = displayName
        };
    }

    /// <summary>
    /// Creates a reputation reward entry.
    /// </summary>
    /// <param name="factionId">The faction ID.</param>
    /// <param name="amount">The reputation change (can be negative).</param>
    /// <param name="displayName">Optional faction display name override.</param>
    /// <returns>A new RewardEntry for reputation.</returns>
    /// <exception cref="ArgumentException">Thrown if factionId is null or empty.</exception>
    public static RewardEntry Reputation(string factionId, int amount, string? displayName = null)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(factionId);

        return new RewardEntry
        {
            Type = RewardType.Reputation,
            Amount = amount,
            TargetId = factionId.ToLowerInvariant(),
            DisplayName = displayName
        };
    }

    /// <summary>
    /// Creates a choice item reward entry.
    /// </summary>
    /// <param name="itemId">The item definition ID.</param>
    /// <param name="choiceGroup">The choice group ID.</param>
    /// <param name="displayName">Optional display name override.</param>
    /// <returns>A new RewardEntry for a choice item.</returns>
    /// <exception cref="ArgumentException">Thrown if itemId or choiceGroup is null or empty.</exception>
    public static RewardEntry ChoiceItem(string itemId, string choiceGroup, string? displayName = null)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(itemId);
        ArgumentException.ThrowIfNullOrWhiteSpace(choiceGroup);

        return new RewardEntry
        {
            Type = RewardType.Item,
            Amount = 1,
            TargetId = itemId.ToLowerInvariant(),
            DisplayName = displayName,
            IsChoice = true,
            ChoiceGroup = choiceGroup.ToLowerInvariant()
        };
    }

    /// <summary>
    /// Creates an unlock reward entry.
    /// </summary>
    /// <param name="unlockId">The ID of what to unlock.</param>
    /// <param name="displayName">Display name for the unlock.</param>
    /// <returns>A new RewardEntry for an unlock.</returns>
    /// <exception cref="ArgumentException">Thrown if unlockId is null or empty.</exception>
    public static RewardEntry Unlock(string unlockId, string? displayName = null)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(unlockId);

        return new RewardEntry
        {
            Type = RewardType.Unlock,
            Amount = 1,
            TargetId = unlockId.ToLowerInvariant(),
            DisplayName = displayName
        };
    }

    /// <summary>
    /// Gets a display string for this entry.
    /// </summary>
    /// <returns>A formatted string describing this reward.</returns>
    public string ToDisplayString()
    {
        return Type switch
        {
            RewardType.XP => $"{Amount} XP",
            RewardType.Gold => $"{Amount} gold",
            RewardType.Item => Amount > 1
                ? $"{Amount}x {DisplayName ?? TargetId}"
                : DisplayName ?? TargetId,
            RewardType.Reputation => $"{(Amount >= 0 ? "+" : "")}{Amount} {DisplayName ?? TargetId} reputation",
            RewardType.Unlock => DisplayName ?? TargetId,
            _ => $"{Amount} {TargetId}"
        };
    }
}
```

### 5.3 RewardType Enum

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Types of quest rewards.
/// </summary>
/// <remarks>
/// Reward types determine how the reward is processed when distributed
/// to the player and how it is displayed in the quest journal.
/// </remarks>
public enum RewardType
{
    /// <summary>
    /// Experience points granted to the player.
    /// </summary>
    /// <remarks>
    /// Processed via ExperienceService to potentially trigger level-ups.
    /// </remarks>
    XP,

    /// <summary>
    /// Gold currency granted to the player.
    /// </summary>
    /// <remarks>
    /// Added directly to Player.Gold.
    /// </remarks>
    Gold,

    /// <summary>
    /// An item or items granted to the player.
    /// </summary>
    /// <remarks>
    /// Created from item definitions and added to player inventory.
    /// Amount specifies quantity.
    /// </remarks>
    Item,

    /// <summary>
    /// Faction reputation change.
    /// </summary>
    /// <remarks>
    /// Modifies player's standing with a faction.
    /// Amount can be positive or negative.
    /// </remarks>
    Reputation,

    /// <summary>
    /// Unlocks something for the player.
    /// </summary>
    /// <remarks>
    /// Future use for unlocking abilities, areas, features, etc.
    /// TargetId specifies what is unlocked.
    /// </remarks>
    Unlock
}
```

### 5.4 QuestDefinition Updates

```csharp
// Additions to existing QuestDefinition class in RuneAndRust.Domain.Definitions

/// <summary>
/// Gets the rewards granted upon quest completion.
/// </summary>
/// <remarks>
/// Contains XP, gold, items, and reputation rewards.
/// May be empty for quests with no material rewards.
/// </remarks>
public QuestReward Rewards { get; private set; } = QuestReward.Empty;

/// <summary>
/// Gets bonus rewards for completing optional objectives.
/// </summary>
/// <remarks>
/// Only granted when all optional objectives are complete.
/// Null if no bonus rewards are defined.
/// </remarks>
public QuestReward? BonusRewards { get; private set; }

// Update the Create method signature:
public static QuestDefinition Create(
    string id,
    string name,
    string description,
    IEnumerable<ObjectiveDefinition> objectives,
    string? giverNpcId = null,
    string? turnInNpcId = null,
    string? hint = null,
    bool autoActivate = true,
    QuestReward? rewards = null,        // NEW
    QuestReward? bonusRewards = null)   // NEW
{
    ArgumentException.ThrowIfNullOrWhiteSpace(id);
    ArgumentException.ThrowIfNullOrWhiteSpace(name);
    ArgumentException.ThrowIfNullOrWhiteSpace(description);
    ArgumentNullException.ThrowIfNull(objectives);

    var definition = new QuestDefinition
    {
        Id = id.ToLowerInvariant(),
        Name = name,
        Description = description,
        GiverNpcId = giverNpcId?.ToLowerInvariant(),
        TurnInNpcId = turnInNpcId?.ToLowerInvariant(),
        Hint = hint,
        AutoActivate = autoActivate,
        Rewards = rewards ?? QuestReward.Empty,     // NEW
        BonusRewards = bonusRewards                  // NEW
    };

    definition._objectives.AddRange(objectives);

    return definition;
}

/// <summary>
/// Gets whether this quest has any rewards.
/// </summary>
public bool HasRewards => Rewards.HasRewards;

/// <summary>
/// Gets whether this quest has bonus rewards.
/// </summary>
public bool HasBonusRewards => BonusRewards?.HasRewards == true;

/// <summary>
/// Gets the total XP reward including bonus if applicable.
/// </summary>
/// <param name="includeBonus">Whether to include bonus rewards.</param>
/// <returns>Total XP from rewards.</returns>
public int GetTotalXP(bool includeBonus = false)
{
    var total = Rewards.TotalXP;
    if (includeBonus && BonusRewards != null)
        total += BonusRewards.TotalXP;
    return total;
}

/// <summary>
/// Gets the total gold reward including bonus if applicable.
/// </summary>
/// <param name="includeBonus">Whether to include bonus rewards.</param>
/// <returns>Total gold from rewards.</returns>
public int GetTotalGold(bool includeBonus = false)
{
    var total = Rewards.TotalGold;
    if (includeBonus && BonusRewards != null)
        total += BonusRewards.TotalGold;
    return total;
}
```

### 5.5 Quest Entity Updates

```csharp
// Additions to existing Quest class in RuneAndRust.Domain.Entities

/// <summary>
/// Gets the rewards for this quest.
/// </summary>
/// <remarks>
/// Copied from the QuestDefinition when the quest is created.
/// </remarks>
public QuestReward Rewards { get; private set; } = QuestReward.Empty;

/// <summary>
/// Gets the bonus rewards for this quest.
/// </summary>
/// <remarks>
/// Granted when all optional objectives are complete.
/// </remarks>
public QuestReward? BonusRewards { get; private set; }

// Update Quest.Create to include rewards:
public static Quest Create(
    QuestDefinition definition,
    Guid playerId,
    string? giverNpcId = null)
{
    ArgumentNullException.ThrowIfNull(definition);

    var quest = new Quest
    {
        Id = Guid.NewGuid(),
        DefinitionId = definition.Id,
        Name = definition.Name,
        Description = definition.Description,
        Status = QuestStatus.Available,
        PlayerId = playerId,
        GiverNpcId = giverNpcId ?? definition.GiverNpcId,
        TurnInNpcId = definition.TurnInNpcId ?? giverNpcId ?? definition.GiverNpcId,
        Hint = definition.Hint,
        Rewards = definition.Rewards,           // NEW
        BonusRewards = definition.BonusRewards  // NEW
    };

    // Create objectives from definition
    foreach (var objectiveDef in definition.Objectives)
    {
        var objective = QuestObjective.Create(objectiveDef, quest.Id);
        quest._objectives.Add(objective);
    }

    return quest;
}

/// <summary>
/// Gets whether bonus rewards should be granted.
/// </summary>
/// <remarks>
/// Returns true when all optional objectives are complete.
/// </remarks>
public bool ShouldGrantBonusRewards()
{
    if (BonusRewards == null || !BonusRewards.HasRewards)
        return false;

    return _objectives
        .Where(o => o.IsOptional)
        .All(o => o.IsComplete);
}

/// <summary>
/// Gets the effective rewards to grant.
/// </summary>
/// <remarks>
/// Returns base rewards plus bonus if optional objectives are complete.
/// </remarks>
public QuestReward GetEffectiveRewards()
{
    if (!ShouldGrantBonusRewards() || BonusRewards == null)
        return Rewards;

    // Combine base and bonus rewards
    var allEntries = Rewards.Entries.Concat(BonusRewards.Entries);
    return QuestReward.Create(allEntries);
}
```

---

## 6. Configuration Schemas

### 6.1 Updated quests.json

```json
{
  "$schema": "../schemas/quests.schema.json",
  "quests": [
    {
      "id": "goblin-menace",
      "name": "The Goblin Menace",
      "description": "The dungeon entrance is overrun with goblins. Clear them out to make the area safe for other adventurers.",
      "giverNpcId": "guard-captain",
      "turnInNpcId": "guard-captain",
      "hint": "Goblins are commonly found in the upper dungeon levels.",
      "autoActivate": true,
      "objectives": [
        {
          "type": "Kill",
          "description": "Defeat goblins",
          "target": {
            "targetType": "goblin",
            "displayName": "Goblins",
            "anyOfType": true
          },
          "requiredCount": 5,
          "isOptional": false,
          "isHidden": false,
          "order": 1
        }
      ],
      "rewards": {
        "entries": [
          { "type": "XP", "amount": 50 },
          { "type": "Gold", "amount": 25 },
          { "type": "Reputation", "targetId": "city-guard", "amount": 100, "displayName": "City Guard" }
        ]
      }
    },
    {
      "id": "lost-heirloom",
      "name": "The Lost Heirloom",
      "description": "A merchant has lost a family heirloom somewhere in the dungeon. Find and return it.",
      "giverNpcId": "grimbold-trader",
      "turnInNpcId": "grimbold-trader",
      "hint": "The locket was last seen in the storage rooms.",
      "autoActivate": true,
      "objectives": [
        {
          "type": "Collect",
          "description": "Find the Golden Locket",
          "target": {
            "targetId": "item-golden-locket",
            "displayName": "Golden Locket",
            "locationHint": "Last seen in the storage rooms"
          },
          "requiredCount": 1,
          "isOptional": false,
          "isHidden": false,
          "order": 1
        },
        {
          "type": "Talk",
          "description": "Return the locket to Grimbold",
          "target": {
            "targetId": "grimbold-trader",
            "displayName": "Grimbold"
          },
          "requiredCount": 1,
          "isOptional": false,
          "isHidden": false,
          "order": 2
        }
      ],
      "rewards": {
        "entries": [
          { "type": "XP", "amount": 75 },
          { "type": "Gold", "amount": 50 },
          { "type": "Item", "targetId": "ring-of-protection", "displayName": "Ring of Protection" },
          { "type": "Reputation", "targetId": "merchant-guild", "amount": 150, "displayName": "Merchant Guild" }
        ]
      }
    },
    {
      "id": "dangerous-errand",
      "name": "A Dangerous Errand",
      "description": "Retrieve supplies from the abandoned outpost. The journey is perilous, but the reward is worth the risk.",
      "giverNpcId": "quartermaster",
      "turnInNpcId": "quartermaster",
      "hint": "The outpost is beyond the eastern tunnels.",
      "autoActivate": true,
      "objectives": [
        {
          "type": "Collect",
          "description": "Retrieve supply crates",
          "target": {
            "targetId": "item-supply-crate",
            "displayName": "Supply Crates"
          },
          "requiredCount": 3,
          "isOptional": false,
          "isHidden": false,
          "order": 1
        }
      ],
      "rewards": {
        "entries": [
          { "type": "XP", "amount": 100 },
          { "type": "Gold", "amount": 30 },
          { "type": "Item", "targetId": "iron-sword", "displayName": "Iron Sword", "isChoice": true, "choiceGroup": "weapon" },
          { "type": "Item", "targetId": "iron-axe", "displayName": "Iron Axe", "isChoice": true, "choiceGroup": "weapon" },
          { "type": "Item", "targetId": "iron-mace", "displayName": "Iron Mace", "isChoice": true, "choiceGroup": "weapon" }
        ]
      }
    },
    {
      "id": "dungeon-survey",
      "name": "Mapping the Depths",
      "description": "The Adventurer's Guild needs updated maps. Explore the key areas of the dungeon.",
      "giverNpcId": "guild-cartographer",
      "turnInNpcId": "guild-cartographer",
      "hint": "Find the Grand Hall, Underground Lake, and Ancient Library.",
      "autoActivate": true,
      "objectives": [
        {
          "type": "Explore",
          "description": "Visit the Grand Hall",
          "target": {
            "targetId": "room-grand-hall",
            "displayName": "Grand Hall"
          },
          "requiredCount": 1,
          "isOptional": false,
          "isHidden": false,
          "order": 1
        },
        {
          "type": "Explore",
          "description": "Visit the Underground Lake",
          "target": {
            "targetId": "room-underground-lake",
            "displayName": "Underground Lake"
          },
          "requiredCount": 1,
          "isOptional": false,
          "isHidden": false,
          "order": 2
        },
        {
          "type": "Explore",
          "description": "Visit the Ancient Library",
          "target": {
            "targetId": "room-ancient-library",
            "displayName": "Ancient Library"
          },
          "requiredCount": 1,
          "isOptional": false,
          "isHidden": false,
          "order": 3
        },
        {
          "type": "Explore",
          "description": "Discover the Hidden Treasury",
          "target": {
            "targetId": "room-hidden-treasury",
            "displayName": "Hidden Treasury"
          },
          "requiredCount": 1,
          "isOptional": true,
          "isHidden": true,
          "order": 4
        }
      ],
      "rewards": {
        "entries": [
          { "type": "XP", "amount": 80 },
          { "type": "Gold", "amount": 40 },
          { "type": "Reputation", "targetId": "adventurers-guild", "amount": 100, "displayName": "Adventurer's Guild" }
        ]
      },
      "bonusRewards": {
        "entries": [
          { "type": "XP", "amount": 50 },
          { "type": "Gold", "amount": 100 },
          { "type": "Item", "targetId": "treasure-map", "displayName": "Treasure Map" }
        ]
      }
    }
  ]
}
```

### 6.2 Updated quests.schema.json

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Quest Configuration",
  "description": "Defines quests, objectives, and rewards for the game",
  "type": "object",
  "required": ["quests"],
  "properties": {
    "quests": {
      "type": "array",
      "description": "List of quest definitions",
      "items": {
        "$ref": "#/definitions/questDefinition"
      }
    }
  },
  "definitions": {
    "questDefinition": {
      "type": "object",
      "required": ["id", "name", "description", "objectives"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Unique identifier (lowercase, alphanumeric with hyphens)"
        },
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100,
          "description": "Display name of the quest"
        },
        "description": {
          "type": "string",
          "minLength": 10,
          "maxLength": 1000,
          "description": "Narrative description of the quest"
        },
        "giverNpcId": {
          "type": ["string", "null"],
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "NPC who gives this quest"
        },
        "turnInNpcId": {
          "type": ["string", "null"],
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "NPC to turn in the quest (defaults to giver)"
        },
        "hint": {
          "type": ["string", "null"],
          "maxLength": 500,
          "description": "Hint text shown in journal"
        },
        "autoActivate": {
          "type": "boolean",
          "default": true,
          "description": "Whether quest auto-activates on acceptance"
        },
        "objectives": {
          "type": "array",
          "minItems": 1,
          "items": {
            "$ref": "#/definitions/objectiveDefinition"
          },
          "description": "Quest objectives"
        },
        "rewards": {
          "$ref": "#/definitions/questReward",
          "description": "Rewards granted on quest completion"
        },
        "bonusRewards": {
          "$ref": "#/definitions/questReward",
          "description": "Bonus rewards for completing optional objectives"
        }
      }
    },
    "objectiveDefinition": {
      "type": "object",
      "required": ["type", "description", "target"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["Kill", "Collect", "Explore", "Talk", "Deliver", "Use", "Custom"],
          "description": "Type of objective"
        },
        "description": {
          "type": "string",
          "minLength": 1,
          "maxLength": 200,
          "description": "Display description of the objective"
        },
        "target": {
          "$ref": "#/definitions/objectiveTarget"
        },
        "requiredCount": {
          "type": "integer",
          "minimum": 1,
          "default": 1,
          "description": "Number required to complete objective"
        },
        "isOptional": {
          "type": "boolean",
          "default": false,
          "description": "Whether objective is optional for quest completion"
        },
        "isHidden": {
          "type": "boolean",
          "default": false,
          "description": "Whether objective is hidden until discovered"
        },
        "order": {
          "type": "integer",
          "minimum": 0,
          "default": 0,
          "description": "Display order (ascending)"
        }
      }
    },
    "objectiveTarget": {
      "type": "object",
      "properties": {
        "targetId": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Specific target ID (for specific targets)"
        },
        "displayName": {
          "type": "string",
          "minLength": 1,
          "description": "Display name for the target"
        },
        "locationHint": {
          "type": ["string", "null"],
          "description": "Hint about where to find the target"
        },
        "anyOfType": {
          "type": "boolean",
          "default": false,
          "description": "Whether any entity of the type counts"
        },
        "targetType": {
          "type": ["string", "null"],
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Entity type for 'any of type' matching"
        }
      },
      "required": ["displayName"]
    },
    "questReward": {
      "type": "object",
      "required": ["entries"],
      "properties": {
        "entries": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/rewardEntry"
          },
          "description": "Individual reward entries"
        }
      }
    },
    "rewardEntry": {
      "type": "object",
      "required": ["type"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["XP", "Gold", "Item", "Reputation", "Unlock"],
          "description": "Type of reward"
        },
        "amount": {
          "type": "integer",
          "description": "Amount (XP, gold, quantity, reputation change)"
        },
        "targetId": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Target ID (item ID, faction ID, unlock ID)"
        },
        "displayName": {
          "type": ["string", "null"],
          "description": "Display name override"
        },
        "isChoice": {
          "type": "boolean",
          "default": false,
          "description": "Whether this is a choice reward"
        },
        "choiceGroup": {
          "type": ["string", "null"],
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Choice group ID for grouping choices"
        }
      },
      "allOf": [
        {
          "if": {
            "properties": { "type": { "const": "XP" } }
          },
          "then": {
            "required": ["amount"],
            "properties": {
              "amount": { "minimum": 1 }
            }
          }
        },
        {
          "if": {
            "properties": { "type": { "const": "Gold" } }
          },
          "then": {
            "required": ["amount"],
            "properties": {
              "amount": { "minimum": 1 }
            }
          }
        },
        {
          "if": {
            "properties": { "type": { "const": "Item" } }
          },
          "then": {
            "required": ["targetId"]
          }
        },
        {
          "if": {
            "properties": { "type": { "const": "Reputation" } }
          },
          "then": {
            "required": ["targetId", "amount"]
          }
        },
        {
          "if": {
            "properties": { "isChoice": { "const": true } }
          },
          "then": {
            "required": ["choiceGroup"]
          }
        }
      ]
    }
  }
}
```

---

## 7. Service Specifications

### 7.1 IConfigurationProvider Updates

```csharp
// The existing LoadQuestDefinitions method needs to handle rewards

// In JsonConfigurationProvider.LoadQuestDefinitions:

private QuestReward CreateReward(RewardConfigDto? dto)
{
    if (dto?.Entries == null || dto.Entries.Count == 0)
        return QuestReward.Empty;

    var entries = new List<RewardEntry>();

    foreach (var entryDto in dto.Entries)
    {
        var entry = CreateRewardEntry(entryDto);
        if (entry.HasValue)
            entries.Add(entry.Value);
    }

    return QuestReward.Create(entries);
}

private RewardEntry? CreateRewardEntry(RewardEntryDto dto)
{
    try
    {
        return dto.Type switch
        {
            "XP" => RewardEntry.XP(dto.Amount),
            "Gold" => RewardEntry.Gold(dto.Amount),
            "Item" when dto.IsChoice =>
                RewardEntry.ChoiceItem(dto.TargetId!, dto.ChoiceGroup!, dto.DisplayName),
            "Item" =>
                RewardEntry.Item(dto.TargetId!, dto.Amount > 0 ? dto.Amount : 1, dto.DisplayName),
            "Reputation" =>
                RewardEntry.Reputation(dto.TargetId!, dto.Amount, dto.DisplayName),
            "Unlock" =>
                RewardEntry.Unlock(dto.TargetId!, dto.DisplayName),
            _ => null
        };
    }
    catch (Exception ex)
    {
        _logger.LogWarning(
            "Invalid reward entry in configuration: {Type} - {Error}",
            dto.Type, ex.Message);
        return null;
    }
}
```

### 7.2 Configuration DTOs

```csharp
namespace RuneAndRust.Application.Configuration;

/// <summary>
/// DTO for reward configuration in quests.json.
/// </summary>
public class RewardConfigDto
{
    /// <summary>
    /// Gets or sets the reward entries.
    /// </summary>
    public List<RewardEntryDto> Entries { get; set; } = new();
}

/// <summary>
/// DTO for a single reward entry in configuration.
/// </summary>
public class RewardEntryDto
{
    /// <summary>
    /// Gets or sets the reward type.
    /// </summary>
    public string Type { get; set; } = string.Empty;

    /// <summary>
    /// Gets or sets the amount.
    /// </summary>
    public int Amount { get; set; }

    /// <summary>
    /// Gets or sets the target ID.
    /// </summary>
    public string? TargetId { get; set; }

    /// <summary>
    /// Gets or sets the display name.
    /// </summary>
    public string? DisplayName { get; set; }

    /// <summary>
    /// Gets or sets whether this is a choice reward.
    /// </summary>
    public bool IsChoice { get; set; }

    /// <summary>
    /// Gets or sets the choice group ID.
    /// </summary>
    public string? ChoiceGroup { get; set; }
}
```

### 7.3 RewardDisplayDto

```csharp
namespace RuneAndRust.Application.DTOs;

/// <summary>
/// DTO for displaying quest rewards in the UI.
/// </summary>
/// <param name="XP">Total XP reward.</param>
/// <param name="Gold">Total gold reward.</param>
/// <param name="Items">Item rewards.</param>
/// <param name="ReputationChanges">Reputation changes.</param>
/// <param name="ChoiceGroups">Choice reward groups.</param>
/// <param name="DisplayString">Formatted display string.</param>
public record RewardDisplayDto(
    int XP,
    int Gold,
    IReadOnlyList<ItemRewardDto> Items,
    IReadOnlyList<ReputationRewardDto> ReputationChanges,
    IReadOnlyList<RewardChoiceGroupDto> ChoiceGroups,
    string DisplayString)
{
    /// <summary>
    /// Creates an empty reward display.
    /// </summary>
    public static RewardDisplayDto Empty => new(
        0, 0,
        Array.Empty<ItemRewardDto>(),
        Array.Empty<ReputationRewardDto>(),
        Array.Empty<RewardChoiceGroupDto>(),
        "None");

    /// <summary>
    /// Creates a RewardDisplayDto from a QuestReward.
    /// </summary>
    public static RewardDisplayDto FromQuestReward(QuestReward reward)
    {
        if (!reward.HasRewards)
            return Empty;

        var items = reward.ItemRewards
            .Where(i => !i.IsChoice)
            .Select(i => new ItemRewardDto(i.TargetId, i.DisplayName ?? i.TargetId, i.Amount))
            .ToList();

        var reputation = reward.ReputationRewards
            .Select(r => new ReputationRewardDto(r.TargetId, r.DisplayName ?? r.TargetId, r.Amount))
            .ToList();

        var choiceGroups = reward.ChoiceGroups
            .Select(g => new RewardChoiceGroupDto(
                g,
                reward.GetChoicesForGroup(g)
                    .Select(c => new ItemRewardDto(c.TargetId, c.DisplayName ?? c.TargetId, c.Amount))
                    .ToList()))
            .ToList();

        return new RewardDisplayDto(
            reward.TotalXP,
            reward.TotalGold,
            items,
            reputation,
            choiceGroups,
            reward.GetDisplayString());
    }
}

/// <summary>
/// DTO for an item reward.
/// </summary>
/// <param name="ItemId">The item definition ID.</param>
/// <param name="DisplayName">The display name.</param>
/// <param name="Quantity">The quantity.</param>
public record ItemRewardDto(string ItemId, string DisplayName, int Quantity);

/// <summary>
/// DTO for a reputation reward.
/// </summary>
/// <param name="FactionId">The faction ID.</param>
/// <param name="DisplayName">The faction display name.</param>
/// <param name="Amount">The reputation change.</param>
public record ReputationRewardDto(string FactionId, string DisplayName, int Amount);

/// <summary>
/// DTO for a choice reward group.
/// </summary>
/// <param name="GroupId">The choice group ID.</param>
/// <param name="Choices">The available choices.</param>
public record RewardChoiceGroupDto(string GroupId, IReadOnlyList<ItemRewardDto> Choices);
```

### 7.4 QuestDetailDto Updates

```csharp
// Updates to existing QuestDetailDto

/// <summary>
/// Detailed information about a quest for display.
/// </summary>
/// <param name="Id">Quest instance ID.</param>
/// <param name="Name">Quest name.</param>
/// <param name="Description">Quest description.</param>
/// <param name="Status">Current status.</param>
/// <param name="Progress">Overall progress percentage.</param>
/// <param name="Objectives">List of objectives.</param>
/// <param name="Hint">Optional hint text.</param>
/// <param name="GiverName">Name of the quest giver NPC.</param>
/// <param name="TurnInName">Name of the turn-in NPC.</param>
/// <param name="AcceptedAt">When the quest was accepted.</param>
/// <param name="Rewards">Quest rewards.</param>
/// <param name="BonusRewards">Optional bonus rewards.</param>
public record QuestDetailDto(
    Guid Id,
    string Name,
    string Description,
    string Status,
    int Progress,
    IReadOnlyList<ObjectiveSummaryDto> Objectives,
    string? Hint,
    string? GiverName,
    string? TurnInName,
    DateTime? AcceptedAt,
    RewardDisplayDto Rewards,           // NEW
    RewardDisplayDto? BonusRewards);    // NEW
```

---

## 8. User-Facing Changes

### 8.1 Quest Journal Display

The quest journal detail view now shows rewards:

```
┌─────────────────────────────────────────────────────────────┐
│                    THE GOBLIN MENACE                        │
├─────────────────────────────────────────────────────────────┤
│  Status: Active                      Progress: 60%          │
│  Given by: Guard Captain                                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  The dungeon entrance is overrun with goblins. Clear them   │
│  out to make the area safe for other adventurers.           │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  OBJECTIVES                                                 │
│  • Defeat goblins                                  (3/5)    │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  REWARDS                                                    │
│  • 50 XP                                                    │
│  • 25 gold                                                  │
│  • +100 City Guard reputation                               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 8.2 Quest with Choice Rewards

```
┌─────────────────────────────────────────────────────────────┐
│                   A DANGEROUS ERRAND                        │
├─────────────────────────────────────────────────────────────┤
│  Status: Active                      Progress: 33%          │
│  Given by: Quartermaster                                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  Retrieve supplies from the abandoned outpost.              │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  OBJECTIVES                                                 │
│  • Retrieve supply crates                          (1/3)    │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  REWARDS                                                    │
│  • 100 XP                                                   │
│  • 30 gold                                                  │
│  • Choice of: Iron Sword, Iron Axe, or Iron Mace           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 8.3 Quest with Bonus Rewards

```
┌─────────────────────────────────────────────────────────────┐
│                   MAPPING THE DEPTHS                        │
├─────────────────────────────────────────────────────────────┤
│  Status: Active                      Progress: 66%          │
│  Given by: Guild Cartographer                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  The Adventurer's Guild needs updated maps.                 │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  OBJECTIVES                                                 │
│  ✓ Visit the Grand Hall                         [Complete]  │
│  ✓ Visit the Underground Lake                   [Complete]  │
│  • Visit the Ancient Library                  [Incomplete]  │
│  [BONUS] Discover the Hidden Treasury         [Incomplete]  │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  REWARDS                                                    │
│  • 80 XP                                                    │
│  • 40 gold                                                  │
│  • +100 Adventurer's Guild reputation                       │
│                                                             │
│  BONUS REWARDS (complete optional objectives)               │
│  • 50 XP                                                    │
│  • 100 gold                                                 │
│  • Treasure Map                                             │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 9. Logging Requirements

### 9.1 Log Events

| Event | Level | Message Template | Properties |
|-------|-------|------------------|------------|
| Reward Config | Debug | "Loaded rewards for quest '{QuestId}': {RewardSummary}" | QuestId, RewardSummary |
| Invalid Reward | Warning | "Invalid reward entry in quest '{QuestId}': {EntryType} - {Error}" | QuestId, EntryType, Error |
| Choice Group | Debug | "Quest '{QuestId}' has choice group '{GroupId}' with {ChoiceCount} options" | QuestId, GroupId, ChoiceCount |
| Bonus Rewards | Debug | "Quest '{QuestId}' has bonus rewards: {BonusSummary}" | QuestId, BonusSummary |
| Missing Target | Warning | "Reward entry references unknown target: {TargetId}" | TargetId |

### 9.2 Example Log Output

```
[2024-01-20 14:30:15 DBG] Loaded rewards for quest 'goblin-menace': 50 XP, 25 gold, +100 City Guard reputation
[2024-01-20 14:30:15 DBG] Loaded rewards for quest 'dangerous-errand': 100 XP, 30 gold, Choice of: Iron Sword, Iron Axe, Iron Mace
[2024-01-20 14:30:15 DBG] Quest 'dangerous-errand' has choice group 'weapon' with 3 options
[2024-01-20 14:30:15 DBG] Quest 'dungeon-survey' has bonus rewards: 50 XP, 100 gold, Treasure Map
```

---

## 10. Unit Test Specifications

### 10.1 QuestReward Tests (~10 tests)

```csharp
namespace RuneAndRust.Domain.Tests.ValueObjects;

[TestFixture]
public class QuestRewardTests
{
    [Test]
    public void Empty_ReturnsRewardWithNoEntries()
    {
        var reward = QuestReward.Empty;

        reward.HasRewards.Should().BeFalse();
        reward.Entries.Should().BeEmpty();
        reward.TotalXP.Should().Be(0);
        reward.TotalGold.Should().Be(0);
    }

    [Test]
    public void Create_WithEntries_ReturnsRewardWithEntries()
    {
        var entries = new[]
        {
            RewardEntry.XP(50),
            RewardEntry.Gold(25)
        };

        var reward = QuestReward.Create(entries);

        reward.HasRewards.Should().BeTrue();
        reward.Entries.Should().HaveCount(2);
    }

    [Test]
    public void Simple_CreatesXPAndGoldReward()
    {
        var reward = QuestReward.Simple(100, 50);

        reward.TotalXP.Should().Be(100);
        reward.TotalGold.Should().Be(50);
        reward.Entries.Should().HaveCount(2);
    }

    [Test]
    public void Simple_WithZeroXP_OmitsXPEntry()
    {
        var reward = QuestReward.Simple(0, 50);

        reward.TotalXP.Should().Be(0);
        reward.TotalGold.Should().Be(50);
        reward.Entries.Should().HaveCount(1);
    }

    [Test]
    public void TotalXP_SumsAllXPEntries()
    {
        var entries = new[]
        {
            RewardEntry.XP(50),
            RewardEntry.Gold(25),
            RewardEntry.XP(30)
        };

        var reward = QuestReward.Create(entries);

        reward.TotalXP.Should().Be(80);
    }

    [Test]
    public void ItemRewards_ReturnsOnlyItemEntries()
    {
        var entries = new[]
        {
            RewardEntry.XP(50),
            RewardEntry.Item("iron-sword", 1, "Iron Sword"),
            RewardEntry.Gold(25),
            RewardEntry.Item("health-potion", 3, "Health Potion")
        };

        var reward = QuestReward.Create(entries);

        reward.ItemRewards.Should().HaveCount(2);
        reward.ItemRewards.Select(i => i.TargetId).Should().Contain("iron-sword", "health-potion");
    }

    [Test]
    public void ChoiceRewards_ReturnsOnlyChoiceEntries()
    {
        var entries = new[]
        {
            RewardEntry.XP(50),
            RewardEntry.ChoiceItem("iron-sword", "weapon", "Iron Sword"),
            RewardEntry.ChoiceItem("iron-axe", "weapon", "Iron Axe")
        };

        var reward = QuestReward.Create(entries);

        reward.HasChoices.Should().BeTrue();
        reward.ChoiceRewards.Should().HaveCount(2);
        reward.ChoiceGroups.Should().Contain("weapon");
    }

    [Test]
    public void GetChoicesForGroup_ReturnsGroupedChoices()
    {
        var entries = new[]
        {
            RewardEntry.ChoiceItem("iron-sword", "weapon", "Iron Sword"),
            RewardEntry.ChoiceItem("iron-axe", "weapon", "Iron Axe"),
            RewardEntry.ChoiceItem("leather-armor", "armor", "Leather Armor")
        };

        var reward = QuestReward.Create(entries);

        reward.GetChoicesForGroup("weapon").Should().HaveCount(2);
        reward.GetChoicesForGroup("armor").Should().HaveCount(1);
    }

    [Test]
    public void WithEntry_ReturnsNewRewardWithAddedEntry()
    {
        var reward = QuestReward.Simple(50, 25);

        var updated = reward.WithEntry(RewardEntry.Item("sword", 1, "Sword"));

        updated.Entries.Should().HaveCount(3);
        reward.Entries.Should().HaveCount(2); // Original unchanged
    }

    [Test]
    public void GetDisplayString_FormatsCorrectly()
    {
        var entries = new[]
        {
            RewardEntry.XP(50),
            RewardEntry.Gold(25),
            RewardEntry.Reputation("city-guard", 100, "City Guard")
        };

        var reward = QuestReward.Create(entries);

        var display = reward.GetDisplayString();

        display.Should().Contain("50 XP");
        display.Should().Contain("25 gold");
        display.Should().Contain("+100 City Guard reputation");
    }
}
```

### 10.2 RewardEntry Tests (~8 tests)

```csharp
[TestFixture]
public class RewardEntryTests
{
    [Test]
    public void XP_CreatesXPEntry()
    {
        var entry = RewardEntry.XP(100);

        entry.Type.Should().Be(RewardType.XP);
        entry.Amount.Should().Be(100);
        entry.TargetId.Should().BeEmpty();
        entry.IsChoice.Should().BeFalse();
    }

    [Test]
    public void XP_WithZeroOrNegative_ThrowsArgumentOutOfRange()
    {
        var act = () => RewardEntry.XP(0);

        act.Should().Throw<ArgumentOutOfRangeException>();
    }

    [Test]
    public void Gold_CreatesGoldEntry()
    {
        var entry = RewardEntry.Gold(50);

        entry.Type.Should().Be(RewardType.Gold);
        entry.Amount.Should().Be(50);
    }

    [Test]
    public void Item_CreatesItemEntry()
    {
        var entry = RewardEntry.Item("iron-sword", 1, "Iron Sword");

        entry.Type.Should().Be(RewardType.Item);
        entry.TargetId.Should().Be("iron-sword");
        entry.Amount.Should().Be(1);
        entry.DisplayName.Should().Be("Iron Sword");
        entry.IsChoice.Should().BeFalse();
    }

    [Test]
    public void Item_WithNullOrEmptyId_ThrowsArgumentException()
    {
        var act = () => RewardEntry.Item("", 1);

        act.Should().Throw<ArgumentException>();
    }

    [Test]
    public void Reputation_CreatesReputationEntry()
    {
        var entry = RewardEntry.Reputation("city-guard", 100, "City Guard");

        entry.Type.Should().Be(RewardType.Reputation);
        entry.TargetId.Should().Be("city-guard");
        entry.Amount.Should().Be(100);
        entry.DisplayName.Should().Be("City Guard");
    }

    [Test]
    public void Reputation_AllowsNegativeAmount()
    {
        var entry = RewardEntry.Reputation("bandits", -50, "Bandits");

        entry.Amount.Should().Be(-50);
    }

    [Test]
    public void ChoiceItem_CreatesChoiceEntry()
    {
        var entry = RewardEntry.ChoiceItem("iron-sword", "weapon", "Iron Sword");

        entry.Type.Should().Be(RewardType.Item);
        entry.IsChoice.Should().BeTrue();
        entry.ChoiceGroup.Should().Be("weapon");
    }

    [Test]
    public void ToDisplayString_FormatsCorrectly()
    {
        RewardEntry.XP(100).ToDisplayString().Should().Be("100 XP");
        RewardEntry.Gold(50).ToDisplayString().Should().Be("50 gold");
        RewardEntry.Item("sword", 1, "Iron Sword").ToDisplayString().Should().Be("Iron Sword");
        RewardEntry.Item("potion", 3, "Health Potion").ToDisplayString().Should().Be("3x Health Potion");
        RewardEntry.Reputation("guard", 100, "City Guard").ToDisplayString().Should().Be("+100 City Guard reputation");
        RewardEntry.Reputation("bandit", -50, "Bandits").ToDisplayString().Should().Be("-50 Bandits reputation");
    }
}
```

### 10.3 QuestDefinition Reward Tests (~4 tests)

```csharp
[TestFixture]
public class QuestDefinitionRewardTests
{
    [Test]
    public void Create_WithRewards_StoresRewards()
    {
        var rewards = QuestReward.Simple(50, 25);

        var definition = QuestDefinition.Create(
            "test-quest",
            "Test Quest",
            "A test quest.",
            Array.Empty<ObjectiveDefinition>(),
            rewards: rewards);

        definition.HasRewards.Should().BeTrue();
        definition.Rewards.TotalXP.Should().Be(50);
        definition.Rewards.TotalGold.Should().Be(25);
    }

    [Test]
    public void Create_WithoutRewards_HasEmptyRewards()
    {
        var definition = QuestDefinition.Create(
            "test-quest",
            "Test Quest",
            "A test quest.",
            Array.Empty<ObjectiveDefinition>());

        definition.HasRewards.Should().BeFalse();
        definition.Rewards.Should().Be(QuestReward.Empty);
    }

    [Test]
    public void Create_WithBonusRewards_StoresBonusRewards()
    {
        var rewards = QuestReward.Simple(50, 25);
        var bonusRewards = QuestReward.Simple(25, 10);

        var definition = QuestDefinition.Create(
            "test-quest",
            "Test Quest",
            "A test quest.",
            Array.Empty<ObjectiveDefinition>(),
            rewards: rewards,
            bonusRewards: bonusRewards);

        definition.HasBonusRewards.Should().BeTrue();
        definition.BonusRewards!.TotalXP.Should().Be(25);
    }

    [Test]
    public void GetTotalXP_IncludesBonusWhenRequested()
    {
        var rewards = QuestReward.Simple(50, 0);
        var bonusRewards = QuestReward.Simple(25, 0);

        var definition = QuestDefinition.Create(
            "test-quest",
            "Test Quest",
            "A test quest.",
            Array.Empty<ObjectiveDefinition>(),
            rewards: rewards,
            bonusRewards: bonusRewards);

        definition.GetTotalXP(includeBonus: false).Should().Be(50);
        definition.GetTotalXP(includeBonus: true).Should().Be(75);
    }
}
```

### 10.4 Quest Reward Integration Tests (~3 tests)

```csharp
[TestFixture]
public class QuestRewardIntegrationTests
{
    [Test]
    public void Quest_Create_CopiesRewardsFromDefinition()
    {
        var rewards = QuestReward.Simple(100, 50);
        var definition = QuestDefinition.Create(
            "test-quest",
            "Test Quest",
            "A test quest.",
            new[] { CreateTestObjective() },
            rewards: rewards);

        var quest = Quest.Create(definition, Guid.NewGuid());

        quest.Rewards.TotalXP.Should().Be(100);
        quest.Rewards.TotalGold.Should().Be(50);
    }

    [Test]
    public void Quest_ShouldGrantBonusRewards_ReturnsTrueWhenOptionalComplete()
    {
        var rewards = QuestReward.Simple(100, 50);
        var bonusRewards = QuestReward.Simple(50, 25);
        var definition = QuestDefinition.Create(
            "test-quest",
            "Test Quest",
            "A test quest.",
            new[]
            {
                ObjectiveDefinition.Create(
                    ObjectiveType.Kill,
                    "Required objective",
                    ObjectiveTarget.Any("enemy", "Enemies"),
                    1,
                    isOptional: false),
                ObjectiveDefinition.Create(
                    ObjectiveType.Explore,
                    "Optional objective",
                    ObjectiveTarget.Specific("room", "Room"),
                    1,
                    isOptional: true)
            },
            rewards: rewards,
            bonusRewards: bonusRewards);

        var quest = Quest.Create(definition, Guid.NewGuid());
        quest.Objectives[0].SetProgress(1); // Complete required
        quest.Objectives[1].SetProgress(1); // Complete optional

        quest.ShouldGrantBonusRewards().Should().BeTrue();
    }

    [Test]
    public void Quest_GetEffectiveRewards_CombinesBonusWhenEarned()
    {
        var rewards = QuestReward.Simple(100, 50);
        var bonusRewards = QuestReward.Simple(50, 25);
        var definition = QuestDefinition.Create(
            "test-quest",
            "Test Quest",
            "A test quest.",
            new[]
            {
                ObjectiveDefinition.Create(
                    ObjectiveType.Kill,
                    "Optional objective",
                    ObjectiveTarget.Any("enemy", "Enemies"),
                    1,
                    isOptional: true)
            },
            rewards: rewards,
            bonusRewards: bonusRewards);

        var quest = Quest.Create(definition, Guid.NewGuid());
        quest.Objectives[0].SetProgress(1);

        var effective = quest.GetEffectiveRewards();

        effective.TotalXP.Should().Be(150);
        effective.TotalGold.Should().Be(75);
    }

    private ObjectiveDefinition CreateTestObjective()
    {
        return ObjectiveDefinition.Create(
            ObjectiveType.Kill,
            "Test",
            ObjectiveTarget.Any("enemy", "Enemies"),
            1);
    }
}
```

---

## 11. Use Cases

### UC-001: Define Quest Rewards
**Actor:** Game Designer (via configuration)
**Flow:** Edit quests.json → Add rewards section → Define entries → Validate schema → Configuration loaded

### UC-002: View Quest Rewards in Journal
**Actor:** Player
**Flow:** Open quest journal → Select quest → View detail → Rewards section displays XP, gold, items, reputation

### UC-003: Configure Choice Rewards
**Actor:** Game Designer
**Flow:** Add reward entries with isChoice: true → Set choiceGroup → Multiple entries share group → Player sees "Choice of: X, Y, Z"

### UC-004: Configure Bonus Rewards
**Actor:** Game Designer
**Flow:** Add bonusRewards section → Define bonus entries → Displayed separately in journal → Granted when optional objectives complete

---

## 12. Acceptance Criteria

### AC-3.1a-1: QuestReward Value Object
- [ ] QuestReward can hold multiple RewardEntry instances
- [ ] TotalXP correctly sums all XP entries
- [ ] TotalGold correctly sums all gold entries
- [ ] ItemRewards filters to item type entries
- [ ] ReputationRewards filters to reputation type entries
- [ ] HasRewards returns true when entries exist
- [ ] Empty static property returns reward with no entries
- [ ] GetDisplayString formats rewards correctly

### AC-3.1a-2: RewardEntry Value Object
- [ ] RewardEntry.XP creates XP entry with amount
- [ ] RewardEntry.Gold creates gold entry with amount
- [ ] RewardEntry.Item creates item entry with targetId and quantity
- [ ] RewardEntry.Reputation creates reputation entry with faction and amount
- [ ] RewardEntry.ChoiceItem creates choice entry with group
- [ ] Negative reputation amounts are allowed
- [ ] Factory methods validate input parameters

### AC-3.1a-3: RewardType Enum
- [ ] RewardType has 5 values: XP, Gold, Item, Reputation, Unlock
- [ ] All values have XML documentation

### AC-3.1a-4: QuestDefinition Updates
- [ ] QuestDefinition has Rewards property
- [ ] QuestDefinition has optional BonusRewards property
- [ ] HasRewards returns true when rewards defined
- [ ] HasBonusRewards returns true when bonus rewards defined
- [ ] GetTotalXP calculates correct total with/without bonus

### AC-3.1a-5: Quest Entity Updates
- [ ] Quest copies Rewards from definition on create
- [ ] Quest copies BonusRewards from definition on create
- [ ] ShouldGrantBonusRewards checks optional objectives
- [ ] GetEffectiveRewards combines rewards when bonus earned

### AC-3.1a-6: Configuration
- [ ] quests.json supports rewards section
- [ ] All reward types can be configured
- [ ] Choice rewards are grouped correctly
- [ ] Bonus rewards are separate from base rewards
- [ ] Schema validates reward entries

### AC-3.1a-7: Quest Journal Display
- [ ] Rewards section appears in quest detail
- [ ] XP and gold totals display correctly
- [ ] Item rewards show names
- [ ] Reputation rewards show faction and amount with sign
- [ ] Choice rewards display as "Choice of: X, Y, or Z"
- [ ] Bonus rewards display separately when defined

### AC-3.1a-8: Unit Tests
- [ ] ~25 unit tests implemented
- [ ] All tests pass
- [ ] Tests cover happy path and error cases

---

## 13. Deliverable Checklist

### Domain Layer
- [ ] `ValueObjects/QuestReward.cs`
- [ ] `ValueObjects/RewardEntry.cs`
- [ ] `Enums/RewardType.cs`
- [ ] `Definitions/QuestDefinition.cs` updates (Rewards, BonusRewards)
- [ ] `Entities/Quest.cs` updates (Rewards, BonusRewards, GetEffectiveRewards)

### Application Layer
- [ ] `Configuration/RewardConfigDto.cs`
- [ ] `Configuration/RewardEntryDto.cs`
- [ ] `DTOs/RewardDisplayDto.cs`
- [ ] `DTOs/ItemRewardDto.cs`
- [ ] `DTOs/ReputationRewardDto.cs`
- [ ] `DTOs/RewardChoiceGroupDto.cs`
- [ ] `DTOs/QuestDetailDto.cs` updates

### Infrastructure Layer
- [ ] `Configuration/JsonConfigurationProvider.cs` updates (reward parsing)

### Configuration Files
- [ ] `config/quests.json` updates (reward entries)
- [ ] `config/schemas/quests.schema.json` updates (reward schema)

### Tests
- [ ] `Domain.Tests/ValueObjects/QuestRewardTests.cs`
- [ ] `Domain.Tests/ValueObjects/RewardEntryTests.cs`
- [ ] `Domain.Tests/Definitions/QuestDefinitionRewardTests.cs`
- [ ] `Domain.Tests/Entities/QuestRewardIntegrationTests.cs`

### Documentation
- [ ] XML documentation on all public members
- [ ] JSON schema documentation for rewards

---

## 14. Dependencies

### Required from v0.3.0
- Quest entity (from v0.3.0a)
- QuestDefinition entity (from v0.3.0a)
- QuestObjective entity (from v0.3.0a)
- QuestDetailDto (from v0.3.0b)
- IConfigurationProvider with quest loading (from v0.3.0a)

### Provided to v0.3.1b (Quest Giver NPCs)
- QuestReward for display in NPC dialogue
- RewardDisplayDto for rendering

### Provided to v0.3.1c (Prerequisites & Distribution)
- QuestReward for distribution logic
- RewardEntry for processing individual rewards
- RewardType for dispatch to appropriate services

### Provided to v0.3.2 (Quest Chains)
- Reward system ready for chain bonus rewards

---

## 15. Future Considerations

### Deferred to v0.3.1b
- **NPC Reward Display**: Show rewards in NPC quest offering dialogue
- **Quest Giver Integration**: NPCs that offer quests with rewards

### Deferred to v0.3.1c
- **Reward Distribution**: Actually granting rewards to players
- **Choice Selection UI**: Player selecting from choice groups
- **Inventory Space Checks**: Validating player can receive items
- **Experience Service Integration**: Granting XP
- **Reputation Service Integration**: Modifying faction standing

### Deferred to v0.3.2
- **Chain Bonus Rewards**: Extra rewards for completing quest chains
- **Scaling Rewards**: Rewards that scale with player level
- **Random Rewards**: Reward tables with random selection

### Out of Scope
- **Loot Tables**: Complex random reward generation
- **Currency Types**: Multiple currency beyond gold
- **Crafting Materials**: Specialized reward categories

---

*Document Version: 1.0*
*Last Updated: 2024-01-20*
*Author: Claude Code*
