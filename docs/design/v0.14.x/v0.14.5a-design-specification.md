# v0.14.5a Design Specification: Currency Schema

**Version:** 0.14.5a
**Parent:** v0.14.5 (Economy Configuration Schemas)
**Prerequisites:** v0.14.4 Complete (Environment Configuration Schemas)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Currency Schema Root Definition](#4-currency-schema-root-definition)
   - 4.1 [Root Configuration Properties](#41-root-configuration-properties)
   - 4.2 [CurrencyDefinition Schema](#42-currencydefinition-schema)
5. [Display Configuration](#5-display-configuration)
   - 5.1 [Symbol Configuration](#51-symbol-configuration)
   - 5.2 [Symbol Position Enumeration](#52-symbol-position-enumeration)
   - 5.3 [Decimal Places](#53-decimal-places)
   - 5.4 [Color Configuration](#54-color-configuration)
6. [Exchange Rate Configuration](#6-exchange-rate-configuration)
   - 6.1 [ExchangeRate Definition](#61-exchangerate-definition)
   - 6.2 [Exchange Rate Calculation](#62-exchange-rate-calculation)
   - 6.3 [Bidirectional Exchanges](#63-bidirectional-exchanges)
7. [Capacity Configuration](#7-capacity-configuration)
   - 7.1 [Maximum Amount Caps](#71-maximum-amount-caps)
   - 7.2 [Trade-Only Currencies](#72-trade-only-currencies)
8. [Validation Rules](#8-validation-rules)
   - 8.1 [ID Pattern Validation](#81-id-pattern-validation)
   - 8.2 [Range Validation](#82-range-validation)
   - 8.3 [Required Fields](#83-required-fields)
   - 8.4 [Enum Validation](#84-enum-validation)
9. [Configuration Schema](#9-configuration-schema)
10. [Configuration File Updates](#10-configuration-file-updates)
11. [Data Model Changes](#11-data-model-changes)
12. [Logging Specifications](#12-logging-specifications)
13. [Unit Testing Requirements](#13-unit-testing-requirements)
14. [Use Cases](#14-use-cases)
15. [Deliverable Checklist](#15-deliverable-checklist)
16. [Acceptance Criteria](#16-acceptance-criteria)
17. [Dependencies](#17-dependencies)
18. [Future Considerations](#18-future-considerations)

---

## 1. Executive Summary

Version 0.14.5a introduces the **Currency Schema** (`currency.schema.json`), which validates currency definitions including display formatting, exchange rates, maximum capacity caps, and visual representation. This schema enables full customization of economic currencies without code changes, supporting modding scenarios such as sci-fi credit systems, multi-tier fantasy currencies (gold/silver/copper), faction-specific tokens, or barter economies.

The Currency Schema validates the existing `currency.json` configuration file which currently defines 1 currency (gold). The schema establishes patterns for economy-related configurations that will be extended by resources (v0.14.5b), recipes (v0.14.5c), and vendors (v0.14.5d).

### Key Deliverables

| Category | Items |
|----------|-------|
| **Schema Files** | `currency.schema.json` |
| **Schema Definitions** | `CurrencyDefinition`, `ExchangeRate` |
| **Configuration Files** | Update `currency.json` to reference new schema |
| **Tests** | ~4 new unit tests |

### Architectural Significance

This version provides:
- **Display formatting validation** - Symbol, position, decimal places
- **Exchange rate system** - Currency conversion with bidirectional support
- **Capacity limits** - Maximum carry amount validation
- **Visual configuration** - Color for UI display
- **Trade restrictions** - Currencies that can't be looted

### Relationship to Other Schemas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  v0.14.5 ECONOMY CONFIGURATION SCHEMAS                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  v0.14.5a: currency.schema.json â—€â”€â”€ THIS VERSION                        â”‚
  â”‚  v0.14.5b: resources.schema.json                                        â”‚
  â”‚  v0.14.5c: recipes.schema.json                                          â”‚
  â”‚  v0.14.5d: vendors.schema.json                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Cross-references:
  â€¢ currency.json â†’ exchangeRates[].targetCurrencyId references other currencies
  â€¢ vendors.json â†’ acceptedCurrencies references currency.json (v0.14.5d)
  â€¢ loot-tables.json â†’ goldRange references currency amounts (future)

  Shared definitions:
  â€¢ ID pattern: ^[a-z][a-z0-9-]*$ (lowercase kebab-case)
  â€¢ Schema location: config/schemas/
  â€¢ Currencies structure: Array of currency definitions
```

---

## 2. Feature Overview

```
v0.14.5a Currency Schema Features
â”œâ”€â”€ currency.schema.json
â”‚   â”œâ”€â”€ Root Configuration Properties
â”‚   â”‚   â”œâ”€â”€ $schema (string, optional)
â”‚   â”‚   â”œâ”€â”€ version (string, optional)
â”‚   â”‚   â””â”€â”€ currencies (array of CurrencyDefinition, required)
â”‚   â””â”€â”€ Definitions
â”‚       â”œâ”€â”€ CurrencyDefinition
â”‚       â”‚   â”œâ”€â”€ id (string, kebab-case pattern, required)
â”‚       â”‚   â”œâ”€â”€ name (string, minLength: 1, required)
â”‚       â”‚   â”œâ”€â”€ pluralName (string, optional, defaults to name)
â”‚       â”‚   â”œâ”€â”€ symbol (string, 1-3 characters, required)
â”‚       â”‚   â”œâ”€â”€ symbolPosition (enum: Before/After, default: Before)
â”‚       â”‚   â”œâ”€â”€ color (string, required)
â”‚       â”‚   â”œâ”€â”€ decimalPlaces (integer, 0-4, default: 0)
â”‚       â”‚   â”œâ”€â”€ maxAmount (integer, optional, cap limit)
â”‚       â”‚   â”œâ”€â”€ exchangeRates (array of ExchangeRate, optional)
â”‚       â”‚   â”œâ”€â”€ isTradeOnly (boolean, default: false)
â”‚       â”‚   â”œâ”€â”€ description (string, optional)
â”‚       â”‚   â””â”€â”€ sortOrder (integer, minimum: 0, default: 0)
â”‚       â””â”€â”€ ExchangeRate
â”‚           â”œâ”€â”€ targetCurrencyId (string, required)
â”‚           â”œâ”€â”€ rate (number, minimum: 0.001, required)
â”‚           â””â”€â”€ bidirectional (boolean, default: true)
â”œâ”€â”€ Validation Rules
â”‚   â”œâ”€â”€ Currency ID Pattern Validation (kebab-case)
â”‚   â”œâ”€â”€ Symbol Length Validation (1-3 characters)
â”‚   â”œâ”€â”€ Symbol Position Enum Validation (2 values)
â”‚   â”œâ”€â”€ Decimal Places Range Validation (0-4)
â”‚   â”œâ”€â”€ Exchange Rate Minimum Validation (>= 0.001)
â”‚   â”œâ”€â”€ Max Amount Validation (optional positive integer)
â”‚   â””â”€â”€ Required Fields Enforced
â””â”€â”€ Configuration Updates
    â””â”€â”€ currency.json updated with $schema reference
```

---

## 3. Architecture Diagrams

### 3.1 Currency Definition Structure Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CURRENCY DEFINITION STRUCTURE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      CURRENCY DEFINITION                             â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  id: "gold"                                                          â”‚    â”‚
â”‚  â”‚  name: "Gold"                                                        â”‚    â”‚
â”‚  â”‚  pluralName: "Gold"                                                  â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  DISPLAY CONFIGURATION                                         â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ symbol: "G"             (1-3 characters)                â”‚  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ symbolPosition: "Before" (Before or After)              â”‚  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ color: "yellow"          (UI display color)             â”‚  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ decimalPlaces: 0         (0-4 decimal precision)        â”‚  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  CAPACITY CONFIGURATION (optional)                             â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ maxAmount: 999999        (optional cap limit)           â”‚  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ isTradeOnly: false       (can't be looted if true)      â”‚  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  EXCHANGE RATES (optional)                                     â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ exchangeRates: [                                        â”‚  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   { targetCurrencyId: "silver", rate: 10, bidir: true } â”‚  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   { targetCurrencyId: "gems", rate: 0.01, bidir: false }â”‚  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ ]                                                       â”‚  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  description: "Standard currency used throughout the realm"          â”‚    â”‚
â”‚  â”‚  sortOrder: 0                                                        â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Schema Validation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SCHEMA VALIDATION FLOW                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    User edits currency.json
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          IDE/EDITOR                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Reads $schema property from config file                                  â”‚
â”‚  2. Loads currency.schema.json from config/schemas/                          â”‚
â”‚  3. Validates content against schema                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â”€â”€ Valid â”€â”€â”€â–¶ Green checkmark, autocomplete works
           â”‚
           â””â”€â”€â”€ Invalid â”€â–¶ Error underlines with messages:
                           â€¢ "symbol must be 1-3 characters"
                           â€¢ "symbolPosition must be one of: Before, After"
                           â€¢ "decimalPlaces must be between 0 and 4"
                           â€¢ "rate must be >= 0.001"
```

### 3.3 Currency Display System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CURRENCY DISPLAY SYSTEM                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  SYMBOL POSITION OPTIONS                                                     â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  symbolPosition: "Before"          symbolPosition: "After"             â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  G100   (Gold: symbol before)      100G   (Gold: symbol after)         â”‚ â”‚
â”‚  â”‚  $50.00 (Credits: symbol before)   50CR   (Credits: symbol after)      â”‚ â”‚
â”‚  â”‚  ğŸ’10   (Gems: emoji before)       10ğŸ’   (Gems: emoji after)          â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  DECIMAL PLACES FORMATTING                                                   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  decimalPlaces: 0    â†’    G100, G1500, G25                             â”‚ â”‚
â”‚  â”‚  decimalPlaces: 1    â†’    G100.0, G1500.5, G25.7                       â”‚ â”‚
â”‚  â”‚  decimalPlaces: 2    â†’    $100.00, $1500.50, $25.75                    â”‚ â”‚
â”‚  â”‚  decimalPlaces: 3    â†’    â‚¿0.001, â‚¿1.500, â‚¿0.025                       â”‚ â”‚
â”‚  â”‚  decimalPlaces: 4    â†’    CR0.0001, CR1.5000, CR0.0025                 â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  COLOR CONFIGURATION                                                         â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Named Colors:           Hex Colors:                                   â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                â”‚ â”‚
â”‚  â”‚  "yellow"                "#FFD700" (Gold)                              â”‚ â”‚
â”‚  â”‚  "silver"                "#C0C0C0" (Silver)                            â”‚ â”‚
â”‚  â”‚  "bronze"                "#CD7F32" (Bronze)                            â”‚ â”‚
â”‚  â”‚  "cyan"                  "#00FFFF" (Gems)                              â”‚ â”‚
â”‚  â”‚  "green"                 "#00FF00" (Credits)                           â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 Exchange Rate System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EXCHANGE RATE SYSTEM                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  EXCHANGE RATE CONFIGURATION                                                 â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  In gold currency definition:                                         â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  "exchangeRates": [                                                   â”‚   â”‚
â”‚  â”‚    { "targetCurrencyId": "silver", "rate": 10, "bidirectional": true },â”‚  â”‚
â”‚  â”‚    { "targetCurrencyId": "copper", "rate": 100, "bidirectional": true }â”‚  â”‚
â”‚  â”‚  ]                                                                    â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  Meaning: 1 gold = 10 silver = 100 copper                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  EXCHANGE RATE CALCULATION                                                   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Forward Exchange (rate):                                              â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                             â”‚ â”‚
â”‚  â”‚  Player has: 5 gold                                                    â”‚ â”‚
â”‚  â”‚  Exchange to: silver                                                   â”‚ â”‚
â”‚  â”‚  Rate: 10                                                              â”‚ â”‚
â”‚  â”‚  Result: 5 Ã— 10 = 50 silver                                            â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Reverse Exchange (1/rate, if bidirectional):                          â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”‚ â”‚
â”‚  â”‚  Player has: 100 silver                                                â”‚ â”‚
â”‚  â”‚  Exchange to: gold                                                     â”‚ â”‚
â”‚  â”‚  Reverse Rate: 1/10 = 0.1                                              â”‚ â”‚
â”‚  â”‚  Result: 100 Ã— 0.1 = 10 gold                                           â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  BIDIRECTIONAL FLAG                                                          â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  bidirectional: true                bidirectional: false               â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Gold â—€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Silver             Gold â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Gems                â”‚ â”‚
â”‚  â”‚       (both ways)                        (one way only)                â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Use case: Standard                 Use case: Premium currency         â”‚ â”‚
â”‚  â”‚  currency conversions               that can be purchased but          â”‚ â”‚
â”‚  â”‚                                     not converted back                 â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  MULTI-TIER CURRENCY EXAMPLE                                                 â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚ â”‚
â”‚  â”‚                    â”‚  Gold  â”‚                                          â”‚ â”‚
â”‚  â”‚                    â”‚   G    â”‚                                          â”‚ â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                                          â”‚ â”‚
â”‚  â”‚                         â”‚ 1:10                                         â”‚ â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”                                          â”‚ â”‚
â”‚  â”‚                    â”‚ Silver â”‚                                          â”‚ â”‚
â”‚  â”‚                    â”‚   S    â”‚                                          â”‚ â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                                          â”‚ â”‚
â”‚  â”‚                         â”‚ 1:10                                         â”‚ â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”                                          â”‚ â”‚
â”‚  â”‚                    â”‚ Copper â”‚                                          â”‚ â”‚
â”‚  â”‚                    â”‚   C    â”‚                                          â”‚ â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  1 Gold = 10 Silver = 100 Copper                                       â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.5 Currency Capacity System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CURRENCY CAPACITY SYSTEM                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  MAXIMUM AMOUNT CAPS                                                         â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Currency        maxAmount       Behavior                              â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Gold            (not set)       No limit, can accumulate infinitely   â”‚ â”‚
â”‚  â”‚  Gems            999             Capped at 999, excess is lost         â”‚ â”‚
â”‚  â”‚  Arena Tokens    100             Limited resource, spend or lose       â”‚ â”‚
â”‚  â”‚  Bank Vault      9999999         Very high cap for storage             â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  TRADE-ONLY FLAG                                                             â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  isTradeOnly: false (default)     isTradeOnly: true                    â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â€¢ Drops from enemies             â€¢ Never drops from enemies           â”‚ â”‚
â”‚  â”‚  â€¢ Found in chests                â€¢ Not found in chests                â”‚ â”‚
â”‚  â”‚  â€¢ Rewarded from quests           â€¢ Only from specific quests          â”‚ â”‚
â”‚  â”‚  â€¢ Can be traded with NPCs        â€¢ Can be traded with NPCs            â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Example: Gold, Silver            Example: Faction Tokens,             â”‚ â”‚
â”‚  â”‚                                   Premium Gems, Event Currency         â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.6 File Layer Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            CONFIG LAYER                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  config/                                                                     â”‚
â”‚  â”œâ”€â”€ currency.json â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚   {                                           â”‚ references                â”‚
â”‚  â”‚     "$schema": "./schemas/currency.schema.json",                          â”‚
â”‚  â”‚     "currencies": [                           â”‚                           â”‚
â”‚  â”‚       {                                       â”‚                           â”‚
â”‚  â”‚         "id": "gold",                         â”‚                           â”‚
â”‚  â”‚         "name": "Gold",                       â”‚                           â”‚
â”‚  â”‚         "pluralName": "Gold",                 â”‚                           â”‚
â”‚  â”‚         "symbol": "G",                        â”‚                           â”‚
â”‚  â”‚         "symbolPosition": "Before",           â”‚                           â”‚
â”‚  â”‚         "color": "yellow",                    â”‚                           â”‚
â”‚  â”‚         "decimalPlaces": 0,                   â”‚                           â”‚
â”‚  â”‚         "exchangeRates": [                    â”‚                           â”‚
â”‚  â”‚           {"targetCurrencyId": "silver", ...} â”‚ â†’ other currencies        â”‚
â”‚  â”‚         ],                                    â”‚                           â”‚
â”‚  â”‚         "sortOrder": 0                        â”‚                           â”‚
â”‚  â”‚       },                                      â”‚                           â”‚
â”‚  â”‚       ...                                     â”‚                           â”‚
â”‚  â”‚     ]                                         â”‚                           â”‚
â”‚  â”‚   }                                           â”‚                           â”‚
â”‚  â”‚                                               â”‚                           â”‚
â”‚  â”œâ”€â”€ vendors.json (references currencies, v0.14.5d)                         â”‚
â”‚  â”‚                                               â”‚                           â”‚
â”‚  â””â”€â”€ schemas/                                    â”‚                           â”‚
â”‚      â””â”€â”€ currency.schema.json â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚          {                                                                   â”‚
â”‚            "$schema": "http://json-schema.org/draft-07/schema#",            â”‚
â”‚            "definitions": {                                                  â”‚
â”‚              "CurrencyDefinition": {...},                                    â”‚
â”‚              "ExchangeRate": {...}                                           â”‚
â”‚            }                                                                 â”‚
â”‚          }                                                                   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Currency Schema Root Definition

### 4.1 Root Configuration Properties

**File:** `config/schemas/currency.schema.json`

The currency schema follows JSON Schema Draft-07 specification, providing comprehensive validation for currency configuration files.

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Currency Configuration",
    "description": "Schema for currency definitions including display formatting, exchange rates, capacity limits, and visual representation.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+$"
        },
        "currencies": {
            "type": "array",
            "description": "List of currency definitions",
            "items": {
                "$ref": "#/definitions/CurrencyDefinition"
            },
            "minItems": 1
        }
    },
    "required": ["currencies"],
    "additionalProperties": false,
    "definitions": {
        "CurrencyDefinition": { ... },
        "ExchangeRate": { ... }
    }
}
```

### 4.2 CurrencyDefinition Schema

The `CurrencyDefinition` object defines a complete currency with all its display and exchange properties.

```json
"CurrencyDefinition": {
    "type": "object",
    "description": "A currency definition with display formatting, exchange rates, and capacity limits",
    "properties": {
        "id": {
            "type": "string",
            "description": "Unique identifier for the currency (lowercase kebab-case)",
            "pattern": "^[a-z][a-z0-9-]*$",
            "minLength": 1,
            "maxLength": 50
        },
        "name": {
            "type": "string",
            "description": "Display name for the currency (singular form)",
            "minLength": 1,
            "maxLength": 50
        },
        "pluralName": {
            "type": "string",
            "description": "Plural form of the currency name (defaults to name if not specified)",
            "minLength": 1,
            "maxLength": 50
        },
        "symbol": {
            "type": "string",
            "description": "Symbol displayed with amounts (1-3 characters, can include emoji)",
            "minLength": 1,
            "maxLength": 3
        },
        "symbolPosition": {
            "type": "string",
            "description": "Whether the symbol appears before or after the amount",
            "enum": ["Before", "After"],
            "default": "Before"
        },
        "color": {
            "type": "string",
            "description": "Color for UI display (named color or hex code)",
            "minLength": 1
        },
        "decimalPlaces": {
            "type": "integer",
            "description": "Number of decimal places for display (0-4)",
            "minimum": 0,
            "maximum": 4,
            "default": 0
        },
        "maxAmount": {
            "type": "integer",
            "description": "Maximum amount a player can carry (optional, no limit if not specified)",
            "minimum": 1
        },
        "exchangeRates": {
            "type": "array",
            "description": "Exchange rates to other currencies",
            "items": {
                "$ref": "#/definitions/ExchangeRate"
            }
        },
        "isTradeOnly": {
            "type": "boolean",
            "description": "If true, this currency cannot be looted from enemies or found in the world",
            "default": false
        },
        "description": {
            "type": "string",
            "description": "Optional flavor text describing the currency"
        },
        "sortOrder": {
            "type": "integer",
            "description": "Order for display sorting (lower values first)",
            "minimum": 0,
            "default": 0
        }
    },
    "required": ["id", "name", "symbol", "color"],
    "additionalProperties": false
}
```

---

## 5. Display Configuration

### 5.1 Symbol Configuration

The `symbol` field defines the character(s) displayed with currency amounts.

**Validation:**
```json
"symbol": {
    "type": "string",
    "description": "Symbol displayed with amounts (1-3 characters, can include emoji)",
    "minLength": 1,
    "maxLength": 3
}
```

**Symbol Examples:**

| Currency | Symbol | Length | Display Example |
|----------|--------|--------|-----------------|
| Gold | `G` | 1 | G100 |
| Silver | `S` | 1 | S500 |
| Copper | `C` | 1 | C1500 |
| Credits | `CR` | 2 | CR1000 |
| Dollars | `$` | 1 | $50.00 |
| Gems | `ğŸ’` | 1 (emoji) | ğŸ’25 |
| Bitcoin | `â‚¿` | 1 | â‚¿0.001 |

### 5.2 Symbol Position Enumeration

The `symbolPosition` field defines whether the symbol appears before or after the amount.

```json
"symbolPosition": {
    "type": "string",
    "description": "Whether the symbol appears before or after the amount",
    "enum": ["Before", "After"],
    "default": "Before"
}
```

| Position | Description | Example |
|----------|-------------|---------|
| `Before` | Symbol precedes amount (default) | G100, $50.00, ğŸ’25 |
| `After` | Symbol follows amount | 100G, 50.00$, 25ğŸ’ |

**Regional Considerations:**

| Region/Convention | Typical Position | Example |
|-------------------|------------------|---------|
| US Dollar | Before | $100 |
| Euro (France) | After | 100â‚¬ |
| Euro (Germany) | Before | â‚¬100 |
| Japanese Yen | Before | Â¥1000 |
| Fantasy Gold | Before or After | G100 or 100G |

### 5.3 Decimal Places

The `decimalPlaces` field defines precision for displaying fractional currency amounts.

```json
"decimalPlaces": {
    "type": "integer",
    "description": "Number of decimal places for display (0-4)",
    "minimum": 0,
    "maximum": 4,
    "default": 0
}
```

| Decimal Places | Use Case | Display Examples |
|----------------|----------|------------------|
| 0 | Whole number currencies (gold, silver) | 100, 1500, 25 |
| 1 | Simple fractions | 100.0, 1500.5, 25.7 |
| 2 | Standard monetary (dollars, credits) | 100.00, 1500.50, 25.75 |
| 3 | Fine precision (crypto-like) | 0.001, 1.500, 0.025 |
| 4 | Ultra precision (micro-transactions) | 0.0001, 1.5000, 0.0025 |

### 5.4 Color Configuration

The `color` field defines the display color for UI elements.

```json
"color": {
    "type": "string",
    "description": "Color for UI display (named color or hex code)",
    "minLength": 1
}
```

**Supported Formats:**

| Format | Example | Description |
|--------|---------|-------------|
| Named Color | `"yellow"` | CSS named color |
| Hex (6-digit) | `"#FFD700"` | RGB hex code |
| Hex (3-digit) | `"#FD0"` | Shorthand RGB |

**Common Currency Colors:**

| Currency Type | Suggested Color | Hex |
|---------------|-----------------|-----|
| Gold | `"yellow"` or `"#FFD700"` | #FFD700 |
| Silver | `"silver"` or `"#C0C0C0"` | #C0C0C0 |
| Copper | `"#CD7F32"` | #CD7F32 |
| Gems/Premium | `"cyan"` or `"#00FFFF"` | #00FFFF |
| Credits | `"green"` or `"#00FF00"` | #00FF00 |
| Faction Tokens | `"purple"` or `"#800080"` | #800080 |

---

## 6. Exchange Rate Configuration

### 6.1 ExchangeRate Definition

The `ExchangeRate` object defines conversion rules between currencies.

```json
"ExchangeRate": {
    "type": "object",
    "description": "Exchange rate to another currency",
    "properties": {
        "targetCurrencyId": {
            "type": "string",
            "description": "ID of the currency to exchange to",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "rate": {
            "type": "number",
            "description": "Exchange rate (1 of this currency = rate of target currency)",
            "minimum": 0.001
        },
        "bidirectional": {
            "type": "boolean",
            "description": "Whether the exchange can go both ways",
            "default": true
        }
    },
    "required": ["targetCurrencyId", "rate"],
    "additionalProperties": false
}
```

### 6.2 Exchange Rate Calculation

**Forward Exchange:**
```
Target Amount = Source Amount Ã— Rate
```

**Example:**
- Source: 5 Gold
- Target: Silver
- Rate: 10 (1 gold = 10 silver)
- Result: 5 Ã— 10 = 50 Silver

**Reverse Exchange (if bidirectional):**
```
Source Amount = Target Amount Ã— (1 / Rate)
```

**Example:**
- Source: 100 Silver
- Target: Gold
- Reverse Rate: 1/10 = 0.1
- Result: 100 Ã— 0.1 = 10 Gold

### 6.3 Bidirectional Exchanges

| `bidirectional` | Behavior |
|-----------------|----------|
| `true` (default) | Player can convert in both directions |
| `false` | Player can only convert from this currency to target, not reverse |

**Use Cases for Non-Bidirectional:**

| Scenario | Configuration |
|----------|---------------|
| Premium currency purchase | Gold â†’ Gems (bidirectional: false) |
| Event token conversion | Event Tokens â†’ Gold (bidirectional: false) |
| One-way upgrade | Basic Coins â†’ Advanced Coins (bidirectional: false) |

**Example Configuration:**
```json
{
    "id": "gold",
    "name": "Gold",
    "exchangeRates": [
        {
            "targetCurrencyId": "silver",
            "rate": 10,
            "bidirectional": true
        },
        {
            "targetCurrencyId": "gems",
            "rate": 0.01,
            "bidirectional": false
        }
    ]
}
```

In this example:
- 1 Gold = 10 Silver (can convert both ways)
- 100 Gold = 1 Gem (can only buy gems with gold, cannot sell gems for gold)

---

## 7. Capacity Configuration

### 7.1 Maximum Amount Caps

The optional `maxAmount` field limits how much of a currency a player can hold.

```json
"maxAmount": {
    "type": "integer",
    "description": "Maximum amount a player can carry (optional, no limit if not specified)",
    "minimum": 1
}
```

**Cap Behavior:**

| Scenario | Behavior |
|----------|----------|
| `maxAmount` not set | No limit, currency can accumulate indefinitely |
| `maxAmount` set | Excess currency is discarded when cap is reached |
| Cap reached during loot | Player receives notification, excess lost |
| Cap reached during exchange | Exchange blocked or partial |

**Example Configurations:**

| Currency | maxAmount | Use Case |
|----------|-----------|----------|
| Gold | (not set) | Main currency, no cap needed |
| Gems | 999 | Premium currency with scarcity |
| Arena Tokens | 100 | Weekly capped resource |
| Event Currency | 5000 | Event-specific cap |

### 7.2 Trade-Only Currencies

The `isTradeOnly` flag restricts how a currency can be obtained.

```json
"isTradeOnly": {
    "type": "boolean",
    "description": "If true, this currency cannot be looted from enemies or found in the world",
    "default": false
}
```

**Trade-Only Restrictions:**

| Source | isTradeOnly: false | isTradeOnly: true |
|--------|-------------------|-------------------|
| Enemy drops | âœ… Allowed | âŒ Blocked |
| Chest loot | âœ… Allowed | âŒ Blocked |
| Quest rewards | âœ… Allowed | âœ… Allowed (if quest specifies) |
| Vendor trades | âœ… Allowed | âœ… Allowed |
| Currency exchange | âœ… Allowed | âœ… Allowed (if rates defined) |

**Use Cases:**

| Currency | isTradeOnly | Reason |
|----------|-------------|--------|
| Gold | false | Standard lootable currency |
| Faction Reputation | true | Only earned from faction activities |
| Premium Gems | true | Only from real-money or special quests |
| Event Tokens | true | Only from event participation |

---

## 8. Validation Rules

### 8.1 ID Pattern Validation

| Property | Pattern | Description |
|----------|---------|-------------|
| `CurrencyDefinition.id` | `^[a-z][a-z0-9-]*$` | Lowercase letters, numbers, hyphens |
| `ExchangeRate.targetCurrencyId` | `^[a-z][a-z0-9-]*$` | Must reference valid currency |

**Valid IDs:**
- `gold`
- `silver`
- `copper`
- `arena-tokens`
- `premium-gems`

**Invalid IDs:**
- `Gold` (uppercase)
- `123gold` (starts with number)
- `gold_coins` (underscore not allowed)
- `gold coins` (space not allowed)

### 8.2 Range Validation

| Property | Range | Validation Error |
|----------|-------|------------------|
| `symbol` | 1-3 chars | "symbol must be 1-3 characters" |
| `decimalPlaces` | 0-4 | "decimalPlaces must be between 0 and 4" |
| `rate` | >= 0.001 | "rate must be >= 0.001" |
| `maxAmount` | >= 1 | "maxAmount must be >= 1" |
| `sortOrder` | >= 0 | "sortOrder must be >= 0" |

### 8.3 Required Fields

| Definition | Required Fields |
|------------|-----------------|
| `CurrencyDefinition` | id, name, symbol, color |
| `ExchangeRate` | targetCurrencyId, rate |

### 8.4 Enum Validation

| Enum | Values |
|------|--------|
| `symbolPosition` | Before, After |

---

## 9. Configuration Schema

### Complete Currency Schema File

**File:** `config/schemas/currency.schema.json`

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Currency Configuration",
    "description": "Schema for currency definitions including display formatting, exchange rates, capacity limits, and visual representation.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+$"
        },
        "currencies": {
            "type": "array",
            "description": "List of currency definitions",
            "items": {
                "$ref": "#/definitions/CurrencyDefinition"
            },
            "minItems": 1
        }
    },
    "required": ["currencies"],
    "additionalProperties": false,
    "definitions": {
        "CurrencyDefinition": {
            "type": "object",
            "description": "A currency definition with display formatting, exchange rates, and capacity limits",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique identifier for the currency (lowercase kebab-case)",
                    "pattern": "^[a-z][a-z0-9-]*$",
                    "minLength": 1,
                    "maxLength": 50
                },
                "name": {
                    "type": "string",
                    "description": "Display name for the currency (singular form)",
                    "minLength": 1,
                    "maxLength": 50
                },
                "pluralName": {
                    "type": "string",
                    "description": "Plural form of the currency name (defaults to name if not specified)",
                    "minLength": 1,
                    "maxLength": 50
                },
                "symbol": {
                    "type": "string",
                    "description": "Symbol displayed with amounts (1-3 characters, can include emoji)",
                    "minLength": 1,
                    "maxLength": 3
                },
                "symbolPosition": {
                    "type": "string",
                    "description": "Whether the symbol appears before or after the amount",
                    "enum": ["Before", "After"],
                    "default": "Before"
                },
                "color": {
                    "type": "string",
                    "description": "Color for UI display (named color or hex code)",
                    "minLength": 1
                },
                "decimalPlaces": {
                    "type": "integer",
                    "description": "Number of decimal places for display (0-4)",
                    "minimum": 0,
                    "maximum": 4,
                    "default": 0
                },
                "maxAmount": {
                    "type": "integer",
                    "description": "Maximum amount a player can carry (optional, no limit if not specified)",
                    "minimum": 1
                },
                "exchangeRates": {
                    "type": "array",
                    "description": "Exchange rates to other currencies",
                    "items": {
                        "$ref": "#/definitions/ExchangeRate"
                    }
                },
                "isTradeOnly": {
                    "type": "boolean",
                    "description": "If true, this currency cannot be looted from enemies or found in the world",
                    "default": false
                },
                "description": {
                    "type": "string",
                    "description": "Optional flavor text describing the currency"
                },
                "sortOrder": {
                    "type": "integer",
                    "description": "Order for display sorting (lower values first)",
                    "minimum": 0,
                    "default": 0
                }
            },
            "required": ["id", "name", "symbol", "color"],
            "additionalProperties": false
        },
        "ExchangeRate": {
            "type": "object",
            "description": "Exchange rate to another currency",
            "properties": {
                "targetCurrencyId": {
                    "type": "string",
                    "description": "ID of the currency to exchange to",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "rate": {
                    "type": "number",
                    "description": "Exchange rate (1 of this currency = rate of target currency)",
                    "minimum": 0.001
                },
                "bidirectional": {
                    "type": "boolean",
                    "description": "Whether the exchange can go both ways",
                    "default": true
                }
            },
            "required": ["targetCurrencyId", "rate"],
            "additionalProperties": false
        }
    }
}
```

---

## 10. Configuration File Updates

### Updated currency.json

Update the existing `currency.json` to include the schema reference and demonstrate the expanded capabilities.

**File:** `config/currency.json`

```json
{
    "$schema": "./schemas/currency.schema.json",
    "currencies": [
        {
            "id": "gold",
            "name": "Gold",
            "pluralName": "Gold",
            "symbol": "G",
            "symbolPosition": "Before",
            "color": "yellow",
            "decimalPlaces": 0,
            "description": "The standard currency used throughout the realm",
            "sortOrder": 0
        },
        {
            "id": "silver",
            "name": "Silver",
            "pluralName": "Silver",
            "symbol": "S",
            "symbolPosition": "Before",
            "color": "silver",
            "decimalPlaces": 0,
            "description": "Common currency for everyday transactions",
            "sortOrder": 1
        },
        {
            "id": "copper",
            "name": "Copper",
            "pluralName": "Copper",
            "symbol": "C",
            "symbolPosition": "Before",
            "color": "#CD7F32",
            "decimalPlaces": 0,
            "description": "The most basic currency denomination",
            "sortOrder": 2
        },
        {
            "id": "gems",
            "name": "Gem",
            "pluralName": "Gems",
            "symbol": "ğŸ’",
            "symbolPosition": "After",
            "color": "cyan",
            "decimalPlaces": 0,
            "maxAmount": 999,
            "isTradeOnly": true,
            "description": "Rare premium currency for special purchases",
            "sortOrder": 3
        }
    ]
}
```

### Backward Compatibility

The existing `currency.json` structure is preserved. All new properties are optional, ensuring the current single-currency configuration remains valid:

| Property | Existing | New Schema | Backward Compatible |
|----------|----------|------------|---------------------|
| `id` | âœ… Required | âœ… Required | âœ… Yes |
| `name` | âœ… Required | âœ… Required | âœ… Yes |
| `pluralName` | âœ… Present | Optional | âœ… Yes |
| `symbol` | âœ… Present | âœ… Required | âœ… Yes |
| `color` | âœ… Present | âœ… Required | âœ… Yes |
| `sortOrder` | âœ… Present | Optional | âœ… Yes |
| `symbolPosition` | âŒ New | Optional | âœ… Yes (default: Before) |
| `decimalPlaces` | âŒ New | Optional | âœ… Yes (default: 0) |
| `maxAmount` | âŒ New | Optional | âœ… Yes (no limit) |
| `exchangeRates` | âŒ New | Optional | âœ… Yes (no exchanges) |
| `isTradeOnly` | âŒ New | Optional | âœ… Yes (default: false) |
| `description` | âŒ New | Optional | âœ… Yes |

---

## 11. Data Model Changes

### No Domain Changes Required

This phase creates only a JSON Schema file and updates the configuration file reference. No changes to domain entities, services, or application layer are required.

| Layer | Changes |
|-------|---------|
| Domain | None |
| Application | None |
| Infrastructure | None |
| Configuration | One schema file added, one config file updated with $schema reference |

### Schema as Documentation

The schema serves as:
- **Validation contract** for currency configuration
- **IDE documentation** via description fields
- **Modding reference** for custom currency creation
- **Design specification** for currency mechanics

---

## 12. Logging Specifications

### No Runtime Logging Required

Schema validation occurs at design-time in IDE/editors, not at runtime. No logging infrastructure changes are needed for this phase.

| Component | Level | Events |
|-----------|-------|--------|
| N/A | N/A | Schema validation is IDE-based |

---

## 13. Unit Testing Requirements

### Test Count by Feature

| Feature | Test Count |
|---------|------------|
| Schema Valid Structure | ~1 |
| Symbol Validation | ~1 |
| Exchange Rate Validation | ~1 |
| Configuration File Validation | ~1 |
| **Total** | **~4** |

### Test Descriptions

#### CurrencySchemaTests.cs

```csharp
[TestFixture]
public class CurrencySchemaTests
{
    /// <summary>
    /// Verifies the schema file is valid JSON Schema Draft-07.
    /// </summary>
    [Test]
    public void Schema_IsValidJsonSchemaDraft07();

    /// <summary>
    /// Verifies the currency.json validates against the schema without errors.
    /// </summary>
    [Test]
    public void CurrencyJson_ValidatesAgainstSchema();

    /// <summary>
    /// Verifies symbol must be 1-3 characters.
    /// </summary>
    [Test]
    public void Symbol_TooLong_FailsValidation();

    /// <summary>
    /// Verifies exchange rate must be >= 0.001.
    /// </summary>
    [Test]
    public void ExchangeRate_TooLow_FailsValidation();
}
```

### Test Implementation Notes

Tests should use a JSON Schema validation library (e.g., `NJsonSchema` for C#) to:
1. Load the schema file
2. Validate test JSON documents
3. Assert expected validation results

---

## 14. Use Cases

### UC-001: Load Currency Configuration

**Actor:** Game System
**Flow:** System starts â†’ Loads `currency.json` â†’ Schema validates content â†’ Currencies available for economy system

### UC-002: Edit Currencies in IDE

**Actor:** Developer/Modder
**Flow:** Opens `currency.json` in VS Code â†’ IDE loads schema â†’ Autocomplete suggests properties â†’ Validation errors shown inline

### UC-003: Add New Currency

**Actor:** Modder
**Flow:** Adds new currency object to `currencies` array â†’ Sets id, name, symbol, color â†’ Optionally configures exchangeRates â†’ IDE validates structure

### UC-004: Configure Exchange Rates

**Actor:** Modder
**Flow:** Adds exchangeRates array to currency â†’ Defines targetCurrencyId and rate â†’ Sets bidirectional flag â†’ IDE validates rate >= 0.001

### UC-005: Set Currency Cap

**Actor:** Modder
**Flow:** Adds maxAmount to currency definition â†’ Sets positive integer value â†’ System enforces cap during gameplay

### UC-006: Invalid Symbol Length

**Actor:** Modder
**Flow:** Sets symbol to "GOLD" (4 characters) â†’ IDE shows error "symbol must be 1-3 characters" â†’ Modder corrects to valid value

---

## 15. Deliverable Checklist

### Schema Files
- [ ] `config/schemas/currency.schema.json` created
- [ ] Schema follows JSON Schema Draft-07 format
- [ ] Schema includes all 2 definitions (CurrencyDefinition, ExchangeRate)

### Validation Rules
- [ ] Currency ID pattern validation: `^[a-z][a-z0-9-]*$`
- [ ] Symbol length validation (1-3 characters)
- [ ] Symbol position enum validation (Before, After)
- [ ] Decimal places validation (0-4)
- [ ] Exchange rate minimum validation (>= 0.001)
- [ ] Max amount validation (>= 1, optional)
- [ ] Required fields enforced for all definitions

### Configuration Files
- [ ] `currency.json` updated with $schema reference
- [ ] Existing currency (gold) validates against schema

### Testing
- [ ] ~4 unit tests implemented
- [ ] All tests passing
- [ ] Tests cover happy path and error cases

### Documentation
- [ ] Schema properties have descriptions
- [ ] This design specification complete

---

## 16. Acceptance Criteria

### Functional
- [ ] `currency.schema.json` created in `config/schemas/` directory
- [ ] Schema validates existing `currency.json` without errors
- [ ] ID pattern validated (lowercase kebab-case)
- [ ] Symbol validated (1-3 characters)
- [ ] Symbol position enum validated (Before, After)
- [ ] Decimal places validated (0-4 range)
- [ ] Exchange rates validated with target currency reference
- [ ] Exchange rate minimum validated (>= 0.001)
- [ ] Max amount validated as optional positive integer
- [ ] VS Code provides autocomplete when schema linked

### Quality
- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] ~4 unit tests pass
- [ ] Schema file is valid JSON
- [ ] All schema properties have descriptions

---

## 17. Dependencies

### Required from Prior Versions

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| None | N/A | Currency schema is independent |

### Provides to Future Versions

| Type | Usage |
|------|-------|
| `currency.schema.json` | Validates currency configuration |
| Currency IDs | Referenced by vendors.json (v0.14.5d) |
| Currency IDs | Referenced by loot-tables.json (future) |
| Exchange rate pattern | Reusable for other conversion systems |

### Implementation Order Note

**v0.14.5a can be implemented in parallel with v0.14.5b** as they have no internal dependencies. v0.14.5c and v0.14.5d may reference currency IDs.

---

## 18. Future Considerations

### Deferred to Future Versions

- **Cross-reference validation**: Validating targetCurrencyId exists in currencies array
- **Circular exchange detection**: Preventing exchange rate loops
- **Currency transaction logic**: Runtime buy/sell/exchange operations
- **Bank/storage systems**: Separate storage with different caps

### Out of Scope

- **Resource schema** (v0.14.5b) - Class resources like mana, rage
- **Recipe schema** (v0.14.5c) - Crafting material costs
- **Vendor schema** (v0.14.5d) - Shop pricing and accepted currencies
- **Runtime currency operations**: Application-level transactions (domain logic)
- **Currency balance tuning**: Specific exchange rates (design decisions)

### Potential Future Enhancements

If the currency system expands, consider adding to the schema:

**Currency Categories:**
```json
"category": {
    "type": "string",
    "description": "Category grouping for related currencies",
    "enum": ["Standard", "Premium", "Faction", "Event", "Crafting"]
}
```

**Conversion Fees:**
```json
"conversionFee": {
    "type": "number",
    "description": "Percentage fee taken during currency exchange (0.0 to 1.0)",
    "minimum": 0,
    "maximum": 1,
    "default": 0
}
```

**Time-Limited Currencies:**
```json
"expirationDays": {
    "type": "integer",
    "description": "Number of days until currency expires (event currencies)",
    "minimum": 1
}
```

**Reputation Requirements:**
```json
"requiredReputation": {
    "type": "object",
    "description": "Faction reputation required to use this currency",
    "properties": {
        "factionId": { "type": "string" },
        "minimumLevel": { "type": "integer" }
    }
}
```

**Interest/Decay:**
```json
"dailyInterest": {
    "type": "number",
    "description": "Daily interest rate for banked currency (-1 to 1, negative for decay)",
    "minimum": -1,
    "maximum": 1
}
```

**Display Icons:**
```json
"iconId": {
    "type": "string",
    "description": "Reference to icon asset for UI display",
    "pattern": "^[a-z][a-z0-9-]*$"
}
```

**Localization Keys:**
```json
"localizationKey": {
    "type": "string",
    "description": "Key for localized currency names",
    "pattern": "^[A-Z][A-Z0-9_]*$"
}
```

---

*Document Version: 1.0*
*Last Updated: 2026-01-17*
*Author: Claude*
