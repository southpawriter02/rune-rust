# v0.15.6b - Three-Layer Examination System

**Release Date:** 2026-01-26

## Summary

Implements the **Three-Layer Examination System** Domain value objects and persistence interfaces. This version adds the foundational types for progressive depth examination based on WITS checks.

## Layer System

| Layer | Name     | DC Required | Information Depth                      |
| ----- | -------- | ----------- | -------------------------------------- |
| 1     | Cursory  | 0 (auto)    | Basic visual, obvious features         |
| 2     | Detailed | 12          | Functional details, condition, hints   |
| 3     | Expert   | 18          | Historical context, secrets, solutions |

## Added

### Value Objects (Domain)

| Value Object         | Purpose                                                         |
| -------------------- | --------------------------------------------------------------- |
| `ExaminationContext` | Encapsulates examination check parameters with history tracking |
| `ExaminationResult`  | Complete examination outcome with composite description         |

### Entities (Domain)

| Entity             | Purpose                                        |
| ------------------ | ---------------------------------------------- |
| `ExaminationState` | Persists character-object examination progress |

### Interfaces (Application)

| Interface                     | Purpose                                               |
| ----------------------------- | ----------------------------------------------------- |
| `IExaminationStateRepository` | Repository contract for examination state persistence |

## Key Features

### ExaminationContext

- Factory methods: `FirstExamination()`, `WithHistory()`
- Helper properties: `HasPreviousExamination`, `HasDetailedKnowledge`, `HasExpertKnowledge`
- `NextLayerDc` property returns 0/12/18/-1 based on current knowledge

### ExaminationResult

- Factory methods: `CursoryOnly()`, `Create()`
- Composite description generation combining unlocked layers
- Hint and interaction tracking (for v0.15.6e integration)
- Summary string formatting for display

### ExaminationState

- Non-regressing layer updates (layers never go down)
- Timestamp tracking (`FirstExaminedAt`, `LastExaminedAt`)

## Tests Added

| Test Class                | Test Count | Coverage                                                   |
| ------------------------- | ---------- | ---------------------------------------------------------- |
| `ExaminationContextTests` | 10         | Factory methods, NextLayerDc, validation                   |
| `ExaminationResultTests`  | 12         | Layer unlocking, composite description, summary formatting |

## Existing Components (from prior versions)

- `ExaminationLayer` enum (Cursory=1, Detailed=2, Expert=3)
- `IExaminationService` with `ExamineObjectAsync()`, `CheckPassivePerceptionAsync()`, etc.
- `ExaminationService` implementation
- `ExaminationResultDto`, `LayerTextDto` DTOs

## Related Design Specification

- [v0.15.6b Design Specification](../design/v0.15.x/v0.15.6b-design-specification.md)
