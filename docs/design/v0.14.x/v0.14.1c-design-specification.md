# v0.14.1c Design Specification: Damage Type Schema

**Version:** 0.14.1c
**Parent:** v0.14.1 (Combat Configuration Schemas)
**Prerequisites:** v0.14.0 Complete (Character Configuration Schemas)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Damage Type Schema Definition](#4-damage-type-schema-definition)
   - 4.1 [Root Configuration Properties](#41-root-configuration-properties)
   - 4.2 [DamageCategory Definition](#42-damagecategory-definition)
   - 4.3 [DamageType Definition](#43-damagetype-definition)
   - 4.4 [DamageRelationship Definition](#44-damagerelationship-definition)
   - 4.5 [ResistanceTemplate Definition](#45-resistancetemplate-definition)
   - 4.6 [ResistanceEntry Definition](#46-resistanceentry-definition)
5. [Damage Category Configuration](#5-damage-category-configuration)
   - 5.1 [Category Types](#51-category-types)
   - 5.2 [Category Usage](#52-category-usage)
6. [Resistance System Configuration](#6-resistance-system-configuration)
   - 6.1 [Resistance Value Ranges](#61-resistance-value-ranges)
   - 6.2 [Immunity and Absorption](#62-immunity-and-absorption)
   - 6.3 [Resistance Templates](#63-resistance-templates)
7. [Damage Type Relationships](#7-damage-type-relationships)
   - 7.1 [Relationship Types](#71-relationship-types)
   - 7.2 [Relationship Modifiers](#72-relationship-modifiers)
8. [Validation Rules](#8-validation-rules)
   - 8.1 [Enum Validation](#81-enum-validation)
   - 8.2 [Range Validation](#82-range-validation)
   - 8.3 [Required Fields](#83-required-fields)
   - 8.4 [Pattern Validation](#84-pattern-validation)
9. [Configuration Schema](#9-configuration-schema)
10. [Configuration File Updates](#10-configuration-file-updates)
11. [Data Model Changes](#11-data-model-changes)
12. [Logging Specifications](#12-logging-specifications)
13. [Unit Testing Requirements](#13-unit-testing-requirements)
14. [Use Cases](#14-use-cases)
15. [Deliverable Checklist](#15-deliverable-checklist)
16. [Acceptance Criteria](#16-acceptance-criteria)
17. [Dependencies](#17-dependencies)
18. [Future Considerations](#18-future-considerations)

---

## 1. Executive Summary

Version 0.14.1c introduces the **Damage Type Schema** (`damage-types.schema.json`), which validates damage type configuration including damage categories, resistance/vulnerability modifiers, immunity definitions, absorption mechanics, damage type relationships, and resistance templates for creature types. This schema enables full customization of the damage system without code changes, supporting different combat balancing, elemental systems, and creature-specific resistances.

The Damage Type Schema validates damage categories (Physical, Elemental, Magical, Special), resistance values (-100 to 100), immunity and absorption flags, damage type relationships (Strong, Weak, Neutral, Nullifies), and resistance templates for common creature types like undead, constructs, and elementals.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Schema Files** | `damage-types.schema.json` |
| **Schema Definitions** | `DamageCategory`, `DamageType`, `DamageRelationship`, `ResistanceTemplate`, `ResistanceEntry` |
| **Configuration Updates** | Update `damage-types.json` with schema reference, categories, and templates |
| **Tests** | ~8 new unit tests |

### Architectural Significance

This version provides:
- **Damage category system** - Grouping damage types into logical categories
- **Resistance value pattern** - Unified -100 to 100 scale for resistances and vulnerabilities
- **Immunity flag pattern** - Complete immunity that cannot be reduced by effects
- **Absorption pattern** - Damage that heals instead of harming
- **Relationship system** - Damage type interactions (fire strong vs ice)
- **Resistance templates** - Reusable resistance profiles for creature types
- **Visual/audio associations** - Color, VFX, and SFX references for damage types

### Relationship to Other Schemas

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     v0.14.1 COMBAT CONFIGURATION SCHEMAS                     │
└─────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────┐
  │  v0.14.1a: abilities.schema.json (expanded)                              │
  │  v0.14.1b: status-effects.schema.json                                    │
  │  v0.14.1c: damage-types.schema.json ◀── THIS VERSION                     │
  │  v0.14.1d: combat.schema.json                                            │
  └─────────────────────────────────────────────────────────────────────────┘

  Cross-references:
  • status-effects.json → damageType field references damage-types.json
  • abilities.json → damage effects reference damage types
  • monsters.json → baseResistances/resistanceTemplateId reference this schema

  All schemas share:
  • JSON Schema Draft-07 format
  • ID pattern: ^[a-z][a-z0-9-]*$
  • Schema location: config/schemas/
  • Required field enforcement
  • IDE autocomplete support
```

---

## 2. Feature Overview

```
v0.14.1c Damage Type Schema Features
├── damage-types.schema.json
│   ├── Root Configuration Properties
│   │   ├── $schema (string, optional)
│   │   ├── version (string, optional)
│   │   ├── damageCategories (array of DamageCategory)
│   │   ├── damageTypes (array of DamageType, required)
│   │   └── resistanceTemplates (array of ResistanceTemplate)
│   └── Definitions
│       ├── DamageCategory
│       │   ├── id (string, kebab-case pattern, required)
│       │   ├── name (string, minLength: 1, required)
│       │   ├── description (string)
│       │   └── sortOrder (integer, minimum: 0)
│       ├── DamageType
│       │   ├── id (string, kebab-case pattern, required)
│       │   ├── name (string, minLength: 1, required)
│       │   ├── description (string, required)
│       │   ├── categoryId (string, references DamageCategory)
│       │   ├── color (string, required)
│       │   ├── iconId (string, optional)
│       │   ├── vfxId (string, optional)
│       │   ├── sfxId (string, optional)
│       │   ├── bypassesArmor (boolean, default: false)
│       │   ├── canCrit (boolean, default: true)
│       │   ├── relationships (array of DamageRelationship)
│       │   └── sortOrder (integer, minimum: 0)
│       ├── DamageRelationship
│       │   ├── targetTypeId (string, required)
│       │   ├── relationship (enum: Strong, Weak, Neutral, Nullifies)
│       │   └── modifier (number, 0.0 to 3.0)
│       ├── ResistanceTemplate
│       │   ├── id (string, kebab-case pattern, required)
│       │   ├── name (string, minLength: 1, required)
│       │   ├── description (string)
│       │   ├── creatureTypes (array of string, required)
│       │   └── resistances (array of ResistanceEntry, required)
│       └── ResistanceEntry
│           ├── damageTypeId (string, required)
│           ├── value (integer, -100 to 100, required)
│           ├── isImmunity (boolean, default: false)
│           └── isAbsorption (boolean, default: false)
├── Validation Rules
│   ├── Damage Category Validation
│   ├── Resistance Value Range (-100 to 100)
│   ├── Relationship Enum Validation
│   ├── ID Pattern Validation (kebab-case)
│   └── Color Field Validation
└── Configuration Updates
    └── damage-types.json expanded with categories and templates
```

---

## 3. Architecture Diagrams

### 3.1 Schema Validation Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         SCHEMA VALIDATION FLOW                               │
└─────────────────────────────────────────────────────────────────────────────┘

    User edits damage-types.json
           │
           ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                          IDE/EDITOR                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│  1. Reads $schema property from config file                                  │
│  2. Loads damage-types.schema.json from config/schemas/                      │
│  3. Validates content against schema                                         │
└─────────────────────────────────────────────────────────────────────────────┘
           │
           ├─── Valid ───▶ Green checkmark, autocomplete works
           │
           └─── Invalid ─▶ Error underlines with messages:
                           • "relationship must be one of: Strong, Weak, ..."
                           • "value must be between -100 and 100"
                           • "id must match pattern ^[a-z][a-z0-9-]*$"
                           • "color is required"
```

### 3.2 Damage Type Schema Structure Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        damage-types.schema.json                              │
├─────────────────────────────────────────────────────────────────────────────┤
│  $schema: "http://json-schema.org/draft-07/schema#"                         │
│  title: "Damage Types Configuration"                                        │
│  type: object                                                                │
├─────────────────────────────────────────────────────────────────────────────┤
│  properties:                                                                 │
│  ┌─────────────────────────┬─────────────────────────────────────────────┐  │
│  │ $schema                 │ type: string (optional)                     │  │
│  ├─────────────────────────┼─────────────────────────────────────────────┤  │
│  │ version                 │ type: string (optional)                     │  │
│  ├─────────────────────────┼─────────────────────────────────────────────┤  │
│  │ damageCategories        │ type: array, items: $ref DamageCategory     │  │
│  ├─────────────────────────┼─────────────────────────────────────────────┤  │
│  │ damageTypes             │ type: array, items: $ref DamageType         │  │
│  ├─────────────────────────┼─────────────────────────────────────────────┤  │
│  │ resistanceTemplates     │ type: array, items: $ref ResistanceTemplate │  │
│  └─────────────────────────┴─────────────────────────────────────────────┘  │
├─────────────────────────────────────────────────────────────────────────────┤
│  definitions:                                                                │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ DamageCategory                                                       │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ id                    │ string, pattern: ^[a-z][a-z0-9-]*$    │   │    │
│  │ │ name                  │ string, minLength: 1                   │   │    │
│  │ │ description           │ string                                 │   │    │
│  │ │ sortOrder             │ integer, minimum: 0                    │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ DamageType                                                           │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ id                    │ string, pattern: ^[a-z][a-z0-9-]*$    │   │    │
│  │ │ name                  │ string, minLength: 1                   │   │    │
│  │ │ description           │ string                                 │   │    │
│  │ │ categoryId            │ string                                 │   │    │
│  │ │ color                 │ string                                 │   │    │
│  │ │ iconId                │ string (optional)                      │   │    │
│  │ │ vfxId                 │ string (optional)                      │   │    │
│  │ │ sfxId                 │ string (optional)                      │   │    │
│  │ │ bypassesArmor         │ boolean, default: false                │   │    │
│  │ │ canCrit               │ boolean, default: true                 │   │    │
│  │ │ relationships         │ array of $ref DamageRelationship       │   │    │
│  │ │ sortOrder             │ integer, minimum: 0                    │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ DamageRelationship                                                   │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ targetTypeId          │ string (damage type ID)                │   │    │
│  │ │ relationship          │ enum: Strong, Weak, Neutral, Nullifies │   │    │
│  │ │ modifier              │ number, 0.0 to 3.0                     │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ ResistanceTemplate                                                   │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ id                    │ string, pattern: ^[a-z][a-z0-9-]*$    │   │    │
│  │ │ name                  │ string, minLength: 1                   │   │    │
│  │ │ description           │ string                                 │   │    │
│  │ │ creatureTypes         │ array of string                        │   │    │
│  │ │ resistances           │ array of $ref ResistanceEntry          │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ ResistanceEntry                                                      │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ damageTypeId          │ string (references DamageType)         │   │    │
│  │ │ value                 │ integer, -100 to 100                   │   │    │
│  │ │ isImmunity            │ boolean, default: false                │   │    │
│  │ │ isAbsorption          │ boolean, default: false                │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Damage Category Hierarchy Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        DAMAGE CATEGORY HIERARCHY                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                         PHYSICAL                                     │    │
│  │  Mundane physical damage from weapons and natural attacks            │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Damage Types:                                                       │    │
│  │  • physical - Standard weapon damage (white)                         │    │
│  │  • piercing - Puncturing attacks (white)                             │    │
│  │  • slashing - Cutting attacks (white)                                │    │
│  │  • bludgeoning - Crushing attacks (white)                            │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                         ELEMENTAL                                    │    │
│  │  Natural elemental forces and energies                               │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Damage Types:                                                       │    │
│  │  • fire - Heat and flame damage (red)                                │    │
│  │  • ice - Cold and frost damage (cyan)                                │    │
│  │  • lightning - Electrical damage (yellow)                            │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                          MAGICAL                                     │    │
│  │  Pure magical energy from arcane or divine sources                   │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Damage Types:                                                       │    │
│  │  • arcane - Pure magical energy (blue)                               │    │
│  │  • holy - Divine radiant damage (gold)                               │    │
│  │  • dark - Necrotic shadow damage (purple)                            │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                          SPECIAL                                     │    │
│  │  Unique damage types with special properties                         │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Damage Types:                                                       │    │
│  │  • poison - Toxic damage (green)                                     │    │
│  │  • psychic - Mental damage (pink)                                    │    │
│  │  • true - Unmitigable damage (white)                                 │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 Resistance Value Scale Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        RESISTANCE VALUE SCALE                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  -100         -50           0           50          100                      │
│    │           │            │            │           │                       │
│    ▼           ▼            ▼            ▼           ▼                       │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │ EXTREME    MODERATE     NORMAL     MODERATE    IMMUNITY                │  │
│  │ VULN       VULN                    RESIST                              │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  VULNERABILITY (Negative Values)                                            │
│  ├── -100: Extreme vulnerability (200% damage, double)                      │
│  ├── -75:  High vulnerability (175% damage)                                 │
│  ├── -50:  Moderate vulnerability (150% damage)                             │
│  └── -25:  Low vulnerability (125% damage)                                  │
│                                                                              │
│  NEUTRAL                                                                     │
│  └── 0:    Normal damage (100%)                                             │
│                                                                              │
│  RESISTANCE (Positive Values)                                               │
│  ├── 25:   Low resistance (75% damage)                                      │
│  ├── 50:   Moderate resistance (50% damage)                                 │
│  ├── 75:   High resistance (25% damage)                                     │
│  └── 100:  Immunity (0% damage)                                             │
│                                                                              │
│  SPECIAL FLAGS                                                               │
│  ├── isImmunity: true  → Complete immunity, cannot be reduced               │
│  └── isAbsorption: true → Damage heals instead of harming                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.5 Damage Type Relationships Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      DAMAGE TYPE RELATIONSHIPS                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ELEMENTAL TRIANGLE                                                          │
│                                                                              │
│                    Fire                                                      │
│                   /    \                                                     │
│          Strong /      \ Strong                                              │
│             (1.5x)   (1.5x)                                                  │
│               /          \                                                   │
│              ▼            ▼                                                  │
│           Ice ──────────── Lightning                                         │
│                  Weak                                                        │
│                 (0.75x)                                                      │
│                                                                              │
│  HOLY/DARK OPPOSITION                                                        │
│                                                                              │
│            Holy ◀────────────────▶ Dark                                      │
│                   Strong (1.5x)                                              │
│                   Both directions                                            │
│                                                                              │
│  RELATIONSHIP TYPES                                                          │
│  ┌──────────────┬────────────────────────────────────────────────────────┐  │
│  │ Strong       │ Deals increased damage (modifier > 1.0)                │  │
│  │ Weak         │ Deals reduced damage (modifier < 1.0)                  │  │
│  │ Neutral      │ Normal damage (modifier = 1.0)                         │  │
│  │ Nullifies    │ No damage dealt (modifier = 0)                         │  │
│  └──────────────┴────────────────────────────────────────────────────────┘  │
│                                                                              │
│  EXAMPLE RELATIONSHIPS                                                       │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │ Fire → Ice:           Strong (1.5x) - Fire melts ice                 │   │
│  │ Fire → Fire Elemental: Nullifies (0x) - Absorbed                     │   │
│  │ Ice → Lightning:      Weak (0.75x) - Frozen targets resist           │   │
│  │ Holy → Undead:        Strong (1.5x) - Divine vs death                │   │
│  │ Lightning → Wet:      Strong (2.0x) - Conductivity bonus             │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.6 Resistance Template System Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     RESISTANCE TEMPLATE SYSTEM                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  TEMPLATE INHERITANCE                                                        │
│                                                                              │
│  ┌─────────────────────────┐                                                │
│  │   ResistanceTemplate    │                                                │
│  │   "undead-resistances"  │                                                │
│  ├─────────────────────────┤                                                │
│  │ creatureTypes:          │                                                │
│  │ • undead                 │                                                │
│  │ • skeleton               │                                                │
│  │ • zombie                 │                                                │
│  │ • ghost                  │                                                │
│  │ • vampire                │                                                │
│  ├─────────────────────────┤                                                │
│  │ resistances:            │                                                │
│  │ • poison: 100 (immune)  │                                                │
│  │ • psychic: 100 (immune) │                                                │
│  │ • dark: +50             │                                                │
│  │ • ice: +25              │                                                │
│  │ • holy: -50             │                                                │
│  │ • fire: -25             │                                                │
│  └─────────────────────────┘                                                │
│            │                                                                │
│            ▼ Applied to                                                     │
│  ┌─────────────────────────┐     ┌─────────────────────────────┐           │
│  │     Skeleton            │     │     Frost Skeleton          │           │
│  ├─────────────────────────┤     ├─────────────────────────────┤           │
│  │ templateId:             │     │ templateId:                 │           │
│  │ "undead-resistances"    │     │ "undead-resistances"        │           │
│  │                         │     │                             │           │
│  │ (Uses template as-is)   │     │ resistanceOverrides:        │           │
│  │                         │     │ • ice: +75 (override)       │           │
│  │                         │     │ • fire: -75 (override)      │           │
│  └─────────────────────────┘     └─────────────────────────────┘           │
│                                                                              │
│  TEMPLATE + OVERRIDE CALCULATION                                             │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │ 1. Load base template resistances                                    │   │
│  │ 2. Apply any override values (replaces template value)               │   │
│  │ 3. Final resistance = override value if present, else template value │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.7 File Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            CONFIG LAYER                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  config/                                                                     │
│  ├── damage-types.json ◀──────────────────────────┐                        │
│  │   {                                             │ references             │
│  │     "$schema": "./schemas/damage-types.schema.json",                     │
│  │     "damageCategories": [                       │                        │
│  │       { "id": "physical", ... },                │                        │
│  │       { "id": "elemental", ... },               │                        │
│  │       { "id": "magical", ... },                 │                        │
│  │       { "id": "special", ... }                  │                        │
│  │     ],                                          │                        │
│  │     "damageTypes": [                            │                        │
│  │       { "id": "physical", "categoryId": "physical", ... },              │
│  │       { "id": "fire", "categoryId": "elemental", ... },                 │
│  │       ...                                       │                        │
│  │     ],                                          │                        │
│  │     "resistanceTemplates": [                    │                        │
│  │       { "id": "undead-resistances", ... },      │                        │
│  │       ...                                       │                        │
│  │     ]                                           │                        │
│  │   }                                             │                        │
│  │                                                 │                        │
│  └── schemas/                                      │                        │
│      └── damage-types.schema.json ─────────────────┘                        │
│          {                                                                   │
│            "$schema": "http://json-schema.org/draft-07/schema#",            │
│            "definitions": {                                                  │
│              "DamageCategory": {...},                                        │
│              "DamageType": {...},                                            │
│              "DamageRelationship": {...},                                    │
│              "ResistanceTemplate": {...},                                    │
│              "ResistanceEntry": {...}                                        │
│            }                                                                 │
│          }                                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Damage Type Schema Definition

### 4.1 Root Configuration Properties

**File:** `config/schemas/damage-types.schema.json`

The damage type schema follows JSON Schema Draft-07 specification, providing comprehensive validation for damage type configuration files.

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Damage Types Configuration",
    "description": "Schema for damage type and resistance definitions. Defines all damage types, their categories, relationships, and resistance templates for creature types.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
        },
        "damageCategories": {
            "type": "array",
            "description": "List of damage category definitions",
            "items": {
                "$ref": "#/definitions/DamageCategory"
            }
        },
        "damageTypes": {
            "type": "array",
            "description": "List of damage type definitions",
            "items": {
                "$ref": "#/definitions/DamageType"
            },
            "minItems": 1
        },
        "resistanceTemplates": {
            "type": "array",
            "description": "List of resistance templates for creature types",
            "items": {
                "$ref": "#/definitions/ResistanceTemplate"
            }
        }
    },
    "required": ["damageTypes"],
    "additionalProperties": false,
    "definitions": {
        "DamageCategory": { ... },
        "DamageType": { ... },
        "DamageRelationship": { ... },
        "ResistanceTemplate": { ... },
        "ResistanceEntry": { ... }
    }
}
```

### 4.2 DamageCategory Definition

The `DamageCategory` object groups related damage types into logical categories.

```json
"DamageCategory": {
    "type": "object",
    "description": "A category grouping related damage types",
    "properties": {
        "id": {
            "type": "string",
            "description": "Unique identifier for the category (lowercase, kebab-case)",
            "pattern": "^[a-z][a-z0-9-]*$",
            "minLength": 1,
            "maxLength": 50
        },
        "name": {
            "type": "string",
            "description": "Display name for the category",
            "minLength": 1,
            "maxLength": 100
        },
        "description": {
            "type": "string",
            "description": "Description of the damage category"
        },
        "sortOrder": {
            "type": "integer",
            "description": "Order for display sorting (lower values first)",
            "minimum": 0,
            "default": 0
        }
    },
    "required": ["id", "name"],
    "additionalProperties": false
}
```

### 4.3 DamageType Definition

The `DamageType` object defines a complete damage type with all its properties.

```json
"DamageType": {
    "type": "object",
    "description": "A damage type that can be dealt and resisted",
    "properties": {
        "id": {
            "type": "string",
            "description": "Unique identifier for the damage type (lowercase, kebab-case)",
            "pattern": "^[a-z][a-z0-9-]*$",
            "minLength": 1,
            "maxLength": 50
        },
        "name": {
            "type": "string",
            "description": "Display name shown to players",
            "minLength": 1,
            "maxLength": 100
        },
        "description": {
            "type": "string",
            "description": "Full description of the damage type",
            "minLength": 1
        },
        "categoryId": {
            "type": "string",
            "description": "Reference to the damage category this type belongs to",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "color": {
            "type": "string",
            "description": "Console color name or hex value for display",
            "minLength": 1
        },
        "iconId": {
            "type": "string",
            "description": "Icon identifier for UI display",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "vfxId": {
            "type": "string",
            "description": "Visual effect identifier for combat animations",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "sfxId": {
            "type": "string",
            "description": "Sound effect identifier for combat audio",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "bypassesArmor": {
            "type": "boolean",
            "description": "Whether this damage type ignores armor/defense",
            "default": false
        },
        "canCrit": {
            "type": "boolean",
            "description": "Whether this damage type can critically hit",
            "default": true
        },
        "relationships": {
            "type": "array",
            "description": "Relationships with other damage types or targets",
            "items": {
                "$ref": "#/definitions/DamageRelationship"
            }
        },
        "sortOrder": {
            "type": "integer",
            "description": "Order for display sorting (lower values first)",
            "minimum": 0,
            "default": 0
        }
    },
    "required": ["id", "name", "description", "color"],
    "additionalProperties": false
}
```

### 4.4 DamageRelationship Definition

The `DamageRelationship` object defines how one damage type interacts with another.

```json
"DamageRelationship": {
    "type": "object",
    "description": "A relationship between this damage type and another type or target",
    "properties": {
        "targetTypeId": {
            "type": "string",
            "description": "The damage type ID or creature type this relationship targets",
            "pattern": "^[a-z][a-z0-9-]*$",
            "minLength": 1
        },
        "relationship": {
            "type": "string",
            "description": "The type of relationship",
            "enum": ["Strong", "Weak", "Neutral", "Nullifies"]
        },
        "modifier": {
            "type": "number",
            "description": "Damage multiplier (1.0 = normal, 1.5 = 50% more, 0.5 = 50% less)",
            "minimum": 0.0,
            "maximum": 3.0,
            "default": 1.0
        }
    },
    "required": ["targetTypeId", "relationship"],
    "additionalProperties": false
}
```

### 4.5 ResistanceTemplate Definition

The `ResistanceTemplate` object defines a reusable set of resistances for creature types.

```json
"ResistanceTemplate": {
    "type": "object",
    "description": "A template defining resistances for a category of creatures",
    "properties": {
        "id": {
            "type": "string",
            "description": "Unique identifier for the template (lowercase, kebab-case)",
            "pattern": "^[a-z][a-z0-9-]*$",
            "minLength": 1,
            "maxLength": 50
        },
        "name": {
            "type": "string",
            "description": "Display name for the template",
            "minLength": 1,
            "maxLength": 100
        },
        "description": {
            "type": "string",
            "description": "Description of the resistance template"
        },
        "creatureTypes": {
            "type": "array",
            "description": "Creature type tags this template applies to",
            "items": {
                "type": "string",
                "pattern": "^[a-z][a-z0-9-]*$",
                "minLength": 1
            },
            "minItems": 1
        },
        "resistances": {
            "type": "array",
            "description": "List of resistance entries for this template",
            "items": {
                "$ref": "#/definitions/ResistanceEntry"
            },
            "minItems": 1
        }
    },
    "required": ["id", "name", "creatureTypes", "resistances"],
    "additionalProperties": false
}
```

### 4.6 ResistanceEntry Definition

The `ResistanceEntry` object defines a single resistance value for a damage type.

```json
"ResistanceEntry": {
    "type": "object",
    "description": "A resistance entry for a specific damage type",
    "properties": {
        "damageTypeId": {
            "type": "string",
            "description": "Reference to the damage type this resistance applies to",
            "pattern": "^[a-z][a-z0-9-]*$",
            "minLength": 1
        },
        "value": {
            "type": "integer",
            "description": "Resistance value (-100 to 100). Positive = resistance, negative = vulnerability",
            "minimum": -100,
            "maximum": 100
        },
        "isImmunity": {
            "type": "boolean",
            "description": "If true, complete immunity that cannot be reduced by effects",
            "default": false
        },
        "isAbsorption": {
            "type": "boolean",
            "description": "If true, damage of this type heals instead of harming",
            "default": false
        }
    },
    "required": ["damageTypeId", "value"],
    "additionalProperties": false
}
```

---

## 5. Damage Category Configuration

### 5.1 Category Types

The damage category system groups related damage types for organizational and gameplay purposes.

| Category ID | Name | Description | Example Damage Types |
|-------------|------|-------------|----------------------|
| `physical` | Physical | Mundane physical damage from weapons and natural attacks | physical, piercing, slashing, bludgeoning |
| `elemental` | Elemental | Natural elemental forces and energies | fire, ice, lightning |
| `magical` | Magical | Pure magical energy from arcane or divine sources | arcane, holy, dark |
| `special` | Special | Unique damage types with special properties | poison, psychic, true |

### 5.2 Category Usage

Categories are used for:
- **UI organization** - Grouping damage types in tooltips and stats screens
- **Resistance category effects** - "Resist all Elemental" abilities
- **Damage reduction rules** - Category-wide armor effects
- **Balance analysis** - Ensuring variety across categories

**Category JSON Example:**

```json
{
    "damageCategories": [
        {
            "id": "physical",
            "name": "Physical",
            "description": "Mundane physical damage from weapons and natural attacks.",
            "sortOrder": 0
        },
        {
            "id": "elemental",
            "name": "Elemental",
            "description": "Natural elemental forces and energies.",
            "sortOrder": 1
        },
        {
            "id": "magical",
            "name": "Magical",
            "description": "Pure magical energy from arcane or divine sources.",
            "sortOrder": 2
        },
        {
            "id": "special",
            "name": "Special",
            "description": "Unique damage types with special properties.",
            "sortOrder": 3
        }
    ]
}
```

---

## 6. Resistance System Configuration

### 6.1 Resistance Value Ranges

The resistance system uses a unified -100 to 100 scale:

| Value Range | Meaning | Damage Multiplier | Example |
|-------------|---------|-------------------|---------|
| -100 | Extreme vulnerability | 2.0x (200%) | Paper golem vs fire |
| -75 | High vulnerability | 1.75x (175%) | Ice elemental vs fire |
| -50 | Moderate vulnerability | 1.5x (150%) | Plant vs fire |
| -25 | Low vulnerability | 1.25x (125%) | Skeleton vs bludgeoning |
| 0 | Normal | 1.0x (100%) | Default for all types |
| 25 | Low resistance | 0.75x (75%) | Armored vs physical |
| 50 | Moderate resistance | 0.5x (50%) | Dwarf vs poison |
| 75 | High resistance | 0.25x (25%) | Fire elemental vs fire |
| 100 | Immunity | 0x (0%) | Undead vs poison |

**Formula:** `FinalDamage = BaseDamage * (100 - Resistance) / 100`

### 6.2 Immunity and Absorption

Special resistance flags provide additional behaviors beyond the value scale:

| Flag | Description | Behavior |
|------|-------------|----------|
| `isImmunity: true` | Complete immunity | Cannot be reduced by resistance-lowering effects |
| `isAbsorption: true` | Damage heals | Damage of this type heals instead of harming |

**Immunity Example:**
```json
{
    "damageTypeId": "poison",
    "value": 100,
    "isImmunity": true
}
```
This means the creature is completely immune to poison - even effects that "reduce poison resistance" won't work.

**Absorption Example:**
```json
{
    "damageTypeId": "fire",
    "value": 100,
    "isAbsorption": true
}
```
This means fire damage heals the creature instead of harming it (fire elemental).

### 6.3 Resistance Templates

Standard resistance templates for common creature types:

| Template ID | Creature Types | Key Resistances |
|-------------|----------------|-----------------|
| `undead-resistances` | undead, skeleton, zombie, ghost, vampire | Poison: immune, Psychic: immune, Dark: +50, Ice: +25, Holy: -50, Fire: -25 |
| `construct-resistances` | construct, golem, automaton | Poison: immune, Psychic: immune, Physical: +25 |
| `elemental-fire-resistances` | fire-elemental | Fire: absorb, Ice: -75, Lightning: +25 |
| `elemental-ice-resistances` | ice-elemental | Ice: absorb, Fire: -75, Lightning: -25 |
| `demon-resistances` | demon, fiend | Fire: +50, Holy: -50, Dark: +75, Poison: +50 |
| `celestial-resistances` | celestial, angel | Holy: absorb, Dark: -50, Fire: +25 |
| `plant-resistances` | plant, treant | Fire: -50, Poison: +75, Ice: -25 |
| `ooze-resistances` | ooze, slime | Physical: +50, Poison: immune, Lightning: -25 |

---

## 7. Damage Type Relationships

### 7.1 Relationship Types

The relationship system defines how damage types interact:

| Relationship | Description | Typical Modifier | Use Case |
|--------------|-------------|------------------|----------|
| `Strong` | Deals increased damage | 1.25x - 2.0x | Fire vs Ice, Holy vs Undead |
| `Weak` | Deals reduced damage | 0.5x - 0.75x | Ice vs Lightning |
| `Neutral` | Normal damage | 1.0x | Default relationship |
| `Nullifies` | No damage dealt | 0x | Fire vs Fire Elemental (absorbed) |

### 7.2 Relationship Modifiers

Standard relationship modifiers:

| Modifier Value | Effect | Example |
|----------------|--------|---------|
| 0.0 | No damage | Nullifies |
| 0.5 | Half damage | Strong weakness |
| 0.75 | Three-quarter damage | Mild weakness |
| 1.0 | Normal damage | Neutral |
| 1.25 | 25% more damage | Mild strength |
| 1.5 | 50% more damage | Strong strength |
| 2.0 | Double damage | Extreme strength |
| 3.0 | Triple damage | Maximum (rare) |

**Standard Elemental Relationships:**

```json
{
    "id": "fire",
    "relationships": [
        {
            "targetTypeId": "ice",
            "relationship": "Strong",
            "modifier": 1.5
        }
    ]
}
```

```json
{
    "id": "holy",
    "relationships": [
        {
            "targetTypeId": "dark",
            "relationship": "Strong",
            "modifier": 1.5
        }
    ]
}
```

---

## 8. Validation Rules

### 8.1 Enum Validation

| Property | Valid Values | Validation Error |
|----------|--------------|------------------|
| `relationship` | `Strong`, `Weak`, `Neutral`, `Nullifies` | "relationship must be one of: Strong, Weak, Neutral, Nullifies" |

### 8.2 Range Validation

| Property | Range | Validation Error |
|----------|-------|------------------|
| `value` (ResistanceEntry) | -100 to 100 | "value must be between -100 and 100" |
| `modifier` (DamageRelationship) | 0.0 to 3.0 | "modifier must be between 0.0 and 3.0" |
| `sortOrder` | ≥0 | "sortOrder must be >= 0" |

### 8.3 Required Fields

#### DamageCategory Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `id` | Must be present and match pattern | "missing required property 'id'" |
| `name` | Must be present and non-empty | "missing required property 'name'" |

#### DamageType Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `id` | Must be present and match pattern | "missing required property 'id'" |
| `name` | Must be present and non-empty | "missing required property 'name'" |
| `description` | Must be present | "missing required property 'description'" |
| `color` | Must be present and non-empty | "missing required property 'color'" |

#### DamageRelationship Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `targetTypeId` | Must be present and match pattern | "missing required property 'targetTypeId'" |
| `relationship` | Must be present and valid enum | "missing required property 'relationship'" |

#### ResistanceTemplate Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `id` | Must be present and match pattern | "missing required property 'id'" |
| `name` | Must be present and non-empty | "missing required property 'name'" |
| `creatureTypes` | Must be present with at least one item | "missing required property 'creatureTypes'" |
| `resistances` | Must be present with at least one item | "missing required property 'resistances'" |

#### ResistanceEntry Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `damageTypeId` | Must be present and match pattern | "missing required property 'damageTypeId'" |
| `value` | Must be present and in range | "missing required property 'value'" |

### 8.4 Pattern Validation

| Property | Pattern | Validation Error |
|----------|---------|------------------|
| `id` (all definitions) | `^[a-z][a-z0-9-]*$` | "id must match pattern ^[a-z][a-z0-9-]*$" |
| `categoryId` | `^[a-z][a-z0-9-]*$` | "categoryId must match pattern ^[a-z][a-z0-9-]*$" |
| `targetTypeId` | `^[a-z][a-z0-9-]*$` | "targetTypeId must match pattern ^[a-z][a-z0-9-]*$" |
| `damageTypeId` | `^[a-z][a-z0-9-]*$` | "damageTypeId must match pattern ^[a-z][a-z0-9-]*$" |
| `iconId` | `^[a-z][a-z0-9-]*$` | "iconId must match pattern ^[a-z][a-z0-9-]*$" |
| `vfxId` | `^[a-z][a-z0-9-]*$` | "vfxId must match pattern ^[a-z][a-z0-9-]*$" |
| `sfxId` | `^[a-z][a-z0-9-]*$` | "sfxId must match pattern ^[a-z][a-z0-9-]*$" |

---

## 9. Configuration Schema

### Complete Damage Types Schema File

**File:** `config/schemas/damage-types.schema.json`

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Damage Types Configuration",
    "description": "Schema for damage type and resistance definitions. Defines all damage types, their categories, relationships, and resistance templates for creature types.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
        },
        "damageCategories": {
            "type": "array",
            "description": "List of damage category definitions",
            "items": {
                "$ref": "#/definitions/DamageCategory"
            }
        },
        "damageTypes": {
            "type": "array",
            "description": "List of damage type definitions",
            "items": {
                "$ref": "#/definitions/DamageType"
            },
            "minItems": 1
        },
        "resistanceTemplates": {
            "type": "array",
            "description": "List of resistance templates for creature types",
            "items": {
                "$ref": "#/definitions/ResistanceTemplate"
            }
        }
    },
    "required": ["damageTypes"],
    "additionalProperties": false,
    "definitions": {
        "DamageCategory": {
            "type": "object",
            "description": "A category grouping related damage types",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique identifier for the category (lowercase, kebab-case)",
                    "pattern": "^[a-z][a-z0-9-]*$",
                    "minLength": 1,
                    "maxLength": 50
                },
                "name": {
                    "type": "string",
                    "description": "Display name for the category",
                    "minLength": 1,
                    "maxLength": 100
                },
                "description": {
                    "type": "string",
                    "description": "Description of the damage category"
                },
                "sortOrder": {
                    "type": "integer",
                    "description": "Order for display sorting (lower values first)",
                    "minimum": 0,
                    "default": 0
                }
            },
            "required": ["id", "name"],
            "additionalProperties": false
        },
        "DamageType": {
            "type": "object",
            "description": "A damage type that can be dealt and resisted",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique identifier for the damage type (lowercase, kebab-case)",
                    "pattern": "^[a-z][a-z0-9-]*$",
                    "minLength": 1,
                    "maxLength": 50
                },
                "name": {
                    "type": "string",
                    "description": "Display name shown to players",
                    "minLength": 1,
                    "maxLength": 100
                },
                "description": {
                    "type": "string",
                    "description": "Full description of the damage type",
                    "minLength": 1
                },
                "categoryId": {
                    "type": "string",
                    "description": "Reference to the damage category this type belongs to",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "color": {
                    "type": "string",
                    "description": "Console color name or hex value for display",
                    "minLength": 1
                },
                "iconId": {
                    "type": "string",
                    "description": "Icon identifier for UI display",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "vfxId": {
                    "type": "string",
                    "description": "Visual effect identifier for combat animations",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "sfxId": {
                    "type": "string",
                    "description": "Sound effect identifier for combat audio",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "bypassesArmor": {
                    "type": "boolean",
                    "description": "Whether this damage type ignores armor/defense",
                    "default": false
                },
                "canCrit": {
                    "type": "boolean",
                    "description": "Whether this damage type can critically hit",
                    "default": true
                },
                "relationships": {
                    "type": "array",
                    "description": "Relationships with other damage types or targets",
                    "items": {
                        "$ref": "#/definitions/DamageRelationship"
                    }
                },
                "sortOrder": {
                    "type": "integer",
                    "description": "Order for display sorting (lower values first)",
                    "minimum": 0,
                    "default": 0
                }
            },
            "required": ["id", "name", "description", "color"],
            "additionalProperties": false
        },
        "DamageRelationship": {
            "type": "object",
            "description": "A relationship between this damage type and another type or target",
            "properties": {
                "targetTypeId": {
                    "type": "string",
                    "description": "The damage type ID or creature type this relationship targets",
                    "pattern": "^[a-z][a-z0-9-]*$",
                    "minLength": 1
                },
                "relationship": {
                    "type": "string",
                    "description": "The type of relationship",
                    "enum": ["Strong", "Weak", "Neutral", "Nullifies"]
                },
                "modifier": {
                    "type": "number",
                    "description": "Damage multiplier (1.0 = normal, 1.5 = 50% more, 0.5 = 50% less)",
                    "minimum": 0.0,
                    "maximum": 3.0,
                    "default": 1.0
                }
            },
            "required": ["targetTypeId", "relationship"],
            "additionalProperties": false
        },
        "ResistanceTemplate": {
            "type": "object",
            "description": "A template defining resistances for a category of creatures",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique identifier for the template (lowercase, kebab-case)",
                    "pattern": "^[a-z][a-z0-9-]*$",
                    "minLength": 1,
                    "maxLength": 50
                },
                "name": {
                    "type": "string",
                    "description": "Display name for the template",
                    "minLength": 1,
                    "maxLength": 100
                },
                "description": {
                    "type": "string",
                    "description": "Description of the resistance template"
                },
                "creatureTypes": {
                    "type": "array",
                    "description": "Creature type tags this template applies to",
                    "items": {
                        "type": "string",
                        "pattern": "^[a-z][a-z0-9-]*$",
                        "minLength": 1
                    },
                    "minItems": 1
                },
                "resistances": {
                    "type": "array",
                    "description": "List of resistance entries for this template",
                    "items": {
                        "$ref": "#/definitions/ResistanceEntry"
                    },
                    "minItems": 1
                }
            },
            "required": ["id", "name", "creatureTypes", "resistances"],
            "additionalProperties": false
        },
        "ResistanceEntry": {
            "type": "object",
            "description": "A resistance entry for a specific damage type",
            "properties": {
                "damageTypeId": {
                    "type": "string",
                    "description": "Reference to the damage type this resistance applies to",
                    "pattern": "^[a-z][a-z0-9-]*$",
                    "minLength": 1
                },
                "value": {
                    "type": "integer",
                    "description": "Resistance value (-100 to 100). Positive = resistance, negative = vulnerability",
                    "minimum": -100,
                    "maximum": 100
                },
                "isImmunity": {
                    "type": "boolean",
                    "description": "If true, complete immunity that cannot be reduced by effects",
                    "default": false
                },
                "isAbsorption": {
                    "type": "boolean",
                    "description": "If true, damage of this type heals instead of harming",
                    "default": false
                }
            },
            "required": ["damageTypeId", "value"],
            "additionalProperties": false
        }
    }
}
```

---

## 10. Configuration File Updates

### Updated damage-types.json

The existing `damage-types.json` needs to be expanded with schema reference, categories, and resistance templates.

**File:** `config/damage-types.json`

Current structure (7 damage types, no categories or templates):
```json
{
  "damageTypes": [
    { "id": "physical", "name": "Physical", ... },
    { "id": "fire", "name": "Fire", ... },
    { "id": "ice", "name": "Ice", ... },
    { "id": "lightning", "name": "Lightning", ... },
    { "id": "poison", "name": "Poison", ... },
    { "id": "holy", "name": "Holy", ... },
    { "id": "dark", "name": "Dark", ... }
  ]
}
```

Expanded with schema reference, categories, and templates:
```json
{
    "$schema": "./schemas/damage-types.schema.json",
    "damageCategories": [
        {
            "id": "physical",
            "name": "Physical",
            "description": "Mundane physical damage from weapons and natural attacks.",
            "sortOrder": 0
        },
        {
            "id": "elemental",
            "name": "Elemental",
            "description": "Natural elemental forces and energies.",
            "sortOrder": 1
        },
        {
            "id": "magical",
            "name": "Magical",
            "description": "Pure magical energy from arcane or divine sources.",
            "sortOrder": 2
        },
        {
            "id": "special",
            "name": "Special",
            "description": "Unique damage types with special properties.",
            "sortOrder": 3
        }
    ],
    "damageTypes": [
        {
            "id": "physical",
            "name": "Physical",
            "description": "Standard physical damage from weapons and natural attacks.",
            "categoryId": "physical",
            "color": "white",
            "sortOrder": 0
        },
        {
            "id": "fire",
            "name": "Fire",
            "description": "Burning damage from flames and heat.",
            "categoryId": "elemental",
            "color": "red",
            "relationships": [
                {
                    "targetTypeId": "ice",
                    "relationship": "Strong",
                    "modifier": 1.5
                }
            ],
            "sortOrder": 1
        },
        {
            "id": "ice",
            "name": "Ice",
            "description": "Freezing damage from cold and frost.",
            "categoryId": "elemental",
            "color": "cyan",
            "relationships": [
                {
                    "targetTypeId": "fire",
                    "relationship": "Weak",
                    "modifier": 0.75
                }
            ],
            "sortOrder": 2
        },
        {
            "id": "lightning",
            "name": "Lightning",
            "description": "Electrical damage from storms and magic.",
            "categoryId": "elemental",
            "color": "yellow",
            "sortOrder": 3
        },
        {
            "id": "poison",
            "name": "Poison",
            "description": "Toxic damage from venoms and chemicals.",
            "categoryId": "special",
            "color": "green",
            "sortOrder": 4
        },
        {
            "id": "holy",
            "name": "Holy",
            "description": "Radiant damage from divine sources.",
            "categoryId": "magical",
            "color": "gold1",
            "relationships": [
                {
                    "targetTypeId": "dark",
                    "relationship": "Strong",
                    "modifier": 1.5
                }
            ],
            "sortOrder": 5
        },
        {
            "id": "dark",
            "name": "Dark",
            "description": "Necrotic damage from shadow and death magic.",
            "categoryId": "magical",
            "color": "purple",
            "relationships": [
                {
                    "targetTypeId": "holy",
                    "relationship": "Strong",
                    "modifier": 1.5
                }
            ],
            "sortOrder": 6
        }
    ],
    "resistanceTemplates": [
        {
            "id": "undead-resistances",
            "name": "Undead Resistances",
            "description": "Standard resistances for undead creatures.",
            "creatureTypes": ["undead", "skeleton", "zombie", "ghost", "vampire"],
            "resistances": [
                { "damageTypeId": "poison", "value": 100, "isImmunity": true },
                { "damageTypeId": "dark", "value": 50 },
                { "damageTypeId": "ice", "value": 25 },
                { "damageTypeId": "holy", "value": -50 },
                { "damageTypeId": "fire", "value": -25 }
            ]
        },
        {
            "id": "construct-resistances",
            "name": "Construct Resistances",
            "description": "Standard resistances for constructed creatures.",
            "creatureTypes": ["construct", "golem", "automaton"],
            "resistances": [
                { "damageTypeId": "poison", "value": 100, "isImmunity": true },
                { "damageTypeId": "physical", "value": 25 }
            ]
        },
        {
            "id": "elemental-fire-resistances",
            "name": "Fire Elemental Resistances",
            "description": "Resistances for fire-based elemental creatures.",
            "creatureTypes": ["fire-elemental"],
            "resistances": [
                { "damageTypeId": "fire", "value": 100, "isAbsorption": true },
                { "damageTypeId": "ice", "value": -75 },
                { "damageTypeId": "lightning", "value": 25 }
            ]
        },
        {
            "id": "elemental-ice-resistances",
            "name": "Ice Elemental Resistances",
            "description": "Resistances for ice-based elemental creatures.",
            "creatureTypes": ["ice-elemental"],
            "resistances": [
                { "damageTypeId": "ice", "value": 100, "isAbsorption": true },
                { "damageTypeId": "fire", "value": -75 },
                { "damageTypeId": "lightning", "value": -25 }
            ]
        }
    ]
}
```

### Validation Confirmation

The existing configuration validates successfully against the schema after adding categories:

| Damage Type | Category | Color | Valid |
|-------------|----------|-------|-------|
| `physical` | physical | white | Yes |
| `fire` | elemental | red | Yes |
| `ice` | elemental | cyan | Yes |
| `lightning` | elemental | yellow | Yes |
| `poison` | special | green | Yes |
| `holy` | magical | gold1 | Yes |
| `dark` | magical | purple | Yes |

---

## 11. Data Model Changes

### No Domain Changes Required

This phase creates only a JSON Schema file for validation. No changes to domain entities, services, or application layer are required.

| Layer | Changes |
|-------|---------|
| Domain | None |
| Application | None |
| Infrastructure | None |
| Configuration | One schema file added, one config file expanded |

### Schema as Documentation

The schema serves as:
- **Validation contract** for damage type configuration
- **IDE documentation** via description fields
- **Modding reference** for custom damage systems
- **Design specification** for resistance mechanics

---

## 12. Logging Specifications

### No Runtime Logging Required

Schema validation occurs at design-time in IDE/editors, not at runtime. No logging infrastructure changes are needed for this phase.

| Component | Level | Events |
|-----------|-------|--------|
| N/A | N/A | Schema validation is IDE-based |

---

## 13. Unit Testing Requirements

### Test Count by Feature

| Feature | Test Count |
|---------|------------|
| Schema Valid Structure | ~1 |
| Damage Category Validation | ~1 |
| Relationship Enum Validation | ~1 |
| Resistance Value Range Validation | ~1 |
| Immunity Flag Validation | ~1 |
| Absorption Flag Validation | ~1 |
| ID Pattern Validation | ~1 |
| Existing Configuration Validation | ~1 |
| **Total** | **~8** |

### Test Descriptions

#### DamageTypesSchemaTests.cs

```csharp
[TestFixture]
public class DamageTypesSchemaTests
{
    /// <summary>
    /// Verifies the schema file is valid JSON Schema Draft-07.
    /// </summary>
    [Test]
    public void Schema_IsValidJsonSchemaDraft07();

    /// <summary>
    /// Verifies the existing damage-types.json validates against the schema without errors.
    /// </summary>
    [Test]
    public void ExistingDamageTypesJson_ValidatesAgainstSchema();

    /// <summary>
    /// Verifies relationship must be a valid enum value (Strong, Weak, Neutral, Nullifies).
    /// </summary>
    [Test]
    public void Relationship_InvalidEnumValue_FailsValidation();

    /// <summary>
    /// Verifies resistance value must be within valid range (-100 to 100).
    /// </summary>
    [Test]
    public void ResistanceValue_OutOfRange_FailsValidation();

    /// <summary>
    /// Verifies isImmunity flag is validated as boolean.
    /// </summary>
    [Test]
    public void IsImmunity_ValidBoolean_PassesValidation();

    /// <summary>
    /// Verifies isAbsorption flag is validated as boolean.
    /// </summary>
    [Test]
    public void IsAbsorption_ValidBoolean_PassesValidation();

    /// <summary>
    /// Verifies ID fields must match the kebab-case pattern.
    /// </summary>
    [Test]
    public void Id_InvalidPattern_FailsValidation();

    /// <summary>
    /// Verifies color field is required and non-empty.
    /// </summary>
    [Test]
    public void Color_MissingOrEmpty_FailsValidation();
}
```

### Test Implementation Notes

Tests should use a JSON Schema validation library (e.g., `NJsonSchema` for C#) to:
1. Load the schema file
2. Validate test JSON documents
3. Assert expected validation results

---

## 14. Use Cases

### UC-001: Load Damage Types Configuration

**Actor:** Game System
**Flow:** System starts → Loads `damage-types.json` → Schema validates content → Damage types available for combat calculations

### UC-002: Edit Damage Types in IDE

**Actor:** Developer/Modder
**Flow:** Opens `damage-types.json` in VS Code → IDE loads schema → Autocomplete suggests properties → Validation errors shown inline

### UC-003: Add New Damage Type

**Actor:** Modder
**Flow:** Adds new damage type object to `damageTypes` array → Sets id, name, description, color, categoryId → IDE validates structure

### UC-004: Create Resistance Template

**Actor:** Modder
**Flow:** Adds new template object to `resistanceTemplates` array → Specifies id, name, creatureTypes, resistances → IDE validates structure

### UC-005: Define Damage Type Relationship

**Actor:** Modder
**Flow:** Adds relationships array to damage type → Specifies targetTypeId, relationship, modifier → IDE validates enum and range

### UC-006: Invalid Resistance Value

**Actor:** Modder
**Flow:** Sets resistance value to `150` → IDE shows error "value must be between -100 and 100" → Modder corrects to `100`

---

## 15. Deliverable Checklist

### Schema Files
- [ ] `config/schemas/damage-types.schema.json` created
- [ ] Schema follows JSON Schema Draft-07 format
- [ ] Schema includes all defined properties
- [ ] Schema includes definitions section (DamageCategory, DamageType, DamageRelationship, ResistanceTemplate, ResistanceEntry)

### Validation Rules
- [ ] Relationship enum validation: Strong, Weak, Neutral, Nullifies
- [ ] Resistance value range validation: -100 to 100
- [ ] Modifier range validation: 0.0 to 3.0
- [ ] ID pattern validation: ^[a-z][a-z0-9-]*$
- [ ] Color field required and non-empty
- [ ] isImmunity validated as boolean
- [ ] isAbsorption validated as boolean
- [ ] Required fields enforced
- [ ] Optional fields have defaults

### Configuration Updates
- [ ] `damage-types.json` $schema reference added as `./schemas/damage-types.schema.json`
- [ ] `damage-types.json` expanded with damageCategories array
- [ ] `damage-types.json` expanded with resistanceTemplates array
- [ ] Existing damage types updated with categoryId
- [ ] Existing `damage-types.json` validates against schema

### Testing
- [ ] ~8 unit tests implemented
- [ ] All tests passing
- [ ] Tests cover happy path and error cases

### Documentation
- [ ] Schema properties have descriptions
- [ ] This design specification complete

---

## 16. Acceptance Criteria

### Functional
- [ ] `damage-types.schema.json` created in `config/schemas/` directory
- [ ] Schema validates existing `damage-types.json` without errors
- [ ] Damage category definitions validated
- [ ] Relationship enum validated (Strong, Weak, Neutral, Nullifies)
- [ ] Resistance value range validated (-100 to 100)
- [ ] Modifier range validated (0.0 to 3.0)
- [ ] ID pattern enforced (lowercase kebab-case)
- [ ] Color field validated (required, non-empty)
- [ ] Immunity flag validated as boolean
- [ ] Absorption flag validated as boolean
- [ ] Resistance template structure validated
- [ ] Template creature types validated as string array
- [ ] VS Code provides autocomplete when schema linked

### Quality
- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] ~8 unit tests pass
- [ ] Schema file is valid JSON
- [ ] All schema properties have descriptions

---

## 17. Dependencies

### Required from Prior Versions

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `damage-types.json` | `config/damage-types.json` | Validated and expanded by new schema |
| Schema patterns | `config/schemas/*.schema.json` | Reference for schema structure |
| Status effect schema (v0.14.1b) | `config/schemas/status-effects.schema.json` | References damageType field pattern |

### Provides to Future Versions

| Type | Usage |
|------|-------|
| `damage-types.schema.json` | Validates damage type configuration |
| DamageCategory pattern | Reusable category grouping pattern |
| ResistanceTemplate pattern | Used by monsters.json for resistance assignment |
| DamageRelationship pattern | Used for damage type interactions |
| Resistance value scale | Standard -100 to 100 scale for all resistances |

### Implementation Order Note

**v0.14.1c can be implemented in parallel with other v0.14.1 parts** (a, b, d) as they have no internal dependencies.

Complete v0.14.1 implementation order options:
- All parts can be implemented in parallel
- Or sequentially in any order: v0.14.1a → v0.14.1b → v0.14.1c → v0.14.1d

---

## 18. Future Considerations

### Deferred to Future Versions

- **Cross-reference validation**: Validating categoryId references exist in damageCategories
- **Damage type reference validation**: Validating damageTypeId references in resistance templates
- **Monster integration**: monsters.json resistanceTemplateId and resistanceOverrides fields
- **Effect interaction rules**: effect-interactions.json schema for damage type combinations

### Out of Scope

- **Runtime schema validation**: Application-level validation at load time (handled by existing provider patterns)
- **Schema versioning migration**: Automatic migration between schema versions
- **Resistance calculation logic**: Runtime mechanics for damage calculation (domain logic, not schema)
- **UI resistance display**: How resistances are shown to players (presentation concern)
- **Balance tuning**: Specific resistance values (design decisions)

### Potential Future Enhancements

If the damage type system expands, consider adding:
- `damageReduction` - Flat damage reduction before percentage resistance
- `minimumDamage` - Minimum damage that bypasses resistance
- `reflectPercentage` - Damage reflected back to attacker
- `lifestealPercentage` - Healing based on damage dealt
- `appliesStatusEffect` - Status effect applied on damage
- `stacksWithSelf` - Whether multiple sources stack
- `triggersOnHit` - Effects triggered when this damage hits
- `visualVariants` - Different visual effects based on damage amount

---

*Document Version: 1.0*
*Last Updated: 2026-01-17*
*Author: Claude*
