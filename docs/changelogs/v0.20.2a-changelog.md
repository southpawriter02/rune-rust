# v0.20.2a Changelog — Rúnasmiðr Framework & Tier 1

**Date:** 2026-02-10
**Scope:** Rúnasmiðr (Runesmith) specialization framework, Rune Charges resource, Tier 1 abilities
**Parent Archetype:** Adept
**Path Type:** Coherent

---

## Added

### Domain Layer

- **`RuneChargeResource`** — immutable value object for Rune Charges (max 5, crafting-based generation)
    - `TrySpend(int)` — attempt to consume charges for abilities
    - `Restore(int)` / `RestoreAll()` — partial or full restoration on rest
    - `GenerateFromCraft(bool)` — generate 1 (standard) or 2 (complex) charges from crafting
- **`InscribedRune`** — immutable value object for runes on items
    - `CreateEnhancement(Guid)` — weapon rune: +2 damage, 10 turns
    - `CreateProtection(Guid)` — armor rune: +1 Defense, 10 turns
    - `Tick()` — decrement duration per turn
- **`RunestoneWard`** — immutable value object for damage absorption ward (10 HP)
    - `AbsorbDamage(int)` — absorb damage, return (absorbed, remaining, updated)
    - `GetVisualBar()` — visual bar rendering (█/░)
- **`RuneType`** — enum for rune categories (Enhancement, Protection, Elemental, Ward, Trap)
- **`RunasmidrAbilityId`** — enum for all 9 Rúnasmiðr abilities across 4 tiers
- **`SpecializationId.Runasmidr = 17`** — new enum value (18 total specializations, 6 Adept)

### Application Layer

- **`IRuneChargeService`** — interface for Rune Charge management (spend, generate, restore, check)
- **`RuneChargeService`** — implementation with exhaustive structured logging
    - Logs spend success/rejection, craft generation, rest restoration
    - Warning-level logging on rejected operations (insufficient charges, already full)

### Configuration

- **`specializations.json`** — added Rúnasmiðr pathType (Coherent), definition, specialResource (rune-charges), and Tier 1 abilities
    - `inscribe-rune` — active, costs 1 rune charge
    - `read-the-marks` — passive, no cost
    - `runestone-ward` — active, costs 1 rune charge

### Unit Tests (14 total)

- **`RuneChargeResourceTests`** (7 tests) — creation, spending, restoration, craft generation
- **`RuneChargeServiceTests`** (7 tests) — service delegation, logging, edge cases

## Changed

- **`SpecializationId.cs`** — updated header comments (17→18 specializations, 5→6 Adept)
- **`SpecializationIdExtensions.cs`** — added `Runasmidr` to `GetParentArchetype()` (→Adept) and `GetDisplayName()` (→"Rúnasmiðr")

---

## Test Summary

| Suite                     | Tests  | Passed | Failed |
| ------------------------- | ------ | ------ | ------ |
| `RuneChargeResourceTests` | 7      | 7      | 0      |
| `RuneChargeServiceTests`  | 7      | 7      | 0      |
| **Total**                 | **14** | **14** | **0**  |
