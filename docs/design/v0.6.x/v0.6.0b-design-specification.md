# v0.6.0b Design Specification: Status Bar

**Version:** 0.6.0b
**Parent:** v0.6.0 (Core UI Framework)
**Prerequisites:** v0.6.0a Complete (Screen Layout System)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Status Bar Component](#4-status-bar-component)
5. [Data Provider](#5-data-provider)
6. [Format Modes](#6-format-modes)
7. [Data Model](#7-data-model)
8. [Configuration](#8-configuration)
9. [Logging Specifications](#9-logging-specifications)
10. [Unit Testing Requirements](#10-unit-testing-requirements)
11. [Use Cases](#11-use-cases)
12. [Deliverable Checklist](#12-deliverable-checklist)
13. [Acceptance Criteria](#13-acceptance-criteria)
14. [Dependencies](#14-dependencies)
15. [Future Considerations](#15-future-considerations)

---

## 1. Executive Summary

### Purpose

The Status Bar implements a persistent display component that shows always-visible player information in the footer panel established by v0.6.0a. The status bar auto-refreshes when player state changes, providing immediate feedback on health, resources, experience, gold, location, and combat status.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Components** | StatusBar class |
| **Interfaces** | IStatusBarDataProvider |
| **Format Modes** | Compact (<100 width), Expanded (≥100 width), Combat |
| **Tests** | ~8 new unit tests |

### Architectural Significance

This version establishes the **Reactive UI Update Pattern** that will be used throughout the game:
- Components subscribe to data change events
- Automatic refresh on state changes
- Format adapts to available space

---

## 2. Feature Overview

```
v0.6.0b Features
├── StatusBar Component
│   ├── Render to footer panel
│   ├── Content formatting
│   ├── Auto-refresh on data change
│   └── Format mode selection
├── IStatusBarDataProvider
│   ├── Health (Current, Max)
│   ├── Primary Resource (Current, Max, Name)
│   ├── Experience (Current, ToNext)
│   ├── Gold
│   ├── Location
│   ├── Combat Info (Round, IsPlayerTurn)
│   └── OnDataChanged event
└── Display Formats
    ├── Compact format (<100 chars)
    ├── Expanded format (≥100 chars)
    ├── Combat format (round/turn display)
    └── Low HP warning indicator
```

---

## 3. Architecture Diagrams

### 3.1 Status Bar Architecture

```
┌─────────────────────────────────────────────────────────────────────┐
│                    STATUS BAR ARCHITECTURE                           │
└─────────────────────────────────────────────────────────────────────┘

    DOMAIN LAYER                APPLICATION LAYER           PRESENTATION LAYER
    ────────────                ─────────────────           ──────────────────
    
    ┌─────────────┐            ┌─────────────────────┐     ┌─────────────────┐
    │   Player    │            │ IStatusBarDataProvider   │     StatusBar     │
    ├─────────────┤            ├─────────────────────┤     ├─────────────────┤
    │ Health      │◀───────────│ Health              │────▶│ Render()        │
    │ Resources[] │            │ PrimaryResource     │     │ Refresh()       │
    │ Gold        │            │ Experience          │     │ FormatContent() │
    │ Level       │            │ Gold                │     └────────┬────────┘
    └─────────────┘            │ Location            │              │
                               │ CombatInfo          │              │
    ┌─────────────┐            │ OnDataChanged       │              │
    │    Room     │◀───────────└─────────────────────┘              │
    ├─────────────┤                     ▲                           │
    │ Name        │                     │ fires                     │
    └─────────────┘                     │ event                     │
                               ┌─────────────────────┐              │
    ┌─────────────┐            │  Game State Changes │              │
    │ CombatState │◀───────────│  (HP, Gold, Room)   │              │
    ├─────────────┤            └─────────────────────┘              │
    │ Round       │                                                 │
    │ ActiveTurn  │                                                 │
    └─────────────┘                                                 │
                                                                    ▼
                                                           ┌─────────────────┐
                                                           │   ScreenLayout  │
                                                           │   (v0.6.0a)     │
                                                           ├─────────────────┤
                                                           │ Footer Panel    │
                                                           └─────────────────┘
```

### 3.2 Auto-Refresh Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                       AUTO-REFRESH FLOW                              │
└─────────────────────────────────────────────────────────────────────┘

    Game State Changes              Data Provider              StatusBar
    ──────────────────              ─────────────              ─────────

    ┌─────────────────┐
    │ Player.TakeDamage() │
    │ HP: 100 → 85        │
    └─────────┬───────────┘
              │
              ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │  IStatusBarDataProvider.OnDataChanged fires                      │
    └─────────────────────────────────────┬───────────────────────────┘
                                          │
                                          ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │  StatusBar.Refresh()                                             │
    ├─────────────────────────────────────────────────────────────────┤
    │  1. Get panel from ScreenLayout (Footer)                         │
    │  2. Determine format mode (Compact/Expanded/Combat)              │
    │  3. Format content string                                        │
    │  4. Render to panel via ScreenLayout.RenderToPanel()             │
    └─────────────────────────────────────────────────────────────────┘
                                          │
                                          ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │  Footer Panel Updated                                            │
    │  ┌────────────────────────────────────────────────────────────┐ │
    │  │ HP:85/100 | MP:60/100 | XP:450/1000 | Gold:150 | Dark Cave │ │
    │  └────────────────────────────────────────────────────────────┘ │
    └─────────────────────────────────────────────────────────────────┘
```

### 3.3 Format Selection Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                     FORMAT SELECTION FLOW                            │
└─────────────────────────────────────────────────────────────────────┘

    StatusBar.FormatContent(availableWidth)
                    │
                    ▼
    ┌───────────────────────────────────┐
    │  Check: In Combat?                │
    └───────────────┬───────────────────┘
                    │
         YES ───────┴─────── NO
          │                   │
          ▼                   ▼
    ┌─────────────┐   ┌───────────────────────────────┐
    │ COMBAT MODE │   │  Check: Width >= 100?         │
    │             │   └───────────────┬───────────────┘
    │ HP | MP |   │            YES ───┴─── NO
    │ Round N |   │             │           │
    │ YOUR TURN   │             ▼           ▼
    └─────────────┘   ┌─────────────┐ ┌─────────────┐
                      │  EXPANDED   │ │   COMPACT   │
                      │             │ │             │
                      │ Health: X/Y │ │ HP:X/Y |    │
                      │ Mana: X/Y   │ │ MP:X/Y |    │
                      │ XP: X/Y     │ │ XP:X/Y |    │
                      │ (Level N)   │ │ Gold:N      │
                      └─────────────┘ └─────────────┘
```

---

## 4. Status Bar Component

### 4.1 StatusBar Class

**File:** `src/Presentation/RuneAndRust.TUI/UI/StatusBar.cs`

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Renders the persistent status bar in the footer panel.
/// </summary>
/// <remarks>
/// The status bar displays player information (HP, MP, XP, Gold, Location)
/// and automatically refreshes when the underlying data changes.
/// </remarks>
public class StatusBar : IDisposable
{
    private readonly IStatusBarDataProvider _dataProvider;
    private readonly ScreenLayout _layout;
    private readonly ILogger<StatusBar> _logger;
    
    private const int ExpandedWidthThreshold = 100;
    private const double LowHpThreshold = 0.25;
    
    public StatusBar(
        IStatusBarDataProvider dataProvider,
        ScreenLayout layout,
        ILogger<StatusBar> logger)
    {
        _dataProvider = dataProvider;
        _layout = layout;
        _logger = logger;
        
        _dataProvider.OnDataChanged += Refresh;
        
        _logger.LogDebug("StatusBar initialized");
    }
    
    /// <summary>
    /// Renders the status bar to the footer panel.
    /// </summary>
    public void Render()
    {
        var panel = _layout.GetPanel(PanelPosition.Footer);
        if (panel == null)
        {
            _logger.LogWarning("Footer panel not found");
            return;
        }
        
        var content = FormatContent(panel.Value.ContentWidth);
        _layout.RenderToPanel(PanelPosition.Footer, new[] { content });
        
        _logger.LogDebug("StatusBar rendered: {Content}", content);
    }
    
    /// <summary>
    /// Refreshes the status bar content.
    /// </summary>
    public void Refresh()
    {
        Render();
    }
    
    /// <summary>
    /// Formats the status bar content for the available width.
    /// </summary>
    /// <param name="availableWidth">Width in characters.</param>
    /// <returns>Formatted status string.</returns>
    private string FormatContent(int availableWidth)
    {
        var combat = _dataProvider.CombatInfo;
        
        if (combat.HasValue)
        {
            return FormatCombatMode(availableWidth, combat.Value);
        }
        
        return availableWidth >= ExpandedWidthThreshold
            ? FormatExpanded(availableWidth)
            : FormatCompact(availableWidth);
    }
    
    /// <summary>
    /// Formats status for compact display (<100 width).
    /// </summary>
    private string FormatCompact(int width)
    {
        var health = _dataProvider.Health;
        var resource = _dataProvider.PrimaryResource;
        var xp = _dataProvider.Experience;
        var gold = _dataProvider.Gold;
        var location = _dataProvider.Location;
        
        var hpWarning = IsLowHp() ? " ⚠" : "";
        
        var parts = new List<string>
        {
            $"HP:{health.Current}/{health.Max}{hpWarning}"
        };
        
        if (resource.HasValue)
        {
            parts.Add($"{GetResourceAbbrev(resource.Value.Name)}:{resource.Value.Current}/{resource.Value.Max}");
        }
        
        parts.Add($"XP:{xp.Current}/{xp.ToNext}");
        parts.Add($"Gold:{gold}");
        parts.Add(TruncateLocation(location, width - string.Join(" | ", parts).Length - 3));
        
        return string.Join(" | ", parts);
    }
    
    /// <summary>
    /// Formats status for expanded display (≥100 width).
    /// </summary>
    private string FormatExpanded(int width)
    {
        var health = _dataProvider.Health;
        var resource = _dataProvider.PrimaryResource;
        var xp = _dataProvider.Experience;
        var gold = _dataProvider.Gold;
        var location = _dataProvider.Location;
        
        var hpWarning = IsLowHp() ? " ⚠" : "";
        
        var parts = new List<string>
        {
            $"Health: {health.Current}/{health.Max}{hpWarning}"
        };
        
        if (resource.HasValue)
        {
            parts.Add($"{resource.Value.Name}: {resource.Value.Current}/{resource.Value.Max}");
        }
        
        parts.Add($"XP: {xp.Current}/{xp.ToNext}");
        parts.Add($"Gold: {gold}");
        parts.Add($"Location: {location}");
        
        return string.Join(" | ", parts);
    }
    
    /// <summary>
    /// Formats status for combat mode.
    /// </summary>
    private string FormatCombatMode(int width, (int Round, bool IsPlayerTurn) combat)
    {
        var health = _dataProvider.Health;
        var resource = _dataProvider.PrimaryResource;
        var location = _dataProvider.Location;
        
        var hpWarning = IsLowHp() ? " ⚠" : "";
        var turnIndicator = combat.IsPlayerTurn ? "YOUR TURN" : "ENEMY TURN";
        
        var parts = new List<string>
        {
            $"HP:{health.Current}/{health.Max}{hpWarning}"
        };
        
        if (resource.HasValue)
        {
            parts.Add($"{GetResourceAbbrev(resource.Value.Name)}:{resource.Value.Current}/{resource.Value.Max}");
        }
        
        parts.Add($"Round {combat.Round}");
        parts.Add(turnIndicator);
        parts.Add(TruncateLocation(location, 20));
        
        return string.Join(" | ", parts);
    }
    
    /// <summary>
    /// Checks if player HP is below the low threshold.
    /// </summary>
    private bool IsLowHp()
    {
        var health = _dataProvider.Health;
        return health.Max > 0 && 
               (double)health.Current / health.Max <= LowHpThreshold;
    }
    
    /// <summary>
    /// Gets abbreviated resource name for compact display.
    /// </summary>
    private static string GetResourceAbbrev(string resourceName)
    {
        return resourceName.ToUpperInvariant() switch
        {
            "MANA" => "MP",
            "RAGE" => "RG",
            "ENERGY" => "EN",
            "STAMINA" => "ST",
            "FOCUS" => "FO",
            _ => resourceName[..Math.Min(2, resourceName.Length)].ToUpperInvariant()
        };
    }
    
    /// <summary>
    /// Truncates location name to fit available space.
    /// </summary>
    private static string TruncateLocation(string location, int maxLength)
    {
        if (maxLength <= 0) return "";
        if (location.Length <= maxLength) return location;
        if (maxLength <= 3) return location[..maxLength];
        return location[..(maxLength - 3)] + "...";
    }
    
    public void Dispose()
    {
        _dataProvider.OnDataChanged -= Refresh;
    }
}
```

---

## 5. Data Provider

### 5.1 IStatusBarDataProvider Interface

**File:** `src/Core/RuneAndRust.Application/Interfaces/IStatusBarDataProvider.cs`

```csharp
namespace RuneAndRust.Application.Interfaces;

/// <summary>
/// Provides data for the status bar display.
/// </summary>
/// <remarks>
/// Implementations should fire OnDataChanged whenever any property
/// changes to trigger status bar refresh.
/// </remarks>
public interface IStatusBarDataProvider
{
    /// <summary>
    /// Gets current health points.
    /// </summary>
    (int Current, int Max) Health { get; }
    
    /// <summary>
    /// Gets current primary resource (MP, Rage, etc.).
    /// </summary>
    /// <remarks>
    /// Null if the player's class has no resource pool.
    /// </remarks>
    (int Current, int Max, string Name)? PrimaryResource { get; }
    
    /// <summary>
    /// Gets current XP progress.
    /// </summary>
    (int Current, int ToNext) Experience { get; }
    
    /// <summary>
    /// Gets current gold amount.
    /// </summary>
    int Gold { get; }
    
    /// <summary>
    /// Gets current location name.
    /// </summary>
    string Location { get; }
    
    /// <summary>
    /// Gets combat turn info if currently in combat.
    /// </summary>
    /// <remarks>
    /// Null when not in combat.
    /// </remarks>
    (int Round, bool IsPlayerTurn)? CombatInfo { get; }
    
    /// <summary>
    /// Event raised when any status bar data changes.
    /// </summary>
    event Action? OnDataChanged;
}
```

### 5.2 StatusBarDataProvider Implementation

**File:** `src/Infrastructure/RuneAndRust.Infrastructure/Providers/StatusBarDataProvider.cs`

```csharp
namespace RuneAndRust.Infrastructure.Providers;

/// <summary>
/// Provides status bar data from game state.
/// </summary>
public class StatusBarDataProvider : IStatusBarDataProvider
{
    private readonly IGameStateService _gameState;
    private readonly IEventBus _eventBus;
    private readonly ILogger<StatusBarDataProvider> _logger;
    
    public event Action? OnDataChanged;
    
    public StatusBarDataProvider(
        IGameStateService gameState,
        IEventBus eventBus,
        ILogger<StatusBarDataProvider> logger)
    {
        _gameState = gameState;
        _eventBus = eventBus;
        _logger = logger;
        
        // Subscribe to relevant game events
        _eventBus.Subscribe<PlayerHealthChangedEvent>(OnPlayerHealthChanged);
        _eventBus.Subscribe<PlayerResourceChangedEvent>(OnPlayerResourceChanged);
        _eventBus.Subscribe<PlayerGoldChangedEvent>(OnPlayerGoldChanged);
        _eventBus.Subscribe<PlayerExperienceChangedEvent>(OnPlayerExperienceChanged);
        _eventBus.Subscribe<RoomChangedEvent>(OnRoomChanged);
        _eventBus.Subscribe<CombatStartedEvent>(OnCombatStateChanged);
        _eventBus.Subscribe<CombatEndedEvent>(OnCombatStateChanged);
        _eventBus.Subscribe<CombatTurnChangedEvent>(OnCombatStateChanged);
    }
    
    public (int Current, int Max) Health
    {
        get
        {
            var player = _gameState.CurrentPlayer;
            return (player?.Health ?? 0, player?.Stats.MaxHealth ?? 0);
        }
    }
    
    public (int Current, int Max, string Name)? PrimaryResource
    {
        get
        {
            var player = _gameState.CurrentPlayer;
            var primary = player?.ResourcePools.FirstOrDefault();
            if (primary == null) return null;
            
            return (primary.Current, primary.Max, primary.Definition.DisplayName);
        }
    }
    
    public (int Current, int ToNext) Experience
    {
        get
        {
            var player = _gameState.CurrentPlayer;
            return (player?.Experience ?? 0, player?.ExperienceToNextLevel ?? 1000);
        }
    }
    
    public int Gold => _gameState.CurrentPlayer?.Gold ?? 0;
    
    public string Location => _gameState.CurrentRoom?.Name ?? "Unknown";
    
    public (int Round, bool IsPlayerTurn)? CombatInfo
    {
        get
        {
            var combat = _gameState.CurrentCombat;
            if (combat == null || !combat.IsActive) return null;
            
            return (combat.Round, combat.IsPlayerTurn);
        }
    }
    
    private void OnPlayerHealthChanged(PlayerHealthChangedEvent e)
    {
        _logger.LogDebug("Health changed: {Old} -> {New}", e.OldHealth, e.NewHealth);
        OnDataChanged?.Invoke();
    }
    
    private void OnPlayerResourceChanged(PlayerResourceChangedEvent e)
    {
        OnDataChanged?.Invoke();
    }
    
    private void OnPlayerGoldChanged(PlayerGoldChangedEvent e)
    {
        OnDataChanged?.Invoke();
    }
    
    private void OnPlayerExperienceChanged(PlayerExperienceChangedEvent e)
    {
        OnDataChanged?.Invoke();
    }
    
    private void OnRoomChanged(RoomChangedEvent e)
    {
        OnDataChanged?.Invoke();
    }
    
    private void OnCombatStateChanged(IGameEvent e)
    {
        OnDataChanged?.Invoke();
    }
}
```

---

## 6. Format Modes

### 6.1 Compact Format (<100 width)

```
┌────────────────────────────────────────────────────────────────────┐
│ HP:80/100 | MP:60/100 | XP:450/1000 | Gold:150 | Dark Cave         │
└────────────────────────────────────────────────────────────────────┘
```

**Characteristics:**
- Abbreviated labels (HP, MP, XP)
- Minimal spacing
- Location truncated to fit

### 6.2 Expanded Format (≥100 width)

```
┌────────────────────────────────────────────────────────────────────────────────────────────┐
│ Health: 80/100 | Mana: 60/100 | XP: 450/1000 | Gold: 150 | Location: Dark Cave            │
└────────────────────────────────────────────────────────────────────────────────────────────┘
```

**Characteristics:**
- Full labels (Health, Mana, Location)
- More spacing
- Full location name

### 6.3 Combat Format

```
┌────────────────────────────────────────────────────────────────────┐
│ HP:80/100 | MP:60/100 | Round 3 | YOUR TURN | Dark Cave            │
└────────────────────────────────────────────────────────────────────┘
```

**Characteristics:**
- Same as compact for HP/MP
- XP/Gold hidden (not relevant in combat)
- Round number displayed
- Turn indicator (YOUR TURN / ENEMY TURN)

### 6.4 Low HP Warning

```
┌────────────────────────────────────────────────────────────────────┐
│ HP:15/100 ⚠ | MP:60/100 | XP:450/1000 | Gold:150 | Dark Cave       │
└────────────────────────────────────────────────────────────────────┘
```

**Trigger:** HP ≤ 25% of Max HP

---

## 7. Data Model

### 7.1 New Interfaces

| Interface | Layer | Description |
|-----------|-------|-------------|
| `IStatusBarDataProvider` | Application | Status bar data source |

### 7.2 New Classes

| Class | Layer | Description |
|-------|-------|-------------|
| `StatusBar` | Presentation | Status bar UI component |
| `StatusBarDataProvider` | Infrastructure | Data provider implementation |

### 7.3 Dependencies on v0.6.0a

| Type | Usage |
|------|-------|
| `ScreenLayout` | Get footer panel, render content |
| `Panel` | Check content width for format selection |
| `PanelPosition.Footer` | Target panel for status bar |

---

## 8. Configuration

### 8.1 Status Bar Configuration

**File:** `config/status-bar.json`

```json
{
  "$schema": "./schemas/status-bar.schema.json",
  "statusBar": {
    "expandedWidthThreshold": 100,
    "lowHpThreshold": 0.25,
    "resourceAbbreviations": {
      "mana": "MP",
      "rage": "RG",
      "energy": "EN",
      "stamina": "ST",
      "focus": "FO"
    },
    "format": {
      "separator": " | ",
      "lowHpWarning": "⚠",
      "playerTurnIndicator": "YOUR TURN",
      "enemyTurnIndicator": "ENEMY TURN"
    }
  }
}
```

### 8.2 Configuration Schema

| Property | Type | Default | Description |
|----------|------|---------|-------------|
| `expandedWidthThreshold` | int | 100 | Width threshold for expanded format |
| `lowHpThreshold` | double | 0.25 | HP ratio for low HP warning (25%) |
| `resourceAbbreviations` | object | (see above) | Resource name → abbreviation map |
| `format.separator` | string | " \| " | Section separator |
| `format.lowHpWarning` | string | "⚠" | Low HP warning symbol |

---

## 9. Logging Specifications

### 9.1 Log Levels by Component

| Component | Level | Events |
|-----------|-------|--------|
| `StatusBar` | Debug | Initialization, render |
| `StatusBar` | Warning | Footer panel not found |
| `StatusBarDataProvider` | Debug | Data change events |

### 9.2 Log Message Templates

```csharp
// StatusBar
_logger.LogDebug("StatusBar initialized");
_logger.LogDebug("StatusBar rendered: {Content}", content);
_logger.LogWarning("Footer panel not found");

// StatusBarDataProvider
_logger.LogDebug("Health changed: {Old} -> {New}", oldHealth, newHealth);
```

---

## 10. Unit Testing Requirements

### 10.1 Test Count by Feature

| Feature | Test Count |
|---------|------------|
| StatusBar formatting | 4 |
| StatusBarDataProvider | 2 |
| Auto-refresh | 2 |
| **Total** | **~8** |

### 10.2 Test Specifications

#### StatusBarTests.cs

```csharp
[TestFixture]
public class StatusBarTests
{
    [Test]
    public void FormatContent_WithNarrowWidth_ReturnsCompactFormat();
    
    [Test]
    public void FormatContent_WithWideWidth_ReturnsExpandedFormat();
    
    [Test]
    public void FormatContent_InCombat_ReturnsCombatFormat();
    
    [Test]
    public void FormatContent_WithLowHp_IncludesWarningSymbol();
    
    [Test]
    public void Refresh_WhenCalled_RendersToFooterPanel();
    
    [Test]
    public void Constructor_SubscribesToOnDataChanged();
}
```

#### StatusBarDataProviderTests.cs

```csharp
[TestFixture]
public class StatusBarDataProviderTests
{
    [Test]
    public void Health_ReturnsCurrentAndMax();
    
    [Test]
    public void OnDataChanged_FiresWhenHealthChanges();
}
```

---

## 11. Use Cases

### UC-001: Display Initial Status
**Actor:** System
**Flow:** Game start → StatusBar created → Render() called → Status displayed in footer

### UC-002: Update on Damage
**Actor:** System
**Flow:** Player takes damage → PlayerHealthChangedEvent → OnDataChanged fires → StatusBar.Refresh() → Updated HP displayed

### UC-003: Enter Combat Mode
**Actor:** System
**Flow:** Combat starts → CombatStartedEvent → OnDataChanged fires → StatusBar.Refresh() → Combat format displayed with round/turn

### UC-004: Exit Combat Mode
**Actor:** System
**Flow:** Combat ends → CombatEndedEvent → OnDataChanged fires → StatusBar.Refresh() → Normal format restored

### UC-005: Change Room
**Actor:** Player
**Flow:** Player moves to new room → RoomChangedEvent → OnDataChanged fires → StatusBar.Refresh() → New location displayed

---

## 12. Deliverable Checklist

### Status Bar Component
- [ ] `StatusBar` class created
- [ ] Render() method implemented
- [ ] Refresh() method implemented
- [ ] FormatContent() method implemented
- [ ] FormatCompact() implemented
- [ ] FormatExpanded() implemented
- [ ] FormatCombatMode() implemented
- [ ] IsLowHp() check implemented
- [ ] GetResourceAbbrev() helper implemented
- [ ] TruncateLocation() helper implemented
- [ ] Auto-refresh subscription implemented
- [ ] Dispose() cleanup implemented

### Data Provider
- [ ] `IStatusBarDataProvider` interface created
- [ ] `StatusBarDataProvider` implementation created
- [ ] Health property implemented
- [ ] PrimaryResource property implemented
- [ ] Experience property implemented
- [ ] Gold property implemented
- [ ] Location property implemented
- [ ] CombatInfo property implemented
- [ ] OnDataChanged event implemented
- [ ] Event subscriptions implemented

### Configuration
- [ ] `config/status-bar.json` created (optional)

### Testing
- [ ] ~8 unit tests implemented
- [ ] All tests passing

---

## 13. Acceptance Criteria

### Functional
- [ ] StatusBar renders to footer panel correctly
- [ ] HP displays as Current/Max format
- [ ] MP/resource displays correctly (or hidden if none)
- [ ] XP displays as Current/ToNext format
- [ ] Gold displays as integer
- [ ] Location name displays
- [ ] Combat mode shows Round N and YOUR TURN/ENEMY TURN
- [ ] Low HP warning (⚠) appears when HP ≤ 25%
- [ ] Compact format used when width < 100
- [ ] Expanded format used when width ≥ 100
- [ ] Auto-refresh triggers on player state change
- [ ] Location truncated with ... when too long

### Quality
- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] All ~8 unit tests pass
- [ ] XML documentation complete on all public members

---

## 14. Dependencies

### Required from v0.6.0a

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `ScreenLayout` | `Presentation/UI/ScreenLayout.cs` | Get footer panel, render content |
| `Panel` | `Presentation/UI/Panel.cs` | Check content width |
| `PanelPosition` | `Presentation/UI/PanelPosition.cs` | Footer position constant |

### Required from Prior Versions

| Type | Location | Usage |
|------|----------|-------|
| `Player` | `Domain/Entities/Player.cs` | Health, Gold, Resources |
| `Room` | `Domain/Entities/Room.cs` | Location name |
| `IEventBus` | `Application/Interfaces/IEventBus.cs` | Event subscriptions |
| `IGameStateService` | `Application/Interfaces/IGameStateService.cs` | Current player/room |

### Provides to v0.6.0c

| Type | Usage |
|------|-------|
| `StatusBar` | Will be enhanced with colored text via IColorThemeService |
| `IStatusBarDataProvider` | Pattern for other reactive UI components |

---

## 15. Future Considerations

### Deferred to v0.6.0c
- **Colored Status Values**: HP in red when low, gold in yellow (requires color themes)

### Deferred to v0.6.1
- **Health Bar Visualization**: Visual bar instead of numbers

### Out of Scope
- **Custom Status Bar Layout**: User-configurable field order (future)
- **Status Bar Icons**: Graphical icons for stats (GUI only)
- **Multiple Resource Pools**: Showing all resources (current: primary only)

---

*Document Version: 1.0*
*Last Updated: 2026-01-10*
*Author: Assistant*
