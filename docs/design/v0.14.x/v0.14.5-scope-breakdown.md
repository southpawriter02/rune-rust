# v0.14.5 Economy Configuration Schemas - Scope Breakdown

**Version:** 0.14.5
**Theme:** Economy Configuration Schemas
**Prerequisites:** v0.14.4 Complete (Environment Configuration Schemas)
**Total Estimated Tests:** ~20 new tests

---

## Executive Summary

The Economy Configuration Schemas version creates comprehensive JSON schemas for all economy-related configuration files, enabling full customization of currencies, resources, crafting recipes, and vendor shops without code changes. This supports modding scenarios like sci-fi credit systems, barter economies, complex crafting trees, or faction-based merchants.

The work is divided into **four sub-parts**:

| Part | Name | Focus | Est. Tests |
|------|------|-------|------------|
| v0.14.5a | Currency Schema | currency.schema.json with exchange rates, display formatting, caps | 9 âœ“ |
| v0.14.5b | Resource Schema | resources.schema.json with regeneration, depletion, visual representation | 11 âœ“ |
| v0.14.5c | Crafting Recipe Schema | recipes.schema.json with materials, skills, outputs, stations | 12 âœ“ |
| v0.14.5d | Vendor Schema | vendors.schema.json with inventory, pricing, restock rules | 11 âœ“ |

---

## Feature Analysis & Categorization

### From v0.14.x-overview.md - Economy Configuration Schemas

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| currency.schema.json | Low | None | **v0.14.5a** |
| Exchange rates | Low | currency.schema.json | **v0.14.5a** |
| Display formatting | Low | currency.schema.json | **v0.14.5a** |
| Cap limits | Low | currency.schema.json | **v0.14.5a** |
| resources.schema.json | Medium | None | **v0.14.5b** |
| Regeneration rules | Medium | resources.schema.json | **v0.14.5b** |
| Maximum calculations | Low | resources.schema.json | **v0.14.5b** |
| Depletion effects | Medium | resources.schema.json | **v0.14.5b** |
| Visual representations | Low | resources.schema.json | **v0.14.5b** |
| recipes.schema.json | High | items, skills | **v0.14.5c** |
| Material requirements | Medium | recipes.schema.json | **v0.14.5c** |
| Skill requirements | Low | recipes.schema.json | **v0.14.5c** |
| Output definitions | Medium | recipes.schema.json | **v0.14.5c** |
| Station requirements | Low | recipes.schema.json | **v0.14.5c** |
| Discovery conditions | Medium | recipes.schema.json | **v0.14.5c** |
| vendors.schema.json | Medium | items, currency | **v0.14.5d** |
| Inventory definitions | Medium | vendors.schema.json | **v0.14.5d** |
| Price modifiers | Medium | vendors.schema.json | **v0.14.5d** |
| Restock rules | Low | vendors.schema.json | **v0.14.5d** |
| Specialty categories | Low | vendors.schema.json | **v0.14.5d** |

---

## Existing Infrastructure

### Current Configuration Files

| File | Current State | Schema Exists |
|------|---------------|---------------|
| `config/currency.json` | 1 currency (gold) | No |
| `config/resources.json` | 6 resources (health, mana, rage, energy, faith, focus) | No |
| `config/recipes.json` | Does not exist yet | No |
| `config/vendors.json` | Does not exist yet | No |

### Current Currency Structure

```json
{
  "id": "gold",
  "name": "Gold",
  "pluralName": "Gold",
  "symbol": "G",
  "color": "yellow",
  "sortOrder": 0
}
```

### Current Resource Structure

```json
{
  "id": "rage",
  "displayName": "Fury",
  "abbreviation": "RG",
  "description": "Battle fury that builds from combat. Decays when not fighting.",
  "color": "#FF6600",
  "defaultMax": 100,
  "regenPerTurn": 0,
  "decayPerTurn": 10,
  "decayOnlyOutOfCombat": true,
  "buildOnDamageDealt": 10,
  "buildOnDamageTaken": 15,
  "isUniversal": false,
  "startsAtZero": true,
  "sortOrder": 2
}
```

### Key Schema Conventions

- JSON Schema Draft-07 format
- ID pattern: `^[a-z][a-z0-9-]*$` (lowercase kebab-case)
- Definitions section for reusable types
- Required fields explicitly listed
- Descriptions on all properties

---

## Phase Definitions

---

## v0.14.5a: Currency Schema

[v0.14.5a Design Specification](v0.14.5a-design-specification.md)

### Overview

Create a comprehensive JSON schema for currency definitions that validates display formatting, exchange rates, cap limits, and visual representation.

### Scope

**In Scope:**
- `currency.schema.json` - Full schema for currency definitions
- Display name (singular and plural)
- Symbol configuration (character, position)
- Color for UI display
- Exchange rates between currencies
- Maximum carry limits (caps)
- Decimal places for fractional currencies
- Sort order for display

**Out of Scope:**
- Resource schema (v0.14.5b)
- Recipe schema (v0.14.5c)
- Vendor schema (v0.14.5d)
- Currency transaction logic (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `currency.schema.json` |
| Schema Definitions | 2 | `CurrencyDefinition`, `ExchangeRate` |
| Configuration Updates | 1 | Update `currency.json` to reference new schema |
| Unit Tests | ~4 | Schema validation tests |

### Schema Structure

```
currency.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Currency Configuration"
|-- description: "Schema for currency definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string (optional)
|   +-- currencies: array of CurrencyDefinition
|-- required: ["currencies"]
+-- definitions:
    |-- CurrencyDefinition
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- name: string (minLength: 1)
    |   |-- pluralName: string (optional, defaults to name)
    |   |-- symbol: string (minLength: 1, maxLength: 3)
    |   |-- symbolPosition: string (enum: Before, After, default: Before)
    |   |-- color: string (hex color or named color)
    |   |-- decimalPlaces: integer (minimum: 0, maximum: 4, default: 0)
    |   |-- maxAmount: integer (optional, cap limit)
    |   |-- exchangeRates: array of ExchangeRate (optional)
    |   |-- isTradeOnly: boolean (default: false, can't be looted)
    |   |-- description: string (optional)
    |   +-- sortOrder: integer (minimum: 0, default: 0)
    +-- ExchangeRate
        |-- targetCurrencyId: string (references another currency)
        |-- rate: number (minimum: 0.001, exchange ratio)
        +-- bidirectional: boolean (default: true)
```

### Currency Examples

| Currency | Symbol | Position | Decimals | Cap |
|----------|--------|----------|----------|-----|
| `gold` | G | Before | 0 | None |
| `silver` | S | Before | 0 | None |
| `copper` | C | Before | 0 | None |
| `gems` | ğŸ’ | After | 0 | 999 |
| `credits` | CR | Before | 2 | 999999 |

### Exchange Rate Examples

| From | To | Rate | Meaning |
|------|-----|------|---------|
| gold | silver | 10 | 1 gold = 10 silver |
| silver | copper | 10 | 1 silver = 10 copper |
| gems | gold | 100 | 1 gem = 100 gold |

### Acceptance Criteria

- [x] `currency.schema.json` created in `config/schemas/`
- [x] Schema validates existing `currency.json` without errors
- [x] ID pattern validated (lowercase kebab-case)
- [x] Symbol validated (1-3 characters)
- [x] Symbol position enum validated (Before, After)
- [x] Color validated as string
- [x] Decimal places validated (0-4 range)
- [x] Exchange rates validated with target currency reference
- [x] Max amount validated as optional positive integer
- [x] ~4 unit tests pass (9 implemented)

---

## v0.14.5b: Resource Schema

[v0.14.5b Design Specification](v0.14.5b-design-specification.md)

### Overview

Create a comprehensive JSON schema for resource definitions that validates regeneration rules, maximum calculations, depletion effects, and visual representations for class resources like mana, rage, and energy.

### Scope

**In Scope:**
- `resources.schema.json` - Full schema for resource definitions
- Display name and abbreviation
- Color for UI bars
- Default maximum value
- Regeneration per turn
- Decay per turn
- Combat-only decay flag
- Build-on-action triggers (damage dealt, damage taken, healing)
- Universal resource flag (all classes have it)
- Starting value configuration (zero vs max)
- Depletion effect references (what happens at 0)

**Out of Scope:**
- Currency schema (v0.14.5a)
- Recipe schema (v0.14.5c)
- Vendor schema (v0.14.5d)
- Resource calculation logic (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `resources.schema.json` |
| Schema Definitions | 3 | `ResourceDefinition`, `MaxCalculation`, `DepletionEffect` |
| Configuration Updates | 1 | Update `resources.json` to reference new schema |
| Unit Tests | ~5 | Schema validation tests |

### Schema Structure

```
resources.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Resource Configuration"
|-- description: "Schema for class resource definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string (optional)
|   +-- resourceTypes: array of ResourceDefinition
|-- required: ["resourceTypes"]
+-- definitions:
    |-- ResourceDefinition
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- displayName: string (minLength: 1)
    |   |-- abbreviation: string (minLength: 1, maxLength: 4)
    |   |-- description: string
    |   |-- color: string (hex color, e.g., "#FF0000")
    |   |-- defaultMax: integer (minimum: 1)
    |   |-- maxCalculation: MaxCalculation (optional)
    |   |-- regenPerTurn: integer (minimum: 0, default: 0)
    |   |-- regenOutOfCombatOnly: boolean (default: false)
    |   |-- decayPerTurn: integer (minimum: 0, default: 0)
    |   |-- decayOnlyOutOfCombat: boolean (default: false)
    |   |-- buildOnDamageDealt: integer (optional)
    |   |-- buildOnDamageTaken: integer (optional)
    |   |-- buildOnHeal: integer (optional)
    |   |-- buildOnKill: integer (optional)
    |   |-- buildOnCritical: integer (optional)
    |   |-- isUniversal: boolean (default: false)
    |   |-- startsAtZero: boolean (default: false)
    |   |-- depletionEffect: DepletionEffect (optional)
    |   |-- iconId: string (optional)
    |   +-- sortOrder: integer (minimum: 0)
    |-- MaxCalculation
    |   |-- baseValue: integer (minimum: 1)
    |   |-- perLevelBonus: integer (optional)
    |   |-- attributeScaling: AttributeScaling (optional)
    |   +-- classOverrides: object (classId -> max value, optional)
    |-- AttributeScaling
    |   |-- attribute: string (enum: might, fortitude, will, wits, finesse)
    |   +-- multiplier: number (minimum: 0)
    +-- DepletionEffect
        |-- statusEffectId: string (optional, apply status at 0)
        |-- preventActions: boolean (default: false)
        +-- message: string (optional, display when depleted)
```

### Resource Types

| Resource | Regen | Decay | Build On | Class |
|----------|-------|-------|----------|-------|
| `health` | 0 | 0 | N/A | Universal |
| `mana` | 10/turn | 0 | N/A | Galdr-Caster |
| `rage` | 0 | 10/turn (OOC) | Damage dealt/taken | Shieldmaiden |
| `energy` | 20/turn | 0 | N/A | Shadow-Walker |
| `faith` | 5/turn | 0 | Healing | Blood-Priest |
| `focus` | 8/turn | 0 | N/A | Scrap-Tinker |

### Build Triggers

| Trigger | Description | Example |
|---------|-------------|---------|
| `buildOnDamageDealt` | Gain resource when dealing damage | Rage +10 per hit |
| `buildOnDamageTaken` | Gain resource when taking damage | Rage +15 per hit |
| `buildOnHeal` | Gain resource when healing | Faith +15 per heal |
| `buildOnKill` | Gain resource on killing blow | Energy +25 per kill |
| `buildOnCritical` | Gain resource on critical hit | Focus +10 per crit |

### Acceptance Criteria

- [x] `resources.schema.json` created in `config/schemas/`
- [x] Schema validates existing `resources.json` without errors
- [x] ID pattern validated (lowercase kebab-case)
- [x] Abbreviation validated (1-4 characters)
- [x] Color validated as hex color string
- [x] Default max validated as positive integer
- [x] Regen/decay validated as non-negative integers
- [x] Build-on triggers validated as optional integers
- [x] Universal and starts-at-zero flags validated
- [x] Depletion effect validated with optional status reference
- [x] ~5 unit tests pass (11 implemented)

---

## v0.14.5c: Crafting Recipe Schema

[v0.14.5c Design Specification](v0.14.5c-design-specification.md)

### Overview

Create a comprehensive JSON schema for crafting recipe definitions that validates material requirements, skill checks, output items, station requirements, and discovery conditions.

### Scope

**In Scope:**
- `recipes.schema.json` - Full schema for crafting recipes
- Recipe categories (Alchemy, Smithing, Enchanting, Cooking, etc.)
- Material requirements (item id, quantity)
- Skill requirements (skill id, DC)
- Output definitions (item id, quantity, quality variance)
- Crafting station requirements
- Discovery conditions (quest, level, teacher, item)
- Crafting time (turns or real-time)
- Failure consequences

**Out of Scope:**
- Currency schema (v0.14.5a)
- Resource schema (v0.14.5b)
- Vendor schema (v0.14.5d)
- Crafting execution logic (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `recipes.schema.json` |
| Schema Definitions | 5 | `RecipeDefinition`, `MaterialRequirement`, `SkillRequirement`, `OutputDefinition`, `DiscoveryCondition` |
| Configuration Updates | 1 | Create `recipes.json` with example recipes |
| Unit Tests | ~6 | Schema validation tests |

### Schema Structure

```
recipes.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Crafting Recipe Configuration"
|-- description: "Schema for crafting recipe definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string (optional)
|   +-- recipes: array of RecipeDefinition
|-- required: ["recipes"]
+-- definitions:
    |-- RecipeDefinition
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- name: string (minLength: 1)
    |   |-- description: string
    |   |-- category: string (enum: Alchemy, Smithing, Enchanting, Cooking, Leatherworking, Tailoring, Jewelcrafting, Engineering, Inscription)
    |   |-- materials: array of MaterialRequirement (minItems: 1)
    |   |-- skillRequirements: array of SkillRequirement (optional)
    |   |-- output: OutputDefinition
    |   |-- stationRequired: string (optional, station id)
    |   |-- craftingTime: integer (optional, turns to craft)
    |   |-- discoveryCondition: DiscoveryCondition (optional)
    |   |-- isKnownByDefault: boolean (default: false)
    |   |-- failureChance: number (minimum: 0, maximum: 1, default: 0)
    |   |-- failureOutput: OutputDefinition (optional, what you get on failure)
    |   |-- experienceReward: integer (optional, crafting XP)
    |   +-- sortOrder: integer (minimum: 0, optional)
    |-- MaterialRequirement
    |   |-- itemId: string (references items.json)
    |   |-- quantity: integer (minimum: 1, default: 1)
    |   +-- isConsumed: boolean (default: true)
    |-- SkillRequirement
    |   |-- skillId: string (references skills.json)
    |   |-- minimumLevel: integer (minimum: 1, optional)
    |   +-- dc: integer (minimum: 1, optional, skill check DC)
    |-- OutputDefinition
    |   |-- itemId: string (references items.json)
    |   |-- quantity: QuantityRange
    |   |-- qualityVariance: QualityVariance (optional)
    |   +-- bonusOutputs: array of BonusOutput (optional)
    |-- QuantityRange
    |   |-- min: integer (minimum: 1, default: 1)
    |   +-- max: integer (minimum: 1, default: 1)
    |-- QualityVariance
    |   |-- baseQuality: string (enum: Common, Uncommon, Rare, Epic, Legendary)
    |   |-- upgradeChance: number (minimum: 0, maximum: 1, optional)
    |   +-- criticalUpgradeChance: number (minimum: 0, maximum: 1, optional)
    |-- BonusOutput
    |   |-- itemId: string
    |   |-- quantity: integer (minimum: 1)
    |   +-- chance: number (minimum: 0, maximum: 1)
    +-- DiscoveryCondition
        |-- type: string (enum: Quest, Level, Teacher, Item, Exploration, Default)
        |-- questId: string (optional, for Quest type)
        |-- requiredLevel: integer (optional, for Level type)
        |-- teacherNpcId: string (optional, for Teacher type)
        |-- itemId: string (optional, for Item type)
        +-- locationId: string (optional, for Exploration type)
```

### Recipe Categories

| Category | Description | Typical Output |
|----------|-------------|----------------|
| `Alchemy` | Potions and elixirs | Health Potion, Mana Elixir |
| `Smithing` | Weapons and armor | Iron Sword, Steel Plate |
| `Enchanting` | Magical enhancements | +1 Fire Damage |
| `Cooking` | Food and buffs | Grilled Meat, Hearty Stew |
| `Leatherworking` | Leather gear | Leather Armor, Boots |
| `Tailoring` | Cloth gear | Robes, Cloaks |
| `Jewelcrafting` | Accessories | Rings, Amulets |
| `Engineering` | Gadgets and traps | Mechanical Trap, Grapple |
| `Inscription` | Scrolls and glyphs | Scroll of Fireball |

### Discovery Types

| Type | Description | Example |
|------|-------------|---------|
| `Quest` | Learned from completing quest | "Alchemist's Secret" quest |
| `Level` | Unlocked at character level | Level 10 unlocks |
| `Teacher` | Purchased from NPC trainer | Blacksmith teaches |
| `Item` | Found as recipe scroll | Recipe: Iron Sword |
| `Exploration` | Discovered in location | Found in Ruins |
| `Default` | Known from start | Basic recipes |

### Acceptance Criteria

- [x] `recipes.schema.json` created in `config/schemas/`
- [x] Schema validates with sample recipes
- [x] Category enum validated (9 categories)
- [x] Materials validated with item references
- [x] Skill requirements validated with DC
- [x] Output validated with quantity range
- [x] Quality variance validated
- [x] Station requirement validated as optional string
- [x] Discovery condition validated with type enum
- [x] Failure chance validated (0-1 range)
- [x] ~6 unit tests pass (12 implemented)

---

## v0.14.5d: Vendor Schema

[v0.14.5d Design Specification](v0.14.5d-design-specification.md)

### Overview

Create a comprehensive JSON schema for vendor NPC definitions that validates inventory listings, price modifiers, restock rules, and specialty categories.

### Scope

**In Scope:**
- `vendors.schema.json` - Full schema for vendor definitions
- Vendor specialty categories (Blacksmith, Alchemist, General, etc.)
- Inventory item listings (item id, stock quantity, price override)
- Buy/sell price modifiers (base multipliers)
- Reputation effects on prices
- Charisma/skill effects on prices
- Restock rules (timer, trigger, infinite stock)
- Operating hours (optional schedule)
- Currency acceptance (which currencies)
- Dialogue references

**Out of Scope:**
- Currency schema (v0.14.5a)
- Resource schema (v0.14.5b)
- Recipe schema (v0.14.5c)
- Transaction execution logic (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `vendors.schema.json` |
| Schema Definitions | 4 | `VendorDefinition`, `InventoryItem`, `PriceModifiers`, `RestockRule` |
| Configuration Updates | 1 | Create `vendors.json` with example vendors |
| Unit Tests | ~5 | Schema validation tests |

### Schema Structure

```
vendors.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Vendor Configuration"
|-- description: "Schema for vendor NPC definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string (optional)
|   +-- vendors: array of VendorDefinition
|-- required: ["vendors"]
+-- definitions:
    |-- VendorDefinition
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- name: string (minLength: 1)
    |   |-- title: string (optional, e.g., "Master Blacksmith")
    |   |-- description: string
    |   |-- specialty: string (enum: General, Blacksmith, Armorer, Alchemist, Enchanter, Jeweler, Tailor, Innkeeper, Provisioner, Exotic)
    |   |-- inventory: array of InventoryItem
    |   |-- priceModifiers: PriceModifiers
    |   |-- restockRule: RestockRule (optional)
    |   |-- acceptedCurrencies: array of string (currency ids, default: ["gold"])
    |   |-- reputationFactionId: string (optional, reputation affects prices)
    |   |-- dialogueStartId: string (optional, references dialogue)
    |   |-- locationId: string (optional, where vendor is found)
    |   |-- operatingHours: OperatingHours (optional)
    |   +-- sortOrder: integer (minimum: 0, optional)
    |-- InventoryItem
    |   |-- itemId: string (references items, weapons, or armor)
    |   |-- itemType: string (enum: Item, Weapon, Armor, optional)
    |   |-- stockQuantity: integer (minimum: -1, -1 = infinite)
    |   |-- priceOverride: integer (optional, specific price)
    |   |-- buyPriceMultiplier: number (optional, override base)
    |   |-- sellPriceMultiplier: number (optional, override base)
    |   |-- requiredLevel: integer (optional, player level gate)
    |   |-- requiredReputationLevel: integer (optional, rep gate)
    |   +-- isRare: boolean (default: false, limited availability)
    |-- PriceModifiers
    |   |-- baseBuyMultiplier: number (minimum: 0.1, default: 1.0)
    |   |-- baseSellMultiplier: number (minimum: 0.1, default: 0.5)
    |   |-- charismaEffect: number (optional, per-point discount)
    |   |-- persuasionEffect: number (optional, per-skill-level discount)
    |   |-- reputationEffect: number (optional, per-reputation-level discount)
    |   +-- maxDiscount: number (minimum: 0, maximum: 0.9, default: 0.5)
    |-- RestockRule
    |   |-- type: string (enum: Timer, OnRest, OnLevelUp, Manual, Never)
    |   |-- timerTurns: integer (optional, for Timer type)
    |   |-- restockPercentage: number (minimum: 0, maximum: 1, default: 1.0)
    |   +-- restockRareItems: boolean (default: false)
    +-- OperatingHours
        |-- startHour: integer (minimum: 0, maximum: 23)
        |-- endHour: integer (minimum: 0, maximum: 23)
        +-- closedDays: array of string (enum: Monday-Sunday, optional)
```

### Vendor Specialties

| Specialty | Typical Inventory | Buy Multiplier |
|-----------|-------------------|----------------|
| `General` | Mixed items | 1.0x |
| `Blacksmith` | Weapons, tools | 1.0x |
| `Armorer` | Armor, shields | 1.0x |
| `Alchemist` | Potions, ingredients | 1.1x |
| `Enchanter` | Magical items, scrolls | 1.2x |
| `Jeweler` | Rings, amulets | 1.2x |
| `Tailor` | Cloth armor, bags | 0.9x |
| `Innkeeper` | Food, lodging, rumors | 0.8x |
| `Provisioner` | Supplies, rations | 0.9x |
| `Exotic` | Rare, unique items | 1.5x |

### Restock Types

| Type | Behavior | Use Case |
|------|----------|----------|
| `Timer` | Restocks after X turns | Regular merchants |
| `OnRest` | Restocks when player rests | Camp vendors |
| `OnLevelUp` | Restocks on level up | Progression-tied |
| `Manual` | Restocks via event/quest | Story vendors |
| `Never` | Fixed inventory | Unique items |

### Price Calculation

```
Final Buy Price = Base Price Ã— baseBuyMultiplier Ã— (1 - charismaDiscount) Ã— (1 - repDiscount)
Final Sell Price = Base Price Ã— baseSellMultiplier Ã— (1 + charismaBonus) Ã— (1 + repBonus)

Discounts capped at maxDiscount (default 50%)
```

### Acceptance Criteria

- [x] `vendors.schema.json` created in `config/schemas/`
- [x] Schema validates with sample vendors
- [x] Specialty enum validated (10 specialties)
- [x] Inventory items validated with item references
- [x] Stock quantity validated (-1 for infinite)
- [x] Price modifiers validated with multipliers
- [x] Restock rule validated with type enum
- [x] Accepted currencies validated as array
- [x] Reputation and dialogue references validated
- [x] Operating hours validated
- [x] ~5 unit tests pass (11 implemented)

---

## Dependencies & Prerequisites

```
v0.14.4 (Environment Configuration Schemas) - REQUIRED
    |
    +-- All environment schemas available â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                           |
                                       v
v0.14.5 (Economy Configuration Schemas)
    |
    |-- v0.14.5a: Currency Schema â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    |       Dependencies: None                                             |
    |       Provides: currency.schema.json                                 |
    |                                                                      |
    |-- v0.14.5b: Resource Schema â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    |       Dependencies: None                                             |
    |       Provides: resources.schema.json                                |
    |                                                                      |
    |-- v0.14.5c: Crafting Recipe Schema â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    |       Dependencies: items.schema.json, skills.schema.json            |
    |       Provides: recipes.schema.json, recipes.json                    |
    |                                                                      |
    +-- v0.14.5d: Vendor Schema â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            Dependencies: items.schema.json, currency.schema.json
            Provides: vendors.schema.json, vendors.json

Note: v0.14.5a and v0.14.5b can be implemented in parallel (no dependencies).
      v0.14.5c and v0.14.5d depend on prior v0.14.x schemas.
```

---

## Estimated Effort Summary

| Part | New Files | Modified Files | Est. Tests | Complexity |
|------|-----------|----------------|------------|------------|
| v0.14.5a | 1 | 1 | ~4 | Low |
| v0.14.5b | 1 | 1 | ~5 | Medium |
| v0.14.5c | 2 | 0 | ~6 | High |
| v0.14.5d | 2 | 0 | ~5 | Medium |
| **Total** | **6** | **2** | **~20** | |

---

## Risk Assessment

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Resource structure differs from expected | Low | Low | Review existing resources.json |
| Recipe complexity scope creep | Medium | Medium | Keep to schema validation only |
| Vendor pricing formula complexity | Low | Low | Document formula clearly |
| Currency exchange rate cycles | Low | Low | Validate no circular exchanges |

---

## Design Decisions (Confirmed)

### Schema Standards

| Decision | Value | Notes |
|----------|-------|-------|
| **JSON Schema Version** | Draft-07 | Consistent with v0.14.0-v0.14.4 |
| **ID Pattern** | `^[a-z][a-z0-9-]*$` | Lowercase kebab-case |
| **Schema Location** | `config/schemas/` | Centralized schema storage |

### Currency Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Decimal Support** | 0-4 places | Supports fractional currencies |
| **Exchange Rates** | Optional | Not all currencies exchange |
| **Symbol Position** | Before/After | Flexible display |

### Resource Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Build Triggers** | 5 types | Damage dealt, taken, heal, kill, crit |
| **Depletion Effects** | Optional | Can apply status at 0 |
| **Max Calculation** | Attribute scaling | Optional formula support |

### Crafting Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Recipe Categories** | 9 types | Covers major crafting traditions |
| **Discovery Types** | 6 types | Multiple ways to learn recipes |
| **Quality Variance** | Optional | Supports random quality |

### Vendor Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Vendor Specialties** | 10 types | Covers merchant archetypes |
| **Infinite Stock** | -1 quantity | Standard convention |
| **Restock Types** | 5 types | Timer, OnRest, OnLevelUp, Manual, Never |

---

## Next Steps

1. **Review & Approve** - Confirm scope breakdown
2. **v0.14.5a Design Spec** - Create currency schema (simplest)
3. **v0.14.5a Implementation** - Build currency.schema.json
4. **v0.14.5b Design Spec** - Create resource schema
5. **v0.14.5b Implementation** - Build resources.schema.json
6. **v0.14.5c Design Spec** - Create recipe schema
7. **v0.14.5c Implementation** - Build recipes.schema.json, recipes.json
8. **v0.14.5d Design Spec** - Create vendor schema
9. **v0.14.5d Implementation** - Build vendors.schema.json, vendors.json

---

*This scope breakdown provides a structured approach to implementing v0.14.5 Economy Configuration Schemas. Each sub-part creates a complete, validated JSON schema for economy-related configuration files. The recommended implementation order is v0.14.5a (currency), v0.14.5b (resources), v0.14.5c (recipes), and finally v0.14.5d (vendors), enabling full economy customization without code changes.*
