# v0.14.3a Design Specification: Monster Schema

**Version:** 0.14.3a
**Parent:** v0.14.3 (Monster Configuration Schemas)
**Prerequisites:** v0.14.2 Complete (Equipment Configuration Schemas)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Monster Schema Definition](#4-monster-schema-definition)
   - 4.1 [Root Configuration Properties](#41-root-configuration-properties)
   - 4.2 [MonsterDefinition Definition](#42-monsterdefinition-definition)
   - 4.3 [NameGenerator Definition](#43-namegenerator-definition)
   - 4.4 [EmbeddedLootTable Definition](#44-embeddedloottable-definition)
   - 4.5 [LootEntry Definition](#45-lootentry-definition)
   - 4.6 [CurrencyDrop Definition](#46-currencydrop-definition)
   - 4.7 [LevelRange Definition](#47-levelrange-definition)
5. [AI Behavior Configuration](#5-ai-behavior-configuration)
   - 5.1 [Behavior Enumeration](#51-behavior-enumeration)
   - 5.2 [Behavior Examples](#52-behavior-examples)
6. [Monster Tag Configuration](#6-monster-tag-configuration)
   - 6.1 [Tag Definitions](#61-tag-definitions)
   - 6.2 [Tag Usage Examples](#62-tag-usage-examples)
7. [Resistance Configuration](#7-resistance-configuration)
   - 7.1 [Resistance Map Structure](#71-resistance-map-structure)
   - 7.2 [Resistance Values](#72-resistance-values)
8. [Reference Configurations](#8-reference-configurations)
   - 8.1 [Tier References](#81-tier-references)
   - 8.2 [Trait References](#82-trait-references)
   - 8.3 [Ability References](#83-ability-references)
   - 8.4 [Biome References](#84-biome-references)
9. [Validation Rules](#9-validation-rules)
   - 9.1 [Enum Validation](#91-enum-validation)
   - 9.2 [Range Validation](#92-range-validation)
   - 9.3 [Required Fields](#93-required-fields)
   - 9.4 [Pattern Validation](#94-pattern-validation)
   - 9.5 [Conditional Validation](#95-conditional-validation)
10. [Configuration Schema](#10-configuration-schema)
11. [Configuration File Updates](#11-configuration-file-updates)
12. [Data Model Changes](#12-data-model-changes)
13. [Logging Specifications](#13-logging-specifications)
14. [Unit Testing Requirements](#14-unit-testing-requirements)
15. [Use Cases](#15-use-cases)
16. [Deliverable Checklist](#16-deliverable-checklist)
17. [Acceptance Criteria](#17-acceptance-criteria)
18. [Dependencies](#18-dependencies)
19. [Future Considerations](#19-future-considerations)

---

## 1. Executive Summary

Version 0.14.3a introduces the **Monster Schema** (`monsters.schema.json`), which validates monster definitions including stat blocks, AI behavior patterns, resistance configurations, tier/trait references, name generation, and embedded loot tables. This schema enables full customization of monsters without code changes, supporting modding scenarios like sci-fi enemies, undead hordes, alien creatures, or fantasy beasts.

The Monster Schema provides comprehensive validation for the existing `monsters.json` configuration while establishing patterns for monster-related data structures that will be referenced by traits (v0.14.3b), tiers (v0.14.3c), and bosses (v0.14.3d).

### Key Deliverables

| Category | Items |
|----------|-------|
| **Schema Files** | `monsters.schema.json` |
| **Schema Definitions** | `MonsterDefinition`, `NameGenerator`, `EmbeddedLootTable`, `LootEntry`, `CurrencyDrop`, `LevelRange` |
| **Configuration Files** | Update `monsters.json` to reference new schema |
| **Tests** | ~6 new unit tests |

### Architectural Significance

This version provides:
- **Monster stat block validation** - Base health, attack, defense, experience value
- **AI behavior patterns** - 6 behavior types (Aggressive, Defensive, Cowardly, Support, Chaotic, Tactical)
- **Monster tagging system** - Categorization by type (humanoid, undead, beast, ooze, magic, construct, dragon)
- **Resistance map validation** - Damage type to percentage mapping (-100 to 100)
- **Tier/trait references** - Links to difficulty tiers and monster traits
- **Name generation** - Procedural name creation with prefixes, suffixes, and title formats
- **Embedded loot tables** - Inline loot configuration per monster
- **Spawn configuration** - Weight, level range, and biome restrictions

### Relationship to Other Schemas

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    v0.14.3 MONSTER CONFIGURATION SCHEMAS                     │
└─────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────┐
  │  v0.14.3a: monsters.schema.json ◀── THIS VERSION                        │
  │  v0.14.3b: traits.schema.json                                           │
  │  v0.14.3c: tiers.schema.json                                            │
  │  v0.14.3d: bosses.schema.json                                           │
  └─────────────────────────────────────────────────────────────────────────┘

  Cross-references:
  • tiers.json → possibleTiers references tier IDs
  • traits.json → possibleTraits references trait IDs
  • abilities.json → abilityIds references ability IDs
  • biomes.json → biomeIds references biome IDs (spawn restrictions)
  • items.json → itemId in loot entries references item IDs
  • loot-tables.schema.json → embedded loot table follows similar patterns

  Shared definitions:
  • ID pattern: ^[a-z][a-z0-9_]*$ (underscore convention for monsters)
  • Drop chance: 0.0 to 1.0 (percentage as decimal)
  • Resistance range: -100 to 100 (negative = weakness, positive = resistance)
  • Schema location: config/schemas/
```

---

## 2. Feature Overview

```
v0.14.3a Monster Schema Features
├── monsters.schema.json
│   ├── Root Configuration Properties
│   │   ├── $schema (string, optional)
│   │   ├── version (string, optional)
│   │   └── monsters (array of MonsterDefinition, required)
│   └── Definitions
│       ├── MonsterDefinition
│       │   ├── id (string, underscore pattern, required)
│       │   ├── name (string, minLength: 1, required)
│       │   ├── description (string, required)
│       │   ├── baseHealth (integer, minimum: 1, required)
│       │   ├── baseAttack (integer, minimum: 0, required)
│       │   ├── baseDefense (integer, minimum: 0, required)
│       │   ├── experienceValue (integer, minimum: 0, required)
│       │   ├── behavior (enum, required)
│       │   ├── tags (array of string, required)
│       │   ├── canHeal (boolean, default: false)
│       │   ├── healAmount (integer, optional)
│       │   ├── spawnWeight (integer, default: 100)
│       │   ├── initiativeModifier (integer, default: 0)
│       │   ├── baseResistances (object, optional)
│       │   ├── possibleTiers (array of string, required)
│       │   ├── possibleTraits (array of string, optional)
│       │   ├── nameGenerator (NameGenerator, optional)
│       │   ├── lootTable (EmbeddedLootTable, optional)
│       │   ├── abilityIds (array of string, optional)
│       │   ├── biomeIds (array of string, optional)
│       │   ├── levelRange (LevelRange, optional)
│       │   └── sortOrder (integer, optional)
│       ├── NameGenerator
│       │   ├── prefixes (array of string, minItems: 1)
│       │   ├── suffixes (array of string, minItems: 1)
│       │   └── titleFormat (string)
│       ├── EmbeddedLootTable
│       │   ├── entries (array of LootEntry)
│       │   └── currencyDrops (array of CurrencyDrop, optional)
│       ├── LootEntry
│       │   ├── itemId (string, required)
│       │   ├── weight (integer, minimum: 1, default: 100)
│       │   ├── minQuantity (integer, minimum: 1, default: 1)
│       │   ├── maxQuantity (integer, minimum: 1, default: 1)
│       │   └── dropChance (number, 0-1, default: 1.0)
│       ├── CurrencyDrop
│       │   ├── currencyId (string, default: "gold")
│       │   ├── minAmount (integer, minimum: 0)
│       │   ├── maxAmount (integer, minimum: 0)
│       │   └── dropChance (number, 0-1, default: 1.0)
│       └── LevelRange
│           ├── min (integer, minimum: 1, default: 1)
│           └── max (integer, minimum: 1, optional)
├── Validation Rules
│   ├── Monster ID Pattern Validation (underscore)
│   ├── Base Stat Range Validation (health >= 1, attack/defense >= 0)
│   ├── Behavior Enum Validation (6 options)
│   ├── Tags Array Validation
│   ├── Resistance Map Validation (-100 to 100)
│   ├── Drop Chance Range Validation (0.0-1.0)
│   ├── Spawn Weight Non-Negative Validation
│   └── Healing Amount Conditional Validation
└── Configuration Updates
    └── monsters.json updated with $schema reference
```

---

## 3. Architecture Diagrams

### 3.1 Schema Validation Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         SCHEMA VALIDATION FLOW                               │
└─────────────────────────────────────────────────────────────────────────────┘

    User edits monsters.json
           │
           ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                          IDE/EDITOR                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│  1. Reads $schema property from config file                                  │
│  2. Loads monsters.schema.json from config/schemas/                          │
│  3. Validates content against schema                                         │
└─────────────────────────────────────────────────────────────────────────────┘
           │
           ├─── Valid ───▶ Green checkmark, autocomplete works
           │
           └─── Invalid ─▶ Error underlines with messages:
                           • "baseHealth must be >= 1"
                           • "behavior must be one of: Aggressive, Defensive, ..."
                           • "id must match pattern ^[a-z][a-z0-9_]*$"
                           • "dropChance must be between 0 and 1"
```

### 3.2 Monster Schema Structure Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        monsters.schema.json                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│  $schema: "http://json-schema.org/draft-07/schema#"                         │
│  title: "Monster Configuration"                                              │
│  type: object                                                                │
├─────────────────────────────────────────────────────────────────────────────┤
│  properties:                                                                 │
│  ┌─────────────────────────┬─────────────────────────────────────────────┐  │
│  │ $schema                 │ type: string (optional)                     │  │
│  ├─────────────────────────┼─────────────────────────────────────────────┤  │
│  │ version                 │ type: string (optional)                     │  │
│  ├─────────────────────────┼─────────────────────────────────────────────┤  │
│  │ monsters                │ type: array, items: $ref MonsterDefinition  │  │
│  └─────────────────────────┴─────────────────────────────────────────────┘  │
├─────────────────────────────────────────────────────────────────────────────┤
│  definitions:                                                                │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ MonsterDefinition                                                    │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ id                    │ string, pattern: ^[a-z][a-z0-9_]*$    │   │    │
│  │ │ name                  │ string, minLength: 1                   │   │    │
│  │ │ description           │ string                                 │   │    │
│  │ │ baseHealth            │ integer, minimum: 1                    │   │    │
│  │ │ baseAttack            │ integer, minimum: 0                    │   │    │
│  │ │ baseDefense           │ integer, minimum: 0                    │   │    │
│  │ │ experienceValue       │ integer, minimum: 0                    │   │    │
│  │ │ behavior              │ enum: 6 behavior types                 │   │    │
│  │ │ tags                  │ array of string                        │   │    │
│  │ │ canHeal               │ boolean, default: false                │   │    │
│  │ │ healAmount            │ integer (optional)                     │   │    │
│  │ │ spawnWeight           │ integer, minimum: 0, default: 100      │   │    │
│  │ │ initiativeModifier    │ integer, default: 0                    │   │    │
│  │ │ baseResistances       │ object (damage type -> percentage)     │   │    │
│  │ │ possibleTiers         │ array of string (tier id references)   │   │    │
│  │ │ possibleTraits        │ array of string (trait id references)  │   │    │
│  │ │ nameGenerator         │ $ref NameGenerator (optional)          │   │    │
│  │ │ lootTable             │ $ref EmbeddedLootTable (optional)      │   │    │
│  │ │ abilityIds            │ array of string (optional)             │   │    │
│  │ │ biomeIds              │ array of string (optional)             │   │    │
│  │ │ levelRange            │ $ref LevelRange (optional)             │   │    │
│  │ │ sortOrder             │ integer, minimum: 0 (optional)         │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ NameGenerator                                                        │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ prefixes              │ array of string, minItems: 1          │   │    │
│  │ │ suffixes              │ array of string, minItems: 1          │   │    │
│  │ │ titleFormat           │ string (format pattern)               │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ EmbeddedLootTable                                                    │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ entries               │ array of $ref LootEntry               │   │    │
│  │ │ currencyDrops         │ array of $ref CurrencyDrop (optional) │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ LootEntry                                                            │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ itemId                │ string (required)                      │   │    │
│  │ │ weight                │ integer, minimum: 1, default: 100      │   │    │
│  │ │ minQuantity           │ integer, minimum: 1, default: 1        │   │    │
│  │ │ maxQuantity           │ integer, minimum: 1, default: 1        │   │    │
│  │ │ dropChance            │ number, 0-1, default: 1.0              │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ CurrencyDrop                                                         │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ currencyId            │ string, default: "gold"                │   │    │
│  │ │ minAmount             │ integer, minimum: 0                    │   │    │
│  │ │ maxAmount             │ integer, minimum: 0                    │   │    │
│  │ │ dropChance            │ number, 0-1, default: 1.0              │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ LevelRange                                                           │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ min                   │ integer, minimum: 1, default: 1       │   │    │
│  │ │ max                   │ integer, minimum: 1 (optional)        │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Monster Definition Structure Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        MONSTER DEFINITION STRUCTURE                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                      MONSTER DEFINITION                              │    │
│  │                                                                      │    │
│  │  id: "orc"                                                           │    │
│  │  name: "Orc"                                                         │    │
│  │  description: "A large, brutish creature with green skin..."         │    │
│  │                                                                      │    │
│  │  ┌───────────────────────────────────────────────────────────────┐  │    │
│  │  │  STAT BLOCK                                                    │  │    │
│  │  │  ┌──────────────────────────────────────────────────────────┐ │  │    │
│  │  │  │ baseHealth: 45        (minimum: 1)                       │ │  │    │
│  │  │  │ baseAttack: 12        (minimum: 0)                       │ │  │    │
│  │  │  │ baseDefense: 4        (minimum: 0)                       │ │  │    │
│  │  │  │ experienceValue: 40   (minimum: 0)                       │ │  │    │
│  │  │  └──────────────────────────────────────────────────────────┘ │  │    │
│  │  └───────────────────────────────────────────────────────────────┘  │    │
│  │                                                                      │    │
│  │  ┌───────────────────────────────────────────────────────────────┐  │    │
│  │  │  BEHAVIOR & TAGS                                               │  │    │
│  │  │  ┌──────────────────────────────────────────────────────────┐ │  │    │
│  │  │  │ behavior: "Aggressive"                                   │ │  │    │
│  │  │  │ tags: ["humanoid"]                                       │ │  │    │
│  │  │  │ canHeal: false                                           │ │  │    │
│  │  │  └──────────────────────────────────────────────────────────┘ │  │    │
│  │  └───────────────────────────────────────────────────────────────┘  │    │
│  │                                                                      │    │
│  │  ┌───────────────────────────────────────────────────────────────┐  │    │
│  │  │  SPAWN CONFIGURATION                                           │  │    │
│  │  │  ┌──────────────────────────────────────────────────────────┐ │  │    │
│  │  │  │ spawnWeight: 50                                          │ │  │    │
│  │  │  │ initiativeModifier: -1                                   │ │  │    │
│  │  │  └──────────────────────────────────────────────────────────┘ │  │    │
│  │  └───────────────────────────────────────────────────────────────┘  │    │
│  │                                                                      │    │
│  │  ┌───────────────────────────────────────────────────────────────┐  │    │
│  │  │  REFERENCES                                                    │  │    │
│  │  │  ┌──────────────────────────────────────────────────────────┐ │  │    │
│  │  │  │ possibleTiers: ["common", "named", "elite", "boss"]      │ │  │    │
│  │  │  │ possibleTraits: ["armored", "berserker", "regenerating"] │ │  │    │
│  │  │  └──────────────────────────────────────────────────────────┘ │  │    │
│  │  └───────────────────────────────────────────────────────────────┘  │    │
│  │                                                                      │    │
│  │  ┌───────────────────────────────────────────────────────────────┐  │    │
│  │  │  NAME GENERATOR                                                │  │    │
│  │  │  ┌──────────────────────────────────────────────────────────┐ │  │    │
│  │  │  │ prefixes: ["Gr", "Kr", "Th", "Br", "Dr"]                 │ │  │    │
│  │  │  │ suffixes: ["ok", "ag", "ul", "ax", "or"]                 │ │  │    │
│  │  │  │ titleFormat: "{0} the {1}"                               │ │  │    │
│  │  │  └──────────────────────────────────────────────────────────┘ │  │    │
│  │  └───────────────────────────────────────────────────────────────┘  │    │
│  │                                                                      │    │
│  │  ┌───────────────────────────────────────────────────────────────┐  │    │
│  │  │  LOOT TABLE                                                    │  │    │
│  │  │  ┌──────────────────────────────────────────────────────────┐ │  │    │
│  │  │  │ entries:                                                 │ │  │    │
│  │  │  │   - health_potion (weight: 100, dropChance: 0.25)        │ │  │    │
│  │  │  │   - iron_sword (weight: 50, dropChance: 0.10)            │ │  │    │
│  │  │  │   - orcish_helm (weight: 30, dropChance: 0.05)           │ │  │    │
│  │  │  │ currencyDrops:                                           │ │  │    │
│  │  │  │   - gold (15-35, dropChance: 1.0)                        │ │  │    │
│  │  │  └──────────────────────────────────────────────────────────┘ │  │    │
│  │  └───────────────────────────────────────────────────────────────┘  │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 Resistance System Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          RESISTANCE SYSTEM                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  RESISTANCE VALUE SCALE                                                      │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  -100          -50            0            50           100          │   │
│  │    │            │             │             │             │          │   │
│  │    │◀── Weakness ──▶│◀── Normal ──▶│◀── Resistant ──▶│            │   │
│  │    │                 │              │                  │             │   │
│  │  2x damage      1.5x damage    Normal      0.5x damage   Immune     │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│  EXAMPLE RESISTANCE MAPS                                                     │
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │  SKELETON                                                              │ │
│  │  ┌────────────────┬────────────┬──────────────────────────────────┐   │ │
│  │  │ Damage Type    │ Value      │ Effect                           │   │ │
│  │  ├────────────────┼────────────┼──────────────────────────────────┤   │ │
│  │  │ physical       │ 25         │ Takes 25% less physical damage   │   │ │
│  │  │ fire           │ -50        │ Takes 50% more fire damage       │   │ │
│  │  │ poison         │ 100        │ Immune to poison                 │   │ │
│  │  │ holy           │ -50        │ Takes 50% more holy damage       │   │ │
│  │  │ dark           │ 50         │ Takes 50% less dark damage       │   │ │
│  │  └────────────────┴────────────┴──────────────────────────────────┘   │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │  SLIME                                                                 │ │
│  │  ┌────────────────┬────────────┬──────────────────────────────────┐   │ │
│  │  │ Damage Type    │ Value      │ Effect                           │   │ │
│  │  ├────────────────┼────────────┼──────────────────────────────────┤   │ │
│  │  │ physical       │ 50         │ Takes 50% less physical damage   │   │ │
│  │  │ fire           │ -25        │ Takes 25% more fire damage       │   │ │
│  │  │ ice            │ -25        │ Takes 25% more ice damage        │   │ │
│  │  │ lightning      │ -50        │ Takes 50% more lightning damage  │   │ │
│  │  │ poison         │ 100        │ Immune to poison                 │   │ │
│  │  └────────────────┴────────────┴──────────────────────────────────┘   │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.5 Name Generation System Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        NAME GENERATION SYSTEM                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  NAME GENERATOR CONFIGURATION                                                │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  nameGenerator: {                                                    │   │
│  │    "prefixes": ["Gr", "Kr", "Th", "Br", "Dr"],                       │   │
│  │    "suffixes": ["ok", "ag", "ul", "ax", "or"],                       │   │
│  │    "titleFormat": "{0} the {1}"                                      │   │
│  │  }                                                                   │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│  GENERATION PROCESS                                                          │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  Step 1: Select random prefix                                        │   │
│  │          Example: "Gr"                                               │   │
│  │                                                                      │   │
│  │  Step 2: Select random suffix                                        │   │
│  │          Example: "ok"                                               │   │
│  │                                                                      │   │
│  │  Step 3: Combine to form name                                        │   │
│  │          Result: "Grok"                                              │   │
│  │                                                                      │   │
│  │  Step 4: Select title (for named/elite tiers)                        │   │
│  │          Example title: "Fierce"                                     │   │
│  │                                                                      │   │
│  │  Step 5: Apply titleFormat                                           │   │
│  │          Format: "{0} the {1}"                                       │   │
│  │          {0} = generated name = "Grok"                               │   │
│  │          {1} = title = "Fierce"                                      │   │
│  │          Result: "Grok the Fierce"                                   │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│  EXAMPLE OUTPUTS BY MONSTER TYPE                                             │
│                                                                              │
│  ┌────────────────┬───────────────────┬──────────────────────────────────┐  │
│  │ Monster        │ Name              │ Title Format                     │  │
│  ├────────────────┼───────────────────┼──────────────────────────────────┤  │
│  │ Goblin         │ "Gnik"            │ "{0} the {1}" → "Gnik the Sly"   │  │
│  │ Skeleton       │ "Skull"           │ "{0} the Bone {1}" → "Skull..."  │  │
│  │ Orc            │ "Grok"            │ "{0} the {1}" → "Grok the Fierce"│  │
│  │ Goblin Shaman  │ "Zrik"            │ "{0} the Shaman" → "Zrik..."     │  │
│  │ Slime          │ "Blob"            │ "{0} the {1}" → "Blob the Oozy"  │  │
│  └────────────────┴───────────────────┴──────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.6 File Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            CONFIG LAYER                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  config/                                                                     │
│  ├── monsters.json ◀──────────────────────────┐                             │
│  │   {                                         │ references                  │
│  │     "$schema": "./schemas/monsters.schema.json",                          │
│  │     "monsters": [                           │                             │
│  │       {                                     │                             │
│  │         "id": "goblin",                     │                             │
│  │         "name": "Goblin",                   │                             │
│  │         "baseHealth": 30,                   │                             │
│  │         "baseAttack": 8,                    │                             │
│  │         "behavior": "Cowardly",             │                             │
│  │         "tags": ["humanoid"],               │                             │
│  │         "possibleTiers": ["common", ...],   │                             │
│  │         "lootTable": {...}                  │                             │
│  │       },                                    │                             │
│  │       ...                                   │                             │
│  │     ]                                       │                             │
│  │   }                                         │                             │
│  │                                             │                             │
│  ├── tiers.json (tier ID references)           │                             │
│  ├── traits.json (trait ID references)         │                             │
│  ├── items.json (itemId references)            │                             │
│  │                                             │                             │
│  └── schemas/                                  │                             │
│      └── monsters.schema.json ─────────────────┘                             │
│          {                                                                   │
│            "$schema": "http://json-schema.org/draft-07/schema#",            │
│            "definitions": {                                                  │
│              "MonsterDefinition": {...},                                     │
│              "NameGenerator": {...},                                         │
│              "EmbeddedLootTable": {...},                                     │
│              "LootEntry": {...},                                             │
│              "CurrencyDrop": {...},                                          │
│              "LevelRange": {...}                                             │
│            }                                                                 │
│          }                                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Monster Schema Definition

### 4.1 Root Configuration Properties

**File:** `config/schemas/monsters.schema.json`

The monster schema follows JSON Schema Draft-07 specification, providing comprehensive validation for monster configuration files.

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Monster Configuration",
    "description": "Schema for monster definitions. Defines all monsters that can spawn in the game, including their stats, behaviors, resistances, and loot tables.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
        },
        "monsters": {
            "type": "array",
            "description": "List of monster definitions",
            "items": {
                "$ref": "#/definitions/MonsterDefinition"
            },
            "minItems": 1
        }
    },
    "required": ["monsters"],
    "additionalProperties": false,
    "definitions": {
        "MonsterDefinition": { ... },
        "NameGenerator": { ... },
        "EmbeddedLootTable": { ... },
        "LootEntry": { ... },
        "CurrencyDrop": { ... },
        "LevelRange": { ... }
    }
}
```

### 4.2 MonsterDefinition Definition

The `MonsterDefinition` object defines a complete monster with all its properties.

```json
"MonsterDefinition": {
    "type": "object",
    "description": "A monster that can spawn and be fought by players",
    "properties": {
        "id": {
            "type": "string",
            "description": "Unique identifier for the monster (lowercase with underscores)",
            "pattern": "^[a-z][a-z0-9_]*$",
            "minLength": 1,
            "maxLength": 50
        },
        "name": {
            "type": "string",
            "description": "Display name shown to players",
            "minLength": 1,
            "maxLength": 100
        },
        "description": {
            "type": "string",
            "description": "Full description of the monster",
            "minLength": 1
        },
        "baseHealth": {
            "type": "integer",
            "description": "Base hit points before tier modifiers",
            "minimum": 1
        },
        "baseAttack": {
            "type": "integer",
            "description": "Base attack power before tier modifiers",
            "minimum": 0
        },
        "baseDefense": {
            "type": "integer",
            "description": "Base defense value before tier modifiers",
            "minimum": 0
        },
        "experienceValue": {
            "type": "integer",
            "description": "Base experience points awarded on defeat",
            "minimum": 0
        },
        "behavior": {
            "type": "string",
            "description": "AI behavior pattern for combat decisions",
            "enum": ["Aggressive", "Defensive", "Cowardly", "Support", "Chaotic", "Tactical"]
        },
        "tags": {
            "type": "array",
            "description": "Category tags for monster type classification",
            "items": {
                "type": "string"
            },
            "minItems": 1
        },
        "canHeal": {
            "type": "boolean",
            "description": "Whether this monster can heal itself or allies",
            "default": false
        },
        "healAmount": {
            "type": "integer",
            "description": "Amount of healing per heal action (required if canHeal is true)",
            "minimum": 1
        },
        "spawnWeight": {
            "type": "integer",
            "description": "Relative weight for spawn probability (higher = more common)",
            "minimum": 0,
            "default": 100
        },
        "initiativeModifier": {
            "type": "integer",
            "description": "Modifier to initiative roll for turn order",
            "default": 0
        },
        "baseResistances": {
            "type": "object",
            "description": "Damage type resistances/weaknesses (-100 to 100)",
            "additionalProperties": {
                "type": "integer",
                "minimum": -100,
                "maximum": 100
            }
        },
        "possibleTiers": {
            "type": "array",
            "description": "Tier IDs this monster can spawn as",
            "items": {
                "type": "string",
                "pattern": "^[a-z][a-z0-9_]*$"
            },
            "minItems": 1
        },
        "possibleTraits": {
            "type": "array",
            "description": "Trait IDs this monster can spawn with",
            "items": {
                "type": "string",
                "pattern": "^[a-z][a-z0-9_]*$"
            }
        },
        "nameGenerator": {
            "$ref": "#/definitions/NameGenerator"
        },
        "lootTable": {
            "$ref": "#/definitions/EmbeddedLootTable"
        },
        "abilityIds": {
            "type": "array",
            "description": "Ability IDs this monster can use",
            "items": {
                "type": "string",
                "pattern": "^[a-z][a-z0-9_-]*$"
            }
        },
        "biomeIds": {
            "type": "array",
            "description": "Biome IDs where this monster can spawn",
            "items": {
                "type": "string",
                "pattern": "^[a-z][a-z0-9_-]*$"
            }
        },
        "levelRange": {
            "$ref": "#/definitions/LevelRange"
        },
        "sortOrder": {
            "type": "integer",
            "description": "Order for display sorting (lower values first)",
            "minimum": 0
        }
    },
    "required": ["id", "name", "description", "baseHealth", "baseAttack", "baseDefense", "experienceValue", "behavior", "tags", "possibleTiers"],
    "additionalProperties": false
}
```

### 4.3 NameGenerator Definition

The `NameGenerator` object defines procedural name generation rules for named monsters.

```json
"NameGenerator": {
    "type": "object",
    "description": "Configuration for generating unique monster names",
    "properties": {
        "prefixes": {
            "type": "array",
            "description": "Name prefix syllables",
            "items": {
                "type": "string",
                "minLength": 1
            },
            "minItems": 1
        },
        "suffixes": {
            "type": "array",
            "description": "Name suffix syllables",
            "items": {
                "type": "string",
                "minLength": 1
            },
            "minItems": 1
        },
        "titleFormat": {
            "type": "string",
            "description": "Format string for full name with title. {0} = name, {1} = title",
            "minLength": 1
        }
    },
    "required": ["prefixes", "suffixes", "titleFormat"],
    "additionalProperties": false
}
```

### 4.4 EmbeddedLootTable Definition

The `EmbeddedLootTable` object defines inline loot configuration per monster.

```json
"EmbeddedLootTable": {
    "type": "object",
    "description": "Loot table embedded directly in the monster definition",
    "properties": {
        "entries": {
            "type": "array",
            "description": "Item drop entries",
            "items": {
                "$ref": "#/definitions/LootEntry"
            }
        },
        "currencyDrops": {
            "type": "array",
            "description": "Currency (gold) drop entries",
            "items": {
                "$ref": "#/definitions/CurrencyDrop"
            }
        }
    },
    "additionalProperties": false
}
```

### 4.5 LootEntry Definition

The `LootEntry` object defines a single item drop entry.

```json
"LootEntry": {
    "type": "object",
    "description": "A single item drop entry in the loot table",
    "properties": {
        "itemId": {
            "type": "string",
            "description": "Reference to item ID in items.json, weapons.json, or armor.json",
            "minLength": 1
        },
        "weight": {
            "type": "integer",
            "description": "Relative weight for selection from pool (higher = more likely)",
            "minimum": 1,
            "default": 100
        },
        "minQuantity": {
            "type": "integer",
            "description": "Minimum quantity of items to drop",
            "minimum": 1,
            "default": 1
        },
        "maxQuantity": {
            "type": "integer",
            "description": "Maximum quantity of items to drop",
            "minimum": 1,
            "default": 1
        },
        "dropChance": {
            "type": "number",
            "description": "Probability of this item dropping (0.0 to 1.0)",
            "minimum": 0,
            "maximum": 1,
            "default": 1.0
        }
    },
    "required": ["itemId"],
    "additionalProperties": false
}
```

### 4.6 CurrencyDrop Definition

The `CurrencyDrop` object defines currency (gold) drops.

```json
"CurrencyDrop": {
    "type": "object",
    "description": "Currency dropped by the monster",
    "properties": {
        "currencyId": {
            "type": "string",
            "description": "Currency type ID",
            "default": "gold"
        },
        "minAmount": {
            "type": "integer",
            "description": "Minimum currency amount",
            "minimum": 0
        },
        "maxAmount": {
            "type": "integer",
            "description": "Maximum currency amount",
            "minimum": 0
        },
        "dropChance": {
            "type": "number",
            "description": "Probability of currency dropping (0.0 to 1.0)",
            "minimum": 0,
            "maximum": 1,
            "default": 1.0
        }
    },
    "required": ["minAmount", "maxAmount"],
    "additionalProperties": false
}
```

### 4.7 LevelRange Definition

The `LevelRange` object defines spawn level restrictions.

```json
"LevelRange": {
    "type": "object",
    "description": "Level range for monster spawning",
    "properties": {
        "min": {
            "type": "integer",
            "description": "Minimum player level for this monster to spawn",
            "minimum": 1,
            "default": 1
        },
        "max": {
            "type": "integer",
            "description": "Maximum player level for this monster to spawn (optional, no max if omitted)",
            "minimum": 1
        }
    },
    "additionalProperties": false
}
```

---

## 5. AI Behavior Configuration

### 5.1 Behavior Enumeration

The behavior enum defines AI patterns for combat decisions.

| Behavior | Description | Target Selection | Ability Usage |
|----------|-------------|------------------|---------------|
| `Aggressive` | Attacks strongest target, pursues relentlessly | Highest threat/damage | Offensive abilities |
| `Defensive` | Protects allies, uses defensive abilities | Closest ally in danger | Shields, buffs |
| `Cowardly` | Flees when low HP, avoids strong enemies | Weakest or none (flee) | Escape abilities |
| `Support` | Heals allies, buffs, stays behind front line | Lowest HP ally | Heals, buffs |
| `Chaotic` | Random target selection, unpredictable | Random | Random |
| `Tactical` | Prioritizes weak targets, uses abilities strategically | Lowest HP enemy | Best situational |

### 5.2 Behavior Examples

**Aggressive Behavior (Orc):**
```json
{
    "id": "orc",
    "name": "Orc",
    "behavior": "Aggressive",
    "description": "Charges at the strongest enemy, uses powerful attacks"
}
```

**Support Behavior (Goblin Shaman):**
```json
{
    "id": "goblin_shaman",
    "name": "Goblin Shaman",
    "behavior": "Support",
    "canHeal": true,
    "healAmount": 10,
    "description": "Stays behind other goblins, heals wounded allies"
}
```

**Cowardly Behavior (Goblin):**
```json
{
    "id": "goblin",
    "name": "Goblin",
    "behavior": "Cowardly",
    "description": "Attacks opportunistically, flees when hurt"
}
```

**Chaotic Behavior (Slime):**
```json
{
    "id": "slime",
    "name": "Slime",
    "behavior": "Chaotic",
    "description": "Attacks randomly, unpredictable target selection"
}
```

---

## 6. Monster Tag Configuration

### 6.1 Tag Definitions

Tags classify monsters by type for game mechanics and targeting.

| Tag | Description | Mechanical Effects | Examples |
|-----|-------------|-------------------|----------|
| `humanoid` | Intelligent bipedal creatures | Affected by charm, fear | Goblin, Orc, Bandit |
| `undead` | Animated dead creatures | Immune to poison, fear; weak to holy | Skeleton, Zombie, Ghost |
| `beast` | Natural animal creatures | Affected by animal handling | Wolf, Bear, Boar |
| `ooze` | Amorphous blob creatures | Resistant to physical; weak to elements | Slime, Gelatinous Cube |
| `magic` | Magically inclined creatures | Resistant to magic; can cast spells | Shaman, Mage, Elemental |
| `construct` | Artificially created creatures | Immune to poison, charm; resistant to physical | Golem, Automaton |
| `dragon` | Draconic creatures | High resistances; breath attacks | Drake, Dragon, Wyvern |

### 6.2 Tag Usage Examples

**Single Tag:**
```json
{
    "id": "goblin",
    "tags": ["humanoid"]
}
```

**Multiple Tags:**
```json
{
    "id": "goblin_shaman",
    "tags": ["humanoid", "magic"]
}
```

**Type-Specific Tags:**
```json
{
    "id": "skeleton",
    "tags": ["undead"]
}
```

```json
{
    "id": "slime",
    "tags": ["ooze"]
}
```

---

## 7. Resistance Configuration

### 7.1 Resistance Map Structure

The `baseResistances` property is an object mapping damage type IDs to percentage values.

**Structure:**
```json
"baseResistances": {
    "<damageTypeId>": <integer -100 to 100>,
    "<damageTypeId>": <integer -100 to 100>
}
```

### 7.2 Resistance Values

| Value Range | Effect | Description |
|-------------|--------|-------------|
| `-100` | Double Damage | 2x damage from this type |
| `-50` | Weakness | 1.5x damage from this type |
| `0` | Normal | Standard damage |
| `50` | Resistant | 0.5x damage from this type |
| `100` | Immune | No damage from this type |

**Example - Skeleton:**
```json
{
    "baseResistances": {
        "physical": 25,
        "fire": -50,
        "poison": 100,
        "holy": -50,
        "dark": 50
    }
}
```

**Example - Slime:**
```json
{
    "baseResistances": {
        "physical": 50,
        "fire": -25,
        "ice": -25,
        "lightning": -50,
        "poison": 100
    }
}
```

**Example - No Resistances (Goblin):**
```json
{
    "baseResistances": {}
}
```

---

## 8. Reference Configurations

### 8.1 Tier References

The `possibleTiers` array references tier IDs from `tiers.json`.

**Example:**
```json
{
    "possibleTiers": ["common", "named", "elite", "boss"]
}
```

This means the monster can spawn as any of these four tiers, with the tier affecting stats and loot.

### 8.2 Trait References

The `possibleTraits` array references trait IDs from `traits.json`.

**Example:**
```json
{
    "possibleTraits": ["armored", "berserker", "regenerating"]
}
```

This means the monster may spawn with one or more of these traits, modifying its abilities and stats.

### 8.3 Ability References

The `abilityIds` array references ability IDs from `abilities.json`.

**Example:**
```json
{
    "abilityIds": ["fireball", "heal", "poison_spray"]
}
```

This defines special abilities the monster can use in combat.

### 8.4 Biome References

The `biomeIds` array references biome IDs from `biomes.json`, restricting where the monster can spawn.

**Example:**
```json
{
    "biomeIds": ["forest", "cave", "swamp"]
}
```

If omitted, the monster can spawn in any biome.

---

## 9. Validation Rules

### 9.1 Enum Validation

| Property | Valid Values | Validation Error |
|----------|--------------|------------------|
| `behavior` | `Aggressive`, `Defensive`, `Cowardly`, `Support`, `Chaotic`, `Tactical` | "behavior must be one of: Aggressive, Defensive, ..." |

### 9.2 Range Validation

| Property | Range | Validation Error |
|----------|-------|------------------|
| `baseHealth` | >= 1 | "baseHealth must be >= 1" |
| `baseAttack` | >= 0 | "baseAttack must be >= 0" |
| `baseDefense` | >= 0 | "baseDefense must be >= 0" |
| `experienceValue` | >= 0 | "experienceValue must be >= 0" |
| `spawnWeight` | >= 0 | "spawnWeight must be >= 0" |
| `healAmount` | >= 1 | "healAmount must be >= 1" |
| `baseResistances.*` | -100 to 100 | "resistance value must be between -100 and 100" |
| `lootTable.entries.*.weight` | >= 1 | "weight must be >= 1" |
| `lootTable.entries.*.minQuantity` | >= 1 | "minQuantity must be >= 1" |
| `lootTable.entries.*.maxQuantity` | >= 1 | "maxQuantity must be >= 1" |
| `lootTable.entries.*.dropChance` | 0-1 | "dropChance must be between 0 and 1" |
| `lootTable.currencyDrops.*.minAmount` | >= 0 | "minAmount must be >= 0" |
| `lootTable.currencyDrops.*.maxAmount` | >= 0 | "maxAmount must be >= 0" |
| `lootTable.currencyDrops.*.dropChance` | 0-1 | "dropChance must be between 0 and 1" |
| `levelRange.min` | >= 1 | "levelRange.min must be >= 1" |
| `levelRange.max` | >= 1 | "levelRange.max must be >= 1" |
| `sortOrder` | >= 0 | "sortOrder must be >= 0" |

### 9.3 Required Fields

#### MonsterDefinition Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `id` | Must be present and match pattern | "missing required property 'id'" |
| `name` | Must be present and non-empty | "missing required property 'name'" |
| `description` | Must be present | "missing required property 'description'" |
| `baseHealth` | Must be present and >= 1 | "missing required property 'baseHealth'" |
| `baseAttack` | Must be present and >= 0 | "missing required property 'baseAttack'" |
| `baseDefense` | Must be present and >= 0 | "missing required property 'baseDefense'" |
| `experienceValue` | Must be present and >= 0 | "missing required property 'experienceValue'" |
| `behavior` | Must be present and valid enum | "missing required property 'behavior'" |
| `tags` | Must be present with at least one tag | "missing required property 'tags'" |
| `possibleTiers` | Must be present with at least one tier | "missing required property 'possibleTiers'" |

#### NameGenerator Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `prefixes` | Must be present with at least one item | "missing required property 'prefixes'" |
| `suffixes` | Must be present with at least one item | "missing required property 'suffixes'" |
| `titleFormat` | Must be present | "missing required property 'titleFormat'" |

#### LootEntry Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `itemId` | Must be present | "missing required property 'itemId'" |

#### CurrencyDrop Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `minAmount` | Must be present and >= 0 | "missing required property 'minAmount'" |
| `maxAmount` | Must be present and >= 0 | "missing required property 'maxAmount'" |

### 9.4 Pattern Validation

| Property | Pattern | Validation Error |
|----------|---------|------------------|
| `id` | `^[a-z][a-z0-9_]*$` | "id must match pattern ^[a-z][a-z0-9_]*$" |
| `version` | `^[0-9]+\.[0-9]+\.[0-9]+$` | "version must match pattern (e.g., '1.0.0')" |
| `possibleTiers[*]` | `^[a-z][a-z0-9_]*$` | "tier id must match pattern" |
| `possibleTraits[*]` | `^[a-z][a-z0-9_]*$` | "trait id must match pattern" |
| `abilityIds[*]` | `^[a-z][a-z0-9_-]*$` | "ability id must match pattern" |
| `biomeIds[*]` | `^[a-z][a-z0-9_-]*$` | "biome id must match pattern" |

### 9.5 Conditional Validation

| Condition | Required Field | Notes |
|-----------|----------------|-------|
| `canHeal: true` | `healAmount` | Must specify heal amount if monster can heal |

Note: JSON Schema Draft-07 supports conditional validation via `if`/`then` keywords or custom validation.

---

## 10. Configuration Schema

### Complete Monsters Schema File

**File:** `config/schemas/monsters.schema.json`

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Monster Configuration",
    "description": "Schema for monster definitions. Defines all monsters that can spawn in the game, including their stats, behaviors, resistances, and loot tables.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
        },
        "monsters": {
            "type": "array",
            "description": "List of monster definitions",
            "items": {
                "$ref": "#/definitions/MonsterDefinition"
            },
            "minItems": 1
        }
    },
    "required": ["monsters"],
    "additionalProperties": false,
    "definitions": {
        "MonsterDefinition": {
            "type": "object",
            "description": "A monster that can spawn and be fought by players",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique identifier for the monster (lowercase with underscores)",
                    "pattern": "^[a-z][a-z0-9_]*$",
                    "minLength": 1,
                    "maxLength": 50
                },
                "name": {
                    "type": "string",
                    "description": "Display name shown to players",
                    "minLength": 1,
                    "maxLength": 100
                },
                "description": {
                    "type": "string",
                    "description": "Full description of the monster",
                    "minLength": 1
                },
                "baseHealth": {
                    "type": "integer",
                    "description": "Base hit points before tier modifiers",
                    "minimum": 1
                },
                "baseAttack": {
                    "type": "integer",
                    "description": "Base attack power before tier modifiers",
                    "minimum": 0
                },
                "baseDefense": {
                    "type": "integer",
                    "description": "Base defense value before tier modifiers",
                    "minimum": 0
                },
                "experienceValue": {
                    "type": "integer",
                    "description": "Base experience points awarded on defeat",
                    "minimum": 0
                },
                "behavior": {
                    "type": "string",
                    "description": "AI behavior pattern for combat decisions",
                    "enum": ["Aggressive", "Defensive", "Cowardly", "Support", "Chaotic", "Tactical"]
                },
                "tags": {
                    "type": "array",
                    "description": "Category tags for monster type classification",
                    "items": {
                        "type": "string"
                    },
                    "minItems": 1
                },
                "canHeal": {
                    "type": "boolean",
                    "description": "Whether this monster can heal itself or allies",
                    "default": false
                },
                "healAmount": {
                    "type": "integer",
                    "description": "Amount of healing per heal action (required if canHeal is true)",
                    "minimum": 1
                },
                "spawnWeight": {
                    "type": "integer",
                    "description": "Relative weight for spawn probability (higher = more common)",
                    "minimum": 0,
                    "default": 100
                },
                "initiativeModifier": {
                    "type": "integer",
                    "description": "Modifier to initiative roll for turn order",
                    "default": 0
                },
                "baseResistances": {
                    "type": "object",
                    "description": "Damage type resistances/weaknesses (-100 to 100)",
                    "additionalProperties": {
                        "type": "integer",
                        "minimum": -100,
                        "maximum": 100
                    }
                },
                "possibleTiers": {
                    "type": "array",
                    "description": "Tier IDs this monster can spawn as",
                    "items": {
                        "type": "string",
                        "pattern": "^[a-z][a-z0-9_]*$"
                    },
                    "minItems": 1
                },
                "possibleTraits": {
                    "type": "array",
                    "description": "Trait IDs this monster can spawn with",
                    "items": {
                        "type": "string",
                        "pattern": "^[a-z][a-z0-9_]*$"
                    }
                },
                "nameGenerator": {
                    "$ref": "#/definitions/NameGenerator"
                },
                "lootTable": {
                    "$ref": "#/definitions/EmbeddedLootTable"
                },
                "abilityIds": {
                    "type": "array",
                    "description": "Ability IDs this monster can use",
                    "items": {
                        "type": "string",
                        "pattern": "^[a-z][a-z0-9_-]*$"
                    }
                },
                "biomeIds": {
                    "type": "array",
                    "description": "Biome IDs where this monster can spawn",
                    "items": {
                        "type": "string",
                        "pattern": "^[a-z][a-z0-9_-]*$"
                    }
                },
                "levelRange": {
                    "$ref": "#/definitions/LevelRange"
                },
                "sortOrder": {
                    "type": "integer",
                    "description": "Order for display sorting (lower values first)",
                    "minimum": 0
                }
            },
            "required": ["id", "name", "description", "baseHealth", "baseAttack", "baseDefense", "experienceValue", "behavior", "tags", "possibleTiers"],
            "additionalProperties": false
        },
        "NameGenerator": {
            "type": "object",
            "description": "Configuration for generating unique monster names",
            "properties": {
                "prefixes": {
                    "type": "array",
                    "description": "Name prefix syllables",
                    "items": {
                        "type": "string",
                        "minLength": 1
                    },
                    "minItems": 1
                },
                "suffixes": {
                    "type": "array",
                    "description": "Name suffix syllables",
                    "items": {
                        "type": "string",
                        "minLength": 1
                    },
                    "minItems": 1
                },
                "titleFormat": {
                    "type": "string",
                    "description": "Format string for full name with title. {0} = name, {1} = title",
                    "minLength": 1
                }
            },
            "required": ["prefixes", "suffixes", "titleFormat"],
            "additionalProperties": false
        },
        "EmbeddedLootTable": {
            "type": "object",
            "description": "Loot table embedded directly in the monster definition",
            "properties": {
                "entries": {
                    "type": "array",
                    "description": "Item drop entries",
                    "items": {
                        "$ref": "#/definitions/LootEntry"
                    }
                },
                "currencyDrops": {
                    "type": "array",
                    "description": "Currency (gold) drop entries",
                    "items": {
                        "$ref": "#/definitions/CurrencyDrop"
                    }
                }
            },
            "additionalProperties": false
        },
        "LootEntry": {
            "type": "object",
            "description": "A single item drop entry in the loot table",
            "properties": {
                "itemId": {
                    "type": "string",
                    "description": "Reference to item ID in items.json, weapons.json, or armor.json",
                    "minLength": 1
                },
                "weight": {
                    "type": "integer",
                    "description": "Relative weight for selection from pool (higher = more likely)",
                    "minimum": 1,
                    "default": 100
                },
                "minQuantity": {
                    "type": "integer",
                    "description": "Minimum quantity of items to drop",
                    "minimum": 1,
                    "default": 1
                },
                "maxQuantity": {
                    "type": "integer",
                    "description": "Maximum quantity of items to drop",
                    "minimum": 1,
                    "default": 1
                },
                "dropChance": {
                    "type": "number",
                    "description": "Probability of this item dropping (0.0 to 1.0)",
                    "minimum": 0,
                    "maximum": 1,
                    "default": 1.0
                }
            },
            "required": ["itemId"],
            "additionalProperties": false
        },
        "CurrencyDrop": {
            "type": "object",
            "description": "Currency dropped by the monster",
            "properties": {
                "currencyId": {
                    "type": "string",
                    "description": "Currency type ID",
                    "default": "gold"
                },
                "minAmount": {
                    "type": "integer",
                    "description": "Minimum currency amount",
                    "minimum": 0
                },
                "maxAmount": {
                    "type": "integer",
                    "description": "Maximum currency amount",
                    "minimum": 0
                },
                "dropChance": {
                    "type": "number",
                    "description": "Probability of currency dropping (0.0 to 1.0)",
                    "minimum": 0,
                    "maximum": 1,
                    "default": 1.0
                }
            },
            "required": ["minAmount", "maxAmount"],
            "additionalProperties": false
        },
        "LevelRange": {
            "type": "object",
            "description": "Level range for monster spawning",
            "properties": {
                "min": {
                    "type": "integer",
                    "description": "Minimum player level for this monster to spawn",
                    "minimum": 1,
                    "default": 1
                },
                "max": {
                    "type": "integer",
                    "description": "Maximum player level for this monster to spawn (optional, no max if omitted)",
                    "minimum": 1
                }
            },
            "additionalProperties": false
        }
    }
}
```

---

## 11. Configuration File Updates

### Updated monsters.json

Update the existing `monsters.json` to include the schema reference.

**File:** `config/monsters.json`

```json
{
    "$schema": "./schemas/monsters.schema.json",
    "monsters": [
        {
            "id": "goblin",
            "name": "Goblin",
            "description": "A small, green creature with sharp teeth and beady eyes. It looks hostile.",
            "baseHealth": 30,
            "baseAttack": 8,
            "baseDefense": 2,
            "experienceValue": 25,
            "behavior": "Cowardly",
            "tags": ["humanoid"],
            "canHeal": false,
            "spawnWeight": 100,
            "initiativeModifier": 1,
            "baseResistances": {},
            "possibleTiers": ["common", "named", "elite"],
            "possibleTraits": ["venomous", "berserker"],
            "nameGenerator": {
                "prefixes": ["Gn", "Sn", "Gr", "Kr", "Zn"],
                "suffixes": ["ik", "ob", "ax", "ek", "uk"],
                "titleFormat": "{0} the {1}"
            },
            "lootTable": {
                "entries": [
                    { "itemId": "health_potion", "weight": 100, "minQuantity": 1, "maxQuantity": 1, "dropChance": 0.15 },
                    { "itemId": "rusty_dagger", "weight": 50, "minQuantity": 1, "maxQuantity": 1, "dropChance": 0.05 }
                ],
                "currencyDrops": [
                    { "currencyId": "gold", "minAmount": 5, "maxAmount": 15, "dropChance": 0.80 }
                ]
            }
        },
        {
            "id": "skeleton",
            "name": "Skeleton",
            "description": "An animated pile of bones held together by dark magic.",
            "baseHealth": 25,
            "baseAttack": 6,
            "baseDefense": 3,
            "experienceValue": 20,
            "behavior": "Aggressive",
            "tags": ["undead"],
            "canHeal": false,
            "spawnWeight": 80,
            "initiativeModifier": 0,
            "baseResistances": {
                "physical": 25,
                "fire": -50,
                "poison": 100,
                "holy": -50,
                "dark": 50
            },
            "possibleTiers": ["common", "named", "elite", "boss"],
            "possibleTraits": ["armored", "berserker"],
            "nameGenerator": {
                "prefixes": ["Sk", "Bl", "Dr", "Vr", "Th"],
                "suffixes": ["ull", "ax", "or", "im", "us"],
                "titleFormat": "{0} the Bone {1}"
            },
            "lootTable": {
                "entries": [
                    { "itemId": "bone_dust", "weight": 100, "minQuantity": 1, "maxQuantity": 3, "dropChance": 0.30 },
                    { "itemId": "ancient_coin", "weight": 50, "minQuantity": 1, "maxQuantity": 1, "dropChance": 0.10 }
                ],
                "currencyDrops": [
                    { "currencyId": "gold", "minAmount": 8, "maxAmount": 20, "dropChance": 0.90 }
                ]
            }
        },
        {
            "id": "orc",
            "name": "Orc",
            "description": "A large, brutish creature with green skin and tusks. It wields a crude axe.",
            "baseHealth": 45,
            "baseAttack": 12,
            "baseDefense": 4,
            "experienceValue": 40,
            "behavior": "Aggressive",
            "tags": ["humanoid"],
            "canHeal": false,
            "spawnWeight": 50,
            "initiativeModifier": -1,
            "baseResistances": {},
            "possibleTiers": ["common", "named", "elite", "boss"],
            "possibleTraits": ["armored", "berserker", "regenerating"],
            "nameGenerator": {
                "prefixes": ["Gr", "Kr", "Th", "Br", "Dr"],
                "suffixes": ["ok", "ag", "ul", "ax", "or"],
                "titleFormat": "{0} the {1}"
            },
            "lootTable": {
                "entries": [
                    { "itemId": "health_potion", "weight": 100, "minQuantity": 1, "maxQuantity": 1, "dropChance": 0.25 },
                    { "itemId": "iron_sword", "weight": 50, "minQuantity": 1, "maxQuantity": 1, "dropChance": 0.10 },
                    { "itemId": "orcish_helm", "weight": 30, "minQuantity": 1, "maxQuantity": 1, "dropChance": 0.05 }
                ],
                "currencyDrops": [
                    { "currencyId": "gold", "minAmount": 15, "maxAmount": 35, "dropChance": 1.0 }
                ]
            }
        },
        {
            "id": "goblin_shaman",
            "name": "Goblin Shaman",
            "description": "A goblin adorned with crude fetishes and glowing runes.",
            "baseHealth": 25,
            "baseAttack": 6,
            "baseDefense": 1,
            "experienceValue": 30,
            "behavior": "Support",
            "tags": ["humanoid", "magic"],
            "canHeal": true,
            "healAmount": 10,
            "spawnWeight": 30,
            "initiativeModifier": 2,
            "baseResistances": {},
            "possibleTiers": ["common", "named", "elite"],
            "possibleTraits": ["regenerating"],
            "nameGenerator": {
                "prefixes": ["Zn", "Xr", "Wr", "Qz", "Vx"],
                "suffixes": ["ik", "ax", "um", "ek", "oz"],
                "titleFormat": "{0} the Shaman"
            },
            "lootTable": {
                "entries": [
                    { "itemId": "mana_potion", "weight": 100, "minQuantity": 1, "maxQuantity": 1, "dropChance": 0.20 },
                    { "itemId": "fetish_charm", "weight": 50, "minQuantity": 1, "maxQuantity": 1, "dropChance": 0.10 }
                ],
                "currencyDrops": [
                    { "currencyId": "gold", "minAmount": 10, "maxAmount": 25, "dropChance": 0.85 }
                ]
            }
        },
        {
            "id": "slime",
            "name": "Slime",
            "description": "A gelatinous blob that oozes across the floor.",
            "baseHealth": 40,
            "baseAttack": 5,
            "baseDefense": 5,
            "experienceValue": 15,
            "behavior": "Chaotic",
            "tags": ["ooze"],
            "canHeal": false,
            "spawnWeight": 90,
            "initiativeModifier": -2,
            "baseResistances": {
                "physical": 50,
                "fire": -25,
                "ice": -25,
                "lightning": -50,
                "poison": 100
            },
            "possibleTiers": ["common", "named", "elite"],
            "possibleTraits": ["regenerating", "venomous"],
            "nameGenerator": {
                "prefixes": ["Bl", "Gl", "Sl", "Sp", "Sq"],
                "suffixes": ["ob", "ub", "op", "ip", "oop"],
                "titleFormat": "{0} the {1}"
            },
            "lootTable": {
                "entries": [
                    { "itemId": "slime_residue", "weight": 100, "minQuantity": 1, "maxQuantity": 3, "dropChance": 0.50 }
                ],
                "currencyDrops": [
                    { "currencyId": "gold", "minAmount": 1, "maxAmount": 5, "dropChance": 0.30 }
                ]
            }
        }
    ]
}
```

---

## 12. Data Model Changes

### No Domain Changes Required

This phase creates only a JSON Schema file and updates the configuration file reference. No changes to domain entities, services, or application layer are required.

| Layer | Changes |
|-------|---------|
| Domain | None |
| Application | None |
| Infrastructure | None |
| Configuration | One schema file added, one config file updated with $schema reference |

### Schema as Documentation

The schema serves as:
- **Validation contract** for monster configuration
- **IDE documentation** via description fields
- **Modding reference** for custom monster systems
- **Design specification** for monster mechanics

---

## 13. Logging Specifications

### No Runtime Logging Required

Schema validation occurs at design-time in IDE/editors, not at runtime. No logging infrastructure changes are needed for this phase.

| Component | Level | Events |
|-----------|-------|--------|
| N/A | N/A | Schema validation is IDE-based |

---

## 14. Unit Testing Requirements

### Test Count by Feature

| Feature | Test Count |
|---------|------------|
| Schema Valid Structure | ~1 |
| Base Stat Range Validation | ~1 |
| Behavior Enum Validation | ~1 |
| Resistance Map Validation | ~1 |
| Embedded Loot Table Validation | ~1 |
| Configuration File Validation | ~1 |
| **Total** | **~6** |

### Test Descriptions

#### MonstersSchemaTests.cs

```csharp
[TestFixture]
public class MonstersSchemaTests
{
    /// <summary>
    /// Verifies the schema file is valid JSON Schema Draft-07.
    /// </summary>
    [Test]
    public void Schema_IsValidJsonSchemaDraft07();

    /// <summary>
    /// Verifies the monsters.json validates against the schema without errors.
    /// </summary>
    [Test]
    public void MonstersJson_ValidatesAgainstSchema();

    /// <summary>
    /// Verifies baseHealth must be >= 1.
    /// </summary>
    [Test]
    public void BaseHealth_LessThanOne_FailsValidation();

    /// <summary>
    /// Verifies behavior must be a valid enum value.
    /// </summary>
    [Test]
    public void Behavior_InvalidEnumValue_FailsValidation();

    /// <summary>
    /// Verifies resistance values must be between -100 and 100.
    /// </summary>
    [Test]
    public void Resistance_OutOfRange_FailsValidation();

    /// <summary>
    /// Verifies embedded loot table structure is validated correctly.
    /// </summary>
    [Test]
    public void EmbeddedLootTable_ValidStructure_PassesValidation();
}
```

### Test Implementation Notes

Tests should use a JSON Schema validation library (e.g., `NJsonSchema` for C#) to:
1. Load the schema file
2. Validate test JSON documents
3. Assert expected validation results

---

## 15. Use Cases

### UC-001: Load Monster Configuration

**Actor:** Game System
**Flow:** System starts -> Loads `monsters.json` -> Schema validates content -> Monsters available for spawn system

### UC-002: Edit Monsters in IDE

**Actor:** Developer/Modder
**Flow:** Opens `monsters.json` in VS Code -> IDE loads schema -> Autocomplete suggests properties -> Validation errors shown inline

### UC-003: Add New Monster Type

**Actor:** Modder
**Flow:** Adds new monster to `monsters` array -> Sets id, name, stats -> Sets behavior and tags -> Adds tier/trait references -> Configures loot table -> IDE validates structure

### UC-004: Configure Monster Resistances

**Actor:** Modder
**Flow:** Edits baseResistances object -> Adds damage type keys with percentage values -> IDE validates range (-100 to 100)

### UC-005: Invalid Base Health

**Actor:** Modder
**Flow:** Sets baseHealth to 0 (invalid) -> IDE shows error "baseHealth must be >= 1" -> Modder corrects to 1 or higher

### UC-006: Configure Embedded Loot Table

**Actor:** Modder
**Flow:** Adds lootTable object -> Adds entries with itemId, weight, dropChance -> Adds currencyDrops -> IDE validates structure

---

## 16. Deliverable Checklist

### Schema Files
- [ ] `config/schemas/monsters.schema.json` created
- [ ] Schema follows JSON Schema Draft-07 format
- [ ] Schema includes all defined properties
- [ ] Schema includes definitions section (MonsterDefinition, NameGenerator, EmbeddedLootTable, LootEntry, CurrencyDrop, LevelRange)

### Validation Rules
- [ ] Monster ID pattern validation: `^[a-z][a-z0-9_]*$`
- [ ] Base stat validation (health >= 1, attack/defense >= 0)
- [ ] Behavior enum validation (6 options)
- [ ] Tags array validation (minItems: 1)
- [ ] Resistance map validation (-100 to 100)
- [ ] Tier/trait references validated as string arrays
- [ ] Name generator structure validated
- [ ] Embedded loot table validated
- [ ] Drop chance range validation (0.0-1.0)
- [ ] Required fields enforced
- [ ] Optional fields have defaults

### Configuration Files
- [ ] `monsters.json` updated with $schema reference
- [ ] Existing monsters validate against schema
- [ ] All 5 monsters pass validation

### Testing
- [ ] ~6 unit tests implemented
- [ ] All tests passing
- [ ] Tests cover happy path and error cases

### Documentation
- [ ] Schema properties have descriptions
- [ ] This design specification complete

---

## 17. Acceptance Criteria

### Functional
- [ ] `monsters.schema.json` created in `config/schemas/` directory
- [ ] Schema validates existing `monsters.json` without errors
- [ ] Base stats validated (health >= 1, attack/defense >= 0)
- [ ] Behavior enum validated (6 options: Aggressive, Defensive, Cowardly, Support, Chaotic, Tactical)
- [ ] Tags validated as array of strings (minItems: 1)
- [ ] Resistance map validated (damage type keys, -100 to 100 values)
- [ ] Tier/trait references validated as string arrays
- [ ] Name generator structure validated (prefixes, suffixes, titleFormat)
- [ ] Embedded loot table validated
- [ ] VS Code provides autocomplete when schema linked

### Quality
- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] ~6 unit tests pass
- [ ] Schema file is valid JSON
- [ ] All schema properties have descriptions

---

## 18. Dependencies

### Required from Prior Versions

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `loot-tables.schema.json` | `config/schemas/loot-tables.schema.json` (v0.14.2d) | Embedded loot table follows similar patterns |
| Schema patterns | `config/schemas/*.schema.json` | Reference for schema structure |
| ID patterns | Prior schemas | Consistent ID patterns |

### Provides to Future Versions

| Type | Usage |
|------|-------|
| `monsters.schema.json` | Validates monster configuration |
| MonsterDefinition pattern | Referenced by bosses.schema.json (v0.14.3d) |
| Monster IDs | Referenced by bosses.json baseMonsterId |
| EmbeddedLootTable pattern | Reusable loot table definition |

### Implementation Order Note

**v0.14.3a can be implemented in parallel with v0.14.3b and v0.14.3c** as they have no internal dependencies.

v0.14.3d (Bosses) should be implemented last as it references monster IDs from v0.14.3a.

---

## 19. Future Considerations

### Deferred to Future Versions

- **Cross-reference validation**: Validating tier/trait/ability/biome IDs exist in respective config files
- **AI behavior execution**: Runtime AI decision-making logic
- **Spawn system logic**: Runtime monster spawning and placement
- **Dynamic stat scaling**: Level-based monster stat scaling
- **Monster variants**: Visual/stat variations of base monsters

### Out of Scope

- **Trait schema** (v0.14.3b) - Traits that modify monster stats and abilities
- **Tier schema** (v0.14.3c) - Difficulty tiers that scale monster power
- **Boss schema** (v0.14.3d) - Complex boss encounter definitions
- **Runtime monster AI**: Application-level AI execution (handled by AI service)
- **Spawn distribution logic**: Runtime mechanics for monster spawning (domain logic)
- **Balance tuning**: Specific stat values and drop rates (design decisions)

### Potential Future Enhancements

If the monster system expands, consider adding to the schema:

**Monster Variants:**
```json
"variants": {
    "type": "array",
    "description": "Visual/stat variations of this monster",
    "items": {
        "type": "object",
        "properties": {
            "id": { "type": "string" },
            "nameSuffix": { "type": "string" },
            "statModifiers": { "type": "object" },
            "visualModifiers": { "type": "object" }
        }
    }
}
```

**External Loot Table Reference:**
```json
"lootTableId": {
    "type": "string",
    "description": "Reference to external loot table in loot-tables.json",
    "pattern": "^[a-z][a-z0-9_-]*$"
}
```

**Faction System:**
```json
"factionId": {
    "type": "string",
    "description": "Faction this monster belongs to (affects hostility)",
    "pattern": "^[a-z][a-z0-9_-]*$"
}
```

**Sound/Visual Effects:**
```json
"sounds": {
    "type": "object",
    "properties": {
        "spawn": { "type": "string" },
        "attack": { "type": "string" },
        "death": { "type": "string" },
        "idle": { "type": "array", "items": { "type": "string" } }
    }
}
```

**Environmental Hazard Immunity:**
```json
"hazardImmunities": {
    "type": "array",
    "description": "Hazard types this monster is immune to",
    "items": { "type": "string" }
}
```

---

*Document Version: 1.0*
*Last Updated: 2026-01-17*
*Author: Claude*
