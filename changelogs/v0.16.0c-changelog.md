# v0.16.0c Changelog - Drop Probability Tables

## Summary

Implements the **Drop Probability Table** system that determines what quality tier of loot enemies drop when defeated. Different enemy classes have distinct probability distributions, creating meaningful loot progression where stronger enemies yield better rewards.

## Added

### Domain Layer - Enum (1 file)

| File                | Description                                                                                             |
| ------------------- | ------------------------------------------------------------------------------------------------------- |
| `EnemyDropClass.cs` | Enum classifying enemies by loot potential: Trash (0), Standard (1), Elite (2), MiniBoss (3), Boss (4). |

### Domain Layer - Value Objects (2 files)

| File                      | Description                                                                                                                                             |
| ------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `DropRollResult.cs`       | `readonly record struct` representing drop outcome. Factory methods: `Dropped()`, `NoDrop()`. Properties: `DroppedTier`, `IsNoDrop`, `RolledValue`.     |
| `DropProbabilityEntry.cs` | Sealed class defining probability distribution per enemy class. Factory: `Create()` with validation. Method: `RollDrop(Random)` for weighted selection. |

### Application Layer - Interfaces (1 file)

| File                    | Description                                                                                                                                                             |
| ----------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `IDropTableProvider.cs` | Interface for drop table access. Methods: `GetDropEntry()`, `RollDrop()`, `GetAllEntries()`, `ValidateConfiguration()`, `GetHighestPossibleTier()`, `CanDropNothing()`. |

### Configuration (2 files)

| File                                     | Description                                                                                  |
| ---------------------------------------- | -------------------------------------------------------------------------------------------- |
| `config/drop-tables.json`                | Drop probability tables for all 5 enemy classes with tier probabilities and no-drop chances. |
| `config/schemas/drop-tables.schema.json` | JSON Schema draft-07 for validation. Enforces exactly 5 entries and probability ranges.      |

### Unit Tests (3 files, 26 test cases)

| File                           | Tests                                                                                        |
| ------------------------------ | -------------------------------------------------------------------------------------------- |
| `EnemyDropClassTests.cs`       | Enum values, count, string parsing.                                                          |
| `DropRollResultTests.cs`       | Factory methods, Tier access, HasDrop, ToString.                                             |
| `DropProbabilityEntryTests.cs` | Create validation, RollDrop distribution, GetTierProbability, HighestPossibleTier, Validate. |

## Drop Probability Reference

| Enemy Class | Tier Range | No-Drop | Best Tier Chance | Design Intent             |
| ----------- | ---------- | ------- | ---------------- | ------------------------- |
| Trash       | 0-1        | 10%     | 30% T1           | Clear quickly, low reward |
| Standard    | 1-3        | 0%      | 20% T3           | Core gameplay loop        |
| Elite       | 2-4        | 0%      | 10% T4           | Risk/reward encounters    |
| MiniBoss    | 2-4        | 0%      | 30% T4           | Memorable milestones      |
| Boss        | 3-4        | 0%      | 70% T4           | Climactic rewards         |

## Files Changed

### Added (9 files)

- `src/Core/RuneAndRust.Domain/Enums/EnemyDropClass.cs`
- `src/Core/RuneAndRust.Domain/ValueObjects/DropRollResult.cs`
- `src/Core/RuneAndRust.Domain/ValueObjects/DropProbabilityEntry.cs`
- `src/Core/RuneAndRust.Application/Interfaces/IDropTableProvider.cs`
- `config/drop-tables.json`
- `config/schemas/drop-tables.schema.json`
- `tests/RuneAndRust.Domain.UnitTests/Enums/EnemyDropClassTests.cs`
- `tests/RuneAndRust.Domain.UnitTests/ValueObjects/DropRollResultTests.cs`
- `tests/RuneAndRust.Domain.UnitTests/ValueObjects/DropProbabilityEntryTests.cs`

## Dependencies

### Requires from v0.16.0a

- `QualityTier` enum for tier keys in probability dictionary

### Provides to v0.16.0d

- `EnemyDropClass`, `DropProbabilityEntry`, `DropRollResult`, `IDropTableProvider` for loot generation

## Notes

- `DropTableProvider` implementation deferred to v0.16.0d (Loot Service Integration)
- Weighted selection algorithm uses cumulative probability thresholds
- Probabilities must sum to 1.0 (validated on creation)
