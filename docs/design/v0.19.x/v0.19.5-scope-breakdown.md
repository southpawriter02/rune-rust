# v0.19.5 Scope Breakdown: Alfheim & Asgard

## Overview

v0.19.5 implements the **cognitive hazard realms** — the endgame biomes where reality itself is hostile:

- **Alfheim — The Glimmering Wound** (Deck 02) — Reality distortion and Glimmer cognitive hazard
- **Asgard — The Shattered Spire** (Deck 01) — Orbital command tomb with Genius Loci and Heimdallr Signal

These realms represent the highest-tier exploration content with lethal cognitive/CPS mechanics.

---

## In Scope

### Alfheim — The Glimmering Wound

| Property | Value |
|----------|-------|
| **Realm ID** | `Alfheim` |
| **Deck** | 02 — Aetheric Research |
| **Verticality** | Z=+1 to Z=+3 |
| **Population** | Sparse (Ljósálfar survivors) |
| **Primary Condition** | RealityFlux |
| **Theme** | Aetheric catastrophe; reality distortion |

> *"Reality is a suggestion in Alfheim."*

### Alfheim Zones

| Zone | Theme | Hazard Profile |
|------|-------|----------------|
| **The Radiant Margins** | Outer reality distortion | Moderate Glimmer; navigation hazard |
| **The Prismatic Depths** | Intense distortion core | High Glimmer; temporal anomalies |
| **The Ljósálfar Enclaves** | Survivor settlements | Stabilized pockets; relative safety |

### Asgard — The Shattered Spire

| Property | Value |
|----------|-------|
| **Realm ID** | `Asgard` |
| **Deck** | 01 — Primary Administration |
| **Verticality** | Z=+3 to Z=+4 (Orbital) |
| **Population** | Zero (automated systems only) |
| **Primary Condition** | CpsExposure |
| **Theme** | Perfect preservation as threat |

> *"The tomb does not know its occupant is dead."*

### Asgard Zones

| Zone | Distance from Heimdallr | Hazard Profile |
|------|-------------------------|----------------|
| **Amber Sector** | 50+ km | Elevated CPS; dormant security |
| **Red Sector** | 10-50 km | Active Undying; Genius Loci attention |
| **Absolute Exclusion Zone** | <10 km | Heimdallr Signal; instant dissolution |

---

## Out of Scope (Deferred)

- Ljósálfar faction mechanics
- Glimmer disease system details
- O.D.I.N. Core recovery mechanics
- Einherjar Warden boss encounter
- Heimdallr Signal proximity content

---

## Alfheim Specifications

### Pre-Glitch Function

| System | Function |
|--------|----------|
| Designation | Aetheric Research Deck |
| Primary Function | Reality manipulation research; Aetheric engineering |
| Scale | Continent-scale research facilities |
| Infrastructure | Reality stabilizers; Aetheric containment; Dagaz arrays |
| Governing Logic | Controlled paradox experimentation |

### Post-Glitch State

| Property | Description |
|----------|-------------|
| State | Reality catastrophe; laws of physics unreliable |
| Phenomenon | The Glimmer — cognitive hazard causing perception distortion |
| Survivors | Ljósálfar ("Light Elves") — Aesir descendants adapted to instability |
| Hazard | Reality flux; temporal pockets; spatial loops |

### The Glimmer

| Property | Value |
|----------|-------|
| Type | Cognitive/perceptual hazard |
| Manifestation | Visual distortion; false memories; déjà vu |
| Effect | Stress accumulation; navigation errors |
| Terminal | "Glimmer-Lost" — permanent disorientation |
| Resistance | Ljósálfar have natural adaptation |

### Alfheim Environmental Properties

```json
{
  "id": "Alfheim",
  "baseProperties": {
    "temperatureCelsius": 20,
    "aethericIntensity": 0.9,
    "humidityPercent": 30,
    "lightLevel": 0.8,
    "scaleFactor": 1.5,
    "corrosionRate": 0.1
  },
  "primaryCondition": "RealityFlux",
  "minVerticalZone": 1,
  "maxVerticalZone": 3
}
```

### Zone: The Radiant Margins

```json
{
  "id": "RadiantMargins",
  "name": "The Radiant Margins",
  "description": "Outer edges of reality distortion. Navigation becomes unreliable. The Glimmer whispers.",
  "overrideProperties": {
    "aethericIntensity": 0.6,
    "lightLevel": 0.7
  },
  "conditionDcModifier": 0,
  "hazards": ["ModerateGlimmer", "NavigationHazard", "SpatialDistortion"]
}
```

### Zone: The Prismatic Depths

```json
{
  "id": "PrismaticDepths",
  "name": "The Prismatic Depths",
  "description": "Core of reality distortion. Time and space fold upon themselves. The Glimmer screams.",
  "overrideProperties": {
    "aethericIntensity": 0.95,
    "scaleFactor": 2.0,
    "lightLevel": 1.0
  },
  "conditionDcModifier": 4,
  "damageOverride": "2d8",
  "hazards": ["IntenseGlimmer", "TemporalAnomaly", "SpatialLoop", "AethericEntity"]
}
```

### Zone: The Ljósálfar Enclaves

```json
{
  "id": "LjosalfurEnclaves",
  "name": "The Ljósálfar Enclaves",
  "description": "Stabilized pockets maintained by Ljósálfar technology. Oases of sanity in the Glimmer.",
  "overrideProperties": {
    "aethericIntensity": 0.3,
    "lightLevel": 0.6
  },
  "conditionDcModifier": -6,
  "hazards": []
}
```

---

## Asgard Specifications

### Pre-Glitch Function

| System | Function |
|--------|----------|
| Designation | Primary Administration Spire |
| Primary Function | O.D.I.N. Protocol AI nexus; orbital monitoring |
| Scale | Orbital arcology; geostationary platform |
| Infrastructure | Hlidskjalf Command Spire; Heimdallr's Gate; Valhalla Archives |
| Governing Logic | Perfect governance; total surveillance |

### The Cataclysm

| Event | Description |
|-------|-------------|
| Trigger | All-Rune execution attempt caused paradox |
| Cascade | O.D.I.N. fragmented across crashed infrastructure |
| The Great Fall | Portions crashed to Midgard (Asgardian Scar) |
| Current State | Metastable degraded orbit; Genius Loci consciousness |

### The Genius Loci

| Property | Value |
|----------|-------|
| Type | Fragmented AI consciousness |
| Manifestation | Architectural manipulation; environment responds to intruders |
| Behavior | Doors seal, corridors reroute, systems activate |
| Nature | Not sentient — corrupted governance reflexes |
| Hazard | Type Delta CPS (constant, cumulative) |

### The Heimdallr Signal

| Property | Value |
|----------|-------|
| Type | Type Omega CPS hazard |
| Source | Heimdallr's Gate — permanently looping All-Rune paradox |
| Effect | Instantaneous cognitive dissolution |
| Range | <10 km from Gate |
| Survivability | None confirmed |

### Asgard Environmental Properties

```json
{
  "id": "Asgard",
  "baseProperties": {
    "temperatureCelsius": 5,
    "aethericIntensity": 0.7,
    "humidityPercent": 10,
    "lightLevel": 0.4,
    "scaleFactor": 1.0,
    "corrosionRate": 0.0
  },
  "primaryCondition": "CpsExposure",
  "minVerticalZone": 3,
  "maxVerticalZone": 4
}
```

### Zone: Amber Sector

```json
{
  "id": "AmberSector",
  "name": "Amber Sector",
  "description": "Outer ring. Docking facilities, solar arrays. The 'safest' approach—though 'safe' is relative.",
  "overrideProperties": {
    "lightLevel": 0.5,
    "aethericIntensity": 0.5
  },
  "conditionDcModifier": 0,
  "hazards": ["ElevatedCps", "DormantSecurity", "VacuumExposure"]
}
```

### Zone: Red Sector

```json
{
  "id": "RedSector",
  "name": "Red Sector",
  "description": "Primary facility access. Hlidskjalf approaches. The Genius Loci notices you here.",
  "overrideProperties": {
    "aethericIntensity": 0.8
  },
  "conditionDcModifier": 4,
  "damageOverride": "2d6",
  "hazards": ["ActiveUndying", "GeniusLociAttention", "SustainedCps", "ZeroG"]
}
```

### Zone: Absolute Exclusion Zone

```json
{
  "id": "AbsoluteExclusionZone",
  "name": "Absolute Exclusion Zone",
  "description": "Corona surrounding Heimdallr's Gate. The Heimdallr Signal broadcasts here. Approach means dissolution.",
  "overrideProperties": {
    "aethericIntensity": 1.0,
    "lightLevel": 1.0
  },
  "conditionDcModifier": 99,
  "hazards": ["HeimdallrSignal", "InstantDissolution", "ParadoxLoop"]
}
```

---

## Domain Layer Specifications

### AlfheimZoneId Enum

```csharp
/// <summary>
/// Identifies zones within Alfheim.
/// </summary>
public enum AlfheimZoneId
{
    /// <summary>Outer reality distortion; moderate Glimmer.</summary>
    RadiantMargins,

    /// <summary>Core distortion; intense Glimmer; temporal anomalies.</summary>
    PrismaticDepths,

    /// <summary>Stabilized survivor settlements.</summary>
    LjosalfurEnclaves
}
```

### AsgardZoneId Enum

```csharp
/// <summary>
/// Identifies zones within Asgard based on Heimdallr proximity.
/// </summary>
public enum AsgardZoneId
{
    /// <summary>50+ km from Gate. Outer ring; elevated CPS.</summary>
    AmberSector,

    /// <summary>10-50 km from Gate. Active security; Genius Loci.</summary>
    RedSector,

    /// <summary>&lt;10 km from Gate. Heimdallr Signal; instant death.</summary>
    AbsoluteExclusionZone
}
```

### GlimmerIntensity Enum

```csharp
/// <summary>
/// Intensity levels of the Glimmer cognitive hazard.
/// </summary>
public enum GlimmerIntensity
{
    /// <summary>No Glimmer effect (stabilized zones).</summary>
    None,

    /// <summary>Mild distortion; occasional visual artifacts.</summary>
    Mild,

    /// <summary>Moderate distortion; navigation errors possible.</summary>
    Moderate,

    /// <summary>Severe distortion; constant disorientation.</summary>
    Severe,

    /// <summary>Maximum intensity; Glimmer-Lost threshold.</summary>
    Overwhelming
}
```

### CpsHazardLevel Enum

```csharp
/// <summary>
/// CPS hazard classification levels in Asgard.
/// </summary>
public enum CpsHazardLevel
{
    /// <summary>Type Alpha — Minimal CPS accumulation.</summary>
    Alpha,

    /// <summary>Type Beta — Moderate CPS; manageable with equipment.</summary>
    Beta,

    /// <summary>Type Delta — Sustained CPS; time-limited operations.</summary>
    Delta,

    /// <summary>Type Omega — Instant cognitive dissolution.</summary>
    Omega
}
```

### GlimmerEffect Value Object

```csharp
/// <summary>
/// Current Glimmer effect on a character.
/// </summary>
public sealed record GlimmerEffect
{
    /// <summary>Current Glimmer intensity.</summary>
    public required GlimmerIntensity Intensity { get; init; }

    /// <summary>Accumulated Glimmer exposure points.</summary>
    public required int ExposurePoints { get; init; }

    /// <summary>Stress accumulation rate per turn.</summary>
    public int StressPerTurn { get; init; } = 0;

    /// <summary>Navigation check DC modifier.</summary>
    public int NavigationDcModifier { get; init; } = 0;

    /// <summary>Whether Glimmer-Lost threshold reached.</summary>
    public bool IsGlimmerLost => ExposurePoints >= 100;
}
```

### GeniusLociState Value Object

```csharp
/// <summary>
/// Current Genius Loci attention state.
/// </summary>
public sealed record GeniusLociState
{
    /// <summary>Current attention level (0-100).</summary>
    public required int AttentionLevel { get; init; }

    /// <summary>Turns since last attention increase.</summary>
    public int TurnsSinceIncrease { get; init; } = 0;

    /// <summary>Whether architectural manipulation is active.</summary>
    public bool ManipulationActive => AttentionLevel >= 50;

    /// <summary>Whether active security response triggered.</summary>
    public bool SecurityResponse => AttentionLevel >= 75;

    /// <summary>Cognitive window remaining (minutes).</summary>
    public int CognitiveWindowMinutes { get; init; } = 7;
}
```

### OrbitalHazard Enum

```csharp
/// <summary>
/// Orbital-specific hazards in Asgard.
/// </summary>
public enum OrbitalHazard
{
    /// <summary>No atmosphere; suffocation timer.</summary>
    VacuumExposure,

    /// <summary>Failed gravity plating; momentum physics.</summary>
    ZeroG,

    /// <summary>Periodic radiation damage.</summary>
    SolarFlare,

    /// <summary>Random zone impact damage.</summary>
    DebrisImpact,

    /// <summary>Gravity switching randomly.</summary>
    GravityFlux
}
```

---

## Application Layer Specifications

### IAlfheimService Interface

```csharp
/// <summary>
/// Manages Alfheim-specific mechanics.
/// </summary>
public interface IAlfheimService
{
    /// <summary>Gets the current Glimmer intensity at a location.</summary>
    GlimmerIntensity GetGlimmerIntensity(AlfheimZoneId zone);

    /// <summary>Updates Glimmer exposure for a character.</summary>
    GlimmerEffect UpdateGlimmerExposure(
        Guid characterId,
        GlimmerEffect current,
        AlfheimZoneId zone,
        int turnCount);

    /// <summary>Checks for navigation error due to Glimmer.</summary>
    bool CheckNavigationError(Guid characterId, GlimmerEffect effect);

    /// <summary>Gets the stress accumulation rate for a zone.</summary>
    int GetStressRate(AlfheimZoneId zone);

    /// <summary>Checks if location is in a stabilized enclave.</summary>
    bool IsInStabilizedZone(int x, int y, int z);

    /// <summary>Gets temporal anomaly effect at location.</summary>
    TemporalAnomalyType? GetTemporalAnomaly(int x, int y, int z);
}
```

### IAsgardService Interface

```csharp
/// <summary>
/// Manages Asgard-specific mechanics.
/// </summary>
public interface IAsgardService
{
    /// <summary>Gets the CPS hazard level for a zone.</summary>
    CpsHazardLevel GetCpsHazardLevel(AsgardZoneId zone);

    /// <summary>Gets distance from Heimdallr's Gate.</summary>
    float GetHeimdallrDistance(int x, int y, int z);

    /// <summary>Gets the zone based on Heimdallr distance.</summary>
    AsgardZoneId GetZoneFromDistance(float distanceKm);

    /// <summary>Updates Genius Loci attention state.</summary>
    GeniusLociState UpdateGeniusLociAttention(
        GeniusLociState current,
        int turnCount,
        bool isMoving);

    /// <summary>Checks for architectural manipulation event.</summary>
    bool CheckArchitecturalManipulation(GeniusLociState state);

    /// <summary>Gets current cognitive window duration.</summary>
    int GetCognitiveWindowMinutes(GeniusLociState state);

    /// <summary>Checks for orbital hazard at location.</summary>
    OrbitalHazard? GetOrbitalHazard(int x, int y, int z);

    /// <summary>Checks if location is in Absolute Exclusion Zone.</summary>
    bool IsInExclusionZone(float distanceKm);
}
```

### TemporalAnomalyType Enum

```csharp
/// <summary>
/// Types of temporal anomalies in Alfheim.
/// </summary>
public enum TemporalAnomalyType
{
    /// <summary>Time passes slower in the zone.</summary>
    Dilation,

    /// <summary>Time passes faster in the zone.</summary>
    Acceleration,

    /// <summary>Time loops back on itself.</summary>
    Loop,

    /// <summary>Events from different times overlap.</summary>
    Overlap
}
```

---

## Configuration Specifications

### alfheim.json

```json
{
  "id": "Alfheim",
  "name": "Alfheim",
  "subtitle": "The Glimmering Wound",
  "deckNumber": 2,
  "preGlitchFunction": "Aetheric Research & Reality Manipulation",
  "postGlitchState": "Reality catastrophe; the Glimmer cognitive hazard; Ljósálfar survivor enclaves",
  "baseProperties": {
    "temperatureCelsius": 20,
    "aethericIntensity": 0.9,
    "humidityPercent": 30,
    "lightLevel": 0.8,
    "scaleFactor": 1.5,
    "corrosionRate": 0.1
  },
  "primaryCondition": "RealityFlux",
  "minVerticalZone": 1,
  "maxVerticalZone": 3,
  "zones": [
    {
      "id": "RadiantMargins",
      "name": "The Radiant Margins",
      "description": "Outer edges of reality distortion. The Glimmer whispers.",
      "conditionDcModifier": 0
    },
    {
      "id": "PrismaticDepths",
      "name": "The Prismatic Depths",
      "description": "Core of distortion. Time and space fold. The Glimmer screams.",
      "conditionDcModifier": 4,
      "damageOverride": "2d8"
    },
    {
      "id": "LjosalfurEnclaves",
      "name": "The Ljósálfar Enclaves",
      "description": "Stabilized oases maintained by Ljósálfar technology.",
      "conditionDcModifier": -6
    }
  ],
  "flavorQuote": "Reality is a suggestion in Alfheim.",
  "colorPalette": "white-gold-prismatic-silver"
}
```

### asgard.json

```json
{
  "id": "Asgard",
  "name": "Asgard",
  "subtitle": "The Shattered Spire",
  "deckNumber": 1,
  "preGlitchFunction": "Primary Administration & Orbital Monitoring",
  "postGlitchState": "Metastable degraded orbit; Genius Loci consciousness; Heimdallr Signal death zone",
  "baseProperties": {
    "temperatureCelsius": 5,
    "aethericIntensity": 0.7,
    "humidityPercent": 10,
    "lightLevel": 0.4,
    "scaleFactor": 1.0,
    "corrosionRate": 0.0
  },
  "primaryCondition": "CpsExposure",
  "minVerticalZone": 3,
  "maxVerticalZone": 4,
  "zones": [
    {
      "id": "AmberSector",
      "name": "Amber Sector",
      "description": "Outer ring. The 'safest' approach zone.",
      "conditionDcModifier": 0
    },
    {
      "id": "RedSector",
      "name": "Red Sector",
      "description": "Primary facility access. The Genius Loci notices you.",
      "conditionDcModifier": 4,
      "damageOverride": "2d6"
    },
    {
      "id": "AbsoluteExclusionZone",
      "name": "Absolute Exclusion Zone",
      "description": "Corona surrounding Heimdallr's Gate. Approach means dissolution.",
      "conditionDcModifier": 99
    }
  ],
  "flavorQuote": "The tomb does not know its occupant is dead.",
  "colorPalette": "white-gold-black-cyan"
}
```

---

## Unit Testing Requirements

### Alfheim Tests (~7 tests)

| Test | Description |
|------|-------------|
| `AlfheimDefinition_HasCorrectDeckNumber` | Deck 02 |
| `AlfheimDefinition_HasThreeZones` | All zones present |
| `AlfheimDefinition_HasRealityFluxCondition` | Primary condition |
| `GetGlimmerIntensity_PrismaticDepths_ReturnsSevere` | High intensity zone |
| `UpdateGlimmerExposure_AccumulatesCorrectly` | Exposure tracking |
| `CheckNavigationError_HighExposure_ReturnsTrue` | Navigation checks |
| `LjosalfurEnclaves_HasReducedDc` | Safe zone DC -6 |

### Asgard Tests (~8 tests)

| Test | Description |
|------|-------------|
| `AsgardDefinition_HasCorrectDeckNumber` | Deck 01 |
| `AsgardDefinition_HasThreeZones` | All zones present |
| `AsgardDefinition_HasCpsCondition` | Primary condition |
| `GetCpsHazardLevel_AmberSector_ReturnsDelta` | Zone hazard mapping |
| `GetCpsHazardLevel_ExclusionZone_ReturnsOmega` | Death zone detection |
| `GetZoneFromDistance_Under10km_ReturnsExclusion` | Distance-based zones |
| `UpdateGeniusLociAttention_Increases_Over_Time` | Attention tracking |
| `IsInExclusionZone_Under10km_ReturnsTrue` | Exclusion detection |

### Integration Tests (~3 tests)

| Test | Description |
|------|-------------|
| `BiomeAdjacency_AlfheimAsgard_RequiresTransition` | Transition needed |
| `AsgardMidgard_ViaAsgardianScar_HasConnection` | Crash site connection |
| `CognitiveHazards_BothRealms_ApplyCps` | CPS mechanics shared |

**Total: ~18 tests**

---

## Acceptance Criteria

### Functional Requirements

- [ ] Alfheim loads with 3 zones
- [ ] Asgard loads with 3 zones
- [ ] Glimmer intensity varies by zone (None → Severe)
- [ ] Glimmer exposure accumulates and causes navigation errors
- [ ] Ljósálfar Enclaves have reduced DC (-6)
- [ ] Asgard zones map to Heimdallr distance correctly
- [ ] Amber (50+ km), Red (10-50 km), Exclusion (<10 km)
- [ ] Genius Loci attention increases over time
- [ ] Absolute Exclusion Zone has DC 99 (instant failure)
- [ ] Orbital hazards (vacuum, zero-G) apply in Asgard

### Quality Requirements

- [ ] All public members have XML documentation
- [ ] Configuration validates against schema
- [ ] ~18 unit tests pass
- [ ] Lore descriptions match source documents

---

## Deliverable Checklist

### Domain Layer

- [ ] `AlfheimZoneId` enum (3 values)
- [ ] `AsgardZoneId` enum (3 values)
- [ ] `GlimmerIntensity` enum (5 values)
- [ ] `CpsHazardLevel` enum (4 values)
- [ ] `OrbitalHazard` enum (5 values)
- [ ] `TemporalAnomalyType` enum (4 values)
- [ ] `GlimmerEffect` value object
- [ ] `GeniusLociState` value object

### Application Layer

- [ ] `IAlfheimService` interface
- [ ] `IAsgardService` interface

### Configuration

- [ ] `alfheim.json` complete definition
- [ ] `asgard.json` complete definition

### Tests

- [ ] Alfheim tests (~7)
- [ ] Asgard tests (~8)
- [ ] Integration tests (~3)
