# v0.15.3a Changelog - Social Interaction Framework

## Added

### Domain Layer - Enums

- **`SocialInteractionType`** (`src/Core/RuneAndRust.Domain/Enums/SocialInteractionType.cs`)
  - New enum with 6 interaction types: `Persuasion`, `Deception`, `Intimidation`, `Negotiation`, `Protocol`, `Interrogation`
  - Each type maps to specific Rhetoric skill checks with unique mechanics

- **`NpcDisposition`** (`src/Core/RuneAndRust.Domain/Enums/NpcDisposition.cs`)
  - New enum with 6 disposition tiers: `Ally`, `Friendly`, `NeutralPositive`, `Neutral`, `Unfriendly`, `Hostile`
  - Maps disposition values (-100 to +100) to dice modifiers (+3d10 to -2d10)

- **`SocialModifierType`** (`src/Core/RuneAndRust.Domain/Enums/SocialModifierType.cs`)
  - New enum for categorizing social modifiers: `FactionRelation`, `ArgumentQuality`, `Evidence`, `TargetState`, `Reputation`, `Cultural`, `Equipment`

### Domain Layer - Extensions

- **`SocialInteractionTypeExtensions`** (`src/Core/RuneAndRust.Domain/Extensions/SocialInteractionTypeExtensions.cs`)
  - Extension methods for interaction type properties: `IsOpposed()`, `HasStressCost()`, `AlwaysCostsReputation()`, `IsMultiRound()`, `GetFumbleType()`, stress/reputation cost accessors

- **`NpcDispositionExtensions`** (`src/Core/RuneAndRust.Domain/Extensions/NpcDispositionExtensions.cs`)
  - Extension methods for disposition handling: `GetDiceModifier()`, `FromValue()`, threshold calculations, navigation between tiers

### Domain Layer - Value Objects

- **`DispositionLevel`** (`src/Core/RuneAndRust.Domain/ValueObjects/DispositionLevel.cs`)
  - Tracks NPC disposition as numeric value with category conversion
  - Supports locking/unlocking for fumble consequences
  - Factory methods: `CreateNeutral()`, `Create()`, `FromCategory()`

- **`SocialModifier`** (`src/Core/RuneAndRust.Domain/ValueObjects/SocialModifier.cs`)
  - Implements `ISkillModifier` for social-specific modifiers
  - 15+ factory methods: `FactionStanding()`, `ArgumentAlignment()`, `Evidence()`, `Suspicious()`, `Trusting()`, `StrengthComparison()`, `Reputation()`, `HasBackup()`, `WieldingArtifact()`, `CulturalKnowledge()`, etc.

- **`SocialContext`** (`src/Core/RuneAndRust.Domain/ValueObjects/SocialContext.cs`)
  - Aggregates all modifiers affecting a social check
  - Properties: `TotalDiceModifier`, `TotalDcModifier`, `EffectiveDc`, interaction type delegates

- **`SocialResult`** (`src/Core/RuneAndRust.Domain/ValueObjects/SocialResult.cs`)
  - Captures social interaction outcomes including disposition changes, reputation effects, unlocked/locked options, stress costs, fumble consequences

### Application Layer

- **`ISocialContextBuilder`** (`src/Core/RuneAndRust.Application/Interfaces/ISocialContextBuilder.cs`)
  - Fluent builder interface for constructing `SocialContext` instances
  - Methods for target, faction, culture, modifiers, and convenience helpers

- **`SocialContextBuilder`** (`src/Core/RuneAndRust.Application/Services/SocialContextBuilder.cs`)
  - Full implementation with structured logging integration
  - Filters modifiers by interaction type during build

### Unit Tests

- **`DispositionLevelTests`** - 23 tests covering factory methods, modification, locking, and threshold calculations
- **`SocialModifierTests`** - 24 tests covering all factory methods and filtering logic
- **`SocialContextTests`** - 22 tests covering modifier aggregation and interaction type properties
- **`SocialContextBuilderTests`** - 20 tests covering fluent API and complex scenarios

## Changed

- **`ModifierCategory`** (`src/Core/RuneAndRust.Domain/Enums/ModifierCategory.cs`)
  - Added `Social = 4` category for social interaction modifiers

## Dependencies

- Builds on v0.15.1a Skill Context Framework
- Uses existing `FumbleType` enum (TrustShattered, LieExposed, ChallengeAccepted)
- Uses existing `FumbleConsequence` entity
- Uses existing `OutcomeDetails` and `SkillOutcome` value objects

## Notes

- This version establishes the foundation for social interactions
- Future versions will add:
  - v0.15.3b: Negotiation position tracks and multi-round mechanics
  - v0.15.3c: Interrogation resistance system
  - v0.15.3d: Cultural protocols (Dvergr, Utgard, etc.)
