# v0.13.4 Achievements & Statistics UI - Scope Breakdown

**Version:** 0.13.4
**Theme:** Achievements & Statistics UI
**Prerequisites:** v0.13.3 Complete (Crafting UI), v0.12.x Achievements & Statistics Services Complete
**Total Estimated Tests:** ~30 new tests

---

## Executive Summary

The Achievements & Statistics UI version implements all achievement and statistics-related UI components that were deferred during v0.12.x development. This includes achievement panel with categories and progress bars, statistics dashboard with category tabs and comparison views, leaderboard display with score breakdown, dice history panel with roll distribution, and playtime tracking displays. These components visualize the achievements and statistics systems introduced in v0.12.x without introducing any new domain logic or business rules.

The work is divided into **four sub-parts**:

| Part | Name | Focus | Est. Tests |
|------|------|-------|------------|
| v0.13.4a | Achievement Panel | Achievement browser, categories, progress bars, notifications | ~8 |
| v0.13.4b | Statistics Dashboard | Stats overview, category tabs, comparison view, charts | ~8 |
| v0.13.4c | Leaderboard View | Ranked entries, score breakdown, personal best highlighting | ~6 |
| v0.13.4d | Dice History Panel | Roll history, streak indicators, roll distribution | ~8 |

---

## Feature Analysis & Categorization

### From v0.13.0-overview.md - v0.12.x Achievements & Statistics UI

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| Achievement Panel | Medium | IAchievementService | **v0.13.4a** |
| Achievement Categories | Medium | AchievementCategory enum | **v0.13.4a** |
| Progress Bars | Low | AchievementProgress | **v0.13.4a** |
| Achievement Notifications | Medium | Achievement events | **v0.13.4a** |
| Rarity Indicators | Low | AchievementRarity enum | **v0.13.4a** |
| Statistics Dashboard | Medium | IStatisticsService | **v0.13.4b** |
| Category Tabs | Low | StatisticsCategory enum | **v0.13.4b** |
| Stat Comparison | Medium | Session vs all-time data | **v0.13.4b** |
| Graphical Displays | Medium | Chart rendering | **v0.13.4b** |
| Leaderboard View | Medium | ILeaderboardService | **v0.13.4c** |
| Score Breakdown | Low | ScoreComponents | **v0.13.4c** |
| Personal Best Highlighting | Low | Player scores | **v0.13.4c** |
| Roll History Panel | Medium | IDiceHistoryService | **v0.13.4d** |
| Streak Indicators | Low | Streak calculation | **v0.13.4d** |
| Roll Statistics | Medium | Distribution data | **v0.13.4d** |
| Session Timer | Low | Session tracking | **v0.13.4b** |
| Total Playtime | Low | Playtime data | **v0.13.4b** |

---

## Existing Infrastructure

### From v0.12.x (Required Services)

| Component | Location | Purpose for v0.13.4 |
|-----------|----------|---------------------|
| `IAchievementService` | `Application/Interfaces/IAchievementService.cs` | Retrieve achievements, progress, unlock status |
| `IStatisticsService` | `Application/Interfaces/IStatisticsService.cs` | Retrieve player statistics by category |
| `ILeaderboardService` | `Application/Interfaces/ILeaderboardService.cs` | Retrieve leaderboard entries, rankings |
| `IDiceHistoryService` | `Application/Interfaces/IDiceHistoryService.cs` | Retrieve roll history, statistics |
| `AchievementDefinition` | `Domain/Entities/AchievementDefinition.cs` | Achievement templates with requirements |
| `PlayerStatistics` | `Domain/Entities/PlayerStatistics.cs` | Player statistics tracking entity |
| `DiceRollHistory` | `Domain/Entities/DiceRollHistory.cs` | Roll history tracking entity |

### From v0.7.x-v0.8.x (Existing UI Infrastructure)

| Component | Location | Purpose for v0.13.4 |
|-----------|----------|---------------------|
| `MainMenuView` | `Presentation.Tui/Views/MainMenuView.cs` | Integration point for achievements/stats commands |
| `CharacterView` | `Presentation.Tui/Views/CharacterView.cs` | Integration point for playtime display |
| `ITerminalService` | `Presentation.Tui/Services/ITerminalService.cs` | Terminal output abstraction |

---

## Phase Definitions

---

## v0.13.4a: Achievement Panel

[v0.13.4a Design Specification](v0.13.4a-design-specification.md)

### Overview

Implement the achievement panel showing all achievements organized by category, with progress bars for incremental achievements, rarity tier badges, and unlock notifications.

### Scope

**In Scope:**
- Achievement panel with full achievement browser
- Achievement categories (Combat, Exploration, Progression, Collection, Challenge)
- Progress bars for incremental achievements
- Achievement notifications on unlock
- Rarity tier badges (Bronze, Silver, Gold, Platinum)
- Secret achievement handling (hidden until unlocked)

**Out of Scope:**
- Statistics dashboard (v0.13.4b)
- Leaderboard view (v0.13.4c)
- Dice history panel (v0.13.4d)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| UI Components | 4 | `AchievementPanel`, `AchievementCategoryView`, `AchievementCard`, `RarityBadge` |
| Renderers | 1 | `ProgressBarRenderer` |
| Notifications | 1 | `AchievementUnlockNotification` |
| Commands | 1 | `AchievementsCommand` |
| Unit Tests | ~8 | Panel display, category filtering, progress, notification tests |

### Data Model Changes

```
NEW: AchievementPanel (UI Component)
|-- RenderAchievements(IEnumerable<AchievementDefinition>, IEnumerable<AchievementProgress>): void
|-- FilterByCategory(AchievementCategory): void
|-- ShowTotalProgress(int, int): void
+-- ShowTotalPoints(int): void

NEW: AchievementCategoryView (UI Component)
|-- RenderCategory(AchievementCategory, IEnumerable<AchievementDefinition>): void
|-- GetCategoryIcon(AchievementCategory): string
+-- GetCategoryColor(AchievementCategory): ConsoleColor

NEW: AchievementCard (UI Component)
|-- RenderAchievement(AchievementDefinition, AchievementProgress): void
|-- ShowProgress(int, int): void
|-- ShowUnlockStatus(bool): void
+-- ShowSecretPlaceholder(): void

NEW: RarityBadge (UI Component)
|-- RenderBadge(AchievementRarity): string
|-- GetRarityColor(AchievementRarity): ConsoleColor
+-- GetPointValue(AchievementRarity): int

NEW: ProgressBarRenderer (Renderer)
|-- RenderProgressBar(int, int, int): string
|-- FormatPercentage(int, int): string
+-- GetProgressColor(float): ConsoleColor

NEW: AchievementUnlockNotification (Notification)
|-- ShowUnlock(AchievementDefinition): void
|-- ShowPointsEarned(int): void
+-- GetDuration(): TimeSpan
```

### User-Facing Changes

**Achievement Panel Example:**
```
+=====================================================================+
|                        ACHIEVEMENTS                                  |
+=====================================================================+
|  Total Points: 485 | Unlocked: 23/75 (31%)                          |
+=====================================================================+
|  [All] [Combat] [Exploration] [Progression] [Collection] [Challenge]|
+=====================================================================+
|                                                                      |
|  COMBAT ACHIEVEMENTS                                                 |
|  -------------------                                                 |
|                                                                      |
|  +---------------------------------------------------------------+  |
|  | [x] FIRST BLOOD                                   Bronze (10) |  |
|  |   Defeat your first monster                                   |  |
|  |   [########################################] 100%             |  |
|  +---------------------------------------------------------------+  |
|                                                                      |
|  +---------------------------------------------------------------+  |
|  | [~] MONSTER SLAYER                                Silver (25) |  |
|  |   Defeat 100 monsters                                         |  |
|  |   [####################....................] 47/100 (47%)     |  |
|  +---------------------------------------------------------------+  |
|                                                                      |
|  +---------------------------------------------------------------+  |
|  | ( ) BOSS HUNTER                                   Gold (50)   |  |
|  |   Defeat 10 different bosses                                  |  |
|  |   [########................................] 2/10 (20%)       |  |
|  +---------------------------------------------------------------+  |
|                                                                      |
|  +---------------------------------------------------------------+  |
|  | [L] ??? (Secret Achievement)                      Platinum    |  |
|  |   ???                                                         |  |
|  |   [........................................] Locked           |  |
|  +---------------------------------------------------------------+  |
|                                                                      |
+=====================================================================+
```

**Achievement Status Indicators:**
- `[x]` Unlocked (completed)
- `[~]` In progress (partially complete)
- `( )` Not started (0% progress)
- `[L]` Locked (secret, not yet revealed)

**Rarity Tiers:**
- Bronze (10 points) - Common achievements
- Silver (25 points) - Moderate difficulty
- Gold (50 points) - Challenging achievements
- Platinum (100 points) - Elite achievements

**Achievement Unlock Notification:**
```
+=====================================================+
|  [!]  ACHIEVEMENT UNLOCKED!                         |
+=====================================================+
|                                                     |
|  MONSTER SLAYER                                     |
|  Defeat 100 monsters                                |
|                                                     |
|  Silver   |   +25 Points                            |
+=====================================================+
```

### Acceptance Criteria

- [ ] Achievement panel displays all achievements
- [ ] Achievements grouped by category
- [ ] Category filter tabs work correctly
- [ ] Progress bars show correct percentages
- [ ] Unlocked achievements show `[x]` indicator
- [ ] In-progress achievements show `[~]` indicator
- [ ] Not started achievements show `( )` indicator
- [ ] Secret achievements show `[L]` and `???` until unlocked
- [ ] Rarity badges display with correct colors
- [ ] Total points and unlock count display correctly
- [ ] Achievement unlock notification displays on unlock
- [ ] ~8 unit tests pass

---

## v0.13.4b: Statistics Dashboard

[v0.13.4b Design Specification](v0.13.4b-design-specification.md)

### Overview

Implement the statistics dashboard showing comprehensive player statistics organized by category, with session vs all-time comparison and optional graphical displays for trends.

### Scope

**In Scope:**
- Statistics dashboard with comprehensive overview
- Category tabs (Combat, Exploration, Crafting, Misc)
- Session vs all-time stat comparison
- Simple chart display for distribution/trends
- Session timer display
- Total playtime display

**Out of Scope:**
- Achievement panel (v0.13.4a)
- Leaderboard view (v0.13.4c)
- Dice history panel (v0.13.4d)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| UI Components | 4 | `StatisticsDashboard`, `CategoryTabs`, `StatComparisonView`, `SimpleChart` |
| Renderers | 1 | `PlaytimeRenderer` |
| View Updates | 1 | `CharacterView` integration |
| Unit Tests | ~8 | Dashboard display, category switching, comparison, chart tests |

### Data Model Changes

```
NEW: StatisticsDashboard (UI Component)
|-- RenderStatistics(PlayerStatistics): void
|-- FilterByCategory(StatisticsCategory): void
|-- ShowSessionStats(SessionStatistics): void
+-- ShowAllTimeStats(PlayerStatistics): void

NEW: CategoryTabs (UI Component)
|-- RenderTabs(IEnumerable<StatisticsCategory>): void
|-- SelectTab(StatisticsCategory): void
|-- GetTabIcon(StatisticsCategory): string
+-- HighlightActive(StatisticsCategory): void

NEW: StatComparisonView (UI Component)
|-- RenderComparison(SessionStatistics, PlayerStatistics): void
|-- FormatDelta(int, int): string
|-- GetDeltaColor(int): ConsoleColor
+-- ShowPercentageChange(float): void

NEW: SimpleChart (UI Component)
|-- RenderBarChart(IEnumerable<ChartDataPoint>): void
|-- RenderDistribution(IEnumerable<int>): void
|-- SetScale(int, int): void
+-- ShowLegend(bool): void

NEW: PlaytimeRenderer (Renderer)
|-- FormatSessionTime(TimeSpan): string
|-- FormatTotalPlaytime(TimeSpan): string
+-- GetPlaytimeColor(TimeSpan): ConsoleColor
```

### User-Facing Changes

**Statistics Dashboard Example:**
```
+=====================================================================+
|                       STATISTICS                                     |
+=====================================================================+
|  Session: 2h 15m | Total Playtime: 47h 32m                          |
+=====================================================================+
|  [Combat] [Exploration] [Crafting] [Misc]                           |
+=====================================================================+
|                                                                      |
|  COMBAT STATISTICS                                                   |
|  -----------------                                                   |
|                                                                      |
|  Statistic              Session      All-Time      Change            |
|  ================================================================== |
|  Monsters Defeated          47          1,284       +47              |
|  Bosses Defeated             2             15       +2               |
|  Total Damage Dealt     15,420        524,830   +15,420              |
|  Total Damage Taken      3,240        187,650    +3,240              |
|  Critical Hits              28            892       +28              |
|  Deaths                      1             23        +1              |
|  Highest Hit Damage        847          1,523        -               |
|  Combat Win Rate          94.2%          91.7%    +2.5%              |
|                                                                      |
|  -------------------------------------------------------------------  |
|                                                                      |
|  DAMAGE TYPE DISTRIBUTION                                            |
|  Physical [#############...........] 58%                             |
|  Fire     [######..................] 22%                             |
|  Ice      [####...................] 12%                              |
|  Lightning [##....................] 8%                               |
|                                                                      |
+=====================================================================+
```

**Exploration Statistics Tab:**
```
|  EXPLORATION STATISTICS                                              |
|  ----------------------                                              |
|                                                                      |
|  Statistic              Session      All-Time      Change            |
|  ================================================================== |
|  Rooms Discovered           12            342       +12              |
|  Secrets Found               3             47        +3              |
|  Treasure Chests            8            156        +8              |
|  Traps Triggered             2             34        +2              |
|  NPCs Talked To              5             89        +5              |
|  Quests Completed            2             28        +2              |
|  Distance Traveled         847         24,530      +847              |
```

**Crafting Statistics Tab:**
```
|  CRAFTING STATISTICS                                                 |
|  -------------------                                                 |
|                                                                      |
|  Statistic              Session      All-Time      Change            |
|  ================================================================== |
|  Items Crafted              12            245       +12              |
|  Resources Gathered         34            892       +34              |
|  Recipes Discovered          2             35        +2              |
|  Rare Crafts                 1             18        +1              |
|  Epic Crafts                 0              4        -               |
|  Legendary Crafts            0              1        -               |
|  Crafting Failures           3             42        +3              |
```

**Playtime Display (in CharacterView):**
```
Session: 2h 15m | Total: 47h 32m
```

### Acceptance Criteria

- [ ] Statistics dashboard displays all statistics
- [ ] Category tabs switch views correctly
- [ ] Combat statistics display correctly
- [ ] Exploration statistics display correctly
- [ ] Crafting statistics display correctly
- [ ] Misc statistics display correctly
- [ ] Session vs all-time comparison shows deltas
- [ ] Positive changes show `+` prefix
- [ ] Chart renders distribution correctly
- [ ] Session timer displays current session time
- [ ] Total playtime displays correctly
- [ ] ~8 unit tests pass

---

## v0.13.4c: Leaderboard View

[v0.13.4c Design Specification](v0.13.4c-design-specification.md)

### Overview

Implement the leaderboard view showing ranked entries for various categories, score breakdown showing component contributions, and personal best highlighting.

### Scope

**In Scope:**
- Leaderboard view with ranked entries
- Multiple leaderboard categories (High Score, Speedrun, No Death, Achievement Points, Boss Slayer)
- Score breakdown showing components
- Personal best highlighting
- Player rank display

**Out of Scope:**
- Achievement panel (v0.13.4a)
- Statistics dashboard (v0.13.4b)
- Dice history panel (v0.13.4d)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| UI Components | 3 | `LeaderboardView`, `ScoreBreakdownPanel`, `PersonalBestHighlight` |
| Renderers | 1 | `LeaderboardEntryRenderer` |
| Commands | 1 | `LeaderboardCommand` |
| Unit Tests | ~6 | Leaderboard display, ranking, breakdown, highlight tests |

### Data Model Changes

```
NEW: LeaderboardView (UI Component)
|-- RenderLeaderboard(IEnumerable<LeaderboardEntry>): void
|-- SelectCategory(LeaderboardCategory): void
|-- HighlightPlayerEntry(LeaderboardEntry): void
+-- ShowPlayerRank(int, int): void

NEW: ScoreBreakdownPanel (UI Component)
|-- RenderBreakdown(ScoreComponents): void
|-- FormatComponent(string, int): string
|-- ShowMultipliers(IEnumerable<ScoreMultiplier>): void
+-- ShowPenalties(IEnumerable<ScorePenalty>): void

NEW: PersonalBestHighlight (UI Component)
|-- RenderPersonalBest(LeaderboardEntry): void
|-- CompareToEntry(LeaderboardEntry, LeaderboardEntry): void
+-- ShowNewRecord(): void

NEW: LeaderboardEntryRenderer (Renderer)
|-- FormatEntry(LeaderboardEntry, int): string
|-- GetRankColor(int): ConsoleColor
|-- FormatScore(int): string
+-- FormatDate(DateTime): string
```

### User-Facing Changes

**Leaderboard View Example:**
```
+=====================================================================+
|                        LEADERBOARDS                                  |
+=====================================================================+
| [High Score] [Speedrun] [No Death] [Achievement Points] [Boss Slayer]|
+=====================================================================+
|                                                                      |
|   HIGH SCORE LEADERBOARD                                            |
|   ----------------------                                             |
|                                                                      |
|   Rank    Name           Class      Level    Score      Date        |
|   ================================================================= |
|   #1      Thorin        Warrior      15     125,430    2026-01-05   |
|   #2      Elara         Mage         12      98,750    2026-01-03   |
|   #3      Shadow        Rogue        14      87,320    2026-01-08   |
|    4      Grok          Warrior      10      65,100    2026-01-01   |
|   >5      Hero (You)    Paladin       8      52,340    2026-01-10   |
|    6      Luna          Healer        9      48,200    2026-01-02   |
|    7      Drake         Ranger        7      35,600    2025-12-28   |
|                                                                      |
|   ----------------------------------------------------------------- |
|   Your Best: 52,340 (Rank #5)                                       |
|                                                                      |
+=====================================================================+
```

**Rank Indicators:**
- `#1`, `#2`, `#3` - Top 3 (special highlighting)
- `>5` - Current player's entry (highlighted)
- `4`, `5`, etc. - Standard ranks

**Score Breakdown Panel:**
```
|   SCORE BREAKDOWN:                                                   |
|   ----------------------------------------------------------------- |
|   |-- Monsters Killed: 127 x 10 = 1,270                             |
|   |-- Bosses Killed: 3 x 500 = 1,500                                |
|   |-- Rooms Discovered: 42 x 25 = 1,050                             |
|   |-- Gold Earned: 15,340                                            |
|   |-- Level Multiplier: x1.8                                         |
|   |-- Achievement Bonus: 4,850                                       |
|   +-- Death Penalty: -300                                            |
|                                                                      |
|   TOTAL: 52,340                                                      |
```

**Other Leaderboard Categories:**

Speedrun:
```
|   Rank    Name           Class      Level    Time       Date        |
|   ================================================================= |
|   #1      Shadow        Rogue        10     1:23:45    2026-01-08   |
|   #2      Wind          Ranger        8     1:45:20    2026-01-05   |
```

No Death:
```
|   Rank    Name           Class      Level    Floors     Date        |
|   ================================================================= |
|   #1      Iron          Warrior      15        42      2026-01-03   |
|   #2      Shield        Paladin      12        38      2026-01-01   |
```

### Acceptance Criteria

- [ ] Leaderboard view displays ranked entries
- [ ] Top 3 ranks have special highlighting
- [ ] Player's entry is highlighted with `>`
- [ ] Category tabs switch leaderboards correctly
- [ ] Score breakdown shows all components
- [ ] Multipliers display correctly
- [ ] Penalties display correctly (negative)
- [ ] Personal best shows player's record
- [ ] Date formatting is consistent
- [ ] ~6 unit tests pass

---

## v0.13.4d: Dice History Panel

[v0.13.4d Design Specification](v0.13.4d-design-specification.md)

### Overview

Implement the dice history panel showing recent roll history, streak indicators for lucky/unlucky runs, and roll statistics including distribution visualization.

### Scope

**In Scope:**
- Roll history panel showing recent rolls
- Streak indicators (lucky/unlucky streaks)
- Roll statistics (total rolls, natural 20s/1s, average)
- Luck rating calculation
- Roll distribution visualization

**Out of Scope:**
- Achievement panel (v0.13.4a)
- Statistics dashboard (v0.13.4b)
- Leaderboard view (v0.13.4c)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| UI Components | 3 | `DiceHistoryPanel`, `StreakIndicator`, `RollDistributionChart` |
| Renderers | 1 | `DiceRollRenderer` |
| Commands | 1 | `DiceHistoryCommand` |
| Unit Tests | ~8 | Roll history, streak, statistics, distribution tests |

### Data Model Changes

```
NEW: DiceHistoryPanel (UI Component)
|-- RenderHistory(IEnumerable<DiceRoll>): void
|-- ShowStatistics(DiceStatistics): void
|-- ShowLuckRating(float): void
+-- SetDisplayCount(int): void

NEW: StreakIndicator (UI Component)
|-- RenderStreak(int, bool): void
|-- GetStreakDescription(int): string
|-- ShowLongestStreaks(int, int): void
+-- GetStreakColor(int): ConsoleColor

NEW: RollDistributionChart (UI Component)
|-- RenderDistribution(int[]): void
|-- HighlightOutliers(int, int): void
|-- ShowExpectedLine(): void
+-- FormatBar(int, int): string

NEW: DiceRollRenderer (Renderer)
|-- FormatRoll(int, bool, bool): string
|-- FormatRollList(IEnumerable<int>): string
|-- GetRollColor(int): ConsoleColor
+-- HighlightCritical(int): string
```

### User-Facing Changes

**Dice History Panel Example:**
```
+=====================================================================+
|                        DICE HISTORY                                  |
+=====================================================================+
|                                                                      |
|   RECENT ROLLS (d20)                                                 |
|   ------------------                                                 |
|   18, 14, 12, 3, 20!, 8, 15, 11, 19, 7, 16, 4, 9, 13, 20!, 6        |
|                                                                      |
|   ----------------------------------------------------------------- |
|                                                                      |
|   STATISTICS                  LUCK RATING                            |
|   ----------                  -----------                            |
|   Total d20 Rolls: 523        LUCKY (+6.7%)                          |
|   Natural 20s: 47 (9.0%)                                            |
|   Natural 1s: 31 (5.9%)       Current Streak: +3                    |
|   Average Roll: 11.2          (3 above-average in a row)            |
|   Expected: 10.5                                                     |
|                               Longest Lucky: +7                      |
|                               Longest Unlucky: -5                    |
|                                                                      |
|   ----------------------------------------------------------------- |
|                                                                      |
|   ROLL DISTRIBUTION                                                  |
|   -----------------                                                  |
|                                                                      |
|   1  [####................]  31 (5.9%)                              |
|   2  [####................]  28 (5.4%)                              |
|   3  [#####...............]  30 (5.7%)                              |
|   4  [####................]  27 (5.2%)                              |
|   5  [#####...............]  29 (5.5%)                              |
|   6  [####................]  26 (5.0%)                              |
|   7  [#####...............]  28 (5.4%)                              |
|   8  [####................]  25 (4.8%)                              |
|   9  [#####...............]  27 (5.2%)                              |
|   10 [#####...............]  26 (5.0%)                              |
|   11 [#####...............]  28 (5.4%)                              |
|   12 [####................]  24 (4.6%)                              |
|   13 [#####...............]  27 (5.2%)                              |
|   14 [#####...............]  26 (5.0%)                              |
|   15 [######..............]  30 (5.7%)                              |
|   16 [######..............]  32 (6.1%)                              |
|   17 [#####...............]  28 (5.4%)                              |
|   18 [######..............]  31 (5.9%)                              |
|   19 [######..............]  35 (6.7%)                              |
|   20 [#########...........]  47 (9.0%) <- Above expected!           |
|                                                                      |
+=====================================================================+
```

**Roll Formatting:**
- `20!` - Natural 20 (critical success)
- `1!` - Natural 1 (critical failure)
- Regular numbers otherwise

**Luck Rating Levels:**
- `VERY LUCKY (+10%+)` - Significantly above average
- `LUCKY (+5-10%)` - Above average
- `NORMAL (-5% to +5%)` - Within expected range
- `UNLUCKY (-5 to -10%)` - Below average
- `VERY UNLUCKY (-10%+)` - Significantly below average

**Streak Indicators:**
- Positive streak: `+N` (N above-average rolls in a row)
- Negative streak: `-N` (N below-average rolls in a row)

### Acceptance Criteria

- [ ] Roll history displays recent rolls
- [ ] Natural 20s marked with `!`
- [ ] Natural 1s marked with `!`
- [ ] Total roll count displays correctly
- [ ] Natural 20/1 percentages calculate correctly
- [ ] Average roll calculates correctly
- [ ] Luck rating displays based on deviation from expected
- [ ] Current streak shows positive/negative value
- [ ] Longest streaks display correctly
- [ ] Roll distribution chart renders all 20 values
- [ ] Outliers highlighted (above/below expected)
- [ ] ~8 unit tests pass

---

## Dependencies & Prerequisites

```
v0.12.x (Achievements & Statistics) - REQUIRED
    |
    |-- v0.12.x: Achievements ────────────────────────┐
    |       Provides: IAchievementService              |
    |       Provides: AchievementDefinition            |
    |                                                  |
    |-- v0.12.x: Statistics ─────────────────────────┤
    |       Provides: IStatisticsService               |
    |       Provides: PlayerStatistics                 |
    |                                                  |
    |-- v0.12.x: Leaderboards ───────────────────────┤
    |       Provides: ILeaderboardService              |
    |       Provides: LeaderboardEntry                 |
    |                                                  |
    +-- v0.12.x: Dice History ───────────────────────┤
            Provides: IDiceHistoryService              |
            Provides: DiceRollHistory                  |
                                                       |
                                   v
v0.13.4 (Achievements & Statistics UI)
    |
    |-- v0.13.4a: Achievement Panel ─────────────────┐
    |       Dependencies: IAchievementService          |
    |       Provides: AchievementPanel,                |
    |                 AchievementCard, RarityBadge     |
    |                                                  |
    |-- v0.13.4b: Statistics Dashboard ──────────────┤
    |       Dependencies: IStatisticsService           |
    |       Provides: StatisticsDashboard,             |
    |                 CategoryTabs, StatComparisonView |
    |                                                  |
    |-- v0.13.4c: Leaderboard View ──────────────────┤
    |       Dependencies: ILeaderboardService          |
    |       Provides: LeaderboardView,                 |
    |                 ScoreBreakdownPanel              |
    |                                                  |
    +-- v0.13.4d: Dice History Panel ────────────────┘
            Dependencies: IDiceHistoryService
            Provides: DiceHistoryPanel,
                      StreakIndicator, RollDistributionChart
```

---

## Estimated Effort Summary

| Part | New Files | Modified Files | Est. Tests | Complexity |
|------|-----------|----------------|------------|------------|
| v0.13.4a | ~6 | ~1 | ~8 | Medium-High |
| v0.13.4b | ~5 | ~2 | ~8 | Medium-High |
| v0.13.4c | ~4 | ~1 | ~6 | Medium |
| v0.13.4d | ~4 | ~1 | ~8 | Medium |
| **Total** | **~19** | **~5** | **~30** | |

---

## Risk Assessment

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Large achievement lists performance | Medium | Low | Implement pagination/virtualization |
| Chart rendering complexity | Low | Medium | Use simple ASCII bar charts |
| Dice statistics accuracy | Low | Low | Use standard statistical formulas |
| Leaderboard sorting performance | Low | Low | Use indexed queries |
| Session timer accuracy | Low | Low | Use system time tracking |

---

## Design Decisions (Confirmed)

### Achievement Panel

| Decision | Value | Notes |
|----------|-------|-------|
| **Status Indicators** | `[x]`, `[~]`, `( )`, `[L]` | Clear unlock status |
| **Rarity Tiers** | Bronze, Silver, Gold, Platinum | Standard tier names |
| **Point Values** | 10, 25, 50, 100 | Scaled by difficulty |
| **Secret Handling** | `???` until unlocked | Hide details |
| **Notification Duration** | 5 seconds | Auto-dismiss |

### Statistics Dashboard

| Decision | Value | Notes |
|----------|-------|-------|
| **Categories** | Combat, Exploration, Crafting, Misc | Four main categories |
| **Comparison Format** | Session / All-Time / Change | Three-column format |
| **Chart Type** | ASCII bar chart | Simple rendering |
| **Playtime Format** | `#h ##m` | Hours and minutes |

### Leaderboard View

| Decision | Value | Notes |
|----------|-------|-------|
| **Top Highlight** | `#1`, `#2`, `#3` | Special formatting |
| **Player Highlight** | `>N` | Arrow prefix |
| **Score Format** | Comma-separated | `125,430` |
| **Date Format** | `YYYY-MM-DD` | ISO format |

### Dice History Panel

| Decision | Value | Notes |
|----------|-------|-------|
| **Recent Roll Count** | 20 | Display last 20 rolls |
| **Critical Indicator** | `!` suffix | `20!`, `1!` |
| **Luck Rating** | Percentage deviation | From expected average |
| **Distribution Width** | 20 characters | ASCII bar chart |

---

## Next Steps

1. **Review & Approve** - Confirm scope breakdown
2. **v0.13.4a Design Spec** - Create detailed design for Achievement Panel
3. **v0.13.4a Implementation** - Build AchievementPanel, AchievementCard, RarityBadge
4. **v0.13.4b Design Spec** - Create detailed design for Statistics Dashboard
5. **v0.13.4b Implementation** - Build StatisticsDashboard, CategoryTabs, StatComparisonView
6. **v0.13.4c Design Spec** - Create detailed design for Leaderboard View
7. **v0.13.4c Implementation** - Build LeaderboardView, ScoreBreakdownPanel
8. **v0.13.4d Design Spec** - Create detailed design for Dice History Panel
9. **v0.13.4d Implementation** - Build DiceHistoryPanel, StreakIndicator, RollDistributionChart

---

*This scope breakdown provides a structured approach to implementing v0.13.4 Achievements & Statistics UI. Each sub-part builds incrementally, with v0.13.4a establishing achievement display, v0.13.4b adding statistics visualization, v0.13.4c providing leaderboard rankings, and v0.13.4d completing dice history tracking. All sub-parts integrate with existing views (MainMenuView, CharacterView) and leverage services from v0.12.x.*
