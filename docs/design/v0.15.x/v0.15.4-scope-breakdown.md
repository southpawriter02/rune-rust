## v0.15.4 - System Bypass Skill Expansion

**Focus:** Lockpicking, terminal hacking, trap disarmament, jury-rigging, and glitch exploitation

**Source Specification:** [system-bypass.md](../../aethelgard/design/01-core/skills/system-bypass.md)

### Overview

This version transforms System Bypass from simple checks into a comprehensive "cargo cult" technology manipulation system. Characters interact with incomprehensible Old World technology through pattern recognition, physical manipulation, and learned rituals—never true understanding.

---

### Deliverables Summary

| Category | Items | Estimated Tests |
|----------|-------|-----------------|
| Enums | 6 | 6 |
| Value Objects | 8 | 12 |
| Entities | 4 | 8 |
| Services | 5 | 4 |
| **Total** | **23** | **~30** |

---

### v0.15.4a - Lockpicking System

#### LockType Enum
```
LockType
├── ImprovisedLatch (DC 6)
├── SimpleLock (DC 10)
├── StandardLock (DC 14)
├── ComplexLock (DC 18)
├── MasterLock (DC 22)
├── JotunForged (DC 26)
```

#### LockContext Value Object
- [ ] `LockType` - Classification
- [ ] `CorruptionLevel` - Normal, [Glitched], [Blighted]
- [ ] `ToolQuality` - Bare hands, improvised, proper, masterwork
- [ ] `PreviousAttempts` - Number of failed attempts
- [ ] `IsJammed` - From previous fumble

**Corruption Modifiers:**
| Corruption | DC Modifier |
|------------|-------------|
| [Glitched] | +2 DC |
| [Blighted] | +4 DC |

**Tool Modifiers:**
| Tool | Modifier |
|------|----------|
| Bare Hands | -2d10 |
| Improvised Tools | +0 |
| Proper Lockpicks | +1d10 |
| Masterwork Tools | +2d10 |

**Tool Requirements:**
- [ ] DC 4+ requires [Tinker's Toolkit]
- [ ] Cannot attempt DC 4+ bare-handed

**Degrees of Success:**
- [ ] Success: Lock opens
- [ ] Critical Success: Lock opens + salvage component
- [ ] Failure: Lock remains locked, may retry
- [ ] Fumble: [Mechanism Jammed] - DC +2 permanent, key useless

**Salvageable Components:**
| Lock Type | Component |
|-----------|-----------|
| Mechanical | [High-Tension Spring], [Pin Set] |
| Electronic | [Circuit Fragment], [Power Cell] |
| Complex | [Encryption Chip], [Biometric Sensor] |

**Unit Tests (~4):**
- [ ] Lock type sets correct DC
- [ ] Tool modifier applies correctly
- [ ] Critical success yields component
- [ ] Fumble triggers [Mechanism Jammed]

---

### v0.15.4b - Terminal Hacking System (Multi-Layer) ✅ COMPLETE

#### TerminalType Enum ✅
```
TerminalType
├── CivilianDataPort (DC 8, no ICE)
├── CorporateMainframe (DC 12, Passive ICE)
├── SecurityHub (DC 16, Active ICE)
├── MilitaryServer (DC 20, Active ICE)
├── JotunArchive (DC 24, Lethal ICE)
├── GlitchedManifold (DC varies, unpredictable)
```

#### TerminalInfiltrationState Entity ✅
```
TerminalInfiltrationState
├── InfiltrationId: string
├── CharacterId: string
├── TerminalType: TerminalType
├── CurrentLayer: int (1-3)
├── LayerResults: List<LayerResult>
├── IceEncounters: List<IceEncounter>
├── AccessLevel: AccessLevel enum
├── AlertLevel: int
├── IsLockedOut: bool
└── Status: InfiltrationStatus enum
```

#### InfiltrationLayer Enum ✅
```
InfiltrationLayer
├── Layer1_Access - Initial connection, bypass security
├── Layer2_Authentication - Identity verification
├── Layer3_Navigation - Data location and access
```

#### AccessLevel Enum ✅
```
AccessLevel
├── None - Access denied
├── UserLevel - Basic functions
├── AdminLevel - All functions, hidden files
├── Lockout - Terminal disabled
```

**Layer DCs:**

| Terminal Type | Layer 1 DC | Time |
|---------------|------------|------|
| Basic | 12 | 1 round |
| Secured | 14 | 2 rounds |
| Encrypted | 16 | 3 rounds |
| Jötun-Archive | 18 | 5 rounds |

| Security Level | Layer 2 DC Modifier |
|----------------|---------------------|
| Password only | +0 |
| Biometric | +2 |
| Multi-factor | +4 |
| Jötun-Locked | +6 |

| Data Type | Layer 3 DC |
|-----------|------------|
| Public records | 10 |
| Internal docs | 14 |
| Classified | 18 |
| Archived/Hidden | 22 |

**Infiltration Logic:**
- [x] Layer 1 failure: 1 minute lockout, retry at DC +2
- [x] Layer 2 failure: Alert triggers, ICE may activate
- [x] Layer 3 failure: Partial access only
- [x] Critical success: Gain [Admin-Level]
- [x] Fumble: [System Lockout] - terminal disabled, alert broadcast

**Covering Tracks:**
- [x] Optional DC 14 stealth check
- [x] Success: Access logs wiped
- [x] Failure: Access logged permanently

**Unit Tests (~4):** ✅ 18 tests implemented
- [x] Terminal type sets correct layer DCs
- [x] Layer failure applies lockout
- [x] Layer 2 failure triggers ICE check
- [x] Fumble causes permanent lockout

---

### v0.15.4c - ICE Countermeasures ✅ COMPLETE

#### IceType Enum ✅
```
IceType
├── Passive (Trace) - Reveal hacker location
├── Active (Attack) - Force disconnect
├── Lethal (Neural) - Psychic damage
```

#### IceEncounter Value Object ✅
- [x] `IceType` - Classification
- [x] `IceRating` - Difficulty (12-24)
- [x] `Triggered` - Has it activated
- [x] `EncounterResult` - Win/Lose/Evade

#### IceResolutionResult Value Object ✅
- [x] `Outcome` - Resolution outcome
- [x] `PsychicDamage` - Damage from Lethal ICE
- [x] `StressGained` - Stress from Lethal ICE
- [x] `LockoutDuration` - Lockout duration in minutes
- [x] `AlertLevelChange` - Change to alert level
- [x] `BonusDiceGranted` - Bonus from defeating Active ICE

**ICE Ratings by Terminal:**
| Terminal Security | ICE Rating | ICE Type |
|-------------------|------------|----------|
| Basic | — | No ICE |
| Secured | 12 | Passive (Trace) |
| Encrypted | 16 | Active (Attack) |
| Military | 20 | Active + Lethal |
| Jötun-Archive | 24 | Lethal (Neural) |

**ICE Resolution:**
- [x] Passive (Trace): Contested Bypass vs. ICE Rating
  - Win: Evade detection
  - Lose: Physical location revealed
- [x] Active (Attack): Contested Bypass vs. ICE Rating
  - Win: ICE disabled, +1d10 bonus
  - Lose: Forced disconnect, 1 min lockout
- [x] Lethal (Neural): WILL save DC 16
  - Success: Auto-disconnect, 1d6 stress, 1 min lockout
  - Failure: 3d10 psychic damage + 2d6 stress, permanent lockout

**Unit Tests (~3):** ✅ 27+ tests implemented
- [x] ICE triggers on Layer 2 failure
- [x] Contested check resolves correctly
- [x] Lethal ICE applies damage/stress

---

### v0.15.4d - Trap Disarmament System ✅ COMPLETE

#### TrapType Enum ✅
```
TrapType
├── Tripwire (DC 8, triggers alarm)
├── PressurePlate (DC 12, 2d10 damage)
├── Electrified (DC 16, 3d10 lightning)
├── LaserGrid (DC 20, alarm + lockdown)
├── JotunDefense (DC 24, 5d10 + alert)
```

#### TrapDisarmState Entity ✅
```
TrapDisarmState
├── DisarmId: string
├── CharacterId: string
├── TrapType: TrapType
├── CurrentStep: DisarmStep enum
├── AnalysisComplete: bool
├── RevealedInfo: TrapAnalysisInfo
├── FailedAttempts: int
├── Status: DisarmStatus enum
├── SalvagedComponents: IReadOnlyList<string>
```

#### DisarmStep Enum ✅
```
DisarmStep
├── Detection - Finding the trap
├── Analysis - Understanding the trap
├── Disarmament - Neutralizing the trap
```

#### DisarmStatus Enum ✅
```
DisarmStatus
├── Undetected - Not yet found
├── Detected - Found, can analyze/disarm
├── Analyzed - Analysis complete
├── DisarmInProgress - Disarming (may have failed)
├── Disarmed - Successfully neutralized
├── Triggered - Detection failed, trap fired
├── Destroyed - Fumble, trap fired and destroyed
```

#### TrapAnalysisInfo Value Object ✅
- [x] `DisarmDcRevealed` - Whether DC was revealed
- [x] `DisarmDc` - Revealed DC value
- [x] `ConsequencesRevealed` - Whether consequences shown
- [x] `ConsequenceDescription` - Consequence text
- [x] `HintRevealed` - Whether hints shown
- [x] `HintDescription` - Hint text
- [x] `GrantsHintBonus` - +1d10 on disarmament

#### DisarmResult Value Object ✅
- [x] Factory methods for all outcomes
- [x] Damage and damage type tracking
- [x] Alert and lockdown flags
- [x] Salvage component tracking
- [x] Narrative descriptions

**Three-Step Procedure:** ✅

1. **Detection (Required):** ✅
   - [x] Perception check to find trap
   - [x] DC varies by trap sophistication
   - [x] Failure = walk into trap

2. **Analysis (Optional):** ✅
   | Information | Analysis DC |
   |-------------|-------------|
   | Disarm DC | Base DC - 2 |
   | Failure consequences | Base DC |
   | Disarm hints | Base DC + 2 |

3. **Disarmament:** ✅
   - [x] Higher of WITS or FINESSE
   - [x] Success: Trap disabled
   - [x] Critical: Disabled + salvage components
   - [x] Failure: DC +1 for next attempt
   - [x] Fumble: [Forced Execution] - trap triggers

**Salvageable Components:** ✅
| Trap Type | Components |
|-----------|------------|
| Tripwire | Wire, Bell, Tension Spring |
| Pressure Plate | Metal Plate, Calibration Gear |
| Electrified | Copper Wire, Capacitor, Power Cell |
| Laser Grid | Emitter Housing, Sensor Array, Focusing Crystal |
| Jötun Defense | Strange Alloy, Resonance Coil, Jötun Fragment, Jötun Core |

**Tool Requirement:** ✅
- [x] DC 4+ traps require [Tinker's Toolkit]
- [x] DC < 4 can attempt bare-handed at -2d10

**Unit Tests (~4):** ✅ 30+ tests implemented
- [x] Trap type sets correct DC
- [x] Analysis reveals correct information
- [x] Failure increases DC
- [x] Fumble triggers trap on disarmer

---

### v0.15.4e - Jury-Rigging System ✅ COMPLETE

#### BypassMethod Enum ✅
```
BypassMethod
├── PercussiveMaintenance (+0, may break)
├── WireManipulation (-2 DC, electrocution risk)
├── GlitchExploitation (-4 DC, unpredictable)
├── MemorizedSequence (-2 DC, familiar types only)
├── BruteDisassembly (+2 DC, destroys mechanism)
├── PowerCycling (+0, resets progress)
```

#### JuryRigContext Value Object ✅
- [x] `MethodUsed` - Bypass approach
- [x] `FamiliarMechanism` - Has character seen this before
- [x] `ToolsAvailable` - Quality of tools
- [x] `ElectrocutionRisk` - For wire manipulation
- [x] `ComplicationRoll` - d10 for failure effects

**Trial-and-Error Procedure:** ✅
| Step | Action | Check | Outcome |
|------|--------|-------|---------|
| 1. Observe | Study visually | WITS DC 10 | Identify inputs |
| 2. Probe | Try buttons/levers | Auto | Machine reacts |
| 3. Pattern | Recognize type | WITS DC 12 | +2d10 if familiar |
| 4. Experiment | Try combinations | Bypass DC | Success or complication |
| 5. Iterate | Learn from failure | Auto | DC -1 next attempt |

**Complication Table (on failure):** ✅
| d10 | Effect |
|-----|--------|
| 1 | Machine locks permanently |
| 2-3 | Alarm triggers |
| 4-5 | Sparks fly (1d6 damage) |
| 6-7 | Nothing, try again |
| 8-9 | Partial success (one function works) |
| 10 | Machine glitches in your favor |

**Electrocution Risk (Wire Manipulation):** ✅
- [x] FINESSE save DC 12
- [x] Failure: 2d10 lightning damage
- [x] Success: Proceed with bypass at -2 DC

**Unit Tests (~3):** ✅ 65 tests implemented
- [x] Method applies correct modifier
- [x] Familiar mechanism grants bonus
- [x] Complication table resolves correctly

---

### v0.15.4f - Glitch Exploitation ✅ COMPLETE

#### GlitchCyclePhase Enum ✅
```
GlitchCyclePhase
├── Stable (+0 DC, normal glitched behavior)
├── Unstable (+0 DC, erratic intensifies)
├── Permissive (-4 DC, EXPLOIT WINDOW!)
├── Lockdown (+2 DC, system compensates)
```

#### ChaosEffect Enum ✅
```
ChaosEffect
├── Against (d6 1-2, +4 DC)
├── Neutral (d6 3-4, +0 DC)
├── Helps (d6 5-6, -2 DC)
```

#### GlitchState Value Object ✅
- [x] `GlitchCycleIdentified` - Did character observe pattern
- [x] `CyclePhase` - Where in the cycle
- [x] `ExploitWindow` - When to act
- [x] `ChaosRoll` - d6 for unpredictable behavior
- [x] `PhaseDuration` - Duration of current phase in rounds
- [x] `RoundsInCurrentPhase` - Rounds elapsed in current phase

#### ChaosResult Value Object ✅
- [x] `Roll` - d6 roll result (1-6)
- [x] `Effect` - ChaosEffect enum value
- [x] `DcModifier` - Applied DC modifier
- [x] `NarrativeText` - Flavor text

#### GlitchObservationResult Value Object ✅
- [x] `Success` - Whether observation succeeded
- [x] `NetSuccesses` - Net successes from WITS check
- [x] `GlitchState` - Resulting state
- [x] `NarrativeText` - Descriptive text

**Glitch Exploitation Logic:** ✅
1. Observe glitch pattern: WITS DC 14
2. If success: Can time action for -4 DC
3. If failure: Random chaos

**Glitch Cycle Phases:** ✅
| Phase | DC Modifier | Duration |
|-------|-------------|----------|
| Stable | +0 | 1d4+1 rounds |
| Unstable | +0 | 1d4+1 rounds |
| Permissive | -4 | 1d4 rounds (shorter!) |
| Lockdown | +2 | 1d4+1 rounds |

**Chaos Roll (unpredictable glitch):** ✅
| d6 | Effect |
|----|--------|
| 1-2 | Glitch works against you, +4 DC |
| 3-4 | Normal difficulty |
| 5-6 | Glitch helps, -2 DC |

**Unit Tests (~2):** ✅ 40+ tests implemented
- [x] Pattern identification reduces DC
- [x] Chaos roll applies correct modifier
- [x] Exploit window detection
- [x] Phase advancement cycles correctly

---

### v0.15.4g - Improvised Tool Crafting ✅ COMPLETE

#### ImprovisedTool Value Object ✅
- [x] `ToolId` - Identifier
- [x] `ToolName` - Display name
- [x] `ComponentsRequired` - What's needed
- [x] `CraftDc` - Difficulty to make
- [x] `BonusWhenUsed` - Modifier granted

**Craftable Tools:**
| Tool | Components | Craft DC | Bonus |
|------|------------|----------|-------|
| Shim Picks | Scrap metal × 3 | 10 | +1d10 to locks |
| Wire Probe | Copper wire × 2, handle | 12 | +1d10 to terminals |
| Glitch Trigger | Capacitor × 1, wire × 4 | 14 | Force glitch state |
| Bypass Clamps | Metal clips × 4 | 12 | Skip one layer |

**Unit Tests (~2):** ✅ 35+ tests implemented
- [x] Tool crafting succeeds with components
- [x] Crafted tool provides correct bonus

---

### v0.15.4h - Alternative Bypass Methods ✅ COMPLETE

#### BruteForceOption Value Object ✅
**Purpose:** When lockpicking unavailable

| Target | MIGHT DC | Consequences |
|--------|----------|--------------|
| Simple Door | 12 | Loud (alerts nearby) |
| Reinforced Door | 16 | Very loud, may damage contents |
| Vault | 22 | Multiple attempts, exhausting |
| Container | 10-16 | Contents may be damaged |

**Alternative Methods:**
| Obstacle | Alternatives |
|----------|--------------|
| Locked Door | Find key, brute force, runic bypass, alternate route |
| Secured Terminal | Find codes, hotwire to different terminal, accept partial |
| Active Trap | Trigger from distance, destroy mechanism, sacrifice |

**Unit Tests (~2):** ✅ 2 tests implemented
- [x] Brute force applies correct DC
- [x] Brute force consequences apply

---

### v0.15.4i - Specialization Integration ✅ COMPLETE

#### Scrap-Tinker Abilities ✅
- [x] `[Master Craftsman]` - Craft [Masterwork Tools] from rare components
- [x] `[Relock]` - Can re-lock bypassed lock to slow pursuit

#### Ruin-Stalker Abilities ✅
- [x] `[Trap Artist]` - Re-arm disabled traps as party defenses
- [x] `[Sixth Sense]` - Auto-detect traps within 10 feet

#### Jötun-Reader Abilities ✅
- [x] `[Deep Access]` - Automatically gain [Admin-Level] on success
- [x] `[Pattern Recognition]` - Reduce [Glitched] DC penalty by 2

#### Gantry-Runner Abilities ✅
- [x] `[Fast Pick]` - Reduced time on bypass
- [x] `[Bypass Under Fire]` - No penalty when in danger

**Unit Tests (~2):** ✅ 19 tests implemented
- [x] Jötun-Reader gains Admin on success
- [x] Ruin-Stalker auto-detects nearby traps

---

### Configuration Files

| File | Purpose |
|------|---------|
| `lock-types.json` | Lock classification and DCs |
| `terminal-types.json` | Terminal types and ICE ratings |
| `trap-types.json` | Trap definitions and consequences |
| `bypass-methods.json` | Jury-rigging approaches |
| `improvised-tools.json` | Craftable tool recipes |
| `system-bypass-descriptors.json` | Voice guidance text |

---

### Dependencies

**Requires:**
- v0.15.0: Dice pool refactor (success-counting, fumble/critical detection)
- v0.15.1: Skill infrastructure (SkillContext, SkillOutcome, FumbleConsequence)
- v0.10.x: Status effects
- Crafting system: Component usage

**Provides to:**
- Dungeon exploration mechanics
- Security system interactions
- Resource recovery

---

### Acceptance Criteria

- [ ] Lockpicking uses tool modifiers correctly
- [ ] Lock fumble creates [Mechanism Jammed]
- [x] Terminal hacking progresses through layers *(v0.15.4b)*
- [x] ICE encounters resolve correctly *(v0.15.4c)*
- [x] Trap disarmament follows three-step process *(v0.15.4d)*
- [x] Trap fumble triggers on disarmer *(v0.15.4d)*
- [x] Jury-rigging methods apply modifiers *(v0.15.4e)*
- [x] Complication table resolves on failure *(v0.15.4e)*
- [x] Glitch exploitation timing works *(v0.15.4f)*
- [x] Tool crafting produces usable items *(v0.15.4g)*
- [x] Specialization abilities function *(v0.15.4i)*
- [x] ~30 unit tests pass (236+ tests implemented: 18 in v0.15.4b, 27+ in v0.15.4c, 30+ in v0.15.4d, 65 in v0.15.4e, 40+ in v0.15.4f, 35+ in v0.15.4g, 2 in v0.15.4h, 19 in v0.15.4i)
