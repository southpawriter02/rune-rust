# v0.18.4c Changelog — Coherence System (Arcanist)

**Release Date**: 2026-02-02

## Summary

Implements the domain layer foundation for the Coherence System, the arcane resource for Arcanist specialization characters. Coherence functions as a reality-stability meter with five tiers (Destabilized → Apotheosis), providing spell power bonuses, critical cast chance, and cascade risk mechanics.

---

## Added

### Domain Layer — Enums

| File                    | Description                                                                    |
| ----------------------- | ------------------------------------------------------------------------------ |
| `CoherenceThreshold.cs` | 5-tier enum: Destabilized, Unstable, Balanced, Focused, Apotheosis             |
| `CoherenceSource.cs`    | 4 sources: SuccessfulCast, ControlledChannel, MeditationAction, StabilityField |

### Domain Layer — Entity

| File                | Description                                                                                                                                   |
| ------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `CoherenceState.cs` | Core entity with threshold computation, spell power bonus (-2 to +5), critical cast chance (0-20%), cascade risk (0-25%), apotheosis tracking |

### Domain Layer — Value Objects

| File                  | Description                                                                        |
| --------------------- | ---------------------------------------------------------------------------------- |
| `CascadeResult.cs`    | Record for cascade events with damage, stress, corruption, and disruption tracking |
| `ApotheosisResult.cs` | Record for apotheosis state transitions with ability unlocks and exit tracking     |

### Unit Tests

| File                     | Tests                                                                                                                                                       |
| ------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `CoherenceStateTests.cs` | 72 tests covering factory method, threshold boundaries, spell power, crit chance, cascade risk, apotheosis, meditation, edge cases, constants, and ToString |

---

## Verification

| Check                                 | Status   |
| ------------------------------------- | -------- |
| Build succeeds (0 errors, 0 warnings) | ✅       |
| CoherenceState tests pass             | ✅ 72/72 |
| Full test suite                       | ✅       |

---

## Files Added

```
src/Core/RuneAndRust.Domain/Enums/
├── CoherenceThreshold.cs
└── CoherenceSource.cs

src/Core/RuneAndRust.Domain/Entities/
└── CoherenceState.cs

src/Core/RuneAndRust.Domain/ValueObjects/
├── CascadeResult.cs
└── ApotheosisResult.cs

tests/RuneAndRust.Domain.UnitTests/Entities/
└── CoherenceStateTests.cs
```

---

## Next Steps (v0.18.4d)

- Define `ICoherenceService` interface in Application layer
- Implement coherence gain/drain methods
- Add cascade check logic
