# v0.7.1c Design Specification: Message Log Panel

**Version:** 0.7.1c
**Parent:** v0.7.1 (Core Display Panels)
**Prerequisites:** v0.7.1b Complete (Player Status Panel)
**Status:** Design Complete
**Estimated Unit Tests:** ~8

---

## Table of Contents

1. [Overview](#1-overview)
2. [Feature Overview](#2-feature-overview)
3. [Architecture](#3-architecture)
4. [Message Log Panel](#4-message-log-panel)
5. [Message Log ViewModel](#5-message-log-viewmodel)
6. [Game Message Model](#6-game-message-model)
7. [Message Types and Colors](#7-message-types-and-colors)
8. [Value Converters](#8-value-converters)
9. [Styles](#9-styles)
10. [Data Model Changes](#10-data-model-changes)
11. [Logging Specifications](#11-logging-specifications)
12. [Unit Testing Requirements](#12-unit-testing-requirements)
13. [Use Cases](#13-use-cases)
14. [Deliverable Checklist](#14-deliverable-checklist)
15. [Acceptance Criteria](#15-acceptance-criteria)
16. [Dependencies](#16-dependencies)
17. [Future Considerations](#17-future-considerations)

---

## 1. Overview

### Purpose

This phase implements the message log panel that displays a scrollable history of game messages with timestamps and color coding. The log auto-scrolls to show new messages but allows manual scrolling to review history. This panel occupies the BottomContent region of the GameWindow.

### Key Deliverables

| Category | Items |
|----------|-------|
| **User Controls** | `MessageLogPanel` |
| **ViewModels** | `MessageLogViewModel` |
| **Models** | `GameMessage` |
| **Enums** | `MessageType`, `MessageCategory` |
| **Converters** | `MessageTypeToColorConverter` |
| **Styles** | `MessageLogStyles.axaml` |
| **Tests** | ~8 unit tests |

### Design Principles

1. **Chronological History**: Messages displayed in order with timestamps
2. **Color-Coded Context**: Different message types have distinct colors
3. **Smart Scrolling**: Auto-scroll with manual override capability
4. **Performance**: Message limit prevents memory bloat

---

## 2. Feature Overview

```
v0.7.1c Features
â”œâ”€â”€ Message Log Panel (UserControl)
â”‚   â”œâ”€â”€ Scrollable message list
â”‚   â”œâ”€â”€ Timestamp display
â”‚   â”œâ”€â”€ Color-coded messages
â”‚   â”œâ”€â”€ Auto-scroll toggle button
â”‚   â””â”€â”€ Clear log button
â”œâ”€â”€ Message Log ViewModel
â”‚   â”œâ”€â”€ Messages collection
â”‚   â”œâ”€â”€ AutoScrollEnabled property
â”‚   â”œâ”€â”€ Filter toggles (Combat, Loot, System)
â”‚   â”œâ”€â”€ ClearLogCommand
â”‚   â”œâ”€â”€ ToggleAutoScrollCommand
â”‚   â””â”€â”€ Max message limit (500)
â”œâ”€â”€ Game Message Model
â”‚   â”œâ”€â”€ Timestamp property
â”‚   â”œâ”€â”€ Text property
â”‚   â”œâ”€â”€ MessageType property
â”‚   â”œâ”€â”€ MessageCategory property
â”‚   â””â”€â”€ Factory methods
â””â”€â”€ Value Converters
    â””â”€â”€ MessageTypeToColorConverter
```

---

## 3. Architecture

### Component Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       PRESENTATION LAYER                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  VIEWS                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      MessageLogPanel                               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ - Header with auto-scroll toggle                                  â”‚ â”‚
â”‚  â”‚ - ScrollViewer with message list                                  â”‚ â”‚
â”‚  â”‚ - Message ItemsControl                                            â”‚ â”‚
â”‚  â”‚ - Clear button                                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                   â”‚ DataContext                        â”‚
â”‚                                   â–¼                                    â”‚
â”‚  VIEWMODELS                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   MessageLogViewModel                              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ + Messages: ObservableCollection<GameMessage>                     â”‚ â”‚
â”‚  â”‚ + AutoScrollEnabled: bool                                         â”‚ â”‚
â”‚  â”‚ + ShowCombatMessages: bool                                        â”‚ â”‚
â”‚  â”‚ + ShowLootMessages: bool                                          â”‚ â”‚
â”‚  â”‚ + ShowSystemMessages: bool                                        â”‚ â”‚
â”‚  â”‚ + ClearLogCommand                                                 â”‚ â”‚
â”‚  â”‚ + ToggleAutoScrollCommand                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  MODELS                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        GameMessage                                 â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ + Timestamp: DateTime                                             â”‚ â”‚
â”‚  â”‚ + Text: string                                                    â”‚ â”‚
â”‚  â”‚ + Type: MessageType                                               â”‚ â”‚
â”‚  â”‚ + Category: MessageCategory                                       â”‚ â”‚
â”‚  â”‚ + FormattedTime: string (computed)                                â”‚ â”‚
â”‚  â”‚ + static Info(text): GameMessage                                  â”‚ â”‚
â”‚  â”‚ + static Combat(text, type): GameMessage                          â”‚ â”‚
â”‚  â”‚ + static Loot(text, type): GameMessage                            â”‚ â”‚
â”‚  â”‚ + static System(text): GameMessage                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  ENUMS                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      MessageType            â”‚  â”‚     MessageCategory             â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Default                     â”‚  â”‚ General                         â”‚ â”‚
â”‚  â”‚ Info, Warning, Error        â”‚  â”‚ Combat                          â”‚ â”‚
â”‚  â”‚ CombatHit, CombatMiss       â”‚  â”‚ Loot                            â”‚ â”‚
â”‚  â”‚ CombatHeal, CombatCritical  â”‚  â”‚ Dialogue                        â”‚ â”‚
â”‚  â”‚ LootCommon through Legendaryâ”‚  â”‚ System                          â”‚ â”‚
â”‚  â”‚ Dialogue, Success, Failure  â”‚  â”‚                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         APPLICATION LAYER                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                      IGameSessionService                           â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ + OnMessage: event Action<string, MessageType>                     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MESSAGE FLOW                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Game action occurs (attack, pickup, dialogue, etc.)
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            GameSessionService.OnMessage(text, type)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Raises event with message text and type                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          MessageLogViewModel.HandleNewMessage(text, type)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Create GameMessage with timestamp                                  â”‚
â”‚  2. Add to Messages collection                                         â”‚
â”‚  3. Trim if over MaxMessages limit                                     â”‚
â”‚  4. Trigger scroll if AutoScrollEnabled                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   MessageLogPanel (UI Updates)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - New message appears with timestamp and color                        â”‚
â”‚  - ScrollViewer scrolls to bottom if auto-scroll enabled               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Message Log Panel

### Panel Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MESSAGE LOG                                            [â–¼ Auto-scroll] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  [12:30:15] You wake up in a small village.                             â”‚
â”‚  [12:30:18] You see a sword shop to the north.                          â”‚
â”‚  [12:31:02] You enter the sword shop.                                   â”‚
â”‚  [12:31:05] The shopkeeper greets you warmly.                           â”‚
â”‚  [12:32:15] You purchased: Iron Sword (50 gold)                         â”‚
â”‚  [12:33:00] You leave the shop and head east.                           â”‚
â”‚  [12:34:22] You enter the dark cave.                                    â”‚
â”‚  [12:34:25] A skeleton blocks your path!                                â”‚
â”‚  [12:34:30] â•â•â•â•â•â• COMBAT BEGINS â•â•â•â•â•â•                                 â”‚
â”‚  [12:34:35] You attack the Skeleton with Iron Sword!                    â”‚
â”‚  [12:34:35] Hit! 12 damage to Skeleton.                                 â”‚
â”‚  [12:34:40] Skeleton attacks you!                                       â”‚
â”‚  [12:34:40] Miss! The skeleton's attack misses.                         â”‚
â”‚  [12:34:45] You attack the Skeleton with Iron Sword!                    â”‚
â”‚  [12:34:45] Critical Hit! 24 damage to Skeleton.                        â”‚
â”‚  [12:34:50] Skeleton defeated! +50 XP                                   â”‚
â”‚  [12:34:55] â•â•â•â•â•â• COMBAT ENDS â•â•â•â•â•â•                                   â”‚
â”‚  [12:35:00] You found: Rusty Key                                        â”‚
â”‚  [12:35:05] The key might unlock something nearby.                      â”‚
â”‚                                                                    â–¼    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Clear Log]                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### XAML Implementation

**File:** `src/Presentation/RuneAndRust.Avalonia/Controls/MessageLogPanel.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:RuneAndRust.Avalonia.ViewModels"
             xmlns:models="using:RuneAndRust.Avalonia.Models"
             xmlns:conv="using:RuneAndRust.Avalonia.Converters"
             x:Class="RuneAndRust.Avalonia.Controls.MessageLogPanel"
             x:DataType="vm:MessageLogViewModel">
    
    <UserControl.Resources>
        <conv:MessageTypeToColorConverter x:Key="MessageTypeToColor" />
    </UserControl.Resources>
    
    <Design.DataContext>
        <vm:MessageLogViewModel />
    </Design.DataContext>
    
    <Grid RowDefinitions="Auto,*,Auto">
        
        <!-- Header -->
        <Border Grid.Row="0" Classes="panel-header" Padding="12,8">
            <Grid ColumnDefinitions="*,Auto">
                <TextBlock Text="MESSAGE LOG"
                           Classes="secondary"
                           FontWeight="SemiBold"
                           VerticalAlignment="Center" />
                
                <ToggleButton Grid.Column="1"
                              IsChecked="{Binding AutoScrollEnabled}"
                              Command="{Binding ToggleAutoScrollCommand}"
                              Classes="auto-scroll-toggle"
                              ToolTip.Tip="Toggle auto-scroll">
                    <StackPanel Orientation="Horizontal" Spacing="4">
                        <TextBlock Text="â–¼" />
                        <TextBlock Text="Auto-scroll" />
                    </StackPanel>
                </ToggleButton>
            </Grid>
        </Border>
        
        <!-- Message List -->
        <ScrollViewer Grid.Row="1"
                      Name="MessageScrollViewer"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled">
            <ItemsControl ItemsSource="{Binding Messages}"
                          Margin="8,4">
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="models:GameMessage">
                        <Grid ColumnDefinitions="70,*" Margin="0,2">
                            <!-- Timestamp -->
                            <TextBlock Grid.Column="0"
                                       Text="{Binding FormattedTime, StringFormat='[{0}]'}"
                                       Classes="timestamp"
                                       Foreground="{StaticResource TextMutedBrush}" />
                            
                            <!-- Message Text -->
                            <TextBlock Grid.Column="1"
                                       Text="{Binding Text}"
                                       TextWrapping="Wrap"
                                       Foreground="{Binding Type, Converter={StaticResource MessageTypeToColor}}" />
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
        
        <!-- Footer -->
        <Border Grid.Row="2" Classes="panel-footer" Padding="8">
            <StackPanel Orientation="Horizontal" Spacing="8">
                <Button Content="Clear Log"
                        Command="{Binding ClearLogCommand}"
                        Classes="small-button" />
                
                <!-- Filter toggles (optional, compact) -->
                <ToggleButton IsChecked="{Binding ShowCombatMessages}"
                              Classes="filter-toggle"
                              ToolTip.Tip="Show combat messages">
                    <TextBlock Text="âš”" />
                </ToggleButton>
                
                <ToggleButton IsChecked="{Binding ShowLootMessages}"
                              Classes="filter-toggle"
                              ToolTip.Tip="Show loot messages">
                    <TextBlock Text="ğŸ’" />
                </ToggleButton>
                
                <ToggleButton IsChecked="{Binding ShowSystemMessages}"
                              Classes="filter-toggle"
                              ToolTip.Tip="Show system messages">
                    <TextBlock Text="â„¹" />
                </ToggleButton>
            </StackPanel>
        </Border>
        
    </Grid>
</UserControl>
```

**File:** `src/Presentation/RuneAndRust.Avalonia/Controls/MessageLogPanel.axaml.cs`

```csharp
namespace RuneAndRust.Avalonia.Controls;

using global::Avalonia.Controls;
using global::Avalonia.Threading;
using RuneAndRust.Avalonia.ViewModels;

/// <summary>
/// Panel control displaying the message log.
/// </summary>
public partial class MessageLogPanel : UserControl
{
    public MessageLogPanel()
    {
        InitializeComponent();
        
        // Subscribe to message additions for auto-scroll
        DataContextChanged += OnDataContextChanged;
    }

    private void OnDataContextChanged(object? sender, EventArgs e)
    {
        if (DataContext is MessageLogViewModel vm)
        {
            vm.Messages.CollectionChanged += OnMessagesChanged;
        }
    }

    private void OnMessagesChanged(object? sender, 
        System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
    {
        if (DataContext is MessageLogViewModel { AutoScrollEnabled: true })
        {
            Dispatcher.UIThread.Post(() =>
            {
                MessageScrollViewer?.ScrollToEnd();
            });
        }
    }
}
```

---

## 5. Message Log ViewModel

**File:** `src/Presentation/RuneAndRust.Avalonia/ViewModels/MessageLogViewModel.cs`

```csharp
namespace RuneAndRust.Avalonia.ViewModels;

using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using RuneAndRust.Application.Interfaces;
using RuneAndRust.Avalonia.Models;
using System.Collections.ObjectModel;
using System.Collections.Specialized;
using Serilog;

/// <summary>
/// View model for the message log panel.
/// </summary>
public partial class MessageLogViewModel : ViewModelBase
{
    private readonly IGameSessionService? _gameSession;
    
    /// <summary>
    /// Maximum number of messages to retain.
    /// </summary>
    public const int MaxMessages = 500;

    [ObservableProperty]
    private ObservableCollection<GameMessage> _messages = new();

    [ObservableProperty]
    private bool _autoScrollEnabled = true;

    [ObservableProperty]
    private bool _showCombatMessages = true;

    [ObservableProperty]
    private bool _showLootMessages = true;

    [ObservableProperty]
    private bool _showSystemMessages = true;

    /// <summary>
    /// Creates a new MessageLogViewModel with game session.
    /// </summary>
    public MessageLogViewModel(IGameSessionService gameSession)
    {
        _gameSession = gameSession;
        _gameSession.OnMessage += HandleNewMessage;
    }

    /// <summary>
    /// Design-time constructor with sample data.
    /// </summary>
    public MessageLogViewModel()
    {
        // Design-time sample messages
        AddSampleMessages();
    }

    /// <summary>
    /// Clears all messages from the log.
    /// </summary>
    [RelayCommand]
    private void ClearLog()
    {
        Messages.Clear();
        Log.Debug("Message log cleared");
    }

    /// <summary>
    /// Toggles auto-scroll behavior.
    /// </summary>
    [RelayCommand]
    private void ToggleAutoScroll()
    {
        AutoScrollEnabled = !AutoScrollEnabled;
        Log.Debug("Auto-scroll set to {Enabled}", AutoScrollEnabled);
    }

    /// <summary>
    /// Adds a new message to the log.
    /// </summary>
    public void AddMessage(GameMessage message)
    {
        // Check category filter
        if (!ShouldShowMessage(message))
            return;

        Messages.Add(message);

        // Trim old messages if over limit
        while (Messages.Count > MaxMessages)
        {
            Messages.RemoveAt(0);
        }
    }

    private void HandleNewMessage(string text, MessageType type)
    {
        var category = DetermineCategory(type);
        var message = new GameMessage(DateTime.Now, text, type, category);
        AddMessage(message);
    }

    private bool ShouldShowMessage(GameMessage message)
    {
        return message.Category switch
        {
            MessageCategory.Combat => ShowCombatMessages,
            MessageCategory.Loot => ShowLootMessages,
            MessageCategory.System => ShowSystemMessages,
            _ => true
        };
    }

    private static MessageCategory DetermineCategory(MessageType type)
    {
        return type switch
        {
            MessageType.CombatHit or MessageType.CombatMiss or 
            MessageType.CombatHeal or MessageType.CombatCritical => MessageCategory.Combat,
            
            MessageType.LootCommon or MessageType.LootUncommon or 
            MessageType.LootRare or MessageType.LootEpic or 
            MessageType.LootLegendary => MessageCategory.Loot,
            
            MessageType.Warning or MessageType.Error => MessageCategory.System,
            
            MessageType.Dialogue => MessageCategory.Dialogue,
            
            _ => MessageCategory.General
        };
    }

    private void AddSampleMessages()
    {
        var baseTime = DateTime.Now.AddMinutes(-5);
        
        Messages.Add(new GameMessage(baseTime.AddSeconds(0), "You wake up in a small village.", MessageType.Default));
        Messages.Add(new GameMessage(baseTime.AddSeconds(3), "You see a sword shop to the north.", MessageType.Info));
        Messages.Add(new GameMessage(baseTime.AddSeconds(47), "You enter the sword shop.", MessageType.Default));
        Messages.Add(new GameMessage(baseTime.AddSeconds(50), "The shopkeeper greets you warmly.", MessageType.Dialogue));
        Messages.Add(new GameMessage(baseTime.AddSeconds(120), "You purchased: Iron Sword (50 gold)", MessageType.LootCommon));
        Messages.Add(new GameMessage(baseTime.AddSeconds(165), "You leave the shop and head east.", MessageType.Default));
        Messages.Add(new GameMessage(baseTime.AddSeconds(247), "You enter the dark cave.", MessageType.Default));
        Messages.Add(new GameMessage(baseTime.AddSeconds(250), "A skeleton blocks your path!", MessageType.Warning));
        Messages.Add(new GameMessage(baseTime.AddSeconds(255), "â•â•â•â•â•â• COMBAT BEGINS â•â•â•â•â•â•", MessageType.Info));
        Messages.Add(new GameMessage(baseTime.AddSeconds(260), "You attack the Skeleton with Iron Sword!", MessageType.Default));
        Messages.Add(new GameMessage(baseTime.AddSeconds(260), "Hit! 12 damage to Skeleton.", MessageType.CombatHit));
        Messages.Add(new GameMessage(baseTime.AddSeconds(265), "Skeleton attacks you!", MessageType.Default));
        Messages.Add(new GameMessage(baseTime.AddSeconds(265), "Miss! The skeleton's attack misses.", MessageType.CombatMiss));
        Messages.Add(new GameMessage(baseTime.AddSeconds(270), "You attack the Skeleton with Iron Sword!", MessageType.Default));
        Messages.Add(new GameMessage(baseTime.AddSeconds(270), "Critical Hit! 24 damage to Skeleton.", MessageType.CombatCritical));
        Messages.Add(new GameMessage(baseTime.AddSeconds(275), "Skeleton defeated! +50 XP", MessageType.Success));
        Messages.Add(new GameMessage(baseTime.AddSeconds(280), "â•â•â•â•â•â• COMBAT ENDS â•â•â•â•â•â•", MessageType.Info));
        Messages.Add(new GameMessage(baseTime.AddSeconds(285), "You found: Rusty Key", MessageType.LootUncommon));
        Messages.Add(new GameMessage(baseTime.AddSeconds(290), "The key might unlock something nearby.", MessageType.Info));
    }
}
```

---

## 6. Game Message Model

**File:** `src/Presentation/RuneAndRust.Avalonia/Models/GameMessage.cs`

```csharp
namespace RuneAndRust.Avalonia.Models;

/// <summary>
/// Represents a message in the game log.
/// </summary>
public record GameMessage(
    DateTime Timestamp,
    string Text,
    MessageType Type,
    MessageCategory Category = MessageCategory.General)
{
    /// <summary>
    /// Gets the formatted timestamp string (HH:mm:ss).
    /// </summary>
    public string FormattedTime => Timestamp.ToString("HH:mm:ss");

    /// <summary>
    /// Creates an info message.
    /// </summary>
    public static GameMessage Info(string text) =>
        new(DateTime.Now, text, MessageType.Info);

    /// <summary>
    /// Creates a combat message.
    /// </summary>
    public static GameMessage Combat(string text, MessageType type = MessageType.CombatHit) =>
        new(DateTime.Now, text, type, MessageCategory.Combat);

    /// <summary>
    /// Creates a loot message.
    /// </summary>
    public static GameMessage Loot(string text, MessageType type = MessageType.LootCommon) =>
        new(DateTime.Now, text, type, MessageCategory.Loot);

    /// <summary>
    /// Creates a system message.
    /// </summary>
    public static GameMessage System(string text) =>
        new(DateTime.Now, text, MessageType.Info, MessageCategory.System);

    /// <summary>
    /// Creates a dialogue message.
    /// </summary>
    public static GameMessage Dialogue(string text) =>
        new(DateTime.Now, text, MessageType.Dialogue, MessageCategory.Dialogue);

    /// <summary>
    /// Creates a success message.
    /// </summary>
    public static GameMessage Success(string text) =>
        new(DateTime.Now, text, MessageType.Success);

    /// <summary>
    /// Creates a failure message.
    /// </summary>
    public static GameMessage Failure(string text) =>
        new(DateTime.Now, text, MessageType.Failure);
}
```

**File:** `src/Presentation/RuneAndRust.Avalonia/Models/MessageType.cs`

```csharp
namespace RuneAndRust.Avalonia.Models;

/// <summary>
/// Types of messages that determine color coding.
/// </summary>
public enum MessageType
{
    /// <summary>Default text color.</summary>
    Default,
    
    /// <summary>Informational message (cyan).</summary>
    Info,
    
    /// <summary>Warning message (yellow).</summary>
    Warning,
    
    /// <summary>Error message (red).</summary>
    Error,
    
    /// <summary>Combat hit (orange-red).</summary>
    CombatHit,
    
    /// <summary>Combat miss (gray).</summary>
    CombatMiss,
    
    /// <summary>Combat heal (lime green).</summary>
    CombatHeal,
    
    /// <summary>Combat critical hit (magenta).</summary>
    CombatCritical,
    
    /// <summary>Common loot (white).</summary>
    LootCommon,
    
    /// <summary>Uncommon loot (lime green).</summary>
    LootUncommon,
    
    /// <summary>Rare loot (royal blue).</summary>
    LootRare,
    
    /// <summary>Epic loot (purple).</summary>
    LootEpic,
    
    /// <summary>Legendary loot (gold).</summary>
    LootLegendary,
    
    /// <summary>NPC dialogue (yellow).</summary>
    Dialogue,
    
    /// <summary>Success message (lime green).</summary>
    Success,
    
    /// <summary>Failure message (orange-red).</summary>
    Failure
}
```

**File:** `src/Presentation/RuneAndRust.Avalonia/Models/MessageCategory.cs`

```csharp
namespace RuneAndRust.Avalonia.Models;

/// <summary>
/// Categories for message filtering.
/// </summary>
public enum MessageCategory
{
    /// <summary>General game messages.</summary>
    General,
    
    /// <summary>Combat-related messages.</summary>
    Combat,
    
    /// <summary>Loot and item messages.</summary>
    Loot,
    
    /// <summary>NPC dialogue messages.</summary>
    Dialogue,
    
    /// <summary>System/technical messages.</summary>
    System
}
```

---

## 7. Message Types and Colors

| Message Type | Color | Use Case |
|--------------|-------|----------|
| `Default` | White/Primary | General narrative |
| `Info` | Cyan | Hints, observations |
| `Warning` | Yellow | Alerts, enemies appearing |
| `Error` | Red | Errors, invalid actions |
| `CombatHit` | OrangeRed | Successful attacks |
| `CombatMiss` | Gray | Missed attacks |
| `CombatHeal` | LimeGreen | Healing effects |
| `CombatCritical` | Magenta | Critical hits |
| `LootCommon` | White | Common items |
| `LootUncommon` | LimeGreen | Uncommon items |
| `LootRare` | RoyalBlue | Rare items |
| `LootEpic` | Purple | Epic items |
| `LootLegendary` | Gold | Legendary items |
| `Dialogue` | Yellow | NPC speech |
| `Success` | LimeGreen | Successful actions |
| `Failure` | OrangeRed | Failed actions |

---

## 8. Value Converters

**File:** `src/Presentation/RuneAndRust.Avalonia/Converters/MessageTypeToColorConverter.cs`

```csharp
namespace RuneAndRust.Avalonia.Converters;

using global::Avalonia;
using global::Avalonia.Data.Converters;
using global::Avalonia.Media;
using RuneAndRust.Avalonia.Models;
using System.Globalization;

/// <summary>
/// Converts MessageType to appropriate color brush.
/// </summary>
public class MessageTypeToColorConverter : IValueConverter
{
    public object Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        if (value is not MessageType type)
            return GetBrush("TextPrimaryBrush", Brushes.White);

        return type switch
        {
            MessageType.Default => GetBrush("TextPrimaryBrush", Brushes.White),
            MessageType.Info => Brushes.Cyan,
            MessageType.Warning => Brushes.Yellow,
            MessageType.Error => Brushes.Red,
            MessageType.CombatHit => Brushes.OrangeRed,
            MessageType.CombatMiss => Brushes.Gray,
            MessageType.CombatHeal => Brushes.LimeGreen,
            MessageType.CombatCritical => Brushes.Magenta,
            MessageType.LootCommon => GetBrush("TextPrimaryBrush", Brushes.White),
            MessageType.LootUncommon => Brushes.LimeGreen,
            MessageType.LootRare => Brushes.RoyalBlue,
            MessageType.LootEpic => Brushes.Purple,
            MessageType.LootLegendary => Brushes.Gold,
            MessageType.Dialogue => Brushes.Yellow,
            MessageType.Success => Brushes.LimeGreen,
            MessageType.Failure => Brushes.OrangeRed,
            _ => GetBrush("TextPrimaryBrush", Brushes.White)
        };
    }

    public object ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
        => throw new NotImplementedException();

    private static IBrush GetBrush(string resourceKey, IBrush fallback)
    {
        return Application.Current?.FindResource(resourceKey) as IBrush ?? fallback;
    }
}
```

---

## 9. Styles

**File:** `src/Presentation/RuneAndRust.Avalonia/Styles/MessageLogStyles.axaml`

```xml
<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    
    <!-- Timestamp Style -->
    <Style Selector="TextBlock.timestamp">
        <Setter Property="FontFamily" Value="Consolas, Courier New, monospace" />
        <Setter Property="FontSize" Value="{StaticResource FontSizeSmall}" />
        <Setter Property="Foreground" Value="{StaticResource TextMutedBrush}" />
    </Style>
    
    <!-- Auto-scroll Toggle -->
    <Style Selector="ToggleButton.auto-scroll-toggle">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}" />
        <Setter Property="Padding" Value="8,4" />
        <Setter Property="CornerRadius" Value="4" />
    </Style>
    
    <Style Selector="ToggleButton.auto-scroll-toggle:checked">
        <Setter Property="Background" Value="{StaticResource PrimaryBrush}" />
        <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}" />
    </Style>
    
    <!-- Filter Toggle -->
    <Style Selector="ToggleButton.filter-toggle">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="{StaticResource TextMutedBrush}" />
        <Setter Property="Padding" Value="6,4" />
        <Setter Property="MinWidth" Value="28" />
        <Setter Property="CornerRadius" Value="4" />
    </Style>
    
    <Style Selector="ToggleButton.filter-toggle:checked">
        <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}" />
    </Style>
    
    <Style Selector="ToggleButton.filter-toggle:not(:checked)">
        <Setter Property="Opacity" Value="0.5" />
    </Style>
    
    <!-- Small Button -->
    <Style Selector="Button.small-button">
        <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
        <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}" />
        <Setter Property="Padding" Value="8,4" />
        <Setter Property="FontSize" Value="{StaticResource FontSizeSmall}" />
        <Setter Property="CornerRadius" Value="4" />
    </Style>
    
    <Style Selector="Button.small-button:pointerover">
        <Setter Property="Background" Value="{StaticResource SurfaceLightBrush}" />
    </Style>
    
    <!-- Panel Header -->
    <Style Selector="Border.panel-header">
        <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
        <Setter Property="BorderThickness" Value="0,0,0,1" />
    </Style>
    
    <!-- Panel Footer -->
    <Style Selector="Border.panel-footer">
        <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
        <Setter Property="BorderThickness" Value="0,1,0,0" />
    </Style>
    
</Styles>
```

---

## 10. Data Model Changes

### New Types

| Type | Layer | Description |
|------|-------|-------------|
| `MessageLogPanel` | Presentation | Message log UserControl |
| `MessageLogViewModel` | Presentation | Message state view model |
| `GameMessage` | Presentation | Message record |
| `MessageType` | Presentation | Message type enum |
| `MessageCategory` | Presentation | Message category enum |
| `MessageTypeToColorConverter` | Presentation | Type to color converter |

No domain or application layer changes required.

---

## 11. Logging Specifications

| Component | Level | Events |
|-----------|-------|--------|
| `MessageLogViewModel` | Debug | Log cleared, auto-scroll toggled |

---

## 12. Unit Testing Requirements

### Test Count by Feature

| Feature | Test Count |
|---------|------------|
| MessageLogViewModel | ~4 |
| GameMessage | ~2 |
| MessageTypeToColorConverter | ~2 |
| **Total** | **~8** |

### Test Specifications

**File:** `tests/RuneAndRust.Avalonia.UnitTests/ViewModels/MessageLogViewModelTests.cs`

```csharp
[TestFixture]
public class MessageLogViewModelTests
{
    [Test]
    public void AddMessage_AddsToCollection();

    [Test]
    public void AddMessage_OverLimit_RemovesOldest();

    [Test]
    public void ClearLogCommand_ClearsMessages();

    [Test]
    public void ToggleAutoScrollCommand_TogglesEnabled();
}
```

**File:** `tests/RuneAndRust.Avalonia.UnitTests/Models/GameMessageTests.cs`

```csharp
[TestFixture]
public class GameMessageTests
{
    [Test]
    public void FormattedTime_ReturnsHHmmss();

    [Test]
    public void Combat_FactoryMethod_SetsCombatCategory();
}
```

**File:** `tests/RuneAndRust.Avalonia.UnitTests/Converters/MessageTypeToColorConverterTests.cs`

```csharp
[TestFixture]
public class MessageTypeToColorConverterTests
{
    [Test]
    public void Convert_CombatCritical_ReturnsMagenta();

    [Test]
    public void Convert_LootLegendary_ReturnsGold();
}
```

---

## 13. Use Cases

### UC-071c-001: View Message History
**Actor:** Player
**Flow:** Game events occur â†’ Messages appear in log with timestamps

### UC-071c-002: Auto-Scroll Messages
**Actor:** Player
**Flow:** New message arrives â†’ Log scrolls to bottom automatically

### UC-071c-003: Review History
**Actor:** Player
**Flow:** Scroll up manually â†’ Auto-scroll pauses â†’ Read old messages

### UC-071c-004: Resume Auto-Scroll
**Actor:** Player
**Flow:** Click auto-scroll button â†’ Log scrolls to latest message

### UC-071c-005: Clear Message Log
**Actor:** Player
**Flow:** Click "Clear Log" â†’ All messages removed

### UC-071c-006: Filter Messages
**Actor:** Player
**Flow:** Toggle filter â†’ Messages of that category show/hide

---

## 14. Deliverable Checklist

### Controls
- [ ] `Controls/MessageLogPanel.axaml` created
- [ ] `Controls/MessageLogPanel.axaml.cs` created

### ViewModels
- [ ] `ViewModels/MessageLogViewModel.cs` created

### Models
- [ ] `Models/GameMessage.cs` created
- [ ] `Models/MessageType.cs` created
- [ ] `Models/MessageCategory.cs` created

### Converters
- [ ] `Converters/MessageTypeToColorConverter.cs` created

### Styles
- [ ] `Styles/MessageLogStyles.axaml` created

### Integration
- [ ] `App.axaml` includes MessageLogStyles
- [ ] GameWindow registers MessageLogPanel in BottomContent region

### Testing
- [ ] ~8 unit tests implemented
- [ ] All tests passing

---

## 15. Acceptance Criteria

### Message Display
- [ ] Messages display in scrollable list
- [ ] Timestamps show for each message ([HH:mm:ss])
- [ ] Messages appear in chronological order
- [ ] Text wraps properly for long messages

### Color Coding
- [ ] Combat hit messages show orange-red
- [ ] Combat miss messages show gray
- [ ] Critical hits show magenta
- [ ] Loot rarity colors match tier
- [ ] Dialogue shows yellow

### Auto-Scroll
- [ ] New messages trigger scroll to bottom
- [ ] Manual scroll pauses auto-scroll
- [ ] Toggle button shows current state
- [ ] Re-enabling resumes auto-scroll

### Message Management
- [ ] Clear log removes all messages
- [ ] Max message limit (500) enforced
- [ ] Oldest messages removed when over limit
- [ ] Filter toggles show/hide categories

### Quality
- [ ] Build completes with 0 errors
- [ ] Build completes with 0 warnings
- [ ] ~8 unit tests pass
- [ ] Panel updates when new messages arrive

---

## 16. Dependencies

### Required from v0.7.1b

| Type | Location | Usage |
|------|----------|-------|
| ViewModel patterns | v0.7.1b | Consistent ViewModel structure |
| Converter patterns | v0.7.1b | Reference for color converter |

### Required from v0.7.0c

| Type | Location | Usage |
|------|----------|-------|
| `GameWindow` | `Views/GameWindow.axaml` | BottomContent region host |
| `IWindowLayoutService` | `Services/IWindowLayoutService.cs` | Panel registration |
| `PanelRegion.BottomContent` | `Services/PanelRegion.cs` | Region identifier |
| Panel styles | `Styles/PanelStyles.axaml` | `.panel` class |

### Required from Application Layer

| Type | Location | Usage |
|------|----------|-------|
| `IGameSessionService` | Application layer | Message events |

### Provides to v0.7.2

| Type | Usage |
|------|-------|
| `GameMessage` | Reusable message model |
| `MessageType` | Message categorization |
| Color patterns | Reference for input feedback |

---

## 17. Future Considerations

### Deferred to v0.7.2
- **Command Input Panel**: Input region content
- **Command history**: Up/down arrow navigation

### Deferred to v0.8.0
- **Message search**: Find within log
- **Message export**: Save log to file
- **Rich text formatting**: Bold, italic in messages

### Out of Scope
- **Chat integration**: Multiplayer feature
- **Voice messages**: Accessibility feature for future

---

*Document Version: 1.0*
*Last Updated: 2026-01-10*
*Author: Assistant*
