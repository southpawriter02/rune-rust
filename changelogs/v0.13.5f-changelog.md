# v0.13.5f Changelog — Accessibility & Performance

**Release Date:** 2026-01-21  
**Status:** Implementation Complete

---

## Summary

Implemented inclusive design features (color blind modes, screen reader support, keyboard navigation hints) and performance optimizations (lazy loading, animation optimization) to ensure the application is accessible to all users across varying hardware capabilities.

---

## Added

### Enums

- **`AnnouncementPriority`** — Screen reader announcement priority levels
  - `Normal` — Queued after current speech
  - `Important` — Interrupts current speech
  - `Assertive` — Read immediately for critical alerts

### Interfaces

- **`IAccessibilityService`** — Unified accessibility abstraction
  - `ColorBlindMode` property — Current color blind simulation mode
  - `GetAccessibleColor(ThemeColor)` — Transforms colors for color blind mode
  - `IsHighContrastEnabled` / `IsReducedMotionEnabled` — Visual settings
  - `IsScreenReaderActive` — Screen reader detection
  - `GetAltText(IconKey)` / `GetAltText(string)` — Icon descriptions
  - `Announce(string, AnnouncementPriority)` — Screen reader announcements
  - `ShowKeyboardHints` / `GetKeyboardShortcut(string)` — Keyboard navigation

### Utilities

- **`ColorBlindTransform`** — Color transformation matrices
  - `Transform(ThemeColor, ColorBlindMode)` — Applies color blind simulation
  - Supports Protanopia, Deuteranopia, Tritanopia, Achromatopsia
  - Based on Machado, Oliveira & Fernandes (2009) research

- **`LazyLoader<T>`** — Paginated data loading with caching
  - `LoadPage(int)` — Load specific page with caching
  - `LoadNextPage()` / `LoadPreviousPage()` — Navigation
  - `GetItem(int)` — Individual item access
  - `PrefetchAsync(int)` — Background prefetching
  - `InvalidateCache()` — Cache management
  - LRU eviction policy, configurable cache size (default 3 pages)

- **`AnimationOptimizer`** — Performance-aware animation control
  - `ShouldAnimate()` — Respects reduced motion preference
  - `GetOptimizedDuration(TimeSpan)` — Scales duration based on frame rate
  - `GetFrameSkip()` — Frame skip recommendations
  - `TrackFrame()` — Frame rate tracking with exponential moving average
  - Automatic low-power mode detection (~30 FPS threshold)

### Configuration

- **`AccessibilitySettings`** — Persisted accessibility preferences
  - Color blind mode selection
  - High contrast / reduced motion toggles
  - Screen reader labels enable/disable
  - Keyboard hints visibility
  - `CreateMaxAccessibility()` — Factory for maximum accessibility

### Service Implementations

- **`TuiAccessibilityService`** — Terminal accessibility implementation
  - Console-based announcements (logged, not spoken)
  - Alt text mappings for ASCII icons
  - Keyboard shortcut dictionary

- **`GuiAccessibilityService`** — Avalonia GUI accessibility implementation
  - Screen reader detection (platform-aware)
  - AutomationProperties integration
  - Extended icon alt text mappings

### Test Coverage

- **`ColorBlindTransformTests`** — 13 tests
  - Matrix transformation verification for all modes
  - Edge cases: pure colors, grayscale, boundary values

- **`LazyLoaderTests`** — 24 tests
  - Page loading, caching, LRU eviction
  - Navigation, item access, async prefetching

- **`AnimationOptimizerTests`** — 14 tests
  - Reduced motion behavior
  - Frame rate tracking, duration scaling

---

## Technical Notes

- Color transformation uses scientifically validated matrices
- LazyLoader is thread-safe with internal locking
- AnimationOptimizer uses 0.1 smoothing factor for frame time averaging
- All services support optional ILogger injection for diagnostics

---

## File Changes

### New Files (11)

```
src/Presentation/RuneAndRust.Presentation.Shared/
├── Configuration/
│   └── AccessibilitySettings.cs
├── Enums/
│   └── AnnouncementPriority.cs
├── Interfaces/
│   └── IAccessibilityService.cs
└── Utilities/
    ├── AnimationOptimizer.cs
    ├── ColorBlindTransform.cs
    └── LazyLoader.cs

src/Presentation/RuneAndRust.Presentation.Tui/Services/
└── TuiAccessibilityService.cs

src/Presentation/RuneAndRust.Presentation.Gui/Services/
└── GuiAccessibilityService.cs

tests/RuneAndRust.Presentation.Shared.UnitTests/Utilities/
├── AnimationOptimizerTests.cs
├── ColorBlindTransformTests.cs
└── LazyLoaderTests.cs
```

---

## Related

- **Design Specification:** `docs/design/v0.13.x/v0.13.5f-design-specification.md`
- **Scope Breakdown:** `docs/design/v0.13.x/v0.13.5-scope-breakdown.md`
- **Previous Version:** `changelogs/v0.13.5e-changelog.md`
