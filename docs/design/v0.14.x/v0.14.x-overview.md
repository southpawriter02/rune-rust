## v0.14.x - Configuration Consolidation Pass

**Focus:** JSON configuration and schema standardization for full game customization

### Overview

This version consolidates and standardizes all JSON configuration files to enable complete game customization without code changes. By establishing consistent schema patterns, validation, and documentation, modders and game designers can easily adapt the game to different settings, character options, monsters, abilities, items, and more. The goal is a fully data-driven game where all gameplay content is defined in JSON files with comprehensive schemas.

---

### Current Configuration Landscape

The game currently has **40+ JSON configuration files** across these categories:

| Category | Files | Current State |
|----------|-------|---------------|
| Character Creation | 6 | races, classes, archetypes, backgrounds, attributes, skills |
| Combat & Abilities | 6 | abilities, combat, damage-types, status-effects, effect-interactions, grid |
| Equipment & Items | 3 | weapons, armor, cleanse-items |
| Enemies & Encounters | 3 | monsters, tiers, traits |
| Environment | 9 | biomes, room-types, room-templates, terrain, cover, hazards, interactive-objects, generation-rules, puzzles |
| Resources & Economy | 2 | currency, resources |
| Audio | 2 | sound-effects, music-themes |
| Descriptors | 17 | Various sensory and narrative text pools |
| Schemas | 5 | abilities, cover, grid, hazards, terrain |

**Gap Analysis:** Only 5 of 40+ configuration files have JSON schemas.

---

### v0.14.0 - Character Configuration Schemas

#### Race Configuration
- [ ] **races.schema.json** - Schema for race definitions
- [ ] **Race attribute modifiers** - Validate stat bonus ranges
- [ ] **Race traits** - Define trait reference format
- [ ] **Race lore fields** - Optional description/history fields
- [ ] **Starting equipment references** - Link to item definitions

#### Class Configuration
- [ ] **classes.schema.json** - Schema for class definitions
- [ ] **Class resource types** - Validate resource references (mana, rage, energy)
- [ ] **Growth rate definitions** - Per-level stat scaling
- [ ] **Class ability references** - Link to ability definitions
- [ ] **Archetype associations** - Validate archetype IDs

#### Background Configuration
- [ ] **backgrounds.schema.json** - Schema for background definitions
- [ ] **Skill proficiency grants** - Reference skill definitions
- [ ] **Starting gold ranges** - Economy balance validation
- [ ] **Background traits** - Narrative and mechanical traits

#### Skill Configuration
- [ ] **skills.schema.json** - Schema for skill definitions
- [ ] **Skill attribute links** - Reference attribute definitions
- [ ] **Skill categories** - Enumeration validation
- [ ] **Difficulty class references** - Link to DC definitions

#### Progression Configuration
- [ ] **progression.schema.json** - Schema for level progression
- [ ] **XP thresholds** - Per-level requirements
- [ ] **Ability point grants** - Talent/skill points per level
- [ ] **Attribute increases** - Stat boost schedules

---

### v0.14.1 - Combat Configuration Schemas

#### Ability Configuration (Expand Existing)
- [ ] **abilities.schema.json** - Comprehensive ability schema (expand existing)
- [ ] **Effect type definitions** - Damage, healing, buff, debuff, summon
- [ ] **Targeting rules** - Self, single, AoE, cone, line
- [ ] **Cost definitions** - Resource costs, cooldowns, charges
- [ ] **Combo chain references** - Link abilities in sequences
- [ ] **Prerequisite validation** - Level, class, other ability requirements

#### Status Effect Configuration
- [ ] **status-effects.schema.json** - Schema for buffs/debuffs
- [ ] **Effect duration types** - Turns, seconds, permanent, until-dispelled
- [ ] **Stacking rules** - Intensity, duration, refresh behaviors
- [ ] **Immunity definitions** - Effect type immunities
- [ ] **Trigger conditions** - On-hit, on-damage, on-turn-start, etc.
- [ ] **Cleanse categories** - Magic, poison, curse, disease

#### Damage Type Configuration
- [ ] **damage-types.schema.json** - Schema for damage types
- [ ] **Resistance/vulnerability modifiers** - Percentage ranges
- [ ] **Visual effect associations** - Link to VFX definitions
- [ ] **Sound effect associations** - Link to SFX definitions

#### Combat Rules Configuration
- [ ] **combat.schema.json** - Schema for combat mechanics
- [ ] **Initiative rules** - Calculation formulas
- [ ] **Flanking definitions** - Position-based bonuses
- [ ] **Opportunity attack rules** - Trigger conditions
- [ ] **Death/unconscious rules** - HP threshold behaviors

---

### v0.14.2 - Equipment Configuration Schemas

#### Weapon Configuration
- [ ] **weapons.schema.json** - Schema for weapon definitions
- [ ] **Damage dice expressions** - Validate dice notation (1d8, 2d6+3)
- [ ] **Weapon properties** - Finesse, versatile, reach, thrown, etc.
- [ ] **Proficiency categories** - Simple, martial, exotic
- [ ] **Material types** - Iron, steel, mithril, etc.
- [ ] **Quality tiers** - Common, uncommon, rare, legendary

#### Armor Configuration
- [ ] **armor.schema.json** - Schema for armor definitions
- [ ] **Defense calculations** - AC bonus, damage reduction
- [ ] **Armor categories** - Light, medium, heavy, shield
- [ ] **Movement penalties** - Speed/stealth modifiers
- [ ] **Material types** - Leather, chain, plate, etc.

#### Item Configuration
- [ ] **items.schema.json** - General item schema
- [ ] **Consumable effects** - Potion, scroll, food effects
- [ ] **Equipment slots** - Head, chest, hands, etc.
- [ ] **Stack limits** - Inventory management
- [ ] **Rarity definitions** - Drop rate modifiers
- [ ] **Vendor values** - Buy/sell price calculations

#### Loot Table Configuration
- [ ] **loot-tables.schema.json** - Schema for loot generation
- [ ] **Drop chance percentages** - Probability validation
- [ ] **Quantity ranges** - Min/max drops
- [ ] **Conditional drops** - Level, difficulty, class requirements
- [ ] **Guaranteed vs random** - Fixed and weighted pools

---

### v0.14.3 - Monster Configuration Schemas

#### Monster Definition Configuration
- [ ] **monsters.schema.json** - Comprehensive monster schema
- [ ] **Stat block definitions** - HP, AC, attributes, saves
- [ ] **Ability references** - Link to ability definitions
- [ ] **AI behavior patterns** - Aggressive, defensive, tactical
- [ ] **Loot table references** - Link to loot definitions
- [ ] **Spawn conditions** - Biome, level range, rarity

#### Monster Trait Configuration
- [ ] **traits.schema.json** - Schema for monster traits
- [ ] **Stat modifiers** - Bonus HP, damage, speed
- [ ] **Ability grants** - Special abilities from traits
- [ ] **Resistance/immunity grants** - Damage type protections
- [ ] **Visual modifiers** - Size, color, descriptor changes

#### Monster Tier Configuration
- [ ] **tiers.schema.json** - Schema for difficulty tiers
- [ ] **Stat multipliers** - HP, damage scaling
- [ ] **Loot quality modifiers** - Better drops for higher tiers
- [ ] **XP multipliers** - Reward scaling
- [ ] **Name prefix/suffix** - "Elite", "Champion", etc.

#### Boss Configuration
- [ ] **bosses.schema.json** - Schema for boss encounters
- [ ] **Phase definitions** - Health thresholds, ability changes
- [ ] **Enrage mechanics** - Timer, trigger conditions
- [ ] **Vulnerability windows** - Damage phase timing
- [ ] **Summon configurations** - Minion spawn rules
- [ ] **Unique loot tables** - Boss-specific drops

---

### v0.14.4 - Environment Configuration Schemas

#### Biome Configuration
- [x] **biomes.schema.json** - Schema for biome definitions
- [x] **Monster spawn tables** - Weighted by biome
- [x] **Terrain distributions** - Tile type percentages
- [x] **Hazard frequencies** - Environmental danger rates
- [x] **Ambient descriptors** - Atmosphere text pools
- [x] **Music theme associations** - Audio references

#### Room Configuration
- [x] **room-types.schema.json** - Schema for room types
- [x] **Room template references** - Layout definitions
- [x] **Feature spawn rules** - Objects, NPCs, enemies
- [x] **Connection rules** - Door, corridor, secret passage
- [x] **Lighting conditions** - Visibility modifiers

#### Terrain Configuration (Expand Existing)
- [x] **terrain.schema.json** - Expand existing schema
- [x] **Movement cost validation** - Cost ranges
- [x] **Cover associations** - Terrain providing cover
- [x] **Hazard associations** - Dangerous terrain
- [x] **Visibility modifiers** - Line-of-sight effects

#### Interactive Object Configuration
- [x] **interactive-objects.schema.json** - Schema for interactables
- [x] **Interaction types** - Open, search, activate, destroy
- [x] **Skill check requirements** - DC and skill references
- [x] **Reward definitions** - Items, gold, information
- [x] **State transitions** - Locked -> unlocked, closed -> open

---

### v0.14.5 - Economy Configuration Schemas

#### Currency Configuration
- [x] **currency.schema.json** - Schema for currency types
- [x] **Exchange rates** - Conversion between currencies
- [x] **Display formatting** - Symbol, position, decimals
- [x] **Cap limits** - Maximum carry amounts

#### Resource Configuration
- [x] **resources.schema.json** - Schema for resource types
- [x] **Regeneration rules** - Per-turn, per-rest recovery
- [x] **Maximum calculations** - Base + level + modifiers
- [x] **Depletion effects** - What happens at zero
- [x] **Visual representations** - Bar colors, icons

#### Crafting Recipe Configuration
- [x] **recipes.schema.json** - Schema for crafting recipes
- [x] **Material requirements** - Item/resource references
- [x] **Skill requirements** - Crafting skill checks
- [x] **Output definitions** - Result items with quality variance
- [x] **Station requirements** - Required crafting stations
- [x] **Discovery conditions** - How recipes are learned

#### Vendor Configuration
- [x] **vendors.schema.json** - Schema for NPC shops
- [x] **Inventory definitions** - Available items
- [x] **Price modifiers** - Reputation, charisma effects
- [x] **Restock rules** - Inventory refresh timing
- [x] **Specialty categories** - Blacksmith, alchemist, etc.

---

### v0.14.6 - Audio Configuration Schemas

#### Sound Effect Configuration
- [x] **sound-effects.schema.json** - Schema for SFX definitions
- [x] **Sound categories** - Combat, ability, UI, ambient
- [x] **Trigger associations** - Event to sound mapping
- [x] **Volume/pitch variance** - Randomization ranges
- [x] **Fallback definitions** - Missing sound handling

#### Music Theme Configuration
- [x] **music-themes.schema.json** - Schema for music definitions
- [x] **Theme categories** - Menu, exploration, combat, boss
- [x] **Transition rules** - Crossfade, immediate, stinger
- [x] **Intensity layers** - Dynamic music scaling
- [x] **Loop points** - Seamless audio looping

---

### v0.14.7 - Descriptor Configuration Schemas

#### Sensory Descriptor Configuration
- [x] **descriptors.schema.json** - Master schema for all descriptors
- [x] **Pool definitions** - Category/subcategory structure
- [x] **Weighted selection** - Probability distributions
- [x] **Context tags** - Biome, time, weather filters
- [x] **Variable substitution** - Template placeholders

#### Combat Descriptor Configuration
- [x] **combat-descriptors.schema.json** - Schema for combat text
- [x] **Hit descriptions** - Damage type variations
- [x] **Death descriptions** - Monster type variations
- [x] **Critical descriptions** - Enhanced impact text
- [x] **Miss descriptions** - Failure flavor text

#### Environment Descriptor Configuration
- [x] **environment-descriptors.schema.json** - Schema for environment text
- [x] **Room descriptions** - Entry text pools
- [x] **Object descriptions** - Examination text
- [x] **Ambient events** - Random occurrence text
- [x] **Weather descriptions** - Atmosphere text

---

### v0.14.8 - Dice Configuration Schemas

#### Dice Types Configuration
- [x] **dice-types.schema.json** - Schema for die type definitions
- [x] **Standard dice** - d4, d6, d8, d10, d12, d20, d100
- [x] **Custom dice support** - Arbitrary face counts
- [x] **Dice expression pattern** - Validation regex for "1d6+2" notation
- [x] **Display metadata** - Color, icon, description

#### Dice Mechanics Configuration
- [x] **dice-mechanics.schema.json** - Schema for dice pool mechanics
- [x] **Critical thresholds** - Natural min/max handling
- [x] **Advantage/disadvantage** - Roll multiple, keep best/worst
- [x] **Exploding dice** - Reroll on max
- [x] **Default dice** - By roll category (skill, attack, save)

---

### v0.14.9 - Advanced Descriptor Configuration Schemas

#### Dialogue Configuration
- [x] **dialogue.schema.json** - Schema for NPC dialogue trees
- [x] **Dialogue node definitions** - Id, Text, Options structure
- [x] **Dialogue option validation** - Text, NextNodeId, SkillCheck, Outcome
- [x] **Skill check integration** - Attribute-based checks (might, finesse, will, wits)
- [x] **Outcome types** - InitiateCombat, ReputationChange, QuestGiven, ItemGiven, etc.
- [x] **Condition system** - Node/option visibility controls

#### Ability Descriptor Configuration
- [x] **ability-descriptors.schema.json** - Schema for ability flavor text
- [x] **Galdr action descriptors** - Invocation, chant, manifestation, discharge
- [x] **Weapon art descriptors** - Melee, ranged, defensive abilities
- [x] **Skill usage descriptors** - Success, failure, critical outcomes
- [x] **Rune school classification** - 24 rune schools

#### NPC Descriptor Configuration
- [x] **npc-descriptors.schema.json** - Schema for NPC flavor text
- [x] **Physical appearance descriptors** - Full body, face, clothing, equipment
- [x] **Ambient bark descriptors** - At work, idle, warning, greeting
- [x] **Reaction descriptors** - Surprised, angry, fearful, grateful

#### Psychological Descriptor Configuration
- [x] **psychological-descriptors.schema.json** - Schema for psychological states
- [x] **Stress threshold descriptors** - Minimal to Broken progression
- [x] **Trauma type descriptors** - Flashback, panic, dissociation
- [x] **Corruption progression** - Clean to Forlorn stages

#### Capture Template Configuration
- [x] **capture-templates.schema.json** - Schema for lore fragments
- [x] **Capture type classification** - TextFragment, EchoRecording, etc.
- [x] **Codex keyword matching** - matchKeywords array
- [x] **Quality/reward values** - Legend progression integration

---

### v0.14.10 - Game Systems Configuration Schemas

#### Faction Configuration
- [x] **factions.schema.json** - Schema for faction definitions (~63 tests)
- [x] **Faction identities** - ID, name, description, iconId, color
- [x] **Reputation thresholds** - hostile, unfriendly, neutral, friendly, allied, exalted
- [x] **Inter-faction relationships** - Allied, Friendly, Neutral, Unfriendly, Hostile, AtWar
- [x] **Reputation modifiers** - KillMember, HelpMember, CompleteQuest, FailQuest, Theft, Gift, Betrayal, Discovery
- [x] **Faction perks** - Benefits unlocked at reputation thresholds
- [x] **Vendor access** - Price modifiers and exclusive items by threshold

#### Quest Configuration
- [x] **quests.schema.json** - Schema for quest definitions (~48 tests)
- [x] **Quest stages** - Sequential progression with objectives
- [x] **Objective types** - Kill, Collect, Talk, Explore, Escort, Defend, Craft, Discover, Deliver, Use, Survive, Reach
- [x] **Prerequisites** - Level, faction reputation, completed quests, items
- [x] **Rewards** - XP, gold, items, reputation, abilities
- [x] **Branching paths** - Multiple endings and failure conditions

#### Codex Configuration
- [x] **codex.schema.json** - Schema for codex/journal entries (~55 tests)
- [x] **Entry categories** - Lore, bestiary, items, locations, characters, mechanics
- [x] **Unlock conditions** - 8 types: CaptureCollected, QuestComplete, EnemyKilled, LocationVisited, ItemObtained, FactionReputation, LevelReached, ManualUnlock
- [x] **Progression levels** - Fragment → Partial → Complete → Mastery

#### Command Configuration
- [x] **commands.schema.json** - Schema for command syntax (~62 tests)
- [x] **Command categories** - 8 categories: Movement, Combat, Interaction, Inventory, Information, Social, System, Debug
- [x] **Argument types** - 10 types: String, Number, Direction, Target, Item, Ability, NPC, Location, Quantity, Boolean
- [x] **Context restrictions** - 9 contexts: Exploration, Combat, Dialogue, Inventory, Menu, Rest, Crafting, Trading, Any

#### Glossary Configuration
- [x] **glossary.schema.json** - Schema for game terminology (~49 tests)
- [x] **Term definitions** - ID, term, definition with shortDefinition for tooltips
- [x] **Cross-references** - 4 relationship types: SeeAlso, Contrast, Prerequisite, Related
- [x] **Context-sensitive display** - 5 contexts: Tooltip, Help, Codex, Combat, Inventory

#### Combat Stance Configuration
- [x] **stances.schema.json** - Schema for combat stances (~73 tests)
- [x] **Stat modifiers** - 8 stats: Attack, Defense, Speed, Accuracy, Evasion, CriticalChance, CriticalDamage, DamageReduction
- [x] **Ability restrictions** - 3 types: Category, Specific, Tag
- [x] **Switching rules** - 4 action costs, 7 condition types, 6 trigger effect types
- [x] **AI behavior** - 7 AI condition types, priority, stickiness

---

### Cross-Cutting Configuration Concerns

#### Schema Validation Infrastructure
- [ ] **Schema validation service** - Runtime JSON validation
- [ ] **Schema inheritance** - Base schemas for common patterns
- [ ] **Cross-reference validation** - Verify ID references exist
- [ ] **Circular dependency detection** - Prevent invalid references

#### Configuration Documentation
- [ ] **Auto-generated docs** - Schema to markdown conversion
- [ ] **Example configurations** - Template files for each type
- [ ] **Modding guide** - How to customize the game
- [ ] **Migration guides** - Upgrading between versions

#### Configuration Tooling
- [ ] **Config validator CLI** - Validate all configs at once
- [ ] **Config editor hints** - VS Code schema integration
- [ ] **Config diff tool** - Compare configurations
- [ ] **Config merge tool** - Combine mod configurations

#### Backwards Compatibility
- [ ] **Version fields** - Track schema versions
- [ ] **Migration scripts** - Upgrade old configs
- [ ] **Deprecation warnings** - Flag outdated fields
- [ ] **Fallback defaults** - Handle missing optional fields

---

### Configuration Categories Summary

| Version | Focus | New Schemas | Key Customizations |
|---------|-------|-------------|-------------------|
| v0.14.1 | Character | ~5 | Races, classes, backgrounds, skills, progression |
| v0.14.2 | Combat | ~4 | Abilities, status effects, damage types, combat rules |
| v0.14.3 | Equipment | ~4 | Weapons, armor, items, loot tables |
| v0.14.4 | Monsters | ~4 | Monsters, traits, tiers, bosses |
| v0.14.5 | Environment | ~4 | Biomes, rooms, terrain, objects |
| v0.14.6 | Economy | ~4 | Currency, resources, recipes, vendors |
| v0.14.7 | Audio | ~2 | Sound effects, music themes |
| v0.14.8 | Descriptors | ~3 | Sensory, combat, environment text |
| v0.14.9 | Advanced Descriptors | ~5 | Dialogue, ability, NPC, psychological, lore |

**Total: ~35 new schemas** enabling complete game customization.

---

### Modding Scenarios Enabled

After v0.14.x completion, the following customizations require **zero code changes**:

| Scenario | Configuration Files |
|----------|-------------------|
| **Sci-Fi Setting** | races, classes, weapons, armor, monsters, biomes, descriptors |
| **Low Fantasy** | abilities (remove magic), classes, monsters, items |
| **Horror Theme** | monsters, descriptors, music-themes, status-effects |
| **Comedy/Parody** | descriptors, monster names, item names |
| **Historical Setting** | races, weapons, armor, monsters, biomes |
| **New Playable Race** | races.json (single file addition) |
| **New Character Class** | classes.json, abilities.json |
| **New Monster Type** | monsters.json, traits.json, loot-tables.json |
| **New Dungeon Biome** | biomes.json, room-types.json, terrain.json |
| **Rebalance Combat** | damage-types.json, weapons.json, abilities.json |
| **New Crafting System** | recipes.json, resources.json, items.json |
| **New NPC Dialogues** | dialogues/*.json (branching conversations with skill checks) |

---

### Acceptance Criteria (Overall)

- [ ] All 40+ configuration files have corresponding JSON schemas
- [ ] Schemas include comprehensive field descriptions
- [ ] Cross-references between configurations are validated
- [ ] Example configurations provided for each schema
- [ ] Configuration validation runs at startup
- [ ] Invalid configurations produce clear error messages
- [ ] Modding documentation covers all customization scenarios
- [ ] VS Code provides autocomplete for all config files
- [ ] Backwards compatibility maintained with existing configs
- [ ] Performance: Schema validation < 500ms at startup
