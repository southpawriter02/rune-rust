# v0.18.2 Cognitive Paradox Syndrome - Scope Breakdown

**Version:** 0.18.2
**Theme:** Cognitive Paradox Syndrome (CPS)
**Prerequisites:** v0.18.0 Complete (Psychic Stress), v0.6.x (Dice System), v0.10.x (Status Effects)
**Total Estimated Tests:** ~12 new tests

---

## Executive Summary

v0.18.2 implements **Cognitive Paradox Syndrome (CPS)** — the progressive mental deterioration that occurs when the human mind processes reality-breaking paradoxes. CPS builds on the Psychic Stress system, adding staged symptoms and the Panic Table for severe psychological breaks.

> _"The mind is a machine designed to process logic. The Glitch is pure anti-logic. CPS is the friction of a logical engine grinding against an impossible reality."_

The work is divided into **4 sub-phases**:

| Phase    | Name                               | Focus                                         | Est. Tests |
| -------- | ---------------------------------- | --------------------------------------------- | ---------- |
| v0.18.2a | CPS Enums & State                  | CpsStage, PanicEffect, CpsState               | ~5         |
| v0.18.2b | Panic & Result Objects             | PanicResult, CpsStageChangeResult, UI Effects | ~2         |
| v0.18.2c | ICpsService Interface              | Service contract definition                   | ~0         |
| v0.18.2d | CpsService Implementation & Config | Core CPS logic, JSON config                   | ~5         |

---

## Feature Analysis & Categorization

### From trauma-economy.md - CPS Tracking

| Feature               | Complexity | Dependencies | Assigned Phase |
| --------------------- | ---------- | ------------ | -------------- |
| CpsStage Enum         | Low        | None         | **v0.18.2a**   |
| PanicEffect Enum      | Low        | None         | **v0.18.2a**   |
| CpsState Value Object | Medium     | StressState  | **v0.18.2a**   |

### From trauma-economy.md - CPS Operations

| Feature                    | Complexity | Dependencies     | Assigned Phase |
| -------------------------- | ---------- | ---------------- | -------------- |
| PanicResult Record         | Low        | PanicEffect enum | **v0.18.2b**   |
| CpsStageChangeResult       | Low        | CpsStage enum    | **v0.18.2b**   |
| CpsUiEffects Record        | Low        | CpsStage enum    | **v0.18.2b**   |
| CpsRecoveryProtocol Record | Low        | CpsStage enum    | **v0.18.2b**   |

### From trauma-economy.md - Service Layer

| Feature          | Complexity | Dependencies      | Assigned Phase |
| ---------------- | ---------- | ----------------- | -------------- |
| ICpsService      | Medium     | All VOs           | **v0.18.2c**   |
| CpsService       | High       | ICpsService, Dice | **v0.18.2d**   |
| cps_stages.json  | Medium     | None              | **v0.18.2d**   |
| panic_table.json | Medium     | None              | **v0.18.2d**   |

---

## Phase Definitions

---

## v0.18.2a: CPS Enums & State

[v0.18.2a Design Specification](v0.18.2a-design-specification.md)

### Overview

Defines the foundational CPS stage enum, Panic effect enum, and the CpsState value object that maps stress levels to CPS symptoms.

### Scope

**In Scope:**

- `CpsStage` enum (5 stages: None → HollowShell)
- `PanicEffect` enum (7 effects for Panic Table)
- `CpsState` value object with computed properties

**Out of Scope:**

- Panic Table configuration (v0.18.2d)
- Service implementation (v0.18.2d)

### Key Deliverables

| Type                 | Count | Details               |
| -------------------- | ----- | --------------------- |
| Domain Enums         | 2     | CpsStage, PanicEffect |
| Domain Value Objects | 1     | CpsState              |
| Unit Tests           | ~5    |                       |

### Data Model Changes

```
NEW: CpsStage (Enum)
├── None = 0          (0-19 stress) - Normal cognitive function
├── WeightOfKnowing = 1 (20-49 stress) - Migraines, tinnitus
├── GlimmerMadness = 2  (50-79 stress) - Hallucinations, semantic drift
├── RuinMadness = 3     (80-99 stress) - Violent paranoia, Logic-Locks
└── HollowShell = 4     (100 stress) - Mind erased, catatonia

NEW: PanicEffect (Enum)
├── Freeze = 1        (d10 1-2) - Logic Lock, Stunned 1 turn
├── Flight = 2        (d10 3-4) - Evacuation Protocol, flee
├── Fight = 3         (d10 5-6) - Paradox Fury, attack nearest
├── Babble = 4        (d10 7) - Word Salad, stealth impossible
├── SelfHarm = 5      (d10 8) - Purge, 1d6 self-damage
├── Hallucination = 6 (d10 9) - Phantom Data, disadvantage
└── Catatonia = 7     (d10 10) - System Crash, Prone + Stunned

NEW: CpsState (Value Object)
├── CurrentStress: int
├── Stage: CpsStage (computed from stress)
├── StageName: string (display name)
├── HasVisualDistortion: bool (Stage >= GlimmerMadness)
├── HasLogicDisadvantage: bool (Stage >= GlimmerMadness)
├── RequiresPanicRoll: bool (Stage == RuinMadness)
├── IsHollow: bool (Stage == HollowShell)
├── UiDistortionLevel: int (0-4)
└── Symptoms: IReadOnlyList<string> (by stage)
```

### CPS Stage Mapping

| Stage           | Stress Range | Key Symptoms                      | Mechanical Effects   |
| --------------- | ------------ | --------------------------------- | -------------------- |
| None            | 0-19         | Normal function                   | None                 |
| WeightOfKnowing | 20-49        | Migraines, tinnitus, irritability | UI warnings          |
| GlimmerMadness  | 50-79        | Hallucinations, semantic drift    | Logic disadvantage   |
| RuinMadness     | 80-99        | Violent paranoia, Logic-Locks     | Panic Table required |
| HollowShell     | 100          | Catatonia, hollow behavior        | Character lost       |

### Symptoms by Stage

**Stage 1 - Weight of Knowing:**

- Migraines (The Pressure)
- High-pitched tinnitus (The Static Hiss)
- Mild auditory paresthesia
- Irritability

**Stage 2 - Glimmer-Madness:**

- Visual hallucinations (fractals)
- The Writhing Text (letters rearrange)
- Vertigo
- Semantic drift (forgetting names)

**Stage 3 - Ruin-Madness:**

- Violent paranoia
- Logic-Locks (repeating actions)
- Loss of self-identity
- Worship of anomalies

**Stage 4 - The Hollow Shell:**

- Catatonia
- Hollow behavior (mimicking without comprehension)
- No pupillary response
- Complete lack of survival instinct

### Acceptance Criteria

- [ ] CpsStage enum has 5 values with correct stress ranges
- [ ] PanicEffect enum has 7 values matching d10 roll ranges
- [ ] CpsState correctly computes Stage from CurrentStress
- [ ] HasVisualDistortion true only at Stage 2+
- [ ] HasLogicDisadvantage true only at Stage 2+
- [ ] RequiresPanicRoll true only at Stage 3
- [ ] IsHollow true only at Stage 4
- [ ] ~5 unit tests pass

---

## v0.18.2b: Panic & Result Objects

[v0.18.2b Design Specification](v0.18.2b-design-specification.md)

### Overview

Defines value objects for Panic Table results, stage change detection, UI effects, and recovery protocols.

### Scope

**In Scope:**

- `PanicResult` record
- `CpsStageChangeResult` record
- `CpsUiEffects` record
- `CpsRecoveryProtocol` record

**Out of Scope:**

- Service that creates these results (v0.18.2d)
- Actual dice rolling logic (uses existing `IDiceService`)

### Key Deliverables

| Type                 | Count | Details                                                              |
| -------------------- | ----- | -------------------------------------------------------------------- |
| Domain Value Objects | 4     | PanicResult, CpsStageChangeResult, CpsUiEffects, CpsRecoveryProtocol |
| Unit Tests           | ~2    |                                                                      |

### Data Model Changes

```
NEW: PanicResult (Record)
├── DieRoll: int
├── Effect: PanicEffect
├── EffectName: string
├── Description: string
├── DurationTurns: int?
├── SelfDamage: int?
├── StatusEffects: IReadOnlyList<string>
├── ForcesAction: bool
└── ForcedActionType: string?

NEW: CpsStageChangeResult (Record)
├── PreviousStage: CpsStage
├── NewStage: CpsStage
├── StageChanged: bool (computed)
├── StageWorsened: bool (computed)
├── StageImproved: bool (computed)
├── EnteredRuinMadness: bool (computed)
└── EnteredHollowShell: bool (computed)

NEW: CpsUiEffects (Record)
├── Stage: CpsStage
├── DistortionIntensity: float (0.0 - 1.0)
├── PeripheralStatic: bool
├── TextGlitching: bool
├── LeetSpeakLevel: int (0-4)
├── SystemWarnings: bool
├── ColorTint: string
└── ScreenLag: bool

NEW: CpsRecoveryProtocol (Record)
├── Stage: CpsStage
├── IsRecoverable: bool
├── ProtocolName: string
├── Steps: IReadOnlyList<string>
├── RecoveryTime: string
└── Urgency: string
```

### Panic Table Summary

| d10 Roll | Effect        | Name                | Mechanical Impact              |
| -------- | ------------- | ------------------- | ------------------------------ |
| 1-2      | Freeze        | Logic Lock          | Stunned 1 turn, -5 Defense     |
| 3-4      | Flight        | Evacuation Protocol | Forced Move away from source   |
| 5-6      | Fight         | Paradox Fury        | Forced Attack nearest target   |
| 7        | Babble        | Word Salad          | Party stealth impossible       |
| 8        | SelfHarm      | Purge               | 1d6 self-damage (ignores Soak) |
| 9        | Hallucination | Phantom Data        | Disadvantage on next action    |
| 10       | Catatonia     | System Crash        | Prone + Stunned 1d4 turns      |

### UI Effects by Stage

| Stage           | Distortion | Static | Text Glitch | Leet Level | Color Tint |
| --------------- | ---------- | ------ | ----------- | ---------- | ---------- |
| None            | 0.0        | No     | No          | 0          | #FFFFFF    |
| WeightOfKnowing | 0.1        | Yes    | No          | 0          | #E8E8E8    |
| GlimmerMadness  | 0.4        | Yes    | Yes         | 2          | #FFE0B0    |
| RuinMadness     | 0.7        | Yes    | Yes         | 4          | #FF8080    |
| HollowShell     | 1.0        | N/A    | N/A         | N/A        | #000000    |

### Acceptance Criteria

- [ ] PanicResult contains all mechanical impact data
- [ ] CpsStageChangeResult correctly detects RuinMadness entry
- [ ] CpsStageChangeResult correctly detects HollowShell entry
- [ ] CpsUiEffects scales distortion with stage
- [ ] CpsRecoveryProtocol provides appropriate steps per stage
- [ ] ~2 unit tests pass

---

## v0.18.2c: ICpsService Interface

[v0.18.2c Design Specification](v0.18.2c-design-specification.md)

### Overview

Defines the service contract for all CPS management operations.

### Scope

**In Scope:**

- `ICpsService` interface definition
- Method signatures and XML documentation

**Out of Scope:**

- Implementation (v0.18.2d)

### Key Deliverables

| Type                   | Count | Details        |
| ---------------------- | ----- | -------------- |
| Application Interfaces | 1     | ICpsService    |
| Unit Tests             | ~0    | Interface only |

### Interface Definition

```csharp
public interface ICpsService
{
    CpsState GetCpsState(Guid characterId);
    CpsStage GetCurrentStage(Guid characterId);
    CpsStageChangeResult CheckStageChange(Guid characterId, int previousStress, int newStress);
    PanicResult RollPanicTable(Guid characterId);
    CpsUiEffects GetUiEffects(Guid characterId);
    void ApplyPanicEffect(Guid characterId, PanicResult panicResult);
    bool IsRecoverable(Guid characterId);
    CpsRecoveryProtocol GetRecoveryProtocol(Guid characterId);
}
```

### Acceptance Criteria

- [ ] ICpsService defines all 8 methods
- [ ] All methods have XML documentation
- [ ] Interface compiles without dependencies on implementation

---

## v0.18.2d: CpsService Implementation & Config

[v0.18.2d Design Specification](v0.18.2d-design-specification.md)

### Overview

Implements the core CPS logic and defines the JSON configuration files for stages and the Panic Table.

### Scope

**In Scope:**

- `CpsService` class implementing `ICpsService`
- `config/cps-stages.json` configuration file
- `config/panic-table.json` configuration file

**Out of Scope:**

- Visual shader effects (v0.19.x)
- Leetspeak text rendering (v0.19.x)
- Audio distortion effects (v0.19.x)
- Logic Save checks (v0.18.3)

### Key Deliverables

| Type                 | Count | Details                           |
| -------------------- | ----- | --------------------------------- |
| Application Services | 1     | CpsService                        |
| Configuration Files  | 2     | cps-stages.json, panic-table.json |
| Unit Tests           | ~5    |                                   |

### cps-stages.json Structure

```json
{
    "version": "1.0",
    "stages": [
        {
            "stage": 0,
            "name": "None",
            "displayName": "Clear",
            "stressRange": { "min": 0, "max": 19 },
            "symptoms": [],
            "uiEffects": {
                "distortionIntensity": 0.0,
                "peripheralStatic": false,
                "textGlitching": false,
                "leetSpeakLevel": 0
            },
            "recoveryProtocol": null
        },
        {
            "stage": 1,
            "name": "WeightOfKnowing",
            "displayName": "Weight of Knowing",
            "stressRange": { "min": 20, "max": 49 },
            "symptoms": [
                "Migraines (The Pressure)",
                "High-pitched tinnitus",
                "Auditory paresthesia",
                "Irritability"
            ],
            "fieldSigns": [
                "Subject frequently rubs temples",
                "Asks 'Did you hear that?'",
                "Stares at geometry too long"
            ],
            "uiEffects": {
                "distortionIntensity": 0.1,
                "peripheralStatic": true,
                "textGlitching": false,
                "colorTint": "#E8E8E8"
            },
            "recoveryProtocol": {
                "name": "Cognitive Hygiene",
                "steps": [
                    "Rest in safe location",
                    "Silence and darkness",
                    "Avoid anomaly exposure"
                ],
                "recoveryTime": "12-24 hours",
                "urgency": "Low"
            }
        }
        // ... additional stages
    ]
}
```

### panic-table.json Structure

```json
{
    "version": "1.0",
    "table": [
        {
            "dieRange": { "min": 1, "max": 2 },
            "effect": "Freeze",
            "name": "Logic Lock",
            "description": "Character loses all actions this turn. Stares at a geometric anomaly.",
            "flavor": "The angles... they don't connect...",
            "mechanicalImpact": {
                "statusEffects": ["Stunned"],
                "duration": 1,
                "defensePenalty": 5
            }
        },
        {
            "dieRange": { "min": 3, "max": 4 },
            "effect": "Flight",
            "name": "Evacuation Protocol",
            "description": "Character spends all movement fleeing the source of stress.",
            "flavor": "Abort! Abort!",
            "mechanicalImpact": {
                "forcedAction": "Move",
                "direction": "away_from_source"
            }
        }
        // ... additional entries
    ]
}
```

### Recovery Protocols by Stage

| Stage           | Protocol Name        | Urgency  | Recovery Time | Recoverable |
| --------------- | -------------------- | -------- | ------------- | ----------- |
| WeightOfKnowing | Cognitive Hygiene    | Low      | 12-24 hours   | Yes         |
| GlimmerMadness  | Silent Room Protocol | Critical | 48+ hours     | Yes         |
| RuinMadness     | Terminal Protocol    | None     | N/A           | No          |
| HollowShell     | None                 | N/A      | N/A           | No          |

### Acceptance Criteria

- [ ] CpsService correctly retrieves stress-based CPS state
- [ ] CheckStageChange detects all stage transitions
- [ ] RollPanicTable returns valid effects within d10 range
- [ ] GetUiEffects scales correctly with stage
- [ ] ApplyPanicEffect correctly applies status effects
- [ ] IsRecoverable returns true only for Stage 2 or below
- [ ] Configuration files load and validate correctly
- [ ] ~5 unit tests pass

---

## Dependencies & Prerequisites

```
v0.18.0 (Psychic Stress) - REQUIRED
    │
    └── StressState for CPS stage calculation
                    │
v0.6.x (Dice System) - REQUIRED
    │
    └── IDiceService (d10 Panic Table rolls)
                    │
v0.10.x (Status Effects) - REQUIRED
    │
    └── Stunned, Prone effects
                    │
                    ▼
v0.18.2 (Cognitive Paradox Syndrome)
    │
    ├── v0.18.2a: CPS Enums & State ─────────────────┐
    │       Dependencies: v0.18.0                     │
    │                                                 │
    ├── v0.18.2b: Panic & Result Objects ────────────┤
    │       Dependencies: v0.18.2a                   │
    │                                                 │
    ├── v0.18.2c: ICpsService Interface ─────────────┤
    │       Dependencies: v0.18.2a, v0.18.2b         │
    │                                                 │
    └── v0.18.2d: CpsService & Config ───────────────┘
            Dependencies: v0.18.2c, IDiceService
```

---

## Estimated Effort Summary

| Phase     | New Files | Modified Files | Est. Tests | Complexity |
| --------- | --------- | -------------- | ---------- | ---------- |
| v0.18.2a  | 3         | 0              | ~5         | Low        |
| v0.18.2b  | 4         | 0              | ~2         | Low        |
| v0.18.2c  | 1         | 0              | ~0         | Low        |
| v0.18.2d  | 3         | 1              | ~5         | High       |
| **Total** | **11**    | **1**          | **~12**    |            |

---

## Risk Assessment

| Risk                       | Impact | Probability | Mitigation                             |
| -------------------------- | ------ | ----------- | -------------------------------------- |
| Panic Table balance issues | Medium | Medium      | Playtest and adjust values in config   |
| UI effect performance      | Low    | Low         | Effects are data-only, UI layer defers |
| Stage boundary edge cases  | Low    | Medium      | Comprehensive unit tests               |

---

## Design Decisions (Confirmed)

### CPS Mechanics

| Decision           | Value           | Notes                             |
| ------------------ | --------------- | --------------------------------- |
| **Stage Count**    | 5 stages        | None + 4 progressive stages       |
| **Stage Mapping**  | Based on Stress | Direct correlation with Stress %  |
| **Panic Trigger**  | Stage 3 only    | Ruin-Madness requires Panic rolls |
| **Character Loss** | Stage 4         | Hollow Shell = unplayable         |

### Recovery Philosophy

| Decision              | Value            | Notes                         |
| --------------------- | ---------------- | ----------------------------- |
| **Stage 1 Recovery**  | 12-24 hours rest | Cognitive Hygiene protocol    |
| **Stage 2 Recovery**  | 48+ hours + SSP  | Silent Room Protocol required |
| **Stage 3+ Recovery** | Impossible       | Person is effectively gone    |

### UI Effects

| Decision             | Value     | Notes                          |
| -------------------- | --------- | ------------------------------ |
| **Distortion Scale** | 0.0 - 1.0 | Scaled by stage                |
| **Leetspeak Levels** | 0-4       | Progressive text corruption    |
| **Color Tinting**    | By stage  | Warmer/redder at higher stages |

---

## Out of Scope

| Feature                  | Deferred To | Reason                   |
| ------------------------ | ----------- | ------------------------ |
| Visual shader effects    | v0.19.x     | UI/Graphics version      |
| Leetspeak text rendering | v0.19.x     | UI version               |
| Audio distortion effects | v0.19.x     | Audio version            |
| Logic Save checks        | v0.18.3     | Trauma Check integration |
| Forlorn conversion       | v0.21.x     | Enemy system             |

---

## Next Steps

1. **Review & Approve** - Confirm scope breakdown with stakeholders
2. **v0.18.2a Design Spec** - Create detailed design specification for CPS Enums & State
3. **Implement v0.18.2a** - Build foundational enums and CpsState
4. **Repeat for v0.18.2b through v0.18.2d**

---

_This scope breakdown provides a structured approach to implementing v0.18.2 Cognitive Paradox Syndrome. Each sub-phase builds on the previous, allowing for incremental development and testing._

---

## Changelog

| Version | Date       | Changes                        |
| ------- | ---------- | ------------------------------ |
| 1.0     | 2026-01-17 | Initial scope breakdown        |
| 1.1     | 2026-01-27 | Restructured to match template |
