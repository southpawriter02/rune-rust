# v0.15.3c Changelog - Deception System

## Summary

Implements the **Deception System** subsystem of the Rhetoric skill. Enables lying and misleading through 4-tier lie complexity (DC 10-22), opposed rolls (WILL + Rhetoric vs. NPC WITS), cover story preparation, forged documents, and the Liar's Burden psychic stress mechanic. Features [Lie Exposed] fumble consequence with combat/ban/quest failure possibilities.

## Added

### Domain Layer - Enums (2 files)

| File | Description |
|------|-------------|
| `LieComplexity.cs` | 4-tier enum: WhiteLie (DC 10), Plausible (DC 14), Unlikely (DC 18), Outrageous (DC 22) |
| `CoverStoryQuality.cs` | 5-tier enum: None, Basic (-1 DC), Good (-2), Excellent (-3), Masterwork (-4) |

### Domain Layer - Extensions (2 files)

| File | Description |
|------|-------------|
| `LieComplexityExtensions.cs` | `GetBaseDc()`, `GetDetectionSeverity()`, `RequiresEvidence()`, `GetCombatChanceModifier()`, `GetExamples()` |
| `CoverStoryQualityExtensions.cs` | `GetDcModifier()`, `RequiresPreparation()`, `RequiresEvidence()`, `GetDescription()` |

### Domain Layer - Value Objects (3 files)

| File | Description |
|------|-------------|
| `DeceptionContext.cs` | Captures all deception factors: lie complexity, NPC state, cover story, forged docs, calculates `EffectiveDc`, `PlayerDiceModifier`, `NpcDicePool` |
| `DeceptionResult.cs` | Outcome with LieBelieved, StressCost, combat/ban/quest consequences, factory methods for Success/Failure/Fumble |
| `LiarsBurden.cs` | Stress calculation: Success +1, Failure +3, Fumble +8 (+5 from LieExposed = 13 total) |

### Application Layer (2 files)

| File | Description |
|------|-------------|
| `IDeceptionService.cs` | Interface: `AttemptDeceptionAsync`, `BuildContextAsync`, `HasUntrustworthyFlagAsync`, `CalculateLiarsBurden` |
| `DeceptionService.cs` | Full implementation with opposed rolls, Liar's Burden, [Untrustworthy] flag management |

### Configuration (1 file)

| File | Description |
|------|-------------|
| `config/social/lie-complexity.json` | Lie tiers, DC modifiers, stress costs, fumble consequences |

### Unit Tests (1 test file, 24 tests)

| File | Tests |
|------|-------|
| `LieComplexityTests.cs` | DC mapping, suspicious NPC +4 DC, trusting NPC -4 DC, Liar's Burden stress, cover story modifiers, detection severity, combat chance |

## Key Features

### Lie Complexity Tiers

| Tier | DC | Detection Severity | Combat Chance | Examples |
|------|:--:|:------------------:|:-------------:|----------|
| WhiteLie | 10 | 1 (mild) | 40% | "I didn't see anything" |
| Plausible | 14 | 2 (suspicion) | 50% | "I'm with the Combine" |
| Unlikely | 18 | 3 (alarm) | 60% | "The Warden sent me" |
| Outrageous | 22 | 4 (hostile) | 70% | "I am the Warden" |

### Modifier System

| Source | Modifier | Type |
|--------|----------|------|
| NPC [Suspicious] | +4 | DC |
| NPC [Trusting] | -4 | DC |
| Evidence Contradicts | +6 | DC |
| [Untrustworthy] flag | +3 | DC |
| Cover Story (Basic→Masterwork) | -1 to -4 | DC |
| Forged Documents (Basic) | +1d10 | Dice |
| Forged Documents (High) | +2d10 | Dice |
| Lie Contains Truth | +1d10 | Dice |
| NPC Distracted | +1d10 | Dice |
| NPC Intoxicated | +1d10 | Dice |

### Liar's Burden Stress

| Outcome | Base Stress | [Lie Exposed] | Total |
|---------|:-----------:|:-------------:|:-----:|
| Success | +1 | - | 1 |
| Failure | +3 | - | 3 |
| Fumble | +8 | +5 | 13 |

### [Lie Exposed] Fumble Consequences

- **Trigger:** 0 successes + ≥1 botch
- **[Untrustworthy] flag** applied (+3 DC future deception)
- **Combat:** 40-70% chance based on lie complexity
- **Settlement ban:** 30-50% chance, 1-6 days or permanent
- **Quest failure:** If deception was on critical path

## Files Changed

| File | Change |
|------|--------|
| `src/Core/RuneAndRust.Domain/Enums/LieComplexity.cs` | Added |
| `src/Core/RuneAndRust.Domain/Enums/CoverStoryQuality.cs` | Added |
| `src/Core/RuneAndRust.Domain/Extensions/LieComplexityExtensions.cs` | Added |
| `src/Core/RuneAndRust.Domain/Extensions/CoverStoryQualityExtensions.cs` | Added |
| `src/Core/RuneAndRust.Domain/ValueObjects/LiarsBurden.cs` | Added |
| `src/Core/RuneAndRust.Domain/ValueObjects/DeceptionContext.cs` | Added |
| `src/Core/RuneAndRust.Domain/ValueObjects/DeceptionResult.cs` | Added |
| `src/Core/RuneAndRust.Application/Interfaces/IDeceptionService.cs` | Added |
| `src/Core/RuneAndRust.Application/Services/DeceptionService.cs` | Added |
| `config/social/lie-complexity.json` | Added |
| `tests/RuneAndRust.Domain.UnitTests/Enums/LieComplexityTests.cs` | Added |
| `changelogs/v0.15.3c-changelog.md` | Added |

## Test Results

```
Total tests: 24
     Passed: 24
Build succeeded with 0 errors
```

## Dependencies

- **v0.15.3b:** `PersuasionContext`, `ArgumentAlignment` (pattern reference)
- **v0.15.3a:** `NpcDisposition`, `DispositionLevel`, `SocialContext`
- **v0.15.1b:** `FumbleType.LieExposed` (already existed), `FumbleConsequence`, `OutcomeDetails`
- **v0.15.0:** `DiceRollResult`, `SkillOutcome`, `IDiceRollerService`

## Notes

- `FumbleType.LieExposed` already existed (value = 1), no modification needed
- Opposed roll system: Player (WILL + Rhetoric) vs. NPC (WITS)
- Service uses in-memory tracking; production requires persistence for [Untrustworthy] flags
- Simulated rolls; full integration requires `IDiceRollerService`
