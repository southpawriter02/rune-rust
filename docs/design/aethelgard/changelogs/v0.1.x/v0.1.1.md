# Changelog: v0.1.1 - The Interaction Layer

**Release Date:** December 18, 2025
**Total Tests:** 721 (164 new tests added)

## Table of Contents

- [Summary](#summary)
- [New Features](#new-features)
- [Files Created](#files-created)
- [Files Modified](#files-modified)
- [Code Implementation Details](#code-implementation-details)
- [Commands Reference (Updated)](#commands-reference-updated)
- [Logging Matrix (v0.1.1)](#logging-matrix-v011)
- [Complete Test Inventory](#complete-test-inventory)
- [DI Registration](#di-registration)
- [Build Verification](#build-verification)
- [Directory Structure After v0.1.1](#directory-structure-after-v011)
- [Database Schema Addition](#database-schema-addition)
- [Running Tests](#running-tests)
- [Test Summary by Category](#test-summary-by-category)
- [Next Steps (v0.1.2: The Combat System)](#next-steps-v012-the-combat-system)

---

## Summary

Version 0.1.1 introduces the **Interaction Layer** - a complete system for player-object interactions using WITS-based dice checks. This release transforms static rooms into interactive environments with examinable objects, container mechanics, and procedural description generation following the Three-Tier Composition model (Base + Modifier + Detail).

Key architectural additions:
- **InteractableObject Entity**: Room-bound objects with three-tier descriptions (base, detailed, expert)
- **WITS-Based Examination**: d10 dice pool system determining information revelation depth
- **DescriptorEngine**: Procedural description composition with biome modifiers and danger details
- **ObjectSpawner**: Automatic room population during dungeon generation (2-3 objects per room)
- **Extended Command Parser**: New verbs (examine, open, close, search, objects)

---

## New Features

### Three-Tier Examination System
- **Base Tier (0 net successes)**: Always-visible description
- **Detailed Tier (1+ net successes)**: Additional sensory and observable information
- **Expert Tier (3+ net successes)**: Hidden lore, mechanical insights, secret information
- Examination state persists - highest tier achieved is remembered per object

### Container Mechanics
- **Open/Close Commands**: Toggle container state with validation
- **Locked Containers**: Require unlock before opening (future implementation)
- **Lock Difficulty**: Net successes required for lockpicking (1-3 range)

### Procedural Description Engine
- **Biome Modifiers**: Ruin, Industrial, Organic, Void atmospheric phrases
- **Danger Details**: Safe, Unstable, Hostile, Lethal threat-level descriptions
- **Random Selection**: Varied descriptions for replay value
- **AAM-VOICE Compliant**: All descriptions follow Domain 4 constraints

### Object Spawning System
- **Automatic Population**: 2-3 objects spawned per room during generation
- **Biome Bias**: Object types weighted by room biome
- **5 Object Types**: Furniture, Container, Device, Inscription, Corpse
- **Complete Templates**: Each object has full three-tier descriptions

---

## Files Created

### Core Layer

| File | Purpose |
|------|---------|
| `RuneAndRust.Core/Enums/ObjectType.cs` | Five object categories: Furniture, Container, Device, Inscription, Corpse |
| `RuneAndRust.Core/Enums/BiomeType.cs` | Four biome atmospheres: Ruin, Industrial, Organic, Void |
| `RuneAndRust.Core/Enums/DangerLevel.cs` | Four threat levels: Safe, Unstable, Hostile, Lethal |
| `RuneAndRust.Core/Entities/InteractableObject.cs` | Entity with 3-tier descriptions, container state, examination tracking |
| `RuneAndRust.Core/Models/ExaminationResult.cs` | Record containing dice result data and revealed description |
| `RuneAndRust.Core/Interfaces/IInteractableObjectRepository.cs` | Room-based object queries |
| `RuneAndRust.Core/Interfaces/IInteractionService.cs` | Examine, Open, Close, Search contract |
| `RuneAndRust.Core/Interfaces/IDescriptorEngine.cs` | Three-tier composition contract |

### Persistence Layer

| File | Purpose |
|------|---------|
| `RuneAndRust.Persistence/Repositories/InteractableObjectRepository.cs` | Room-based queries with case-insensitive name matching |

### Engine Layer

| File | Purpose |
|------|---------|
| `RuneAndRust.Engine/Services/DescriptorEngine.cs` | Procedural description generation with biome/danger modifiers |
| `RuneAndRust.Engine/Services/InteractionService.cs` | WITS-based examination, container operations |
| `RuneAndRust.Engine/Services/ObjectSpawner.cs` | Room population with AAM-VOICE compliant objects |

### Test Layer

| File | Purpose |
|------|---------|
| `RuneAndRust.Tests/Core/ObjectTypeTests.cs` | Enum validation (8 tests) |
| `RuneAndRust.Tests/Core/BiomeTypeTests.cs` | Enum validation (7 tests) |
| `RuneAndRust.Tests/Core/DangerLevelTests.cs` | Enum validation (8 tests) |
| `RuneAndRust.Tests/Core/InteractableObjectTests.cs` | Entity properties, state transitions (21 tests) |
| `RuneAndRust.Tests/Core/ExaminationResultTests.cs` | Record behavior, computed properties (16 tests) |
| `RuneAndRust.Tests/Engine/DescriptorEngineTests.cs` | Composition logic, biome/danger phrases (19 tests) |
| `RuneAndRust.Tests/Engine/InteractionServiceTests.cs` | WITS checks, container logic (27 tests) |
| `RuneAndRust.Tests/Engine/ObjectSpawnerTests.cs` | Room population, variety tests (15 tests) |
| `RuneAndRust.Tests/Integration/InteractableObjectPersistenceTests.cs` | CRUD, room queries (18 tests) |

---

## Files Modified

| File | Change |
|------|--------|
| `RuneAndRust.Persistence/Data/RuneAndRustDbContext.cs` | Added `DbSet<InteractableObject>` with RoomId index |
| `RuneAndRust.Engine/Services/CommandParser.cs` | Extended `ParseResult` with interaction flags; added examine/open/close/search/objects commands |
| `RuneAndRust.Terminal/Program.cs` | Registered new services in DI container; updated version to v0.1.1 |

---

## Code Implementation Details

### ObjectType Enum
```csharp
public enum ObjectType
{
    Furniture = 0,   // Decorative, minimal interaction
    Container = 1,   // Can be opened/closed, may contain items
    Device = 2,      // Mechanical objects that can be activated
    Inscription = 3, // Text, runes, symbols to be read
    Corpse = 4       // Remains that can be searched
}
```

### BiomeType Enum
```csharp
public enum BiomeType
{
    Ruin = 0,       // Collapsed structures, dust, ancient decay
    Industrial = 1, // Pipes, machinery, rust
    Organic = 2,    // Fungal growth, corrupted life
    Void = 3        // Empty, echoing darkness
}
```

### DangerLevel Enum
```csharp
public enum DangerLevel
{
    Safe = 0,     // No active threats
    Unstable = 1, // Environmental hazards
    Hostile = 2,  // Active enemies nearby
    Lethal = 3    // Immediate danger
}
```

### InteractableObject Entity
```csharp
public class InteractableObject
{
    // Identity
    public Guid Id { get; set; }
    public Guid RoomId { get; set; }
    public string Name { get; set; }
    public ObjectType ObjectType { get; set; }

    // Three-tier descriptions
    public string Description { get; set; }           // Always visible
    public string? DetailedDescription { get; set; }  // 1+ net successes
    public string? ExpertDescription { get; set; }    // 3+ net successes

    // Container properties
    public bool IsContainer { get; set; }
    public bool IsOpen { get; set; }
    public bool IsLocked { get; set; }
    public int LockDifficulty { get; set; }

    // Examination state
    public bool HasBeenExamined { get; set; }
    public int HighestExaminationTier { get; set; }  // 0=base, 1=detailed, 2=expert

    // Metadata
    public DateTime CreatedAt { get; set; }
    public DateTime LastModified { get; set; }
}
```

### ExaminationResult Record
```csharp
public record ExaminationResult(
    bool Success,
    int NetSuccesses,
    int TierRevealed,
    string Description,
    bool NewInfoRevealed,
    IReadOnlyList<int> Rolls
)
{
    public bool IsFumble => NetSuccesses < 0;
    public bool RevealedExpert => TierRevealed >= 2;
    public bool RevealedDetailed => TierRevealed >= 1;

    public static ExaminationResult NotFound(string targetName) => new(...);
}
```

### InteractionService Tier Thresholds
```csharp
private const int DetailedTierThreshold = 1;  // 1+ net successes
private const int ExpertTierThreshold = 3;    // 3+ net successes

private static int CalculateTierRevealed(int netSuccesses)
{
    if (netSuccesses >= ExpertTierThreshold) return 2;  // Expert
    if (netSuccesses >= DetailedTierThreshold) return 1; // Detailed
    return 0; // Base only
}
```

### ObjectSpawner Configuration
```csharp
private const int MinObjectsPerRoom = 2;
private const int MaxObjectsPerRoom = 3;

// Biome-based object type bias:
// Ruin      -> Furniture, Inscription
// Industrial -> Device, Container
// Organic   -> Corpse, Furniture
// Void      -> Inscription, Corpse

// Container lock probability: 30%
// Lock difficulty range: 1-3 net successes required
```

### ParseResult Extensions
```csharp
public class ParseResult
{
    // Existing properties...

    // New interaction properties
    public bool RequiresExamine { get; set; }
    public string? ExamineTarget { get; set; }
    public bool RequiresOpen { get; set; }
    public string? OpenTarget { get; set; }
    public bool RequiresClose { get; set; }
    public string? CloseTarget { get; set; }
    public bool RequiresSearch { get; set; }
    public bool RequiresListObjects { get; set; }
}
```

---

## Commands Reference (Updated)

### Exploration Phase Commands
| Command | Aliases | Action |
|---------|---------|--------|
| `examine <target>` | `x <target>`, `look <target>` | WITS-based examination of object |
| `open <target>` | | Open a container (if unlocked) |
| `close <target>` | | Close an open container |
| `search` | | Search current room using WITS |
| `objects` | `obj`, `items` | List visible objects in room |

---

## Logging Matrix (v0.1.1)

### InteractionService Logs
| Event | Level | Template |
|-------|-------|----------|
| Examine Start | Information | `"Examining object '{TargetName}'"` |
| No Current Room | Warning | `"Examine attempted with no current room set"` |
| No Character | Warning | `"Examine attempted with no current character"` |
| Object Not Found | Debug | `"Object '{TargetName}' not found in room {RoomId}"` |
| Roll Result | Debug | `"Examination roll: {Successes} successes, {Botches} botches = {Net} net"` |
| Tier Updated | Information | `"Object '{ObjectName}' examination tier updated to {Tier}"` |
| Examine Complete | Debug | `"Examination complete: Success={Success}, Tier={Tier}, NewInfo={NewInfo}"` |
| Open Start | Information | `"Attempting to open '{TargetName}'"` |
| Open Not Container | Debug | `"Object '{ObjectName}' is not a container"` |
| Open Already Open | Debug | `"Object '{ObjectName}' is already open"` |
| Open Locked | Debug | `"Object '{ObjectName}' is locked"` |
| Opened | Information | `"Opened container '{ObjectName}'"` |
| Close Start | Information | `"Attempting to close '{TargetName}'"` |
| Closed | Information | `"Closed container '{ObjectName}'"` |
| Search Start | Information | `"Searching current room"` |
| Search Roll | Debug | `"Search roll: {Successes} successes, {Botches} botches = {Net} net"` |
| Search Fumble | Debug | `"Search fumbled - only basic objects revealed"` |

### DescriptorEngine Logs
| Event | Level | Template |
|-------|-------|----------|
| Compose Start | Debug | `"Composing description with base length {BaseLength}, modifier: {HasModifier}, detail: {HasDetail}"` |
| Composed | Debug | `"Composed description: {Length} characters from {PartCount} parts"` |
| Select Biome Modifier | Debug | `"Selecting modifier for biome {Biome}"` |
| No Modifiers | Warning | `"No modifiers defined for biome {Biome}"` |
| Selected Modifier | Debug | `"Selected biome modifier index {Index}: \"{Modifier}\""` |
| Select Danger Detail | Debug | `"Selecting detail for danger level {DangerLevel}"` |
| Generate Room | Information | `"Generating room description for biome {Biome}, danger {DangerLevel}"` |

### ObjectSpawner Logs
| Event | Level | Template |
|-------|-------|----------|
| Spawn Room Start | Information | `"Spawning objects in room {RoomId} with biome {Biome}"` |
| Object Count | Debug | `"Spawning {Count} objects in room {RoomId}"` |
| Object Created | Debug | `"Created object '{ObjectName}' ({ObjectType}) in room {RoomId}"` |
| Spawn Complete | Information | `"Spawned {Count} objects in room {RoomId}"` |
| Spawn Rooms Total | Information | `"Total objects spawned across all rooms: {Total}"` |

### InteractableObjectRepository Logs
| Event | Level | Template |
|-------|-------|----------|
| Fetch Room Objects | Debug | `"Fetching interactable objects for room {RoomId}"` |
| Retrieved Count | Debug | `"Retrieved {Count} interactable objects for room {RoomId}"` |
| Search by Name | Debug | `"Searching for object '{ObjectName}' in room {RoomId}"` |
| Object Not Found | Debug | `"Object '{ObjectName}' not found in room {RoomId}"` |
| Object Found | Debug | `"Found object '{ObjectName}' ({ObjectId}) in room {RoomId}"` |
| Fetch Containers | Debug | `"Fetching container objects for room {RoomId}"` |
| Check Exists | Debug | `"Checking if object '{ObjectName}' exists in room {RoomId}"` |
| Add Range | Debug | `"Adding {Count} interactable objects to database"` |
| Clear Room | Information | `"Clearing all interactable objects from room {RoomId}"` |
| Cleared | Information | `"Cleared {Count} interactable objects from room {RoomId}"` |

---

## Complete Test Inventory

### Core/ObjectTypeTests.cs (8 tests)
| Test Name | Description |
|-----------|-------------|
| `ObjectType_ShouldHaveExactlyFiveValues` | Validates 5 object types exist |
| `ObjectType_ShouldContain_Furniture` | Furniture value exists |
| `ObjectType_ShouldContain_Container` | Container value exists |
| `ObjectType_ShouldContain_Device` | Device value exists |
| `ObjectType_ShouldContain_Inscription` | Inscription value exists |
| `ObjectType_ShouldContain_Corpse` | Corpse value exists |
| `ObjectType_EnumValues_ShouldBeSequential` | Values are 0,1,2,3,4 |
| `ObjectType_ToString_ReturnsExpectedName` | ToString returns names (5 cases) |

### Core/BiomeTypeTests.cs (7 tests)
| Test Name | Description |
|-----------|-------------|
| `BiomeType_ShouldHaveExactlyFourValues` | Validates 4 biome types exist |
| `BiomeType_ShouldContain_Ruin` | Ruin value exists |
| `BiomeType_ShouldContain_Industrial` | Industrial value exists |
| `BiomeType_ShouldContain_Organic` | Organic value exists |
| `BiomeType_ShouldContain_Void` | Void value exists |
| `BiomeType_EnumValues_ShouldBeSequential` | Values are 0,1,2,3 |
| `BiomeType_ToString_ReturnsExpectedName` | ToString returns names (4 cases) |

### Core/DangerLevelTests.cs (8 tests)
| Test Name | Description |
|-----------|-------------|
| `DangerLevel_ShouldHaveExactlyFourValues` | Validates 4 danger levels exist |
| `DangerLevel_ShouldContain_Safe` | Safe value exists |
| `DangerLevel_ShouldContain_Unstable` | Unstable value exists |
| `DangerLevel_ShouldContain_Hostile` | Hostile value exists |
| `DangerLevel_ShouldContain_Lethal` | Lethal value exists |
| `DangerLevel_EnumValues_ShouldBeSequential` | Values are 0,1,2,3 |
| `DangerLevel_ToString_ReturnsExpectedName` | ToString returns names (4 cases) |
| `DangerLevel_Order_ShouldRepresentIncreasingThreat` | Order represents threat escalation |

### Core/InteractableObjectTests.cs (21 tests)
| Test Name | Description |
|-----------|-------------|
| `InteractableObject_NewInstance_ShouldHaveUniqueId` | Each instance has unique GUID |
| `InteractableObject_DefaultRoomId_ShouldBeEmpty` | RoomId defaults to empty |
| `InteractableObject_DefaultName_ShouldBeEmpty` | Name defaults to empty |
| `InteractableObject_DefaultObjectType_ShouldBeFurniture` | ObjectType defaults to Furniture |
| `InteractableObject_DefaultDescription_ShouldBeEmpty` | Description defaults to empty |
| `InteractableObject_DetailedDescription_ShouldBeNullByDefault` | DetailedDescription defaults to null |
| `InteractableObject_ExpertDescription_ShouldBeNullByDefault` | ExpertDescription defaults to null |
| `InteractableObject_CanSetAllDescriptionLayers` | All three description tiers settable |
| `InteractableObject_DefaultIsContainer_ShouldBeFalse` | IsContainer defaults to false |
| `InteractableObject_DefaultIsOpen_ShouldBeFalse` | IsOpen defaults to false |
| `InteractableObject_DefaultIsLocked_ShouldBeFalse` | IsLocked defaults to false |
| `InteractableObject_DefaultLockDifficulty_ShouldBeZero` | LockDifficulty defaults to 0 |
| `InteractableObject_Container_CanBeOpened` | Container IsOpen can be toggled |
| `InteractableObject_Container_CanBeLocked` | Container lock properties work |
| `InteractableObject_DefaultHasBeenExamined_ShouldBeFalse` | HasBeenExamined defaults to false |
| `InteractableObject_DefaultHighestExaminationTier_ShouldBeZero` | HighestExaminationTier defaults to 0 |
| `InteractableObject_ExaminationTier_CanBeSet` | Examination state can be modified |
| `InteractableObject_ExaminationTier_AcceptsValidValues` | Tier values 0,1,2 accepted (3 cases) |
| `InteractableObject_CreatedAt_ShouldBeSetOnCreation` | Timestamp set on creation |
| `InteractableObject_LastModified_ShouldBeSetOnCreation` | LastModified set on creation |
| `InteractableObject_CompleteConfiguration_ShouldSetAllProperties` | Full object configuration works |

### Core/ExaminationResultTests.cs (16 tests)
| Test Name | Description |
|-----------|-------------|
| `ExaminationResult_CanBeCreated_WithRequiredParameters` | Record creation works |
| `ExaminationResult_Equality_WorksAsExpected` | Record equality comparison |
| `ExaminationResult_IsFumble_ReturnsTrueForNegativeNetSuccesses` | IsFumble true for negative |
| `ExaminationResult_IsFumble_ReturnsFalseForZeroNetSuccesses` | IsFumble false for zero |
| `ExaminationResult_IsFumble_ReturnsFalseForPositiveNetSuccesses` | IsFumble false for positive |
| `ExaminationResult_RevealedExpert_ReturnsTrueForTier2` | RevealedExpert true for tier 2 |
| `ExaminationResult_RevealedExpert_ReturnsFalseForTier1` | RevealedExpert false for tier 1 |
| `ExaminationResult_RevealedExpert_ReturnsFalseForTier0` | RevealedExpert false for tier 0 |
| `ExaminationResult_RevealedDetailed_ReturnsTrueForTier1` | RevealedDetailed true for tier 1 |
| `ExaminationResult_RevealedDetailed_ReturnsTrueForTier2` | RevealedDetailed true for tier 2 |
| `ExaminationResult_RevealedDetailed_ReturnsFalseForTier0` | RevealedDetailed false for tier 0 |
| `ExaminationResult_NotFound_ReturnsFailedResult` | NotFound factory returns failure |
| `ExaminationResult_NotFound_ContainsTargetNameInDescription` | NotFound includes target name |
| `ExaminationResult_NotFound_HasEmptyRolls` | NotFound has no dice rolls |
| `ExaminationResult_NotFound_IsNotFumble` | NotFound is not a fumble |
| `ExaminationResult_TierRevealed_MatchesExpectedValue` | Tier thresholds documented (5 cases) |

### Engine/DescriptorEngineTests.cs (19 tests)
| Test Name | Description |
|-----------|-------------|
| `ComposeDescription_WithOnlyBase_ReturnsBase` | Base-only composition |
| `ComposeDescription_WithBaseAndModifier_CombinesBoth` | Two-tier composition |
| `ComposeDescription_WithAllThreeTiers_CombinesAll` | Full three-tier composition |
| `ComposeDescription_TrimsWhitespace` | Whitespace handling |
| `ComposeDescription_WithEmptyModifier_SkipsModifier` | Empty modifier skipped |
| `ComposeDescription_WithWhitespaceModifier_SkipsModifier` | Whitespace-only skipped |
| `GetModifierForBiome_ReturnsNonEmptyString` | All biomes have modifiers (4 cases) |
| `GetModifierForBiome_Ruin_ContainsThematicContent` | Ruin modifiers are varied |
| `GetModifierForBiome_Industrial_ContainsThematicContent` | Industrial modifiers varied |
| `GetModifierForBiome_Organic_ContainsThematicContent` | Organic modifiers varied |
| `GetModifierForBiome_Void_ContainsThematicContent` | Void modifiers varied |
| `GetDetailForDangerLevel_ReturnsNonEmptyString` | All danger levels have details (4 cases) |
| `GetDetailForDangerLevel_Safe_ContainsThematicContent` | Safe details varied |
| `GetDetailForDangerLevel_Lethal_ContainsThematicContent` | Lethal details varied |
| `GenerateRoomDescription_CombinesAllTiers` | Full generation works |
| `GenerateRoomDescription_IncludesBaseDescription` | Base preserved in output |
| `GenerateRoomDescription_ProducesVariedResults` | Output variety validated |
| `ComposeDescription_LogsAtDebugLevel` | Debug logging verified |
| `GenerateRoomDescription_LogsAtInformationLevel` | Info logging verified |

### Engine/InteractionServiceTests.cs (27 tests)
| Test Name | Description |
|-----------|-------------|
| `ExamineAsync_ObjectNotFound_ReturnsNotFoundResult` | Missing object handling |
| `ExamineAsync_NoCurrentRoom_ReturnsNotFoundResult` | No room validation |
| `ExamineAsync_NoCurrentCharacter_ReturnsNotFoundResult` | No character validation |
| `ExamineAsync_ZeroNetSuccesses_ReturnsTierZero` | Zero net = tier 0 |
| `ExamineAsync_OneNetSuccess_ReturnsTierOne` | 1+ net = tier 1 |
| `ExamineAsync_ThreeOrMoreNetSuccesses_ReturnsTierTwo` | 3+ net = tier 2 |
| `ExamineAsync_UsesCharacterWits_ForDicePool` | WITS used for pool size |
| `ExamineAsync_UpdatesObjectState_WhenNewTierRevealed` | State persistence |
| `ExamineAsync_IncludesRolls_InResult` | Dice rolls returned |
| `OpenAsync_ObjectNotFound_ReturnsNotFoundMessage` | Missing object handling |
| `OpenAsync_NotAContainer_ReturnsCannotOpenMessage` | Non-container rejection |
| `OpenAsync_AlreadyOpen_ReturnsAlreadyOpenMessage` | Already open state |
| `OpenAsync_Locked_ReturnsLockedMessage` | Locked state blocking |
| `OpenAsync_Success_OpensContainer` | Successful open operation |
| `CloseAsync_ObjectNotFound_ReturnsNotFoundMessage` | Missing object handling |
| `CloseAsync_NotAContainer_ReturnsCannotCloseMessage` | Non-container rejection |
| `CloseAsync_AlreadyClosed_ReturnsAlreadyClosedMessage` | Already closed state |
| `CloseAsync_Success_ClosesContainer` | Successful close operation |
| `SearchAsync_NoCurrentRoom_ReturnsErrorMessage` | No room validation |
| `SearchAsync_EmptyRoom_ReturnsNothingFoundMessage` | Empty room handling |
| `SearchAsync_WithObjects_ListsObjectNames` | Object names listed |
| `SearchAsync_UsesCharacterWits` | WITS used for search |
| `GetVisibleObjectsAsync_NoCurrentRoom_ReturnsEmpty` | No room returns empty |
| `GetVisibleObjectsAsync_WithObjects_ReturnsAllObjects` | Objects returned |
| `ListObjectsAsync_EmptyRoom_ReturnsNothingMessage` | Empty room message |
| `ListObjectsAsync_SingleObject_ListsIt` | Single object formatting |
| `ListObjectsAsync_MultipleObjects_ListsAllWithCommas` | Multiple object formatting |

### Engine/ObjectSpawnerTests.cs (15 tests)
| Test Name | Description |
|-----------|-------------|
| `SpawnObjectsInRoomAsync_SpawnsMinimumTwoObjects` | Minimum 2 objects |
| `SpawnObjectsInRoomAsync_SpawnsMaximumThreeObjects` | Maximum 3 objects |
| `SpawnObjectsInRoomAsync_ClearsExistingObjects` | Clears before spawning |
| `SpawnObjectsInRoomAsync_SavesChanges` | Persistence verified |
| `SpawnObjectsInRoomAsync_ObjectsHaveCorrectRoomId` | RoomId set correctly |
| `SpawnObjectsInRoomAsync_ObjectsHaveNonEmptyNames` | Names populated |
| `SpawnObjectsInRoomAsync_ObjectsHaveDescriptions` | Descriptions populated |
| `SpawnObjectsInRoomAsync_ContainersAreMarkedCorrectly` | Container flag set |
| `SpawnObjectsInRoomAsync_AcceptsAllBiomeTypes` | All biomes supported (4 cases) |
| `SpawnObjectsInRoomsAsync_SpawnsInAllRooms` | Multi-room spawning |
| `SpawnObjectsInRoomsAsync_ReturnsCorrectTotal` | Total count accurate |
| `SpawnObjectsInRoomsAsync_EmptyList_ReturnsZero` | Empty input handling |
| `SpawnObjectsInRoomAsync_ProducesVariedObjectTypes` | Type variety |
| `SpawnObjectsInRoomAsync_ProducesVariedObjectNames` | Name variety |
| `SpawnObjectsInRoomAsync_ObjectsHaveThreeTierDescriptions` | All three tiers populated |

### Integration/InteractableObjectPersistenceTests.cs (18 tests)
| Test Name | Description |
|-----------|-------------|
| `AddAsync_ShouldPersistObject` | Basic add and retrieve |
| `AddAsync_ShouldPersistAllProperties` | All properties persisted |
| `GetByRoomIdAsync_ReturnsObjectsInRoom` | Room filtering works |
| `GetByRoomIdAsync_EmptyRoom_ReturnsEmptyList` | Empty room handling |
| `GetByRoomIdAsync_ReturnsOrderedByName` | Alphabetical ordering |
| `GetByNameInRoomAsync_FindsExactMatch` | Exact name match |
| `GetByNameInRoomAsync_CaseInsensitive` | Case-insensitive search |
| `GetByNameInRoomAsync_TrimsWhitespace` | Whitespace trimming |
| `GetByNameInRoomAsync_NotFound_ReturnsNull` | Missing returns null |
| `GetByNameInRoomAsync_WrongRoom_ReturnsNull` | Room scoping enforced |
| `GetContainersInRoomAsync_ReturnsOnlyContainers` | Container filtering |
| `ObjectExistsInRoomAsync_ExistingObject_ReturnsTrue` | Existence check true |
| `ObjectExistsInRoomAsync_NonExisting_ReturnsFalse` | Existence check false |
| `AddRangeAsync_AddsMultipleObjects` | Bulk add works |
| `ClearRoomObjectsAsync_RemovesAllObjectsInRoom` | Room clearing works |
| `ClearRoomObjectsAsync_DoesNotAffectOtherRooms` | Room isolation maintained |
| `UpdateAsync_ShouldModifyExistingObject` | Update persistence |
| `DeleteAsync_ShouldRemoveObject` | Delete works |

---

## DI Registration

Added to `Program.cs`:
```csharp
// Interactable Object Repository
services.AddScoped<IInteractableObjectRepository, InteractableObjectRepository>();

// Engine Services
services.AddScoped<IDescriptorEngine, DescriptorEngine>();
services.AddScoped<IInteractionService, InteractionService>();
services.AddScoped<ObjectSpawner>();
```

---

## Build Verification

```
Build succeeded.
    0 Warning(s)
    0 Error(s)

Test run:
  Passed: 721
  Failed: 0
  Skipped: 0
```

---

## Directory Structure After v0.1.1

```
RuneAndRust/
├── RuneAndRust.Core/
│   ├── Entities/
│   │   ├── Character.cs
│   │   ├── InteractableObject.cs         [NEW]
│   │   ├── Room.cs
│   │   └── SaveGame.cs
│   ├── Enums/
│   │   ├── Attribute.cs
│   │   ├── BiomeType.cs                  [NEW]
│   │   ├── DangerLevel.cs                [NEW]
│   │   ├── Direction.cs
│   │   ├── GamePhase.cs
│   │   ├── ObjectType.cs                 [NEW]
│   │   └── PendingGameAction.cs
│   ├── Interfaces/
│   │   ├── IDescriptorEngine.cs          [NEW]
│   │   ├── IDiceService.cs
│   │   ├── IInputHandler.cs
│   │   ├── IInteractableObjectRepository.cs [NEW]
│   │   ├── IInteractionService.cs        [NEW]
│   │   ├── IRepository.cs
│   │   ├── ISaveGameRepository.cs
│   │   └── IStatCalculationService.cs
│   └── Models/
│       ├── Character.cs
│       ├── ExaminationResult.cs          [NEW]
│       └── GameState.cs
├── RuneAndRust.Engine/
│   └── Services/
│       ├── CommandParser.cs              [MODIFIED]
│       ├── DescriptorEngine.cs           [NEW]
│       ├── DiceService.cs
│       ├── DungeonGenerator.cs
│       ├── GameService.cs
│       ├── InteractionService.cs         [NEW]
│       ├── NavigationService.cs
│       ├── ObjectSpawner.cs              [NEW]
│       ├── SaveManager.cs
│       └── StatCalculationService.cs
├── RuneAndRust.Persistence/
│   ├── Data/
│   │   └── RuneAndRustDbContext.cs       [MODIFIED]
│   └── Repositories/
│       ├── GenericRepository.cs
│       ├── InteractableObjectRepository.cs [NEW]
│       ├── RoomRepository.cs
│       └── SaveGameRepository.cs
├── RuneAndRust.Terminal/
│   ├── Program.cs                        [MODIFIED]
│   └── Services/
│       └── TerminalInputHandler.cs
├── RuneAndRust.Tests/
│   ├── Core/
│   │   ├── BiomeTypeTests.cs             [NEW]
│   │   ├── DangerLevelTests.cs           [NEW]
│   │   ├── ExaminationResultTests.cs     [NEW]
│   │   ├── InteractableObjectTests.cs    [NEW]
│   │   ├── ObjectTypeTests.cs            [NEW]
│   │   └── ... (existing tests)
│   ├── Engine/
│   │   ├── DescriptorEngineTests.cs      [NEW]
│   │   ├── InteractionServiceTests.cs    [NEW]
│   │   ├── ObjectSpawnerTests.cs         [NEW]
│   │   └── ... (existing tests)
│   └── Integration/
│       ├── InteractableObjectPersistenceTests.cs [NEW]
│       └── ... (existing tests)
└── docs/
    └── changelogs/
        ├── v0.0.2.md
        ├── v0.0.3.md
        ├── v0.0.4.md
        └── v0.1.1.md                     [NEW]
```

---

## Database Schema Addition

### InteractableObjects Table
```sql
CREATE TABLE "InteractableObjects" (
    "Id" uuid NOT NULL PRIMARY KEY,
    "RoomId" uuid NOT NULL,
    "Name" character varying(100) NOT NULL,
    "ObjectType" integer NOT NULL,
    "Description" text NOT NULL,
    "DetailedDescription" text NULL,
    "ExpertDescription" text NULL,
    "IsContainer" boolean NOT NULL,
    "IsOpen" boolean NOT NULL,
    "IsLocked" boolean NOT NULL,
    "LockDifficulty" integer NOT NULL,
    "HasBeenExamined" boolean NOT NULL,
    "HighestExaminationTier" integer NOT NULL,
    "CreatedAt" timestamp with time zone NOT NULL,
    "LastModified" timestamp with time zone NOT NULL
);

CREATE INDEX "IX_InteractableObjects_RoomId" ON "InteractableObjects" ("RoomId");
```

---

## Running Tests

```bash
# Run all tests
dotnet test RuneAndRust.Tests

# Run only v0.1.1 new tests
dotnet test RuneAndRust.Tests --filter "FullyQualifiedName~ObjectType|FullyQualifiedName~BiomeType|FullyQualifiedName~DangerLevel|FullyQualifiedName~InteractableObject|FullyQualifiedName~ExaminationResult|FullyQualifiedName~DescriptorEngine|FullyQualifiedName~InteractionService|FullyQualifiedName~ObjectSpawner"

# Run interaction tests specifically
dotnet test RuneAndRust.Tests --filter "FullyQualifiedName~InteractionService"
```

---

## Test Summary by Category

| Category | Test Count |
|----------|------------|
| Core/ObjectTypeTests | 8 |
| Core/BiomeTypeTests | 7 |
| Core/DangerLevelTests | 8 |
| Core/InteractableObjectTests | 21 |
| Core/ExaminationResultTests | 16 |
| Core (other) | 146 |
| Engine/DescriptorEngineTests | 19 |
| Engine/InteractionServiceTests | 27 |
| Engine/ObjectSpawnerTests | 15 |
| Engine (other) | 167 |
| Integration/InteractableObjectPersistenceTests | 18 |
| Integration (other) | 60 |
| **v0.1.1 New Tests** | **164** |
| **Total** | **721** |

---

## Next Steps (v0.1.2: The Combat System)

Potential features for the next release:
- Combat state machine (Initiative, Attack, Defense, Resolution)
- Attack/Defend commands using SINEW, AGILITY, WITS
- Damage calculation and health tracking
- Monster entity with AI behavior patterns
- Combat encounter spawning during exploration
