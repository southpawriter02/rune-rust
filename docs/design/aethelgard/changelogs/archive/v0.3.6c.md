> **Archived** - This changelog has been consolidated. See the complete version at [v0.3.6](../v0.3.x/v0.3.6.md).

# Changelog: v0.3.6c - The Telegraph (Intent & Status)

**Release Date:** 2025-12-22

---

## Summary

Version 0.3.6c introduces the Intent System, providing players with strategic foresight into enemy actions through WITS-based perception checks. This release implements AI pre-planning mechanics where enemies telegraph their intended actions (Attack, Defend, Flee, Pass) at the start of combat and each round, with visibility determined by player WITS checks or the new Analyzed debuff. The system includes dynamic replanning triggered by significant state changes (HP damage, status effects), ensuring enemies adapt to evolving combat conditions.

This release touches the **Core Layer** (Models, ViewModels, Enums), **Engine Layer** (Services), **Terminal Layer** (Rendering), and **Test Layer** with comprehensive test coverage. Key patterns introduced include proactive AI planning with reactive replanning, archetype-specific perception bonuses (Adept +2 WITS), and a new intel-category status effect that bypasses perception requirements.

---

## New Files Created

### Test Layer

| File | Purpose |
|------|---------|
| `RuneAndRust.Tests/Engine/IntentSystemTests.cs` | 13 unit tests validating enemy action planning, WITS-based intent visibility, Adept archetype bonuses, Analyzed status auto-reveal, and intent icon mapping to ViewModel |
| `RuneAndRust.Tests/Engine/AnalyzedStatusTests.cs` | 10 unit tests validating Analyzed status effect behavior including non-stacking mechanics, duration refresh, effect detection, turn-end processing, debuff classification, and max stack limits |
| `RuneAndRust.Tests/Terminal/CombatGridRendererIntentTests.cs` | 9 unit tests validating intent icon rendering (âš”ï¸/ğŸ›¡ï¸/ğŸ’¨/ğŸ’¤/?), status icon display (ğŸ©¸/ğŸ¤¢/ğŸ’«/ğŸ’”/ğŸ›¡ï¸), stack count formatting, and combined intent/status/targeting display |

---

## Files Modified

| File | Change |
|------|--------|
| `RuneAndRust.Core/Enums/StatusEffectType.cs` | Added `Analyzed = 6` as intel debuff effect. Documented as non-stacking (max stacks = 1), reapplication refreshes duration, auto-reveals enemy intent regardless of WITS check |
| `RuneAndRust.Core/Models/Combat/Combatant.cs` | Added `PlannedAction` property (type `CombatAction?`) to store AI-determined action at round start. Added `IsIntentRevealed` property (type `bool`) to track whether player can see the planned action via WITS check or Analyzed status |
| `RuneAndRust.Core/ViewModels/CombatViewModel.cs` | Added `IntentIcon` parameter to `CombatantView` record (type `string?`) showing enemy intent icons (âš”ï¸/ğŸ›¡ï¸/ğŸ’¨/ğŸ’¤/? or null for player). Added `StatusIcons` parameter (type `string?`) showing Unicode status effect icons with stack counts |
| `RuneAndRust.Engine/Services/CombatService.cs` | Added Intent System region with `PlanEnemyActions()`, `CalculateIntentVisibility()`, `GetIntentIcon()`, `GetStatusIcons()`, and `OnStateChange()` methods. Updated constructor to inject `IDiceService` dependency. Modified `StartCombat()` to call `PlanEnemyActions()` after turn order setup. Modified `NextTurn()` to call `PlanEnemyActions()` at round start. Updated `ProcessEnemyTurnAsync()` to use `PlannedAction` with fallback to fresh `DetermineAction()`. Modified `MapToView()` to populate `IntentIcon` and `StatusIcons` for CombatantView. Added `OnStateChange()` calls after damage application in player and enemy attack methods |
| `RuneAndRust.Terminal/Rendering/CombatGridRenderer.cs` | Updated `FormatCombatant()` to display intent icons for enemies with yellow coloring. Added status icon display for all combatants using `StatusIcons` property |
| `RuneAndRust.Terminal/Program.cs` | Updated version string from v0.3.6b to v0.3.6c in boot sequence |

---

## Code Implementation Details

### StatusEffectType.Analyzed (Core/Enums)

**Enum Value:**
```csharp
/// <summary>
/// Intel effect. Target's planned action is revealed to the player.
/// Reveals enemy intent regardless of WITS check result.
/// Does not stack; reapplication refreshes duration only (v0.3.6c).
/// </summary>
Analyzed = 6,
```

**Classification:**
- **Value:** 6 (debuff range: 0-99)
- **Category:** Intel debuff (not DoT)
- **Stacking:** Does not stack (max stacks = 1)
- **Reapplication Behavior:** Refreshes duration to new value
- **Interaction:** Grants automatic intent visibility, bypassing WITS checks entirely

---

### Combatant Intent Properties (Core/Models)

**Added Properties:**
```csharp
/// <summary>
/// The action the AI intends to take this round (v0.3.6c).
/// Calculated at round start and on state changes (HP, status).
/// Null for player combatants.
/// </summary>
public CombatAction? PlannedAction { get; set; }

/// <summary>
/// Whether the player has successfully perceived this enemy's intent (v0.3.6c).
/// Set by CombatService based on WITS check or Analyzed status.
/// Always false for player combatants.
/// </summary>
public bool IsIntentRevealed { get; set; } = false;
```

**Lifecycle:**
- `PlannedAction` set by `PlanEnemyActions()` at combat start, round start, and after state changes
- `PlannedAction` cleared to null after consumption in `ProcessEnemyTurnAsync()`
- `IsIntentRevealed` recalculated each time `PlanEnemyActions()` runs
- Player combatants always have `PlannedAction = null` and `IsIntentRevealed = false`

---

### CombatantView Intent Properties (Core/ViewModels)

**Added Parameters:**
```csharp
public record CombatantView(
    // ... existing parameters ...
    string? IntentIcon = null,    // v0.3.6c
    string? StatusIcons = null    // v0.3.6c
);
```

**IntentIcon Values:**
- `"âš”ï¸"` - Attack action
- `"ğŸ›¡ï¸"` - Defend action
- `"ğŸ’¨"` - Flee action
- `"ğŸ’¤"` - Pass action
- `"?"` - Hidden intent (failed WITS check, no Analyzed status)
- `null` - Player combatants (no intent display)

**StatusIcons Format:**
- Single effect: `"ğŸ©¸"` (Bleeding)
- Stacked effect: `"ğŸ©¸Ã—3"` (Bleeding with 3 stacks)
- Multiple effects: `"ğŸ©¸ ğŸ¤¢"` (Bleeding and Poisoned, space-separated)
- No effects: `null`

**Icon Mappings:**
| Status Effect | Icon | Display Example |
|---------------|------|-----------------|
| Bleeding | ğŸ©¸ | `"ğŸ©¸Ã—2"` |
| Poisoned | ğŸ¤¢ | `"ğŸ¤¢Ã—1"` |
| Stunned | ğŸ’« | `"ğŸ’«"` |
| Vulnerable | ğŸ’” | `"ğŸ’”"` |
| Disoriented | ğŸ˜µ | `"ğŸ˜µ"` |
| Exhausted | ğŸ˜´ | `"ğŸ˜´"` |
| Analyzed | ğŸ” | `"ğŸ”"` |
| Fortified | ğŸ›¡ï¸ | `"ğŸ›¡ï¸Ã—3"` |
| Hasted | âš¡ | `"âš¡"` |
| Inspired | âœ¨ | `"âœ¨"` |

---

### CombatService Intent System Methods (Engine/Services)

**PlanEnemyActions:**
```csharp
private void PlanEnemyActions()
```

**Algorithm:**
1. Return early if `CombatState` is null
2. Locate player combatant from turn order
3. Iterate all living enemy combatants (`CurrentHp > 0`)
4. For each enemy:
   - Call `_aiService.DetermineAction()` to get planned action
   - Call `CalculateIntentVisibility()` to determine if player can perceive
   - Log action type and revealed status at Trace level
5. Total runtime: O(n) where n = enemy count

**Invocation Points:**
- `StartCombat()` - After turn order initialization, before first turn
- `NextTurn()` - When `TurnIndex` wraps to 0 (new round start)
- `OnStateChange()` - After HP damage applied to any combatant

**CalculateIntentVisibility:**
```csharp
private bool CalculateIntentVisibility(Combatant player, Combatant enemy)
```

**Visibility Logic:**
1. **Analyzed Check:** If enemy has `Analyzed` status, return `true` immediately (bypass WITS)
2. **WITS Pool Calculation:**
   - Base pool: `player.GetAttribute(CharacterAttribute.Wits)`
   - Archetype bonus: +2 if player is `ArchetypeType.Adept`, else 0
   - Condition modifier: `player.ConditionWitsModifier`
   - Total pool: `baseWits + archetypeBonus + conditionModifier`
   - Minimum pool: 1 (never roll 0 dice)
3. **Dice Roll:** Roll pool size using `_dice.Roll()`
4. **Success Threshold:** 1+ successes reveals intent
5. **Log:** Debug message showing result, successes, and final pool size

**Behaviors:**
- Analyzed status always reveals, no roll needed
- Adept archetype receives +2 WITS pool for intent checks only (not global bonus)
- Success threshold is low (1 success) to favor player strategic awareness
- Each enemy rolls independently (possible to see some intents but not others)

---

**GetIntentIcon:**
```csharp
private static string GetIntentIcon(CombatAction? action, bool isRevealed)
```

**Mapping:**
```csharp
if (!isRevealed || action == null) return "?";

return action.Type switch
{
    ActionType.Attack => "âš”ï¸",
    ActionType.Defend => "ğŸ›¡ï¸",
    ActionType.Flee => "ğŸ’¨",
    ActionType.Pass => "ğŸ’¤",
    _ => "?"
};
```

**Edge Cases:**
- `null` action â†’ `"?"`
- `isRevealed = false` â†’ `"?"` regardless of action
- Unknown `ActionType` â†’ `"?"` (defensive fallback)

---

**GetStatusIcons:**
```csharp
private static string? GetStatusIcons(List<ActiveStatusEffect>? effects)
```

**Algorithm:**
1. Return `null` if effects list is null or empty
2. Iterate effects and map each to icon (see table above)
3. For stacks > 1, append `Ã—{Stacks}` to icon
4. Join icons with space separator
5. Return `null` if no icons generated (all effects unmapped)

**Output Examples:**
- `"ğŸ©¸Ã—2"` - Bleeding with 2 stacks
- `"ğŸ©¸ ğŸ¤¢Ã—3"` - Bleeding (1 stack) and Poisoned (3 stacks)
- `"ğŸ’«"` - Stunned (non-stacking effect)
- `null` - No effects or all effects unmapped

---

**OnStateChange:**
```csharp
private void OnStateChange()
```

**Purpose:** Trigger enemy replanning after significant combat state changes (HP damage, status effects).

**Behaviors:**
- Calls `PlanEnemyActions()` to recalculate all enemy actions
- Logs trace message indicating replanning occurred
- Lightweight operation: only recalculates actions, does not modify turn order

**Invocation Sites:**
1. **Player Attack Resolution:** After `target.CurrentHp -= result.FinalDamage` in player attack method
2. **Enemy Attack Resolution:** After `target.CurrentHp -= result.FinalDamage` in enemy attack method

**Rationale:** Enemies should adapt strategies when player HP drops (Tank may Defend to protect wounded allies) or enemy HP changes (DPS may become more aggressive when wounded).

---

**ProcessEnemyTurnAsync Updates:**
```csharp
public async Task ProcessEnemyTurnAsync(Combatant enemy)
{
    // ... delay, reset defending ...

    // Use planned action if available, otherwise determine fresh (v0.3.6c)
    var action = enemy.PlannedAction ?? _aiService.DetermineAction(enemy, _gameState.CombatState!);

    // Clear the planned action after use
    enemy.PlannedAction = null;

    // ... execute action ...
}
```

**Behaviors:**
- Prefers `PlannedAction` over fresh determination (uses pre-planned intent)
- Fallback to `DetermineAction()` if `PlannedAction` is null (defensive programming)
- Clears `PlannedAction` after consumption to prevent reuse
- Logs continue to reference action type for debugging

**Fallback Scenarios:**
- `PlannedAction` manually set to null (testing or debugging)
- Enemy added mid-combat without planning phase
- Corruption of combat state

---

**MapToView Intent Mapping:**
```csharp
private static CombatantView MapToView(Combatant combatant, Combatant? activeCombatant)
{
    // ... existing health and status logic ...

    return new CombatantView(
        // ... existing parameters ...
        IntentIcon: combatant.IsPlayer ? null : GetIntentIcon(combatant.PlannedAction, combatant.IsIntentRevealed),
        StatusIcons: GetStatusIcons(combatant.StatusEffects)
    );
}
```

**Intent Display Rules:**
- Player combatants: `IntentIcon = null` (never show intent for player)
- Enemy combatants: Call `GetIntentIcon()` with `PlannedAction` and `IsIntentRevealed`
- Hidden intent: `"?"` if `IsIntentRevealed = false`
- Revealed intent: Action-specific icon if `IsIntentRevealed = true`

**Status Display Rules:**
- All combatants: Call `GetStatusIcons()` with `StatusEffects` list
- Empty list: `StatusIcons = null`
- Populated list: Space-separated icon string with stack counts

---

### CombatGridRenderer Intent Display (Terminal/Rendering)

**Updated FormatCombatant:**
```csharp
public static string FormatCombatant(CombatantView c, bool isEnemy)
{
    // ... existing active marker, name, health icon ...

    // Add intent icon for enemies (v0.3.6c)
    var intentDisplay = "";
    if (isEnemy && !string.IsNullOrEmpty(c.IntentIcon))
    {
        intentDisplay = $" [yellow]{c.IntentIcon}[/]";
    }

    // Add status icons (v0.3.6c)
    var statusDisplay = "";
    if (!string.IsNullOrEmpty(c.StatusIcons))
    {
        statusDisplay = $" {c.StatusIcons}";
    }

    // ... existing targeting indicator ...

    return $"{activeMarker}[{color}]{escapedName}[/]{healthIcon}{intentDisplay}{statusDisplay}{targetIndicator}";
}
```

**Display Order:**
1. Active marker (`>` or space)
2. Combatant name (cyan for players, red for enemies)
3. Health icon (`!!!` / `!!` for enemies)
4. Intent icon (yellow, enemies only)
5. Status icons (default color)
6. Target indicator (`*` if targeted)

**Example Outputs:**
- ` [red]Voidling[/] [yellow]âš”ï¸[/] ğŸ©¸Ã—2` - Enemy with revealed Attack intent and Bleeding Ã—2
- `>[red]Feralhound[/] !!! [yellow]?[/] ğŸ’«` - Active enemy, Critical health, hidden intent, Stunned
- ` [cyan]Kael[/] ğŸ›¡ï¸ ğŸ¤¢` - Player with Fortified and Poisoned (no intent icon)

**Styling:**
- Intent icons: `[yellow]...[/]` (consistent warning color)
- Status icons: No Spectre markup (render as raw Unicode)
- Active marker: `[bold yellow]>[/]`
- Target indicator: `[bold white]*[/]`

---

### Constructor Update (Engine/Services)

**Added Dependency:**
```csharp
public CombatService(
    // ... existing dependencies ...
    IDiceService dice,              // v0.3.6c for WITS checks
    ILogger<CombatService> logger)
{
    // ... existing assignments ...
    _dice = dice;
    _logger = logger;
}
```

**Rationale:** Intent visibility requires dice rolls for WITS checks. `IDiceService` provides standard d10 pool rolling with success counting (8+ = success).

**Impact:** All existing DI registrations and test mocks must include `IDiceService`.

---

## Logging Matrix

### CombatService (Intent System)

| Event | Level | Template |
|-------|-------|----------|
| Enemy action planned | Trace | `"[AI] {Enemy} planned action: {ActionType}. Revealed: {Revealed}"` |
| Intent check result | Debug | `"[Combat] Intent check vs {Enemy}: {Result} ({Successes} successes, pool: {Pool})"` |
| Analyzed bypass | Debug | `"[Combat] {Enemy} intent revealed via Analyzed status"` |
| State change replanning | Trace | `"[Combat] Replanned enemy actions after state change"` |

**Log Contexts:**
- `{Enemy}` - Enemy combatant name (string)
- `{ActionType}` - Enum value (Attack, Defend, Flee, Pass)
- `{Revealed}` - Boolean (true/false)
- `{Result}` - String ("Revealed" or "Hidden")
- `{Successes}` - Integer (dice successes, 8+ counts)
- `{Pool}` - Integer (total dice pool size)

---

## Test Coverage

**Total Tests Added:** 32
**Total Project Tests:** 2,161
**Passed:** 2,161
**Failed:** 0
**Duration:** ~1 second

---

### IntentSystemTests (13 tests)

| Test Name | Description |
|-----------|-------------|
| `StartCombat_PlansActionsForAllEnemies` | Verifies all enemy combatants receive `PlannedAction` at combat start |
| `StartCombat_SkipsDeadEnemies_WhenPlanningActions` | Confirms dead enemies (`CurrentHp <= 0`) are excluded from planning |
| `StartCombat_PlayerCombatant_HasNullPlannedAction` | Asserts player combatant always has `PlannedAction = null` |
| `StartCombat_AnalyzedStatus_AlwaysRevealsIntent` | Validates Analyzed status bypasses WITS checks, sets `IsIntentRevealed = true` |
| `StartCombat_HighWits_WithSuccessfulRoll_RevealsIntent` | Tests successful WITS check (1+ successes) reveals intent |
| `StartCombat_LowWits_WithFailedRoll_HidesIntent` | Tests failed WITS check (0 successes) hides intent |
| `StartCombat_AdeptArchetype_GetsBonusToWitsPool` | Confirms Adept archetype receives +2 dice pool size for intent checks |
| `StartCombat_NonAdeptArchetype_NoBonus` | Confirms Warrior/Skirmisher/Mystic archetypes get no bonus |
| `GetViewModel_Enemy_WithRevealedIntent_ShowsIntentIcon` | Asserts `CombatantView.IntentIcon` shows action icon (âš”ï¸) when `IsIntentRevealed = true` |
| `GetViewModel_Enemy_WithHiddenIntent_ShowsQuestionMark` | Asserts `CombatantView.IntentIcon` shows `"?"` when `IsIntentRevealed = false` |
| `GetViewModel_Player_HasNullIntentIcon` | Confirms player combatants have `IntentIcon = null` |
| `GetViewModel_DefendAction_ShowsShieldIcon` | Tests Defend action maps to `"ğŸ›¡ï¸"` icon |

**Test Setup:**
- Uses Moq to mock 13 service dependencies (added `IDiceService` in v0.3.6c)
- `CreateTestCharacter()` helper creates player combatants with configurable WITS
- `CreateTestEnemy()` helper creates enemy combatants
- Mocks `_mockDice.Roll()` to control success/failure for WITS checks
- Mocks `_mockStatusEffects.HasEffect()` to simulate Analyzed status
- Captures dice pool size via `Callback<int, string>()` to verify bonus application

---

### AnalyzedStatusTests (10 tests)

| Test Name | Description |
|-----------|-------------|
| `ApplyEffect_Analyzed_DoesNotStack` | Verifies applying Analyzed twice results in 1 stack only |
| `ApplyEffect_Analyzed_RefreshesDuration_OnReapplication` | Confirms reapplication refreshes duration to new value |
| `HasEffect_Analyzed_ReturnsTrue_WhenApplied` | Tests `HasEffect()` returns true when Analyzed is active |
| `HasEffect_Analyzed_ReturnsFalse_WhenNotApplied` | Tests `HasEffect()` returns false when Analyzed is not active |
| `ProcessTurnEnd_Analyzed_DecrementsDuration` | Validates duration decrements by 1 each turn via `ProcessTurnEnd()` |
| `ProcessTurnEnd_Analyzed_RemovesEffect_WhenExpired` | Confirms effect removed when duration reaches 0 |
| `Analyzed_IsDebuff` | Asserts `ActiveStatusEffect.IsDebuff()` returns true (value 6 < 100) |
| `Analyzed_IsNotDamageOverTime` | Asserts `ActiveStatusEffect.IsDamageOverTime()` returns false |
| `Analyzed_CannotStack` | Asserts `ActiveStatusEffect.CanStack()` returns false |
| `Analyzed_MaxStacks_IsOne` | Asserts `ActiveStatusEffect.GetMaxStacks()` returns 1 |

**Test Characteristics:**
- Uses `StatusEffectService` as system under test
- `CreateTestCombatant()` helper creates clean combatant for effect application
- Tests cover full lifecycle: apply, check, decrement, expire
- Tests verify static classification methods (`IsDebuff`, `CanStack`, etc.)

---

### CombatGridRendererIntentTests (9 tests)

| Test Name | Description |
|-----------|-------------|
| `FormatCombatant_Enemy_WithIntentIcon_ShowsIcon` | Verifies intent icon (âš”ï¸) appears in formatted output for enemies |
| `FormatCombatant_Enemy_WithQuestionMarkIntent_ShowsQuestionMark` | Confirms `"?"` displays for hidden intent |
| `FormatCombatant_Player_NoIntentIcon` | Asserts player combatants do not show any intent icons |
| `FormatCombatant_Enemy_WithDefendIntent_ShowsShieldIcon` | Tests Defend icon (ğŸ›¡ï¸) renders correctly |
| `FormatCombatant_WithStatusIcons_ShowsIcons` | Validates status icons (ğŸ©¸ ğŸ¤¢) appear in output |
| `FormatCombatant_WithStackedStatus_ShowsStackCount` | Confirms stacked status displays as `ğŸ©¸Ã—3` |
| `FormatCombatant_NoStatusIcons_DoesNotAddExtraSpace` | Ensures null status icons don't add spurious whitespace |
| `FormatCombatant_Enemy_WithIntentAndStatus_ShowsBoth` | Tests combined intent and status icon display |
| `FormatCombatant_ActiveEnemy_ShowsActiveMarker` | Verifies `>` marker displays for active combatants |
| `FormatCombatant_TargetedEnemy_ShowsTargetIndicator` | Verifies `*` marker displays for targeted combatants |

**Test Helpers:**
- `CreateCombatantView()` generates test `CombatantView` records with configurable parameters
- Uses FluentAssertions `Contain()` to verify icon presence in output strings
- Tests static `FormatCombatant()` method (no mocking required)

---

### Updated Tests (3 files, existing tests modified)

| File | Change |
|------|--------|
| `CombatServiceTests.cs` | Added `Mock<IDiceService>` to test constructor, passed to `CombatService` constructor in all test methods |
| `TimelineProjectionTests.cs` | Added `Mock<IDiceService>` to test constructor, passed to `CombatService` constructor in all test methods |
| `RowAssignmentTests.cs` | Added `Mock<IDiceService>` to test constructor, passed to `CombatService` constructor in all test methods |

**Impact:** No test logic changes, only constructor signature updates to accommodate new `IDiceService` dependency.

---

## DI Registration

**No New Registrations Required**

Both `GetIntentIcon()` and `GetStatusIcons()` are private static helper methods within `CombatService`. The `IDiceService` dependency was already registered in prior versions and is reused for intent WITS checks.

**Existing Registration (unchanged):**
```csharp
// Program.cs or App.axaml.cs
services.AddSingleton<IDiceService, DiceService>();
services.AddSingleton<ICombatService, CombatService>();
```

---

## Verification Results

**Build Output:**
```
Build succeeded.
    0 Warning(s)
    0 Error(s)

Time Elapsed 00:00:00.82
```

**Test Output:**
```
Starting test execution, please wait...
A total of 1 test files matched the specified pattern.

Passed!  - Failed:     0, Passed:  2161, Skipped:     0, Total:  2161, Duration: 1 s - RuneAndRust.Tests.dll (net9.0)
```

---

## Directory Structure After Release

```
RuneAndRust/
â”œâ”€â”€ RuneAndRust.Core/
â”‚   â”œâ”€â”€ Enums/
â”‚   â”‚   â””â”€â”€ StatusEffectType.cs [MODIFIED]
â”‚   â”œâ”€â”€ Models/
â”‚   â”‚   â””â”€â”€ Combat/
â”‚   â”‚       â””â”€â”€ Combatant.cs [MODIFIED]
â”‚   â””â”€â”€ ViewModels/
â”‚       â””â”€â”€ CombatViewModel.cs [MODIFIED]
â”œâ”€â”€ RuneAndRust.Engine/
â”‚   â””â”€â”€ Services/
â”‚       â””â”€â”€ CombatService.cs [MODIFIED]
â”œâ”€â”€ RuneAndRust.Terminal/
â”‚   â”œâ”€â”€ Rendering/
â”‚   â”‚   â””â”€â”€ CombatGridRenderer.cs [MODIFIED]
â”‚   â””â”€â”€ Program.cs [MODIFIED]
â””â”€â”€ RuneAndRust.Tests/
    â”œâ”€â”€ Engine/
    â”‚   â”œâ”€â”€ AnalyzedStatusTests.cs [NEW]
    â”‚   â”œâ”€â”€ CombatServiceTests.cs [MODIFIED - IDiceService mock added]
    â”‚   â”œâ”€â”€ IntentSystemTests.cs [NEW]
    â”‚   â”œâ”€â”€ RowAssignmentTests.cs [MODIFIED - IDiceService mock added]
    â”‚   â””â”€â”€ TimelineProjectionTests.cs [MODIFIED - IDiceService mock added]
    â””â”€â”€ Terminal/
        â””â”€â”€ CombatGridRendererIntentTests.cs [NEW]
```

---

## Running Tests

**Run All Intent System Tests:**
```bash
dotnet test --filter "FullyQualifiedName~IntentSystemTests"
dotnet test --filter "FullyQualifiedName~AnalyzedStatusTests"
dotnet test --filter "FullyQualifiedName~CombatGridRendererIntentTests"
```

**Run Specific Test:**
```bash
dotnet test --filter "FullyQualifiedName~StartCombat_AdeptArchetype_GetsBonusToWitsPool"
```

**Run Full Test Suite:**
```bash
dotnet test
```

---

## Next Steps

Planned work for **v0.3.6d**:

- **Ability-Based Intent Reveal:** Introduce "Scan" or "Analyze" abilities that apply Analyzed status to enemies
- **Multi-Turn Intent Projection:** Show enemy intent for current turn and next turn in timeline
- **Intent Icon Tooltips:** Rich hover details showing full action description ("This enemy will attack the Front Row")
- **AI Strategy Hints:** Display additional intel for Analyzed enemies (target selection, ability choice)
- **Intent-Based Counterplay:** Abilities that trigger off specific enemy intents (Riposte on Attack, Brace on Defend)
- **Status Effect Synergies:** Status effects that interact with intent (Fear prevents Defend, Taunt forces Attack on caster)
- **WITS Passive Bonuses:** Equipment or traits that grant permanent WITS bonuses for intent checks
- **Intent Log Messages:** Combat log entries when intent is revealed ("You sense the Voidling preparing to strike!")

---

**End of Changelog v0.3.6c**
