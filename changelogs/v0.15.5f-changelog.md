# v0.15.5f Changelog - Scavenger Sign Reading System

## Summary

Implements the **Scavenger Sign Reading System** for the Wasteland Survival skill. This subsystem allows characters to interpret scavenger signs left by wasteland factions using skill checks. Features 6 sign types with base DCs 10-14, faction familiarity modifiers (+4 for unknown factions), sign age modifiers (+0 to +4), critical success additional context (net >= 5), and fumble misinterpretation mechanics with believable but dangerous false information.

## Added

### Domain Layer - Enums (2 files)

| File | Description |
|------|-------------|
| `ScavengerSignType.cs` | 6-value enum for scavenger sign types: TerritoryMarker (DC 10), WarningSign (DC 12), CacheIndicator (DC 14), TrailBlaze (DC 10), HuntMarker (DC 14), TabooSign (DC 12). Extension methods: `GetBaseDc()`, `GetDisplayName()`, `GetDescription()`, `GetSuccessMeaning()`, `GetCriticalContext()`, `GetMisinterpretation()`, `IndicatesDanger()`, `IndicatesResource()`, `ProvidesNavigation()`, `MisinterpretationCausesFactionConflict()`, `MisinterpretationCausesEnvironmentalDanger()`. |
| `SignAge.cs` | 5-value enum for sign age categories: Fresh (+0 DC), Recent (+0 DC), Old (+1 DC), Faded (+2 DC), Ancient (+4 DC). Extension methods: `GetDcModifier()`, `ToDisplayString()`, `GetDisplayName()`, `GetDescription()`, `IsReliable()`, `IndicatesRecentActivity()`, `GetApproximateTime()`, `GetReliabilityWarning()`. |

### Domain Layer - Value Objects (2 files)

| File | Description |
|------|-------------|
| `ScavengerSign.cs` | `readonly record struct` for sign definitions. Properties: SignType, FactionId, Meaning, Age, VisualDescription. Computed: BaseDc, AgeModifier, IsMajorFaction, IsReliable, IndicatesRecentActivity. Methods: `CalculateInterpretationDc()`. Factory methods: `Create()`, `TerritoryMarker()`, `WarningSign()`, `CacheIndicator()`, `TrailBlaze()`, `HuntMarker()`, `TabooSign()`. Static helpers: `IsMajorFactionId()`, `GetMajorFactionIds()`. String formatting: `ToDiscoveryString()`, `ToDetailedString()`. |
| `SignInterpretationResult.cs` | `readonly record struct` for interpretation outcomes. Properties: Interpreted, SignType, Meaning, FactionName, FactionKnown, AdditionalContext, IsMisinterpretation, NetSuccesses, TargetDc, RollDetails. Computed: IsCritical, IsFailed, Margin, GainedInformation, IsAccurate. Factory methods: `Success()`, `CriticalSuccess()`, `Failure()`, `Misinterpretation()`, `Empty()`. |

### Domain Layer - Entity Modification (1 file)

| File | Description |
|------|-------------|
| `Player.cs` | Added faction knowledge system. Properties: `KnownFactions` (IReadOnlySet<string>). Methods: `AddKnownFaction()`, `KnowsFaction()`. Static: `IsMajorFaction()`, `GetMajorFactionIds()`. Major factions (always known): iron-covenant, rust-walkers, silent-ones, verdant-circle, ash-born. |

### Application Layer - Interface (1 file)

| File | Description |
|------|-------------|
| `ISignInterpretationService.cs` | Service interface with methods: **Interpretation**: `InterpretSign()`. **DC Calculation**: `GetSignDc()`, `GetBaseDc()`, `GetAgeDcModifier()`, `GetUnknownFactionModifier()`. **Meaning**: `GetSignMeaning()`, `GetCriticalContext()`, `GetMisinterpretation()`. **Faction Knowledge**: `IsFactionKnown()`. **Sign Information**: `GetSignDisplayName()`, `GetSignDescription()`, `GetFactionDisplayName()`. **Age Information**: `GetAgeDisplayString()`, `GetReliabilityWarning()`. **Prerequisites**: `CanInterpret()`, `GetInterpretationBlockedReason()`. Full XML documentation with examples. |

### Application Layer - Service (1 file)

| File | Description |
|------|-------------|
| `SignInterpretationService.cs` | Full implementation of ISignInterpretationService. Dependencies: SkillCheckService, ILogger. Constants for all DCs (10-14), modifiers (+4 unknown faction, +0 to +4 age), critical threshold (5). Uses `PerformCheckWithDC` with skillId `"wasteland-survival"`. Fumble detection via `result.IsFumble`. Critical detection via `result.NetSuccesses >= 5`. Automatic faction learning on successful interpretation. Comprehensive logging at Information, Debug, and Warning levels. |

### Configuration (2 files)

| File | Description |
|------|-------------|
| `config/scavenger-signs.json` | Configuration for sign types (DCs, meanings, misinterpretations, visual styles, characteristics), major factions (display names, sign styles, territory colors), age modifiers (DC modifiers, reliability), interpretation outcomes (success, critical, failure, fumble), and balance notes. |
| `config/schemas/scavenger-signs.schema.json` | JSON Schema 2020-12 for scavenger-signs.json validation. Defines signTypeDefinition, signCharacteristicsDefinition, factionDefinition, signAgeDefinition, dcModifierDefinition, outcomeDefinition, criticalOutcomeDefinition, failureOutcomeDefinition, fumbleOutcomeDefinition. |

### Unit Tests (1 file, 60+ tests)

| File | Tests |
|------|-------|
| `SignInterpretationServiceTests.cs` | **Base DC tests** (6 parameterized cases for sign types, 5 for age modifiers). **DC Calculation tests** (5 cases: known/unknown factions, various ages). **Faction Knowledge tests** (5 major faction cases, unknown faction, learned faction, case insensitivity). **Sign Meaning tests** (3 types, misinterpretation content). **Faction Display Name tests** (5 major factions, unknown faction conversion). **Sign Age Information tests** (display strings, reliability warnings). **Prerequisites tests** (2 cases). **SignInterpretationResult tests** (11 cases: factory methods, computed properties, formatting). **ScavengerSign tests** (12 cases: factory methods, DC calculation, static methods). **ScavengerSignType extension tests** (6 cases). **SignAge extension tests** (9 cases). |

## Key Features

### Sign Types

| Sign Type | Base DC | Purpose | Misinterpretation Danger |
|-----------|---------|---------|-------------------------|
| Territory Marker | 10 | Faction boundary warnings | Faction conflict (thinks it's safe) |
| Warning Sign | 12 | Environmental danger alerts | Environmental danger (thinks it's salvage) |
| Cache Indicator | 14 | Hidden supply locations | Missed opportunity (thinks it's danger) |
| Trail Blaze | 10 | Safe path markers | Environmental danger (thinks it's trap) |
| Hunt Marker | 14 | Prey/predator indicators | Predator encounter (thinks it's safe) |
| Taboo Sign | 12 | Forbidden area designations | Supernatural danger (thinks it's treasure) |

### DC Modifiers

| Modifier | Value | Condition |
|----------|-------|-----------|
| Unknown Faction | +4 | Faction not previously known to player |
| Fresh Sign | +0 | SignAge.Fresh (within hours) |
| Recent Sign | +0 | SignAge.Recent (within 1 day) |
| Old Sign | +1 | SignAge.Old (about 1 week) |
| Faded Sign | +2 | SignAge.Faded (several weeks) |
| Ancient Sign | +4 | SignAge.Ancient (months/years) |

### Interpretation Outcomes

| Outcome | Condition | Result |
|---------|-----------|--------|
| Success | Net successes >= DC | Sign type and meaning revealed; faction learned if unknown |
| Critical | Net successes >= 5 | Additional context provided (time restrictions, hidden details) |
| Failure | Net successes < DC | "Markings incomprehensible" - no information gained |
| Fumble | 0 successes + botch | Misinterpretation - player believes false, dangerous info |

### Major Factions (Always Known)

| Faction ID | Display Name | Sign Style |
|------------|--------------|------------|
| iron-covenant | Iron Covenant | Industrial symbols, gear patterns, angular metalwork motifs |
| rust-walkers | Rust Walkers | Weathered organic shapes, wind-blown patterns, nomadic trail markers |
| silent-ones | Silent Ones | Minimalist marks, subtle shadows, nearly invisible to untrained eyes |
| verdant-circle | Verdant Circle | Plant-based symbols, growth patterns, natural dyes in green and brown |
| ash-born | Ash-Born | Flame motifs, carbon marks, charred surfaces |

### Sign Age Reliability

| Age | Reliable | Recent Activity | Warning |
|-----|----------|-----------------|---------|
| Fresh | Yes | Yes | None |
| Recent | Yes | Yes | None |
| Old | No | Yes | "Situations may have changed" |
| Faded | No | No | "Information may be outdated" |
| Ancient | No | No | "Information likely obsolete" |

## Files Changed

### Added (11 files)
- `src/Core/RuneAndRust.Domain/Enums/ScavengerSignType.cs`
- `src/Core/RuneAndRust.Domain/Enums/SignAge.cs`
- `src/Core/RuneAndRust.Domain/ValueObjects/ScavengerSign.cs`
- `src/Core/RuneAndRust.Domain/ValueObjects/SignInterpretationResult.cs`
- `src/Core/RuneAndRust.Application/Interfaces/ISignInterpretationService.cs`
- `src/Core/RuneAndRust.Application/Services/SignInterpretationService.cs`
- `config/scavenger-signs.json`
- `config/schemas/scavenger-signs.schema.json`
- `tests/RuneAndRust.Application.UnitTests/Services/SignInterpretationServiceTests.cs`
- `changelogs/v0.15.5f-changelog.md`

### Modified (1 file)
- `src/Core/RuneAndRust.Domain/Entities/Player.cs` - Added KnownFactions property and faction knowledge methods

## Dependencies

- `SkillCheckService.cs` - For performing Wasteland Survival interpretation checks
- `Player.cs` entity - For player identification and faction knowledge
- `ILogger<SignInterpretationService>` - For comprehensive logging

## Integration Points

- **SkillCheckService**: Uses `PerformCheckWithDC()` for interpretation skill checks
- **Player.KnowsFaction**: Checks faction familiarity for DC calculation
- **Player.AddKnownFaction**: Learns new factions on successful interpretation
- **SkillCheckResult.IsFumble**: Detects fumble condition for misinterpretation

## Notes

- Sign interpretation uses the Wasteland Survival skill (`wasteland-survival`)
- Major factions are always known to all players (no +4 DC modifier)
- Successfully interpreting a sign from an unknown faction automatically adds that faction to player's known factions
- Fumbles (0 successes + botch) result in misinterpretation where the player believes false information
- Misinterpretations are designed to be believable but lead players into danger (faction conflict, environmental hazards)
- Critical success (net >= 5) provides additional context regardless of sign type
- Sign age affects both DC and information reliability
- Old/Faded/Ancient signs may contain outdated information even when successfully interpreted
- This builds upon v0.15.5e (Hazard Detection System) and provides foundation for v0.15.5g (Shelter Assessment)
