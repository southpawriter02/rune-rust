# v0.0.5b Design Specification: Skill Check System

[Implementation Plan](v0.0.5b-implementation-plan.md)

**Version:** 0.0.5b
**Parent:** v0.0.5 (Dice Pool System)
**Prerequisite:** v0.0.5a (Core Dice Engine) - Complete
**Status:** Draft
**Target Test Count:** ~20 new tests

---

## Table of Contents

1. [Executive Summary](#executive-summary)
2. [User Stories](#user-stories)
3. [Functional Requirements](#functional-requirements)
4. [Technical Design](#technical-design)
5. [Architecture](#architecture)
6. [Workflows & Decision Trees](#workflows--decision-trees)
7. [API Reference](#api-reference)
8. [Configuration](#configuration)
9. [Logging Strategy](#logging-strategy)
10. [Testing Strategy](#testing-strategy)
11. [Documentation Requirements](#documentation-requirements)
12. [Implementation Checklist](#implementation-checklist)
13. [Acceptance Criteria](#acceptance-criteria)
14. [Dependencies & Integration](#dependencies--integration)

---

## Executive Summary

### Purpose
Phase 5b builds the skill check framework that uses the dice engine from 5a to determine success/failure for non-combat player actions. This system enables players to interact with the game world through attribute-based challenges.

### Scope
- **In Scope:**
  - SkillDefinition entity (data-driven from config)
  - DifficultyClassDefinition entity (data-driven from config)
  - SkillCheckResult value object
  - SkillCheckService application service
  - DTOs for presentation layer
  - Configuration files for 10 skills and 8 difficulty classes
  - IGameConfigurationProvider extensions

- **Out of Scope:**
  - Presentation layer integration (Phase 5d)
  - Skill training system (future version)
  - Skill-based combat mechanics (Phase 5c)
  - Equipment skill bonuses (future version)

### Key Decisions
| Decision | Choice | Rationale |
|----------|--------|-----------|
| Dice pool for skills | 1d10 | Consistent with d10-based resolution system |
| Critical thresholds | Natural 1 / Natural 10 | Standard critical range for d10 |
| Attribute bonus | Primary + Secondary/2 | Allows skill depth without complexity |
| Difficulty scale | 5 to 30 (8 levels) | Spans trivial to nearly impossible |
| Untrained penalty | Per-skill config | Some skills require training |

---

## User Stories

### US-5b-1: Perform a Skill Check
**As a** player
**I want to** attempt skill checks for non-combat actions
**So that** my character's abilities affect exploration and interaction

**Acceptance Criteria:**
- [ ] Can attempt any skill check with a single command
- [ ] Dice roll includes attribute bonus
- [ ] Result shows success/failure with margin
- [ ] Critical results are detected and displayed

**Example Flow:**
```
Player attempts to pick a lock (Finesse-based Lockpicking check)

┌─────────────────────────────────────────────────────────────────────────────┐
│ SKILL CHECK: Lockpicking                                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Roll:       1d10 [7]                                                       │
│  Finesse:    +4                                                             │
│  ─────────────────                                                          │
│  Total:      11                                                             │
│                                                                              │
│  Difficulty: Moderate (DC 12)                                               │
│  Result:     FAILURE (by 1)                                                 │
│                                                                              │
│  "You fumble with the lock mechanism..."                                    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### US-5b-2: See Available Difficulty Levels
**As a** game designer
**I want to** define difficulty classes in configuration
**So that** challenges can be balanced consistently

**Acceptance Criteria:**
- [ ] 8 difficulty classes defined (Trivial to Nearly Impossible)
- [ ] Each DC has a clear target number
- [ ] DCs are color-coded for UI display
- [ ] DCs are sorted for display purposes

**Difficulty Class Table:**
```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      DIFFICULTY CLASSES                                      │
├─────────────────┬────────┬──────────────────────────────────────────────────┤
│ Name            │ DC     │ Description                                      │
├─────────────────┼────────┼──────────────────────────────────────────────────┤
│ Trivial         │ 3      │ Almost anyone can do this                        │
│ Easy            │ 5      │ Simple task for someone with basic ability       │
│ Moderate        │ 8      │ Requires some skill or effort                    │
│ Challenging     │ 10     │ Difficult for most people                        │
│ Hard            │ 12     │ Only skilled individuals succeed reliably        │
│ Very Hard       │ 15     │ Even experts struggle                            │
│ Heroic          │ 18     │ A legendary feat                                 │
│ Nearly Impossible│ 22    │ Only the most exceptional can hope to succeed    │
└─────────────────┴────────┴──────────────────────────────────────────────────┘

Note: DCs calibrated for 1d10 + attribute modifier (typically +1 to +6)
```

---

### US-5b-3: Use Attributes for Skill Checks
**As a** player
**I want to** my character's attributes to affect skill checks
**So that** my build choices matter during gameplay

**Acceptance Criteria:**
- [ ] Each skill has a primary attribute
- [ ] Some skills have an optional secondary attribute (half bonus)
- [ ] Attribute values map to skill bonuses
- [ ] Skill check result shows attribute contribution

**Attribute-to-Skill Mapping:**
```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      ATTRIBUTE → SKILL MAPPING                               │
├────────────┬────────────────────────────────────────────────────────────────┤
│ Attribute  │ Primary Skills                                                 │
├────────────┼────────────────────────────────────────────────────────────────┤
│ Might      │ Athletics, Intimidation                                        │
│ Fortitude  │ Endurance (secondary: Athletics)                               │
│ Will       │ Persuasion, Arcana                                             │
│ Wits       │ Perception, Investigation (secondary: Stealth, Investigation) │
│ Finesse    │ Acrobatics, Stealth, Lockpicking                              │
└────────────┴────────────────────────────────────────────────────────────────┘

Bonus Calculation:
- Primary attribute: Full value added to roll
- Secondary attribute: Half value (rounded down) added to roll
- Example: Athletics (Might primary, Fortitude secondary)
  - Might 5, Fortitude 4 → Bonus = 5 + 2 = +7
```

---

### US-5b-4: Handle Critical Results
**As a** player
**I want to** see special effects for critical successes and failures
**So that** extreme rolls feel impactful

**Acceptance Criteria:**
- [ ] Natural 10 on d10 = Critical Success (always succeeds)
- [ ] Natural 1 on d10 = Critical Failure (always fails)
- [ ] Critical results override normal success/failure calculation
- [ ] Descriptors selected from config/descriptors/skillchecks.json

**Critical Result Flow:**
```
                    ┌─────────────────────┐
                    │  Roll First Die     │
                    └──────────┬──────────┘
                               │
                 ┌─────────────┼─────────────┐
                 │             │             │
                 ▼             ▼             ▼
         ┌───────────┐  ┌───────────┐  ┌───────────┐
         │ Roll = 1  │  │ Roll 2-9  │  │ Roll = 10 │
         └─────┬─────┘  └─────┬─────┘  └─────┬─────┘
               │              │              │
               ▼              ▼              ▼
    ┌──────────────────┐    ┌────────────────────┐    ┌────────────────────┐
    │ CRITICAL FAILURE │    │ Calculate Total    │    │ CRITICAL SUCCESS   │
    │ Always fails     │    │ Compare to DC      │    │ Always succeeds    │
    │ Select descriptor│    │ Normal success/fail│    │ Select descriptor  │
    │ from crit_failure│    └────────────────────┘    │ from crit_success  │
    └──────────────────┘                              └────────────────────┘
```

---

### US-5b-5: Support Untrained Skills
**As a** game designer
**I want to** restrict some skills to trained characters
**So that** specialization matters

**Acceptance Criteria:**
- [ ] Skills can be flagged as requiring training
- [ ] Untrained attempts receive a penalty
- [ ] Penalty is configurable per skill
- [ ] Default: all skills are trainable with no penalty

**Untrained Check Flow:**
```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      UNTRAINED SKILL CHECK                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Skill:      Lockpicking (requires training)                                │
│  Trained:    NO                                                             │
│  Penalty:    -5                                                             │
│                                                                              │
│  Roll:       1d10 [6]                                                       │
│  Finesse:    +4                                                             │
│  Untrained:  -5                                                             │
│  ─────────────────                                                          │
│  Total:      5                                                              │
│                                                                              │
│  Difficulty: Moderate (DC 8)                                                │
│  Result:     FAILURE (by 3)                                                 │
│                                                                              │
│  "Your unfamiliarity with locks shows..."                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### US-5b-6: Check with Advantage or Disadvantage
**As a** game system
**I want to** apply advantage/disadvantage to skill checks
**So that** situational modifiers affect outcomes

**Acceptance Criteria:**
- [ ] Skill checks can be made with advantage
- [ ] Skill checks can be made with disadvantage
- [ ] Advantage/disadvantage comes from DiceService (5a)
- [ ] Both rolls shown in result

**Advantage Skill Check:**
```
┌─────────────────────────────────────────────────────────────────────────────┐
│ SKILL CHECK: Perception (with Advantage)                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Roll 1:     1d10 [3] + 4 = 7                                               │
│  Roll 2:     1d10 [8] + 4 = 12  ← BEST                                      │
│  ─────────────────                                                          │
│  Using:      12                                                             │
│                                                                              │
│  Difficulty: Challenging (DC 10)                                            │
│  Result:     SUCCESS (by 2)                                                 │
│                                                                              │
│  "Your heightened senses reveal a hidden passage!"                          │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## Functional Requirements

### FR-5b-1: Skill Definitions
The system SHALL support configurable skill definitions with:

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| Id | string | Yes | Unique identifier (e.g., "lockpicking") |
| Name | string | Yes | Display name (e.g., "Lockpicking") |
| Description | string | Yes | Skill description |
| PrimaryAttribute | string | Yes | Main attribute (might, fortitude, will, wits, finesse) |
| SecondaryAttribute | string | No | Optional secondary attribute (half bonus) |
| BaseDicePool | string | No | Default: "1d10" |
| AllowUntrained | bool | No | Default: true |
| UntrainedPenalty | int | No | Default: 0 |
| Category | string | No | For grouping (Physical, Mental, Social, etc.) |
| Tags | string[] | No | For filtering and searching |

### FR-5b-2: Difficulty Classes
The system SHALL support configurable difficulty classes with:

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| Id | string | Yes | Unique identifier (e.g., "moderate") |
| Name | string | Yes | Display name (e.g., "Moderate") |
| Description | string | Yes | DC description |
| TargetNumber | int | Yes | DC value (minimum 1) |
| Color | string | No | Hex color for UI |
| SortOrder | int | No | Display ordering |

### FR-5b-3: Success Level Determination
The system SHALL determine success levels as follows:

| Condition | Success Level | Behavior |
|-----------|---------------|----------|
| Natural 1 | CriticalFailure | Always fails, regardless of total |
| Natural 10 | CriticalSuccess | Always succeeds, regardless of total |
| Total >= DC | Success | Normal success |
| Total < DC | Failure | Normal failure |

### FR-5b-4: Bonus Calculation
The system SHALL calculate bonuses as:

```
Total = DiceRoll + PrimaryAttribute + (SecondaryAttribute / 2) + AdditionalBonus - UntrainedPenalty
```

---

## Technical Design

### Class Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            DOMAIN LAYER                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌───────────────────────────────────┐                                      │
│  │  SkillDefinition                   │                                      │
│  ├───────────────────────────────────┤                                      │
│  │ + Id: string                       │                                      │
│  │ + Name: string                     │                                      │
│  │ + Description: string              │                                      │
│  │ + PrimaryAttribute: string         │                                      │
│  │ + SecondaryAttribute: string?      │                                      │
│  │ + BaseDicePool: string             │                                      │
│  │ + AllowUntrained: bool             │                                      │
│  │ + UntrainedPenalty: int            │                                      │
│  │ + Category: string                 │                                      │
│  │ + Tags: IReadOnlyList<string>      │                                      │
│  ├───────────────────────────────────┤                                      │
│  │ + «static» Create(...): SkillDef   │                                      │
│  └───────────────────────────────────┘                                      │
│                                                                              │
│  ┌───────────────────────────────────┐                                      │
│  │  DifficultyClassDefinition         │                                      │
│  ├───────────────────────────────────┤                                      │
│  │ + Id: string                       │                                      │
│  │ + Name: string                     │                                      │
│  │ + Description: string              │                                      │
│  │ + TargetNumber: int                │                                      │
│  │ + Color: string                    │                                      │
│  │ + SortOrder: int                   │                                      │
│  ├───────────────────────────────────┤                                      │
│  │ + «static» Create(...): DCDef      │                                      │
│  └───────────────────────────────────┘                                      │
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │  <<record struct>>                                                     │  │
│  │  SkillCheckResult                                                      │  │
│  ├───────────────────────────────────────────────────────────────────────┤  │
│  │ + SkillId: string                                                      │  │
│  │ + SkillName: string                                                    │  │
│  │ + DiceResult: DiceRollResult                                          │  │
│  │ + AttributeBonus: int                                                  │  │
│  │ + OtherBonus: int                                                      │  │
│  │ + TotalResult: int                                                     │  │
│  │ + DifficultyClass: int                                                 │  │
│  │ + DifficultyName: string                                               │  │
│  │ + SuccessLevel: SuccessLevel                                           │  │
│  │ + «computed» Margin: int                                               │  │
│  │ + «computed» IsSuccess: bool                                           │  │
│  │ + «computed» IsCritical: bool                                          │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                          APPLICATION LAYER                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │  SkillCheckService                                                     │  │
│  ├───────────────────────────────────────────────────────────────────────┤  │
│  │ - _diceService: DiceService                                            │  │
│  │ - _configProvider: IGameConfigurationProvider                          │  │
│  │ - _logger: ILogger<SkillCheckService>                                  │  │
│  ├───────────────────────────────────────────────────────────────────────┤  │
│  │ + PerformCheck(player, skillId, dcId, adv, bonus): SkillCheckResult   │  │
│  │ + PerformCheckWithDC(player, skillId, dc, name, adv, bonus): Result   │  │
│  │ + GetAllSkills(): IReadOnlyList<SkillDefinition>                       │  │
│  │ + GetDifficultyClasses(): IReadOnlyList<DifficultyClassDefinition>    │  │
│  │ - GetAttributeBonus(player, skill): int                                │  │
│  │ - GetAttributeValue(player, attributeId): int                          │  │
│  │ - PlayerHasSkillTraining(player, skillId): bool                        │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │  DTOs                                                                   │  │
│  ├───────────────────────────────────────────────────────────────────────┤  │
│  │  SkillCheckResultDto                                                   │  │
│  │  SkillDefinitionDto                                                    │  │
│  │  DifficultyClassDto                                                    │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Sequence Diagram: Skill Check Flow

```
┌──────────┐     ┌─────────────────┐     ┌─────────────────┐     ┌─────────────┐
│  Caller  │     │SkillCheckService│     │  ConfigProvider │     │ DiceService │
└────┬─────┘     └────────┬────────┘     └────────┬────────┘     └──────┬──────┘
     │                    │                       │                      │
     │ PerformCheck()     │                       │                      │
     │───────────────────>│                       │                      │
     │                    │                       │                      │
     │                    │ GetSkillById()        │                      │
     │                    │──────────────────────>│                      │
     │                    │      SkillDefinition  │                      │
     │                    │<──────────────────────│                      │
     │                    │                       │                      │
     │                    │ GetDifficultyClassById()                     │
     │                    │──────────────────────>│                      │
     │                    │      DifficultyClassDef                      │
     │                    │<──────────────────────│                      │
     │                    │                       │                      │
     │                    │ Calculate attribute bonus                    │
     │                    │ (Primary + Secondary/2)                      │
     │                    │                       │                      │
     │                    │ Roll(dicePool, advantageType)               │
     │                    │─────────────────────────────────────────────>│
     │                    │                       │    DiceRollResult    │
     │                    │<─────────────────────────────────────────────│
     │                    │                       │                      │
     │                    │ Create SkillCheckResult                      │
     │                    │ (determines success level)                   │
     │                    │                       │                      │
     │  SkillCheckResult  │                       │                      │
     │<───────────────────│                       │                      │
     │                    │                       │                      │
```

---

## Architecture

### Layer Dependencies

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              PRESENTATION                                    │
│  (Phase 5d - not implemented in 5b)                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                      │                                      │
│                                      ▼                                      │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         APPLICATION LAYER                            │   │
│  │  ┌────────────────────┐    ┌─────────────────────────────────────┐  │   │
│  │  │  SkillCheckService │───>│  IGameConfigurationProvider         │  │   │
│  │  │                    │    │  + GetSkillById(id)                  │  │   │
│  │  │  + PerformCheck()  │    │  + GetSkills()                       │  │   │
│  │  │  + GetAllSkills()  │    │  + GetDifficultyClassById(id)        │  │   │
│  │  │                    │    │  + GetDifficultyClasses()            │  │   │
│  │  └────────┬───────────┘    └─────────────────────────────────────┘  │   │
│  │           │                                                          │   │
│  │           │                                                          │   │
│  │           ▼                                                          │   │
│  │  ┌────────────────────┐                                             │   │
│  │  │  DiceService (5a)  │                                             │   │
│  │  └────────────────────┘                                             │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                      │                                      │
│                                      ▼                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                               DOMAIN LAYER                                   │
│  ┌────────────────────┐  ┌─────────────────────┐  ┌───────────────────────┐│
│  │  SkillDefinition   │  │  DifficultyClassDef │  │  SkillCheckResult     ││
│  └────────────────────┘  └─────────────────────┘  └───────────────────────┘│
│                                                                              │
│  Uses from 5a:                                                              │
│  ┌────────────────────┐  ┌─────────────────────┐  ┌───────────────────────┐│
│  │  DiceRollResult    │  │  SuccessLevel       │  │  AdvantageType        ││
│  └────────────────────┘  └─────────────────────┘  └───────────────────────┘│
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           INFRASTRUCTURE LAYER                               │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  JsonConfigurationProvider                                           │   │
│  │  + GetSkillById(id): SkillDefinition?                               │   │
│  │  + GetSkills(): IReadOnlyList<SkillDefinition>                      │   │
│  │  + GetDifficultyClassById(id): DifficultyClassDefinition?           │   │
│  │  + GetDifficultyClasses(): IReadOnlyList<DifficultyClassDefinition> │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                      │                                      │
│           ┌──────────────────────────┼──────────────────────────┐          │
│           ▼                          ▼                          ▼          │
│  ┌─────────────────┐      ┌─────────────────────┐    ┌─────────────────┐  │
│  │ config/         │      │ config/              │    │ config/         │  │
│  │ skills.json     │      │ difficulty.json      │    │ descriptors/    │  │
│  │ (10 skills)     │      │ (8 difficulty classes│    │ skillchecks.json│  │
│  └─────────────────┘      └─────────────────────┘    └─────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## Workflows & Decision Trees

### Skill Check Decision Tree

```
                         ┌─────────────────────────┐
                         │  Start: PerformCheck()  │
                         └────────────┬────────────┘
                                      │
                         ┌────────────▼────────────┐
                         │  Validate Parameters    │
                         │  - Player not null      │
                         │  - Skill exists         │
                         │  - DC exists            │
                         └────────────┬────────────┘
                                      │
                    ┌─────────────────▼─────────────────┐
                    │  Calculate Attribute Bonus        │
                    │  primary = GetAttributeValue()    │
                    │  secondary = GetAttributeValue()/2│
                    │  bonus = primary + secondary      │
                    └─────────────────┬─────────────────┘
                                      │
                    ┌─────────────────▼─────────────────┐
                    │  Check Untrained Penalty          │
                    │  if !AllowUntrained && !trained   │
                    │    bonus -= UntrainedPenalty      │
                    └─────────────────┬─────────────────┘
                                      │
                    ┌─────────────────▼─────────────────┐
                    │  Roll Dice via DiceService        │
                    │  pool = DicePool.Parse(BaseDice)  │
                    │  result = Roll(pool, advantageType)│
                    └─────────────────┬─────────────────┘
                                      │
                    ┌─────────────────▼─────────────────┐
                    │  Determine Success Level          │
                    └─────────────────┬─────────────────┘
                                      │
        ┌─────────────────────────────┼─────────────────────────────┐
        │                             │                             │
        ▼                             ▼                             ▼
┌───────────────┐           ┌───────────────┐           ┌───────────────┐
│ Natural 1?    │           │ Natural 10?   │           │ Normal Roll   │
│ → CritFailure │           │ → CritSuccess │           │ Total >= DC?  │
└───────────────┘           └───────────────┘           └───────┬───────┘
                                                                │
                                                    ┌───────────┼───────────┐
                                                    ▼           ▼           │
                                            ┌───────────┐ ┌───────────┐     │
                                            │ Success   │ │ Failure   │     │
                                            └───────────┘ └───────────┘     │
```

### Attribute Bonus Calculation

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    ATTRIBUTE BONUS CALCULATION                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Input: SkillDefinition, Player                                             │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  Step 1: Get Primary Attribute Value                                 │   │
│  │                                                                       │   │
│  │  primaryValue = player.Attributes[skill.PrimaryAttribute]            │   │
│  │                                                                       │   │
│  │  Mapping:                                                            │   │
│  │    "might"     → player.Attributes.Might                             │   │
│  │    "fortitude" → player.Attributes.Fortitude                         │   │
│  │    "will"      → player.Attributes.Will                              │   │
│  │    "wits"      → player.Attributes.Wits                              │   │
│  │    "finesse"   → player.Attributes.Finesse                           │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                      │                                      │
│                                      ▼                                      │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  Step 2: Check for Secondary Attribute                               │   │
│  │                                                                       │   │
│  │  if (skill.SecondaryAttribute != null)                               │   │
│  │      secondaryValue = player.Attributes[skill.SecondaryAttribute] / 2│   │
│  │  else                                                                │   │
│  │      secondaryValue = 0                                              │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                      │                                      │
│                                      ▼                                      │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  Step 3: Return Total Bonus                                          │   │
│  │                                                                       │   │
│  │  return primaryValue + secondaryValue                                │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│  Example:                                                                   │
│    Skill: Athletics (primary: might, secondary: fortitude)                  │
│    Player: Might = 5, Fortitude = 4                                         │
│    Bonus = 5 + (4 / 2) = 5 + 2 = 7                                         │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Success Level Determination

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    SUCCESS LEVEL DETERMINATION                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│                           ┌───────────────────┐                             │
│                           │ DiceRollResult    │                             │
│                           │ IsNaturalOne?     │                             │
│                           └─────────┬─────────┘                             │
│                                     │                                       │
│              ┌──────────────────────┼──────────────────────┐                │
│              │ YES                  │ NO                   │                │
│              ▼                      ▼                      │                │
│  ┌────────────────────┐   ┌───────────────────┐           │                │
│  │  CriticalFailure   │   │ IsNaturalMax?     │           │                │
│  │  (Always fails)    │   └─────────┬─────────┘           │                │
│  └────────────────────┘             │                     │                │
│                       ┌─────────────┼─────────────┐       │                │
│                       │ YES         │ NO          │       │                │
│                       ▼             ▼             │       │                │
│           ┌────────────────────┐   ┌────────────────────┐ │                │
│           │  CriticalSuccess   │   │ TotalResult >= DC? │ │                │
│           │  (Always succeeds) │   └─────────┬──────────┘ │                │
│           └────────────────────┘             │            │                │
│                                 ┌────────────┼────────────┐                │
│                                 │ YES        │ NO         │                │
│                                 ▼            ▼            │                │
│                     ┌───────────────┐  ┌───────────────┐  │                │
│                     │   Success     │  │   Failure     │  │                │
│                     └───────────────┘  └───────────────┘  │                │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## API Reference

### SkillDefinition API

```csharp
namespace RuneAndRust.Domain.Definitions;

/// <summary>
/// Defines a skill that can be checked against difficulty.
/// Loaded from configuration.
/// </summary>
public class SkillDefinition
{
    /// <summary>Unique identifier (e.g., "lockpicking", "perception").</summary>
    public string Id { get; init; } = string.Empty;

    /// <summary>Display name (e.g., "Lockpicking", "Perception").</summary>
    public string Name { get; init; } = string.Empty;

    /// <summary>Description of what the skill does.</summary>
    public string Description { get; init; } = string.Empty;

    /// <summary>Primary attribute that modifies this skill (e.g., "finesse", "wits").</summary>
    public string PrimaryAttribute { get; init; } = string.Empty;

    /// <summary>Optional secondary attribute that provides half bonus.</summary>
    public string? SecondaryAttribute { get; init; }

    /// <summary>Base dice pool notation (e.g., "1d10").</summary>
    public string BaseDicePool { get; init; } = "1d10";

    /// <summary>Whether this skill can be attempted untrained.</summary>
    public bool AllowUntrained { get; init; } = true;

    /// <summary>Penalty when attempting untrained.</summary>
    public int UntrainedPenalty { get; init; } = 0;

    /// <summary>Category for organization (e.g., "Combat", "Exploration", "Social").</summary>
    public string Category { get; init; } = "General";

    /// <summary>Tags for filtering and searching.</summary>
    public IReadOnlyList<string> Tags { get; init; } = Array.Empty<string>();

    /// <summary>
    /// Creates a validated skill definition.
    /// </summary>
    /// <exception cref="ArgumentException">If required fields are missing.</exception>
    public static SkillDefinition Create(
        string id,
        string name,
        string description,
        string primaryAttribute,
        string? secondaryAttribute = null,
        string baseDicePool = "1d10",
        bool allowUntrained = true,
        int untrainedPenalty = 0,
        string category = "General",
        IReadOnlyList<string>? tags = null);
}
```

### DifficultyClassDefinition API

```csharp
namespace RuneAndRust.Domain.Definitions;

/// <summary>
/// Defines a difficulty class (DC) threshold.
/// Loaded from configuration.
/// </summary>
public class DifficultyClassDefinition
{
    /// <summary>Unique identifier (e.g., "trivial", "easy", "hard").</summary>
    public string Id { get; init; } = string.Empty;

    /// <summary>Display name (e.g., "Trivial", "Easy", "Hard").</summary>
    public string Name { get; init; } = string.Empty;

    /// <summary>Description shown to player.</summary>
    public string Description { get; init; } = string.Empty;

    /// <summary>Target number to meet or exceed.</summary>
    public int TargetNumber { get; init; }

    /// <summary>Display color (for UI).</summary>
    public string Color { get; init; } = "#FFFFFF";

    /// <summary>Sort order for display.</summary>
    public int SortOrder { get; init; }

    /// <summary>
    /// Creates a validated difficulty class definition.
    /// </summary>
    /// <exception cref="ArgumentException">If ID is missing.</exception>
    /// <exception cref="ArgumentOutOfRangeException">If target number &lt; 1.</exception>
    public static DifficultyClassDefinition Create(
        string id,
        string name,
        string description,
        int targetNumber,
        string color = "#FFFFFF",
        int sortOrder = 0);
}
```

### SkillCheckResult API

```csharp
namespace RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Represents the result of a skill check.
/// Immutable value object.
/// </summary>
public readonly record struct SkillCheckResult
{
    // Properties set at construction
    public string SkillId { get; init; }
    public string SkillName { get; init; }
    public DiceRollResult DiceResult { get; init; }
    public int AttributeBonus { get; init; }
    public int OtherBonus { get; init; }
    public int TotalResult { get; init; }
    public int DifficultyClass { get; init; }
    public string DifficultyName { get; init; }
    public SuccessLevel SuccessLevel { get; init; }

    // Computed properties
    public int Margin => TotalResult - DifficultyClass;
    public bool IsSuccess => SuccessLevel is SuccessLevel.Success or SuccessLevel.CriticalSuccess;
    public bool IsCritical => SuccessLevel is SuccessLevel.CriticalSuccess or SuccessLevel.CriticalFailure;

    /// <summary>
    /// Creates a skill check result, automatically determining success level.
    /// </summary>
    public SkillCheckResult(
        string skillId,
        string skillName,
        DiceRollResult diceResult,
        int attributeBonus,
        int otherBonus,
        int difficultyClass,
        string difficultyName);

    public override string ToString();
}
```

### SkillCheckService API

```csharp
namespace RuneAndRust.Application.Services;

/// <summary>
/// Service for performing skill checks.
/// Integrates dice rolling with player attributes and configuration.
/// </summary>
public class SkillCheckService
{
    /// <summary>
    /// Performs a skill check for a player using a named difficulty class.
    /// </summary>
    /// <param name="player">The player making the check.</param>
    /// <param name="skillId">The skill to check (e.g., "perception").</param>
    /// <param name="difficultyClassId">The difficulty level (e.g., "moderate").</param>
    /// <param name="advantageType">Optional advantage/disadvantage.</param>
    /// <param name="additionalBonus">Extra bonus from situational effects.</param>
    /// <returns>The skill check result with full breakdown.</returns>
    /// <exception cref="ArgumentNullException">If player is null.</exception>
    /// <exception cref="ArgumentException">If skill or DC not found.</exception>
    public SkillCheckResult PerformCheck(
        Player player,
        string skillId,
        string difficultyClassId,
        AdvantageType advantageType = AdvantageType.Normal,
        int additionalBonus = 0);

    /// <summary>
    /// Performs a skill check with a specific DC value.
    /// </summary>
    public SkillCheckResult PerformCheckWithDC(
        Player player,
        string skillId,
        int difficultyClass,
        string difficultyName = "Custom",
        AdvantageType advantageType = AdvantageType.Normal,
        int additionalBonus = 0);

    /// <summary>
    /// Gets all available skill definitions.
    /// </summary>
    public IReadOnlyList<SkillDefinition> GetAllSkills();

    /// <summary>
    /// Gets all difficulty class definitions.
    /// </summary>
    public IReadOnlyList<DifficultyClassDefinition> GetDifficultyClasses();
}
```

### Usage Examples

```csharp
// Basic skill check
var result = skillCheckService.PerformCheck(
    player,
    "perception",
    "moderate");

Console.WriteLine($"{result.SkillName}: {result.TotalResult} vs DC {result.DifficultyClass}");
Console.WriteLine($"Result: {result.SuccessLevel} (by {result.Margin})");

// Skill check with advantage
var stealthResult = skillCheckService.PerformCheck(
    player,
    "stealth",
    "challenging",
    AdvantageType.Advantage);

// Skill check with custom DC
var lockpickResult = skillCheckService.PerformCheckWithDC(
    player,
    "lockpicking",
    15,
    "Ancient Lock");

// List all skills
var skills = skillCheckService.GetAllSkills();
foreach (var skill in skills.Where(s => s.Category == "Physical"))
{
    Console.WriteLine($"{skill.Name} ({skill.PrimaryAttribute})");
}
```

---

## Configuration

### config/skills.json

```json
{
  "$schema": "skills.schema.json",
  "skills": [
    {
      "id": "athletics",
      "name": "Athletics",
      "description": "Physical feats of strength, climbing, jumping, and swimming.",
      "primaryAttribute": "might",
      "secondaryAttribute": "fortitude",
      "baseDicePool": "1d10",
      "allowUntrained": true,
      "untrainedPenalty": 0,
      "category": "Physical",
      "tags": ["physical", "strength"]
    },
    {
      "id": "acrobatics",
      "name": "Acrobatics",
      "description": "Balance, tumbling, and agile maneuvers.",
      "primaryAttribute": "finesse",
      "baseDicePool": "1d10",
      "allowUntrained": true,
      "untrainedPenalty": 0,
      "category": "Physical",
      "tags": ["physical", "agility"]
    },
    {
      "id": "stealth",
      "name": "Stealth",
      "description": "Moving silently and remaining hidden.",
      "primaryAttribute": "finesse",
      "secondaryAttribute": "wits",
      "baseDicePool": "1d10",
      "allowUntrained": true,
      "untrainedPenalty": 0,
      "category": "Physical",
      "tags": ["physical", "sneaking"]
    },
    {
      "id": "perception",
      "name": "Perception",
      "description": "Noticing hidden things, spotting danger, and awareness.",
      "primaryAttribute": "wits",
      "baseDicePool": "1d10",
      "allowUntrained": true,
      "untrainedPenalty": 0,
      "category": "Mental",
      "tags": ["mental", "awareness"]
    },
    {
      "id": "investigation",
      "name": "Investigation",
      "description": "Searching for clues, deducing information, and solving puzzles.",
      "primaryAttribute": "wits",
      "secondaryAttribute": "will",
      "baseDicePool": "1d10",
      "allowUntrained": true,
      "untrainedPenalty": 0,
      "category": "Mental",
      "tags": ["mental", "intellect"]
    },
    {
      "id": "lockpicking",
      "name": "Lockpicking",
      "description": "Opening locks without the key.",
      "primaryAttribute": "finesse",
      "baseDicePool": "1d10",
      "allowUntrained": false,
      "untrainedPenalty": 5,
      "category": "Specialty",
      "tags": ["specialty", "tools"]
    },
    {
      "id": "intimidation",
      "name": "Intimidation",
      "description": "Frightening or coercing others through threats.",
      "primaryAttribute": "might",
      "secondaryAttribute": "will",
      "baseDicePool": "1d10",
      "allowUntrained": true,
      "untrainedPenalty": 0,
      "category": "Social",
      "tags": ["social", "influence"]
    },
    {
      "id": "persuasion",
      "name": "Persuasion",
      "description": "Convincing others through charm and logic.",
      "primaryAttribute": "will",
      "secondaryAttribute": "wits",
      "baseDicePool": "1d10",
      "allowUntrained": true,
      "untrainedPenalty": 0,
      "category": "Social",
      "tags": ["social", "influence"]
    },
    {
      "id": "arcana",
      "name": "Arcana",
      "description": "Knowledge of magic, runes, and supernatural phenomena.",
      "primaryAttribute": "will",
      "baseDicePool": "1d10",
      "allowUntrained": false,
      "untrainedPenalty": 5,
      "category": "Knowledge",
      "tags": ["knowledge", "magic"]
    },
    {
      "id": "endurance",
      "name": "Endurance",
      "description": "Resisting poison, disease, and physical exhaustion.",
      "primaryAttribute": "fortitude",
      "baseDicePool": "1d10",
      "allowUntrained": true,
      "untrainedPenalty": 0,
      "category": "Physical",
      "tags": ["physical", "resilience"]
    }
  ]
}
```

### config/difficulty.json

```json
{
  "$schema": "difficulty.schema.json",
  "difficultyClasses": [
    {
      "id": "trivial",
      "name": "Trivial",
      "description": "Almost anyone can do this.",
      "targetNumber": 3,
      "color": "#88FF88",
      "sortOrder": 1
    },
    {
      "id": "easy",
      "name": "Easy",
      "description": "A simple task for someone with basic ability.",
      "targetNumber": 5,
      "color": "#44DD44",
      "sortOrder": 2
    },
    {
      "id": "moderate",
      "name": "Moderate",
      "description": "Requires some skill or effort.",
      "targetNumber": 8,
      "color": "#FFFF44",
      "sortOrder": 3
    },
    {
      "id": "challenging",
      "name": "Challenging",
      "description": "Difficult for most people.",
      "targetNumber": 10,
      "color": "#FFAA44",
      "sortOrder": 4
    },
    {
      "id": "hard",
      "name": "Hard",
      "description": "Only skilled individuals succeed reliably.",
      "targetNumber": 12,
      "color": "#FF6644",
      "sortOrder": 5
    },
    {
      "id": "very_hard",
      "name": "Very Hard",
      "description": "Even experts struggle.",
      "targetNumber": 15,
      "color": "#FF4444",
      "sortOrder": 6
    },
    {
      "id": "heroic",
      "name": "Heroic",
      "description": "A legendary feat.",
      "targetNumber": 18,
      "color": "#FF00FF",
      "sortOrder": 7
    },
    {
      "id": "impossible",
      "name": "Nearly Impossible",
      "description": "Only the most exceptional can hope to succeed.",
      "targetNumber": 22,
      "color": "#8800FF",
      "sortOrder": 8
    }
  ]
}
```

### IGameConfigurationProvider Extensions

```csharp
// Add to IGameConfigurationProvider interface:
SkillDefinition? GetSkillById(string skillId);
IReadOnlyList<SkillDefinition> GetSkills();
DifficultyClassDefinition? GetDifficultyClassById(string difficultyClassId);
IReadOnlyList<DifficultyClassDefinition> GetDifficultyClasses();
```

---

## Logging Strategy

### Log Levels by Operation

| Operation | Level | Template |
|-----------|-------|----------|
| Service initialization | Information | "SkillCheckService initialized" |
| Check request | Debug | "Performing skill check: Player={Player}, Skill={Skill}, DC={DC}, Advantage={Advantage}" |
| Attribute calculation | Debug | "Attribute bonus for {Skill}: Primary={Primary}, Secondary={Secondary}, Total={Total}" |
| Untrained penalty | Debug | "Applying untrained penalty: {Penalty}" |
| Dice roll delegation | Debug | "Rolling {DicePool} for skill check" |
| Check complete | Information | "Skill check complete: {Result}" |
| Critical result | Information | "{CriticalType} on {Skill}!" |
| Skill not found | Warning | "Unknown skill: {SkillId}" |
| DC not found | Warning | "Unknown difficulty class: {DifficultyClassId}" |

### Structured Logging Examples

```csharp
_logger.LogDebug(
    "Performing skill check: Player={Player}, Skill={Skill}, DC={DC}, Advantage={Advantage}",
    player.Name, skillId, difficultyClassId, advantageType);

_logger.LogDebug(
    "Attribute bonus for {Skill}: Primary={PrimaryAttr}={PrimaryValue}, Secondary={SecondaryAttr}={SecondaryValue}, Total={TotalBonus}",
    skill.Name,
    skill.PrimaryAttribute, primaryBonus,
    skill.SecondaryAttribute ?? "none", secondaryBonus,
    totalBonus);

_logger.LogInformation(
    "Skill check complete: Skill={Skill} Roll={Roll} Bonus={Bonus} Total={Total} DC={DC} Result={Result}",
    skillId, rollResult.Total, attributeBonus, totalResult, dc.TargetNumber, result.SuccessLevel);

if (result.IsCritical)
{
    _logger.LogInformation(
        "{CriticalType} on {Skill}!",
        result.SuccessLevel == SuccessLevel.CriticalSuccess ? "Critical success" : "Critical failure",
        skillId);
}
```

---

## Testing Strategy

### Test File Structure

```
tests/
├── RuneAndRust.Domain.UnitTests/
│   ├── Definitions/
│   │   ├── SkillDefinitionTests.cs          (~5 tests)
│   │   └── DifficultyClassDefinitionTests.cs (~3 tests)
│   └── ValueObjects/
│       └── SkillCheckResultTests.cs          (~5 tests)
└── RuneAndRust.Application.UnitTests/
    └── Services/
        └── SkillCheckServiceTests.cs         (~7 tests)
```

### SkillDefinitionTests (~5 tests)

| Test Name | Category | Description |
|-----------|----------|-------------|
| Create_WithValidData_CreatesDefinition | Construction | Valid skill creation |
| Create_WithMissingId_ThrowsArgumentException | Validation | Required field validation |
| Create_WithMissingName_ThrowsArgumentException | Validation | Required field validation |
| Create_WithMissingPrimaryAttribute_ThrowsArgumentException | Validation | Required field validation |
| Create_WithOptionalSecondary_SetsValue | Optional | Secondary attribute handling |

### DifficultyClassDefinitionTests (~3 tests)

| Test Name | Category | Description |
|-----------|----------|-------------|
| Create_WithValidData_CreatesDefinition | Construction | Valid DC creation |
| Create_WithMissingId_ThrowsArgumentException | Validation | Required field validation |
| Create_WithZeroTargetNumber_ThrowsArgumentOutOfRangeException | Validation | DC minimum validation |

### SkillCheckResultTests (~5 tests)

| Test Name | Category | Description |
|-----------|----------|-------------|
| Constructor_WithNaturalOne_SetsCriticalFailure | Critical | Natural 1 handling |
| Constructor_WithNaturalTen_SetsCriticalSuccess | Critical | Natural 10 handling |
| Constructor_WithTotalAboveDC_SetsSuccess | Success | Normal success |
| Constructor_WithTotalBelowDC_SetsFailure | Failure | Normal failure |
| Margin_CalculatesCorrectly | Computed | Margin calculation |

### SkillCheckServiceTests (~7 tests)

| Test Name | Category | Description |
|-----------|----------|-------------|
| PerformCheck_WithValidSkill_ReturnsResult | Happy path | Basic skill check |
| PerformCheck_WithUnknownSkill_ThrowsArgumentException | Error | Unknown skill handling |
| PerformCheck_WithUnknownDC_ThrowsArgumentException | Error | Unknown DC handling |
| PerformCheck_CalculatesAttributeBonus | Bonus | Primary attribute bonus |
| PerformCheck_WithSecondaryAttribute_AddsHalfBonus | Bonus | Secondary attribute bonus |
| PerformCheck_WithUntrainedSkill_AppliesPenalty | Penalty | Untrained penalty |
| PerformCheck_WithAdvantage_PassesToDiceService | Advantage | Advantage delegation |

### Test Patterns

#### Pattern 1: Mocking Configuration Provider
```csharp
[Test]
public void PerformCheck_WithValidSkill_ReturnsResult()
{
    // Arrange
    var skill = SkillDefinition.Create(
        "perception", "Perception", "Notice things", "wits");
    var dc = DifficultyClassDefinition.Create(
        "moderate", "Moderate", "Requires effort", 8);

    _mockConfig.Setup(c => c.GetSkillById("perception")).Returns(skill);
    _mockConfig.Setup(c => c.GetDifficultyClassById("moderate")).Returns(dc);

    var player = CreateTestPlayer(wits: 4);

    // Act
    var result = _service.PerformCheck(player, "perception", "moderate");

    // Assert
    result.SkillId.Should().Be("perception");
    result.DifficultyClass.Should().Be(8);
    result.AttributeBonus.Should().Be(4);
}
```

#### Pattern 2: Deterministic Dice Testing
```csharp
[Test]
public void PerformCheck_WithNaturalTen_ReturnsCriticalSuccess()
{
    // Arrange - seed random to produce natural 10
    var seededRandom = new Random(/* seed that produces 10 */);
    var diceService = new DiceService(_mockLogger.Object, seededRandom);
    var service = new SkillCheckService(diceService, _mockConfig.Object, _mockServiceLogger.Object);

    SetupSkillAndDC();

    // Act
    var result = service.PerformCheck(_player, "perception", "heroic");

    // Assert
    result.SuccessLevel.Should().Be(SuccessLevel.CriticalSuccess);
    result.DiceResult.IsNaturalMax.Should().BeTrue();
}
```

#### Pattern 3: Attribute Bonus Testing
```csharp
[Test]
public void PerformCheck_WithSecondaryAttribute_AddsHalfBonus()
{
    // Arrange
    var skill = SkillDefinition.Create(
        "athletics", "Athletics", "Physical feats",
        primaryAttribute: "might",
        secondaryAttribute: "fortitude");

    _mockConfig.Setup(c => c.GetSkillById("athletics")).Returns(skill);

    var player = CreateTestPlayer(might: 5, fortitude: 4);

    // Act
    var result = _service.PerformCheck(player, "athletics", "moderate");

    // Assert
    // Primary (5) + Secondary/2 (4/2=2) = 7
    result.AttributeBonus.Should().Be(7);
}
```

---

## Documentation Requirements

### Code Documentation

#### XML Documentation Required For:
- All public classes and interfaces
- All public methods and properties
- All public constructors

#### Example:
```csharp
/// <summary>
/// Performs a skill check for a player.
/// </summary>
/// <param name="player">The player making the check.</param>
/// <param name="skillId">The skill to check (e.g., "perception").</param>
/// <param name="difficultyClassId">The difficulty level (e.g., "moderate").</param>
/// <param name="advantageType">Optional advantage/disadvantage modifier.</param>
/// <param name="additionalBonus">Extra bonus from situational effects.</param>
/// <returns>The skill check result with complete breakdown.</returns>
/// <exception cref="ArgumentNullException">If player is null.</exception>
/// <exception cref="ArgumentException">If skill or difficulty class not found.</exception>
/// <example>
/// <code>
/// var result = skillCheckService.PerformCheck(player, "perception", "moderate");
/// if (result.IsSuccess)
/// {
///     Console.WriteLine($"You notice something! (by {result.Margin})");
/// }
/// </code>
/// </example>
public SkillCheckResult PerformCheck(
    Player player,
    string skillId,
    string difficultyClassId,
    AdvantageType advantageType = AdvantageType.Normal,
    int additionalBonus = 0)
```

### JSON Schema Files

Create schema files for configuration validation:

- `config/schemas/skills.schema.json`
- `config/schemas/difficulty.schema.json`

---

## Implementation Checklist

### Phase 5b Deliverables

#### Domain Layer
- [ ] Create `src/Core/RuneAndRust.Domain/Definitions/SkillDefinition.cs`
  - [ ] Properties (Id, Name, Description, PrimaryAttribute, etc.)
  - [ ] Static Create() factory method with validation
  - [ ] XML documentation
- [ ] Create `src/Core/RuneAndRust.Domain/Definitions/DifficultyClassDefinition.cs`
  - [ ] Properties (Id, Name, Description, TargetNumber, Color, SortOrder)
  - [ ] Static Create() factory method with validation
  - [ ] XML documentation
- [ ] Create `src/Core/RuneAndRust.Domain/ValueObjects/SkillCheckResult.cs`
  - [ ] Implement as readonly record struct
  - [ ] Constructor with success level determination
  - [ ] Computed properties (Margin, IsSuccess, IsCritical)
  - [ ] ToString() method
  - [ ] XML documentation

#### Application Layer
- [ ] Create `src/Core/RuneAndRust.Application/Services/SkillCheckService.cs`
  - [ ] Constructor with DI dependencies
  - [ ] PerformCheck() method
  - [ ] PerformCheckWithDC() method
  - [ ] GetAllSkills() method
  - [ ] GetDifficultyClasses() method
  - [ ] Private helper methods
  - [ ] Structured logging
  - [ ] XML documentation
- [ ] Create `src/Core/RuneAndRust.Application/DTOs/SkillCheckDtos.cs`
  - [ ] SkillCheckResultDto record
  - [ ] SkillDefinitionDto record
  - [ ] DifficultyClassDto record
  - [ ] FromDomainResult() factory methods
- [ ] Modify `src/Core/RuneAndRust.Application/Interfaces/IGameConfigurationProvider.cs`
  - [ ] Add GetSkillById()
  - [ ] Add GetSkills()
  - [ ] Add GetDifficultyClassById()
  - [ ] Add GetDifficultyClasses()

#### Infrastructure Layer
- [ ] Modify `src/Infrastructure/RuneAndRust.Infrastructure/Providers/JsonConfigurationProvider.cs`
  - [ ] Add skills loading from JSON
  - [ ] Add difficulty classes loading from JSON
  - [ ] Implement new interface methods

#### Configuration
- [ ] Create `config/skills.json` with 10 skills
- [ ] Create `config/difficulty.json` with 8 difficulty classes
- [ ] Optional: Create JSON schema files

#### Testing
- [ ] Create `tests/RuneAndRust.Domain.UnitTests/Definitions/SkillDefinitionTests.cs` (~5 tests)
- [ ] Create `tests/RuneAndRust.Domain.UnitTests/Definitions/DifficultyClassDefinitionTests.cs` (~3 tests)
- [ ] Create `tests/RuneAndRust.Domain.UnitTests/ValueObjects/SkillCheckResultTests.cs` (~5 tests)
- [ ] Create `tests/RuneAndRust.Application.UnitTests/Services/SkillCheckServiceTests.cs` (~7 tests)

#### Quality Gates
- [ ] All 20 new tests pass
- [ ] All existing tests still pass
- [ ] Build: 0 errors, 0 warnings
- [ ] Code review completed

---

## Acceptance Criteria

### Functional Criteria

| ID | Criterion | Verification |
|----|-----------|--------------|
| AC-1 | 10 skills defined in configuration | Config review |
| AC-2 | 8 difficulty classes defined | Config review |
| AC-3 | Skill checks use player attributes | Unit test |
| AC-4 | Primary attribute adds full value | Unit test |
| AC-5 | Secondary attribute adds half value | Unit test |
| AC-6 | Natural 10 = Critical Success | Unit test |
| AC-7 | Natural 1 = Critical Failure | Unit test |
| AC-8 | Untrained penalty applies correctly | Unit test |
| AC-9 | Advantage/disadvantage works | Unit test |
| AC-10 | Margin calculated correctly | Unit test |

### Technical Criteria

| ID | Criterion | Verification |
|----|-----------|--------------|
| TC-1 | 20 new tests created | Test count |
| TC-2 | All tests pass | CI/CD |
| TC-3 | Build has 0 errors | Build log |
| TC-4 | Build has 0 warnings | Build log |
| TC-5 | Structured logging implemented | Code review |
| TC-6 | XML documentation complete | Code review |

### Test Metrics

| Metric | Before 5b | After 5b |
|--------|-----------|----------|
| Domain Tests | ~135 | ~148 |
| Application Tests | ~67 | ~74 |
| **Total Tests** | ~210 | ~230 |

---

## Dependencies & Integration

### Dependencies on v0.0.5a

| Component | Dependency |
|-----------|------------|
| DicePool | Used for parsing BaseDicePool notation |
| DiceRollResult | Stored in SkillCheckResult |
| DiceService | Called for rolling dice |
| SuccessLevel | Enum used in SkillCheckResult |
| AdvantageType | Passed to DiceService.Roll() |

### Integration Points

#### IGameConfigurationProvider
New methods to add:
```csharp
SkillDefinition? GetSkillById(string skillId);
IReadOnlyList<SkillDefinition> GetSkills();
DifficultyClassDefinition? GetDifficultyClassById(string difficultyClassId);
IReadOnlyList<DifficultyClassDefinition> GetDifficultyClasses();
```

#### DependencyInjection.cs
Register SkillCheckService:
```csharp
services.AddScoped<SkillCheckService>();
```

### Forward Integration (5c, 5d)

Phase 5b components will be used by:
- **5c (Combat Integration):** Attack rolls as skill checks against monster defense
- **5d (Configuration & Polish):** `check <skill>` command, skill check rendering

---

## Summary

### Files to Create

| Layer | File | Purpose |
|-------|------|---------|
| Domain | `Definitions/SkillDefinition.cs` | Skill configuration entity |
| Domain | `Definitions/DifficultyClassDefinition.cs` | DC configuration entity |
| Domain | `ValueObjects/SkillCheckResult.cs` | Skill check result value object |
| Application | `Services/SkillCheckService.cs` | Skill check service |
| Application | `DTOs/SkillCheckDtos.cs` | DTOs for presentation |
| Config | `skills.json` | 10 skill definitions |
| Config | `difficulty.json` | 8 difficulty classes |
| Tests | 4 test files | ~20 tests |

### Files to Modify

| File | Changes |
|------|---------|
| `IGameConfigurationProvider.cs` | Add 4 new methods |
| `JsonConfigurationProvider.cs` | Implement skill/DC loading |
| `DependencyInjection.cs` | Register SkillCheckService |

### Key Metrics

| Metric | Value |
|--------|-------|
| New files | 9 |
| Modified files | 3 |
| New tests | ~20 |
| New skills | 10 |
| New difficulty classes | 8 |
