# v0.15.4i - Specialization Integration

**Release Date:** 2026-01-24

## Summary

Implements the **Bypass Specialization Integration System**, connecting character archetypes to System Bypass skills with unique abilities. Four bypass specializations are now available, each granting two abilities that modify how characters interact with locks, terminals, traps, and Old World technology.

## Bypass Specializations

| Specialization | Focus Areas | Abilities |
|----------------|-------------|-----------|
| **Scrap-Tinker** | Lockpicking, Tool Crafting | [Master Craftsman], [Relock] |
| **Ruin-Stalker** | Trap Disarmament | [Trap Artist], [Sixth Sense] |
| **Jötun-Reader** | Terminal Hacking, Glitch Exploitation | [Deep Access], [Pattern Recognition] |
| **Gantry-Runner** | All Bypass Systems (Speed/Pressure) | [Fast Pick], [Bypass Under Fire] |

## Specialization Abilities

### Scrap-Tinker

| Ability | Type | Effect |
|---------|------|--------|
| **[Master Craftsman]** | Triggered | Unlocks masterwork tool recipes, granting +1 bonus die on bypass attempts |
| **[Relock]** | Unique Action | Re-lock a previously picked lock (WITS DC 12) to slow pursuers |

### Ruin-Stalker

| Ability | Type | Effect |
|---------|------|--------|
| **[Trap Artist]** | Unique Action | Re-arm a disabled trap (WITS DC 14) as a defensive measure |
| **[Sixth Sense]** | Passive | Automatically detect traps within 10 feet without requiring a check |

### Jötun-Reader

| Ability | Type | Effect |
|---------|------|--------|
| **[Deep Access]** | Triggered | Any successful terminal hack automatically grants Admin-Level access |
| **[Pattern Recognition]** | Passive | Reduce [Glitched] DC penalty by 2 on all bypass attempts |

### Gantry-Runner

| Ability | Type | Effect |
|---------|------|--------|
| **[Fast Pick]** | Passive | All bypass attempts take 1 fewer round to complete (minimum 1 round) |
| **[Bypass Under Fire]** | Passive | Ignore all penalties when attempting bypass while in combat or under threat |

## Masterwork Recipes

Scrap-Tinkers with [Master Craftsman] can craft masterwork tools:

| Recipe | Bypass Type | DC | Bonus | Durability |
|--------|-------------|-----|-------|------------|
| Masterwork Shim Picks | Lockpicking | 14 | +1d10 | 10 uses |
| Masterwork Wire Probe | Terminal Hacking | 16 | +1d10 | 8 uses |
| Masterwork Trap Kit | Trap Disarmament | 15 | +1d10 | 6 uses |
| Masterwork Glitch Trigger | Glitch Exploitation | 18 | +1d10 | 4 uses |

## Added

### Enums

| Enum | Location | Purpose |
|------|----------|---------|
| `BypassSpecialization` | `Domain/Enums/` | Character specializations with bypass focus |
| `BypassAbilityType` | `Domain/Enums/` | Types of abilities (Passive, Triggered, UniqueAction) |
| `BypassTriggerCondition` | `Domain/Enums/` | Conditions that trigger abilities |
| `BypassEffectType` | `Domain/Enums/` | Types of effects abilities apply |
| `BypassPassiveBonusType` | `Domain/Enums/` | Types of passive bonuses |

### Value Objects

| Value Object | Location | Purpose |
|--------------|----------|---------|
| `BypassSpecializationAbility` | `Domain/ValueObjects/` | Specialization ability definition with factory methods |
| `BypassAbilityActivationResult` | `Domain/ValueObjects/` | Result of activating an ability |
| `MasterworkRecipe` | `Domain/ValueObjects/` | Masterwork tool recipe definition |
| `TrapDetectionResult` | `Domain/ValueObjects/` | Result of trap detection via [Sixth Sense] |
| `DetectedTrap` | `Domain/ValueObjects/` | Information about a detected trap |
| `BypassAbilityContext` | `Domain/Interfaces/` | Passive modifiers for a bypass attempt |
| `TrapInfo` | `Domain/Interfaces/` | Trap information for detection |

### Services

| Service | Location | Purpose |
|---------|----------|---------|
| `IBypassSpecializationAbilityService` | `Domain/Interfaces/` | Interface for bypass specialization abilities |
| `BypassSpecializationAbilityService` | `Application/Services/` | Implementation of bypass specialization abilities |

### Configuration

| File | Location | Purpose |
|------|----------|---------|
| `bypass-specializations.json` | `config/system-bypass/` | Specialization ability definitions |
| `bypass-specializations.schema.json` | `config/schemas/` | JSON schema for validation |

### Tests

| Test Class | Purpose |
|------------|---------|
| `BypassSpecializationAbilityServiceTests` | Unit tests for specialization ability service |

## Files Created

```
src/Core/RuneAndRust.Domain/Enums/
├── BypassSpecialization.cs
├── BypassAbilityType.cs
├── BypassTriggerCondition.cs
├── BypassEffectType.cs
└── BypassPassiveBonusType.cs

src/Core/RuneAndRust.Domain/ValueObjects/
├── BypassSpecializationAbility.cs
├── BypassAbilityActivationResult.cs
├── MasterworkRecipe.cs
└── TrapDetectionResult.cs

src/Core/RuneAndRust.Domain/Interfaces/
└── IBypassSpecializationAbilityService.cs

src/Core/RuneAndRust.Application/Services/
└── BypassSpecializationAbilityService.cs

config/system-bypass/
└── bypass-specializations.json

config/schemas/
└── bypass-specializations.schema.json

tests/RuneAndRust.Application.UnitTests/Services/
└── BypassSpecializationAbilityServiceTests.cs

docs/changelogs/
└── v0.15.4i-changelog.md
```

**Total Files:** 14

## Key Design Decisions

### 1. Separate Service from Existing SpecializationAbilityService

The existing `SpecializationAbilityService` handles Acrobatics-related abilities (Gantry-Runner movement, Myrk-gengr stealth). To maintain separation of concerns, a new `BypassSpecializationAbilityService` was created specifically for System Bypass abilities.

### 2. Passive Ability Context Pattern

Instead of modifying existing bypass services directly, the `GetPassiveModifiers()` method returns a `BypassAbilityContext` that can be applied by the calling service. This maintains loose coupling between the specialization system and individual bypass services.

### 3. Value Object Static Factory Methods

Each ability and recipe uses static factory methods (`BypassSpecializationAbility.FastPick()`, `MasterworkRecipe.ShimPicks()`) to ensure consistent definition across the codebase. The `GetAbilitiesFor()` and `GetAll()` methods provide convenient queries.

### 4. Unique Action Validation

Unique actions ([Relock], [Trap Artist]) require specific preconditions:
- The target must have been previously bypassed (lock picked, trap disabled)
- This is tracked by the service to prevent abuse

### 5. Triggered Ability Auto-Fire

Triggered abilities like [Deep Access] fire automatically when their conditions are met. The service integrates with bypass outcome reporting via `TryTriggerAbility()`.

## Integration Points

This version integrates with:

| Version | System | Integration |
|---------|--------|-------------|
| v0.15.4a | Lockpicking | [Relock], [Master Craftsman], [Fast Pick] |
| v0.15.4b | Terminal Hacking | [Deep Access], [Fast Pick] |
| v0.15.4d | Trap Disarmament | [Trap Artist], [Sixth Sense], [Fast Pick] |
| v0.15.4f | Glitch Exploitation | [Pattern Recognition] |
| v0.15.4g | Improvised Tool Crafting | [Master Craftsman] masterwork recipes |

## Dependencies

- `IDiceService` - For unique action checks
- `ILogger<T>` - For exhaustive logging

## Breaking Changes

None. This is an additive feature.

## Acceptance Criteria

### Functional

- [x] Four bypass specializations defined (Scrap-Tinker, Ruin-Stalker, Jötun-Reader, Gantry-Runner)
- [x] Eight abilities implemented (2 per specialization)
- [x] Passive abilities apply correct modifiers
- [x] [Fast Pick] reduces bypass time by 1 round
- [x] [Pattern Recognition] reduces [Glitched] DC penalty by 2
- [x] [Bypass Under Fire] negates combat penalties
- [x] [Sixth Sense] auto-detects traps within 10 feet
- [x] [Deep Access] triggers on terminal hack success
- [x] [Master Craftsman] unlocks masterwork recipes
- [x] [Relock] requires WITS DC 12 check
- [x] [Trap Artist] requires WITS DC 14 check
- [x] Masterwork recipes require specific components

### Quality

- [x] Build succeeds with 0 errors/warnings
- [x] Unit tests pass
- [x] Configuration files created and valid
- [x] JSON schema created for validation
- [x] XML documentation complete for all public types
- [x] Exhaustive logging at appropriate levels
