# v0.7.1b Design Specification: Player Status Panel

**Version:** 0.7.1b
**Parent:** v0.7.1 (Core Display Panels)
**Prerequisites:** v0.7.1a Complete (Room Display Panel)
**Status:** Design Complete
**Estimated Unit Tests:** ~9

---

## Table of Contents

1. [Overview](#1-overview)
2. [Feature Overview](#2-feature-overview)
3. [Architecture](#3-architecture)
4. [Player Status Panel](#4-player-status-panel)
5. [Player Status ViewModel](#5-player-status-viewmodel)
6. [Health Bar Control](#6-health-bar-control)
7. [Supporting ViewModels](#7-supporting-viewmodels)
8. [Value Converters](#8-value-converters)
9. [Styles](#9-styles)
10. [Data Model Changes](#10-data-model-changes)
11. [Logging Specifications](#11-logging-specifications)
12. [Unit Testing Requirements](#12-unit-testing-requirements)
13. [Use Cases](#13-use-cases)
14. [Deliverable Checklist](#14-deliverable-checklist)
15. [Acceptance Criteria](#15-acceptance-criteria)
16. [Dependencies](#16-dependencies)
17. [Future Considerations](#17-future-considerations)

---

## 1. Overview

### Purpose

This phase implements the player status panel that displays character information, HP/MP/XP bars with visual fill indicators, all character stats with modifiers, and currently equipped items. This provides at-a-glance player state in the RightSidebarTop region of the GameWindow.

### Key Deliverables

| Category | Items |
|----------|-------|
| **User Controls** | `PlayerStatusPanel`, `HealthBarControl` |
| **ViewModels** | `PlayerStatusViewModel`, `StatViewModel`, `EquipmentSlotViewModel` |
| **Converters** | `HealthToColorConverter`, `ModifierToStringConverter` |
| **Enums** | `BarType` |
| **Styles** | `StatusPanelStyles.axaml` |
| **Tests** | ~9 unit tests |

### Design Principles

1. **At-a-Glance Status**: Critical info immediately visible
2. **Color-Coded Health**: Visual urgency through color thresholds
3. **Compact Layout**: Efficient use of sidebar space
4. **Reactive Updates**: Panel updates when player state changes

---

## 2. Feature Overview

```
v0.7.1b Features
â”œâ”€â”€ Player Status Panel (UserControl)
â”‚   â”œâ”€â”€ Character name and class
â”‚   â”œâ”€â”€ Level display
â”‚   â”œâ”€â”€ HP bar with color thresholds
â”‚   â”œâ”€â”€ MP/Mana bar
â”‚   â”œâ”€â”€ XP bar with level progress
â”‚   â”œâ”€â”€ Stats section (6 attributes)
â”‚   â”œâ”€â”€ Equipment slots section
â”‚   â”œâ”€â”€ Gold display
â”‚   â””â”€â”€ Current location
â”œâ”€â”€ Health Bar Control (TemplatedControl)
â”‚   â”œâ”€â”€ CurrentValue / MaxValue properties
â”‚   â”œâ”€â”€ BarType property (Health, Mana, XP)
â”‚   â”œâ”€â”€ Label property
â”‚   â”œâ”€â”€ FillPercentage calculation
â”‚   â””â”€â”€ Color threshold logic
â”œâ”€â”€ Player Status ViewModel
â”‚   â”œâ”€â”€ Character info binding
â”‚   â”œâ”€â”€ HP/MP/XP binding
â”‚   â”œâ”€â”€ Stats collection
â”‚   â”œâ”€â”€ Equipment collection
â”‚   â””â”€â”€ Gold/Location binding
â”œâ”€â”€ Supporting ViewModels
â”‚   â”œâ”€â”€ StatViewModel (name, value, modifier)
â”‚   â””â”€â”€ EquipmentSlotViewModel (slot, item)
â””â”€â”€ Value Converters
    â”œâ”€â”€ HealthToColorConverter
    â””â”€â”€ ModifierToStringConverter
```

---

## 3. Architecture

### Component Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       PRESENTATION LAYER                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  VIEWS                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     PlayerStatusPanel                              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ - CharacterInfoSection (Name, Class, Level)                       â”‚ â”‚
â”‚  â”‚ - BarsSection (HP, MP, XP HealthBarControls)                      â”‚ â”‚
â”‚  â”‚ - StatsSection (6 attributes with modifiers)                      â”‚ â”‚
â”‚  â”‚ - EquipmentSection (5 slots)                                      â”‚ â”‚
â”‚  â”‚ - FooterSection (Gold, Location)                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                   â”‚ DataContext                        â”‚
â”‚                                   â–¼                                    â”‚
â”‚  VIEWMODELS                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                  PlayerStatusViewModel                             â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ + PlayerName: string                                              â”‚ â”‚
â”‚  â”‚ + ClassName: string                                               â”‚ â”‚
â”‚  â”‚ + Level: int                                                      â”‚ â”‚
â”‚  â”‚ + CurrentHp / MaxHp: int                                          â”‚ â”‚
â”‚  â”‚ + CurrentMp / MaxMp: int                                          â”‚ â”‚
â”‚  â”‚ + CurrentXp / XpToNextLevel: int                                  â”‚ â”‚
â”‚  â”‚ + Stats: ObservableCollection<StatViewModel>                      â”‚ â”‚
â”‚  â”‚ + Equipment: ObservableCollection<EquipmentSlotViewModel>         â”‚ â”‚
â”‚  â”‚ + Gold: int                                                       â”‚ â”‚
â”‚  â”‚ + LocationName: string                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  CUSTOM CONTROLS                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     HealthBarControl                               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ + CurrentValue: int (StyledProperty)                              â”‚ â”‚
â”‚  â”‚ + MaxValue: int (StyledProperty)                                  â”‚ â”‚
â”‚  â”‚ + BarType: BarType (StyledProperty)                               â”‚ â”‚
â”‚  â”‚ + Label: string (StyledProperty)                                  â”‚ â”‚
â”‚  â”‚ + FillPercentage: double (computed)                               â”‚ â”‚
â”‚  â”‚ + FillBrush: IBrush (computed)                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  SUPPORTING VIEWMODELS                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      StatViewModel          â”‚  â”‚   EquipmentSlotViewModel        â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ + Name: string              â”‚  â”‚ + SlotName: string              â”‚ â”‚
â”‚  â”‚ + Abbreviation: string      â”‚  â”‚ + SlotIcon: string              â”‚ â”‚
â”‚  â”‚ + Value: int                â”‚  â”‚ + ItemName: string              â”‚ â”‚
â”‚  â”‚ + Modifier: int             â”‚  â”‚ + ItemBonus: string             â”‚ â”‚
â”‚  â”‚ + DisplayValue: string      â”‚  â”‚ + IsEmpty: bool                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         APPLICATION LAYER                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                      IGameSessionService                           â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ + OnPlayerChanged: event                                           â”‚â”‚
â”‚  â”‚ + OnRoomChanged: event                                             â”‚â”‚
â”‚  â”‚ + CurrentPlayer: Player                                            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       PLAYER UPDATE FLOW                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Player takes damage / gains XP / equips item
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  GameSessionService.OnPlayerChanged                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Raises event with updated Player entity                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            PlayerStatusViewModel.HandlePlayerChanged(player)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Update Name, Class, Level                                          â”‚
â”‚  2. Update HP, MP, XP values                                           â”‚
â”‚  3. Update Stats collection                                            â”‚
â”‚  4. Update Equipment collection                                        â”‚
â”‚  5. Update Gold                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PlayerStatusPanel (UI Updates)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - HealthBarControls update fill and color                             â”‚
â”‚  - Stats display with modifiers                                        â”‚
â”‚  - Equipment slots show items or "None"                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Player Status Panel

### Panel Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          PLAYER STATUS                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                       â”‚
â”‚  âš” Hero                               â”‚
â”‚  Level 5 Warrior                      â”‚
â”‚                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  HP â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  65/100    â”‚
â”‚  MP â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  30/100    â”‚
â”‚  XP â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  550/1000  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ STATS                           â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ STR: 16 (+3)    DEX: 14 (+2)   â”‚  â”‚
â”‚  â”‚ CON: 15 (+2)    INT: 10 (+0)   â”‚  â”‚
â”‚  â”‚ WIS: 12 (+1)    CHA: 11 (+0)   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ EQUIPPED                        â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ âš” Weapon: Iron Sword (+4 atk)  â”‚  â”‚
â”‚  â”‚ ğŸ›¡ Armor:  Leather (+2 def)    â”‚  â”‚
â”‚  â”‚ ğŸ›¡ Shield: None                â”‚  â”‚
â”‚  â”‚ ğŸ’ Ring:   Ring of Protection  â”‚  â”‚
â”‚  â”‚ ğŸ“¿ Amulet: None                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° Gold: 150                         â”‚
â”‚  ğŸ“ Location: Dark Cave               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### XAML Implementation

**File:** `src/Presentation/RuneAndRust.Avalonia/Controls/PlayerStatusPanel.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:RuneAndRust.Avalonia.ViewModels"
             xmlns:ctrl="using:RuneAndRust.Avalonia.Controls"
             xmlns:conv="using:RuneAndRust.Avalonia.Converters"
             x:Class="RuneAndRust.Avalonia.Controls.PlayerStatusPanel"
             x:DataType="vm:PlayerStatusViewModel">
    
    <UserControl.Resources>
        <conv:ModifierToStringConverter x:Key="ModifierToString" />
    </UserControl.Resources>
    
    <Design.DataContext>
        <vm:PlayerStatusViewModel />
    </Design.DataContext>
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Spacing="12" Margin="8">
            
            <!-- Character Info Section -->
            <Border Classes="panel" Padding="12">
                <StackPanel Spacing="4">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock Text="âš”" FontSize="18" />
                        <TextBlock Text="{Binding PlayerName}"
                                   Classes="heading" />
                    </StackPanel>
                    <TextBlock Classes="secondary">
                        <Run Text="Level " />
                        <Run Text="{Binding Level}" />
                        <Run Text=" " />
                        <Run Text="{Binding ClassName}" />
                    </TextBlock>
                </StackPanel>
            </Border>
            
            <!-- Resource Bars Section -->
            <Border Classes="panel" Padding="12">
                <StackPanel Spacing="8">
                    <ctrl:HealthBarControl Label="HP"
                                           BarType="Health"
                                           CurrentValue="{Binding CurrentHp}"
                                           MaxValue="{Binding MaxHp}" />
                    
                    <ctrl:HealthBarControl Label="MP"
                                           BarType="Mana"
                                           CurrentValue="{Binding CurrentMp}"
                                           MaxValue="{Binding MaxMp}" />
                    
                    <ctrl:HealthBarControl Label="XP"
                                           BarType="Experience"
                                           CurrentValue="{Binding CurrentXp}"
                                           MaxValue="{Binding XpToNextLevel}" />
                </StackPanel>
            </Border>
            
            <!-- Stats Section -->
            <Border Classes="panel" Padding="12">
                <StackPanel>
                    <TextBlock Text="STATS" Classes="secondary" FontWeight="SemiBold"
                               Margin="0,0,0,8" />
                    <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto">
                        <!-- Row 0 -->
                        <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="STR: " Classes="muted" Width="40" />
                            <TextBlock Text="{Binding Strength}" Classes="body" Width="25" />
                            <TextBlock Text="{Binding StrengthModifier, Converter={StaticResource ModifierToString}}"
                                       Classes="stat-modifier" />
                        </StackPanel>
                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="DEX: " Classes="muted" Width="40" />
                            <TextBlock Text="{Binding Dexterity}" Classes="body" Width="25" />
                            <TextBlock Text="{Binding DexterityModifier, Converter={StaticResource ModifierToString}}"
                                       Classes="stat-modifier" />
                        </StackPanel>
                        
                        <!-- Row 1 -->
                        <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="CON: " Classes="muted" Width="40" />
                            <TextBlock Text="{Binding Constitution}" Classes="body" Width="25" />
                            <TextBlock Text="{Binding ConstitutionModifier, Converter={StaticResource ModifierToString}}"
                                       Classes="stat-modifier" />
                        </StackPanel>
                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="INT: " Classes="muted" Width="40" />
                            <TextBlock Text="{Binding Intelligence}" Classes="body" Width="25" />
                            <TextBlock Text="{Binding IntelligenceModifier, Converter={StaticResource ModifierToString}}"
                                       Classes="stat-modifier" />
                        </StackPanel>
                        
                        <!-- Row 2 -->
                        <StackPanel Grid.Row="2" Grid.Column="0" Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="WIS: " Classes="muted" Width="40" />
                            <TextBlock Text="{Binding Wisdom}" Classes="body" Width="25" />
                            <TextBlock Text="{Binding WisdomModifier, Converter={StaticResource ModifierToString}}"
                                       Classes="stat-modifier" />
                        </StackPanel>
                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="CHA: " Classes="muted" Width="40" />
                            <TextBlock Text="{Binding Charisma}" Classes="body" Width="25" />
                            <TextBlock Text="{Binding CharismaModifier, Converter={StaticResource ModifierToString}}"
                                       Classes="stat-modifier" />
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>
            
            <!-- Equipment Section -->
            <Border Classes="panel" Padding="12">
                <StackPanel>
                    <TextBlock Text="EQUIPPED" Classes="secondary" FontWeight="SemiBold"
                               Margin="0,0,0,8" />
                    <ItemsControl ItemsSource="{Binding Equipment}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid ColumnDefinitions="24,70,*" Margin="0,2">
                                    <TextBlock Grid.Column="0" Text="{Binding SlotIcon}" />
                                    <TextBlock Grid.Column="1" Text="{Binding SlotName}"
                                               Classes="muted" />
                                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                                        <TextBlock Text="{Binding ItemName}"
                                                   Classes="body"
                                                   Foreground="{Binding IsEmpty, Converter={StaticResource BoolToMutedConverter}}" />
                                        <TextBlock Text="{Binding ItemBonus}"
                                                   Classes="stat-bonus"
                                                   IsVisible="{Binding HasBonus}"
                                                   Margin="4,0,0,0" />
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>
            
            <!-- Footer Section -->
            <Border Classes="panel" Padding="12">
                <StackPanel Spacing="4">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock Text="ğŸ’°" />
                        <TextBlock Text="Gold:" Classes="muted" />
                        <TextBlock Text="{Binding Gold}" Classes="body" Foreground="{StaticResource GoldColor}" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock Text="ğŸ“" />
                        <TextBlock Text="Location:" Classes="muted" />
                        <TextBlock Text="{Binding LocationName}" Classes="body" />
                    </StackPanel>
                </StackPanel>
            </Border>
            
        </StackPanel>
    </ScrollViewer>
</UserControl>
```

**File:** `src/Presentation/RuneAndRust.Avalonia/Controls/PlayerStatusPanel.axaml.cs`

```csharp
namespace RuneAndRust.Avalonia.Controls;

using global::Avalonia.Controls;

/// <summary>
/// Panel control displaying the player's status.
/// </summary>
public partial class PlayerStatusPanel : UserControl
{
    public PlayerStatusPanel()
    {
        InitializeComponent();
    }
}
```

---

## 5. Player Status ViewModel

**File:** `src/Presentation/RuneAndRust.Avalonia/ViewModels/PlayerStatusViewModel.cs`

```csharp
namespace RuneAndRust.Avalonia.ViewModels;

using CommunityToolkit.Mvvm.ComponentModel;
using RuneAndRust.Application.Interfaces;
using RuneAndRust.Domain.Entities;
using System.Collections.ObjectModel;
using Serilog;

/// <summary>
/// View model for the player status panel.
/// </summary>
public partial class PlayerStatusViewModel : ViewModelBase
{
    private readonly IGameSessionService? _gameSession;

    // Character Info
    [ObservableProperty]
    private string _playerName = "Unknown";

    [ObservableProperty]
    private string _className = "Adventurer";

    [ObservableProperty]
    private int _level = 1;

    // Resource Bars
    [ObservableProperty]
    private int _currentHp = 100;

    [ObservableProperty]
    private int _maxHp = 100;

    [ObservableProperty]
    private int _currentMp;

    [ObservableProperty]
    private int _maxMp;

    [ObservableProperty]
    private int _currentXp;

    [ObservableProperty]
    private int _xpToNextLevel = 100;

    // Stats
    [ObservableProperty]
    private int _strength = 10;

    [ObservableProperty]
    private int _strengthModifier;

    [ObservableProperty]
    private int _dexterity = 10;

    [ObservableProperty]
    private int _dexterityModifier;

    [ObservableProperty]
    private int _constitution = 10;

    [ObservableProperty]
    private int _constitutionModifier;

    [ObservableProperty]
    private int _intelligence = 10;

    [ObservableProperty]
    private int _intelligenceModifier;

    [ObservableProperty]
    private int _wisdom = 10;

    [ObservableProperty]
    private int _wisdomModifier;

    [ObservableProperty]
    private int _charisma = 10;

    [ObservableProperty]
    private int _charismaModifier;

    // Equipment
    [ObservableProperty]
    private ObservableCollection<EquipmentSlotViewModel> _equipment = new();

    // Footer
    [ObservableProperty]
    private int _gold;

    [ObservableProperty]
    private string _locationName = "Unknown";

    /// <summary>
    /// Creates a new PlayerStatusViewModel with game session.
    /// </summary>
    public PlayerStatusViewModel(IGameSessionService gameSession)
    {
        _gameSession = gameSession;
        _gameSession.OnPlayerChanged += HandlePlayerChanged;
        _gameSession.OnRoomChanged += room => LocationName = room.Name;

        InitializeEquipmentSlots();

        // Initialize with current player if available
        if (_gameSession.CurrentPlayer is not null)
        {
            HandlePlayerChanged(_gameSession.CurrentPlayer);
        }
    }

    /// <summary>
    /// Design-time constructor.
    /// </summary>
    public PlayerStatusViewModel()
    {
        // Design-time sample data
        PlayerName = "Hero";
        ClassName = "Warrior";
        Level = 5;
        CurrentHp = 65;
        MaxHp = 100;
        CurrentMp = 30;
        MaxMp = 100;
        CurrentXp = 550;
        XpToNextLevel = 1000;
        Strength = 16;
        StrengthModifier = 3;
        Dexterity = 14;
        DexterityModifier = 2;
        Constitution = 15;
        ConstitutionModifier = 2;
        Intelligence = 10;
        IntelligenceModifier = 0;
        Wisdom = 12;
        WisdomModifier = 1;
        Charisma = 11;
        CharismaModifier = 0;
        Gold = 150;
        LocationName = "Dark Cave";

        InitializeEquipmentSlots();
        Equipment[0] = new EquipmentSlotViewModel("Weapon", "âš”", "Iron Sword", "+4 atk");
        Equipment[1] = new EquipmentSlotViewModel("Armor", "ğŸ›¡", "Leather", "+2 def");
        Equipment[3] = new EquipmentSlotViewModel("Ring", "ğŸ’", "Ring of Protection", "+1 def");
    }

    private void InitializeEquipmentSlots()
    {
        Equipment.Clear();
        Equipment.Add(new EquipmentSlotViewModel("Weapon", "âš”"));
        Equipment.Add(new EquipmentSlotViewModel("Armor", "ğŸ›¡"));
        Equipment.Add(new EquipmentSlotViewModel("Shield", "ğŸ›¡"));
        Equipment.Add(new EquipmentSlotViewModel("Ring", "ğŸ’"));
        Equipment.Add(new EquipmentSlotViewModel("Amulet", "ğŸ“¿"));
    }

    private void HandlePlayerChanged(Player player)
    {
        Log.Debug("Player status updated for {PlayerName}", player.Name);

        PlayerName = player.Name;
        ClassName = player.Class?.Name ?? "Adventurer";
        Level = player.Level;

        // Update HP/MP/XP
        CurrentHp = player.Health;
        MaxHp = player.Stats.MaxHealth;
        CurrentMp = player.GetResource("mana")?.Current ?? 0;
        MaxMp = player.GetResource("mana")?.Max ?? 0;
        CurrentXp = player.Experience;
        XpToNextLevel = player.ExperienceToNextLevel;

        // Update stats
        UpdateStats(player);

        // Update equipment
        UpdateEquipment(player);

        Gold = player.Gold;
    }

    private void UpdateStats(Player player)
    {
        Strength = player.Stats.Strength;
        StrengthModifier = CalculateModifier(Strength);
        
        Dexterity = player.Stats.Dexterity;
        DexterityModifier = CalculateModifier(Dexterity);
        
        Constitution = player.Stats.Constitution;
        ConstitutionModifier = CalculateModifier(Constitution);
        
        Intelligence = player.Stats.Intelligence;
        IntelligenceModifier = CalculateModifier(Intelligence);
        
        Wisdom = player.Stats.Wisdom;
        WisdomModifier = CalculateModifier(Wisdom);
        
        Charisma = player.Stats.Charisma;
        CharismaModifier = CalculateModifier(Charisma);
    }

    private static int CalculateModifier(int statValue)
    {
        return (statValue - 10) / 2;
    }

    private void UpdateEquipment(Player player)
    {
        // Update weapon slot
        var weapon = player.GetEquippedItem("weapon");
        Equipment[0] = new EquipmentSlotViewModel("Weapon", "âš”", 
            weapon?.Name, weapon is not null ? $"+{weapon.AttackBonus} atk" : null);

        // Update armor slot
        var armor = player.GetEquippedItem("armor");
        Equipment[1] = new EquipmentSlotViewModel("Armor", "ğŸ›¡",
            armor?.Name, armor is not null ? $"+{armor.DefenseBonus} def" : null);

        // Update shield slot
        var shield = player.GetEquippedItem("shield");
        Equipment[2] = new EquipmentSlotViewModel("Shield", "ğŸ›¡",
            shield?.Name, shield is not null ? $"+{shield.DefenseBonus} def" : null);

        // Update ring slot
        var ring = player.GetEquippedItem("ring");
        Equipment[3] = new EquipmentSlotViewModel("Ring", "ğŸ’",
            ring?.Name, ring?.BonusDescription);

        // Update amulet slot
        var amulet = player.GetEquippedItem("amulet");
        Equipment[4] = new EquipmentSlotViewModel("Amulet", "ğŸ“¿",
            amulet?.Name, amulet?.BonusDescription);
    }
}
```

---

## 6. Health Bar Control

**File:** `src/Presentation/RuneAndRust.Avalonia/Controls/HealthBarControl.cs`

```csharp
namespace RuneAndRust.Avalonia.Controls;

using global::Avalonia;
using global::Avalonia.Controls.Primitives;
using global::Avalonia.Media;

/// <summary>
/// Custom Avalonia control for health/resource bars with color thresholds.
/// </summary>
public class HealthBarControl : TemplatedControl
{
    public static readonly StyledProperty<int> CurrentValueProperty =
        AvaloniaProperty.Register<HealthBarControl, int>(nameof(CurrentValue));

    public static readonly StyledProperty<int> MaxValueProperty =
        AvaloniaProperty.Register<HealthBarControl, int>(nameof(MaxValue), 100);

    public static readonly StyledProperty<BarType> BarTypeProperty =
        AvaloniaProperty.Register<HealthBarControl, BarType>(nameof(BarType), BarType.Health);

    public static readonly StyledProperty<string> LabelProperty =
        AvaloniaProperty.Register<HealthBarControl, string>(nameof(Label), "HP");

    /// <summary>
    /// Gets or sets the current value.
    /// </summary>
    public int CurrentValue
    {
        get => GetValue(CurrentValueProperty);
        set => SetValue(CurrentValueProperty, value);
    }

    /// <summary>
    /// Gets or sets the maximum value.
    /// </summary>
    public int MaxValue
    {
        get => GetValue(MaxValueProperty);
        set => SetValue(MaxValueProperty, value);
    }

    /// <summary>
    /// Gets or sets the bar type.
    /// </summary>
    public BarType BarType
    {
        get => GetValue(BarTypeProperty);
        set => SetValue(BarTypeProperty, value);
    }

    /// <summary>
    /// Gets or sets the label text.
    /// </summary>
    public string Label
    {
        get => GetValue(LabelProperty);
        set => SetValue(LabelProperty, value);
    }

    /// <summary>
    /// Gets the fill percentage (0.0 to 1.0).
    /// </summary>
    public double FillPercentage => MaxValue > 0 ? (double)CurrentValue / MaxValue : 0;

    /// <summary>
    /// Gets the display text (e.g., "65/100").
    /// </summary>
    public string DisplayText => $"{CurrentValue}/{MaxValue}";

    /// <summary>
    /// Gets the fill brush based on bar type and percentage.
    /// </summary>
    public IBrush FillBrush => BarType switch
    {
        BarType.Health => GetHealthBrush(),
        BarType.Mana => Brushes.RoyalBlue,
        BarType.Experience => Brushes.MediumPurple,
        BarType.Stamina => Brushes.Orange,
        _ => Brushes.Gray
    };

    private IBrush GetHealthBrush()
    {
        var percent = FillPercentage * 100;
        return percent switch
        {
            > 75 => Brushes.ForestGreen,
            > 50 => Brushes.Gold,
            > 25 => Brushes.OrangeRed,
            _ => Brushes.DarkRed
        };
    }

    static HealthBarControl()
    {
        CurrentValueProperty.Changed.AddClassHandler<HealthBarControl>((c, _) => c.OnValueChanged());
        MaxValueProperty.Changed.AddClassHandler<HealthBarControl>((c, _) => c.OnValueChanged());
    }

    private void OnValueChanged()
    {
        // Notify bindings of computed property changes
        RaisePropertyChanged(nameof(FillPercentage));
        RaisePropertyChanged(nameof(FillBrush));
        RaisePropertyChanged(nameof(DisplayText));
    }

    private void RaisePropertyChanged(string propertyName)
    {
        PropertyChanged?.Invoke(this, new global::Avalonia.AvaloniaPropertyChangedEventArgs<object>(
            this,
            null!,
            default,
            default,
            default));
    }
}

/// <summary>
/// Types of resource bars.
/// </summary>
public enum BarType
{
    /// <summary>Health/HP bar with color thresholds.</summary>
    Health,
    
    /// <summary>Mana/MP bar (blue).</summary>
    Mana,
    
    /// <summary>Experience/XP bar (purple).</summary>
    Experience,
    
    /// <summary>Stamina bar (orange).</summary>
    Stamina,
    
    /// <summary>Custom bar with default color.</summary>
    Custom
}
```

**File:** `src/Presentation/RuneAndRust.Avalonia/Controls/HealthBarControl.axaml`

```xml
<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ctrl="using:RuneAndRust.Avalonia.Controls">
    
    <Style Selector="ctrl|HealthBarControl">
        <Setter Property="Template">
            <ControlTemplate>
                <Grid ColumnDefinitions="32,*,60">
                    <!-- Label -->
                    <TextBlock Grid.Column="0"
                               Text="{TemplateBinding Label}"
                               VerticalAlignment="Center"
                               Foreground="{StaticResource TextSecondaryBrush}" />
                    
                    <!-- Bar Background -->
                    <Border Grid.Column="1"
                            Background="{StaticResource SurfaceBrush}"
                            CornerRadius="4"
                            Height="16"
                            Margin="4,0">
                        <!-- Bar Fill -->
                        <Border Background="{TemplateBinding FillBrush}"
                                CornerRadius="4"
                                HorizontalAlignment="Left"
                                Width="{TemplateBinding FillPercentage, Converter={StaticResource PercentToWidthConverter}}" />
                    </Border>
                    
                    <!-- Value Display -->
                    <TextBlock Grid.Column="2"
                               Text="{TemplateBinding DisplayText}"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Right"
                               FontSize="{StaticResource FontSizeSmall}"
                               Foreground="{StaticResource TextMutedBrush}" />
                </Grid>
            </ControlTemplate>
        </Setter>
    </Style>
</Styles>
```

---

## 7. Supporting ViewModels

**File:** `src/Presentation/RuneAndRust.Avalonia/ViewModels/StatViewModel.cs`

```csharp
namespace RuneAndRust.Avalonia.ViewModels;

/// <summary>
/// View model representing a character stat.
/// </summary>
public record StatViewModel(
    string Name,
    string Abbreviation,
    int Value,
    int Modifier)
{
    /// <summary>
    /// Gets the formatted modifier string (+X or -X).
    /// </summary>
    public string ModifierDisplay => Modifier >= 0 ? $"(+{Modifier})" : $"({Modifier})";

    /// <summary>
    /// Gets the full display string.
    /// </summary>
    public string DisplayValue => $"{Value} {ModifierDisplay}";
}
```

**File:** `src/Presentation/RuneAndRust.Avalonia/ViewModels/EquipmentSlotViewModel.cs`

```csharp
namespace RuneAndRust.Avalonia.ViewModels;

/// <summary>
/// View model representing an equipment slot.
/// </summary>
public record EquipmentSlotViewModel
{
    public string SlotName { get; }
    public string SlotIcon { get; }
    public string ItemName { get; }
    public string? ItemBonus { get; }
    public bool IsEmpty { get; }
    public bool HasBonus { get; }

    /// <summary>
    /// Creates an empty equipment slot.
    /// </summary>
    public EquipmentSlotViewModel(string slotName, string slotIcon)
    {
        SlotName = slotName;
        SlotIcon = slotIcon;
        ItemName = "None";
        ItemBonus = null;
        IsEmpty = true;
        HasBonus = false;
    }

    /// <summary>
    /// Creates an equipment slot with an item.
    /// </summary>
    public EquipmentSlotViewModel(string slotName, string slotIcon, string? itemName, string? itemBonus)
    {
        SlotName = slotName;
        SlotIcon = slotIcon;
        ItemName = itemName ?? "None";
        ItemBonus = itemBonus;
        IsEmpty = itemName is null;
        HasBonus = !string.IsNullOrEmpty(itemBonus);
    }
}
```

---

## 8. Value Converters

**File:** `src/Presentation/RuneAndRust.Avalonia/Converters/HealthToColorConverter.cs`

```csharp
namespace RuneAndRust.Avalonia.Converters;

using global::Avalonia.Data.Converters;
using global::Avalonia.Media;
using System.Globalization;

/// <summary>
/// Converts health percentage to color brush.
/// </summary>
public class HealthToColorConverter : IMultiValueConverter
{
    public object Convert(IList<object?> values, Type targetType, object? parameter, CultureInfo culture)
    {
        if (values.Count < 2 || 
            values[0] is not int current || 
            values[1] is not int max ||
            max <= 0)
        {
            return Brushes.Gray;
        }

        var percent = (double)current / max * 100;
        return percent switch
        {
            > 75 => Brushes.ForestGreen,
            > 50 => Brushes.Gold,
            > 25 => Brushes.OrangeRed,
            _ => Brushes.DarkRed
        };
    }
}
```

**File:** `src/Presentation/RuneAndRust.Avalonia/Converters/ModifierToStringConverter.cs`

```csharp
namespace RuneAndRust.Avalonia.Converters;

using global::Avalonia.Data.Converters;
using System.Globalization;

/// <summary>
/// Converts stat modifier to formatted string (+X or -X).
/// </summary>
public class ModifierToStringConverter : IValueConverter
{
    public object Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        if (value is not int modifier)
            return "(+0)";

        return modifier >= 0 ? $"(+{modifier})" : $"({modifier})";
    }

    public object ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
        => throw new NotImplementedException();
}
```

**File:** `src/Presentation/RuneAndRust.Avalonia/Converters/BoolToMutedConverter.cs`

```csharp
namespace RuneAndRust.Avalonia.Converters;

using global::Avalonia;
using global::Avalonia.Data.Converters;
using global::Avalonia.Media;
using System.Globalization;

/// <summary>
/// Converts boolean to muted or primary text brush.
/// </summary>
public class BoolToMutedConverter : IValueConverter
{
    public object Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        if (value is bool isEmpty && isEmpty)
        {
            return Application.Current!.FindResource("TextMutedBrush") ?? Brushes.Gray;
        }
        return Application.Current!.FindResource("TextPrimaryBrush") ?? Brushes.White;
    }

    public object ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
        => throw new NotImplementedException();
}
```

---

## 9. Styles

**File:** `src/Presentation/RuneAndRust.Avalonia/Styles/StatusPanelStyles.axaml`

```xml
<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    
    <!-- Stat Modifier Style (shows +/- color) -->
    <Style Selector="TextBlock.stat-modifier">
        <Setter Property="Foreground" Value="{StaticResource TextMutedBrush}" />
        <Setter Property="FontSize" Value="{StaticResource FontSizeSmall}" />
    </Style>
    
    <!-- Stat Bonus Style (green for positive) -->
    <Style Selector="TextBlock.stat-bonus">
        <Setter Property="Foreground" Value="{StaticResource SuccessColor}" />
        <Setter Property="FontSize" Value="{StaticResource FontSizeSmall}" />
    </Style>
    
    <!-- Gold Color Resource -->
    <Style Selector="TextBlock.gold-value">
        <Setter Property="Foreground" Value="{StaticResource GoldColor}" />
    </Style>
    
</Styles>
```

---

## 10. Data Model Changes

### New Types

| Type | Layer | Description |
|------|-------|-------------|
| `PlayerStatusPanel` | Presentation | Player status UserControl |
| `PlayerStatusViewModel` | Presentation | Player state view model |
| `HealthBarControl` | Presentation | Custom bar control |
| `BarType` | Presentation | Bar type enum |
| `StatViewModel` | Presentation | Stat display record |
| `EquipmentSlotViewModel` | Presentation | Equipment slot record |
| `HealthToColorConverter` | Presentation | Health color converter |
| `ModifierToStringConverter` | Presentation | Modifier format converter |
| `BoolToMutedConverter` | Presentation | Empty state converter |

No domain or application layer changes required.

---

## 11. Logging Specifications

| Component | Level | Events |
|-----------|-------|--------|
| `PlayerStatusViewModel` | Debug | Player status updates |

---

## 12. Unit Testing Requirements

### Test Count by Feature

| Feature | Test Count |
|---------|------------|
| PlayerStatusViewModel | ~3 |
| HealthBarControl | ~3 |
| ModifierToStringConverter | ~2 |
| EquipmentSlotViewModel | ~1 |
| **Total** | **~9** |

### Test Specifications

**File:** `tests/RuneAndRust.Avalonia.UnitTests/ViewModels/PlayerStatusViewModelTests.cs`

```csharp
[TestFixture]
public class PlayerStatusViewModelTests
{
    [Test]
    public void Constructor_WithNoPlayer_HasDefaultValues();

    [Test]
    public void HandlePlayerChanged_UpdatesHealthValues();

    [Test]
    public void CalculateModifier_With16_Returns3();
}
```

**File:** `tests/RuneAndRust.Avalonia.UnitTests/Controls/HealthBarControlTests.cs`

```csharp
[TestFixture]
public class HealthBarControlTests
{
    [Test]
    public void FillPercentage_With50Of100_Returns0Point5();

    [Test]
    public void FillBrush_HealthAt80Percent_ReturnsGreen();

    [Test]
    public void FillBrush_HealthAt20Percent_ReturnsDarkRed();
}
```

---

## 13. Use Cases

### UC-071b-001: View Player Status
**Actor:** Player
**Flow:** Game loads â†’ PlayerStatusPanel displays name, class, level, stats

### UC-071b-002: Monitor Health
**Actor:** Player
**Flow:** Take damage â†’ HP bar updates â†’ Color changes at thresholds

### UC-071b-003: Track Experience
**Actor:** Player
**Flow:** Gain XP â†’ XP bar fills â†’ Level up updates level display

### UC-071b-004: View Equipment
**Actor:** Player
**Flow:** Equip item â†’ Equipment slot updates with item name and bonus

### UC-071b-005: Check Gold
**Actor:** Player
**Flow:** Acquire gold â†’ Gold display updates with new amount

---

## 14. Deliverable Checklist

### Controls
- [ ] `Controls/PlayerStatusPanel.axaml` created
- [ ] `Controls/PlayerStatusPanel.axaml.cs` created
- [ ] `Controls/HealthBarControl.cs` created
- [ ] `Controls/HealthBarControl.axaml` created

### ViewModels
- [ ] `ViewModels/PlayerStatusViewModel.cs` created
- [ ] `ViewModels/StatViewModel.cs` created
- [ ] `ViewModels/EquipmentSlotViewModel.cs` created

### Converters
- [ ] `Converters/HealthToColorConverter.cs` created
- [ ] `Converters/ModifierToStringConverter.cs` created
- [ ] `Converters/BoolToMutedConverter.cs` created

### Styles
- [ ] `Styles/StatusPanelStyles.axaml` created

### Theme Updates
- [ ] `Themes/Colors.axaml` updated with GoldColor, SuccessColor

### Integration
- [ ] `App.axaml` includes StatusPanelStyles
- [ ] GameWindow registers PlayerStatusPanel in RightSidebarTop region

### Testing
- [ ] ~9 unit tests implemented
- [ ] All tests passing

---

## 15. Acceptance Criteria

### Character Info
- [ ] Character name displays
- [ ] Class and level display correctly
- [ ] Level updates on level up

### Resource Bars
- [ ] HP bar fills proportionally
- [ ] HP bar color changes at 75/50/25% thresholds
- [ ] MP bar displays in blue
- [ ] XP bar shows level progress
- [ ] Bar text shows "current/max"

### Stats
- [ ] All 6 stats display with values
- [ ] Stat modifiers show (+X/-X) format
- [ ] Modifiers calculate correctly ((stat-10)/2)

### Equipment
- [ ] All 5 equipment slots display
- [ ] Equipped items show name
- [ ] Item bonuses show when present
- [ ] Empty slots show "None" (muted)

### Footer
- [ ] Gold amount displays with icon
- [ ] Location name displays with icon
- [ ] Updates when player/room changes

### Quality
- [ ] Build completes with 0 errors
- [ ] Build completes with 0 warnings
- [ ] ~9 unit tests pass
- [ ] Panel updates when player changes

---

## 16. Dependencies

### Required from v0.7.1a

| Type | Location | Usage |
|------|----------|-------|
| ViewModel patterns | v0.7.1a | Consistent ViewModel structure |
| Converter patterns | v0.7.1a | Reference for new converters |
| Panel styles | `Styles/PanelStyles.axaml` | `.panel` class |

### Required from v0.7.0c

| Type | Location | Usage |
|------|----------|-------|
| `GameWindow` | `Views/GameWindow.axaml` | RightSidebarTop region host |
| `IWindowLayoutService` | `Services/IWindowLayoutService.cs` | Panel registration |
| `PanelRegion.RightSidebarTop` | `Services/PanelRegion.cs` | Region identifier |

### Provides to v0.7.1c

| Type | Usage |
|------|-------|
| `HealthBarControl` | Reusable resource bar control |
| Color threshold patterns | Reference for message colors |

---

## 17. Future Considerations

### Deferred to v0.7.1c
- **Message Log Panel**: BottomContent region content

### Deferred to v0.7.2
- **Inventory Panel**: Full inventory interaction
- **Detailed stat tooltips**: Hover for detailed calculation

### Deferred to v0.8.0
- **Status effects display**: Buffs/debuffs icons
- **Active abilities display**: Cooldown indicators

### Out of Scope
- **Equipment drag-drop**: v0.7.2+ interaction feature
- **Stat point allocation**: Character creation feature

---

*Document Version: 1.0*
*Last Updated: 2026-01-10*
*Author: Assistant*
