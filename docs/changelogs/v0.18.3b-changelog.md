# v0.18.3b Changelog — CharacterTrauma Entity

**Version**: 0.18.3b  
**Date**: 2026-02-01  
**Category**: Domain Layer — Trauma System

---

## Summary

Implements per-character trauma tracking with `CharacterTrauma` entity and result records for acquisition and retirement evaluation.

---

## Added

### Domain Layer

| File                                 | Purpose                                                                      |
| ------------------------------------ | ---------------------------------------------------------------------------- |
| `Entities/CharacterTrauma.cs`        | Per-character trauma tracking with stack counts, management dates, and notes |
| `Records/TraumaAcquisitionResult.cs` | Immutable record for trauma acquisition outcomes                             |
| `Records/RetirementCheckResult.cs`   | Immutable record for retirement condition evaluation                         |

### Unit Tests

| File                                      | Tests    |
| ----------------------------------------- | -------- |
| `Entities/CharacterTraumaTests.cs`        | 22 tests |
| `Records/TraumaAcquisitionResultTests.cs` | 9 tests  |
| `Records/RetirementCheckResultTests.cs`   | 6 tests  |

---

## Technical Details

### CharacterTrauma Entity

- Factory method: `Create(characterId, traumaDefinitionId, source, acquiredAt)`
- Domain methods: `IncrementStackCount()`, `SetManagementStart()`, `SetNotes()`, `SetActive()`
- Validation: Empty GUIDs, null/empty strings, management date before acquisition
- ID normalization to lowercase

### Result Records

- `TraumaAcquisitionResult`: Factory methods for new, stacked, and failed acquisitions
- `RetirementCheckResult`: Factory methods for mandatory, optional, and no-retirement scenarios

---

## Verification

| Metric         | Result |
| -------------- | ------ |
| Build Errors   | 0      |
| Build Warnings | 0      |
| New Tests      | 37     |
| All Tests Pass | ✓      |

---

## Dependencies

- **Depends on**: v0.18.3a (TraumaType, TraumaDefinition, TraumaEffect, TraumaTrigger)
- **Required by**: v0.18.3c (Trauma Check System), v0.18.3d-e (Service Layer)
