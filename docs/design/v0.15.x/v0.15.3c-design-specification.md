# v0.15.3c Design Specification: Deception System

**Version:** 0.15.3c
**Theme:** Deception System
**Author:** Claude
**Created:** 2026-01-17
**Status:** Draft
**Prerequisites:** v0.15.3a Complete (Social Interaction Framework), v0.15.3b Complete (Persuasion System)

---

## Table of Contents

1. [Overview](#1-overview)
2. [Dependencies](#2-dependencies)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [LieComplexity Enum](#4-liecomplexity-enum)
5. [DeceptionContext Value Object](#5-deceptioncontext-value-object)
6. [DeceptionResult Value Object](#6-deceptionresult-value-object)
7. [CoverStoryQuality Enum](#7-coverstoryquality-enum)
8. [LiarsBurden Value Object](#8-liarsburden-value-object)
9. [IDeceptionService Interface](#9-ideceptionservice-interface)
10. [DeceptionService Implementation](#10-deceptionservice-implementation)
11. [LieExposed Fumble Consequence](#11-lieexposed-fumble-consequence)
12. [Untrustworthy Status Effect](#12-untrustworthy-status-effect)
13. [Configuration](#13-configuration)
14. [Commands](#14-commands)
15. [User-Facing Changes](#15-user-facing-changes)
16. [Logging Specifications](#16-logging-specifications)
17. [Unit Testing Requirements](#17-unit-testing-requirements)
18. [Use Cases](#18-use-cases)
19. [Deliverable Checklist](#19-deliverable-checklist)
20. [Acceptance Criteria](#20-acceptance-criteria)
21. [Future Considerations](#21-future-considerations)
22. [Implementation Notes](#22-implementation-notes)
23. [Document Metadata](#23-document-metadata)

---

## 1. Overview

### 1.1 Purpose

This document provides a comprehensive design specification for v0.15.3c, the Deception System phase. This part implements the lying and misleading subsystem of the Rhetoric skill, allowing players to craft lies of varying complexity, attempt to deceive NPCs, and suffer the psychological burden of maintaining falsehoods. The key components are:

1. **LieComplexity Enum**: Categorizes lies by plausibility from WhiteLie (DC 10) to Outrageous (DC 22), determining the base difficulty of the deception attempt.

2. **DeceptionContext Value Object**: Extends `SocialContext` with deception-specific factors including lie complexity, NPC suspicion/trust state, contradicting evidence, cover story quality, and forged documents.

3. **DeceptionResult Value Object**: Captures deception-specific outcomes including lie believed/detected, suspicion state changes, and stress costs from the Liar's Burden mechanic.

4. **CoverStoryQuality Enum**: Evaluates the quality of a prepared cover story, providing DC reductions for elaborate preparation.

5. **LiarsBurden Value Object**: Tracks the psychic stress cost of deception based on outcome (Success: +1, Failure: +3, Fumble: +8).

6. **DeceptionService**: Orchestrates deception attempts using opposed rolls (WILL + Rhetoric vs. NPC's WITS), applying all context modifiers, and managing the [Lie Exposed] fumble.

7. **[Untrustworthy] Status Effect**: A persistent flag applied after exposed lies, increasing future deception DCs by +3 with all NPCs who learn of the player's dishonesty.

This subsystem creates high-stakes social interactions where players must weigh the benefits of deception against the psychological toll and catastrophic risks of exposure.

### 1.2 Current vs. Target Implementation

| Aspect | Current Implementation | Target Implementation |
|--------|------------------------|----------------------|
| **Lie Complexity** | Generic DC | `LieComplexity` enum with 4 tiers (DC 10-22) |
| **NPC Suspicion** | Not tracked | +4 DC modifier for suspicious NPCs |
| **NPC Trust** | Not tracked | -4 DC modifier for trusting NPCs |
| **Evidence Contradiction** | Not tracked | +6 DC modifier when evidence contradicts |
| **Cover Story** | Not implemented | `CoverStoryQuality` with DC reductions |
| **Forged Documents** | Not tracked | Equipment modifier for convincing proof |
| **Opposed Roll** | Standard check | WILL + Rhetoric vs. NPC's WITS |
| **Psychic Stress** | Not integrated | Liar's Burden stress costs (Success: +1, Failure: +3, Fumble: +8) |
| **Fumble Consequence** | Generic failure | [Lie Exposed] - combat, exile, quest failure |
| **[Untrustworthy]** | Not implemented | Persistent +3 DC flag |

### 1.3 Scope

**In Scope:**
- Define `LieComplexity` enum with 4 plausibility tiers
- Define `DeceptionContext` value object with deception-specific factors
- Define `DeceptionResult` value object for deception outcomes
- Define `CoverStoryQuality` enum for prepared cover story evaluation
- Define `LiarsBurden` value object for stress cost calculation
- Create `IDeceptionService` interface for deception operations
- Implement `DeceptionService` with opposed roll logic
- Implement [Lie Exposed] fumble consequence with all sub-effects
- Implement [Untrustworthy] status effect with +3 DC penalty
- Configuration file `lie-complexity.json`
- Unit tests for deception mechanics (~3 tests)

**Out of Scope:**
- Intimidation system - v0.15.3d
- Negotiation system - v0.15.3e
- Interrogation system - v0.15.3f
- Cultural protocols (including Utgard Veil-Speech) - v0.15.3g
- Extended influence - v0.15.3h
- Specialization integration (Myrk-gengr abilities) - v0.15.3i

### 1.4 Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Enums | 2 | `LieComplexity`, `CoverStoryQuality` |
| Value Objects | 3 | `DeceptionContext`, `DeceptionResult`, `LiarsBurden` |
| Interfaces | 1 | `IDeceptionService` |
| Services | 1 | `DeceptionService` |
| Fumble Types | 1 | `LieExposed` (extension of `FumbleType`) |
| Status Effects | 1 | `Untrustworthy` (extension of `StatusEffectId`) |
| Configuration | 1 | `lie-complexity.json` |
| Unit Tests | ~3 | Lie complexity DC, suspicious NPC modifier, stress cost application |

---

## 2. Dependencies

### 2.1 Required from v0.15.3a (Social Interaction Framework)

| Component | Location | Usage in v0.15.3c |
|-----------|----------|-------------------|
| `SocialInteractionType` | `Domain/Enums/SocialInteractionType.cs` | Set to `Deception` for context |
| `NpcDisposition` | `Domain/Enums/NpcDisposition.cs` | Base disposition modifiers |
| `DispositionLevel` | `Domain/ValueObjects/DispositionLevel.cs` | Tracks NPC disposition changes |
| `SocialContext` | `Domain/ValueObjects/SocialContext.cs` | Base context pattern |
| `SocialResult` | `Domain/ValueObjects/SocialResult.cs` | Base result pattern |
| `SocialModifier` | `Domain/ValueObjects/SocialModifier.cs` | Cover story/document modifiers |
| `SocialContextBuilder` | `Application/Services/SocialContextBuilder.cs` | Builds deception contexts |

### 2.2 Required from v0.15.3b (Persuasion System)

| Component | Location | Usage in v0.15.3c |
|-----------|----------|-------------------|
| `PersuasionContext` | `Domain/ValueObjects/PersuasionContext.cs` | Pattern reference for DeceptionContext |
| `ArgumentAlignment` | `Domain/ValueObjects/ArgumentAlignment.cs` | Pattern for lie plausibility evaluation |

### 2.3 Required from v0.15.0 (Dice Pool Refactor)

| Component | Location | Usage in v0.15.3c |
|-----------|----------|-------------------|
| `DiceRollResult` | `Domain/ValueObjects/DiceRollResult.cs` | Provides `NetSuccesses`, `IsFumble` |
| `IDiceRollerService` | `Application/Interfaces/IDiceRollerService.cs` | Performs both player and NPC rolls |
| `SkillOutcome` | `Domain/Enums/SkillOutcome.cs` | Outcome classification |

### 2.4 Required from v0.15.1b (Outcome Classification)

| Component | Location | Usage in v0.15.3c |
|-----------|----------|-------------------|
| `OutcomeDetails` | `Domain/ValueObjects/OutcomeDetails.cs` | Enhanced outcome metadata |
| `FumbleType` | `Domain/Enums/FumbleType.cs` | Extended with `LieExposed` |
| `FumbleConsequence` | `Domain/Entities/FumbleConsequence.cs` | Tracks [Lie Exposed] |
| `IFumbleConsequenceService` | `Application/Interfaces/IFumbleConsequenceService.cs` | Creates fumble consequences |

### 2.5 Required from v0.15.1e (Integration Points)

| Component | Location | Usage in v0.15.3c |
|-----------|----------|-------------------|
| `SkillStressResult` | `Domain/ValueObjects/SkillStressResult.cs` | Liar's Burden stress tracking |
| `ISkillStressService` | `Application/Interfaces/ISkillStressService.cs` | Applies psychic stress costs |

### 2.6 Required from v0.10.x (Status Effect System)

| Component | Location | Usage in v0.15.3c |
|-----------|----------|-------------------|
| `StatusEffectId` | `Domain/Enums/StatusEffectId.cs` | Extended with `Untrustworthy`, `Suspicious`, `Trusting` |
| `StatusEffectType` | `Domain/Enums/StatusEffectType.cs` | Categorization of effects |
| `IStatusEffectService` | `Application/Interfaces/IStatusEffectService.cs` | Apply/remove status effects |

### 2.7 Required from Game State

| Component | Location | Usage in v0.15.3c |
|-----------|----------|-------------------|
| NPC WITS Attribute | `Domain/Entities/NpcStats.cs` | NPC's opposed roll pool |
| Faction Reputation | `Domain/Services/FactionService.cs` | Reputation damage on exposure |
| Settlement Access | `Application/Services/SettlementService.cs` | Potential exile on fumble |
| Quest State | `Application/Services/QuestService.cs` | Quest failure on critical fumble |

### 2.8 Provides to Future Versions

| Version | Component | Usage |
|---------|-----------|-------|
| v0.15.3e | Negotiation System | Deception as one of four negotiation tactics |
| v0.15.3f | Interrogation System | Deception method for extracting information |
| v0.15.3g | Cultural Protocols | Utgard Veil-Speech reduces deception DC by 4 |
| v0.15.3i | Specialization Integration | Myrk-gengr [Maintain Cover] and [Forge Documents] |

---

## 3. Architecture Diagrams

### 3.1 Deception Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            DECEPTION FLOW                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  DECEPTION ATTEMPT                                                          │
│  Player: "Tell the guard I'm a guild messenger"                             │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    CLASSIFY LIE COMPLEXITY                          │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Lie: "I'm with the guild, here on official business"               │    │
│  │  Classification: Plausible (DC 14)                                  │    │
│  │                                                                      │    │
│  │  LieComplexity Tiers:                                               │    │
│  │  ├── WhiteLie (DC 10)    - "I was here the whole time"             │    │
│  │  ├── Plausible (DC 14)   - "I'm with the Combine" ← SELECTED       │    │
│  │  ├── Unlikely (DC 18)    - "The Warden sent me"                    │    │
│  │  └── Outrageous (DC 22)  - "I am the Warden"                       │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    EVALUATE DECEPTION CONTEXT                       │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  NPC State (gate_guard_erik):                                       │    │
│  │  ├── Suspicious: false (no recent incidents)                        │    │
│  │  ├── Trusting: false (standard vigilance)                           │    │
│  │  └── WITS: 3 (average perception)                                   │    │
│  │                                                                      │    │
│  │  Evidence State:                                                    │    │
│  │  ├── Contradicting Evidence: false                                  │    │
│  │  └── Forged Documents: true (fake guild badge)                      │    │
│  │                                                                      │    │
│  │  Cover Story:                                                       │    │
│  │  ├── Quality: Good (-2 DC)                                          │    │
│  │  └── Details: Memorized guild routes and contact names              │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    BUILD DECEPTION CONTEXT                          │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  DeceptionContext                                                   │    │
│  │  ├── LieComplexity: Plausible (DC 14)                               │    │
│  │  ├── TargetId: "gate_guard_erik"                                    │    │
│  │  ├── TargetWits: 3                                                  │    │
│  │  ├── NpcSuspicious: false                                           │    │
│  │  ├── NpcTrusting: false                                             │    │
│  │  ├── EvidenceContradicts: false                                     │    │
│  │  ├── CoverStoryQuality: Good                                        │    │
│  │  └── ForgedDocuments: true                                          │    │
│  │                                                                      │    │
│  │  DC CALCULATION:                                                    │    │
│  │  ├── Base DC: 14 (Plausible lie)                                    │    │
│  │  ├── Cover Story: -2 DC (Good quality)                              │    │
│  │  └── Effective DC: 12                                               │    │
│  │                                                                      │    │
│  │  PLAYER DICE MODIFIERS:                                             │    │
│  │  ├── Forged Documents: +1d10                                        │    │
│  │  └── Total Modifier: +1d10                                          │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    PERFORM OPPOSED ROLL                             │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  PLAYER ROLL (WILL + Rhetoric):                                     │    │
│  │  ├── Attribute: WILL (3)                                            │    │
│  │  ├── Skill: Rhetoric (2)                                            │    │
│  │  ├── Modifiers: +1d10 (forged documents)                            │    │
│  │  ├── Final Pool: 6d10                                               │    │
│  │  │                                                                   │    │
│  │  │  Roll: [9, 8, 5, 10, 3, 6]                                       │    │
│  │  │  Successes: 3 (9, 8, 10)                                         │    │
│  │  │  Botches: 0                                                      │    │
│  │  └── Net Successes: 3                                               │    │
│  │                                                                      │    │
│  │  NPC ROLL (WITS):                                                   │    │
│  │  ├── Attribute: WITS (3)                                            │    │
│  │  ├── Final Pool: 3d10                                               │    │
│  │  │                                                                   │    │
│  │  │  Roll: [4, 7, 8]                                                 │    │
│  │  │  Successes: 1 (8)                                                │    │
│  │  │  Botches: 0                                                      │    │
│  │  └── Net Successes: 1                                               │    │
│  │                                                                      │    │
│  │  COMPARISON:                                                        │    │
│  │  ├── Player: 3 successes                                            │    │
│  │  ├── NPC: 1 success                                                 │    │
│  │  ├── Margin: 3 - 1 = 2                                              │    │
│  │  └── Outcome: Success (Player wins opposed roll)                    │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    APPLY LIAR'S BURDEN                              │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  LiarsBurden                                                        │    │
│  │  ├── Outcome: Success                                               │    │
│  │  ├── BaseStressCost: 1                                              │    │
│  │  └── TotalStressCost: 1 Psychic Stress                              │    │
│  │                                                                      │    │
│  │  Stress Cost Table:                                                 │    │
│  │  ├── Success: +1 Psychic Stress                                     │    │
│  │  ├── Failure: +3 Psychic Stress                                     │    │
│  │  └── Fumble: +8 Psychic Stress                                      │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    CREATE DECEPTION RESULT                          │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  DeceptionResult                                                    │    │
│  │  ├── Outcome: Success                                               │    │
│  │  ├── LieBelieved: true                                              │    │
│  │  ├── NpcSuspicionChange: 0 (no change)                              │    │
│  │  ├── StressCost: 1 (Liar's Burden)                                  │    │
│  │  ├── DispositionChange: 0                                           │    │
│  │  ├── UnlockedOptions: ["Enter compound", "Ask about shipments"]     │    │
│  │  └── FumbleConsequence: null                                        │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  OUTPUT: "The guard examines your badge, then nods. 'Right, you're         │
│           expected. Head on through.' You feel the familiar weight          │
│           of deception settling in your mind. (+1 Psychic Stress)"          │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 Lie Complexity Spectrum

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        LIE COMPLEXITY SPECTRUM                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  LIE TIERS (Base DC):                                                       │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  WHITE LIE (DC 10)                                                  │    │
│  │  ─────────────────────────────────────────────────────────────────  │    │
│  │  Description: Minor falsehoods, easily believed, low stakes         │    │
│  │                                                                      │    │
│  │  Examples:                                                          │    │
│  │  ├── "I was here the whole time"                                    │    │
│  │  ├── "I didn't see anything"                                        │    │
│  │  ├── "I'm just passing through"                                     │    │
│  │  └── "We've never met before"                                       │    │
│  │                                                                      │    │
│  │  NPC Reaction if Detected: Mild annoyance, slight suspicion         │    │
│  │  Stress Cost: Standard (Success +1, Failure +3, Fumble +8)          │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  PLAUSIBLE (DC 14)                                                  │    │
│  │  ─────────────────────────────────────────────────────────────────  │    │
│  │  Description: Believable lies that could be true given context      │    │
│  │                                                                      │    │
│  │  Examples:                                                          │    │
│  │  ├── "I'm with the Combine"                                         │    │
│  │  ├── "The captain sent me to relieve you"                           │    │
│  │  ├── "I'm a merchant from the outer settlements"                    │    │
│  │  └── "This is my first time in the city"                            │    │
│  │                                                                      │    │
│  │  NPC Reaction if Detected: Suspicion, possible refusal to interact  │    │
│  │  Stress Cost: Standard                                              │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  UNLIKELY (DC 18)                                                   │    │
│  │  ─────────────────────────────────────────────────────────────────  │    │
│  │  Description: Stretches credibility, requires supporting details    │    │
│  │                                                                      │    │
│  │  Examples:                                                          │    │
│  │  ├── "The Warden sent me"                                           │    │
│  │  ├── "I'm a high-ranking official from the capital"                 │    │
│  │  ├── "I discovered a cure for the blight"                           │    │
│  │  └── "The guards already cleared me to be here"                     │    │
│  │                                                                      │    │
│  │  NPC Reaction if Detected: Alarm, possible hostility, report        │    │
│  │  Stress Cost: Standard                                              │    │
│  │  Note: Usually requires evidence or exceptional circumstances       │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  OUTRAGEOUS (DC 22)                                                 │    │
│  │  ─────────────────────────────────────────────────────────────────  │    │
│  │  Description: Nearly unbelievable claims, extreme audacity          │    │
│  │                                                                      │    │
│  │  Examples:                                                          │    │
│  │  ├── "I am the Warden"                                              │    │
│  │  ├── "I single-handedly defeated the Iron-Bane warband"             │    │
│  │  ├── "I've been chosen by the Shattered God"                        │    │
│  │  └── "The entire settlement owes me a blood debt"                   │    │
│  │                                                                      │    │
│  │  NPC Reaction if Detected: Immediate hostility, possible attack     │    │
│  │  Stress Cost: Standard                                              │    │
│  │  Note: Rarely succeeds without extraordinary circumstances          │    │
│  │        or [Trusting] NPC status                                     │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Deception Modifier Matrix

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       DECEPTION MODIFIER MATRIX                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  DC MODIFIERS (affect difficulty):                                          │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  NPC STATE              │ DC MODIFIER │ DESCRIPTION                 │    │
│  ├─────────────────────────┼─────────────┼─────────────────────────────┤    │
│  │  [Suspicious]           │ +4 DC       │ NPC is on guard, looking    │    │
│  │                         │             │ for inconsistencies         │    │
│  │  [Trusting]             │ -4 DC       │ NPC believes player is      │    │
│  │                         │             │ honest, guard lowered       │    │
│  │  Evidence Contradicts   │ +6 DC       │ Physical proof shows lie    │    │
│  │                         │             │ ("But the badge is fake!")  │    │
│  │  [Untrustworthy] flag   │ +3 DC       │ NPC knows player has lied   │    │
│  │                         │             │ before (persistent)         │    │
│  └─────────────────────────┴─────────────┴─────────────────────────────┘    │
│                                                                              │
│  COVER STORY MODIFIERS (DC reduction):                                      │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  COVER STORY QUALITY    │ DC MODIFIER │ REQUIREMENT                 │    │
│  ├─────────────────────────┼─────────────┼─────────────────────────────┤    │
│  │  None                   │ +0          │ Improvised lie, no prep     │    │
│  │  Basic                  │ -1 DC       │ General story, few details  │    │
│  │  Good                   │ -2 DC       │ Consistent details, names   │    │
│  │  Excellent              │ -3 DC       │ Researched, verifiable bits │    │
│  │  Masterwork             │ -4 DC       │ Indistinguishable from      │    │
│  │                         │             │ truth with supporting proof │    │
│  └─────────────────────────┴─────────────┴─────────────────────────────┘    │
│                                                                              │
│  DICE MODIFIERS (affect player pool):                                       │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  FACTOR                 │ DICE MODIFIER │ DESCRIPTION               │    │
│  ├─────────────────────────┼───────────────┼───────────────────────────┤    │
│  │  Forged Documents       │ +1d10         │ Fake badge, papers, seal  │    │
│  │  High-Quality Forgery   │ +2d10         │ Expert crafted documents  │    │
│  │  Genuine Partial Truth  │ +1d10         │ Lie contains some truth   │    │
│  │  NPC is Distracted      │ +1d10         │ Not giving full attention │    │
│  │  NPC is Intoxicated     │ +1d10         │ Impaired judgment         │    │
│  │  Player [Honored]       │ +1d10         │ Reputation suggests       │    │
│  │    with NPC's faction   │               │ honesty                   │    │
│  └─────────────────────────┴───────────────┴───────────────────────────┘    │
│                                                                              │
│  NPC DICE MODIFIERS (affect NPC's WITS pool):                              │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  FACTOR                 │ DICE MODIFIER │ DESCRIPTION               │    │
│  ├─────────────────────────┼───────────────┼───────────────────────────┤    │
│  │  Trained Observer       │ +1d10         │ Guards, investigators     │    │
│  │  Previously Fooled      │ +1d10         │ NPC was deceived before   │    │
│  │  [Alert] status         │ +1d10         │ Heightened awareness      │    │
│  │  Knows Player           │ +1d10         │ Can spot unusual behavior │    │
│  │  [Fatigued] status      │ -1d10         │ Reduced perception        │    │
│  └─────────────────────────┴───────────────┴───────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 Liar's Burden Stress System

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      LIAR'S BURDEN STRESS SYSTEM                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  STRESS COST BY OUTCOME:                                                    │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  OUTCOME          │ STRESS COST │ NARRATIVE                         │    │
│  ├───────────────────┼─────────────┼───────────────────────────────────┤    │
│  │  Success          │ +1 Psychic  │ The weight of deception settles   │    │
│  │                   │   Stress    │ in your mind.                     │    │
│  │  Failure          │ +3 Psychic  │ Your failed lie haunts you. Did   │    │
│  │                   │   Stress    │ they see through you completely?  │    │
│  │  Fumble           │ +8 Psychic  │ The shame of exposure burns.      │    │
│  │                   │   Stress    │ Everyone knows what you are now.  │    │
│  └───────────────────┴─────────────┴───────────────────────────────────┘    │
│                                                                              │
│  STRESS FLOW DIAGRAM:                                                       │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│                    ┌──────────────────┐                                     │
│                    │  Deception       │                                     │
│                    │  Attempted       │                                     │
│                    └────────┬─────────┘                                     │
│                             │                                               │
│              ┌──────────────┼──────────────┐                                │
│              ▼              ▼              ▼                                │
│      ┌───────────┐  ┌───────────┐  ┌───────────┐                           │
│      │  SUCCESS  │  │  FAILURE  │  │  FUMBLE   │                           │
│      └─────┬─────┘  └─────┬─────┘  └─────┬─────┘                           │
│            │              │              │                                  │
│            ▼              ▼              ▼                                  │
│      ┌───────────┐  ┌───────────┐  ┌───────────┐                           │
│      │  +1 Stress │  │  +3 Stress │  │  +8 Stress │                         │
│      └─────┬─────┘  └─────┬─────┘  └─────┬─────┘                           │
│            │              │              │                                  │
│            │              │              ▼                                  │
│            │              │        ┌───────────────┐                        │
│            │              │        │  +5 Additional│                        │
│            │              │        │  from [Lie    │                        │
│            │              │        │  Exposed]     │                        │
│            │              │        └───────┬───────┘                        │
│            │              │                │                                │
│            ▼              ▼                ▼                                │
│      ┌─────────────────────────────────────────────┐                       │
│      │           TOTAL PSYCHIC STRESS              │                       │
│      │  Success: 1 | Failure: 3 | Fumble: 8+5=13   │                       │
│      └─────────────────────────────────────────────┘                       │
│                                                                              │
│  CUMULATIVE DECEPTION STRESS:                                              │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  Each deception attempt adds stress regardless of outcome.                 │
│  A player who relies heavily on deception will accumulate stress           │
│  faster than one using honest persuasion.                                  │
│                                                                              │
│  Example Session:                                                          │
│  ├── Deception #1 (Success): +1 Stress (Total: 1)                          │
│  ├── Deception #2 (Success): +1 Stress (Total: 2)                          │
│  ├── Deception #3 (Failure): +3 Stress (Total: 5)                          │
│  └── Deception #4 (Success): +1 Stress (Total: 6)                          │
│                                                                              │
│  Compare to Persuasion (4 attempts, no stress): Total: 0                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.5 [Lie Exposed] Fumble Consequences

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    [LIE EXPOSED] FUMBLE CONSEQUENCES                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  FUMBLE TRIGGER: 0 Successes + ≥1 Botch on Deception Roll                  │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    IMMEDIATE EFFECTS                                │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  1. STRESS DAMAGE                                                   │    │
│  │     └── +8 Psychic Stress (base fumble)                             │    │
│  │     └── +5 Additional Psychic Stress (exposure shame)               │    │
│  │     └── Total: +13 Psychic Stress                                   │    │
│  │                                                                      │    │
│  │  2. [UNTRUSTWORTHY] FLAG APPLIED                                    │    │
│  │     └── Player gains [Untrustworthy] status with this NPC           │    │
│  │     └── All future deception checks with this NPC: +3 DC            │    │
│  │     └── NPC may spread information to others                        │    │
│  │                                                                      │    │
│  │  3. DIALOGUE OPTIONS LOCKED                                         │    │
│  │     └── All deception options with this NPC permanently locked      │    │
│  │     └── Some persuasion options may also lock (NPC won't believe)   │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    50% CHANCE: COMBAT INITIATED                     │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Roll: d100                                                         │    │
│  │  ├── 1-50: NPC becomes hostile and attacks                          │    │
│  │  │         └── NPC gains [Furious] buff (+1d10 to attacks)          │    │
│  │  │         └── NPC may call for reinforcements                      │    │
│  │  │                                                                   │    │
│  │  └── 51-100: NPC demands player leave immediately                   │    │
│  │              └── Player must comply or face combat                  │    │
│  │              └── NPC may report to authorities                      │    │
│  │                                                                      │    │
│  │  Factors Affecting Combat Chance:                                   │    │
│  │  ├── NPC is a guard/soldier: +10% (total 60%)                       │    │
│  │  ├── Lie was about a crime: +15% (total 65%)                        │    │
│  │  ├── NPC has backup nearby: +10% (total 60%)                        │    │
│  │  ├── NPC is a merchant/civilian: -10% (total 40%)                   │    │
│  │  └── Player has [Honored] reputation: -15% (total 35%)              │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    POSSIBLE: SETTLEMENT BAN                         │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  If the exposed lie was:                                            │    │
│  │  ├── Against a settlement official (mayor, guard captain): 50%     │    │
│  │  ├── About faction allegiance: 30%                                  │    │
│  │  ├── Related to a crime: 60%                                        │    │
│  │  └── About identity impersonation: 40%                              │    │
│  │                                                                      │    │
│  │  Ban Effects:                                                       │    │
│  │  ├── Temporary Ban (1d6 in-game days): Cannot enter settlement      │    │
│  │  ├── Permanent Ban (rare, extreme lies): Never allowed back         │    │
│  │  └── Bounty Posted: Settlement guards attack on sight               │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    POSSIBLE: QUEST FAILURE                          │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  If the deception was part of a quest:                              │    │
│  │  ├── Quest may fail immediately if deception was critical path      │    │
│  │  ├── Alternative paths may still be available                       │    │
│  │  └── Quest giver may become hostile                                 │    │
│  │                                                                      │    │
│  │  Quest State Changes:                                               │    │
│  │  ├── "Infiltrate the compound" → FAILED if caught at gate           │    │
│  │  ├── "Gather information" → MAY CONTINUE via other methods          │    │
│  │  └── "Impersonate the official" → FAILED, alternative required      │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    RECOVERY CONDITIONS                              │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  To Remove [Untrustworthy] with Specific NPC:                       │    │
│  │  ├── Complete a quest that significantly benefits the NPC           │    │
│  │  ├── Save NPC's life or property from danger                        │    │
│  │  ├── Significant time passage (2+ in-game weeks)                    │    │
│  │  └── Third-party intercession (mutual friend vouches for you)       │    │
│  │                                                                      │    │
│  │  Note: [Untrustworthy] with one NPC may spread to others           │    │
│  │        if NPCs communicate (faction members, settlement guards)     │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.6 Layer Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           LAYER ARCHITECTURE                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                      DOMAIN LAYER                                    │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  ValueObjects/                                                      │    │
│  │  ├── DeceptionContext.cs              ←── NEW                       │    │
│  │  ├── DeceptionResult.cs               ←── NEW                       │    │
│  │  └── LiarsBurden.cs                   ←── NEW                       │    │
│  │                                                                      │    │
│  │  Enums/                                                             │    │
│  │  ├── LieComplexity.cs                 ←── NEW                       │    │
│  │  ├── CoverStoryQuality.cs             ←── NEW                       │    │
│  │  ├── FumbleType.cs                    ←── MODIFIED (add LieExposed) │    │
│  │  └── StatusEffectId.cs                ←── MODIFIED (add Untrustworthy,│   │
│  │                                            Suspicious, Trusting)    │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                  │                                           │
│                                  │ uses                                      │
│                                  ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    APPLICATION LAYER                                 │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Interfaces/                                                        │    │
│  │  └── IDeceptionService.cs             ←── NEW                       │    │
│  │                                                                      │    │
│  │  Services/                                                          │    │
│  │  └── DeceptionService.cs              ←── NEW                       │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                  │                                           │
│                                  │ uses                                      │
│                                  ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                  INFRASTRUCTURE LAYER                                │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Configuration/                                                     │    │
│  │  └── lie-complexity.json              ←── NEW                       │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. LieComplexity Enum

### 4.1 Enum Definition

**File:** `src/Core/RuneAndRust.Domain/Enums/LieComplexity.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Categorizes lies by plausibility, determining base DC.
/// </summary>
/// <remarks>
/// <para>
/// Lie complexity is determined by how believable the falsehood is
/// given the context and the NPC's knowledge. Higher complexity lies
/// are more difficult to sell and more dangerous when exposed.
/// </para>
/// <para>
/// Unlike persuasion, deception uses an opposed roll system:
/// Player (WILL + Rhetoric) vs. NPC (WITS). The DC modifies the
/// effective threshold for determining success.
/// </para>
/// </remarks>
public enum LieComplexity
{
    /// <summary>
    /// Minor falsehoods that are easily believed and low stakes.
    /// </summary>
    /// <remarks>
    /// <para>Base DC: 10</para>
    /// <para>Examples: "I was here the whole time", "I didn't see anything"</para>
    /// <para>Even slightly suspicious NPCs may let these pass.</para>
    /// </remarks>
    WhiteLie = 0,

    /// <summary>
    /// Believable lies that could reasonably be true given context.
    /// </summary>
    /// <remarks>
    /// <para>Base DC: 14</para>
    /// <para>Examples: "I'm with the Combine", "The captain sent me"</para>
    /// <para>Requires consistent delivery and may benefit from supporting evidence.</para>
    /// </remarks>
    Plausible = 1,

    /// <summary>
    /// Lies that stretch credibility and typically require supporting details.
    /// </summary>
    /// <remarks>
    /// <para>Base DC: 18</para>
    /// <para>Examples: "The Warden sent me", "I'm a high-ranking official"</para>
    /// <para>Usually requires forged documents or exceptional circumstances to succeed.</para>
    /// </remarks>
    Unlikely = 2,

    /// <summary>
    /// Nearly unbelievable claims requiring extreme audacity.
    /// </summary>
    /// <remarks>
    /// <para>Base DC: 22</para>
    /// <para>Examples: "I am the Warden", "I single-handedly defeated the warband"</para>
    /// <para>Rarely succeeds without [Trusting] NPC status or masterwork cover story.</para>
    /// <para>Exposure is almost always catastrophic.</para>
    /// </remarks>
    Outrageous = 3
}
```

### 4.2 Extension Methods

**File:** `src/Core/RuneAndRust.Domain/Extensions/LieComplexityExtensions.cs`

```csharp
namespace RuneAndRust.Domain.Extensions;

using RuneAndRust.Domain.Enums;

/// <summary>
/// Extension methods for <see cref="LieComplexity"/> enum.
/// </summary>
public static class LieComplexityExtensions
{
    /// <summary>
    /// Gets the base DC for this lie complexity.
    /// </summary>
    /// <param name="complexity">The lie complexity.</param>
    /// <returns>The base difficulty class.</returns>
    public static int GetBaseDc(this LieComplexity complexity)
    {
        return complexity switch
        {
            LieComplexity.WhiteLie => 10,
            LieComplexity.Plausible => 14,
            LieComplexity.Unlikely => 18,
            LieComplexity.Outrageous => 22,
            _ => 14
        };
    }

    /// <summary>
    /// Gets the typical NPC reaction severity if the lie is detected.
    /// </summary>
    /// <param name="complexity">The lie complexity.</param>
    /// <returns>A value from 1 (mild) to 4 (severe) indicating reaction severity.</returns>
    public static int GetDetectionSeverity(this LieComplexity complexity)
    {
        return complexity switch
        {
            LieComplexity.WhiteLie => 1,    // Mild annoyance
            LieComplexity.Plausible => 2,   // Suspicion, possible refusal
            LieComplexity.Unlikely => 3,    // Alarm, possible hostility
            LieComplexity.Outrageous => 4,  // Immediate hostility
            _ => 2
        };
    }

    /// <summary>
    /// Gets whether this lie complexity typically requires supporting evidence.
    /// </summary>
    /// <param name="complexity">The lie complexity.</param>
    /// <returns>True if forged documents or other evidence is highly recommended.</returns>
    public static bool RequiresEvidence(this LieComplexity complexity)
    {
        return complexity >= LieComplexity.Unlikely;
    }

    /// <summary>
    /// Gets the combat initiation chance modifier for [Lie Exposed] fumble.
    /// </summary>
    /// <param name="complexity">The lie complexity.</param>
    /// <returns>A percentage modifier to add to the base 50% combat chance.</returns>
    public static int GetCombatChanceModifier(this LieComplexity complexity)
    {
        return complexity switch
        {
            LieComplexity.WhiteLie => -10,   // 40% base
            LieComplexity.Plausible => 0,    // 50% base
            LieComplexity.Unlikely => 10,    // 60% base
            LieComplexity.Outrageous => 20,  // 70% base
            _ => 0
        };
    }

    /// <summary>
    /// Gets a human-readable description of the lie complexity.
    /// </summary>
    /// <param name="complexity">The lie complexity.</param>
    /// <returns>A descriptive string for UI display.</returns>
    public static string GetDescription(this LieComplexity complexity)
    {
        return complexity switch
        {
            LieComplexity.WhiteLie => "White Lie (DC 10) - Minor falsehood, easily believed",
            LieComplexity.Plausible => "Plausible (DC 14) - Believable given context",
            LieComplexity.Unlikely => "Unlikely (DC 18) - Stretches credibility, needs evidence",
            LieComplexity.Outrageous => "Outrageous (DC 22) - Nearly unbelievable audacity",
            _ => "Unknown lie complexity"
        };
    }

    /// <summary>
    /// Gets example lies for this complexity tier.
    /// </summary>
    /// <param name="complexity">The lie complexity.</param>
    /// <returns>An array of example lie statements.</returns>
    public static string[] GetExamples(this LieComplexity complexity)
    {
        return complexity switch
        {
            LieComplexity.WhiteLie => new[]
            {
                "I was here the whole time",
                "I didn't see anything",
                "I'm just passing through",
                "We've never met before"
            },
            LieComplexity.Plausible => new[]
            {
                "I'm with the Combine",
                "The captain sent me to relieve you",
                "I'm a merchant from the outer settlements",
                "This is my first time in the city"
            },
            LieComplexity.Unlikely => new[]
            {
                "The Warden sent me",
                "I'm a high-ranking official from the capital",
                "I discovered a cure for the blight",
                "The guards already cleared me to be here"
            },
            LieComplexity.Outrageous => new[]
            {
                "I am the Warden",
                "I single-handedly defeated the Iron-Bane warband",
                "I've been chosen by the Shattered God",
                "The entire settlement owes me a blood debt"
            },
            _ => Array.Empty<string>()
        };
    }
}
```

---

## 5. DeceptionContext Value Object

### 5.1 Class Definition

**File:** `src/Core/RuneAndRust.Domain/ValueObjects/DeceptionContext.cs`

```csharp
namespace RuneAndRust.Domain.ValueObjects;

using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.Extensions;

/// <summary>
/// Encapsulates all factors affecting a deception attempt.
/// </summary>
/// <remarks>
/// <para>
/// The deception context captures the complexity of the lie, the NPC's
/// state of alertness/trust, any contradicting evidence, and the quality
/// of the player's cover story. Unlike persuasion, deception uses an
/// opposed roll system where the NPC actively contests the player's check.
/// </para>
/// <para>
/// This is an immutable value object created via the DeceptionService.
/// </para>
/// </remarks>
/// <param name="LieComplexity">The plausibility tier of the lie.</param>
/// <param name="TargetId">The NPC being deceived.</param>
/// <param name="TargetWits">The NPC's WITS attribute for opposed roll.</param>
/// <param name="TargetDisposition">The NPC's current disposition toward player.</param>
/// <param name="NpcSuspicious">Whether the NPC has [Suspicious] status.</param>
/// <param name="NpcTrusting">Whether the NPC has [Trusting] status.</param>
/// <param name="NpcTrainedObserver">Whether the NPC is a guard, investigator, etc.</param>
/// <param name="NpcPreviouslyFooled">Whether this NPC was deceived before by player.</param>
/// <param name="NpcHasAlert">Whether the NPC has [Alert] status.</param>
/// <param name="NpcHasFatigued">Whether the NPC has [Fatigued] status.</param>
/// <param name="NpcKnowsPlayer">Whether the NPC knows the player personally.</param>
/// <param name="EvidenceContradicts">Whether physical evidence contradicts the lie.</param>
/// <param name="ContradictingEvidenceDescription">Description of contradicting evidence.</param>
/// <param name="CoverStoryQuality">Quality of prepared cover story.</param>
/// <param name="HasForgedDocuments">Whether player has forged documents.</param>
/// <param name="ForgedDocumentQuality">Quality of forged documents (0=none, 1=basic, 2=high).</param>
/// <param name="LieContainsTruth">Whether the lie incorporates some genuine truth.</param>
/// <param name="NpcIsDistracted">Whether NPC is distracted by other events.</param>
/// <param name="NpcIsIntoxicated">Whether NPC is intoxicated.</param>
/// <param name="PlayerHasUntrustworthy">Whether player has [Untrustworthy] flag with this NPC.</param>
/// <param name="PlayerFactionStanding">Player's reputation with NPC's faction.</param>
public readonly record struct DeceptionContext(
    LieComplexity LieComplexity,
    string TargetId,
    int TargetWits,
    DispositionLevel TargetDisposition,
    bool NpcSuspicious,
    bool NpcTrusting,
    bool NpcTrainedObserver,
    bool NpcPreviouslyFooled,
    bool NpcHasAlert,
    bool NpcHasFatigued,
    bool NpcKnowsPlayer,
    bool EvidenceContradicts,
    string? ContradictingEvidenceDescription,
    CoverStoryQuality CoverStoryQuality,
    bool HasForgedDocuments,
    int ForgedDocumentQuality,
    bool LieContainsTruth,
    bool NpcIsDistracted,
    bool NpcIsIntoxicated,
    bool PlayerHasUntrustworthy,
    int PlayerFactionStanding)
{
    /// <summary>
    /// Gets the base DC from lie complexity.
    /// </summary>
    public int BaseDc => LieComplexity.GetBaseDc();

    /// <summary>
    /// Gets the NPC suspicion DC modifier (+4 if suspicious).
    /// </summary>
    public int SuspicionDcModifier => NpcSuspicious ? 4 : 0;

    /// <summary>
    /// Gets the NPC trust DC modifier (-4 if trusting).
    /// </summary>
    public int TrustDcModifier => NpcTrusting ? -4 : 0;

    /// <summary>
    /// Gets the contradicting evidence DC modifier (+6 if evidence contradicts).
    /// </summary>
    public int ContradictingEvidenceDcModifier => EvidenceContradicts ? 6 : 0;

    /// <summary>
    /// Gets the [Untrustworthy] flag DC modifier (+3 if player has flag).
    /// </summary>
    public int UntrustworthyDcModifier => PlayerHasUntrustworthy ? 3 : 0;

    /// <summary>
    /// Gets the cover story DC modifier.
    /// </summary>
    public int CoverStoryDcModifier => CoverStoryQuality switch
    {
        CoverStoryQuality.None => 0,
        CoverStoryQuality.Basic => -1,
        CoverStoryQuality.Good => -2,
        CoverStoryQuality.Excellent => -3,
        CoverStoryQuality.Masterwork => -4,
        _ => 0
    };

    /// <summary>
    /// Gets the total DC modifier.
    /// </summary>
    public int TotalDcModifier =>
        SuspicionDcModifier +
        TrustDcModifier +
        ContradictingEvidenceDcModifier +
        UntrustworthyDcModifier +
        CoverStoryDcModifier;

    /// <summary>
    /// Gets the effective DC after all modifiers.
    /// </summary>
    public int EffectiveDc => Math.Max(1, BaseDc + TotalDcModifier);

    /// <summary>
    /// Gets the player's dice pool modifier from documents and circumstance.
    /// </summary>
    public int PlayerDiceModifier
    {
        get
        {
            var modifier = 0;

            // Forged documents
            if (HasForgedDocuments)
            {
                modifier += ForgedDocumentQuality >= 2 ? 2 : 1;
            }

            // Lie contains truth
            if (LieContainsTruth) modifier += 1;

            // NPC state bonuses
            if (NpcIsDistracted) modifier += 1;
            if (NpcIsIntoxicated) modifier += 1;

            // Faction reputation bonus
            if (PlayerFactionStanding >= 75) modifier += 1; // Honored

            return modifier;
        }
    }

    /// <summary>
    /// Gets the NPC's dice pool modifier for the opposed roll.
    /// </summary>
    public int NpcDiceModifier
    {
        get
        {
            var modifier = 0;

            if (NpcTrainedObserver) modifier += 1;
            if (NpcPreviouslyFooled) modifier += 1;
            if (NpcHasAlert) modifier += 1;
            if (NpcKnowsPlayer) modifier += 1;
            if (NpcHasFatigued) modifier -= 1;

            return modifier;
        }
    }

    /// <summary>
    /// Gets the NPC's total dice pool for the opposed roll.
    /// </summary>
    public int NpcDicePool => Math.Max(1, TargetWits + NpcDiceModifier);

    /// <summary>
    /// Gets the detection severity if the lie is exposed.
    /// </summary>
    public int DetectionSeverity => LieComplexity.GetDetectionSeverity();

    /// <summary>
    /// Gets whether this deception attempt is particularly risky.
    /// </summary>
    public bool IsHighRisk =>
        LieComplexity >= LieComplexity.Unlikely ||
        NpcSuspicious ||
        EvidenceContradicts ||
        PlayerHasUntrustworthy;

    /// <summary>
    /// Builds a detailed modifier breakdown for display.
    /// </summary>
    /// <returns>A multi-line string showing all modifiers.</returns>
    public string ToModifierBreakdown()
    {
        var lines = new List<string>
        {
            $"Deception: {LieComplexity.GetDescription()}",
            $"Target: {TargetId} (WITS {TargetWits})"
        };

        // DC modifiers
        lines.Add("DC Modifiers:");
        if (SuspicionDcModifier != 0)
            lines.Add($"  [Suspicious]: +{SuspicionDcModifier} DC");
        if (TrustDcModifier != 0)
            lines.Add($"  [Trusting]: {TrustDcModifier} DC");
        if (ContradictingEvidenceDcModifier != 0)
            lines.Add($"  Evidence Contradicts: +{ContradictingEvidenceDcModifier} DC");
        if (UntrustworthyDcModifier != 0)
            lines.Add($"  [Untrustworthy]: +{UntrustworthyDcModifier} DC");
        if (CoverStoryDcModifier != 0)
            lines.Add($"  Cover Story ({CoverStoryQuality}): {CoverStoryDcModifier} DC");

        lines.Add($"  Effective DC: {EffectiveDc}");

        // Player dice modifiers
        if (PlayerDiceModifier != 0)
        {
            lines.Add("Player Bonuses:");
            if (HasForgedDocuments)
            {
                var quality = ForgedDocumentQuality >= 2 ? "High-Quality" : "Basic";
                var bonus = ForgedDocumentQuality >= 2 ? 2 : 1;
                lines.Add($"  {quality} Forged Documents: +{bonus}d10");
            }
            if (LieContainsTruth)
                lines.Add("  Lie Contains Truth: +1d10");
            if (NpcIsDistracted)
                lines.Add("  NPC Distracted: +1d10");
            if (NpcIsIntoxicated)
                lines.Add("  NPC Intoxicated: +1d10");
            if (PlayerFactionStanding >= 75)
                lines.Add("  [Honored] Reputation: +1d10");
        }

        // NPC dice modifiers
        if (NpcDiceModifier != 0)
        {
            lines.Add("NPC Perception Modifiers:");
            if (NpcTrainedObserver)
                lines.Add("  Trained Observer: +1d10");
            if (NpcPreviouslyFooled)
                lines.Add("  Previously Fooled: +1d10");
            if (NpcHasAlert)
                lines.Add("  [Alert]: +1d10");
            if (NpcKnowsPlayer)
                lines.Add("  Knows Player: +1d10");
            if (NpcHasFatigued)
                lines.Add("  [Fatigued]: -1d10");
        }

        lines.Add($"NPC Opposed Pool: {NpcDicePool}d10");

        return string.Join(Environment.NewLine, lines);
    }
}
```

---

## 6. DeceptionResult Value Object

### 6.1 Class Definition

**File:** `src/Core/RuneAndRust.Domain/ValueObjects/DeceptionResult.cs`

```csharp
namespace RuneAndRust.Domain.ValueObjects;

using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.Entities;

/// <summary>
/// Captures the outcome of a deception attempt.
/// </summary>
/// <remarks>
/// <para>
/// The deception result includes whether the lie was believed, any changes
/// to the NPC's suspicion state, the psychic stress cost from the Liar's
/// Burden mechanic, and any fumble consequences such as [Lie Exposed].
/// </para>
/// <para>
/// Unlike persuasion, deception always incurs a stress cost regardless of
/// outcome, reflecting the psychological toll of maintaining falsehoods.
/// </para>
/// </remarks>
/// <param name="Outcome">The skill outcome classification.</param>
/// <param name="LieBelieved">Whether the NPC believes the lie.</param>
/// <param name="PlayerSuccesses">Number of successes the player rolled.</param>
/// <param name="NpcSuccesses">Number of successes the NPC rolled.</param>
/// <param name="Margin">The difference between player and NPC successes.</param>
/// <param name="NpcSuspicionChange">Change to NPC suspicion (-1 = becomes trusting, +1 = becomes suspicious).</param>
/// <param name="StressCost">Psychic stress incurred from Liar's Burden.</param>
/// <param name="DispositionChange">Change to NPC disposition (usually negative on failure).</param>
/// <param name="UnlockedOptions">Dialogue options unlocked by successful deception.</param>
/// <param name="LockedOptions">Dialogue options locked by failed deception.</param>
/// <param name="FumbleConsequence">The [Lie Exposed] fumble consequence if applicable.</param>
/// <param name="CombatInitiated">Whether the fumble resulted in combat.</param>
/// <param name="SettlementBan">Whether the fumble resulted in settlement ban.</param>
/// <param name="SettlementBanDuration">Duration of ban in in-game days (0 = permanent).</param>
/// <param name="QuestFailed">Whether the fumble caused a quest to fail.</param>
/// <param name="FailedQuestId">ID of the failed quest if applicable.</param>
/// <param name="UntrustworthyApplied">Whether [Untrustworthy] flag was applied.</param>
public readonly record struct DeceptionResult(
    SkillOutcome Outcome,
    bool LieBelieved,
    int PlayerSuccesses,
    int NpcSuccesses,
    int Margin,
    int NpcSuspicionChange,
    int StressCost,
    int DispositionChange,
    IReadOnlyList<string> UnlockedOptions,
    IReadOnlyList<string> LockedOptions,
    FumbleConsequence? FumbleConsequence,
    bool CombatInitiated,
    bool SettlementBan,
    int SettlementBanDuration,
    bool QuestFailed,
    string? FailedQuestId,
    bool UntrustworthyApplied)
{
    /// <summary>
    /// Gets whether this was a successful deception.
    /// </summary>
    public bool IsSuccess => Outcome >= SkillOutcome.MarginalSuccess;

    /// <summary>
    /// Gets whether this was a fumble.
    /// </summary>
    public bool IsFumble => Outcome == SkillOutcome.Fumble;

    /// <summary>
    /// Gets whether the NPC now suspects the player.
    /// </summary>
    public bool NpcNowSuspicious => NpcSuspicionChange > 0;

    /// <summary>
    /// Gets whether the deception had severe consequences.
    /// </summary>
    public bool HasSevereConsequences =>
        CombatInitiated || SettlementBan || QuestFailed || UntrustworthyApplied;

    /// <summary>
    /// Gets a narrative description of the outcome.
    /// </summary>
    /// <returns>A string describing what happened.</returns>
    public string GetNarrativeDescription()
    {
        return Outcome switch
        {
            SkillOutcome.CriticalSuccess =>
                "Your lie is delivered flawlessly. The NPC believes you completely and may even embellish your story to others.",
            SkillOutcome.ExceptionalSuccess =>
                "Your deception is utterly convincing. The NPC has no reason to doubt you.",
            SkillOutcome.FullSuccess =>
                "The NPC accepts your story without question.",
            SkillOutcome.MarginalSuccess =>
                "Your lie lands, but perhaps a bit awkwardly. The NPC seems to believe you... for now.",
            SkillOutcome.Failure =>
                "The NPC doesn't buy it. Something in your story doesn't add up, and they know it.",
            SkillOutcome.Fumble =>
                GetFumbleNarrative(),
            _ => "The outcome is unclear."
        };
    }

    private string GetFumbleNarrative()
    {
        var parts = new List<string>
        {
            "Your lie falls apart spectacularly. The NPC sees through you completely."
        };

        if (CombatInitiated)
            parts.Add("Enraged, they attack!");
        else if (SettlementBan)
            parts.Add($"You are banished from the settlement{(SettlementBanDuration > 0 ? $" for {SettlementBanDuration} days" : " permanently")}.");

        if (QuestFailed)
            parts.Add("Your mission has failed.");

        if (UntrustworthyApplied)
            parts.Add("Word of your dishonesty will spread.");

        return string.Join(" ", parts);
    }

    /// <summary>
    /// Creates a successful deception result.
    /// </summary>
    public static DeceptionResult Success(
        SkillOutcome outcome,
        int playerSuccesses,
        int npcSuccesses,
        int stressCost,
        IReadOnlyList<string>? unlockedOptions = null)
    {
        return new DeceptionResult(
            Outcome: outcome,
            LieBelieved: true,
            PlayerSuccesses: playerSuccesses,
            NpcSuccesses: npcSuccesses,
            Margin: playerSuccesses - npcSuccesses,
            NpcSuspicionChange: 0,
            StressCost: stressCost,
            DispositionChange: 0,
            UnlockedOptions: unlockedOptions ?? Array.Empty<string>(),
            LockedOptions: Array.Empty<string>(),
            FumbleConsequence: null,
            CombatInitiated: false,
            SettlementBan: false,
            SettlementBanDuration: 0,
            QuestFailed: false,
            FailedQuestId: null,
            UntrustworthyApplied: false);
    }

    /// <summary>
    /// Creates a failed deception result (not fumble).
    /// </summary>
    public static DeceptionResult Failure(
        int playerSuccesses,
        int npcSuccesses,
        int stressCost,
        int dispositionChange,
        IReadOnlyList<string>? lockedOptions = null)
    {
        return new DeceptionResult(
            Outcome: SkillOutcome.Failure,
            LieBelieved: false,
            PlayerSuccesses: playerSuccesses,
            NpcSuccesses: npcSuccesses,
            Margin: playerSuccesses - npcSuccesses,
            NpcSuspicionChange: 1, // NPC becomes suspicious
            StressCost: stressCost,
            DispositionChange: dispositionChange,
            UnlockedOptions: Array.Empty<string>(),
            LockedOptions: lockedOptions ?? Array.Empty<string>(),
            FumbleConsequence: null,
            CombatInitiated: false,
            SettlementBan: false,
            SettlementBanDuration: 0,
            QuestFailed: false,
            FailedQuestId: null,
            UntrustworthyApplied: false);
    }

    /// <summary>
    /// Creates a fumble result with [Lie Exposed] consequences.
    /// </summary>
    public static DeceptionResult Fumble(
        int playerSuccesses,
        int npcSuccesses,
        int stressCost,
        FumbleConsequence fumbleConsequence,
        bool combatInitiated,
        bool settlementBan,
        int banDuration,
        bool questFailed,
        string? failedQuestId)
    {
        return new DeceptionResult(
            Outcome: SkillOutcome.Fumble,
            LieBelieved: false,
            PlayerSuccesses: playerSuccesses,
            NpcSuccesses: npcSuccesses,
            Margin: playerSuccesses - npcSuccesses,
            NpcSuspicionChange: 2, // NPC is now very suspicious
            StressCost: stressCost,
            DispositionChange: -30,
            UnlockedOptions: Array.Empty<string>(),
            LockedOptions: Array.Empty<string>(), // All deception locked via fumble
            FumbleConsequence: fumbleConsequence,
            CombatInitiated: combatInitiated,
            SettlementBan: settlementBan,
            SettlementBanDuration: banDuration,
            QuestFailed: questFailed,
            FailedQuestId: failedQuestId,
            UntrustworthyApplied: true);
    }
}
```

---

## 7. CoverStoryQuality Enum

### 7.1 Enum Definition

**File:** `src/Core/RuneAndRust.Domain/Enums/CoverStoryQuality.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Evaluates the quality of a prepared cover story for deception.
/// </summary>
/// <remarks>
/// <para>
/// Cover story quality is determined by how much preparation the player
/// has invested in creating a believable alternate identity or explanation.
/// Higher quality cover stories reduce the DC of deception attempts.
/// </para>
/// <para>
/// Cover stories are typically established through roleplay, research,
/// or specific actions before the deception attempt.
/// </para>
/// </remarks>
public enum CoverStoryQuality
{
    /// <summary>
    /// No prepared cover story; improvised lie.
    /// </summary>
    /// <remarks>
    /// <para>DC Modifier: +0</para>
    /// <para>The player is making up the lie on the spot.</para>
    /// </remarks>
    None = 0,

    /// <summary>
    /// Basic cover story with few details.
    /// </summary>
    /// <remarks>
    /// <para>DC Modifier: -1</para>
    /// <para>Player has a general story but lacks specific details.</para>
    /// <para>Example: "I'm a merchant" but can't name specific goods or routes.</para>
    /// </remarks>
    Basic = 1,

    /// <summary>
    /// Good cover story with consistent details.
    /// </summary>
    /// <remarks>
    /// <para>DC Modifier: -2</para>
    /// <para>Player has memorized names, places, and a coherent backstory.</para>
    /// <para>Example: "I'm a merchant from Ironhold, I trade in salvage parts."</para>
    /// </remarks>
    Good = 2,

    /// <summary>
    /// Excellent cover story with researched, verifiable elements.
    /// </summary>
    /// <remarks>
    /// <para>DC Modifier: -3</para>
    /// <para>Player has done research and includes verifiable details.</para>
    /// <para>Example: Knows the merchant guild master's name, recent trade routes,
    /// and can discuss current market conditions accurately.</para>
    /// </remarks>
    Excellent = 3,

    /// <summary>
    /// Masterwork cover story with supporting proof.
    /// </summary>
    /// <remarks>
    /// <para>DC Modifier: -4</para>
    /// <para>Player has an airtight cover story with physical evidence.</para>
    /// <para>Typically requires forged documents, planted witnesses, or
    /// other elaborate preparation.</para>
    /// <para>Example: Has forged guild credentials, knows secret handshakes,
    /// has a reference from a real guild member (bribed or coerced).</para>
    /// </remarks>
    Masterwork = 4
}
```

### 7.2 Extension Methods

**File:** `src/Core/RuneAndRust.Domain/Extensions/CoverStoryQualityExtensions.cs`

```csharp
namespace RuneAndRust.Domain.Extensions;

using RuneAndRust.Domain.Enums;

/// <summary>
/// Extension methods for <see cref="CoverStoryQuality"/> enum.
/// </summary>
public static class CoverStoryQualityExtensions
{
    /// <summary>
    /// Gets the DC modifier for this cover story quality.
    /// </summary>
    /// <param name="quality">The cover story quality.</param>
    /// <returns>The DC modifier (negative values reduce DC).</returns>
    public static int GetDcModifier(this CoverStoryQuality quality)
    {
        return quality switch
        {
            CoverStoryQuality.None => 0,
            CoverStoryQuality.Basic => -1,
            CoverStoryQuality.Good => -2,
            CoverStoryQuality.Excellent => -3,
            CoverStoryQuality.Masterwork => -4,
            _ => 0
        };
    }

    /// <summary>
    /// Gets whether this cover story quality requires preparation.
    /// </summary>
    /// <param name="quality">The cover story quality.</param>
    /// <returns>True if the quality requires prior preparation.</returns>
    public static bool RequiresPreparation(this CoverStoryQuality quality)
    {
        return quality >= CoverStoryQuality.Good;
    }

    /// <summary>
    /// Gets whether this cover story quality typically needs supporting evidence.
    /// </summary>
    /// <param name="quality">The cover story quality.</param>
    /// <returns>True if forged documents or other evidence is typically needed.</returns>
    public static bool RequiresEvidence(this CoverStoryQuality quality)
    {
        return quality == CoverStoryQuality.Masterwork;
    }

    /// <summary>
    /// Gets a human-readable description of the cover story quality.
    /// </summary>
    /// <param name="quality">The cover story quality.</param>
    /// <returns>A descriptive string for UI display.</returns>
    public static string GetDescription(this CoverStoryQuality quality)
    {
        return quality switch
        {
            CoverStoryQuality.None => "None (improvised)",
            CoverStoryQuality.Basic => "Basic (-1 DC) - General story, few details",
            CoverStoryQuality.Good => "Good (-2 DC) - Consistent details, names",
            CoverStoryQuality.Excellent => "Excellent (-3 DC) - Researched, verifiable",
            CoverStoryQuality.Masterwork => "Masterwork (-4 DC) - Airtight with proof",
            _ => "Unknown quality"
        };
    }
}
```

---

## 8. LiarsBurden Value Object

### 8.1 Class Definition

**File:** `src/Core/RuneAndRust.Domain/ValueObjects/LiarsBurden.cs`

```csharp
namespace RuneAndRust.Domain.ValueObjects;

using RuneAndRust.Domain.Enums;

/// <summary>
/// Tracks the psychic stress cost of deception.
/// </summary>
/// <remarks>
/// <para>
/// The Liar's Burden represents the psychological toll of maintaining
/// falsehoods. Unlike persuasion, deception always incurs a stress cost
/// regardless of outcome, though the cost varies by result:
/// </para>
/// <list type="bullet">
/// <item><description>Success: +1 Psychic Stress</description></item>
/// <item><description>Failure: +3 Psychic Stress</description></item>
/// <item><description>Fumble: +8 Psychic Stress (plus +5 from [Lie Exposed])</description></item>
/// </list>
/// <para>
/// This mechanic discourages over-reliance on deception and creates
/// interesting resource management decisions for players.
/// </para>
/// </remarks>
/// <param name="Outcome">The outcome of the deception attempt.</param>
/// <param name="IsFumble">Whether the roll was a fumble.</param>
public readonly record struct LiarsBurden(SkillOutcome Outcome, bool IsFumble)
{
    /// <summary>
    /// Stress cost for successful deception.
    /// </summary>
    public const int SuccessStressCost = 1;

    /// <summary>
    /// Stress cost for failed deception.
    /// </summary>
    public const int FailureStressCost = 3;

    /// <summary>
    /// Base stress cost for fumbled deception.
    /// </summary>
    public const int FumbleBaseStressCost = 8;

    /// <summary>
    /// Additional stress from [Lie Exposed] consequence.
    /// </summary>
    public const int LieExposedAdditionalStress = 5;

    /// <summary>
    /// Gets the base stress cost from the Liar's Burden.
    /// </summary>
    public int BaseStressCost => Outcome switch
    {
        SkillOutcome.CriticalSuccess => SuccessStressCost,
        SkillOutcome.ExceptionalSuccess => SuccessStressCost,
        SkillOutcome.FullSuccess => SuccessStressCost,
        SkillOutcome.MarginalSuccess => SuccessStressCost,
        SkillOutcome.Failure => FailureStressCost,
        SkillOutcome.Fumble => FumbleBaseStressCost,
        _ => FailureStressCost
    };

    /// <summary>
    /// Gets the additional stress from [Lie Exposed] if applicable.
    /// </summary>
    public int LieExposedStress => IsFumble ? LieExposedAdditionalStress : 0;

    /// <summary>
    /// Gets the total stress cost.
    /// </summary>
    public int TotalStressCost => BaseStressCost + LieExposedStress;

    /// <summary>
    /// Gets a narrative description of the stress effect.
    /// </summary>
    public string GetNarrativeDescription()
    {
        if (IsFumble)
        {
            return $"The shame of exposure burns in your mind. (+{TotalStressCost} Psychic Stress)";
        }

        return Outcome switch
        {
            SkillOutcome.CriticalSuccess or
            SkillOutcome.ExceptionalSuccess or
            SkillOutcome.FullSuccess =>
                $"The weight of deception settles in your mind. (+{TotalStressCost} Psychic Stress)",
            SkillOutcome.MarginalSuccess =>
                $"You got away with it, but the close call rattles you. (+{TotalStressCost} Psychic Stress)",
            SkillOutcome.Failure =>
                $"Your failed lie haunts you. Did they see through you completely? (+{TotalStressCost} Psychic Stress)",
            _ => $"The lie takes its toll. (+{TotalStressCost} Psychic Stress)"
        };
    }

    /// <summary>
    /// Creates a LiarsBurden for a successful deception.
    /// </summary>
    public static LiarsBurden ForSuccess(SkillOutcome outcome = SkillOutcome.FullSuccess)
    {
        return new LiarsBurden(outcome, false);
    }

    /// <summary>
    /// Creates a LiarsBurden for a failed deception.
    /// </summary>
    public static LiarsBurden ForFailure()
    {
        return new LiarsBurden(SkillOutcome.Failure, false);
    }

    /// <summary>
    /// Creates a LiarsBurden for a fumbled deception with [Lie Exposed].
    /// </summary>
    public static LiarsBurden ForFumble()
    {
        return new LiarsBurden(SkillOutcome.Fumble, true);
    }
}
```

---

## 9. IDeceptionService Interface

### 9.1 Interface Definition

**File:** `src/Core/RuneAndRust.Application/Interfaces/IDeceptionService.cs`

```csharp
namespace RuneAndRust.Application.Interfaces;

using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Service for handling deception attempts.
/// </summary>
/// <remarks>
/// <para>
/// The deception service manages the complete lifecycle of a deception
/// attempt, from building context to resolving the opposed roll and
/// applying all consequences including the Liar's Burden stress cost.
/// </para>
/// <para>
/// Deception uses an opposed roll system: Player (WILL + Rhetoric) vs.
/// NPC (WITS), with various modifiers applied to both sides.
/// </para>
/// </remarks>
public interface IDeceptionService
{
    /// <summary>
    /// Attempts to deceive an NPC.
    /// </summary>
    /// <param name="characterId">The ID of the character attempting deception.</param>
    /// <param name="targetNpcId">The ID of the NPC being deceived.</param>
    /// <param name="lieComplexity">The complexity of the lie being told.</param>
    /// <param name="coverStoryQuality">The quality of any prepared cover story.</param>
    /// <param name="hasForgedDocuments">Whether the character has forged documents.</param>
    /// <param name="forgedDocumentQuality">Quality of forged documents (0=none, 1=basic, 2=high).</param>
    /// <param name="lieContainsTruth">Whether the lie incorporates some genuine truth.</param>
    /// <returns>The result of the deception attempt.</returns>
    Task<DeceptionResult> AttemptDeceptionAsync(
        string characterId,
        string targetNpcId,
        LieComplexity lieComplexity,
        CoverStoryQuality coverStoryQuality = CoverStoryQuality.None,
        bool hasForgedDocuments = false,
        int forgedDocumentQuality = 0,
        bool lieContainsTruth = false);

    /// <summary>
    /// Builds the complete deception context for a potential attempt.
    /// </summary>
    /// <remarks>
    /// Use this to preview the difficulty and modifiers before committing
    /// to a deception attempt.
    /// </remarks>
    /// <param name="characterId">The ID of the character.</param>
    /// <param name="targetNpcId">The ID of the target NPC.</param>
    /// <param name="lieComplexity">The complexity of the intended lie.</param>
    /// <param name="coverStoryQuality">The quality of any prepared cover story.</param>
    /// <param name="hasForgedDocuments">Whether the character has forged documents.</param>
    /// <param name="forgedDocumentQuality">Quality of forged documents.</param>
    /// <param name="lieContainsTruth">Whether the lie incorporates truth.</param>
    /// <returns>The complete deception context with all modifiers calculated.</returns>
    Task<DeceptionContext> BuildContextAsync(
        string characterId,
        string targetNpcId,
        LieComplexity lieComplexity,
        CoverStoryQuality coverStoryQuality = CoverStoryQuality.None,
        bool hasForgedDocuments = false,
        int forgedDocumentQuality = 0,
        bool lieContainsTruth = false);

    /// <summary>
    /// Checks if the player has the [Untrustworthy] flag with a specific NPC.
    /// </summary>
    /// <param name="characterId">The ID of the character.</param>
    /// <param name="npcId">The ID of the NPC.</param>
    /// <returns>True if the character has the [Untrustworthy] flag with this NPC.</returns>
    Task<bool> HasUntrustworthyFlagAsync(string characterId, string npcId);

    /// <summary>
    /// Attempts to remove the [Untrustworthy] flag with a specific NPC.
    /// </summary>
    /// <remarks>
    /// Removal requires specific conditions such as completing a beneficial quest,
    /// saving the NPC, significant time passage, or third-party intercession.
    /// </remarks>
    /// <param name="characterId">The ID of the character.</param>
    /// <param name="npcId">The ID of the NPC.</param>
    /// <param name="removalReason">The reason for removal (quest, rescue, time, intercession).</param>
    /// <returns>True if the flag was successfully removed.</returns>
    Task<bool> TryRemoveUntrustworthyFlagAsync(
        string characterId,
        string npcId,
        UntrustworthyRemovalReason removalReason);

    /// <summary>
    /// Calculates the Liar's Burden stress cost for an outcome.
    /// </summary>
    /// <param name="outcome">The skill outcome.</param>
    /// <param name="isFumble">Whether the roll was a fumble.</param>
    /// <returns>The Liar's Burden with calculated stress costs.</returns>
    LiarsBurden CalculateLiarsBurden(SkillOutcome outcome, bool isFumble);
}

/// <summary>
/// Reasons for removing the [Untrustworthy] flag.
/// </summary>
public enum UntrustworthyRemovalReason
{
    /// <summary>
    /// Completed a quest that benefits the NPC.
    /// </summary>
    BeneficialQuest,

    /// <summary>
    /// Saved the NPC's life or property.
    /// </summary>
    RescuedNpc,

    /// <summary>
    /// Significant time has passed (2+ in-game weeks).
    /// </summary>
    TimePassage,

    /// <summary>
    /// A trusted third party vouched for the character.
    /// </summary>
    ThirdPartyIntercession
}
```

---

## 10. DeceptionService Implementation

### 10.1 Class Definition

**File:** `src/Core/RuneAndRust.Application/Services/DeceptionService.cs`

```csharp
namespace RuneAndRust.Application.Services;

using RuneAndRust.Application.Interfaces;
using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.Entities;
using RuneAndRust.Domain.ValueObjects;
using RuneAndRust.Domain.Extensions;
using Microsoft.Extensions.Logging;

/// <summary>
/// Implementation of the deception service.
/// </summary>
/// <remarks>
/// <para>
/// Handles the complete deception flow including context building,
/// opposed roll resolution, Liar's Burden stress application, and
/// [Lie Exposed] fumble consequence management.
/// </para>
/// </remarks>
public class DeceptionService : IDeceptionService
{
    private readonly IDiceRollerService _diceRoller;
    private readonly ICharacterRepository _characterRepository;
    private readonly INpcRepository _npcRepository;
    private readonly IStatusEffectService _statusEffectService;
    private readonly IFumbleConsequenceService _fumbleConsequenceService;
    private readonly ISkillStressService _skillStressService;
    private readonly IFactionService _factionService;
    private readonly IDialogueService _dialogueService;
    private readonly IQuestService _questService;
    private readonly ISettlementService _settlementService;
    private readonly ILogger<DeceptionService> _logger;
    private readonly Random _random;

    public DeceptionService(
        IDiceRollerService diceRoller,
        ICharacterRepository characterRepository,
        INpcRepository npcRepository,
        IStatusEffectService statusEffectService,
        IFumbleConsequenceService fumbleConsequenceService,
        ISkillStressService skillStressService,
        IFactionService factionService,
        IDialogueService dialogueService,
        IQuestService questService,
        ISettlementService settlementService,
        ILogger<DeceptionService> logger)
    {
        _diceRoller = diceRoller;
        _characterRepository = characterRepository;
        _npcRepository = npcRepository;
        _statusEffectService = statusEffectService;
        _fumbleConsequenceService = fumbleConsequenceService;
        _skillStressService = skillStressService;
        _factionService = factionService;
        _dialogueService = dialogueService;
        _questService = questService;
        _settlementService = settlementService;
        _logger = logger;
        _random = new Random();
    }

    /// <inheritdoc />
    public async Task<DeceptionResult> AttemptDeceptionAsync(
        string characterId,
        string targetNpcId,
        LieComplexity lieComplexity,
        CoverStoryQuality coverStoryQuality = CoverStoryQuality.None,
        bool hasForgedDocuments = false,
        int forgedDocumentQuality = 0,
        bool lieContainsTruth = false)
    {
        _logger.LogInformation(
            "Character {CharacterId} attempting {LieComplexity} deception against NPC {NpcId}",
            characterId, lieComplexity, targetNpcId);

        // Build complete context
        var context = await BuildContextAsync(
            characterId,
            targetNpcId,
            lieComplexity,
            coverStoryQuality,
            hasForgedDocuments,
            forgedDocumentQuality,
            lieContainsTruth);

        // Get character stats
        var character = await _characterRepository.GetByIdAsync(characterId);
        var willAttribute = character.Attributes.Will;
        var rhetoricSkill = character.Skills.GetRank("rhetoric");

        // Calculate player dice pool
        var playerBasePool = willAttribute + rhetoricSkill;
        var playerTotalPool = Math.Max(1, playerBasePool + context.PlayerDiceModifier);

        // Perform player roll
        var playerRoll = _diceRoller.Roll(playerTotalPool);

        _logger.LogDebug(
            "Player rolled {Pool}d10: {Successes} successes, {Botches} botches",
            playerTotalPool, playerRoll.Successes, playerRoll.Botches);

        // Check for fumble (0 successes + ≥1 botch)
        if (playerRoll.IsFumble)
        {
            return await HandleFumbleAsync(characterId, targetNpcId, context, playerRoll, lieComplexity);
        }

        // Perform NPC opposed roll
        var npcRoll = _diceRoller.Roll(context.NpcDicePool);

        _logger.LogDebug(
            "NPC rolled {Pool}d10: {Successes} successes",
            context.NpcDicePool, npcRoll.Successes);

        // Compare successes
        var margin = playerRoll.NetSuccesses - npcRoll.NetSuccesses;
        var outcome = DetermineOutcome(margin, playerRoll);

        // Calculate and apply Liar's Burden
        var liarsBurden = CalculateLiarsBurden(outcome, false);
        await _skillStressService.ApplyStressAsync(characterId, liarsBurden.TotalStressCost, "Liar's Burden");

        if (outcome >= SkillOutcome.MarginalSuccess)
        {
            return await HandleSuccessAsync(
                characterId, targetNpcId, context, outcome,
                playerRoll.NetSuccesses, npcRoll.NetSuccesses, liarsBurden.TotalStressCost);
        }
        else
        {
            return await HandleFailureAsync(
                characterId, targetNpcId, context,
                playerRoll.NetSuccesses, npcRoll.NetSuccesses, liarsBurden.TotalStressCost);
        }
    }

    /// <inheritdoc />
    public async Task<DeceptionContext> BuildContextAsync(
        string characterId,
        string targetNpcId,
        LieComplexity lieComplexity,
        CoverStoryQuality coverStoryQuality = CoverStoryQuality.None,
        bool hasForgedDocuments = false,
        int forgedDocumentQuality = 0,
        bool lieContainsTruth = false)
    {
        var npc = await _npcRepository.GetByIdAsync(targetNpcId);
        var character = await _characterRepository.GetByIdAsync(characterId);

        // Get NPC states
        var npcSuspicious = await _statusEffectService.HasStatusAsync(targetNpcId, StatusEffectId.Suspicious);
        var npcTrusting = await _statusEffectService.HasStatusAsync(targetNpcId, StatusEffectId.Trusting);
        var npcAlert = await _statusEffectService.HasStatusAsync(targetNpcId, StatusEffectId.Alert);
        var npcFatigued = await _statusEffectService.HasStatusAsync(targetNpcId, StatusEffectId.Fatigued);

        // Get faction standing
        var factionStanding = npc.FactionId != null
            ? await _factionService.GetStandingAsync(characterId, npc.FactionId)
            : 0;

        // Check for [Untrustworthy] flag
        var hasUntrustworthy = await HasUntrustworthyFlagAsync(characterId, targetNpcId);

        // Check for contradicting evidence (would need to be passed in or queried)
        // For now, assume no contradicting evidence unless specified
        var evidenceContradicts = false;
        string? contradictingEvidence = null;

        return new DeceptionContext(
            LieComplexity: lieComplexity,
            TargetId: targetNpcId,
            TargetWits: npc.Attributes.Wits,
            TargetDisposition: npc.GetDispositionToward(characterId),
            NpcSuspicious: npcSuspicious,
            NpcTrusting: npcTrusting,
            NpcTrainedObserver: npc.IsTrainedObserver,
            NpcPreviouslyFooled: npc.WasFooledBy(characterId),
            NpcHasAlert: npcAlert,
            NpcHasFatigued: npcFatigued,
            NpcKnowsPlayer: npc.KnowsCharacter(characterId),
            EvidenceContradicts: evidenceContradicts,
            ContradictingEvidenceDescription: contradictingEvidence,
            CoverStoryQuality: coverStoryQuality,
            HasForgedDocuments: hasForgedDocuments,
            ForgedDocumentQuality: forgedDocumentQuality,
            LieContainsTruth: lieContainsTruth,
            NpcIsDistracted: npc.IsDistracted,
            NpcIsIntoxicated: npc.IsIntoxicated,
            PlayerHasUntrustworthy: hasUntrustworthy,
            PlayerFactionStanding: factionStanding);
    }

    /// <inheritdoc />
    public async Task<bool> HasUntrustworthyFlagAsync(string characterId, string npcId)
    {
        return await _statusEffectService.HasRelationshipStatusAsync(
            characterId, npcId, StatusEffectId.Untrustworthy);
    }

    /// <inheritdoc />
    public async Task<bool> TryRemoveUntrustworthyFlagAsync(
        string characterId,
        string npcId,
        UntrustworthyRemovalReason removalReason)
    {
        var hasFlag = await HasUntrustworthyFlagAsync(characterId, npcId);
        if (!hasFlag) return true;

        // Validate removal conditions
        var canRemove = removalReason switch
        {
            UntrustworthyRemovalReason.BeneficialQuest =>
                await _questService.HasCompletedBeneficialQuestForAsync(characterId, npcId),
            UntrustworthyRemovalReason.RescuedNpc =>
                await _npcRepository.WasRescuedByAsync(npcId, characterId),
            UntrustworthyRemovalReason.TimePassage =>
                await HasSufficientTimePassedAsync(characterId, npcId),
            UntrustworthyRemovalReason.ThirdPartyIntercession =>
                await HasThirdPartyVouchedAsync(characterId, npcId),
            _ => false
        };

        if (canRemove)
        {
            await _statusEffectService.RemoveRelationshipStatusAsync(
                characterId, npcId, StatusEffectId.Untrustworthy);

            _logger.LogInformation(
                "Removed [Untrustworthy] flag between {CharacterId} and {NpcId} due to {Reason}",
                characterId, npcId, removalReason);
        }

        return canRemove;
    }

    /// <inheritdoc />
    public LiarsBurden CalculateLiarsBurden(SkillOutcome outcome, bool isFumble)
    {
        return new LiarsBurden(outcome, isFumble);
    }

    private SkillOutcome DetermineOutcome(int margin, DiceRollResult playerRoll)
    {
        if (playerRoll.IsCriticalSuccess && margin >= 5)
            return SkillOutcome.CriticalSuccess;
        if (margin >= 3)
            return SkillOutcome.ExceptionalSuccess;
        if (margin >= 1)
            return SkillOutcome.FullSuccess;
        if (margin == 0)
            return SkillOutcome.MarginalSuccess;
        return SkillOutcome.Failure;
    }

    private async Task<DeceptionResult> HandleSuccessAsync(
        string characterId,
        string targetNpcId,
        DeceptionContext context,
        SkillOutcome outcome,
        int playerSuccesses,
        int npcSuccesses,
        int stressCost)
    {
        _logger.LogInformation(
            "Deception succeeded with outcome {Outcome}",
            outcome);

        // Mark NPC as fooled (for future encounters)
        var npc = await _npcRepository.GetByIdAsync(targetNpcId);
        await _npcRepository.MarkAsFooledByAsync(targetNpcId, characterId);

        // On critical success, NPC may become [Trusting]
        if (outcome == SkillOutcome.CriticalSuccess)
        {
            await _statusEffectService.ApplyStatusAsync(targetNpcId, StatusEffectId.Trusting, duration: null);
        }

        // Unlock dialogue options based on the deception
        var unlockedOptions = await _dialogueService.GetDeceptionUnlocksAsync(targetNpcId, context.LieComplexity);

        return DeceptionResult.Success(
            outcome: outcome,
            playerSuccesses: playerSuccesses,
            npcSuccesses: npcSuccesses,
            stressCost: stressCost,
            unlockedOptions: unlockedOptions);
    }

    private async Task<DeceptionResult> HandleFailureAsync(
        string characterId,
        string targetNpcId,
        DeceptionContext context,
        int playerSuccesses,
        int npcSuccesses,
        int stressCost)
    {
        _logger.LogInformation("Deception failed");

        // NPC becomes suspicious
        await _statusEffectService.ApplyStatusAsync(targetNpcId, StatusEffectId.Suspicious, duration: null);

        // Small disposition loss
        var npc = await _npcRepository.GetByIdAsync(targetNpcId);
        await _npcRepository.ModifyDispositionAsync(targetNpcId, characterId, -10);

        // Lock deception options
        var lockedOptions = await _dialogueService.LockDeceptionOptionsAsync(targetNpcId, context.LieComplexity);

        return DeceptionResult.Failure(
            playerSuccesses: playerSuccesses,
            npcSuccesses: npcSuccesses,
            stressCost: stressCost,
            dispositionChange: -10,
            lockedOptions: lockedOptions);
    }

    private async Task<DeceptionResult> HandleFumbleAsync(
        string characterId,
        string targetNpcId,
        DeceptionContext context,
        DiceRollResult playerRoll,
        LieComplexity lieComplexity)
    {
        _logger.LogWarning(
            "Deception fumbled! [Lie Exposed] consequence triggered for {CharacterId}",
            characterId);

        // Calculate stress with fumble penalty
        var liarsBurden = CalculateLiarsBurden(SkillOutcome.Fumble, true);
        await _skillStressService.ApplyStressAsync(characterId, liarsBurden.TotalStressCost, "Lie Exposed");

        // Create fumble consequence
        var fumbleConsequence = await _fumbleConsequenceService.CreateAsync(
            FumbleType.LieExposed,
            characterId,
            targetNpcId);

        // Apply [Untrustworthy] flag
        await _statusEffectService.ApplyRelationshipStatusAsync(
            characterId, targetNpcId, StatusEffectId.Untrustworthy, duration: null);

        // Major disposition loss
        await _npcRepository.ModifyDispositionAsync(targetNpcId, characterId, -30);

        // Lock all deception options
        await _dialogueService.LockAllDeceptionOptionsAsync(targetNpcId);

        // Determine additional consequences
        var combatInitiated = await DetermineCombatInitiationAsync(targetNpcId, lieComplexity);
        var (settlementBan, banDuration) = await DetermineSettlementBanAsync(characterId, targetNpcId, lieComplexity);
        var (questFailed, failedQuestId) = await DetermineQuestFailureAsync(characterId, targetNpcId);

        // Initiate combat if triggered
        if (combatInitiated)
        {
            await InitiateCombatWithNpcAsync(targetNpcId);
        }

        // Apply settlement ban if triggered
        if (settlementBan)
        {
            await _settlementService.BanCharacterAsync(characterId, banDuration);
        }

        // Fail quest if triggered
        if (questFailed && failedQuestId != null)
        {
            await _questService.FailQuestAsync(failedQuestId);
        }

        return DeceptionResult.Fumble(
            playerSuccesses: playerRoll.NetSuccesses,
            npcSuccesses: 0,
            stressCost: liarsBurden.TotalStressCost,
            fumbleConsequence: fumbleConsequence,
            combatInitiated: combatInitiated,
            settlementBan: settlementBan,
            banDuration: banDuration,
            questFailed: questFailed,
            failedQuestId: failedQuestId);
    }

    private async Task<bool> DetermineCombatInitiationAsync(string npcId, LieComplexity lieComplexity)
    {
        var npc = await _npcRepository.GetByIdAsync(npcId);

        // Base 50% chance
        var combatChance = 50;

        // Modify based on lie complexity
        combatChance += lieComplexity.GetCombatChanceModifier();

        // Modify based on NPC type
        if (npc.IsGuard || npc.IsSoldier) combatChance += 10;
        if (npc.IsMerchant || npc.IsCivilian) combatChance -= 10;
        if (npc.HasBackupNearby) combatChance += 10;

        var roll = _random.Next(1, 101);
        return roll <= combatChance;
    }

    private async Task<(bool Ban, int Duration)> DetermineSettlementBanAsync(
        string characterId,
        string npcId,
        LieComplexity lieComplexity)
    {
        var npc = await _npcRepository.GetByIdAsync(npcId);

        // Only certain NPCs can impose bans
        if (!npc.CanImposeBan) return (false, 0);

        // Determine ban chance based on context
        var banChance = npc.IsOfficial ? 50 : 30;
        banChance += lieComplexity >= LieComplexity.Unlikely ? 20 : 0;

        var roll = _random.Next(1, 101);
        if (roll > banChance) return (false, 0);

        // Determine duration (1d6 days, or 0 for permanent on extreme lies)
        var duration = lieComplexity == LieComplexity.Outrageous && roll <= 10
            ? 0 // Permanent
            : _random.Next(1, 7); // 1-6 days

        return (true, duration);
    }

    private async Task<(bool Failed, string? QuestId)> DetermineQuestFailureAsync(
        string characterId,
        string npcId)
    {
        // Check if there's an active quest involving deception with this NPC
        var activeQuest = await _questService.GetActiveDeceptionQuestAsync(characterId, npcId);

        if (activeQuest == null) return (false, null);

        // Check if the deception was on the critical path
        if (activeQuest.IsDeceptionCriticalPath)
        {
            return (true, activeQuest.QuestId);
        }

        return (false, null);
    }

    private async Task InitiateCombatWithNpcAsync(string npcId)
    {
        var npc = await _npcRepository.GetByIdAsync(npcId);

        // Apply [Furious] buff to NPC
        await _statusEffectService.ApplyStatusAsync(npcId, StatusEffectId.Furious, duration: 3);

        // Trigger combat through combat service
        // This would integrate with the combat system from v0.11.x
        _logger.LogInformation("Combat initiated with NPC {NpcId} due to [Lie Exposed]", npcId);
    }

    private async Task<bool> HasSufficientTimePassedAsync(string characterId, string npcId)
    {
        // Check if 2+ in-game weeks have passed since the flag was applied
        var flagAppliedTime = await _statusEffectService.GetRelationshipStatusAppliedTimeAsync(
            characterId, npcId, StatusEffectId.Untrustworthy);

        if (flagAppliedTime == null) return false;

        var gameTime = await _characterRepository.GetGameTimeAsync(characterId);
        var daysPassed = (gameTime - flagAppliedTime.Value).Days;

        return daysPassed >= 14; // 2 weeks
    }

    private async Task<bool> HasThirdPartyVouchedAsync(string characterId, string npcId)
    {
        // Check if a trusted third party has vouched for the character
        return await _npcRepository.HasThirdPartyVouchedAsync(npcId, characterId);
    }
}
```

---

## 11. LieExposed Fumble Consequence

### 11.1 FumbleType Extension

**File:** `src/Core/RuneAndRust.Domain/Enums/FumbleType.cs` (modification)

```csharp
// Add to existing FumbleType enum:

/// <summary>
/// [Lie Exposed] - Deception fumble consequence.
/// </summary>
/// <remarks>
/// <para>Effects:</para>
/// <list type="bullet">
/// <item><description>+8 base Psychic Stress + 5 additional from exposure</description></item>
/// <item><description>[Untrustworthy] flag applied with this NPC</description></item>
/// <item><description>All deception options locked with this NPC</description></item>
/// <item><description>50% chance of combat initiation</description></item>
/// <item><description>Possible settlement ban</description></item>
/// <item><description>Possible quest failure</description></item>
/// </list>
/// <para>Recovery: Complete beneficial quest, rescue NPC, time passage, or intercession.</para>
/// </remarks>
LieExposed = 10,
```

### 11.2 LieExposed Consequence Handler

**File:** `src/Core/RuneAndRust.Application/Services/FumbleConsequenceHandlers/LieExposedHandler.cs`

```csharp
namespace RuneAndRust.Application.Services.FumbleConsequenceHandlers;

using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.Entities;

/// <summary>
/// Handles the [Lie Exposed] fumble consequence from failed deception.
/// </summary>
public class LieExposedHandler : IFumbleConsequenceHandler
{
    /// <inheritdoc />
    public FumbleType FumbleType => FumbleType.LieExposed;

    /// <inheritdoc />
    public string DisplayName => "[Lie Exposed]";

    /// <inheritdoc />
    public string Description =>
        "Your deception has been completely exposed. The NPC sees through your lies and knows you for what you are.";

    /// <inheritdoc />
    public int BaseStressCost => 8;

    /// <inheritdoc />
    public int AdditionalStressCost => 5;

    /// <inheritdoc />
    public bool IsPersistent => true;

    /// <inheritdoc />
    public FumbleConsequence CreateConsequence(string characterId, string? targetId)
    {
        return new FumbleConsequence
        {
            Id = Guid.NewGuid().ToString(),
            FumbleType = FumbleType.LieExposed,
            CharacterId = characterId,
            TargetId = targetId,
            AppliedAt = DateTime.UtcNow,
            IsPersistent = true,
            RecoveryConditions = new List<string>
            {
                "Complete a quest that benefits the NPC",
                "Save the NPC's life or property",
                "Significant time passage (2+ in-game weeks)",
                "A trusted third party vouches for you"
            },
            Effects = new Dictionary<string, object>
            {
                ["untrustworthy_applied"] = true,
                ["deception_locked"] = true,
                ["combat_chance"] = 50,
                ["ban_possible"] = true
            }
        };
    }

    /// <inheritdoc />
    public IReadOnlyList<string> GetRecoveryConditions()
    {
        return new[]
        {
            "Complete a quest that significantly benefits the NPC",
            "Save the NPC's life or property from danger",
            "Significant time passage (2+ in-game weeks)",
            "Third-party intercession (mutual friend vouches for you)"
        };
    }

    /// <inheritdoc />
    public string GetNarrativeText(FumbleConsequence consequence)
    {
        return "Your lies unravel spectacularly. Every word you spoke now rings false " +
               "in the NPC's ears. They see the truth of what you are - a deceiver. " +
               "Word of your dishonesty may spread. Trust, once broken, is not easily mended.";
    }
}
```

---

## 12. Untrustworthy Status Effect

### 12.1 StatusEffectId Extension

**File:** `src/Core/RuneAndRust.Domain/Enums/StatusEffectId.cs` (modification)

```csharp
// Add to existing StatusEffectId enum:

/// <summary>
/// [Untrustworthy] - Player has been caught lying to this NPC.
/// </summary>
/// <remarks>
/// <para>Effect: All deception checks with this NPC have +3 DC.</para>
/// <para>May spread to other NPCs who communicate with this one.</para>
/// <para>Removal requires specific recovery conditions.</para>
/// </remarks>
Untrustworthy = 200,

/// <summary>
/// [Suspicious] - NPC is on guard for deception.
/// </summary>
/// <remarks>
/// <para>Effect: Deception checks against this NPC have +4 DC.</para>
/// <para>Applied when a lie fails (but doesn't fumble).</para>
/// </remarks>
Suspicious = 201,

/// <summary>
/// [Trusting] - NPC believes the player is honest.
/// </summary>
/// <remarks>
/// <para>Effect: Deception checks against this NPC have -4 DC.</para>
/// <para>Applied on critical success deception or through relationship building.</para>
/// </remarks>
Trusting = 202,
```

### 12.2 Untrustworthy Effect Definition

**File:** `src/Infrastructure/RuneAndRust.Infrastructure/Configuration/StatusEffects/untrustworthy.json`

```json
{
  "id": "untrustworthy",
  "displayName": "[Untrustworthy]",
  "description": "Your dishonesty has been exposed. This NPC no longer trusts you.",
  "type": "social_debuff",
  "isPersistent": true,
  "isRelationshipBased": true,
  "dcModifier": 3,
  "appliesToSkill": "rhetoric",
  "appliesToInteraction": "deception",
  "canSpread": true,
  "spreadCondition": "npcs_communicate",
  "removalConditions": [
    {
      "type": "quest_completion",
      "requirement": "beneficial_to_npc"
    },
    {
      "type": "rescue",
      "requirement": "save_npc_life_or_property"
    },
    {
      "type": "time_passage",
      "requirement": "14_days"
    },
    {
      "type": "intercession",
      "requirement": "trusted_third_party"
    }
  ],
  "narrativeDescriptions": {
    "applied": "Word of your deception has marked you. {NpcName} will remember your lies.",
    "active": "{NpcName} eyes you with distrust, remembering your past dishonesty.",
    "removed": "{NpcName} has forgiven your past deceptions. Your trust is restored."
  }
}
```

---

## 13. Configuration

### 13.1 Lie Complexity Configuration

**File:** `src/Infrastructure/RuneAndRust.Infrastructure/Configuration/lie-complexity.json`

```json
{
  "version": "0.15.3c",
  "description": "Lie complexity tiers and DC values for the Deception System",
  "lieComplexityTiers": [
    {
      "id": "white_lie",
      "name": "White Lie",
      "baseDc": 10,
      "description": "Minor falsehoods that are easily believed and low stakes",
      "detectionSeverity": 1,
      "combatChanceModifier": -10,
      "requiresEvidence": false,
      "examples": [
        "I was here the whole time",
        "I didn't see anything",
        "I'm just passing through",
        "We've never met before"
      ],
      "npcReactionOnDetection": "Mild annoyance, slight suspicion"
    },
    {
      "id": "plausible",
      "name": "Plausible",
      "baseDc": 14,
      "description": "Believable lies that could reasonably be true given context",
      "detectionSeverity": 2,
      "combatChanceModifier": 0,
      "requiresEvidence": false,
      "examples": [
        "I'm with the Combine",
        "The captain sent me to relieve you",
        "I'm a merchant from the outer settlements",
        "This is my first time in the city"
      ],
      "npcReactionOnDetection": "Suspicion, possible refusal to interact"
    },
    {
      "id": "unlikely",
      "name": "Unlikely",
      "baseDc": 18,
      "description": "Lies that stretch credibility and typically require supporting details",
      "detectionSeverity": 3,
      "combatChanceModifier": 10,
      "requiresEvidence": true,
      "examples": [
        "The Warden sent me",
        "I'm a high-ranking official from the capital",
        "I discovered a cure for the blight",
        "The guards already cleared me to be here"
      ],
      "npcReactionOnDetection": "Alarm, possible hostility, report to authorities"
    },
    {
      "id": "outrageous",
      "name": "Outrageous",
      "baseDc": 22,
      "description": "Nearly unbelievable claims requiring extreme audacity",
      "detectionSeverity": 4,
      "combatChanceModifier": 20,
      "requiresEvidence": true,
      "examples": [
        "I am the Warden",
        "I single-handedly defeated the Iron-Bane warband",
        "I've been chosen by the Shattered God",
        "The entire settlement owes me a blood debt"
      ],
      "npcReactionOnDetection": "Immediate hostility, likely attack"
    }
  ],
  "dcModifiers": {
    "npcSuspicious": 4,
    "npcTrusting": -4,
    "evidenceContradicts": 6,
    "untrustworthy": 3,
    "coverStory": {
      "none": 0,
      "basic": -1,
      "good": -2,
      "excellent": -3,
      "masterwork": -4
    }
  },
  "diceModifiers": {
    "player": {
      "forgedDocumentsBasic": 1,
      "forgedDocumentsHigh": 2,
      "lieContainsTruth": 1,
      "npcDistracted": 1,
      "npcIntoxicated": 1,
      "honoredReputation": 1
    },
    "npc": {
      "trainedObserver": 1,
      "previouslyFooled": 1,
      "alertStatus": 1,
      "knowsPlayer": 1,
      "fatiguedStatus": -1
    }
  },
  "liarsBurden": {
    "successStress": 1,
    "failureStress": 3,
    "fumbleBaseStress": 8,
    "lieExposedAdditionalStress": 5
  },
  "fumbleConsequences": {
    "baseCombatChance": 50,
    "combatChanceModifiers": {
      "npcIsGuard": 10,
      "lieAboutCrime": 15,
      "npcHasBackup": 10,
      "npcIsCivilian": -10,
      "playerHonored": -15
    },
    "settlementBanChance": {
      "official": 50,
      "nonOfficial": 30,
      "unlikelyLieBonus": 20
    },
    "permanentBanThreshold": 10
  }
}
```

---

## 14. Commands

### 14.1 Deceive Command

**Command:** `deceive <npc_id> <lie_complexity>`

**Description:** Attempt to deceive an NPC with a lie of specified complexity.

**Parameters:**
- `npc_id` - The identifier of the NPC to deceive
- `lie_complexity` - The complexity tier: `whitelie`, `plausible`, `unlikely`, `outrageous`

**Options:**
- `--cover-story <quality>` - Specify cover story quality: `none`, `basic`, `good`, `excellent`, `masterwork`
- `--forged-docs` - Indicate possession of forged documents
- `--high-quality-forgery` - Indicate high-quality forged documents
- `--partial-truth` - Indicate the lie contains some genuine truth
- `--preview` - Show modifier breakdown without attempting the deception

**Examples:**
```
> deceive gate_guard plausible --cover-story good --forged-docs
Attempting deception against Gate Guard...
Lie Complexity: Plausible (DC 14)
Cover Story: Good (-2 DC)
Forged Documents: +1d10
Effective DC: 12

Rolling WILL (3) + Rhetoric (2) + 1 = 6d10...
Player: [9, 8, 5, 10, 3, 6] = 3 successes
NPC (WITS 3): [4, 7, 8] = 1 success
Margin: +2 (Full Success)

The guard examines your badge, then nods. "Right, you're expected."
The weight of deception settles in your mind. (+1 Psychic Stress)
```

### 14.2 Check Deception Command

**Command:** `check deception <npc_id> <lie_complexity>`

**Description:** Preview the modifiers and difficulty for a potential deception attempt without committing to it.

**Example:**
```
> check deception gate_guard unlikely --preview
Deception Preview:
  Lie: Unlikely (DC 18)
  Target: Gate Guard (WITS 3)

DC Modifiers:
  Base DC: 18
  Cover Story (None): +0

Your Pool: 5d10 (WILL 3 + Rhetoric 2)
NPC Pool: 3d10 (WITS 3)

WARNING: This lie complexity typically requires forged documents.
WARNING: Fumble would trigger [Lie Exposed] with high combat chance (60%).
```

---

## 15. User-Facing Changes

### 15.1 Deception Attempt Display

When a player attempts deception, the following information is displayed:

**Success Display:**
```
╔═══════════════════════════════════════════════════════════════╗
║                    DECEPTION: SUCCESS                          ║
╠═══════════════════════════════════════════════════════════════╣
║  Lie: "I'm with the guild, here on official business"          ║
║  Complexity: Plausible (DC 14)                                  ║
║                                                                 ║
║  Your Roll: 6d10 → [9, 8, 5, 10, 3, 6] = 3 successes           ║
║  NPC Roll: 3d10 → [4, 7, 8] = 1 success                        ║
║  Margin: +2 (Full Success)                                      ║
║                                                                 ║
║  The NPC accepts your story without question.                   ║
║                                                                 ║
║  ┌─────────────────────────────────────────────────────────┐   ║
║  │  LIAR'S BURDEN: +1 Psychic Stress                       │   ║
║  │  The weight of deception settles in your mind.          │   ║
║  └─────────────────────────────────────────────────────────┘   ║
╚═══════════════════════════════════════════════════════════════╝
```

**Failure Display:**
```
╔═══════════════════════════════════════════════════════════════╗
║                    DECEPTION: FAILURE                          ║
╠═══════════════════════════════════════════════════════════════╣
║  Lie: "The captain sent me"                                     ║
║  Complexity: Plausible (DC 14)                                  ║
║                                                                 ║
║  Your Roll: 5d10 → [4, 3, 7, 2, 5] = 0 successes               ║
║  NPC Roll: 4d10 → [8, 9, 6, 3] = 2 successes                   ║
║  Margin: -2 (Failure)                                           ║
║                                                                 ║
║  The NPC narrows their eyes. "Nice try. I don't buy it."        ║
║  [NPC is now SUSPICIOUS of you]                                 ║
║                                                                 ║
║  ┌─────────────────────────────────────────────────────────┐   ║
║  │  LIAR'S BURDEN: +3 Psychic Stress                       │   ║
║  │  Your failed lie haunts you. Did they see through       │   ║
║  │  you completely?                                        │   ║
║  └─────────────────────────────────────────────────────────┘   ║
╚═══════════════════════════════════════════════════════════════╝
```

**Fumble Display:**
```
╔═══════════════════════════════════════════════════════════════╗
║                 ⚠ DECEPTION: FUMBLE ⚠                          ║
║                    [LIE EXPOSED]                                ║
╠═══════════════════════════════════════════════════════════════╣
║  Lie: "I am the Warden"                                         ║
║  Complexity: Outrageous (DC 22)                                 ║
║                                                                 ║
║  Your Roll: 5d10 → [1, 4, 3, 2, 6] = 0 successes, 1 botch      ║
║  FUMBLE: 0 successes + botch                                    ║
║                                                                 ║
║  Your lie falls apart spectacularly. The guard's face           ║
║  twists with fury. "The WARDEN? You lying scum!"                ║
║                                                                 ║
║  ┌─────────────────────────────────────────────────────────┐   ║
║  │  CONSEQUENCES:                                          │   ║
║  │  • [UNTRUSTWORTHY] applied - all future deception +3 DC │   ║
║  │  • All deception options LOCKED with this NPC           │   ║
║  │  • Combat initiated! NPC gains [FURIOUS] (+1d10 damage) │   ║
║  └─────────────────────────────────────────────────────────┘   ║
║                                                                 ║
║  ┌─────────────────────────────────────────────────────────┐   ║
║  │  LIAR'S BURDEN: +13 Psychic Stress                      │   ║
║  │  (+8 fumble + 5 [Lie Exposed])                          │   ║
║  │  The shame of exposure burns in your mind.              │   ║
║  └─────────────────────────────────────────────────────────┘   ║
╚═══════════════════════════════════════════════════════════════╝
```

---

## 16. Logging Specifications

### 16.1 Log Events

| Event | Level | Format |
|-------|-------|--------|
| Deception Attempted | Information | `Character {CharacterId} attempting {LieComplexity} deception against NPC {NpcId}` |
| Context Built | Debug | `Deception context: DC {EffectiveDc}, Player modifiers {PlayerDiceModifier}, NPC pool {NpcDicePool}` |
| Player Roll | Debug | `Player rolled {Pool}d10: {Successes} successes, {Botches} botches` |
| NPC Roll | Debug | `NPC rolled {Pool}d10: {Successes} successes` |
| Success | Information | `Deception succeeded with outcome {Outcome}` |
| Failure | Information | `Deception failed, NPC becomes suspicious` |
| Fumble | Warning | `Deception fumbled! [Lie Exposed] consequence triggered for {CharacterId}` |
| Combat Initiated | Information | `Combat initiated with NPC {NpcId} due to [Lie Exposed]` |
| Settlement Ban | Warning | `Character {CharacterId} banned from settlement for {Duration} days` |
| Quest Failed | Warning | `Quest {QuestId} failed due to [Lie Exposed]` |
| Untrustworthy Applied | Information | `[Untrustworthy] flag applied between {CharacterId} and {NpcId}` |
| Untrustworthy Removed | Information | `[Untrustworthy] flag removed between {CharacterId} and {NpcId} due to {Reason}` |
| Stress Applied | Debug | `Applied {Amount} Psychic Stress to {CharacterId} from Liar's Burden` |

---

## 17. Unit Testing Requirements

### 17.1 Test Categories

**Test 1: Lie Complexity Sets Correct DC**

```csharp
[Theory]
[InlineData(LieComplexity.WhiteLie, 10)]
[InlineData(LieComplexity.Plausible, 14)]
[InlineData(LieComplexity.Unlikely, 18)]
[InlineData(LieComplexity.Outrageous, 22)]
public void LieComplexity_GetBaseDc_ReturnsCorrectDc(LieComplexity complexity, int expectedDc)
{
    // Act
    var actualDc = complexity.GetBaseDc();

    // Assert
    Assert.Equal(expectedDc, actualDc);
}
```

**Test 2: Suspicious NPC Increases DC**

```csharp
[Fact]
public void DeceptionContext_SuspiciousNpc_AddsFourToDc()
{
    // Arrange
    var context = new DeceptionContext(
        LieComplexity: LieComplexity.Plausible,
        TargetId: "npc_guard",
        TargetWits: 3,
        TargetDisposition: new DispositionLevel(0),
        NpcSuspicious: true,
        NpcTrusting: false,
        // ... other parameters
        PlayerHasUntrustworthy: false,
        PlayerFactionStanding: 0);

    // Act
    var effectiveDc = context.EffectiveDc;

    // Assert
    Assert.Equal(18, effectiveDc); // 14 base + 4 suspicious
}
```

**Test 3: Deception Applies Stress Cost**

```csharp
[Theory]
[InlineData(SkillOutcome.FullSuccess, false, 1)]
[InlineData(SkillOutcome.Failure, false, 3)]
[InlineData(SkillOutcome.Fumble, true, 13)]
public void LiarsBurden_CalculatesCorrectStress(
    SkillOutcome outcome,
    bool isFumble,
    int expectedStress)
{
    // Arrange
    var burden = new LiarsBurden(outcome, isFumble);

    // Act
    var totalStress = burden.TotalStressCost;

    // Assert
    Assert.Equal(expectedStress, totalStress);
}
```

### 17.2 Integration Tests

```csharp
[Fact]
public async Task AttemptDeception_Success_AppliesStressAndUnlocksOptions()
{
    // Arrange
    var service = CreateDeceptionService();
    SetupSuccessfulRoll(playerSuccesses: 3, npcSuccesses: 1);

    // Act
    var result = await service.AttemptDeceptionAsync(
        characterId: "player1",
        targetNpcId: "guard1",
        lieComplexity: LieComplexity.Plausible);

    // Assert
    Assert.True(result.LieBelieved);
    Assert.Equal(1, result.StressCost);
    Assert.True(result.UnlockedOptions.Any());
}

[Fact]
public async Task AttemptDeception_Fumble_AppliesAllConsequences()
{
    // Arrange
    var service = CreateDeceptionService();
    SetupFumbleRoll(); // 0 successes, 1+ botches

    // Act
    var result = await service.AttemptDeceptionAsync(
        characterId: "player1",
        targetNpcId: "guard1",
        lieComplexity: LieComplexity.Plausible);

    // Assert
    Assert.False(result.LieBelieved);
    Assert.True(result.IsFumble);
    Assert.Equal(13, result.StressCost); // 8 base + 5 exposure
    Assert.True(result.UntrustworthyApplied);
    Assert.NotNull(result.FumbleConsequence);
}
```

---

## 18. Use Cases

### 18.1 Basic Deception

**Scenario:** Player attempts to lie to a guard to gain entry.

**Preconditions:**
- Player is at a guarded entrance
- Player has Rhetoric skill rank 2
- Player has WILL attribute 3
- Guard has WITS 3
- Guard is not suspicious

**Flow:**
1. Player initiates `deceive gate_guard plausible`
2. System classifies lie as Plausible (DC 14)
3. System builds DeceptionContext
4. System performs opposed roll
5. Player rolls 5d10, gets 2 successes
6. Guard rolls 3d10, gets 1 success
7. Margin = +1, Full Success
8. System applies +1 Psychic Stress
9. System marks guard as fooled
10. System unlocks related dialogue options
11. Display success message

**Expected Result:** Deception succeeds, player gains entry, +1 stress applied.

### 18.2 Deception with Cover Story

**Scenario:** Player uses a prepared cover story with forged documents.

**Preconditions:**
- Player has Good cover story quality
- Player has basic forged documents
- Lie is Plausible (DC 14)

**Flow:**
1. Player initiates `deceive merchant plausible --cover-story good --forged-docs`
2. System applies -2 DC from cover story
3. System applies +1d10 from forged documents
4. Effective DC: 12
5. Player pool: base + 1 = 6d10
6. Opposed roll resolves in player's favor
7. Success with reduced difficulty

**Expected Result:** Cover story and documents improve success chance.

### 18.3 Fumble with [Lie Exposed]

**Scenario:** Player fumbles an outrageous lie.

**Preconditions:**
- Player attempts Outrageous lie (DC 22)
- Roll results in 0 successes, 1 botch

**Flow:**
1. Player initiates `deceive warden_aide outrageous`
2. System detects fumble condition
3. System creates [Lie Exposed] consequence
4. System applies +13 Psychic Stress (8 + 5)
5. System applies [Untrustworthy] flag
6. System rolls for combat initiation (70% chance)
7. Combat initiated if roll succeeds
8. System checks for settlement ban possibility
9. System checks for quest failure
10. Display catastrophic failure message

**Expected Result:** Severe consequences including possible combat and ban.

---

## 19. Deliverable Checklist

### 19.1 Enums

- [ ] `LieComplexity` enum with 4 tiers (WhiteLie, Plausible, Unlikely, Outrageous)
- [ ] `LieComplexityExtensions` with GetBaseDc, GetDetectionSeverity, etc.
- [ ] `CoverStoryQuality` enum with 5 tiers (None through Masterwork)
- [ ] `CoverStoryQualityExtensions` with GetDcModifier, etc.
- [ ] `FumbleType.LieExposed` addition
- [ ] `StatusEffectId.Untrustworthy`, `Suspicious`, `Trusting` additions

### 19.2 Value Objects

- [ ] `DeceptionContext` with all deception-specific factors
- [ ] `DeceptionResult` with lie believed, stress cost, consequences
- [ ] `LiarsBurden` with stress cost calculation

### 19.3 Interfaces

- [ ] `IDeceptionService` with AttemptDeceptionAsync, BuildContextAsync, etc.

### 19.4 Services

- [ ] `DeceptionService` implementation with full deception logic
- [ ] `LieExposedHandler` fumble consequence handler

### 19.5 Configuration

- [ ] `lie-complexity.json` with all DC values and modifiers
- [ ] `untrustworthy.json` status effect definition

### 19.6 Tests

- [ ] Lie complexity DC test
- [ ] Suspicious NPC DC modifier test
- [ ] Stress cost calculation test

---

## 20. Acceptance Criteria

- [ ] `LieComplexity` enum correctly maps to DC values (10, 14, 18, 22)
- [ ] `DeceptionContext` calculates all DC modifiers correctly
- [ ] Suspicious NPC adds +4 DC
- [ ] Trusting NPC subtracts -4 DC
- [ ] Evidence contradicting lie adds +6 DC
- [ ] [Untrustworthy] flag adds +3 DC
- [ ] Cover story quality reduces DC appropriately (-1 to -4)
- [ ] Forged documents add +1d10 or +2d10 dice
- [ ] Opposed roll system works (WILL + Rhetoric vs. NPC WITS)
- [ ] Liar's Burden applies correct stress (Success: +1, Failure: +3, Fumble: +8+5)
- [ ] Fumble triggers [Lie Exposed] consequence
- [ ] [Untrustworthy] flag applied on fumble
- [ ] Combat initiation check runs on fumble (50% base chance)
- [ ] Settlement ban possible on fumble
- [ ] Quest failure possible on fumble
- [ ] [Untrustworthy] removal conditions work
- [ ] ~3 unit tests pass

---

## 21. Future Considerations

### 21.1 Utgard Veil-Speech (v0.15.3g)

The Utgard culture treats indirect truth-telling as respectful. Direct truth-telling is offensive. This will integrate with the deception system:

- Deception DC against Utgard reduced by 4
- Proper Veil-Speech (layered truth in deception) grants +1d10
- Direct truth-telling to Utgard causes -2d10 on future checks

### 21.2 Myrk-gengr Specialization (v0.15.3i)

The Myrk-gengr specialization will add deception-specific abilities:

- **[Maintain Cover]** - Stay in character under pressure, no stress on marginal success
- **[Forge Documents]** - Create convincing proof, always treated as high-quality forgery

### 21.3 Interrogation Deception Method (v0.15.3f)

Deception can be used as an interrogation method:
- DC 16, 20 minute duration
- 70% information reliability (subject may lie back)
- No disposition change on success

---

## 22. Implementation Notes

### 22.1 Opposed Roll Implementation

The deception system uses a true opposed roll rather than a DC-based check:

```csharp
// Player rolls WILL + Rhetoric + modifiers
var playerPool = character.Will + character.RhetoricRank + playerModifiers;
var playerRoll = diceRoller.Roll(playerPool);

// NPC rolls WITS + modifiers
var npcPool = npc.Wits + npcModifiers;
var npcRoll = diceRoller.Roll(npcPool);

// Compare successes
var margin = playerRoll.NetSuccesses - npcRoll.NetSuccesses;
```

The DC is used to modify the effective threshold, not as a direct comparison.

### 22.2 Stress Economy Integration

Deception stress integrates with the trauma economy from v0.10.x:

- Stress accumulates with each deception attempt
- High-stress characters may break down, affecting all checks
- Resting reduces stress, encouraging strategic use of deception

### 22.3 [Untrustworthy] Spread Mechanics

The [Untrustworthy] flag can spread between NPCs:

- When NPCs communicate (same faction, same settlement)
- Spread chance based on NPC gossip tendency
- Creates reputation-based gameplay consequences

---

## 23. Document Metadata

| Property | Value |
|----------|-------|
| Version | 0.15.3c |
| Status | Draft |
| Created | 2026-01-17 |
| Author | Claude |
| Reviewed By | - |
| Approved By | - |
| Last Updated | 2026-01-17 |
| Prerequisites | v0.15.3a, v0.15.3b |
| Estimated Tests | ~3 |
| Related Documents | v0.15.3-scope-breakdown.md, rhetoric.md |
