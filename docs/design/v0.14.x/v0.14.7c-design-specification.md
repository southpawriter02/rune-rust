# v0.14.7c Design Specification: Environment Descriptor Schema

**Version:** 0.14.7c
**Parent:** v0.14.7 (Descriptor Configuration Schemas)
**Prerequisites:** v0.14.7a Complete (Sensory Descriptor Schema)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Schema Extension Pattern](#4-schema-extension-pattern)
   - 4.1 [AllOf Extension Mechanism](#41-allof-extension-mechanism)
   - 4.2 [Reference to Master Schema](#42-reference-to-master-schema)
5. [Environment Category Enum](#5-environment-category-enum)
   - 5.1 [Category Definitions](#51-category-definitions)
   - 5.2 [Category Selection](#52-category-selection)
6. [EnvironmentDescriptor Definition](#6-environmentdescriptor-definition)
   - 6.1 [Core Properties (Inherited)](#61-core-properties-inherited)
   - 6.2 [Environment-Specific Properties](#62-environment-specific-properties)
   - 6.3 [Time and Season Filtering](#63-time-and-season-filtering)
7. [LocationTag Enum](#7-locationtag-enum)
   - 7.1 [Location Type Tags](#71-location-type-tags)
   - 7.2 [Biome Tags](#72-biome-tags)
   - 7.3 [Mood Tags](#73-mood-tags)
8. [SensoryCategory Enum](#8-sensorycategory-enum)
   - 8.1 [Sensory Pool Types](#81-sensory-pool-types)
   - 8.2 [Sensory Descriptor Usage](#82-sensory-descriptor-usage)
9. [WeatherPoolTypes Enum](#9-weatherpooltypes-enum)
   - 9.1 [Weather Type Definitions](#91-weather-type-definitions)
   - 9.2 [Indoor/Outdoor Variants](#92-indooroutdoor-variants)
10. [AmbientPoolTypes Enum](#10-ambientpooltypes-enum)
    - 10.1 [Generic Ambient Pools](#101-generic-ambient-pools)
    - 10.2 [Biome-Specific Ambient Pools](#102-biome-specific-ambient-pools)
11. [Configuration Schema](#11-configuration-schema)
12. [Configuration File Updates](#12-configuration-file-updates)
    - 12.1 [environmental.json](#121-environmentaljson)
    - 12.2 [weather.json](#122-weatherjson)
    - 12.3 [ambient-events.json](#123-ambient-eventsjson)
13. [Data Model Changes](#13-data-model-changes)
14. [Logging Specifications](#14-logging-specifications)
15. [Unit Testing Requirements](#15-unit-testing-requirements)
16. [Use Cases](#16-use-cases)
17. [Deliverable Checklist](#17-deliverable-checklist)
18. [Acceptance Criteria](#18-acceptance-criteria)
19. [Dependencies](#19-dependencies)
20. [Future Considerations](#20-future-considerations)
21. [Appendix: Schema Validation Examples](#21-appendix-schema-validation-examples)

---

## 1. Executive Summary

Version 0.14.7c introduces the **Environment Descriptor Schema** (`environment-descriptors.schema.json`), which extends the master descriptor schema (v0.14.7a) with environment-specific validations. This schema provides specialized validation for sensory atmosphere (lighting, sounds, smells, temperature), weather descriptions with indoor/outdoor variants, and ambient events organized by biome type.

The Environment Descriptor Schema validates 3 existing configuration files:
- `environmental.json` (4 sensory pools with 23 descriptors)
- `weather.json` (10 weather pools with 40 descriptors)
- `ambient-events.json` (15 ambient pools with 81 descriptors)

These files enable full atmosphere customization for different game settings, themes, and moods without code changes.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Schema Files** | `environment-descriptors.schema.json` |
| **Schema Definitions** | `EnvironmentCategory`, `EnvironmentDescriptor`, `LocationTag`, `SensoryCategory`, `WeatherPoolTypes`, `AmbientPoolTypes` |
| **Configuration Updates** | `environmental.json`, `weather.json`, `ambient-events.json` (add schema references) |
| **Tests** | ~6 new unit tests |

### Architectural Significance

This version provides:
- **Schema extension pattern** - Demonstrates `allOf` composition with master schema
- **Environment category validation** - Enforces valid category values for environment files
- **Sensory pool validation** - Validates lighting, sounds, smells, temperature pools
- **Weather pool validation** - Validates weather pools with indoor/outdoor variants
- **Ambient pool validation** - Validates ambient event pools with biome specificity
- **Location tag validation** - Validates indoor/outdoor, biome, and mood tags
- **Theme tag validation** - Validates genre/mood filtering (dark_fantasy, horror, high_fantasy)

### Relationship to Other Schemas

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                  v0.14.7 DESCRIPTOR CONFIGURATION SCHEMAS                    │
└─────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────┐
  │  v0.14.7a: descriptors.schema.json (MASTER SCHEMA)                      │
  │  v0.14.7b: combat-descriptors.schema.json (extends master)             │
  │  v0.14.7c: environment-descriptors.schema.json ◀── THIS VERSION        │
  └─────────────────────────────────────────────────────────────────────────┘

  Extension Mechanism:
  ┌─────────────────────────────────────────────────────────────────────────┐
  │  environment-descriptors.schema.json                                    │
  │  └── allOf:                                                             │
  │      └── $ref: "descriptors.schema.json"  ◀── Inherits all master rules │
  │  └── properties:                                                        │
  │      └── category: enum [environmental, weather, ambient, objects]      │
  └─────────────────────────────────────────────────────────────────────────┘

  Configuration Files Using This Schema:
  ├── config/descriptors/environmental.json (4 pools)
  │   └── lighting, sounds, smells, temperature
  │
  ├── config/descriptors/weather.json (10 pools)
  │   └── weather_rain_indoor, weather_rain_outdoor
  │   └── weather_storm_indoor, weather_storm_outdoor
  │   └── weather_snow_indoor, weather_snow_outdoor
  │   └── weather_fog_indoor, weather_fog_outdoor
  │   └── weather_wind_indoor, weather_wind_outdoor
  │
  └── config/descriptors/ambient-events.json (15 pools)
      └── sound, sound_cave, sound_dungeon, sound_forest
      └── visual, visual_volcanic, visual_ruins
      └── creature, creature_cave, creature_swamp, creature_forest
      └── environmental, environmental_frozen
      └── environmental_volcanic, environmental_swamp
```

---

## 2. Feature Overview

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                  ENVIRONMENT DESCRIPTOR SCHEMA FEATURE TREE                  │
└─────────────────────────────────────────────────────────────────────────────┘

environment-descriptors.schema.json
├── Schema Extension
│   ├── allOf composition
│   └── $ref to descriptors.schema.json
│
├── EnvironmentCategory Enum
│   ├── environmental
│   ├── weather
│   ├── ambient
│   └── objects
│
├── EnvironmentDescriptor (extends Descriptor)
│   ├── Inherited Properties
│   │   ├── id (lowercase with underscores)
│   │   ├── text (descriptor content)
│   │   ├── weight (positive integer)
│   │   ├── tags[] (context filters)
│   │   └── themes[] (genre filters)
│   │
│   └── Environment-Specific Properties
│       ├── timeOfDay[] (dawn, day, dusk, night)
│       └── season[] (spring, summer, autumn, winter)
│
├── LocationTag (documented values)
│   ├── Location Types
│   │   ├── indoor, outdoor
│   │   ├── underground, underwater
│   │   └── enclosed
│   │
│   ├── Biome Types
│   │   ├── cave, dungeon
│   │   ├── forest, swamp
│   │   ├── volcanic, frozen
│   │   └── ruin
│   │
│   └── Mood Types
│       ├── danger, safe
│       ├── atmospheric
│       ├── magic, supernatural
│       └── old, decay
│
├── SensoryCategory Enum (4 types)
│   ├── lighting
│   ├── sounds
│   ├── smells
│   └── temperature
│
├── WeatherPoolTypes Enum (10 types)
│   ├── Rain (indoor/outdoor)
│   ├── Storm (indoor/outdoor)
│   ├── Snow (indoor/outdoor)
│   ├── Fog (indoor/outdoor)
│   └── Wind (indoor/outdoor)
│
└── AmbientPoolTypes Enum (15 types)
    ├── Sound Pools (4)
    │   ├── sound (generic)
    │   ├── sound_cave
    │   ├── sound_dungeon
    │   └── sound_forest
    │
    ├── Visual Pools (3)
    │   ├── visual (generic)
    │   ├── visual_volcanic
    │   └── visual_ruins
    │
    ├── Creature Pools (4)
    │   ├── creature (generic)
    │   ├── creature_cave
    │   ├── creature_swamp
    │   └── creature_forest
    │
    └── Environmental Pools (4)
        ├── environmental (generic)
        ├── environmental_frozen
        ├── environmental_volcanic
        └── environmental_swamp
```

---

## 3. Architecture Diagrams

### 3.1 Schema Extension Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       SCHEMA EXTENSION ARCHITECTURE                          │
└─────────────────────────────────────────────────────────────────────────────┘

                       ┌───────────────────────────────────┐
                       │    descriptors.schema.json        │
                       │         (MASTER SCHEMA)           │
                       │───────────────────────────────────│
                       │  • DescriptorPool definition      │
                       │  • Descriptor definition          │
                       │  • Weight validation (> 0)        │
                       │  • ID patterns (kebab/snake)      │
                       │  • Tag/theme arrays               │
                       │  • Variable substitution          │
                       └───────────────┬───────────────────┘
                                       │
                              ┌────────┴────────┐
                              │  allOf: $ref    │
                              └────────┬────────┘
                                       │
                       ┌───────────────▼───────────────────┐
                       │  environment-descriptors.schema   │
                       │       (ENVIRONMENT EXTENSION)     │
                       │───────────────────────────────────│
                       │  INHERITS ALL FROM MASTER:        │
                       │  • DescriptorPool                 │
                       │  • Descriptor base properties     │
                       │  • Weight/ID/Tag validation       │
                       │───────────────────────────────────│
                       │  ADDS ENVIRONMENT-SPECIFIC:       │
                       │  • category: environment enum     │
                       │  • EnvironmentDescriptor ext      │
                       │  • SensoryCategory enum           │
                       │  • WeatherPoolTypes enum          │
                       │  • AmbientPoolTypes enum          │
                       │  • LocationTag documentation      │
                       │  • timeOfDay/season arrays        │
                       └───────────────────────────────────┘
```

### 3.2 Environment Descriptor Selection Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    ENVIRONMENT DESCRIPTOR SELECTION FLOW                     │
└─────────────────────────────────────────────────────────────────────────────┘

  Room Entry Event (e.g., entering a dungeon cave)
           │
           ▼
  ┌─────────────────────────────────────────────────────────────────────────┐
  │                    STEP 1: CONTEXT DETERMINATION                         │
  ├─────────────────────────────────────────────────────────────────────────┤
  │  Location: indoor, underground, cave, dungeon                           │
  │  Theme: dark_fantasy                                                    │
  │  Mood: danger, atmospheric                                              │
  └─────────────────────────────────────────────────────────────────────────┘
           │
           ▼
  ┌─────────────────────────────────────────────────────────────────────────┐
  │                   STEP 2: POOL SELECTION                                 │
  ├─────────────────────────────────────────────────────────────────────────┤
  │  Sensory Pool: lighting (from environmental.json)                       │
  │  Ambient Pool: sound_cave (from ambient-events.json)                    │
  │  Descriptors Available: 6 lighting, 5 cave sounds                       │
  └─────────────────────────────────────────────────────────────────────────┘
           │
           ▼
  ┌─────────────────────────────────────────────────────────────────────────┐
  │                   STEP 3: TAG/THEME FILTER                               │
  ├─────────────────────────────────────────────────────────────────────────┤
  │  Filter: tags contain ["cave", "dungeon", "indoor", "danger"]           │
  │  Filter: themes contain ["dark_fantasy"]                                │
  │  Lighting Remaining: 4 descriptors                                      │
  │  Sound Remaining: 5 descriptors                                         │
  └─────────────────────────────────────────────────────────────────────────┘
           │
           ▼
  ┌─────────────────────────────────────────────────────────────────────────┐
  │                   STEP 4: WEIGHTED SELECTION                             │
  ├─────────────────────────────────────────────────────────────────────────┤
  │  Lighting Weights:                                                      │
  │  • "dimly lit by flickering torches" (weight: 20)                       │
  │  • "shrouded in impenetrable darkness" (weight: 25)                     │
  │  • "where pale light filters through cracks" (weight: 15)               │
  │  • "illuminated by an eerie phosphorescent glow" (weight: 10)           │
  │  Total Weight: 70                                                       │
  │  Random Selection: Based on weight distribution                         │
  └─────────────────────────────────────────────────────────────────────────┘
           │
           ▼
  ┌─────────────────────────────────────────────────────────────────────────┐
  │                    RESULT: COMPOSED ATMOSPHERE                           │
  ├─────────────────────────────────────────────────────────────────────────┤
  │  Lighting: "The chamber is shrouded in impenetrable darkness."          │
  │  Sound: "A single drop of water falls, its echo multiplying..."         │
  │  Smell: "The smell of damp stone fills your nostrils."                  │
  │  Temperature: "A damp chill clings to your skin."                       │
  └─────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           CLEAN ARCHITECTURE LAYERS                          │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                              INFRASTRUCTURE                                  │
│─────────────────────────────────────────────────────────────────────────────│
│                                                                             │
│  config/schemas/                                                            │
│  ├── descriptors.schema.json              (v0.14.7a - master)              │
│  ├── combat-descriptors.schema.json       (v0.14.7b - combat)              │
│  └── environment-descriptors.schema.json  (v0.14.7c - THIS VERSION)        │
│                                                                             │
│  config/descriptors/                                                        │
│  ├── environmental.json                   (uses environment schema)        │
│  ├── weather.json                         (uses environment schema)        │
│  └── ambient-events.json                  (uses environment schema)        │
│                                                                             │
│  Unit Tests (RuneAndRust.Tests)                                            │
│  └── Infrastructure/Validation/                                            │
│      └── EnvironmentDescriptorSchemaTests.cs (~6 tests)                    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Schema Extension Pattern

### 4.1 AllOf Extension Mechanism

The environment descriptor schema extends the master schema using JSON Schema's `allOf` composition. This ensures all environment descriptor files:
1. Meet the base requirements of the master schema
2. Additionally satisfy environment-specific requirements

**Extension Structure:**

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "allOf": [
    { "$ref": "descriptors.schema.json" }
  ],
  "properties": {
    "category": {
      "description": "Environment category identifier",
      "enum": ["environmental", "weather", "ambient", "objects"]
    }
  }
}
```

**Inheritance:**
- All `DescriptorPool` validation from master
- All `Descriptor` property validation from master
- All ID pattern validation from master
- All weight validation from master
- Tag and theme array validation from master

### 4.2 Reference to Master Schema

**File Location:** `config/schemas/environment-descriptors.schema.json`

**Reference Path:** The schema uses a relative reference to the master schema in the same directory:

```json
{
  "allOf": [
    { "$ref": "descriptors.schema.json" }
  ]
}
```

This reference ensures:
- Master schema must be valid before environment schema validates
- Changes to master schema automatically affect environment validation
- No duplication of base validation rules

---

## 5. Environment Category Enum

### 5.1 Category Definitions

The environment descriptor schema restricts the `category` property to environment-related values:

| Category | Description | Configuration File |
|----------|-------------|-------------------|
| `environmental` | Sensory atmosphere descriptions | `environmental.json` |
| `weather` | Weather effect descriptions | `weather.json` |
| `ambient` | Random ambient event descriptions | `ambient-events.json` |
| `objects` | Object examination descriptions | (future use) |

### 5.2 Category Selection

**Schema Definition:**

```json
{
  "properties": {
    "category": {
      "description": "Environment category identifier - must be an environment-related category",
      "type": "string",
      "enum": ["environmental", "weather", "ambient", "objects"]
    }
  },
  "required": ["category"]
}
```

**Validation Rules:**
- Category must be one of the four allowed values
- Category is required (inherits from master)
- Category determines which pool types are valid

---

## 6. EnvironmentDescriptor Definition

### 6.1 Core Properties (Inherited)

EnvironmentDescriptor inherits all properties from the master Descriptor definition:

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `id` | string | Yes | Unique identifier (pattern: `^[a-z][a-z0-9_]*$`) |
| `text` | string | Yes | The descriptor text content |
| `weight` | integer | No | Selection weight (default: 100, minimum: 1) |
| `tags` | string[] | No | Context filter tags (location, biome, mood) |
| `themes` | string[] | No | Theme filter tags (dark_fantasy, horror, high_fantasy) |

### 6.2 Environment-Specific Properties

EnvironmentDescriptor adds environment-specific optional properties for temporal filtering:

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `timeOfDay` | string[] | No | Time filters (dawn, day, dusk, night) |
| `season` | string[] | No | Season filters (spring, summer, autumn, winter) |

**Schema Definition:**

```json
{
  "definitions": {
    "EnvironmentDescriptor": {
      "description": "Extended descriptor with environment-specific properties",
      "allOf": [
        { "$ref": "descriptors.schema.json#/definitions/Descriptor" }
      ],
      "properties": {
        "timeOfDay": {
          "description": "Time of day when this descriptor can be used",
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["dawn", "day", "dusk", "night"]
          },
          "uniqueItems": true
        },
        "season": {
          "description": "Seasons when this descriptor can be used",
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["spring", "summer", "autumn", "winter"]
          },
          "uniqueItems": true
        }
      }
    }
  }
}
```

### 6.3 Time and Season Filtering

**Time of Day Usage:**

| Value | Meaning | Example Context |
|-------|---------|-----------------|
| `dawn` | Early morning, sunrise | Soft light, morning mist |
| `day` | Full daylight | Bright, clear visibility |
| `dusk` | Evening, sunset | Fading light, long shadows |
| `night` | Darkness, moonlight | Stars, darkness, torchlight |

**Season Usage:**

| Value | Meaning | Example Context |
|-------|---------|-----------------|
| `spring` | Mild, growing | Flowers, rain, new growth |
| `summer` | Warm, bright | Heat, long days, lush vegetation |
| `autumn` | Cooling, harvest | Falling leaves, shorter days |
| `winter` | Cold, dormant | Snow, frost, bare trees |

**Example Usage:**

```json
{
  "id": "morning_mist",
  "text": "Morning mist clings to the ground, slowly burning off",
  "weight": 20,
  "tags": ["outdoor", "forest"],
  "timeOfDay": ["dawn"]
}
```

---

## 7. LocationTag Enum

### 7.1 Location Type Tags

Tags defining the physical location type:

| Tag | Description | Example Pools |
|-----|-------------|---------------|
| `indoor` | Inside a structure or building | weather_*_indoor, environmental |
| `outdoor` | Outside, exposed to elements | weather_*_outdoor |
| `underground` | Below ground, caves or tunnels | sound_cave, environmental |
| `underwater` | Submerged environments | (future use) |
| `enclosed` | Small, confined spaces | temperature |

### 7.2 Biome Tags

Tags defining the biome or environment type:

| Tag | Description | Example Pools |
|-----|-------------|---------------|
| `cave` | Natural cavern | sound_cave, creature_cave |
| `dungeon` | Constructed underground | sound_dungeon, lighting |
| `forest` | Wooded area | sound_forest, creature_forest |
| `swamp` | Wetland, marsh | creature_swamp, environmental_swamp |
| `volcanic` | Hot, lava, fire | visual_volcanic, environmental_volcanic |
| `frozen` | Cold, ice, snow | environmental_frozen |
| `ruin` | Ancient structures | visual_ruins |

### 7.3 Mood Tags

Tags defining atmosphere and tension:

| Tag | Description | Effect |
|-----|-------------|--------|
| `danger` | Hostile, threatening | Increases tense descriptors |
| `safe` | Peaceful, secure | Increases calm descriptors |
| `atmospheric` | Immersive, evocative | General mood enhancement |
| `magic` / `magical` | Supernatural elements | Enables magical descriptors |
| `supernatural` | Otherworldly, ghostly | Enables supernatural descriptors |
| `old` | Ancient, aged | Enables decay descriptors |
| `decay` | Rotting, deteriorating | Enables decay descriptors |
| `creature` | Contains creatures | Enables creature-related sounds |
| `combat` | Battle has occurred | Enables combat aftermath descriptors |

**Tag Relationship to Pools:**

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         TAG TO POOL RELATIONSHIPS                            │
└─────────────────────────────────────────────────────────────────────────────┘

  Location Tags                    Biome Tags                 Mood Tags
  ─────────────                    ──────────                 ─────────
  indoor ────────┐                 cave ─────────┐            danger ────────┐
  outdoor ───────┤                 dungeon ──────┤            safe ──────────┤
  underground ───┤                 forest ───────┤            atmospheric ───┤
                 │                 swamp ────────┤            magic ─────────┤
                 │                 volcanic ─────┤            supernatural ──┤
                 │                 frozen ───────┤            old ───────────┤
                 │                 ruin ─────────┤            decay ─────────┤
                 │                               │                           │
                 ▼                               ▼                           ▼
         ┌───────────────────────────────────────────────────────────────────┐
         │                     DESCRIPTOR FILTER                              │
         ├───────────────────────────────────────────────────────────────────┤
         │  Match: descriptor.tags INTERSECTS context.tags                   │
         │  Result: Descriptors with matching tags are eligible              │
         └───────────────────────────────────────────────────────────────────┘
```

---

## 8. SensoryCategory Enum

### 8.1 Sensory Pool Types

The environmental.json file contains four sensory pool types:

| Pool ID | Sensory Type | Descriptor Count | Example Text |
|---------|--------------|------------------|--------------|
| `lighting` | Visual | 6 | "dimly lit by flickering torches" |
| `sounds` | Audio | 6 | "The sound of dripping water echoes in the distance" |
| `smells` | Olfactory | 6 | "The air is thick and musty" |
| `temperature` | Tactile | 5 | "A bone-chilling cold seeps into your very soul" |

**Schema Definition:**

```json
{
  "definitions": {
    "SensoryCategory": {
      "description": "Valid pool IDs for environmental sensory category",
      "type": "string",
      "enum": ["lighting", "sounds", "smells", "temperature"]
    }
  }
}
```

### 8.2 Sensory Descriptor Usage

**Lighting Pool Examples:**

| ID | Text | Tags | Themes |
|----|------|------|--------|
| `dim_torch` | "dimly lit by flickering torches" | indoor, dungeon | dark_fantasy, horror |
| `bathed_torchlight` | "bathed in warm torchlight" | indoor, safe | high_fantasy |
| `shrouded_darkness` | "shrouded in impenetrable darkness" | danger, dungeon | dark_fantasy, horror |
| `eerie_glow` | "illuminated by an eerie phosphorescent glow" | magic, cave | dark_fantasy, horror |

**Sounds Pool Examples:**

| ID | Text | Tags | Themes |
|----|------|------|--------|
| `dripping_water` | "The sound of dripping water echoes in the distance" | cave, dungeon | - |
| `eerie_silence` | "An eerie silence hangs in the air" | atmospheric, danger | horror |
| `chains_rattling` | "The distant rattling of chains sends shivers down your spine" | dungeon, danger | dark_fantasy, horror |

**Smells Pool Examples:**

| ID | Text | Tags | Themes |
|----|------|------|--------|
| `musty_air` | "The air is thick and musty" | indoor, old | - |
| `rotting_vegetation` | "The stench of rotting vegetation assaults your senses" | swamp, decay | horror |
| `sulfurous_fumes` | "Sulfurous fumes sting your eyes and throat" | volcanic, danger | - |

**Temperature Pool Examples:**

| ID | Text | Tags | Themes |
|----|------|------|--------|
| `bone_chilling` | "A bone-chilling cold seeps into your very soul" | cold, supernatural | - |
| `oppressive_heat` | "Oppressive heat radiates from the stone walls" | volcanic, forge | - |
| `unnatural_cold` | "An unnatural cold presence makes your breath visible" | supernatural, undead | horror |

---

## 9. WeatherPoolTypes Enum

### 9.1 Weather Type Definitions

Weather pools define atmospheric conditions with both indoor and outdoor variants:

| Weather Type | Indoor Pool | Outdoor Pool | Description |
|--------------|-------------|--------------|-------------|
| Rain | `weather_rain_indoor` | `weather_rain_outdoor` | Precipitation |
| Storm | `weather_storm_indoor` | `weather_storm_outdoor` | Thunder, lightning |
| Snow | `weather_snow_indoor` | `weather_snow_outdoor` | Cold precipitation |
| Fog | `weather_fog_indoor` | `weather_fog_outdoor` | Limited visibility |
| Wind | `weather_wind_indoor` | `weather_wind_outdoor` | Air movement |

### 9.2 Indoor/Outdoor Variants

**Rain Pools:**

| Pool ID | Descriptor Count | Example Text |
|---------|------------------|--------------|
| `weather_rain_indoor` | 4 | "Rain patters steadily on the roof above" |
| `weather_rain_outdoor` | 4 | "Steady rain patters against you" |

**Storm Pools:**

| Pool ID | Descriptor Count | Example Text |
|---------|------------------|--------------|
| `weather_storm_indoor` | 4 | "Thunder rumbles overhead, shaking the walls" |
| `weather_storm_outdoor` | 4 | "Lightning splits the sky, briefly turning night to day" |

**Snow Pools:**

| Pool ID | Descriptor Count | Example Text |
|---------|------------------|--------------|
| `weather_snow_indoor` | 4 | "Snow drifts through gaps, piling in corners" |
| `weather_snow_outdoor` | 4 | "Snow swirls around you in dancing flurries" |

**Fog Pools:**

| Pool ID | Descriptor Count | Example Text |
|---------|------------------|--------------|
| `weather_fog_indoor` | 3 | "Mist seeps under doors and through cracks" |
| `weather_fog_outdoor` | 4 | "Thick fog limits visibility to mere feet" |

**Wind Pools:**

| Pool ID | Descriptor Count | Example Text |
|---------|------------------|--------------|
| `weather_wind_indoor` | 3 | "Drafts whistle through gaps in the walls" |
| `weather_wind_outdoor` | 4 | "A strong wind buffets you" |

**Schema Definition:**

```json
{
  "definitions": {
    "WeatherPoolTypes": {
      "description": "Valid pool IDs for weather category",
      "type": "string",
      "enum": [
        "weather_rain_indoor",
        "weather_rain_outdoor",
        "weather_storm_indoor",
        "weather_storm_outdoor",
        "weather_snow_indoor",
        "weather_snow_outdoor",
        "weather_fog_indoor",
        "weather_fog_outdoor",
        "weather_wind_indoor",
        "weather_wind_outdoor"
      ]
    }
  }
}
```

---

## 10. AmbientPoolTypes Enum

### 10.1 Generic Ambient Pools

Generic pools that apply across multiple biomes:

| Pool ID | Event Type | Descriptor Count | Example Text |
|---------|------------|------------------|--------------|
| `sound` | Generic Sound | 6 | "A distant scream echoes through the corridors" |
| `visual` | Generic Visual | 5 | "Shadows shift at the corner of your vision" |
| `creature` | Generic Creature | 5 | "Rats scatter as you approach" |
| `environmental` | Generic Environmental | 5 | "Ancient dust settles around you" |

### 10.2 Biome-Specific Ambient Pools

**Sound Pools by Biome:**

| Pool ID | Biome | Descriptor Count | Example Text |
|---------|-------|------------------|--------------|
| `sound_cave` | Cave | 5 | "A single drop of water falls, its echo multiplying into a chorus" |
| `sound_dungeon` | Dungeon | 5 | "Chains rattle somewhere in the darkness" |
| `sound_forest` | Forest | 5 | "A branch snaps somewhere in the undergrowth" |

**Visual Pools by Biome:**

| Pool ID | Biome | Descriptor Count | Example Text |
|---------|-------|------------------|--------------|
| `visual_volcanic` | Volcanic | 5 | "A bubble of lava surfaces and pops, sending sparks into the air" |
| `visual_ruins` | Ruins | 5 | "A ghostly light flickers in a distant window before fading" |

**Creature Pools by Biome:**

| Pool ID | Biome | Descriptor Count | Example Text |
|---------|-------|------------------|--------------|
| `creature_cave` | Cave | 5 | "A colony of bats erupts from a crevice" |
| `creature_swamp` | Swamp | 5 | "A large frog leaps from a log and splashes into the murky water" |
| `creature_forest` | Forest | 5 | "A deer freezes at your approach, then bounds away" |

**Environmental Pools by Biome:**

| Pool ID | Biome | Descriptor Count | Example Text |
|---------|-------|------------------|--------------|
| `environmental_frozen` | Frozen | 5 | "Ice cracks somewhere nearby with a sound like breaking glass" |
| `environmental_volcanic` | Volcanic | 5 | "The ground trembles briefly beneath your feet" |
| `environmental_swamp` | Swamp | 5 | "Bubbles rise from the murky water, releasing foul-smelling gas" |

**Schema Definition:**

```json
{
  "definitions": {
    "AmbientPoolTypes": {
      "description": "Valid pool IDs for ambient events category",
      "type": "string",
      "enum": [
        "sound",
        "sound_cave",
        "sound_dungeon",
        "sound_forest",
        "visual",
        "visual_volcanic",
        "visual_ruins",
        "creature",
        "creature_cave",
        "creature_swamp",
        "creature_forest",
        "environmental",
        "environmental_frozen",
        "environmental_volcanic",
        "environmental_swamp"
      ]
    }
  }
}
```

---

## 11. Configuration Schema

**File:** `config/schemas/environment-descriptors.schema.json`

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://runeandrust.game/schemas/environment-descriptors.schema.json",
  "title": "Environment Descriptor Configuration",
  "description": "Schema for environment-related text descriptors including sensory atmosphere, weather effects, and ambient events. Extends the master descriptor schema.",

  "allOf": [
    { "$ref": "descriptors.schema.json" }
  ],

  "properties": {
    "category": {
      "description": "Environment category identifier - must be an environment-related category",
      "type": "string",
      "enum": ["environmental", "weather", "ambient", "objects"]
    }
  },

  "definitions": {
    "EnvironmentDescriptor": {
      "description": "Extended descriptor with environment-specific properties for temporal filtering",
      "allOf": [
        { "$ref": "descriptors.schema.json#/definitions/Descriptor" }
      ],
      "properties": {
        "timeOfDay": {
          "description": "Array of times when this descriptor can be used. If not specified, applies to all times.",
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["dawn", "day", "dusk", "night"]
          },
          "uniqueItems": true
        },
        "season": {
          "description": "Array of seasons when this descriptor can be used. If not specified, applies to all seasons.",
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["spring", "summer", "autumn", "winter"]
          },
          "uniqueItems": true
        }
      }
    },

    "SensoryCategory": {
      "description": "Valid pool IDs for environmental sensory category (environmental.json)",
      "type": "string",
      "enum": ["lighting", "sounds", "smells", "temperature"]
    },

    "WeatherPoolTypes": {
      "description": "Valid pool IDs for weather category (weather.json)",
      "type": "string",
      "enum": [
        "weather_rain_indoor",
        "weather_rain_outdoor",
        "weather_storm_indoor",
        "weather_storm_outdoor",
        "weather_snow_indoor",
        "weather_snow_outdoor",
        "weather_fog_indoor",
        "weather_fog_outdoor",
        "weather_wind_indoor",
        "weather_wind_outdoor"
      ]
    },

    "AmbientPoolTypes": {
      "description": "Valid pool IDs for ambient events category (ambient-events.json)",
      "type": "string",
      "enum": [
        "sound",
        "sound_cave",
        "sound_dungeon",
        "sound_forest",
        "visual",
        "visual_volcanic",
        "visual_ruins",
        "creature",
        "creature_cave",
        "creature_swamp",
        "creature_forest",
        "environmental",
        "environmental_frozen",
        "environmental_volcanic",
        "environmental_swamp"
      ]
    },

    "LocationTag": {
      "description": "Common location tags used for filtering descriptors. This is documentation only - tags are flexible string arrays.",
      "type": "string",
      "examples": [
        "indoor", "outdoor", "underground", "underwater", "enclosed",
        "cave", "dungeon", "forest", "swamp", "volcanic", "frozen", "ruin",
        "danger", "safe", "atmospheric", "magic", "supernatural", "old", "decay"
      ]
    },

    "ThemeTag": {
      "description": "Common theme tags for genre/mood filtering. This is documentation only - themes are flexible string arrays.",
      "type": "string",
      "examples": [
        "dark_fantasy", "high_fantasy", "horror"
      ]
    }
  }
}
```

---

## 12. Configuration File Updates

### 12.1 environmental.json

**File:** `config/descriptors/environmental.json`

**Update Required:** Add schema reference to enable validation.

**Current Structure (4 pools, 23 descriptors):**

| Pool ID | Pool Name | Descriptor Count |
|---------|-----------|------------------|
| `lighting` | Lighting | 6 |
| `sounds` | Ambient Sounds | 6 |
| `smells` | Ambient Smells | 6 |
| `temperature` | Temperature Sensations | 5 |

**Schema Reference Addition:**

```json
{
  "$schema": "../schemas/environment-descriptors.schema.json",
  "category": "environmental",
  "pools": {
    // ... existing pools unchanged
  }
}
```

### 12.2 weather.json

**File:** `config/descriptors/weather.json`

**Update Required:** Add schema reference to enable validation.

**Current Structure (10 pools, 40 descriptors):**

| Pool ID | Pool Name | Descriptor Count |
|---------|-----------|------------------|
| `weather_rain_indoor` | Rain (Indoor) | 4 |
| `weather_rain_outdoor` | Rain (Outdoor) | 4 |
| `weather_storm_indoor` | Storm (Indoor) | 4 |
| `weather_storm_outdoor` | Storm (Outdoor) | 4 |
| `weather_snow_indoor` | Snow (Indoor) | 4 |
| `weather_snow_outdoor` | Snow (Outdoor) | 4 |
| `weather_fog_indoor` | Fog (Indoor) | 3 |
| `weather_fog_outdoor` | Fog (Outdoor) | 4 |
| `weather_wind_indoor` | Wind (Indoor) | 3 |
| `weather_wind_outdoor` | Wind (Outdoor) | 4 |

**Schema Reference Addition:**

```json
{
  "$schema": "../schemas/environment-descriptors.schema.json",
  "category": "weather",
  "pools": {
    // ... existing pools unchanged
  }
}
```

### 12.3 ambient-events.json

**File:** `config/descriptors/ambient-events.json`

**Update Required:** Add schema reference to enable validation.

**Current Structure (15 pools, 81 descriptors):**

| Pool ID | Pool Name | Descriptor Count |
|---------|-----------|------------------|
| `sound` | Sound Events (Generic) | 6 |
| `sound_cave` | Sound Events (Cave) | 5 |
| `sound_dungeon` | Sound Events (Dungeon) | 5 |
| `sound_forest` | Sound Events (Forest) | 5 |
| `visual` | Visual Events (Generic) | 5 |
| `visual_volcanic` | Visual Events (Volcanic) | 5 |
| `visual_ruins` | Visual Events (Ruins) | 5 |
| `creature` | Creature Events (Generic) | 5 |
| `creature_cave` | Creature Events (Cave) | 5 |
| `creature_swamp` | Creature Events (Swamp) | 5 |
| `creature_forest` | Creature Events (Forest) | 5 |
| `environmental` | Environmental Events (Generic) | 5 |
| `environmental_frozen` | Environmental Events (Frozen) | 5 |
| `environmental_volcanic` | Environmental Events (Volcanic) | 5 |
| `environmental_swamp` | Environmental Events (Swamp) | 5 |

**Schema Reference Addition:**

```json
{
  "$schema": "../schemas/environment-descriptors.schema.json",
  "category": "ambient",
  "pools": {
    // ... existing pools unchanged
  }
}
```

---

## 13. Data Model Changes

### Summary

v0.14.7c introduces no new domain entities or value objects. All changes are configuration schema definitions:

| Artifact | Type | Layer | Description |
|----------|------|-------|-------------|
| `environment-descriptors.schema.json` | JSON Schema | Infrastructure | Environment descriptor validation schema |
| `EnvironmentDescriptor` | Schema Definition | Infrastructure | Extended descriptor with time/season properties |
| `SensoryCategory` | Schema Enum | Infrastructure | Valid sensory pool identifiers |
| `WeatherPoolTypes` | Schema Enum | Infrastructure | Valid weather pool identifiers |
| `AmbientPoolTypes` | Schema Enum | Infrastructure | Valid ambient pool identifiers |
| `LocationTag` | Schema Documentation | Infrastructure | Common location tag values |

### Schema Definitions Overview

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      ENVIRONMENT SCHEMA DEFINITIONS                          │
└─────────────────────────────────────────────────────────────────────────────┘

EnvironmentDescriptor (extends Descriptor)
├── id: string (required, inherited)
├── text: string (required, inherited)
├── weight: integer (optional, inherited, default: 100)
├── tags: string[] (optional, inherited - location/biome/mood)
├── themes: string[] (optional, inherited - dark_fantasy, horror, high_fantasy)
├── timeOfDay: string[] (optional, enum: dawn, day, dusk, night)
└── season: string[] (optional, enum: spring, summer, autumn, winter)

SensoryCategory (enum)
├── lighting
├── sounds
├── smells
└── temperature

WeatherPoolTypes (enum)
├── weather_rain_indoor
├── weather_rain_outdoor
├── weather_storm_indoor
├── weather_storm_outdoor
├── weather_snow_indoor
├── weather_snow_outdoor
├── weather_fog_indoor
├── weather_fog_outdoor
├── weather_wind_indoor
└── weather_wind_outdoor

AmbientPoolTypes (enum)
├── sound
├── sound_cave
├── sound_dungeon
├── sound_forest
├── visual
├── visual_volcanic
├── visual_ruins
├── creature
├── creature_cave
├── creature_swamp
├── creature_forest
├── environmental
├── environmental_frozen
├── environmental_volcanic
└── environmental_swamp
```

---

## 14. Logging Specifications

### Log Levels by Component

| Component | Level | Events |
|-----------|-------|--------|
| Schema Validation | Debug | Schema loading, validation start/end |
| Schema Validation | Information | Successful validation of environment files |
| Schema Validation | Warning | Schema not found, using fallback |
| Schema Validation | Error | Validation failures, invalid enums |

### Log Message Formats

```
[Debug] Loading environment descriptor schema from: config/schemas/environment-descriptors.schema.json
[Debug] Validating environmental.json against environment-descriptors.schema.json
[Information] Successfully validated environmental.json (4 pools, 23 descriptors)
[Information] Successfully validated weather.json (10 pools, 40 descriptors)
[Information] Successfully validated ambient-events.json (15 pools, 81 descriptors)
[Warning] timeOfDay value 'morning' not in enum - did you mean 'dawn'?
[Error] Schema validation failed for weather.json: Invalid category 'environment' - must be 'environmental', 'weather', 'ambient', or 'objects'
```

---

## 15. Unit Testing Requirements

### Test Count by Feature

| Feature | Test Count |
|---------|------------|
| Schema Loading | 1 |
| Category Validation | 1 |
| Sensory Pool Validation | 1 |
| Weather Pool Validation | 1 |
| Ambient Pool Validation | 1 |
| Tag/Theme Validation | 1 |
| **Total** | **~6** |

### Test Specifications

**File:** `tests/RuneAndRust.Tests/Infrastructure/Validation/EnvironmentDescriptorSchemaTests.cs`

```csharp
[TestFixture]
public class EnvironmentDescriptorSchemaTests
{
    /// <summary>
    /// ESC-001: Verify environment-descriptors.schema.json loads and is valid JSON Schema
    /// </summary>
    [Test]
    public void EnvironmentDescriptorSchema_LoadsSuccessfully_ReturnsValidSchema();

    /// <summary>
    /// ESC-002: Verify category enum validation rejects non-environment categories
    /// </summary>
    [Test]
    public void EnvironmentDescriptorSchema_InvalidCategory_FailsValidation();

    /// <summary>
    /// ESC-003: Verify environmental.json validates against environment schema
    /// </summary>
    [Test]
    public void EnvironmentalJson_ValidatesAgainstSchema_Succeeds();

    /// <summary>
    /// ESC-004: Verify weather.json validates against environment schema
    /// </summary>
    [Test]
    public void WeatherJson_ValidatesAgainstSchema_Succeeds();

    /// <summary>
    /// ESC-005: Verify ambient-events.json validates against environment schema
    /// </summary>
    [Test]
    public void AmbientEventsJson_ValidatesAgainstSchema_Succeeds();

    /// <summary>
    /// ESC-006: Verify location tags and theme tags are validated as string arrays
    /// </summary>
    [Test]
    public void EnvironmentDescriptor_TagsAndThemes_ValidatesAsStringArrays();
}
```

---

## 16. Use Cases

### UC-001: Load Environment Descriptor Schema

**Actor:** System (Configuration Loader)
**Flow:** Application Start → Load environment-descriptors.schema.json → Parse JSON Schema → Cache schema → Ready for validation

### UC-002: Validate Environmental File

**Actor:** System (Configuration Validator)
**Flow:** Load environmental.json → Apply environment schema → Verify category is "environmental" → Validate all 4 pools → Validate descriptors with tags/themes → Return validation result

### UC-003: Validate Weather File

**Actor:** System (Configuration Validator)
**Flow:** Load weather.json → Apply environment schema → Verify category is "weather" → Validate all 10 pools → Validate indoor/outdoor naming → Return validation result

### UC-004: Validate Ambient Events File

**Actor:** System (Configuration Validator)
**Flow:** Load ambient-events.json → Apply environment schema → Verify category is "ambient" → Validate all 15 pools → Validate biome-specific pools → Return validation result

### UC-005: Select Sensory Descriptor by Context

**Actor:** Environment System (Runtime)
**Flow:** Room entry occurs → Get room context (tags, theme) → Select sensory pools (lighting, sounds, smells, temperature) → Filter by tags → Weighted random selection → Return composed atmosphere

---

## 17. Deliverable Checklist

### Schema Files
- [ ] `config/schemas/environment-descriptors.schema.json` created
- [ ] Schema extends master via allOf reference
- [ ] EnvironmentDescriptor definition complete
- [ ] SensoryCategory enum defined (4 values)
- [ ] WeatherPoolTypes enum defined (10 values)
- [ ] AmbientPoolTypes enum defined (15 values)
- [ ] Category enum defined (4 values)

### Configuration Updates
- [ ] `config/descriptors/environmental.json` updated with $schema reference
- [ ] `config/descriptors/weather.json` updated with $schema reference
- [ ] `config/descriptors/ambient-events.json` updated with $schema reference

### Unit Tests
- [ ] ESC-001: Schema loads successfully
- [ ] ESC-002: Invalid category fails validation
- [ ] ESC-003: environmental.json validates
- [ ] ESC-004: weather.json validates
- [ ] ESC-005: ambient-events.json validates
- [ ] ESC-006: Tags and themes validate as string arrays

### Documentation
- [ ] Design specification complete (this document)

---

## 18. Acceptance Criteria

### Functional Criteria
- [ ] `environment-descriptors.schema.json` created in `config/schemas/`
- [ ] Schema extends master descriptor schema via allOf
- [ ] Schema validates existing `environmental.json` (4 pools, 23 descriptors)
- [ ] Schema validates existing `weather.json` (10 pools, 40 descriptors)
- [ ] Schema validates existing `ambient-events.json` (15 pools, 81 descriptors)
- [ ] Category enum validates: environmental, weather, ambient, objects
- [ ] SensoryCategory enum validates 4 pool IDs
- [ ] WeatherPoolTypes enum validates 10 pool IDs
- [ ] AmbientPoolTypes enum validates 15 pool IDs
- [ ] Location tags validated as string arrays
- [ ] Theme tags validated as string arrays

### Quality Criteria
- [ ] Build completes with 0 errors
- [ ] Build completes with 0 warnings
- [ ] ~6 unit tests pass
- [ ] Schema follows JSON Schema Draft-07 specification
- [ ] Schema follows established naming conventions

---

## 19. Dependencies

### Required from v0.14.7a

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `descriptors.schema.json` | `config/schemas/` | Base schema for allOf extension |
| DescriptorPool definition | Schema definition | Inherited pool structure |
| Descriptor definition | Schema definition | Base for EnvironmentDescriptor |
| ID pattern validation | Schema definition | Inherited ID patterns |
| Weight validation | Schema definition | Inherited weight rules |
| Tag/theme arrays | Schema definition | Inherited filtering arrays |

### Parallel with v0.14.7b

| Type | Relationship |
|------|--------------|
| Schema extension pattern | Same pattern, different domain |
| Category enum approach | Same approach, different values |
| Pool type enums | Same pattern, different pools |

### Provides to Future Versions

| Type | Usage |
|------|-------|
| Environment descriptor validation | Runtime atmosphere generation |
| Pool type enums | Environment service pool lookups |
| Location/theme tags | Context-based filtering |
| Time/season filtering | Temporal atmosphere variation |

---

## 20. Future Considerations

### Deferred to Future Versions

- **Room generation logic** - Runtime descriptor selection is out of scope (application layer concern)
- **New weather types** - Adding new weather pools (e.g., weather_hail) would require schema enum update
- **New biome types** - Adding new ambient pools (e.g., sound_desert) would require schema enum update
- **Object descriptions** - The `objects` category is defined but no configuration file exists yet

### Out of Scope

- **Master descriptor schema** - Defined in v0.14.7a
- **Combat descriptor schema** - Defined in v0.14.7b
- **Dynamic pool registration** - Pools are statically defined in schema

---

## 21. Appendix: Schema Validation Examples

### Valid Environmental Entry

```json
{
  "$schema": "../schemas/environment-descriptors.schema.json",
  "category": "environmental",
  "pools": {
    "lighting": {
      "id": "lighting",
      "name": "Lighting",
      "descriptors": [
        {
          "id": "dim_torch",
          "text": "dimly lit by flickering torches",
          "weight": 20,
          "tags": ["indoor", "dungeon"],
          "themes": ["dark_fantasy", "horror"]
        },
        {
          "id": "eerie_glow",
          "text": "illuminated by an eerie phosphorescent glow",
          "weight": 10,
          "tags": ["magic", "cave"],
          "themes": ["dark_fantasy", "horror"]
        }
      ]
    }
  }
}
```

### Valid Weather Entry with Indoor/Outdoor Variants

```json
{
  "$schema": "../schemas/environment-descriptors.schema.json",
  "category": "weather",
  "pools": {
    "weather_rain_indoor": {
      "id": "weather_rain_indoor",
      "name": "Rain (Indoor)",
      "descriptors": [
        { "id": "rain_roof", "text": "Rain patters steadily on the roof above", "weight": 30 },
        { "id": "water_seep", "text": "Water seeps through cracks in the ceiling", "weight": 25 }
      ]
    },
    "weather_rain_outdoor": {
      "id": "weather_rain_outdoor",
      "name": "Rain (Outdoor)",
      "descriptors": [
        { "id": "steady_rain", "text": "Steady rain patters against you", "weight": 30 },
        { "id": "rain_soaked", "text": "Rain soaks through your clothing", "weight": 25 }
      ]
    }
  }
}
```

### Valid Ambient Entry with Biome-Specific Pool

```json
{
  "$schema": "../schemas/environment-descriptors.schema.json",
  "category": "ambient",
  "pools": {
    "creature_forest": {
      "id": "creature_forest",
      "name": "Creature Events (Forest)",
      "descriptors": [
        { "id": "deer_flee", "text": "A deer freezes at your approach, then bounds away through the trees", "weight": 25 },
        { "id": "squirrel_chatter", "text": "A squirrel chatters angrily at you from a high branch", "weight": 25 }
      ]
    }
  }
}
```

### Valid Descriptor with Time and Season

```json
{
  "id": "morning_mist",
  "text": "Morning mist clings to the ground, slowly burning off",
  "weight": 20,
  "tags": ["outdoor", "forest"],
  "timeOfDay": ["dawn"],
  "season": ["spring", "autumn"]
}
```

### Invalid: Category Not in Enum

```json
{
  "$schema": "../schemas/environment-descriptors.schema.json",
  "category": "combat-hits",  // ERROR: Not a valid environment category
  "pools": { }
}
```

**Error:** `category` must be one of: environmental, weather, ambient, objects

### Invalid: Missing Pool ID

```json
{
  "pools": {
    "lighting": {
      "name": "Lighting",
      // ERROR: Missing required "id" property
      "descriptors": [...]
    }
  }
}
```

**Error:** Required property `id` is missing from pool definition

### Invalid: Empty Descriptors Array

```json
{
  "pools": {
    "lighting": {
      "id": "lighting",
      "name": "Lighting",
      "descriptors": []  // ERROR: minItems is 1
    }
  }
}
```

**Error:** `descriptors` array must contain at least 1 item

### Invalid: timeOfDay Value Not in Enum

```json
{
  "id": "morning_light",
  "text": "Soft morning light filters through",
  "weight": 20,
  "timeOfDay": ["morning"]  // ERROR: Should be "dawn"
}
```

**Error:** `timeOfDay` value must be one of: dawn, day, dusk, night

---

*Document Version: 1.0*
*Last Updated: 2026-01-17*
*Author: Claude (AI Assistant)*
