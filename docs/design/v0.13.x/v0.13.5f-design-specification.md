# v0.13.5f Design Specification: Accessibility & Performance

**Version:** 0.13.5f
**Theme:** Accessibility & Performance
**Author:** Claude
**Created:** 2026-01-16
**Status:** Draft
**Prerequisites:** v0.13.5b Complete (Theme Consolidation), v0.13.5e Complete (Shared Layer Utilization)

---

## Table of Contents

1. [Overview](#1-overview)
2. [Dependencies](#2-dependencies)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Color Blind Mode Implementation](#4-color-blind-mode-implementation)
5. [Screen Reader Support](#5-screen-reader-support)
6. [Keyboard Navigation](#6-keyboard-navigation)
7. [Lazy Loading](#7-lazy-loading)
8. [Animation Optimization](#8-animation-optimization)
9. [Data Model Changes](#9-data-model-changes)
10. [Configuration](#10-configuration)
11. [Commands](#11-commands)
12. [User-Facing Changes](#12-user-facing-changes)
13. [Logging Specifications](#13-logging-specifications)
14. [Unit Testing Requirements](#14-unit-testing-requirements)
15. [Use Cases](#15-use-cases)
16. [Deliverable Checklist](#16-deliverable-checklist)
17. [Acceptance Criteria](#17-acceptance-criteria)
18. [Future Considerations](#18-future-considerations)
19. [Implementation Notes](#19-implementation-notes)
20. [Document Metadata](#20-document-metadata)

---

## 1. Overview

### 1.1 Purpose

This document provides a comprehensive design specification for v0.13.5f, the Accessibility & Performance implementation. This part focuses on implementing inclusive design features (color blind modes, screen reader support, keyboard navigation) and performance optimizations (lazy loading, animation optimization) to ensure the application is accessible to all users and performs smoothly across a variety of hardware.

### 1.2 Scope

**In Scope:**
- Implement `ColorBlindMode` enum and color shift algorithms
- Create `IAccessibilityService` interface
- Implement screen reader text labels for UI elements
- Enhance keyboard navigation for all panels
- Implement `LazyLoader<T>` for large lists
- Create `AnimationOptimizer` for performance tuning
- Persist accessibility settings in configuration

**Out of Scope:**
- Shared layer refactoring (v0.13.5e - completed)
- Error handling changes (v0.13.5d - completed)
- Service integration patterns (v0.13.5c - completed)
- Theme consolidation (v0.13.5b - completed, but provides IThemeService)
- Naming conventions (v0.13.5a - completed)

### 1.3 Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Enums | 1 | `ColorBlindMode` |
| Interfaces | 1 | `IAccessibilityService` |
| Services | 2 | `AccessibilityService`, `AnimationOptimizer` |
| Utilities | 1 | `LazyLoader<T>` |
| Configuration | 1 | `AccessibilitySettings` |
| Unit Tests | ~4 | Accessibility, performance tests |

---

## 2. Dependencies

### 2.1 Required from v0.13.5b (Theme Consolidation)

| Component | Location | Usage |
|-----------|----------|-------|
| `IThemeService` | `Presentation.Shared/Interfaces/` | Color access for color blind adjustment |
| `ThemeColor` | `Presentation.Shared/ValueObjects/` | Color representation |
| `ColorKey` | `Presentation.Shared/Enums/` | Color lookup keys |
| `ColorPalette` | `Presentation.Shared/ValueObjects/` | Base color definitions |

### 2.2 Required from v0.13.5e (Shared Layer Utilization)

| Component | Location | Usage |
|-----------|----------|-------|
| `FormatUtilities` | `Presentation.Shared/Utilities/` | Accessible text formatting |
| `ValidationUtilities` | `Presentation.Shared/Utilities/` | Input validation |

### 2.3 Required from v0.13.5c (Service Integration Patterns)

| Component | Location | Usage |
|-----------|----------|-------|
| `TuiComponentBase` | `Presentation.Tui/Base/` | Accessibility property injection |
| `GuiControlBase` | `Presentation.Gui/Base/` | Accessibility property injection |
| `IComponentLifecycle` | `Presentation.Shared/Interfaces/` | Lifecycle for lazy loading |

### 2.4 Components Requiring Accessibility Updates

| Component | Layer | Accessibility Features |
|-----------|-------|------------------------|
| `HealthBarDisplay` | TUI | Color blind colors, screen reader text |
| `ResourceBarDisplay` | TUI | Color blind colors, screen reader text |
| `CombatGridPanel` | TUI | Keyboard navigation, color blind colors |
| `StatusEffectPanel` | TUI | Color blind colors, icon alternatives |
| `AchievementPanel` | TUI | Lazy loading, keyboard navigation |
| `LeaderboardView` | TUI | Lazy loading, keyboard navigation |
| `HealthBarControl` | GUI | Color blind colors, automation properties |
| `GridCellControl` | GUI | Color blind colors, keyboard focus |
| `AchievementListControl` | GUI | Lazy loading, virtualization |

---

## 3. Architecture Diagrams

### 3.1 Accessibility Service Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    ACCESSIBILITY SERVICE ARCHITECTURE                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│                         Presentation.Shared                                  │
│                         ───────────────────                                  │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │              IAccessibilityService (Interface)                       │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │ + ColorBlindMode : ColorBlindMode { get; set; }                      │    │
│  │ + IsHighContrastEnabled : bool { get; set; }                         │    │
│  │ + IsReducedMotionEnabled : bool { get; set; }                        │    │
│  │ + IsScreenReaderActive : bool { get; }                               │    │
│  │ + GetAccessibleColor(ThemeColor) : ThemeColor                        │    │
│  │ + GetAltText(IconKey) : string                                       │    │
│  │ + GetAltText(string icon) : string                                   │    │
│  │ + Announce(string message) : void                                    │    │
│  │ + GetFocusableElements() : IEnumerable<IFocusable>                   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                    ▲                                         │
│                                    │ implements                              │
│                    ┌───────────────┴───────────────┐                        │
│                    │                               │                        │
├────────────────────┼───────────────────────────────┼────────────────────────┤
│    Presentation.Tui│                               │    Presentation.Gui    │
│    ───────────────┐│                               │    ───────────────┐    │
│                   ││                               │                   │    │
│  ┌────────────────▼┴───────────────┐  ┌───────────▼────────────────┐  │    │
│  │   TuiAccessibilityService       │  │  GuiAccessibilityService   │  │    │
│  ├─────────────────────────────────┤  ├────────────────────────────┤  │    │
│  │ - _colorBlindMode: ColorBlind.. │  │ - _colorBlindMode: Color.. │  │    │
│  │ - _settings: AccessibilitySett. │  │ - _settings: Accessibili.. │  │    │
│  │                                 │  │ - _automation: IAutomat... │  │    │
│  │ + GetAccessibleColor()          │  │                            │  │    │
│  │ + GetAltText()                  │  │ + GetAccessibleColor()     │  │    │
│  │ + Announce() (console output)   │  │ + GetAltText()             │  │    │
│  └─────────────────────────────────┘  │ + Announce() (narrator)    │  │    │
│                                       └────────────────────────────┘  │    │
│                                                                       │    │
└───────────────────────────────────────────────────────────────────────┴────┘
```

### 3.2 Color Blind Mode Color Transformation

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    COLOR BLIND MODE TRANSFORMATION                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Original Color                                                              │
│       │                                                                      │
│       ▼                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  IAccessibilityService.GetAccessibleColor(ThemeColor)               │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│       │                                                                      │
│       ▼                                                                      │
│  ┌───────────────────────────────────────────────┐                          │
│  │         Check ColorBlindMode                   │                          │
│  └───────────────────┬───────────────────────────┘                          │
│                      │                                                       │
│      ┌───────────────┼───────────────┬───────────────┐                      │
│      │               │               │               │                      │
│      ▼               ▼               ▼               ▼                      │
│  ┌───────┐      ┌─────────┐    ┌─────────┐    ┌─────────┐                  │
│  │ None  │      │Protanopia│    │Deuteran.│    │Tritanop.│                  │
│  │       │      │(Red-weak)│    │(Green-w)│    │(Blue-w) │                  │
│  └───┬───┘      └────┬────┘    └────┬────┘    └────┬────┘                  │
│      │               │              │              │                        │
│      │               ▼              ▼              ▼                        │
│      │         ┌─────────────────────────────────────┐                     │
│      │         │     Apply Color Matrix Transform    │                     │
│      │         │                                     │                     │
│      │         │  Protanopia Matrix:                 │                     │
│      │         │  [0.567, 0.433, 0.000]              │                     │
│      │         │  [0.558, 0.442, 0.000]              │                     │
│      │         │  [0.000, 0.242, 0.758]              │                     │
│      │         │                                     │                     │
│      │         │  Deuteranopia Matrix:               │                     │
│      │         │  [0.625, 0.375, 0.000]              │                     │
│      │         │  [0.700, 0.300, 0.000]              │                     │
│      │         │  [0.000, 0.300, 0.700]              │                     │
│      │         │                                     │                     │
│      │         │  Tritanopia Matrix:                 │                     │
│      │         │  [0.950, 0.050, 0.000]              │                     │
│      │         │  [0.000, 0.433, 0.567]              │                     │
│      │         │  [0.000, 0.475, 0.525]              │                     │
│      │         └──────────────┬──────────────────────┘                     │
│      │                        │                                             │
│      ▼                        ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    Transformed ThemeColor                            │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│  Visual Example:                                                             │
│  ───────────────                                                             │
│                                                                              │
│  Normal Vision:                                                              │
│  ┌─────┬─────┬─────┬─────┬─────┐                                           │
│  │Green│Yellow│Orange│ Red │Purple│  (Health gradient)                     │
│  └─────┴─────┴─────┴─────┴─────┘                                           │
│                                                                              │
│  Protanopia (Red-weak):                                                      │
│  ┌─────┬─────┬─────┬─────┬─────┐                                           │
│  │Green│Yellow│Brown │Brown│ Blue │  (Red → Brown/Gray)                     │
│  └─────┴─────┴─────┴─────┴─────┘                                           │
│                                                                              │
│  Deuteranopia (Green-weak):                                                  │
│  ┌─────┬─────┬─────┬─────┬─────┐                                           │
│  │Yellow│Yellow│Orange│ Red │Purple│  (Green → Yellow)                      │
│  └─────┴─────┴─────┴─────┴─────┘                                           │
│                                                                              │
│  Tritanopia (Blue-weak):                                                     │
│  ┌─────┬─────┬─────┬─────┬─────┐                                           │
│  │Green│Yellow│Orange│ Red │ Pink │  (Blue/Purple → Pink)                   │
│  └─────┴─────┴─────┴─────┴─────┘                                           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Lazy Loading Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    LAZY LOADING ARCHITECTURE                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │              LazyLoader<T> (Generic Utility)                         │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │ - _dataSource: Func<int, int, IEnumerable<T>>                        │    │
│  │ - _pageSize: int                                                     │    │
│  │ - _totalCount: int?                                                  │    │
│  │ - _loadedPages: Dictionary<int, List<T>>                             │    │
│  │ - _currentPage: int                                                  │    │
│  │                                                                       │    │
│  │ + LoadPage(int pageIndex) : IEnumerable<T>                           │    │
│  │ + LoadNextPage() : IEnumerable<T>                                    │    │
│  │ + LoadPreviousPage() : IEnumerable<T>                                │    │
│  │ + GetItem(int index) : T?                                            │    │
│  │ + Prefetch(int pageIndex) : Task                                     │    │
│  │ + InvalidateCache() : void                                           │    │
│  │                                                                       │    │
│  │ + TotalCount : int { get; }                                          │    │
│  │ + LoadedCount : int { get; }                                         │    │
│  │ + CurrentPage : int { get; }                                         │    │
│  │ + TotalPages : int { get; }                                          │    │
│  │ + HasMorePages : bool { get; }                                       │    │
│  │ + HasPreviousPages : bool { get; }                                   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  Usage Flow:                                                                 │
│  ───────────                                                                 │
│                                                                              │
│  AchievementPanel                         LazyLoader<Achievement>            │
│       │                                          │                          │
│       │  1. Create loader                        │                          │
│       │─────────────────────────────────────────▶│                          │
│       │     new LazyLoader(fetchFn, pageSize=20) │                          │
│       │                                          │                          │
│       │  2. Load initial page                    │                          │
│       │─────────────────────────────────────────▶│                          │
│       │     LoadPage(0)                          │                          │
│       │                                          │                          │
│       │◀─────────────────────────────────────────│                          │
│       │     IEnumerable<Achievement> (0-19)      │                          │
│       │                                          │                          │
│       │  3. User scrolls down                    │                          │
│       │─────────────────────────────────────────▶│                          │
│       │     LoadNextPage()                       │                          │
│       │                                          │                          │
│       │◀─────────────────────────────────────────│                          │
│       │     IEnumerable<Achievement> (20-39)     │                          │
│       │                                          │                          │
│       │  4. Prefetch next page (background)      │                          │
│       │─────────────────────────────────────────▶│                          │
│       │     Prefetch(2)                          │                          │
│       │                                          │                          │
│                                                                              │
│  Memory Optimization:                                                        │
│  ────────────────────                                                        │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  Page Cache (keeps last 3 pages)                                     │   │
│  │                                                                       │   │
│  │  [Page 0: ████] [Page 1: ████] [Page 2: ████] [Page 3: ----]         │   │
│  │    ^current       ^cached        ^prefetched    ^not loaded           │   │
│  │                                                                       │   │
│  │  When loading Page 4:                                                 │   │
│  │  - Evict Page 0                                                       │   │
│  │  - Load Page 4                                                        │   │
│  │  - Prefetch Page 5                                                    │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Color Blind Mode Implementation

### 4.1 ColorBlindMode Enum

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  ColorBlindMode (Enum - Presentation.Shared)                                 │
│  ───────────────────────────────────────────                                 │
│                                                                              │
│  Location: Presentation.Shared/Enums/ColorBlindMode.cs                       │
│                                                                              │
│  /// <summary>                                                               │
│  /// Color vision deficiency modes for accessibility.                        │
│  /// </summary>                                                              │
│  public enum ColorBlindMode                                                  │
│  {                                                                           │
│      /// <summary>No color adjustment (normal vision).</summary>             │
│      None = 0,                                                               │
│                                                                              │
│      /// <summary>                                                           │
│      /// Protanopia: Red color blindness (red-weak/absent).                  │
│      /// Affects ~1% of males, 0.01% of females.                             │
│      /// Red appears as dark brown/black, green appears as tan.              │
│      /// </summary>                                                          │
│      Protanopia = 1,                                                         │
│                                                                              │
│      /// <summary>                                                           │
│      /// Deuteranopia: Green color blindness (green-weak/absent).            │
│      /// Most common form, affects ~6% of males, 0.4% of females.            │
│      /// Green appears as beige, red appears as brownish-yellow.             │
│      /// </summary>                                                          │
│      Deuteranopia = 2,                                                       │
│                                                                              │
│      /// <summary>                                                           │
│      /// Tritanopia: Blue color blindness (blue-weak/absent).                │
│      /// Rare, affects ~0.01% of population.                                 │
│      /// Blue appears as green, yellow appears as pink.                      │
│      /// </summary>                                                          │
│      Tritanopia = 3                                                          │
│  }                                                                           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.2 Color Transformation Implementation

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  ColorBlindTransform (Static Class - Presentation.Shared)                    │
│  ────────────────────────────────────────────────────────                    │
│                                                                              │
│  Location: Presentation.Shared/Utilities/ColorBlindTransform.cs              │
│                                                                              │
│  public static class ColorBlindTransform                                     │
│  {                                                                           │
│      // Color transformation matrices based on research by                   │
│      // Machado, Oliveira & Fernandes (2009)                                 │
│                                                                              │
│      private static readonly double[,] ProtanopiaMatrix = new double[,]      │
│      {                                                                       │
│          { 0.567, 0.433, 0.000 },                                            │
│          { 0.558, 0.442, 0.000 },                                            │
│          { 0.000, 0.242, 0.758 }                                             │
│      };                                                                      │
│                                                                              │
│      private static readonly double[,] DeuteranopiaMatrix = new double[,]    │
│      {                                                                       │
│          { 0.625, 0.375, 0.000 },                                            │
│          { 0.700, 0.300, 0.000 },                                            │
│          { 0.000, 0.300, 0.700 }                                             │
│      };                                                                      │
│                                                                              │
│      private static readonly double[,] TritanopiaMatrix = new double[,]      │
│      {                                                                       │
│          { 0.950, 0.050, 0.000 },                                            │
│          { 0.000, 0.433, 0.567 },                                            │
│          { 0.000, 0.475, 0.525 }                                             │
│      };                                                                      │
│                                                                              │
│      /// <summary>                                                           │
│      /// Transforms a color for the specified color blind mode.              │
│      /// </summary>                                                          │
│      public static ThemeColor Transform(ThemeColor color,                    │
│          ColorBlindMode mode)                                                │
│      {                                                                       │
│          if (mode == ColorBlindMode.None)                                    │
│              return color;                                                   │
│                                                                              │
│          var matrix = mode switch                                            │
│          {                                                                   │
│              ColorBlindMode.Protanopia => ProtanopiaMatrix,                  │
│              ColorBlindMode.Deuteranopia => DeuteranopiaMatrix,              │
│              ColorBlindMode.Tritanopia => TritanopiaMatrix,                  │
│              _ => throw new ArgumentOutOfRangeException(nameof(mode))        │
│          };                                                                  │
│                                                                              │
│          return ApplyMatrix(color, matrix);                                  │
│      }                                                                       │
│                                                                              │
│      private static ThemeColor ApplyMatrix(ThemeColor color,                 │
│          double[,] matrix)                                                   │
│      {                                                                       │
│          // Normalize to 0-1 range                                           │
│          double r = color.R / 255.0;                                         │
│          double g = color.G / 255.0;                                         │
│          double b = color.B / 255.0;                                         │
│                                                                              │
│          // Apply matrix transformation                                      │
│          double newR = matrix[0, 0] * r + matrix[0, 1] * g + matrix[0, 2] * b│
│          double newG = matrix[1, 0] * r + matrix[1, 1] * g + matrix[1, 2] * b│
│          double newB = matrix[2, 0] * r + matrix[2, 1] * g + matrix[2, 2] * b│
│                                                                              │
│          // Clamp and convert back to byte range                             │
│          return new ThemeColor(                                              │
│              (byte)Math.Clamp(newR * 255, 0, 255),                           │
│              (byte)Math.Clamp(newG * 255, 0, 255),                           │
│              (byte)Math.Clamp(newB * 255, 0, 255),                           │
│              $"{color.Name} (CB)");                                          │
│      }                                                                       │
│  }                                                                           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. Screen Reader Support

### 5.1 IAccessibilityService Interface

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  IAccessibilityService (Interface - Presentation.Shared)                     │
│  ───────────────────────────────────────────────────────                     │
│                                                                              │
│  Location: Presentation.Shared/Interfaces/IAccessibilityService.cs           │
│                                                                              │
│  public interface IAccessibilityService                                      │
│  {                                                                           │
│      // ═══════════════════════════════════════════════════════════════════ │
│      // COLOR BLIND SUPPORT                                                  │
│      // ═══════════════════════════════════════════════════════════════════ │
│                                                                              │
│      /// <summary>Current color blind mode.</summary>                        │
│      ColorBlindMode ColorBlindMode { get; set; }                             │
│                                                                              │
│      /// <summary>Transforms a color for the current color blind mode.</summ>│
│      ThemeColor GetAccessibleColor(ThemeColor color);                        │
│                                                                              │
│      // ═══════════════════════════════════════════════════════════════════ │
│      // VISUAL SETTINGS                                                      │
│      // ═══════════════════════════════════════════════════════════════════ │
│                                                                              │
│      /// <summary>Whether high contrast mode is enabled.</summary>           │
│      bool IsHighContrastEnabled { get; set; }                                │
│                                                                              │
│      /// <summary>Whether reduced motion is preferred.</summary>             │
│      bool IsReducedMotionEnabled { get; set; }                               │
│                                                                              │
│      // ═══════════════════════════════════════════════════════════════════ │
│      // SCREEN READER SUPPORT                                                │
│      // ═══════════════════════════════════════════════════════════════════ │
│                                                                              │
│      /// <summary>Whether a screen reader is detected/active.</summary>      │
│      bool IsScreenReaderActive { get; }                                      │
│                                                                              │
│      /// <summary>Gets alternative text description for an icon.</summary>   │
│      string GetAltText(IconKey iconKey);                                     │
│                                                                              │
│      /// <summary>Gets alternative text for a custom icon string.</summary>  │
│      string GetAltText(string iconCharacter);                                │
│                                                                              │
│      /// <summary>Announces a message to the screen reader.</summary>        │
│      void Announce(string message);                                          │
│                                                                              │
│      /// <summary>Announces a message with specified priority.</summary>     │
│      void Announce(string message, AnnouncementPriority priority);           │
│                                                                              │
│      // ═══════════════════════════════════════════════════════════════════ │
│      // KEYBOARD NAVIGATION                                                  │
│      // ═══════════════════════════════════════════════════════════════════ │
│                                                                              │
│      /// <summary>Whether keyboard navigation labels should be shown.</summ> │
│      bool ShowKeyboardHints { get; set; }                                    │
│                                                                              │
│      /// <summary>Gets the keyboard shortcut for an action.</summary>        │
│      string? GetKeyboardShortcut(string actionId);                           │
│  }                                                                           │
│                                                                              │
│  public enum AnnouncementPriority                                            │
│  {                                                                           │
│      /// <summary>Normal announcement (may be interrupted).</summary>        │
│      Normal,                                                                 │
│                                                                              │
│      /// <summary>Important announcement (interrupts current speech).</summ> │
│      Important,                                                              │
│                                                                              │
│      /// <summary>Assertive announcement (always read immediately).</summary>│
│      Assertive                                                               │
│  }                                                                           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 5.2 Alt Text Mappings

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    ALT TEXT MAPPINGS                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  IconKey Alt Text Mappings:                                                  │
│  ──────────────────────────                                                  │
│                                                                              │
│  ┌────────────────────────┬──────────────────────────────────────────────┐  │
│  │ IconKey                │ Alt Text                                     │  │
│  ├────────────────────────┼──────────────────────────────────────────────┤  │
│  │ Health                 │ "Health"                                     │  │
│  │ Mana                   │ "Mana"                                       │  │
│  │ Rage                   │ "Rage"                                       │  │
│  │ Energy                 │ "Energy"                                     │  │
│  │ Stamina                │ "Stamina"                                    │  │
│  │ Attack                 │ "Attack"                                     │  │
│  │ Defense                │ "Defense"                                    │  │
│  │ Buff                   │ "Buff active"                                │  │
│  │ Debuff                 │ "Debuff active"                              │  │
│  │ Fire                   │ "Fire damage"                                │  │
│  │ Ice                    │ "Ice damage"                                 │  │
│  │ Lightning              │ "Lightning damage"                           │  │
│  │ Poison                 │ "Poison damage"                              │  │
│  │ Check                  │ "Completed"                                  │  │
│  │ Cross                  │ "Failed"                                     │  │
│  │ Warning                │ "Warning"                                    │  │
│  │ Info                   │ "Information"                                │  │
│  │ Player                 │ "Player"                                     │  │
│  │ Enemy                  │ "Enemy"                                      │  │
│  │ NPC                    │ "Non-player character"                       │  │
│  │ D20                    │ "20-sided die"                               │  │
│  │ CriticalHit            │ "Critical hit!"                              │  │
│  │ CriticalMiss           │ "Critical miss!"                             │  │
│  └────────────────────────┴──────────────────────────────────────────────┘  │
│                                                                              │
│  Direction Alt Text:                                                         │
│  ───────────────────                                                         │
│                                                                              │
│  ┌────────────────┬─────────────────────┐                                   │
│  │ Icon           │ Alt Text            │                                   │
│  ├────────────────┼─────────────────────┤                                   │
│  │ ↑              │ "Up"                │                                   │
│  │ ↓              │ "Down"              │                                   │
│  │ ←              │ "Left"              │                                   │
│  │ →              │ "Right"             │                                   │
│  │ ↗              │ "Up-right"          │                                   │
│  │ ↘              │ "Down-right"        │                                   │
│  │ ↙              │ "Down-left"         │                                   │
│  │ ↖              │ "Up-left"           │                                   │
│  └────────────────┴─────────────────────┘                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 6. Keyboard Navigation

### 6.1 Keyboard Navigation Scheme

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    KEYBOARD NAVIGATION SCHEME                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Global Navigation:                                                          │
│  ──────────────────                                                          │
│                                                                              │
│  ┌──────────────────┬─────────────────────────────────────────────────────┐ │
│  │ Key              │ Action                                              │ │
│  ├──────────────────┼─────────────────────────────────────────────────────┤ │
│  │ Tab              │ Move focus to next panel/section                    │ │
│  │ Shift+Tab        │ Move focus to previous panel/section                │ │
│  │ Escape           │ Close current dialog/menu, return to previous view  │ │
│  │ F1               │ Open help/accessibility settings                    │ │
│  │ F11              │ Toggle fullscreen (GUI only)                        │ │
│  └──────────────────┴─────────────────────────────────────────────────────┘ │
│                                                                              │
│  Panel Navigation:                                                           │
│  ─────────────────                                                           │
│                                                                              │
│  ┌──────────────────┬─────────────────────────────────────────────────────┐ │
│  │ Key              │ Action                                              │ │
│  ├──────────────────┼─────────────────────────────────────────────────────┤ │
│  │ ↑ / ↓            │ Move selection up/down within list                  │ │
│  │ ← / →            │ Move selection left/right within grid               │ │
│  │ Home             │ Jump to first item                                  │ │
│  │ End              │ Jump to last item                                   │ │
│  │ Page Up          │ Scroll up one page                                  │ │
│  │ Page Down        │ Scroll down one page                                │ │
│  │ Enter / Space    │ Select/activate current item                        │ │
│  └──────────────────┴─────────────────────────────────────────────────────┘ │
│                                                                              │
│  Combat Grid Navigation:                                                     │
│  ───────────────────────                                                     │
│                                                                              │
│  ┌──────────────────┬─────────────────────────────────────────────────────┐ │
│  │ Key              │ Action                                              │ │
│  ├──────────────────┼─────────────────────────────────────────────────────┤ │
│  │ ↑↓←→             │ Move cursor on grid                                 │ │
│  │ 1-9 (numpad)     │ Move in 8 directions + stay (5)                     │ │
│  │ Enter            │ Confirm move/select target                          │ │
│  │ Space            │ Select current cell                                 │ │
│  │ A                │ Open ability menu                                   │ │
│  │ I                │ Open inventory                                      │ │
│  │ C                │ Open character sheet                                │ │
│  │ M                │ Open map                                            │ │
│  └──────────────────┴─────────────────────────────────────────────────────┘ │
│                                                                              │
│  Focus Indicator Styles:                                                     │
│  ───────────────────────                                                     │
│                                                                              │
│  TUI Focus:                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  [ ] Normal Item                                                    │    │
│  │  [>] Focused Item  <── Arrow indicator + highlight color            │    │
│  │  [ ] Normal Item                                                    │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  GUI Focus:                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  ┌─────────────┐                                                    │    │
│  │  │ Normal Item │                                                    │    │
│  │  └─────────────┘                                                    │    │
│  │  ╔═════════════╗  <── Highlighted border (2px, accent color)        │    │
│  │  ║ Focused Item║                                                    │    │
│  │  ╚═════════════╝                                                    │    │
│  │  ┌─────────────┐                                                    │    │
│  │  │ Normal Item │                                                    │    │
│  │  └─────────────┘                                                    │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 7. Lazy Loading

### 7.1 LazyLoader Implementation

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  LazyLoader<T> (Generic Class - Presentation.Shared)                         │
│  ────────────────────────────────────────────────────                        │
│                                                                              │
│  Location: Presentation.Shared/Utilities/LazyLoader.cs                       │
│                                                                              │
│  public class LazyLoader<T>                                                  │
│  {                                                                           │
│      private readonly Func<int, int, IEnumerable<T>> _dataSource;            │
│      private readonly Func<int>? _totalCountSource;                          │
│      private readonly int _pageSize;                                         │
│      private readonly int _cacheSize;                                        │
│      private readonly Dictionary<int, List<T>> _pageCache;                   │
│      private readonly Queue<int> _cacheOrder;                                │
│      private int? _totalCount;                                               │
│                                                                              │
│      public LazyLoader(                                                      │
│          Func<int, int, IEnumerable<T>> dataSource,                          │
│          int pageSize = 20,                                                  │
│          int cacheSize = 3,                                                  │
│          Func<int>? totalCountSource = null)                                 │
│      {                                                                       │
│          _dataSource = dataSource ??                                         │
│              throw new ArgumentNullException(nameof(dataSource));            │
│          _pageSize = pageSize > 0 ? pageSize : 20;                           │
│          _cacheSize = cacheSize > 0 ? cacheSize : 3;                         │
│          _totalCountSource = totalCountSource;                               │
│          _pageCache = new Dictionary<int, List<T>>();                        │
│          _cacheOrder = new Queue<int>();                                     │
│      }                                                                       │
│                                                                              │
│      public int CurrentPage { get; private set; }                            │
│                                                                              │
│      public int TotalCount                                                   │
│      {                                                                       │
│          get                                                                 │
│          {                                                                   │
│              _totalCount ??= _totalCountSource?.Invoke() ?? 0;               │
│              return _totalCount.Value;                                       │
│          }                                                                   │
│      }                                                                       │
│                                                                              │
│      public int TotalPages => (int)Math.Ceiling((double)TotalCount / _pSize);│
│                                                                              │
│      public int LoadedCount => _pageCache.Values.Sum(p => p.Count);          │
│                                                                              │
│      public bool HasMorePages => CurrentPage < TotalPages - 1;               │
│                                                                              │
│      public bool HasPreviousPages => CurrentPage > 0;                        │
│                                                                              │
│      public IEnumerable<T> LoadPage(int pageIndex)                           │
│      {                                                                       │
│          if (pageIndex < 0)                                                  │
│              throw new ArgumentOutOfRangeException(nameof(pageIndex));       │
│                                                                              │
│          if (!_pageCache.TryGetValue(pageIndex, out var page))               │
│          {                                                                   │
│              var skip = pageIndex * _pageSize;                               │
│              page = _dataSource(skip, _pageSize).ToList();                   │
│              CachePage(pageIndex, page);                                     │
│          }                                                                   │
│                                                                              │
│          CurrentPage = pageIndex;                                            │
│          return page;                                                        │
│      }                                                                       │
│                                                                              │
│      public IEnumerable<T> LoadNextPage()                                    │
│      {                                                                       │
│          return HasMorePages ? LoadPage(CurrentPage + 1) : Enumerable.Empty<T│
│      }                                                                       │
│                                                                              │
│      public IEnumerable<T> LoadPreviousPage()                                │
│      {                                                                       │
│          return HasPreviousPages ? LoadPage(CurrentPage - 1) : Enumerable.Emp│
│      }                                                                       │
│                                                                              │
│      public T? GetItem(int index)                                            │
│      {                                                                       │
│          if (index < 0 || index >= TotalCount)                               │
│              return default;                                                 │
│                                                                              │
│          var pageIndex = index / _pageSize;                                  │
│          var itemIndex = index % _pageSize;                                  │
│                                                                              │
│          var page = LoadPage(pageIndex).ToList();                            │
│          return itemIndex < page.Count ? page[itemIndex] : default;          │
│      }                                                                       │
│                                                                              │
│      public async Task PrefetchAsync(int pageIndex)                          │
│      {                                                                       │
│          if (pageIndex < 0 || pageIndex >= TotalPages)                       │
│              return;                                                         │
│                                                                              │
│          if (!_pageCache.ContainsKey(pageIndex))                             │
│          {                                                                   │
│              await Task.Run(() =>                                            │
│              {                                                               │
│                  var skip = pageIndex * _pageSize;                           │
│                  var page = _dataSource(skip, _pageSize).ToList();           │
│                  CachePage(pageIndex, page);                                 │
│              });                                                             │
│          }                                                                   │
│      }                                                                       │
│                                                                              │
│      public void InvalidateCache()                                           │
│      {                                                                       │
│          _pageCache.Clear();                                                 │
│          _cacheOrder.Clear();                                                │
│          _totalCount = null;                                                 │
│      }                                                                       │
│                                                                              │
│      private void CachePage(int pageIndex, List<T> page)                     │
│      {                                                                       │
│          // Evict oldest pages if cache is full                              │
│          while (_cacheOrder.Count >= _cacheSize)                             │
│          {                                                                   │
│              var oldest = _cacheOrder.Dequeue();                             │
│              _pageCache.Remove(oldest);                                      │
│          }                                                                   │
│                                                                              │
│          _pageCache[pageIndex] = page;                                       │
│          _cacheOrder.Enqueue(pageIndex);                                     │
│      }                                                                       │
│  }                                                                           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 8. Animation Optimization

### 8.1 AnimationOptimizer Implementation

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  AnimationOptimizer (Class - Presentation.Shared)                            │
│  ────────────────────────────────────────────────                            │
│                                                                              │
│  Location: Presentation.Shared/Utilities/AnimationOptimizer.cs               │
│                                                                              │
│  public class AnimationOptimizer                                             │
│  {                                                                           │
│      private readonly IAccessibilityService _accessibility;                  │
│      private int _frameSkipCounter;                                          │
│      private DateTime _lastFrameTime;                                        │
│      private double _averageFrameTime;                                       │
│      private const double TargetFrameTimeMs = 16.67; // 60 FPS               │
│      private const double LowPowerThresholdMs = 33.33; // 30 FPS             │
│                                                                              │
│      public AnimationOptimizer(IAccessibilityService accessibility)          │
│      {                                                                       │
│          _accessibility = accessibility;                                     │
│          _lastFrameTime = DateTime.UtcNow;                                   │
│      }                                                                       │
│                                                                              │
│      /// <summary>                                                           │
│      /// Whether animations should be played.                                │
│      /// </summary>                                                          │
│      public bool ShouldAnimate()                                             │
│      {                                                                       │
│          // Respect reduced motion preference                                │
│          if (_accessibility?.IsReducedMotionEnabled == true)                 │
│              return false;                                                   │
│                                                                              │
│          // Skip animation if running at low frame rate                      │
│          if (_averageFrameTime > LowPowerThresholdMs)                        │
│              return false;                                                   │
│                                                                              │
│          return true;                                                        │
│      }                                                                       │
│                                                                              │
│      /// <summary>                                                           │
│      /// Gets an optimized duration based on current performance.            │
│      /// </summary>                                                          │
│      public TimeSpan GetOptimizedDuration(TimeSpan baseDuration)             │
│      {                                                                       │
│          if (_accessibility?.IsReducedMotionEnabled == true)                 │
│              return TimeSpan.Zero; // Skip animation                         │
│                                                                              │
│          // Scale duration based on frame rate                               │
│          if (_averageFrameTime > TargetFrameTimeMs)                          │
│          {                                                                   │
│              var scale = TargetFrameTimeMs / _averageFrameTime;              │
│              return TimeSpan.FromMilliseconds(                               │
│                  baseDuration.TotalMilliseconds * scale);                    │
│          }                                                                   │
│                                                                              │
│          return baseDuration;                                                │
│      }                                                                       │
│                                                                              │
│      /// <summary>                                                           │
│      /// Determines how many frames to skip for performance.                 │
│      /// </summary>                                                          │
│      public int GetFrameSkip()                                               │
│      {                                                                       │
│          if (_averageFrameTime <= TargetFrameTimeMs)                         │
│              return 0;                                                       │
│                                                                              │
│          // Skip more frames as performance degrades                         │
│          return (int)((_averageFrameTime / TargetFrameTimeMs) - 1);          │
│      }                                                                       │
│                                                                              │
│      /// <summary>                                                           │
│      /// Called each frame to track performance.                             │
│      /// </summary>                                                          │
│      public void TrackFrame()                                                │
│      {                                                                       │
│          var now = DateTime.UtcNow;                                          │
│          var frameTime = (now - _lastFrameTime).TotalMilliseconds;           │
│          _lastFrameTime = now;                                               │
│                                                                              │
│          // Exponential moving average                                       │
│          const double alpha = 0.1;                                           │
│          _averageFrameTime = _averageFrameTime == 0                          │
│              ? frameTime                                                     │
│              : alpha * frameTime + (1 - alpha) * _averageFrameTime;          │
│      }                                                                       │
│                                                                              │
│      /// <summary>                                                           │
│      /// Whether currently in low-power/performance mode.                    │
│      /// </summary>                                                          │
│      public bool IsLowPowerMode => _averageFrameTime > LowPowerThresholdMs;  │
│                                                                              │
│      /// <summary>                                                           │
│      /// Current frames per second estimate.                                 │
│      /// </summary>                                                          │
│      public double CurrentFps => 1000.0 / _averageFrameTime;                 │
│  }                                                                           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 9. Data Model Changes

### 9.1 New Types Summary

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         DATA MODEL CHANGES                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  NEW: ColorBlindMode (Enum - Presentation.Shared)                            │
│  ├── None          = 0                                                       │
│  ├── Protanopia    = 1  (red-weak)                                           │
│  ├── Deuteranopia  = 2  (green-weak)                                         │
│  └── Tritanopia    = 3  (blue-weak)                                          │
│                                                                              │
│  NEW: AnnouncementPriority (Enum - Presentation.Shared)                      │
│  ├── Normal                                                                  │
│  ├── Important                                                               │
│  └── Assertive                                                               │
│                                                                              │
│  NEW: IAccessibilityService (Interface - Presentation.Shared)                │
│  ├── ColorBlindMode : ColorBlindMode { get; set; }                           │
│  ├── IsHighContrastEnabled : bool { get; set; }                              │
│  ├── IsReducedMotionEnabled : bool { get; set; }                             │
│  ├── IsScreenReaderActive : bool { get; }                                    │
│  ├── ShowKeyboardHints : bool { get; set; }                                  │
│  ├── GetAccessibleColor(ThemeColor) : ThemeColor                             │
│  ├── GetAltText(IconKey) : string                                            │
│  ├── GetAltText(string) : string                                             │
│  ├── Announce(string) : void                                                 │
│  ├── Announce(string, AnnouncementPriority) : void                           │
│  └── GetKeyboardShortcut(string) : string?                                   │
│                                                                              │
│  NEW: ColorBlindTransform (Static Class - Presentation.Shared)               │
│  └── Transform(ThemeColor, ColorBlindMode) : ThemeColor                      │
│                                                                              │
│  NEW: AccessibilitySettings (Configuration - Presentation.Shared)            │
│  ├── ColorBlindMode : ColorBlindMode                                         │
│  ├── HighContrastEnabled : bool                                              │
│  ├── ReducedMotionEnabled : bool                                             │
│  ├── ScreenReaderLabelsEnabled : bool                                        │
│  └── ShowKeyboardHints : bool                                                │
│                                                                              │
│  NEW: LazyLoader<T> (Generic Class - Presentation.Shared)                    │
│  ├── CurrentPage : int { get; }                                              │
│  ├── TotalCount : int { get; }                                               │
│  ├── TotalPages : int { get; }                                               │
│  ├── LoadedCount : int { get; }                                              │
│  ├── HasMorePages : bool { get; }                                            │
│  ├── HasPreviousPages : bool { get; }                                        │
│  ├── LoadPage(int) : IEnumerable<T>                                          │
│  ├── LoadNextPage() : IEnumerable<T>                                         │
│  ├── LoadPreviousPage() : IEnumerable<T>                                     │
│  ├── GetItem(int) : T?                                                       │
│  ├── PrefetchAsync(int) : Task                                               │
│  └── InvalidateCache() : void                                                │
│                                                                              │
│  NEW: AnimationOptimizer (Class - Presentation.Shared)                       │
│  ├── IsLowPowerMode : bool { get; }                                          │
│  ├── CurrentFps : double { get; }                                            │
│  ├── ShouldAnimate() : bool                                                  │
│  ├── GetOptimizedDuration(TimeSpan) : TimeSpan                               │
│  ├── GetFrameSkip() : int                                                    │
│  └── TrackFrame() : void                                                     │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 10. Configuration

### 10.1 AccessibilitySettings Configuration

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  AccessibilitySettings (Configuration - Presentation.Shared)                 │
│  ───────────────────────────────────────────────────────                     │
│                                                                              │
│  Location: Presentation.Shared/Configuration/AccessibilitySettings.cs        │
│                                                                              │
│  public class AccessibilitySettings                                          │
│  {                                                                           │
│      /// <summary>Color blind mode for color adjustments.</summary>          │
│      public ColorBlindMode ColorBlindMode { get; set; } = ColorBlindMode.None│
│                                                                              │
│      /// <summary>Whether high contrast mode is enabled.</summary>           │
│      public bool HighContrastEnabled { get; set; } = false;                  │
│                                                                              │
│      /// <summary>Whether to reduce/disable animations.</summary>            │
│      public bool ReducedMotionEnabled { get; set; } = false;                 │
│                                                                              │
│      /// <summary>Whether screen reader labels are enabled.</summary>        │
│      public bool ScreenReaderLabelsEnabled { get; set; } = true;             │
│                                                                              │
│      /// <summary>Whether keyboard shortcut hints are shown.</summary>       │
│      public bool ShowKeyboardHints { get; set; } = true;                     │
│  }                                                                           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 10.2 Settings Persistence

Settings are persisted in `settings.json`:

```json
{
  "Accessibility": {
    "ColorBlindMode": "None",
    "HighContrastEnabled": false,
    "ReducedMotionEnabled": false,
    "ScreenReaderLabelsEnabled": true,
    "ShowKeyboardHints": true
  }
}
```

---

## 11. Commands

### 11.1 Accessibility Settings Commands

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    ACCESSIBILITY COMMANDS                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Command: accessibility                                                      │
│  Aliases: access, a11y                                                       │
│  Description: Configure accessibility settings                               │
│                                                                              │
│  Subcommands:                                                                │
│  ────────────                                                                │
│                                                                              │
│  accessibility colorblind <mode>                                             │
│  ├── Description: Set color blind mode                                       │
│  ├── Modes: none, protanopia, deuteranopia, tritanopia                       │
│  └── Example: accessibility colorblind deuteranopia                          │
│                                                                              │
│  accessibility highcontrast <on|off>                                         │
│  ├── Description: Toggle high contrast mode                                  │
│  └── Example: accessibility highcontrast on                                  │
│                                                                              │
│  accessibility motion <on|off>                                               │
│  ├── Description: Toggle reduced motion mode                                 │
│  └── Example: accessibility motion off                                       │
│                                                                              │
│  accessibility hints <on|off>                                                │
│  ├── Description: Toggle keyboard hint display                               │
│  └── Example: accessibility hints on                                         │
│                                                                              │
│  accessibility status                                                        │
│  ├── Description: Show current accessibility settings                        │
│  └── Example output:                                                         │
│      ┌──────────────────────────────────────┐                               │
│      │ Accessibility Settings               │                               │
│      │ ────────────────────────────         │                               │
│      │ Color Blind Mode: Deuteranopia       │                               │
│      │ High Contrast:    Off                │                               │
│      │ Reduced Motion:   Off                │                               │
│      │ Keyboard Hints:   On                 │                               │
│      └──────────────────────────────────────┘                               │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 12. User-Facing Changes

### 12.1 Visible Changes

| Feature | Description |
|---------|-------------|
| Color Blind Modes | Colors adjusted for protanopia, deuteranopia, tritanopia |
| High Contrast | Enhanced color contrast for visibility |
| Reduced Motion | Animations disabled or shortened |
| Keyboard Hints | Shortcut keys displayed on UI elements |
| Focus Indicators | Visible focus ring on current element |

### 12.2 Accessibility Menu (F1)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    ACCESSIBILITY SETTINGS                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Color Vision                                                                │
│  ─────────────                                                               │
│  [●] Normal                                                                  │
│  [ ] Protanopia (Red-weak)                                                   │
│  [ ] Deuteranopia (Green-weak)                                               │
│  [ ] Tritanopia (Blue-weak)                                                  │
│                                                                              │
│  Visual Options                                                              │
│  ──────────────                                                              │
│  [ ] High Contrast Mode                                                      │
│  [✓] Show Keyboard Shortcuts                                                 │
│                                                                              │
│  Motion                                                                      │
│  ──────                                                                      │
│  [ ] Reduce Motion                                                           │
│                                                                              │
│  ─────────────────────────────────────────                                   │
│  [Apply]  [Cancel]  [Reset to Defaults]                                      │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 13. Logging Specifications

### 13.1 Accessibility Logging

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    ACCESSIBILITY LOGGING                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Setting Change (Information):                                               │
│  Template: "Accessibility setting changed: {Setting} = {Value}"              │
│  Example:  [INF] Accessibility setting changed: ColorBlindMode = Deuteranopia│
│                                                                              │
│  Color Transform (Debug):                                                    │
│  Template: "Color transformed: {Original} -> {Transformed} ({Mode})"         │
│  Example:  [DBG] Color transformed: #FF0000 -> #8B4513 (Protanopia)          │
│                                                                              │
│  Screen Reader (Debug):                                                      │
│  Template: "Screen reader announcement: {Message}"                           │
│  Example:  [DBG] Screen reader announcement: Health at 75%                   │
│                                                                              │
│  Performance (Debug):                                                        │
│  Template: "Animation optimizer: {FPS} FPS, low power = {LowPower}"          │
│  Example:  [DBG] Animation optimizer: 45 FPS, low power = true               │
│                                                                              │
│  Lazy Loading (Debug):                                                       │
│  Template: "LazyLoader: loaded page {Page} ({Count} items)"                  │
│  Example:  [DBG] LazyLoader: loaded page 2 (20 items)                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 14. Unit Testing Requirements

### 14.1 Test Categories

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    UNIT TESTING REQUIREMENTS (~4 tests)                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Category 1: Color Blind Transform Tests (1 test)                            │
│  ────────────────────────────────────────────────                            │
│                                                                              │
│  Test: ColorBlindTransform_AppliesCorrectMatrix                              │
│  ├── Given: Red color (#FF0000)                                              │
│  ├── When: Transform with Protanopia mode                                    │
│  └── Then: Color shifted toward brown/gray range                             │
│                                                                              │
│  Category 2: LazyLoader Tests (1 test)                                       │
│  ──────────────────────────────────────                                      │
│                                                                              │
│  Test: LazyLoader_LoadsAndCachesPages                                        │
│  ├── Given: LazyLoader with page size 20                                     │
│  ├── When: LoadPage(0), LoadPage(1), LoadPage(2), LoadPage(3)                │
│  ├── Then: Cache contains 3 pages (oldest evicted)                           │
│  └── Then: LoadPage(1) returns cached data (no fetch)                        │
│                                                                              │
│  Category 3: AnimationOptimizer Tests (1 test)                               │
│  ─────────────────────────────────────────────                               │
│                                                                              │
│  Test: AnimationOptimizer_RespectsReducedMotion                              │
│  ├── Given: Accessibility with ReducedMotion = true                          │
│  ├── When: ShouldAnimate() called                                            │
│  └── Then: Returns false                                                     │
│                                                                              │
│  Category 4: AccessibilityService Tests (1 test)                             │
│  ───────────────────────────────────────────────                             │
│                                                                              │
│  Test: AccessibilityService_TransformsColors                                 │
│  ├── Given: Service with Deuteranopia mode                                   │
│  ├── When: GetAccessibleColor(green) called                                  │
│  └── Then: Returns color shifted toward yellow                               │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 14.2 Test File Locations

```
Tests/
└── Presentation.Shared.Tests/
    ├── Utilities/
    │   ├── ColorBlindTransformTests.cs
    │   ├── LazyLoaderTests.cs
    │   └── AnimationOptimizerTests.cs
    └── Services/
        └── AccessibilityServiceTests.cs
```

---

## 15. Use Cases

### 15.1 UC-5f-01: Enable Color Blind Mode

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  USE CASE: UC-5f-01 - Enable Color Blind Mode                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Actor: User with color vision deficiency                                    │
│  Goal: Configure game colors for color blindness                             │
│                                                                              │
│  Steps:                                                                      │
│  1. User opens accessibility settings (F1)                                   │
│  2. User selects color blind mode (e.g., Deuteranopia)                       │
│  3. System applies color transformation matrix                               │
│  4. All UI colors update to accessible alternatives                          │
│  5. User can distinguish previously confusing colors                         │
│                                                                              │
│  Postconditions:                                                             │
│  • Colors adjusted throughout UI                                             │
│  • Setting persisted to configuration                                        │
│  • Health bar uses distinguishable colors                                    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 15.2 UC-5f-02: Navigate Achievement List with Lazy Loading

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  USE CASE: UC-5f-02 - Navigate Achievement List                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Actor: User viewing achievements                                            │
│  Goal: Browse large achievement list without lag                             │
│                                                                              │
│  Steps:                                                                      │
│  1. User opens achievement panel                                             │
│  2. System loads first 20 achievements (page 0)                              │
│  3. System prefetches next page in background                                │
│  4. User scrolls down                                                        │
│  5. System displays next page (already prefetched)                           │
│  6. System prefetches page 2                                                 │
│  7. User continues scrolling                                                 │
│                                                                              │
│  Postconditions:                                                             │
│  • Smooth scrolling experience                                               │
│  • Memory usage bounded (3-page cache)                                       │
│  • No visible loading delays                                                 │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 16. Deliverable Checklist

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         DELIVERABLE CHECKLIST                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Enums                                                                       │
│  ─────                                                                       │
│  [ ] ColorBlindMode in Presentation.Shared/Enums/                            │
│  [ ] AnnouncementPriority in Presentation.Shared/Enums/                      │
│                                                                              │
│  Interfaces                                                                  │
│  ──────────                                                                  │
│  [ ] IAccessibilityService in Presentation.Shared/Interfaces/                │
│                                                                              │
│  Services                                                                    │
│  ────────                                                                    │
│  [ ] TuiAccessibilityService in Presentation.Tui/Services/                   │
│  [ ] GuiAccessibilityService in Presentation.Gui/Services/                   │
│                                                                              │
│  Utilities                                                                   │
│  ─────────                                                                   │
│  [ ] ColorBlindTransform in Presentation.Shared/Utilities/                   │
│  [ ] LazyLoader<T> in Presentation.Shared/Utilities/                         │
│  [ ] AnimationOptimizer in Presentation.Shared/Utilities/                    │
│                                                                              │
│  Configuration                                                               │
│  ─────────────                                                               │
│  [ ] AccessibilitySettings in Presentation.Shared/Configuration/             │
│                                                                              │
│  Updated Components (Accessibility)                                          │
│  ──────────────────────────────────                                          │
│  [ ] HealthBarDisplay uses accessible colors                                 │
│  [ ] CombatGridPanel uses accessible colors                                  │
│  [ ] StatusEffectPanel uses accessible colors                                │
│  [ ] HealthBarControl uses accessible colors                                 │
│                                                                              │
│  Updated Components (Lazy Loading)                                           │
│  ─────────────────────────────────                                           │
│  [ ] AchievementPanel uses LazyLoader                                        │
│  [ ] LeaderboardView uses LazyLoader                                         │
│                                                                              │
│  Unit Tests                                                                  │
│  ──────────                                                                  │
│  [ ] ColorBlindTransformTests.cs (~1 test)                                   │
│  [ ] LazyLoaderTests.cs (~1 test)                                            │
│  [ ] AnimationOptimizerTests.cs (~1 test)                                    │
│  [ ] AccessibilityServiceTests.cs (~1 test)                                  │
│                                                                              │
│  Total: ~4 unit tests                                                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 17. Acceptance Criteria

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         ACCEPTANCE CRITERIA                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Color Blind Support                                                         │
│  ───────────────────                                                         │
│  [ ] ColorBlindMode enum with 4 modes (None, Protanopia, Deuteranopia, Trit) │
│  [ ] Color transformation matrices correctly applied                         │
│  [ ] Health bar colors distinguishable in all modes                          │
│  [ ] Status effect colors distinguishable in all modes                       │
│                                                                              │
│  Screen Reader Support                                                       │
│  ─────────────────────                                                       │
│  [ ] IAccessibilityService interface defined                                 │
│  [ ] Alt text mappings for all IconKey values                                │
│  [ ] Announce() method functional                                            │
│                                                                              │
│  Keyboard Navigation                                                         │
│  ───────────────────                                                         │
│  [ ] Tab navigation between panels                                           │
│  [ ] Arrow key navigation within panels                                      │
│  [ ] Visible focus indicators                                                │
│  [ ] Keyboard shortcuts documented and functional                            │
│                                                                              │
│  Lazy Loading                                                                │
│  ────────────                                                                │
│  [ ] LazyLoader<T> loads pages on demand                                     │
│  [ ] Page cache limits memory usage                                          │
│  [ ] Prefetch reduces perceived load time                                    │
│  [ ] AchievementPanel uses lazy loading                                      │
│  [ ] LeaderboardView uses lazy loading                                       │
│                                                                              │
│  Animation Optimization                                                      │
│  ──────────────────────                                                      │
│  [ ] Reduced motion setting disables animations                              │
│  [ ] Frame rate tracking functional                                          │
│  [ ] Animation duration scales with performance                              │
│                                                                              │
│  Settings Persistence                                                        │
│  ────────────────────                                                        │
│  [ ] Accessibility settings persist between sessions                         │
│  [ ] Settings load on application start                                      │
│  [ ] Settings UI updates when changed                                        │
│                                                                              │
│  Testing                                                                     │
│  ───────                                                                     │
│  [ ] ~4 unit tests pass                                                      │
│  [ ] All existing tests continue to pass                                     │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 18. Future Considerations

### 18.1 Additional Accessibility Features

- **Voice Control**: Voice commands for navigation
- **Font Scaling**: Adjustable text sizes
- **Audio Cues**: Sound effects for visual events
- **Tactile Feedback**: Vibration support for controllers

### 18.2 Performance Enhancements

- **Object Pooling**: Reuse UI element instances
- **Virtualization**: Virtual scrolling for very long lists
- **Background Workers**: Off-thread data processing
- **Level of Detail**: Simplified rendering at distance

---

## 19. Implementation Notes

### 19.1 Implementation Order

1. Create ColorBlindMode enum
2. Create ColorBlindTransform utility
3. Create IAccessibilityService interface
4. Implement TuiAccessibilityService
5. Implement GuiAccessibilityService
6. Create LazyLoader<T>
7. Create AnimationOptimizer
8. Create AccessibilitySettings configuration
9. Update components to use accessibility service
10. Add lazy loading to achievement/leaderboard panels
11. Write tests

### 19.2 Platform Considerations

- **TUI**: Console-based screen reader support limited
- **GUI (Avalonia)**: Use AutomationProperties for accessibility
- **Cross-platform**: Color blind transforms work on all platforms

---

## 20. Document Metadata

| Field | Value |
|-------|-------|
| **Document Version** | 1.0 |
| **Created** | 2026-01-16 |
| **Last Updated** | 2026-01-16 |
| **Author** | Claude |
| **Status** | Draft |
| **Related Documents** | v0.13.5-scope-breakdown.md, v0.13.5b-design-specification.md, v0.13.5e-design-specification.md |

### Change History

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 2026-01-16 | Claude | Initial draft |

---

*This design specification provides a comprehensive blueprint for implementing v0.13.5f Accessibility & Performance. The accessibility features ensure inclusive design for users with color vision deficiencies, while the performance optimizations (lazy loading, animation optimization) ensure smooth user experience across all hardware configurations. This completes the v0.13.5 UI Standardization series.*
