## v0.0.8 - Experience & Leveling

**Focus:** Fully customizable progression system with configurable terminology

**Prerequisites:** v0.0.7 Complete (Equipment System)

### Related Documents

#### Scope & Design
- [v0.0.8 Scope Breakdown](v0.0.8-scope-breakdown.md)
- [v0.0.8a Design Specification](v0.0.8a-design-specification.md) - Core Experience System
- [v0.0.8b Design Specification](v0.0.8b-design-specification.md) - Level-Up Mechanics
- [v0.0.8c Design Specification](v0.0.8c-design-specification.md) - Progression Configuration

#### Implementation Plans
- [v0.0.8a Implementation Plan](v0.0.8a-implementation-plan.md) - Core Experience System
- [v0.0.8b Implementation Plan](v0.0.8b-implementation-plan.md) - Level-Up Mechanics
- [v0.0.8c Implementation Plan](v0.0.8c-implementation-plan.md) - Progression Configuration

#### Changelogs
- [v0.0.8a Changelog](../../changelogs/v0.0.8a-changelog.md) - Core Experience System (Complete)
- [v0.0.8b Changelog](../../changelogs/v0.0.8b-changelog.md) - Level-Up Mechanics (Complete)
- [v0.0.8c Changelog](../../changelogs/v0.0.8c-changelog.md) - Progression Configuration (Complete)

### Sub-Phases

| Phase | Name | Focus | Est. Tests |
|-------|------|-------|------------|
| v0.0.8a | Core Experience System | XP tracking, monster XP values, XP display | ~18 |
| v0.0.8b | Level-Up Mechanics | Level thresholds, stat increases, level-up notifications | ~18 |
| v0.0.8c | Progression Configuration | Configurable terminology, progression curves, ability unlocks | ~14 |

---

### Features

#### v0.0.8a: Core Experience System
- [x] **Experience Property** - `Player.Experience` (int, default 0)
- [x] **Add Experience** - `Player.AddExperience(amount)` returns new total
- [x] **XP Progress Display** - `Player.ExperienceToNextLevel` and `ExperienceProgressPercent`
- [x] **Monster XP Values** - `Monster.ExperienceValue` property
- [x] **XP on Combat Victory** - `CombatResult.ExperienceGained` on monster defeat
- [x] **XP Gain Notification** - "★ You gained 25 XP!" after combat
- [x] **Status XP Display** - "XP: 75/200 (37%)" in status output

#### v0.0.8b: Level-Up Mechanics
- [x] **Level-Up Detection** - `ProgressionService.CheckForLevelUp()` based on XP thresholds
- [x] **Stat Increases** - +5 MaxHealth, +1 Attack, +1 Defense per level (configurable in v0.0.8c)
- [x] **Multi-Level Support** - Handle gaining multiple levels from one XP award
- [x] **Heal on Level-Up** - Health restored to new maximum
- [x] **Ability Unlocks** - Integration with `AbilityService.GetUnlockedAbilitiesAtLevel()` from v0.0.4c
- [x] **Level-Up Notification** - Celebratory display with stat changes and unlocked abilities

#### v0.0.8c: Progression Configuration
- [x] **Progression Terminology** - Configurable names for XP ("Glory", "Essence") and Level ("Rank", "Tier")
- [x] **Progression Curves** - JSON-defined level thresholds (linear, exponential, custom)
- [x] **Class-Specific Bonuses** - Different stat increase multipliers per class (via classGrowthRates parameter)
- [x] **Level Rewards** - Per-level custom rewards configuration
- [x] **Max Level Cap** - Configurable maximum level (default 20)

---

### Data Model Updates

#### New Value Objects
| Type | Location | Purpose |
|------|----------|---------|
| `ExperienceGainResult` | Domain/ValueObjects | Result of XP award operation |
| `LevelUpResult` | Domain/ValueObjects | Result of level-up with stat changes and abilities |
| `StatModifiers` | Domain/ValueObjects | Stat modification values (+HP, +ATK, +DEF) |

#### New Services
| Service | Location | Purpose |
|---------|----------|---------|
| `ExperienceService` | Domain/Services | XP calculation and awarding |
| `ProgressionService` | Domain/Services | Level-up detection and application |

#### New DTOs
| DTO | Location | Purpose |
|-----|----------|---------|
| `ExperienceGainDto` | Application/DTOs | XP gain display data |
| `LevelUpDto` | Application/DTOs | Level-up notification display data |

#### Entity Modifications
| Entity | Changes |
|--------|---------|
| `Player` | Add `Experience`, `AddExperience()`, `ExperienceToNextLevel`, `ExperienceProgressPercent`, `ApplyStatModifiers()`, `GetExperienceForLevel()`, `GetLevelForExperience()` |
| `Monster` | Add `ExperienceValue` property, update constructor and factories |
| `CombatResult` | Add `ExperienceGained` property |

---

### Default Values (v0.0.8a/b)

| Setting | Value | Notes |
|---------|-------|-------|
| Starting XP | 0 | All new players start with 0 XP |
| XP Formula | `level * 100` | Level 2 = 200 XP, Level 3 = 300 XP |
| Goblin XP | 25 | XP awarded for defeating a goblin |
| Default Monster XP | 10 | XP for monsters without specific value |
| HP Bonus per Level | +5 | Applied cumulatively |
| Attack Bonus per Level | +1 | Applied cumulatively |
| Defense Bonus per Level | +1 | Applied cumulatively |
| Heal on Level-Up | Yes | Health restored to new maximum |

---

### Commands

| Command | Phase | Description |
|---------|-------|-------------|
| `status` | v0.0.8a | Updated to show XP progress |
| `attack` | v0.0.8a | Updated to award XP on monster defeat |

*No new commands are introduced in v0.0.8. Experience is gained automatically through combat.*

---

### Display Examples

**Status Output (v0.0.8a):**
```
> status

=== Hero (Level 1 Warrior) ===
HP: 100/100
XP: 75/200 (37%)
Attack: 15  Defense: 8
```

**Combat Victory (v0.0.8a):**
```
> attack goblin

You attack the Goblin for 15 damage!
The Goblin has been defeated!

★ You gained 25 XP!
XP: 25/200 (12%)
```

**Level-Up Notification (v0.0.8b):**
```
═══════════════════════════════════════════
           ★ LEVEL UP! ★
═══════════════════════════════════════════
You have reached Level 2!

Stat Increases:
  Max Health: 100 → 105 (+5)
  Attack: 10 → 11 (+1)
  Defense: 5 → 6 (+1)

New Abilities Unlocked:
  • Shield Bash

Next Level: 100 XP needed (Level 3)
═══════════════════════════════════════════
```

---

### Integration Points

| System | Integration |
|--------|-------------|
| v0.0.4c Abilities | `GetUnlockedAbilitiesAtLevel()` for ability unlocks on level-up |
| v0.0.6 Combat | `CombatResult.ExperienceGained` returns monster XP on defeat |
| v0.0.7 Equipment | Equipment stat bonuses remain separate from level-up bonuses |
| Player Stats | `ApplyStatModifiers()` modifies `Stats` on level-up |

---

### Existing Infrastructure (from v0.0.4)

| Feature | Location | Notes |
|---------|----------|-------|
| `Player.Level` | Player.cs | Defaults to 1, has `SetLevel()` method |
| `AbilityDefinition.UnlockLevel` | AbilityDefinition.cs | Abilities define level requirements |
| `GetUnlockedAbilitiesAtLevel()` | AbilityService.cs | Query abilities by level |
| Ability lock validation | AbilityService.cs | Checks player level vs ability unlock level |

---

### Renderer Updates

| Method | Phase | Purpose |
|--------|-------|---------|
| `RenderExperienceGainAsync()` | v0.0.8a | Display XP gain after combat |
| `RenderLevelUpAsync()` | v0.0.8b | Display level-up notification |
| Status display update | v0.0.8a | Include XP in status output |

---

### Test Summary

| Phase | Test Count | Focus Areas |
|-------|------------|-------------|
| v0.0.8a | ~18 | Player XP, Monster XP, ExperienceService, CombatResult |
| v0.0.8b | ~18 | LevelUpResult, StatModifiers, ProgressionService, Player level-up |
| v0.0.8c | ~14 | ProgressionDefinition, config loading, terminology, class overrides |
| **Total** | **~50** | |
