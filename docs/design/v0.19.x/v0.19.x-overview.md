# v0.19.x Feature Overview: Biome System & Realm Implementation

## Executive Summary

v0.19.x implements the **Nine Realms Biome System** — the environmental framework that defines Aethelgard's geography, hazards, and thematic zones. This version replaces placeholder biome implementations with the canonical realm definitions from the Aethelgard design documents, implementing the full biome infrastructure including environmental conditions, faction spawn pools, transition mechanics, and realm-specific hazards.

Each realm represents a distinct deck/tier of the YGGDRASIL Network with unique pre-Glitch functions, post-Glitch catastrophes, and gameplay mechanics.

---

## Version Structure

```
v0.19.x — Biome System & Realm Implementation
├── v0.19.0 — Core Biome Infrastructure (~20 tests)
│   ├── BiomeDefinition entity (9 realms)
│   ├── BiomeZone entity (sub-biomes)
│   ├── EnvironmentalCondition value object
│   ├── BiomeAdjacency rules and matrix
│   └── IBiomeProvider interface
│
├── v0.19.1 — Midgard Implementation (~18 tests)
│   ├── Midgard (Deck 04) — The Tamed Ruin
│   ├── Four sub-biomes (Greatwood, Scar, Mires, Fjords)
│   ├── Territorial hazards
│   └── Agricultural mechanics
│
├── v0.19.2 — Svartalfheim & Helheim (~22 tests)
│   ├── Svartalfheim (Deck 06) — The Dvergr Forges
│   ├── Three zones (Guild-Lands, Black Veins, Glimmering Grottos)
│   ├── Helheim (Deck 08) — The Gangrenous Gut
│   ├── Three strata (Rusting Labyrinth, Chemical Sump, Sunken Sectors)
│   └── Toxic atmosphere mechanics
│
├── v0.19.3 — Muspelheim & Niflheim (~20 tests)
│   ├── Muspelheim (Deck 08) — The Eternal Meltdown
│   ├── Four zones (Slag Wastes, Gjöllflow, Cinder Peaks, Surtr Core)
│   ├── Niflheim (Deck 05) — The Frozen Tomb
│   ├── Three zones (Permafrost Halls, Hvergelmir's Maw, Ice Archives)
│   └── Thermal extremes mechanics
│
├── v0.19.4 — Jötunheim & Vanaheim (~20 tests)
│   ├── Jötunheim (Deck 07) — The Industrial Graveyard
│   ├── Giant-scale terrain and Great Looms
│   ├── Vanaheim (Deck 03) — The Overgrown Laboratory
│   ├── Vertical stratification (Canopy Sea, Gloom-Veil, Under-growth)
│   └── Bio-organic hazards
│
├── v0.19.5 — Alfheim & Asgard (~18 tests)
│   ├── Alfheim (Deck 02) — The Glimmering Wound
│   ├── Reality distortion and Glimmer hazard
│   ├── Asgard (Deck 01) — The Shattered Spire
│   ├── Three zones (Amber Sector, Red Sector, Exclusion Zone)
│   └── Cognitive hazards (Genius Loci, Heimdallr Signal)
│
└── v0.19.6 — Biome Integration & Transitions (~15 tests)
    ├── Cross-biome transition mechanics
    ├── Environmental property interpolation
    ├── Multi-biome sector generation
    └── Route classification system
```

---

## Design Philosophy

### The Nine Realms as World-Machine Decks

| Realm | Deck | Pre-Glitch Function | Post-Glitch State | Theme |
|-------|------|---------------------|-------------------|-------|
| **Asgard** | 01 | Primary Administration | Shattered Spire | Cognitive hazard |
| **Alfheim** | 02 | Aetheric Research | Glimmering Wound | Reality distortion |
| **Vanaheim** | 03 | Bio-Engineering | Overgrown Laboratory | Mutagenic flora |
| **Midgard** | 04 | Civilian Habitation | Tamed Ruin | Agricultural heartland |
| **Niflheim** | 05 | Cryogenic Preservation | Frozen Tomb | Thermal collapse |
| **Svartalfheim** | 06 | Manufacturing | Dvergr Forges | Industrial darkness |
| **Jötunheim** | 07 | Heavy Industry | Industrial Graveyard | Giant-scale decay |
| **Helheim** | 08 | Waste Reclamation | Gangrenous Gut | Toxic cascade |
| **Muspelheim** | 08* | Power Generation | Eternal Meltdown | Thermal catastrophe |

*Note: Muspelheim and Helheim share Deck 08 designation in some sources; they represent complementary functions (power vs. waste).

### Core Design Principles

1. **Technology, Not Magic**: All biomes are engineered environments with scientific explanations
2. **Function Defines Form**: Pre-Glitch purpose dictates post-Glitch catastrophe
3. **Environmental Storytelling**: Biomes communicate narrative through mechanics
4. **Vertical Hierarchy**: Z-levels correlate with danger and discovery
5. **Transition Logic**: Biomes blend at boundaries, following adjacency rules

---

## Realm Summary

### Surface Realm

| Realm | Verticality | Population | Primary Hazard |
|-------|-------------|------------|----------------|
| **Midgard** | Z=0 to Z=+1 | Large (10,000+) | Territorial fauna, Blight zones |

### Upper Realms

| Realm | Verticality | Population | Primary Hazard |
|-------|-------------|------------|----------------|
| **Asgard** | Z=+3+ (Orbital) | Zero | Genius Loci, Heimdallr Signal |
| **Alfheim** | Z=+1 to Z=+3 | Sparse | Reality distortion, Glimmer |
| **Vanaheim** | Z=-1 to Z=+2 | Small | Mutagenic spores, Golden Plague |

### Middle Realms

| Realm | Verticality | Population | Primary Hazard |
|-------|-------------|------------|----------------|
| **Niflheim** | Z=-1 to Z=+1 | Sparse | Extreme cold, Ice-Debt |
| **Svartalfheim** | Z=-1 to Z=-2 | Medium | Absolute darkness, Cave-Ins |
| **Jötunheim** | Z=-2 to Z=+2 | Small | Giant-scale hazards, Constructs |

### Deep Realms

| Realm | Verticality | Population | Primary Hazard |
|-------|-------------|------------|----------------|
| **Muspelheim** | Z=-2 to Z=-3 | Small | Extreme heat, Surtr AI |
| **Helheim** | Z=-3 to Z=-4 | Sparse | Toxic atmosphere, Structural entropy |

---

## Environmental Mechanics Overview

### Ambient Conditions by Realm

| Realm | Condition | Mechanic |
|-------|-----------|----------|
| **Midgard** | None (temperate) | Territorial encounters |
| **Muspelheim** | [Intense Heat] | STURDINESS DC 12, 2d6 Fire/turn |
| **Niflheim** | [Extreme Cold] | STURDINESS DC 12, 2d6 Cold/turn |
| **Helheim** | [Toxic Atmosphere] | Full environmental seal required |
| **Vanaheim** | [Mutagenic Spores] | Corruption accumulation |
| **Alfheim** | [Reality Flux] | Stress accumulation, navigation hazard |
| **Asgard** | [CPS Exposure] | Cumulative cognitive degradation |
| **Svartalfheim** | [Total Darkness] | Light dependency |
| **Jötunheim** | [Giant Scale] | Increased fall damage, traversal checks |

### Zone Modifiers (Example: Muspelheim)

| Zone | DC Modifier | Damage |
|------|-------------|--------|
| Hearth Interior | -6 (DC 6) | 1d6 |
| Hearth Perimeter | Base (DC 12) | 2d6 |
| Slag Wastes | +2 (DC 14) | 2d8 |
| Gjöllflow Proximity | +4 (DC 16) | 3d6 |
| Forge Core Approach | +8 (DC 20) | 4d6 |

---

## Biome Adjacency Matrix

```
                          ADJACENCY MATRIX (9 Realms)

           Midgard  Vanaheim  Alfheim  Asgard  Niflheim  Muspelheim  Jötunheim  Svartalfheim  Helheim
Midgard       —      Compat   Trans    Via-Scar  Trans      Trans      Trans      Trans        N/A
Vanaheim   Compat      —      Trans    N/A       Trans    ❌INCOMPAT   Trans      Trans       Trans
Alfheim    Trans    Trans       —      Trans     Trans      Trans      Trans      Trans        N/A
Asgard    Via-Scar   N/A     Trans       —       N/A        N/A        N/A        N/A          N/A
Niflheim   Trans    Trans    Trans     N/A         —      ❌INCOMPAT   Trans      Trans       Trans
Muspelheim Trans  ❌INCOMPAT  Trans     N/A    ❌INCOMPAT      —        Trans      Compat      Compat
Jötunheim  Trans    Trans    Trans     N/A       Trans      Trans        —        Trans       Trans
Svartalfheim Trans  Trans    Trans     N/A       Trans      Compat     Trans        —         Compat
Helheim     N/A     Trans     N/A      N/A       Trans      Compat     Trans      Compat        —

Legend: Compat = Compatible, Trans = Requires Transition, ❌INCOMPAT = Cannot neighbor
        N/A = No logical connection exists
```

### Critical Incompatibilities

- **Muspelheim ↔ Niflheim**: Fire and Ice cannot directly neighbor
- **Muspelheim ↔ Vanaheim**: Fire destroys bio-organic growth catastrophically

---

## Faction Spawn Pools by Realm

| Realm | Primary (60%) | Secondary (30%) | Rare (10%) |
|-------|---------------|-----------------|------------|
| **Midgard** | Blighted Beasts | Humanoid | Forlorn (Scar) |
| **Muspelheim** | Fire-Forged | Corrupted Machinery | Forlorn |
| **Niflheim** | Frost-Touched | Corrupted Machinery | Forlorn |
| **Helheim** | Acid-Adapted | Corrupted Machinery | Hel-Walkers |
| **Vanaheim** | Weaponized Flora | Blighted Beasts | The Unraveled |
| **Alfheim** | Aetheric Anomalies | Forlorn | Temporal |
| **Asgard** | Undying | Forlorn | Data-Wraith |
| **Svartalfheim** | Corrupted Automata | Blighted Beasts | Silent Folk |
| **Jötunheim** | Ancient Constructs | Corrupted Machinery | Forlorn |

---

## Test Summary

| Version | Scope | Tests |
|---------|-------|-------|
| v0.19.0 | Core Biome Infrastructure | ~20 |
| v0.19.1 | Midgard Implementation | ~18 |
| v0.19.2 | Svartalfheim & Helheim | ~22 |
| v0.19.3 | Muspelheim & Niflheim | ~20 |
| v0.19.4 | Jötunheim & Vanaheim | ~20 |
| v0.19.5 | Alfheim & Asgard | ~18 |
| v0.19.6 | Biome Integration | ~15 |
| **Total** | | **~133** |

---

## Dependencies

### Required From Previous Versions

| Dependency | Source | Required For |
|------------|--------|--------------|
| StatusEffectService | v0.10.x | Environmental conditions |
| StressService | v0.18.0 | CPS hazard effects |
| CorruptionService | v0.18.1 | Mutagenic exposure |
| CpsService | v0.18.2 | Cognitive hazard zones |
| CharacterState | v0.5.x | Environmental damage application |
| ZoneDefinition | v0.10.x | Biome zone templates |

### Provides To Future Versions

| Provides | Consumer |
|----------|----------|
| BiomeDefinition | Room generation, encounter spawning |
| BiomeZone | Dungeon sector theming |
| EnvironmentalCondition | Combat hazards |
| BiomeAdjacency | Sector layout validation |
| RealmNavigation | Travel time calculations |

---

## Key Design Artifacts

### Source Documentation (Aethelgard Design)

| Realm | Source Document |
|-------|-----------------|
| Midgard | `docs/design/aethelgard/design/07-environment/biomes/midgard.md` |
| Vanaheim | `docs/design/aethelgard/design/07-environment/biomes/vanaheim.md` |
| Alfheim | `docs/design/aethelgard/design/07-environment/biomes/alfheim.md` |
| Asgard | `docs/design/aethelgard/design/07-environment/biomes/asgard.md` |
| Niflheim | `docs/design/aethelgard/design/07-environment/biomes/niflheim.md` |
| Muspelheim | `docs/design/aethelgard/design/07-environment/biomes/muspelheim.md` |
| Svartalfheim | `docs/design/aethelgard/design/07-environment/biomes/svartalfheim.md` |
| Jötunheim | `docs/design/aethelgard/design/07-environment/biomes/jotunheim.md` |
| Helheim | `docs/design/aethelgard/design/resources/01-geography/07-helheim.md` |

### Biome System Overview

| Document | Purpose |
|----------|---------|
| `biomes-overview.md` | Transition mechanics, adjacency matrix |

---

## Realm Quick Reference

### Midgard — The Tamed Ruin (Deck 04)

> *"The Wall is the soul of the Hold."*

Agricultural heartland, most populous realm. Four sub-biomes: Greatwood (feral forest), Asgardian Scar (Blight epicenter), Souring Mires (toxic wetland), Serpent Fjords (poisoned coast).

### Svartalfheim — The Dvergr Forges (Deck 06)

> *"We do not fear the dark. We are the dark."*

Subterranean manufacturing realm. Light-stratified zones: Guild-Lands (patrolled), Black Veins (absolute darkness), Glimmering Grottos (Blight-glow hazard).

### Helheim — The Gangrenous Gut (Deck 08)

> *"The kidney of Aethelgard learned to vomit."*

Toxic catastrophe biome. Three vertical strata: Rusting Labyrinth, Chemical Sump, Sunken Sectors. Source of world-wide contamination via Hvergelmir Anomaly.

### Muspelheim — The Eternal Meltdown (Deck 08)

> *"The fire does not hate you. It simply cannot stop burning."*

Geothermal catastrophe biome. Four zones: Slag Wastes, Gjöllflow Rivers, Cinder Peaks, Surtr Core (AI death zone).

### Niflheim — The Frozen Tomb (Deck 05)

> *"The cold preserves everything. Even madness."*

Cryogenic preservation failure. Contains Einherjar Archive (frozen soldiers), Hvergelmir's Maw (thermal drain), Ice-Debt hazard.

### Jötunheim — The Industrial Graveyard (Deck 07)

> *"Built for giants. Abandoned by all."*

Heavy industrial ruins. Giant-scale architecture, Great Looms (manufacturing), Rust-Clans salvage operations.

### Vanaheim — The Overgrown Laboratory (Deck 03)

> *"The garden that tends itself—and anything that enters it."*

Bio-engineering gone feral. Vertical stratification: Canopy Sea (survivable), Gloom-Veil (transitional), Under-growth (extreme hazard). Golden Plague mutagenic spores.

### Alfheim — The Glimmering Wound (Deck 02)

> *"Reality is a suggestion in Alfheim."*

Aetheric research catastrophe. Reality distortion, Glimmer cognitive hazard, temporal pockets, Ljósálfar (Light Elves) survivors.

### Asgard — The Shattered Spire (Deck 01)

> *"The tomb does not know its occupant is dead."*

Orbital command structure in degraded orbit. Perfect preservation as threat. Genius Loci (fragmented O.D.I.N. AI), Heimdallr Signal (Type Omega CPS death zone).

---

## Implementation Priority

| Priority | Version | Rationale |
|----------|---------|-----------|
| 1 | v0.19.0 | Core infrastructure required by all realms |
| 2 | v0.19.1 | Midgard is starting area and most common |
| 3 | v0.19.2 | Svartalfheim is early-game trading hub; Helheim completes Deck 08 |
| 4 | v0.19.3 | Thermal extremes (Muspelheim/Niflheim) complete core dungeon biomes |
| 5 | v0.19.4 | Jötunheim/Vanaheim add mid-game variety |
| 6 | v0.19.5 | Alfheim/Asgard are endgame content |
| 7 | v0.19.6 | Integration ensures seamless biome transitions |

---

## Acceptance Criteria (v0.19.x Complete)

- [ ] All 9 realms have BiomeDefinition entities with complete properties
- [ ] Environmental conditions apply appropriate damage/effects per realm
- [ ] Faction spawn pools generate correct enemy types per biome
- [ ] Biome adjacency rules prevent invalid zone combinations
- [ ] Transition mechanics interpolate properties correctly
- [ ] Room templates load from realm-appropriate pools
- [ ] Navigation routes respect realm connections
- [ ] ~133 unit tests pass
- [ ] No placeholder biome data remains in system
