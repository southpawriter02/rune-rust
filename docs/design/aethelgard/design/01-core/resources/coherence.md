---
id: SPEC-CORE-RES-COHERENCE
title: "Coherence — Skald/Thul Resource Specification"
version: 1.0
status: draft
last-updated: 2025-12-07
related-files:
  - path: "RuneAndRust.Engine/Services/CoherenceService.cs"
    status: Planned
---

# Coherence — Narrative Power System

> *"Coherence is the power of story—the ability to impose meaning on chaos, to make reality conform to narrative. The Skald speaks, and the world listens."*

---

## Document Control

| Version | Date | Changes |
|---------|------|---------|
| 1.0 | 2025-12-07 | Initial specification |

---

## 1. Overview

### 1.1 Identity Table

| Property | Value |
|----------|-------|
| Spec ID | `SPEC-CORE-RES-COHERENCE` |
| Category | Specialization Resource |
| Parent Spec | `SPEC-CORE-RESOURCES` |
| Availability | **Skald, Thul specializations** |
| Primary Attribute | WILL |
| Range | 0-100 |

### 1.2 Core Philosophy

Coherence represents the power of **narrative and language** to impose order on reality. Skalds and Thuls use words—sagas, poems, diagnostic incantations—to literally rewrite local reality.

**Key Properties:**
- **Builds from Performance**: Generated by successful skill checks
- **Powers Narrative Abilities**: Buffs, debuffs, reality alterations
- **Represents Story Weight**: How much narrative authority character holds
- **Anti-Corruption**: High Coherence protects against Runic Blight effects

---

## 2. Coherence Mechanics

### 2.1 Coherence Range

| Value | State | Description |
|-------|-------|-------------|
| 0 | Silent | No narrative power |
| 1-24 | Whispering | Minor buffs available |
| 25-49 | Speaking | Standard saga powers |
| 50-74 | Declaiming | Powerful declarations |
| 75-99 | Proclaiming | Reality-bending speech |
| 100 | **Apotheosis** | Ultimate narrative control |

### 2.2 Coherence Generation

| Source | Coherence Gained |
|--------|------------------|
| Successful Rhetoric check | +10 |
| Tell inspiring tale (ability) | +15 |
| Ally succeeds dramatically | +10 |
| Identify enemy weakness | +5 |
| Party survives dire situation | +20 |

### 2.3 Coherence Decay

| Context | Decay Rate |
|---------|------------|
| In combat (passive) | −5 per turn |
| ally falls unconscious | −15 |
| Failed Rhetoric check | −10 |
| Witness corruption event | −20 |

---

## 3. Coherence Effects

### 3.1 Passive Bonuses

| Coherence | Party Buff |
|-----------|------------|
| 25+ | +1 to all party Stress resistance |
| 50+ | +2 to party Stress resistance |
| 75+ | Party immune to Fear effects |
| 100 | Anti-Corruption aura |

### 3.2 Coherence Abilities

| Ability | Coherence Cost | Effect |
|---------|----------------|--------|
| Inspiring Verse | -15 | +1 die to ally's next roll |
| Saga of Courage | -25 | Party heals 10 Stress |
| Declaration of Truth | -40 | Reveal all enemy stats |
| Rewrite Fate | -60 | Reroll any die (ally or enemy) |
| Apotheosis: Saga of Einherjar | -100 | Party gains legendary buffs |

---

## 4. Technical Implementation

### 4.1 Coherence Service

```csharp
public interface ICoherenceService
{
    int GetCurrentCoherence(Character character);
    void GainCoherence(Character character, int amount, CoherenceSource source);
    void SpendCoherence(Character character, int cost);
    void DecayCoherence(Character character, CoherenceDecayReason reason);
    CoherenceThreshold GetThreshold(Character character);
    void ApplyPassiveBonuses(Party party, Character narrator);
}

public enum CoherenceSource { Rhetoric, Tale, AllySuccess, Analysis, Survival }
public enum CoherenceDecayReason { PassiveDecay, AllyDown, FailedRhetoric, CorruptEvent }
```

---

## 5. Phased Implementation Guide

### Phase 1: Core Logic
- [ ] **Data**: Update `Character` model to track `CurrentCoherence`.
- [ ] **Service**: Implement `GainCoherence` (cap 100) and `DecayCoherence` (floor 0).
- [ ] **Pasives**: Implement global `ApplyPassiveBonuses` logic for whole party.

### Phase 2: Combat Integration
- [ ] **Decay Loop**: Hook start of turn to Decay (-5 in combat).
- [ ] **Events**: Hook `OnAllyDown` and `OnSkillCheck` to Gain/Decay logic.
- [ ] **Abilities**: Implement Coherence costs for specific abilities.

### Phase 3: Narrative Effects
- [ ] **Stress**: Hook Coherence level to Party Stress Resistance.
- [ ] **Fear**: Implement Fear Immunity at 75+.
- [ ] **Apotheosis**: Implement the "Apotheosis" state triggers.

### Phase 4: UI & Feedback
- [ ] **HUD**: Display Coherence Gauge (Gold/Scroll).
- [ ] **Feedback**: "STORY GROWS!" text on gain.
- [ ] **Aura**: Visual indicator for range of passive buffs.

---

## 6. Testing Requirements

### 6.1 Unit Tests
- [ ] **Gain/Loss**: Verify math is correct.
- [ ] **Decay**: Verify -5 per turn in combat.
- [ ] **Bonuses**: Verify Stress Resist increases at 25/50.
- [ ] **Immunity**: Verify Fear Immunity at 75.

### 6.2 Integration Tests
- [ ] **Combat**: Ally drops -> Coherence drops -15.
- [ ] **Skill**: Fail Rhetoric -> Coherence drops -10.
- [ ] **Buff**: Stress Check -> Verify bonus from Coherence applied.

### 6.3 Manual QA
- [ ] **UI**: Verify gauge fills and emits particles at thresholds.
- [ ] **Apotheosis**: Reach 100 -> Verify legendary buffs applied.

---

## 7. Logging Requirements

**Reference:** [logging.md](../logging.md)

### 7.1 Log Events

| Event | Level | Message Template | Properties |
|-------|-------|------------------|------------|
| Coherence Gain | Info | "{Character} built {Amount} Coherence ({Source}). Total: {Total}" | `Character`, `Amount`, `Source`, `Total` |
| Coherence Decay | Info | "{Character} lost {Amount} Coherence ({Reason}). Total: {Total}" | `Character`, `Amount`, `Reason`, `Total` |
| Apotheosis | Warning | "{Character} reached APOTHEOSIS! Reality bends." | `Character` |

---

## 8. Related Specifications

| Spec ID | Relationship |
|---------|--------------|
| `SPEC-CORE-RESOURCES` | Parent overview spec |
| `SPEC-SPEC-SKALD` | Skald specialization |
| `SPEC-SPEC-THUL` | Thul specialization |
| `SPEC-CORE-ATTR-WILL` | Primary attribute |
