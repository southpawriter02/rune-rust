# v0.15.4a Design Specification: Lockpicking System

**Version:** 0.15.4a
**Theme:** Lockpicking System
**Author:** Claude
**Created:** 2026-01-17
**Status:** Draft
**Prerequisites:** v0.15.0 Complete (Dice Pool Refactor), v0.15.1 Complete (Skill Infrastructure)

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
   - 3.1 [Lockpicking Flow](#31-lockpicking-flow)
   - 3.2 [Fumble Consequence Flow](#32-fumble-consequence-flow)
   - 3.3 [Service Interaction Diagram](#33-service-interaction-diagram)
   - 3.4 [Layer Architecture](#34-layer-architecture)
4. [LockType Enum](#4-locktype-enum)
5. [LockContext Value Object](#5-lockcontext-value-object)
6. [ToolQuality Enum](#6-toolquality-enum)
7. [LockpickingResult Value Object](#7-lockpickingresult-value-object)
8. [LockpickingService](#8-lockpickingservice-implementation)
9. [Salvageable Components](#9-salvageable-components)
10. [Data Model Changes](#10-data-model-changes)
11. [Configuration Files](#11-configuration-files)
    - 11.1 [lock-types.json](#111-lock-typesjson)
    - 11.2 [lockpicking-tools.json](#112-lockpicking-toolsjson)
    - 11.3 [lock-types.schema.json](#113-lock-typesschemajson)
    - 11.4 [lockpicking-tools.schema.json](#114-lockpicking-toolsschemajson)
    - 11.5 [Configuration Schema Summary](#115-configuration-schema-summary)
12. [Logging Specifications](#12-logging-specifications)
13. [Unit Testing Requirements](#13-unit-testing-requirements)
14. [Use Cases](#14-use-cases)
15. [Deliverable Checklist](#15-deliverable-checklist)
16. [Acceptance Criteria](#16-acceptance-criteria)
17. [Dependencies](#17-dependencies)
18. [Future Considerations](#18-future-considerations)
19. [Document Metadata](#19-document-metadata)

---

## 1. Executive Summary

### 1.1 Purpose

This document provides a comprehensive design specification for v0.15.4a, the Lockpicking System. This phase implements the core lockpicking mechanics for the System Bypass skill, establishing the foundational patterns for all bypass subsystems (terminal hacking, trap disarmament, jury-rigging).

Lockpicking in Aethelgard reflects the "cargo cult" approach to Old World technology—characters manipulate incomprehensible mechanisms through pattern recognition and learned rituals rather than true understanding. The system supports:

1. **Lock Classification**: Six lock types from Improvised Latch (DC 6) to Jötun-Forged (DC 26)
2. **Tool Requirements**: DC 4+ locks require [Tinker's Toolkit]; tool quality affects dice pool
3. **Corruption Modifiers**: [Glitched] (+2 DC) and [Blighted] (+4 DC) locks
4. **Fumble Consequences**: [Mechanism Jammed] permanently increases DC and renders keys useless
5. **Critical Salvage**: Critical successes yield valuable components from the lock

### 1.2 Key Deliverables

| Category | Items |
|----------|-------|
| **Enums** | `LockType`, `ToolQuality` |
| **Value Objects** | `LockContext`, `LockpickingResult`, `SalvageableComponent` |
| **Services** | `ILockpickingService`, `LockpickingService` |
| **Configuration** | `lock-types.json`, `lockpicking-tools.json` |
| **Tests** | ~4 new unit tests |

### 1.3 Architectural Significance

This version establishes the **procedural bypass pattern** that will be reused throughout v0.15.4:

- **Context-driven checks**: `LockContext` follows the `SkillContext` pattern from v0.15.1a
- **Tool dependency**: Equipment requirements and quality modifiers
- **Fumble consequences**: Skill-specific `FumbleType` for [Mechanism Jammed]
- **Critical salvage**: Component recovery on critical success

---

## 2. Feature Overview

```
v0.15.4a Lockpicking System
├── Lock Classification
│   ├── LockType enum (6 types with base DCs)
│   ├── Corruption modifiers (Glitched +2, Blighted +4)
│   └── Previous attempt tracking (DC escalation)
├── Tool System
│   ├── ToolQuality enum (4 quality levels)
│   ├── Tool requirements (DC 4+ needs toolkit)
│   └── Dice pool modifiers (-2d10 to +2d10)
├── Lockpicking Check
│   ├── LockContext value object
│   ├── LockpickingService (check execution)
│   └── Integration with SkillCheckService
├── Outcomes
│   ├── Success (lock opens)
│   ├── Critical Success (lock opens + salvage)
│   ├── Failure (lock remains, may retry)
│   └── Fumble ([Mechanism Jammed])
└── Salvage System
    ├── SalvageableComponent value object
    ├── Component tables by lock type
    └── Integration with inventory
```

---

## 3. Architecture Diagrams

### 3.1 Lockpicking Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         LOCKPICKING ATTEMPT FLOW                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Player: "pick lock" on locked container                                    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    1. VALIDATE PREREQUISITES                         │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Lock DC ≥ 4?  ──Yes──▶  Has [Tinker's Toolkit]?                    │    │
│  │                               │                                      │    │
│  │                          No   │   Yes                                │    │
│  │                          ▼    │                                      │    │
│  │                    REJECT:    │                                      │    │
│  │                    "You need  ▼                                      │    │
│  │                    proper     CONTINUE                               │    │
│  │                    tools"                                            │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    2. BUILD LOCK CONTEXT                             │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  LockContext                                                         │    │
│  │  ├── LockType: StandardLock (base DC 14)                            │    │
│  │  ├── CorruptionLevel: Glitched (+2 DC)                              │    │
│  │  ├── ToolQuality: Proper (+1d10)                                    │    │
│  │  ├── PreviousAttempts: 0                                            │    │
│  │  └── IsJammed: false                                                 │    │
│  │                                                                      │    │
│  │  Effective DC: 14 + 2 = 16                                           │    │
│  │  Dice Modifier: +1d10 (proper tools)                                 │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    3. PERFORM SKILL CHECK                            │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  SkillCheckService.PerformCheck(                                    │    │
│  │      player,                                                         │    │
│  │      skillId: "lockpicking",                                        │    │
│  │      context: buildSkillContext(lockContext)                        │    │
│  │  )                                                                   │    │
│  │                                                                      │    │
│  │  Base Pool: 3d10 (attribute + skill rank)                           │    │
│  │  Context: +1d10 (tools)                                              │    │
│  │  Final Pool: 4d10                                                    │    │
│  │                                                                      │    │
│  │  Roll: 4d10 → [3, 8, 9, 10]                                         │    │
│  │  Successes: 3 (8, 9, 10)                                             │    │
│  │  Botches: 0                                                          │    │
│  │  Net Successes: 3                                                    │    │
│  │  DC: 2 (16 → success-counting DC)                                    │    │
│  │  Margin: +1                                                          │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    4. DETERMINE OUTCOME                              │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  ┌─────────────┬──────────────────────────────────────────────────┐ │    │
│  │  │ Outcome     │ Condition                                        │ │    │
│  │  ├─────────────┼──────────────────────────────────────────────────┤ │    │
│  │  │ FUMBLE      │ 0 successes AND ≥1 botch                        │ │    │
│  │  │ FAILURE     │ Net successes < DC                               │ │    │
│  │  │ SUCCESS     │ Net successes ≥ DC                               │ │    │
│  │  │ CRITICAL    │ Net successes ≥ 5                                │ │    │
│  │  └─────────────┴──────────────────────────────────────────────────┘ │    │
│  │                                                                      │    │
│  │  This check: Net 3 ≥ DC 2 → SUCCESS (FullSuccess)                   │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    5. APPLY OUTCOME EFFECTS                          │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  SUCCESS:                                                            │    │
│  │  ├── Lock.Unlock()                                                  │    │
│  │  ├── Log event: "Lock bypassed"                                     │    │
│  │  └── Display: "With deft movements, the lock clicks open."          │    │
│  │                                                                      │    │
│  │  CRITICAL SUCCESS (if applicable):                                  │    │
│  │  ├── Lock.Unlock()                                                  │    │
│  │  ├── SalvageComponent() → [High-Tension Spring]                     │    │
│  │  ├── Log event: "Lock bypassed with salvage"                        │    │
│  │  └── Display: "The lock yields easily. You salvage a component."    │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 Fumble Consequence Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    [MECHANISM JAMMED] FUMBLE CONSEQUENCE                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  FUMBLE DETECTED: 0 successes, 1 botch                                      │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    CREATE FUMBLE CONSEQUENCE                         │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  FumbleConsequence                                                  │    │
│  │  ├── ConsequenceId: "fc-lock-001"                                   │    │
│  │  ├── CharacterId: "player-1"                                        │    │
│  │  ├── SkillId: "lockpicking"                                         │    │
│  │  ├── ConsequenceType: MechanismJammed                               │    │
│  │  ├── TargetId: "lock-chest-room-3"                                  │    │
│  │  ├── IsActive: true                                                 │    │
│  │  ├── Duration: Permanent (for this lock)                            │    │
│  │  └── Effects:                                                        │    │
│  │      ├── Lock DC permanently +2                                     │    │
│  │      └── Associated key rendered useless                            │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    UPDATE LOCK STATE                                 │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  lockContext.MarkAsJammed()                                         │    │
│  │                                                                      │    │
│  │  Before: StandardLock (DC 14)                                       │    │
│  │  After:  StandardLock (DC 14 + 2 = 16), IsJammed: true              │    │
│  │                                                                      │    │
│  │  Key "chest-key-room-3" marked as incompatible                      │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    DISPLAY NARRATIVE                                 │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  "Your pick catches on an internal mechanism and snaps. The lock    │    │
│  │   shudders, emitting a grinding sound as something inside jams.     │    │
│  │   The mechanism is now harder to manipulate, and any key that       │    │
│  │   once fit will no longer work."                                    │    │
│  │                                                                      │    │
│  │   [Mechanism Jammed - Lock DC permanently increased by 2]           │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  RECOVERY OPTIONS:                                                          │
│  ├── Find alternate entry route                                            │
│  ├── Use specialized bypass tools (rare)                                   │
│  └── Force the container open (may damage contents)                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Service Interaction Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      SERVICE INTERACTION DIAGRAM                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                      COMMAND HANDLER                                 │   │
│   │               (LockpickingCommandHandler)                           │   │
│   └─────────────────────────────────┬───────────────────────────────────┘   │
│                                     │                                        │
│                           validates & builds context                        │
│                                     │                                        │
│                                     ▼                                        │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                    LOCKPICKING SERVICE                               │   │
│   │                     (ILockpickingService)                           │   │
│   ├─────────────────────────────────────────────────────────────────────┤   │
│   │  + AttemptLockpick(player, lockContext)                             │   │
│   │  + CanAttempt(player, lockContext)                                  │   │
│   │  + GetAttemptBlockedReason(player, lockContext)                     │   │
│   │  + GetPossibleSalvage(lockType)                                     │   │
│   └──────────┬──────────────────────────┬───────────────────────────────┘   │
│              │                          │                                    │
│    performs check              creates consequence                          │
│              │                          │                                    │
│              ▼                          ▼                                    │
│   ┌─────────────────────────┐  ┌─────────────────────────┐                  │
│   │   SKILL CHECK SERVICE   │  │ FUMBLE CONSEQUENCE SVC  │                  │
│   │   (ISkillCheckService)  │  │ (IFumbleConsequenceSvc) │                  │
│   ├─────────────────────────┤  ├─────────────────────────┤                  │
│   │ + PerformCheckWithDC()  │  │ + CreateConsequence()   │                  │
│   │ + CalculateDicePool()   │  │ + HasActiveConsequence()│                  │
│   └──────────┬──────────────┘  └─────────────────────────┘                  │
│              │                                                               │
│       rolls dice                                                            │
│              │                                                               │
│              ▼                                                               │
│   ┌─────────────────────────┐                                               │
│   │     DICE SERVICE        │                                               │
│   │     (IDiceService)      │                                               │
│   ├─────────────────────────┤                                               │
│   │ + RollPool(count)       │                                               │
│   │ + CountSuccesses()      │                                               │
│   └─────────────────────────┘                                               │
│                                                                              │
│   Data Flow:                                                                │
│   ─────────────────────────────────────────────────────────────────────    │
│   1. CommandHandler validates prerequisites & creates LockContext           │
│   2. LockpickingService.AttemptLockpick() orchestrates the attempt          │
│   3. LockContext.ToSkillContext() converts lock-specific context            │
│   4. SkillCheckService executes the check via DiceService                   │
│   5. On fumble: FumbleConsequenceService creates MechanismJammed            │
│   6. On critical: Random salvage component selected from lock type table    │
│   7. LockpickingResult returned with all outcome details                    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 Layer Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           LAYER ARCHITECTURE                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                      DOMAIN LAYER                                    │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Enums/                                                              │    │
│  │  ├── LockType.cs             ←── NEW (lock classification)          │    │
│  │  └── ToolQuality.cs          ←── NEW (tool quality levels)          │    │
│  │                                                                      │    │
│  │  ValueObjects/                                                       │    │
│  │  ├── LockContext.cs          ←── NEW (lock-specific context)        │    │
│  │  ├── LockpickingResult.cs    ←── NEW (attempt result)               │    │
│  │  └── SalvageableComponent.cs ←── NEW (component from critical)      │    │
│  │                                                                      │    │
│  │  Interfaces/                                                         │    │
│  │  └── ILockpickingService.cs  ←── NEW (service interface)            │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                  │                                           │
│                                  │ implements                                │
│                                  ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    APPLICATION LAYER                                 │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Services/                                                           │    │
│  │  └── LockpickingService.cs   ←── NEW (lockpicking mechanics)        │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                  │                                           │
│                                  │ uses                                      │
│                                  ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                  EXISTING DEPENDENCIES                               │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  From v0.15.0:                                                       │    │
│  │  ├── DiceRollResult          (success counting)                     │    │
│  │  ├── DiceService             (dice rolling)                         │    │
│  │  └── DiceConstants           (thresholds)                           │    │
│  │                                                                      │    │
│  │  From v0.15.1:                                                       │    │
│  │  ├── SkillContext            (modifier aggregation)                 │    │
│  │  ├── SkillContextBuilder     (context construction)                 │    │
│  │  ├── EquipmentModifier       (tool bonuses)                         │    │
│  │  ├── SkillCheckService       (check execution)                      │    │
│  │  ├── FumbleConsequence       (fumble tracking)                      │    │
│  │  └── FumbleConsequenceService (consequence management)              │    │
│  │                                                                      │    │
│  │  From v0.10.x:                                                       │    │
│  │  └── StatusEffectService     (status application)                   │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. LockType Enum

### 4.1 Enum Definition

**File:** `src/Core/RuneAndRust.Domain/Enums/LockType.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Classification of lock types with associated base difficulty classes.
/// </summary>
/// <remarks>
/// <para>
/// Lock difficulty follows a progression from improvised latches found in
/// makeshift shelters to legendary Jötun-forged mechanisms from the Old World.
/// </para>
/// <para>
/// Base DCs assume normal conditions. Additional modifiers apply for:
/// <list type="bullet">
///   <item><description>Corruption level ([Glitched] +2 DC, [Blighted] +4 DC)</description></item>
///   <item><description>Previous failed attempts (+1 DC each, from failure escalation)</description></item>
///   <item><description>[Mechanism Jammed] status (+2 DC permanent)</description></item>
/// </list>
/// </para>
/// </remarks>
public enum LockType
{
    /// <summary>
    /// Improvised latch or simple hook closure.
    /// </summary>
    /// <remarks>
    /// Found on makeshift shelters, scrap containers, and jury-rigged doors.
    /// Can be opened bare-handed with patience.
    /// Base DC: 6 (requires 1 net success for minimal DC).
    /// </remarks>
    ImprovisedLatch = 6,

    /// <summary>
    /// Basic pin tumbler or simple mechanical lock.
    /// </summary>
    /// <remarks>
    /// Common on residential doors, basic chests, and standard containers.
    /// Requires basic tools (improvised or proper).
    /// Base DC: 10 (requires ~2 net successes).
    /// </remarks>
    SimpleLock = 10,

    /// <summary>
    /// Standard quality lock with multiple pins or wards.
    /// </summary>
    /// <remarks>
    /// Found on commercial properties, secure storage, and quality containers.
    /// Requires [Tinker's Toolkit] or equivalent.
    /// Base DC: 14 (requires ~2-3 net successes).
    /// </remarks>
    StandardLock = 14,

    /// <summary>
    /// Complex mechanism with advanced security features.
    /// </summary>
    /// <remarks>
    /// Found on high-security installations, vaults, and valuable caches.
    /// May include false pins, trap triggers, or anti-pick features.
    /// Base DC: 18 (requires ~3-4 net successes).
    /// </remarks>
    ComplexLock = 18,

    /// <summary>
    /// Master-crafted lock of exceptional quality.
    /// </summary>
    /// <remarks>
    /// Rare locks created by skilled Dvergr craftsmen or master locksmiths.
    /// Often guards the most valuable treasures.
    /// Base DC: 22 (requires ~4-5 net successes).
    /// </remarks>
    MasterLock = 22,

    /// <summary>
    /// Legendary Old World lock of Jötun manufacture.
    /// </summary>
    /// <remarks>
    /// Ancient mechanisms of incomprehensible complexity from the World Before.
    /// May incorporate runic elements or require specific bypass rituals.
    /// Often [Glitched] or [Blighted], further increasing difficulty.
    /// Base DC: 26 (requires ~5+ net successes or master abilities).
    /// </remarks>
    JotunForged = 26
}
```

### 4.2 Lock Type Summary Table

| Lock Type | Base DC | Success-Count DC* | Typical Location | Tool Required |
|-----------|---------|-------------------|------------------|---------------|
| Improvised Latch | 6 | 1 | Makeshift shelters, scrap bins | No |
| Simple Lock | 10 | 2 | Residential doors, basic chests | Improvised+ |
| Standard Lock | 14 | 2-3 | Commercial, secure storage | Tinker's Toolkit |
| Complex Lock | 18 | 3-4 | High-security, vaults | Tinker's Toolkit |
| Master Lock | 22 | 4-5 | Rare treasures, Dvergr work | Tinker's Toolkit |
| Jötun-Forged | 26 | 5+ | Old World relics | Tinker's Toolkit |

*Success-Count DC = Approximate net successes needed (DC ÷ ~5, as a rough heuristic)

---

## 5. LockContext Value Object

### 5.1 Value Object Definition

**File:** `src/Core/RuneAndRust.Domain/ValueObjects/LockContext.cs`

```csharp
using RuneAndRust.Domain.Enums;

namespace RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Contextual information for a lockpicking attempt.
/// </summary>
/// <remarks>
/// <para>
/// Aggregates all factors affecting a lockpicking check including lock type,
/// corruption level, tool quality, and previous attempt history.
/// </para>
/// <para>
/// The effective DC is calculated as:
/// <code>
/// EffectiveDc = BaseDc + CorruptionModifier + JammedModifier + PreviousAttemptPenalty
/// </code>
/// </para>
/// <para>
/// The dice modifier is determined by tool quality:
/// <list type="bullet">
///   <item><description>Bare Hands: -2d10</description></item>
///   <item><description>Improvised Tools: +0</description></item>
///   <item><description>Proper Lockpicks: +1d10</description></item>
///   <item><description>Masterwork Tools: +2d10</description></item>
/// </list>
/// </para>
/// </remarks>
public sealed class LockContext
{
    /// <summary>
    /// The type/classification of the lock.
    /// </summary>
    public LockType LockType { get; }

    /// <summary>
    /// The corruption level affecting the lock.
    /// </summary>
    /// <remarks>
    /// Normal: No modifier.
    /// Glitched: +2 DC.
    /// Blighted: +4 DC.
    /// </remarks>
    public CorruptionTier CorruptionLevel { get; }

    /// <summary>
    /// The quality of tools being used for the attempt.
    /// </summary>
    public ToolQuality ToolQuality { get; }

    /// <summary>
    /// Number of previous failed attempts on this lock by this character.
    /// </summary>
    /// <remarks>
    /// Each failed attempt may increase difficulty for subsequent attempts
    /// depending on game configuration (failure escalation).
    /// </remarks>
    public int PreviousAttempts { get; }

    /// <summary>
    /// Whether the lock mechanism has been jammed by a previous fumble.
    /// </summary>
    /// <remarks>
    /// A jammed lock has DC permanently increased by 2 and cannot be
    /// opened with its associated key.
    /// </remarks>
    public bool IsJammed { get; }

    /// <summary>
    /// Unique identifier of the lock entity (for tracking consequences).
    /// </summary>
    public string LockId { get; }

    /// <summary>
    /// Display name of the lock for UI messages.
    /// </summary>
    public string? LockName { get; }

    /// <summary>
    /// Base difficulty class from the lock type.
    /// </summary>
    public int BaseDc => (int)LockType;

    /// <summary>
    /// DC modifier from corruption level.
    /// </summary>
    public int CorruptionDcModifier => CorruptionLevel switch
    {
        CorruptionTier.Normal => 0,
        CorruptionTier.Glitched => 2,
        CorruptionTier.Blighted => 4,
        _ => 0
    };

    /// <summary>
    /// DC modifier from jammed mechanism.
    /// </summary>
    public int JammedDcModifier => IsJammed ? 2 : 0;

    /// <summary>
    /// Total effective difficulty class for the lockpicking check.
    /// </summary>
    /// <remarks>
    /// Sum of base DC, corruption modifier, and jammed modifier.
    /// Previous attempts are NOT included here; they are tracked separately
    /// for failure escalation if enabled.
    /// </remarks>
    public int EffectiveDc => BaseDc + CorruptionDcModifier + JammedDcModifier;

    /// <summary>
    /// Dice pool modifier from tool quality.
    /// </summary>
    public int ToolDiceModifier => ToolQuality switch
    {
        ToolQuality.BareHands => -2,
        ToolQuality.Improvised => 0,
        ToolQuality.Proper => 1,
        ToolQuality.Masterwork => 2,
        _ => 0
    };

    /// <summary>
    /// Whether tools are required for this lock.
    /// </summary>
    /// <remarks>
    /// Locks with DC 4+ (ImprovisedLatch excluded) require at least
    /// a [Tinker's Toolkit] to attempt. Bare hands cannot be used.
    /// </remarks>
    public bool RequiresTools => BaseDc >= 10;

    /// <summary>
    /// Whether the current tool quality meets requirements.
    /// </summary>
    public bool HasRequiredTools => !RequiresTools || ToolQuality >= ToolQuality.Improvised;

    /// <summary>
    /// Creates a new lock context.
    /// </summary>
    /// <param name="lockId">Unique identifier for the lock.</param>
    /// <param name="lockType">Classification of the lock.</param>
    /// <param name="corruptionLevel">Corruption tier affecting the lock.</param>
    /// <param name="toolQuality">Quality of tools being used.</param>
    /// <param name="previousAttempts">Number of prior failed attempts.</param>
    /// <param name="isJammed">Whether the mechanism is jammed.</param>
    /// <param name="lockName">Optional display name.</param>
    public LockContext(
        string lockId,
        LockType lockType,
        CorruptionTier corruptionLevel = CorruptionTier.Normal,
        ToolQuality toolQuality = ToolQuality.Improvised,
        int previousAttempts = 0,
        bool isJammed = false,
        string? lockName = null)
    {
        LockId = lockId ?? throw new ArgumentNullException(nameof(lockId));
        LockType = lockType;
        CorruptionLevel = corruptionLevel;
        ToolQuality = toolQuality;
        PreviousAttempts = Math.Max(0, previousAttempts);
        IsJammed = isJammed;
        LockName = lockName;
    }

    /// <summary>
    /// Creates a copy of this context with the jammed flag set.
    /// </summary>
    /// <returns>A new LockContext with IsJammed = true.</returns>
    public LockContext WithJammed()
    {
        return new LockContext(
            LockId,
            LockType,
            CorruptionLevel,
            ToolQuality,
            PreviousAttempts,
            isJammed: true,
            LockName);
    }

    /// <summary>
    /// Creates a copy of this context with incremented previous attempts.
    /// </summary>
    /// <returns>A new LockContext with PreviousAttempts + 1.</returns>
    public LockContext WithFailedAttempt()
    {
        return new LockContext(
            LockId,
            LockType,
            CorruptionLevel,
            ToolQuality,
            PreviousAttempts + 1,
            IsJammed,
            LockName);
    }

    /// <summary>
    /// Converts this context to a SkillContext for skill check integration.
    /// </summary>
    /// <returns>A SkillContext with equipment modifiers applied.</returns>
    public SkillContext ToSkillContext()
    {
        var builder = new SkillContextBuilder();

        // Add tool modifier as equipment
        if (ToolDiceModifier != 0)
        {
            var toolName = ToolQuality switch
            {
                ToolQuality.BareHands => "Bare Hands",
                ToolQuality.Improvised => "Improvised Tools",
                ToolQuality.Proper => "Lockpicks",
                ToolQuality.Masterwork => "Masterwork Tools",
                _ => "Unknown Tools"
            };

            builder.WithEquipment(
                equipmentId: $"tool-{ToolQuality.ToString().ToLowerInvariant()}",
                equipmentName: toolName,
                diceModifier: ToolDiceModifier);
        }

        // Add corruption modifier as environment
        if (CorruptionDcModifier != 0)
        {
            builder.WithEnvironment(
                source: $"Corruption ({CorruptionLevel})",
                dcModifier: CorruptionDcModifier);
        }

        // Add jammed modifier as situational
        if (IsJammed)
        {
            builder.WithSituation(
                source: "Mechanism Jammed",
                dcModifier: JammedDcModifier,
                description: "Previous fumble damaged the lock");
        }

        return builder.Build();
    }

    /// <summary>
    /// Returns a human-readable description of the lock context.
    /// </summary>
    public override string ToString()
    {
        var parts = new List<string>
        {
            $"{LockType} (DC {EffectiveDc})"
        };

        if (CorruptionLevel != CorruptionTier.Normal)
            parts.Add($"[{CorruptionLevel}]");

        if (IsJammed)
            parts.Add("[Jammed]");

        parts.Add($"Tools: {ToolQuality} ({(ToolDiceModifier >= 0 ? "+" : "")}{ToolDiceModifier}d10)");

        if (PreviousAttempts > 0)
            parts.Add($"{PreviousAttempts} prior attempt(s)");

        return string.Join(", ", parts);
    }
}
```

### 5.2 Property Summary Table

| Property | Type | Description |
|----------|------|-------------|
| `LockType` | `LockType` | Classification of the lock |
| `CorruptionLevel` | `CorruptionTier` | Corruption affecting the lock |
| `ToolQuality` | `ToolQuality` | Quality of tools being used |
| `PreviousAttempts` | `int` | Number of prior failed attempts |
| `IsJammed` | `bool` | Whether mechanism is jammed |
| `LockId` | `string` | Unique identifier for tracking |
| `LockName` | `string?` | Display name for UI |
| `BaseDc` | `int` | Base DC from lock type |
| `CorruptionDcModifier` | `int` | DC modifier from corruption |
| `JammedDcModifier` | `int` | DC modifier if jammed (+2) |
| `EffectiveDc` | `int` | Total calculated DC |
| `ToolDiceModifier` | `int` | Dice pool modifier from tools |
| `RequiresTools` | `bool` | Whether tools are needed |
| `HasRequiredTools` | `bool` | Whether current tools suffice |

---

## 6. ToolQuality Enum

### 6.1 Enum Definition

**File:** `src/Core/RuneAndRust.Domain/Enums/ToolQuality.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Quality levels for lockpicking and bypass tools.
/// </summary>
/// <remarks>
/// <para>
/// Tool quality directly affects the dice pool for lockpicking attempts:
/// <list type="bullet">
///   <item><description>BareHands: -2d10 (only viable for DC &lt; 4)</description></item>
///   <item><description>Improvised: +0 (bent wire, hairpin)</description></item>
///   <item><description>Proper: +1d10 (Tinker's Toolkit, quality picks)</description></item>
///   <item><description>Masterwork: +2d10 (Dvergr-crafted tools)</description></item>
/// </list>
/// </para>
/// <para>
/// Locks with DC 4+ require at least Improvised tools.
/// DC 10+ (SimpleLock and above) require a [Tinker's Toolkit].
/// </para>
/// </remarks>
public enum ToolQuality
{
    /// <summary>
    /// No tools—attempting with fingers only.
    /// </summary>
    /// <remarks>
    /// Modifier: -2d10.
    /// Only viable for ImprovisedLatch (DC 6) with very high skill.
    /// Cannot attempt locks with DC 10+.
    /// </remarks>
    BareHands = 0,

    /// <summary>
    /// Improvised tools such as bent wire, hairpins, or scrap metal.
    /// </summary>
    /// <remarks>
    /// Modifier: +0.
    /// Sufficient for basic attempts but provides no bonus.
    /// Can break on fumble, requiring replacement.
    /// </remarks>
    Improvised = 1,

    /// <summary>
    /// Proper lockpicking tools from a [Tinker's Toolkit].
    /// </summary>
    /// <remarks>
    /// Modifier: +1d10.
    /// Standard equipment for System Bypass specialists.
    /// Required for most serious lockpicking attempts.
    /// </remarks>
    Proper = 2,

    /// <summary>
    /// Masterwork tools of exceptional quality.
    /// </summary>
    /// <remarks>
    /// Modifier: +2d10.
    /// Rare and valuable. May be crafted by Scrap-Tinkers with
    /// the [Master Craftsman] ability and rare components.
    /// </remarks>
    Masterwork = 3
}
```

### 6.2 Tool Quality Summary Table

| Quality | Dice Modifier | Description | Source |
|---------|---------------|-------------|--------|
| Bare Hands | -2d10 | No tools | N/A |
| Improvised | +0 | Bent wire, hairpin | Scavenged |
| Proper | +1d10 | Tinker's Toolkit | Purchased, crafted |
| Masterwork | +2d10 | Dvergr-crafted | Crafted (rare) |

---

## 7. LockpickingResult Value Object

### 7.1 Value Object Definition

**File:** `src/Core/RuneAndRust.Domain/ValueObjects/LockpickingResult.cs`

```csharp
using RuneAndRust.Domain.Enums;

namespace RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Result of a lockpicking attempt.
/// </summary>
/// <remarks>
/// <para>
/// Encapsulates the outcome of a lockpicking check including:
/// <list type="bullet">
///   <item><description>Whether the lock was opened</description></item>
///   <item><description>The skill check outcome tier</description></item>
///   <item><description>Any salvaged components (on critical success)</description></item>
///   <item><description>Fumble consequence details (if applicable)</description></item>
///   <item><description>Updated lock context (if state changed)</description></item>
/// </list>
/// </para>
/// </remarks>
/// <param name="IsSuccess">Whether the lock was successfully opened.</param>
/// <param name="Outcome">The skill check outcome tier.</param>
/// <param name="LockContext">The lock context used for the attempt.</param>
/// <param name="SkillCheckResult">The underlying skill check result.</param>
/// <param name="SalvagedComponent">Component salvaged on critical success.</param>
/// <param name="FumbleConsequence">Consequence created on fumble.</param>
/// <param name="UpdatedContext">Context with updated state (jammed, attempts).</param>
/// <param name="NarrativeDescription">Flavor text describing the outcome.</param>
public readonly record struct LockpickingResult(
    bool IsSuccess,
    SkillOutcome Outcome,
    LockContext LockContext,
    SkillCheckResult SkillCheckResult,
    SalvageableComponent? SalvagedComponent,
    FumbleConsequence? FumbleConsequence,
    LockContext? UpdatedContext,
    string NarrativeDescription)
{
    /// <summary>
    /// Whether this was a critical success that yielded salvage.
    /// </summary>
    public bool HasSalvage => SalvagedComponent.HasValue;

    /// <summary>
    /// Whether this attempt caused a fumble.
    /// </summary>
    public bool IsFumble => Outcome == SkillOutcome.CriticalFailure;

    /// <summary>
    /// Whether this was a critical success.
    /// </summary>
    public bool IsCriticalSuccess => Outcome == SkillOutcome.CriticalSuccess;

    /// <summary>
    /// Whether the lock state changed (jammed, attempt count).
    /// </summary>
    public bool LockStateChanged => UpdatedContext != null;

    /// <summary>
    /// Gets the final lock context (updated if changed, original if not).
    /// </summary>
    public LockContext FinalContext => UpdatedContext ?? LockContext;

    /// <summary>
    /// Creates a success result.
    /// </summary>
    public static LockpickingResult Success(
        SkillOutcome outcome,
        LockContext context,
        SkillCheckResult checkResult,
        string narrative,
        SalvageableComponent? salvage = null)
    {
        return new LockpickingResult(
            IsSuccess: true,
            Outcome: outcome,
            LockContext: context,
            SkillCheckResult: checkResult,
            SalvagedComponent: salvage,
            FumbleConsequence: null,
            UpdatedContext: null,
            NarrativeDescription: narrative);
    }

    /// <summary>
    /// Creates a failure result.
    /// </summary>
    public static LockpickingResult Failure(
        SkillOutcome outcome,
        LockContext context,
        SkillCheckResult checkResult,
        string narrative,
        LockContext? updatedContext = null)
    {
        return new LockpickingResult(
            IsSuccess: false,
            Outcome: outcome,
            LockContext: context,
            SkillCheckResult: checkResult,
            SalvagedComponent: null,
            FumbleConsequence: null,
            UpdatedContext: updatedContext,
            NarrativeDescription: narrative);
    }

    /// <summary>
    /// Creates a fumble result.
    /// </summary>
    public static LockpickingResult Fumble(
        LockContext context,
        SkillCheckResult checkResult,
        FumbleConsequence consequence,
        LockContext updatedContext,
        string narrative)
    {
        return new LockpickingResult(
            IsSuccess: false,
            Outcome: SkillOutcome.CriticalFailure,
            LockContext: context,
            SkillCheckResult: checkResult,
            SalvagedComponent: null,
            FumbleConsequence: consequence,
            UpdatedContext: updatedContext,
            NarrativeDescription: narrative);
    }

    /// <summary>
    /// Returns a formatted string describing the result.
    /// </summary>
    public override string ToString()
    {
        var result = IsSuccess ? "SUCCESS" : "FAILURE";
        if (IsCriticalSuccess) result = "CRITICAL SUCCESS";
        if (IsFumble) result = "FUMBLE";

        return $"Lockpicking {result}: {NarrativeDescription}";
    }
}
```

---

## 8. LockpickingService Implementation

### 8.1 Interface Definition

**File:** `src/Core/RuneAndRust.Domain/Interfaces/ILockpickingService.cs`

```csharp
using RuneAndRust.Domain.Entities;
using RuneAndRust.Domain.ValueObjects;

namespace RuneAndRust.Domain.Interfaces;

/// <summary>
/// Service for executing lockpicking attempts.
/// </summary>
public interface ILockpickingService
{
    /// <summary>
    /// Attempts to pick a lock.
    /// </summary>
    /// <param name="player">The player attempting to pick the lock.</param>
    /// <param name="lockContext">Context containing lock and tool information.</param>
    /// <returns>The result of the lockpicking attempt.</returns>
    LockpickingResult AttemptLockpick(Player player, LockContext lockContext);

    /// <summary>
    /// Determines if a player can attempt to pick a specific lock.
    /// </summary>
    /// <param name="player">The player to check.</param>
    /// <param name="lockContext">The lock context.</param>
    /// <returns>True if the attempt can be made; otherwise false.</returns>
    bool CanAttempt(Player player, LockContext lockContext);

    /// <summary>
    /// Gets the reason why an attempt cannot be made.
    /// </summary>
    /// <param name="player">The player to check.</param>
    /// <param name="lockContext">The lock context.</param>
    /// <returns>Reason string if cannot attempt; null if can attempt.</returns>
    string? GetAttemptBlockedReason(Player player, LockContext lockContext);

    /// <summary>
    /// Gets possible salvage components for a lock type.
    /// </summary>
    /// <param name="lockType">The type of lock.</param>
    /// <returns>List of possible salvageable components.</returns>
    IReadOnlyList<SalvageableComponent> GetPossibleSalvage(LockType lockType);
}
```

### 8.2 Service Implementation

**File:** `src/Core/RuneAndRust.Application/Services/LockpickingService.cs`

```csharp
using Microsoft.Extensions.Logging;
using RuneAndRust.Application.Interfaces;
using RuneAndRust.Domain.Entities;
using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.Interfaces;
using RuneAndRust.Domain.ValueObjects;

namespace RuneAndRust.Application.Services;

/// <summary>
/// Service for executing lockpicking attempts using System Bypass skill.
/// </summary>
/// <remarks>
/// <para>
/// Implements the lockpicking subsystem of the System Bypass skill.
/// Lockpicking follows cargo cult mechanics—characters manipulate
/// incomprehensible mechanisms through pattern recognition.
/// </para>
/// <para>
/// Outcomes:
/// <list type="bullet">
///   <item><description>Success: Lock opens</description></item>
///   <item><description>Critical Success: Lock opens + salvage component</description></item>
///   <item><description>Failure: Lock remains locked, may retry</description></item>
///   <item><description>Fumble: [Mechanism Jammed] - DC +2 permanent, key useless</description></item>
/// </list>
/// </para>
/// </remarks>
public class LockpickingService : ILockpickingService
{
    private readonly ISkillCheckService _skillCheckService;
    private readonly IFumbleConsequenceService _fumbleService;
    private readonly IGameConfigurationProvider _configProvider;
    private readonly ILogger<LockpickingService> _logger;

    private const string LockpickingSkillId = "lockpicking";
    private const string TinkersToolkitId = "tinkers-toolkit";

    /// <summary>
    /// Creates a new LockpickingService.
    /// </summary>
    public LockpickingService(
        ISkillCheckService skillCheckService,
        IFumbleConsequenceService fumbleService,
        IGameConfigurationProvider configProvider,
        ILogger<LockpickingService> logger)
    {
        _skillCheckService = skillCheckService ?? throw new ArgumentNullException(nameof(skillCheckService));
        _fumbleService = fumbleService ?? throw new ArgumentNullException(nameof(fumbleService));
        _configProvider = configProvider ?? throw new ArgumentNullException(nameof(configProvider));
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));
    }

    /// <inheritdoc/>
    public LockpickingResult AttemptLockpick(Player player, LockContext lockContext)
    {
        ArgumentNullException.ThrowIfNull(player);
        ArgumentNullException.ThrowIfNull(lockContext);

        _logger.LogInformation(
            "Player {PlayerId} attempting to pick {LockType} lock {LockId} (DC {DC})",
            player.Id, lockContext.LockType, lockContext.LockId, lockContext.EffectiveDc);

        // Validate prerequisites
        var blockedReason = GetAttemptBlockedReason(player, lockContext);
        if (blockedReason != null)
        {
            _logger.LogWarning("Lockpicking blocked: {Reason}", blockedReason);
            return LockpickingResult.Failure(
                SkillOutcome.Failure,
                lockContext,
                CreateBlockedCheckResult(player, lockContext),
                blockedReason);
        }

        // Build skill context from lock context
        var skillContext = lockContext.ToSkillContext();

        // Perform the skill check
        var checkResult = _skillCheckService.PerformCheckWithDC(
            player,
            LockpickingSkillId,
            lockContext.EffectiveDc,
            difficultyName: lockContext.LockType.ToString(),
            context: skillContext);

        _logger.LogDebug(
            "Lockpicking check: {NetSuccesses} net vs DC {DC}, Outcome: {Outcome}",
            checkResult.DiceResult.NetSuccesses,
            lockContext.EffectiveDc,
            checkResult.Outcome);

        // Process the result
        return ProcessCheckResult(player, lockContext, checkResult);
    }

    /// <inheritdoc/>
    public bool CanAttempt(Player player, LockContext lockContext)
    {
        return GetAttemptBlockedReason(player, lockContext) == null;
    }

    /// <inheritdoc/>
    public string? GetAttemptBlockedReason(Player player, LockContext lockContext)
    {
        // Check tool requirements
        if (lockContext.RequiresTools && !lockContext.HasRequiredTools)
        {
            return lockContext.ToolQuality == ToolQuality.BareHands
                ? "You need proper tools to attempt this lock. A [Tinker's Toolkit] is required."
                : "Your improvised tools are insufficient for this lock. A [Tinker's Toolkit] is required.";
        }

        // Check for existing jammed consequence that blocks retry
        if (lockContext.IsJammed)
        {
            // Jammed locks can still be attempted, just at higher DC
            // Only block if there's a specific blocking consequence
            var hasBlockingConsequence = _fumbleService.HasActiveConsequence(
                player.Id.ToString(),
                LockpickingSkillId,
                lockContext.LockId);

            if (hasBlockingConsequence)
            {
                return "The mechanism is too damaged to attempt again without specialized tools.";
            }
        }

        // Check if player has the skill (lockpicking doesn't allow untrained)
        // This would be checked by SkillCheckService, but we can provide a better message
        // TODO: Add skill proficiency check when skill training system is implemented

        return null;
    }

    /// <inheritdoc/>
    public IReadOnlyList<SalvageableComponent> GetPossibleSalvage(LockType lockType)
    {
        // Return components based on lock type from configuration
        return lockType switch
        {
            LockType.ImprovisedLatch => new[]
            {
                new SalvageableComponent("wire-bundle", "Wire Bundle", "Useful for improvised tools"),
                new SalvageableComponent("spring-small", "Small Spring", "Basic mechanical component")
            },
            LockType.SimpleLock or LockType.StandardLock => new[]
            {
                new SalvageableComponent("high-tension-spring", "High-Tension Spring", "Quality mechanical component"),
                new SalvageableComponent("pin-set", "Pin Set", "Lockpick material")
            },
            LockType.ComplexLock or LockType.MasterLock => new[]
            {
                new SalvageableComponent("circuit-fragment", "Circuit Fragment", "Electronic component"),
                new SalvageableComponent("power-cell-fragment", "Power Cell Fragment", "Energy source component")
            },
            LockType.JotunForged => new[]
            {
                new SalvageableComponent("encryption-chip", "Encryption Chip", "Rare Old World component"),
                new SalvageableComponent("biometric-sensor", "Biometric Sensor", "Advanced security component")
            },
            _ => Array.Empty<SalvageableComponent>()
        };
    }

    /// <summary>
    /// Processes the skill check result and creates the appropriate lockpicking result.
    /// </summary>
    private LockpickingResult ProcessCheckResult(
        Player player,
        LockContext lockContext,
        SkillCheckResult checkResult)
    {
        return checkResult.Outcome switch
        {
            SkillOutcome.CriticalFailure => ProcessFumble(player, lockContext, checkResult),
            SkillOutcome.Failure => ProcessFailure(lockContext, checkResult),
            SkillOutcome.CriticalSuccess => ProcessCriticalSuccess(lockContext, checkResult),
            _ => ProcessSuccess(lockContext, checkResult)
        };
    }

    /// <summary>
    /// Processes a successful lockpicking attempt.
    /// </summary>
    private LockpickingResult ProcessSuccess(LockContext lockContext, SkillCheckResult checkResult)
    {
        var narrative = checkResult.Outcome switch
        {
            SkillOutcome.MarginalSuccess =>
                "With careful manipulation, the lock finally yields. The mechanism clicks open.",
            SkillOutcome.FullSuccess =>
                "Your practiced movements find the right combination. The lock opens smoothly.",
            SkillOutcome.ExceptionalSuccess =>
                "Your fingers dance across the mechanism with expert precision. The lock surrenders immediately.",
            _ => "The lock opens."
        };

        _logger.LogInformation(
            "Lock {LockId} successfully picked ({Outcome})",
            lockContext.LockId, checkResult.Outcome);

        return LockpickingResult.Success(
            checkResult.Outcome,
            lockContext,
            checkResult,
            narrative);
    }

    /// <summary>
    /// Processes a critical success with component salvage.
    /// </summary>
    private LockpickingResult ProcessCriticalSuccess(LockContext lockContext, SkillCheckResult checkResult)
    {
        // Select a random salvageable component
        var possibleSalvage = GetPossibleSalvage(lockContext.LockType);
        var salvage = possibleSalvage.Count > 0
            ? possibleSalvage[Random.Shared.Next(possibleSalvage.Count)]
            : (SalvageableComponent?)null;

        var narrative = salvage.HasValue
            ? $"The lock yields effortlessly to your masterful touch. As it opens, you notice a valuable [{salvage.Value.Name}] that you carefully extract."
            : "The lock yields effortlessly to your masterful touch. It opens with barely a sound.";

        _logger.LogInformation(
            "Lock {LockId} critically picked, salvaged {Component}",
            lockContext.LockId, salvage?.ComponentId ?? "nothing");

        return LockpickingResult.Success(
            SkillOutcome.CriticalSuccess,
            lockContext,
            checkResult,
            narrative,
            salvage);
    }

    /// <summary>
    /// Processes a failed lockpicking attempt.
    /// </summary>
    private LockpickingResult ProcessFailure(LockContext lockContext, SkillCheckResult checkResult)
    {
        var narrative = "Your tools probe the mechanism without success. The lock remains stubbornly closed.";

        // Track the failed attempt
        var updatedContext = lockContext.WithFailedAttempt();

        _logger.LogDebug(
            "Lock {LockId} pick failed, attempt count: {Attempts}",
            lockContext.LockId, updatedContext.PreviousAttempts);

        return LockpickingResult.Failure(
            SkillOutcome.Failure,
            lockContext,
            checkResult,
            narrative,
            updatedContext);
    }

    /// <summary>
    /// Processes a fumble with [Mechanism Jammed] consequence.
    /// </summary>
    private LockpickingResult ProcessFumble(
        Player player,
        LockContext lockContext,
        SkillCheckResult checkResult)
    {
        // Create the [Mechanism Jammed] consequence
        var consequence = _fumbleService.CreateConsequence(
            player.Id.ToString(),
            LockpickingSkillId,
            FumbleType.MechanismJammed,
            lockContext.LockId,
            description: $"The lock mechanism ({lockContext.LockName ?? lockContext.LockType.ToString()}) is jammed. DC permanently +2, associated key no longer works.");

        // Update the lock context to reflect the jam
        var updatedContext = lockContext.WithJammed();

        var narrative =
            "Your pick catches on an internal mechanism and snaps. The lock shudders, " +
            "emitting a grinding sound as something inside jams. The mechanism is now harder " +
            "to manipulate, and any key that once fit will no longer work.";

        _logger.LogWarning(
            "Lock {LockId} JAMMED by fumble from player {PlayerId}",
            lockContext.LockId, player.Id);

        return LockpickingResult.Fumble(
            lockContext,
            checkResult,
            consequence,
            updatedContext,
            narrative);
    }

    /// <summary>
    /// Creates a blocked check result for validation failures.
    /// </summary>
    private SkillCheckResult CreateBlockedCheckResult(Player player, LockContext lockContext)
    {
        // Return a minimal check result indicating the attempt was blocked
        return new SkillCheckResult(
            SkillId: LockpickingSkillId,
            SkillName: "Lockpicking",
            DiceResult: default,
            AttributeBonus: 0,
            ContextBonus: 0,
            TotalResult: 0,
            DifficultyClass: lockContext.EffectiveDc,
            DifficultyName: lockContext.LockType.ToString(),
            Outcome: SkillOutcome.Failure);
    }
}
```

---

## 9. Salvageable Components

### 9.1 Value Object Definition

**File:** `src/Core/RuneAndRust.Domain/ValueObjects/SalvageableComponent.cs`

```csharp
namespace RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Represents a component that can be salvaged from a lock on critical success.
/// </summary>
/// <remarks>
/// <para>
/// Salvageable components are materials recovered from successfully bypassed locks.
/// These can be used in crafting or sold for currency.
/// </para>
/// <para>
/// Component availability depends on lock type:
/// <list type="bullet">
///   <item><description>Mechanical locks: [High-Tension Spring], [Pin Set]</description></item>
///   <item><description>Electronic locks: [Circuit Fragment], [Power Cell]</description></item>
///   <item><description>Complex locks: [Encryption Chip], [Biometric Sensor]</description></item>
/// </list>
/// </para>
/// </remarks>
/// <param name="ComponentId">Unique identifier for the component type.</param>
/// <param name="Name">Display name of the component.</param>
/// <param name="Description">Flavor text describing the component.</param>
/// <param name="Quantity">Number of this component salvaged (default 1).</param>
/// <param name="Rarity">Rarity tier of the component.</param>
public readonly record struct SalvageableComponent(
    string ComponentId,
    string Name,
    string Description,
    int Quantity = 1,
    ItemRarity Rarity = ItemRarity.Common)
{
    /// <summary>
    /// Creates a formatted string for UI display.
    /// </summary>
    public string ToDisplayString()
    {
        var qty = Quantity > 1 ? $" x{Quantity}" : "";
        return $"[{Name}]{qty}";
    }

    /// <inheritdoc/>
    public override string ToString() => ToDisplayString();
}
```

### 9.2 Salvage Tables by Lock Type

| Lock Type | Mechanical Components | Electronic Components |
|-----------|----------------------|----------------------|
| Improvised Latch | Wire Bundle, Small Spring | — |
| Simple Lock | High-Tension Spring, Pin Set | — |
| Standard Lock | High-Tension Spring, Pin Set | — |
| Complex Lock | — | Circuit Fragment, Power Cell Fragment |
| Master Lock | — | Circuit Fragment, Power Cell Fragment |
| Jötun-Forged | — | Encryption Chip, Biometric Sensor |

---

## 10. Data Model Changes

### 10.1 New Types Summary

| Type | Layer | File | Description |
|------|-------|------|-------------|
| `LockType` | Domain | `Enums/LockType.cs` | Lock classification enum |
| `ToolQuality` | Domain | `Enums/ToolQuality.cs` | Tool quality levels |
| `LockContext` | Domain | `ValueObjects/LockContext.cs` | Lock-specific context |
| `LockpickingResult` | Domain | `ValueObjects/LockpickingResult.cs` | Attempt result |
| `SalvageableComponent` | Domain | `ValueObjects/SalvageableComponent.cs` | Salvage component |
| `ILockpickingService` | Domain | `Interfaces/ILockpickingService.cs` | Service interface |
| `LockpickingService` | Application | `Services/LockpickingService.cs` | Service implementation |

### 10.2 Dependencies on Existing Types

| Type | Layer | Usage |
|------|-------|-------|
| `CorruptionTier` | Domain | Lock corruption level |
| `FumbleType` | Domain | MechanismJammed consequence |
| `SkillOutcome` | Domain | Outcome classification |
| `SkillCheckResult` | Domain | Underlying check result |
| `SkillContext` | Domain | Skill modifier aggregation |
| `FumbleConsequence` | Domain | Consequence tracking |
| `ISkillCheckService` | Application | Skill check execution |
| `IFumbleConsequenceService` | Application | Consequence management |

---

## 11. Configuration Files

### 11.1 lock-types.json

**File:** `config/lock-types.json`

```json
{
    "$schema": "./schemas/lock-types.schema.json",
    "lockTypes": [
        {
            "id": "improvised-latch",
            "type": "ImprovisedLatch",
            "baseDc": 6,
            "displayName": "Improvised Latch",
            "description": "A makeshift closure held together with wire or bent metal.",
            "requiresTools": false,
            "salvageTable": "mechanical-basic"
        },
        {
            "id": "simple-lock",
            "type": "SimpleLock",
            "baseDc": 10,
            "displayName": "Simple Lock",
            "description": "A basic pin tumbler lock found on residential doors.",
            "requiresTools": true,
            "minimumToolQuality": "Improvised",
            "salvageTable": "mechanical-standard"
        },
        {
            "id": "standard-lock",
            "type": "StandardLock",
            "baseDc": 14,
            "displayName": "Standard Lock",
            "description": "A quality lock with multiple security pins.",
            "requiresTools": true,
            "minimumToolQuality": "Proper",
            "salvageTable": "mechanical-standard"
        },
        {
            "id": "complex-lock",
            "type": "ComplexLock",
            "baseDc": 18,
            "displayName": "Complex Lock",
            "description": "An advanced mechanism with anti-pick features.",
            "requiresTools": true,
            "minimumToolQuality": "Proper",
            "salvageTable": "electronic-standard"
        },
        {
            "id": "master-lock",
            "type": "MasterLock",
            "baseDc": 22,
            "displayName": "Master Lock",
            "description": "A masterwork lock crafted by Dvergr artisans.",
            "requiresTools": true,
            "minimumToolQuality": "Proper",
            "salvageTable": "electronic-standard"
        },
        {
            "id": "jotun-forged",
            "type": "JotunForged",
            "baseDc": 26,
            "displayName": "Jötun-Forged Lock",
            "description": "An ancient mechanism of incomprehensible complexity from the World Before.",
            "requiresTools": true,
            "minimumToolQuality": "Proper",
            "salvageTable": "electronic-rare"
        }
    ],
    "corruptionModifiers": {
        "Normal": 0,
        "Glitched": 2,
        "Blighted": 4
    },
    "jammedModifier": 2
}
```

### 11.2 lockpicking-tools.json

**File:** `config/lockpicking-tools.json`

```json
{
    "$schema": "./schemas/lockpicking-tools.schema.json",
    "toolQualities": [
        {
            "quality": "BareHands",
            "diceModifier": -2,
            "displayName": "Bare Hands",
            "description": "Attempting without any tools. Only viable for the simplest latches.",
            "maxLockDc": 6
        },
        {
            "quality": "Improvised",
            "diceModifier": 0,
            "displayName": "Improvised Tools",
            "description": "Bent wire, hairpins, or scrap metal fashioned into picks.",
            "maxLockDc": 14,
            "breakOnFumble": true
        },
        {
            "quality": "Proper",
            "diceModifier": 1,
            "displayName": "Proper Lockpicks",
            "description": "Quality picks from a [Tinker's Toolkit].",
            "maxLockDc": null,
            "requiredItemId": "tinkers-toolkit"
        },
        {
            "quality": "Masterwork",
            "diceModifier": 2,
            "displayName": "Masterwork Tools",
            "description": "Dvergr-crafted tools of exceptional quality.",
            "maxLockDc": null,
            "requiredItemId": "masterwork-lockpicks"
        }
    ],
    "salvageTables": {
        "mechanical-basic": [
            { "componentId": "wire-bundle", "name": "Wire Bundle", "weight": 60 },
            { "componentId": "spring-small", "name": "Small Spring", "weight": 40 }
        ],
        "mechanical-standard": [
            { "componentId": "high-tension-spring", "name": "High-Tension Spring", "weight": 50 },
            { "componentId": "pin-set", "name": "Pin Set", "weight": 50 }
        ],
        "electronic-standard": [
            { "componentId": "circuit-fragment", "name": "Circuit Fragment", "weight": 60 },
            { "componentId": "power-cell-fragment", "name": "Power Cell Fragment", "weight": 40 }
        ],
        "electronic-rare": [
            { "componentId": "encryption-chip", "name": "Encryption Chip", "weight": 40 },
            { "componentId": "biometric-sensor", "name": "Biometric Sensor", "weight": 60 }
        ]
    }
}
```

### 11.3 lock-types.schema.json

**File:** `config/schemas/lock-types.schema.json`

```json
{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://runeandrust.game/schemas/lock-types.schema.json",
    "title": "Lock Types Configuration",
    "description": "Configuration schema for lock type definitions and corruption modifiers",
    "type": "object",
    "required": ["lockTypes", "corruptionModifiers", "jammedModifier"],
    "properties": {
        "lockTypes": {
            "type": "array",
            "description": "Array of lock type definitions",
            "items": {
                "type": "object",
                "required": ["id", "type", "baseDc", "displayName", "description", "requiresTools"],
                "properties": {
                    "id": {
                        "type": "string",
                        "description": "Unique identifier for the lock type"
                    },
                    "type": {
                        "type": "string",
                        "enum": ["ImprovisedLatch", "SimpleLock", "StandardLock", "ComplexLock", "MasterLock", "JotunForged"],
                        "description": "Lock type enum value"
                    },
                    "baseDc": {
                        "type": "integer",
                        "minimum": 1,
                        "maximum": 30,
                        "description": "Base difficulty class for this lock type"
                    },
                    "displayName": {
                        "type": "string",
                        "description": "Human-readable name for UI display"
                    },
                    "description": {
                        "type": "string",
                        "description": "Flavor text describing the lock type"
                    },
                    "requiresTools": {
                        "type": "boolean",
                        "description": "Whether tools are required to attempt this lock"
                    },
                    "minimumToolQuality": {
                        "type": "string",
                        "enum": ["BareHands", "Improvised", "Proper", "Masterwork"],
                        "description": "Minimum tool quality required (if requiresTools is true)"
                    },
                    "salvageTable": {
                        "type": "string",
                        "description": "Reference to salvage table for critical success components"
                    }
                }
            }
        },
        "corruptionModifiers": {
            "type": "object",
            "description": "DC modifiers by corruption tier",
            "required": ["Normal", "Glitched", "Blighted"],
            "properties": {
                "Normal": { "type": "integer" },
                "Glitched": { "type": "integer" },
                "Blighted": { "type": "integer" }
            }
        },
        "jammedModifier": {
            "type": "integer",
            "description": "DC modifier applied when lock is jammed"
        }
    }
}
```

### 11.4 lockpicking-tools.schema.json

**File:** `config/schemas/lockpicking-tools.schema.json`

```json
{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://runeandrust.game/schemas/lockpicking-tools.schema.json",
    "title": "Lockpicking Tools Configuration",
    "description": "Configuration schema for tool qualities and salvage tables",
    "type": "object",
    "required": ["toolQualities", "salvageTables"],
    "properties": {
        "toolQualities": {
            "type": "array",
            "description": "Array of tool quality definitions",
            "items": {
                "type": "object",
                "required": ["quality", "diceModifier", "displayName", "description"],
                "properties": {
                    "quality": {
                        "type": "string",
                        "enum": ["BareHands", "Improvised", "Proper", "Masterwork"],
                        "description": "Tool quality enum value"
                    },
                    "diceModifier": {
                        "type": "integer",
                        "minimum": -5,
                        "maximum": 5,
                        "description": "Dice pool modifier for this tool quality"
                    },
                    "displayName": {
                        "type": "string",
                        "description": "Human-readable name for UI display"
                    },
                    "description": {
                        "type": "string",
                        "description": "Flavor text describing the tool quality"
                    },
                    "maxLockDc": {
                        "type": ["integer", "null"],
                        "minimum": 1,
                        "description": "Maximum lock DC this tool can attempt (null = unlimited)"
                    },
                    "breakOnFumble": {
                        "type": "boolean",
                        "description": "Whether tool breaks on fumble"
                    },
                    "requiredItemId": {
                        "type": "string",
                        "description": "Item ID required to use this tool quality"
                    }
                }
            }
        },
        "salvageTables": {
            "type": "object",
            "description": "Salvage component tables by category",
            "additionalProperties": {
                "type": "array",
                "items": {
                    "type": "object",
                    "required": ["componentId", "name", "weight"],
                    "properties": {
                        "componentId": {
                            "type": "string",
                            "description": "Unique identifier for the component"
                        },
                        "name": {
                            "type": "string",
                            "description": "Display name of the component"
                        },
                        "weight": {
                            "type": "integer",
                            "minimum": 1,
                            "maximum": 100,
                            "description": "Weighted probability for random selection"
                        }
                    }
                }
            }
        }
    }
}
```

### 11.5 Configuration Schema Summary

| Config File | Schema File | Purpose |
|-------------|-------------|---------|
| `lock-types.json` | `lock-types.schema.json` | Lock type definitions, DCs, corruption modifiers |
| `lockpicking-tools.json` | `lockpicking-tools.schema.json` | Tool qualities, dice modifiers, salvage tables |

---

## 12. Logging Specifications

### 12.1 Log Levels by Component

| Component | Level | Events |
|-----------|-------|--------|
| `LockpickingService` | Information | Attempt started, success, failure |
| `LockpickingService` | Warning | Fumble occurred, mechanism jammed |
| `LockpickingService` | Debug | Context building, modifier calculation |
| `LockpickingService` | Debug | Salvage roll, component selection |

### 12.2 Log Message Formats

```
[Information] Player {PlayerId} attempting to pick {LockType} lock {LockId} (DC {DC})
[Information] Lock {LockId} successfully picked ({Outcome})
[Information] Lock {LockId} critically picked, salvaged {ComponentId}
[Warning] Lock {LockId} JAMMED by fumble from player {PlayerId}
[Warning] Lockpicking blocked: {Reason}
[Debug] Lockpicking check: {NetSuccesses} net vs DC {DC}, Outcome: {Outcome}
[Debug] Lock {LockId} pick failed, attempt count: {Attempts}
```

---

## 13. Unit Testing Requirements

### 13.1 Test Count by Feature

| Feature | Test Count |
|---------|------------|
| Lock type DC assignment | 1 |
| Tool modifier application | 1 |
| Critical success salvage | 1 |
| Fumble triggers [Mechanism Jammed] | 1 |
| **Total** | **~4** |

### 13.2 Test Specifications

**File:** `tests/RuneAndRust.Application.UnitTests/Services/LockpickingServiceTests.cs`

```csharp
[TestFixture]
public class LockpickingServiceTests
{
    private Mock<ISkillCheckService> _mockSkillCheckService = null!;
    private Mock<IFumbleConsequenceService> _mockFumbleService = null!;
    private Mock<IGameConfigurationProvider> _mockConfigProvider = null!;
    private Mock<ILogger<LockpickingService>> _mockLogger = null!;
    private LockpickingService _service = null!;

    [SetUp]
    public void SetUp()
    {
        _mockSkillCheckService = new Mock<ISkillCheckService>();
        _mockFumbleService = new Mock<IFumbleConsequenceService>();
        _mockConfigProvider = new Mock<IGameConfigurationProvider>();
        _mockLogger = new Mock<ILogger<LockpickingService>>();

        _service = new LockpickingService(
            _mockSkillCheckService.Object,
            _mockFumbleService.Object,
            _mockConfigProvider.Object,
            _mockLogger.Object);
    }

    [Test]
    [TestCase(LockType.ImprovisedLatch, 6)]
    [TestCase(LockType.SimpleLock, 10)]
    [TestCase(LockType.StandardLock, 14)]
    [TestCase(LockType.ComplexLock, 18)]
    [TestCase(LockType.MasterLock, 22)]
    [TestCase(LockType.JotunForged, 26)]
    public void LockType_SetsCorrectBaseDc(LockType lockType, int expectedDc)
    {
        // Arrange
        var context = new LockContext("test-lock", lockType);

        // Assert
        Assert.That(context.BaseDc, Is.EqualTo(expectedDc));
        Assert.That(context.EffectiveDc, Is.EqualTo(expectedDc));
    }

    [Test]
    [TestCase(ToolQuality.BareHands, -2)]
    [TestCase(ToolQuality.Improvised, 0)]
    [TestCase(ToolQuality.Proper, 1)]
    [TestCase(ToolQuality.Masterwork, 2)]
    public void ToolQuality_AppliesCorrectDiceModifier(ToolQuality quality, int expectedModifier)
    {
        // Arrange
        var context = new LockContext(
            "test-lock",
            LockType.StandardLock,
            toolQuality: quality);

        // Assert
        Assert.That(context.ToolDiceModifier, Is.EqualTo(expectedModifier));
    }

    [Test]
    public void CriticalSuccess_YieldsSalvageableComponent()
    {
        // Arrange
        var player = CreateTestPlayer();
        var context = new LockContext("test-lock", LockType.StandardLock, toolQuality: ToolQuality.Proper);

        SetupCriticalSuccessCheck();

        // Act
        var result = _service.AttemptLockpick(player, context);

        // Assert
        Assert.That(result.IsSuccess, Is.True);
        Assert.That(result.IsCriticalSuccess, Is.True);
        Assert.That(result.HasSalvage, Is.True);
        Assert.That(result.SalvagedComponent, Is.Not.Null);
    }

    [Test]
    public void Fumble_CreatesMechanismJammedConsequence()
    {
        // Arrange
        var player = CreateTestPlayer();
        var context = new LockContext("test-lock", LockType.StandardLock, toolQuality: ToolQuality.Proper);

        SetupFumbleCheck();

        // Act
        var result = _service.AttemptLockpick(player, context);

        // Assert
        Assert.That(result.IsSuccess, Is.False);
        Assert.That(result.IsFumble, Is.True);
        Assert.That(result.FumbleConsequence, Is.Not.Null);
        Assert.That(result.UpdatedContext, Is.Not.Null);
        Assert.That(result.UpdatedContext!.IsJammed, Is.True);

        _mockFumbleService.Verify(
            s => s.CreateConsequence(
                It.IsAny<string>(),
                "lockpicking",
                FumbleType.MechanismJammed,
                "test-lock",
                It.IsAny<string>()),
            Times.Once);
    }

    private Player CreateTestPlayer()
    {
        // Create a test player with lockpicking skill
        return Player.Create("Test Player", /* attributes */);
    }

    private void SetupCriticalSuccessCheck()
    {
        _mockSkillCheckService
            .Setup(s => s.PerformCheckWithDC(
                It.IsAny<Player>(),
                "lockpicking",
                It.IsAny<int>(),
                It.IsAny<string>(),
                It.IsAny<SkillContext>()))
            .Returns(CreateCheckResult(SkillOutcome.CriticalSuccess));
    }

    private void SetupFumbleCheck()
    {
        _mockSkillCheckService
            .Setup(s => s.PerformCheckWithDC(
                It.IsAny<Player>(),
                "lockpicking",
                It.IsAny<int>(),
                It.IsAny<string>(),
                It.IsAny<SkillContext>()))
            .Returns(CreateCheckResult(SkillOutcome.CriticalFailure, isFumble: true));

        _mockFumbleService
            .Setup(s => s.CreateConsequence(
                It.IsAny<string>(),
                It.IsAny<string>(),
                It.IsAny<FumbleType>(),
                It.IsAny<string>(),
                It.IsAny<string>()))
            .Returns(CreateFumbleConsequence());
    }

    private SkillCheckResult CreateCheckResult(SkillOutcome outcome, bool isFumble = false)
    {
        // Create a mock skill check result with the specified outcome
        return new SkillCheckResult(/* ... */);
    }

    private FumbleConsequence CreateFumbleConsequence()
    {
        // Create a mock fumble consequence
        return FumbleConsequence.Create(/* ... */);
    }
}
```

---

## 14. Use Cases

### 14.1 UC-1504a-001: Pick a Standard Lock

**Actor:** Player
**Flow:** Player targets locked container → System validates tools → Skill check performed → Lock opens

**Details:**
1. Player issues `pick lock` command on locked chest
2. System creates `LockContext` from chest's lock properties
3. System validates player has [Tinker's Toolkit]
4. `LockpickingService.AttemptLockpick()` called
5. `SkillCheckService` performs check with context modifiers
6. On success, chest marked as unlocked
7. Player receives success narrative

### 14.2 UC-1504a-002: Critical Success with Salvage

**Actor:** Player
**Flow:** Player picks lock → Critical success → Lock opens + component salvaged

**Details:**
1. Player picks a ComplexLock
2. Skill check results in 5+ net successes (Critical)
3. System selects random component from salvage table
4. [Circuit Fragment] added to player inventory
5. Player receives enhanced narrative with salvage mention

### 14.3 UC-1504a-003: Fumble Causes Mechanism Jam

**Actor:** Player
**Flow:** Player picks lock → Fumble → [Mechanism Jammed] applied

**Details:**
1. Player attempts lockpicking on StandardLock
2. Dice result: 0 successes, 1+ botches (Fumble)
3. `FumbleConsequenceService.CreateConsequence()` called
4. Lock entity marked as jammed (DC +2 permanent)
5. Associated key marked as incompatible
6. Player receives fumble narrative with consequence explanation

### 14.4 UC-1504a-004: Tool Requirement Blocks Attempt

**Actor:** Player
**Flow:** Player attempts pick without tools → Attempt blocked

**Details:**
1. Player targets StandardLock (DC 14)
2. Player lacks [Tinker's Toolkit]
3. `CanAttempt()` returns false
4. System displays: "You need proper tools to attempt this lock."
5. No skill check performed

---

## 15. Deliverable Checklist

### 15.1 Domain Layer

- [ ] `LockType.cs` enum created in `Enums/`
- [ ] `ToolQuality.cs` enum created in `Enums/`
- [ ] `LockContext.cs` value object created in `ValueObjects/`
- [ ] `LockpickingResult.cs` value object created in `ValueObjects/`
- [ ] `SalvageableComponent.cs` value object created in `ValueObjects/`
- [ ] `ILockpickingService.cs` interface created in `Interfaces/`

### 15.2 Application Layer

- [ ] `LockpickingService.cs` created in `Services/`
- [ ] Service registered in dependency injection

### 15.3 Configuration

- [ ] `config/lock-types.json` created
- [ ] `config/lockpicking-tools.json` created
- [ ] `config/schemas/lock-types.schema.json` created
- [ ] `config/schemas/lockpicking-tools.schema.json` created
- [ ] Configuration files validate against schemas

### 15.4 Testing

- [ ] `LockpickingServiceTests.cs` created (~4 tests)
- [ ] All tests passing

### 15.5 Documentation

- [ ] XML documentation complete on all public members
- [ ] This design specification complete

---

## 16. Acceptance Criteria

### 16.1 Functional

- [ ] Lock type enum values correspond to correct base DCs
- [ ] Tool quality applies correct dice modifiers (-2 to +2)
- [ ] Corruption levels apply correct DC modifiers (+2/+4)
- [ ] [Mechanism Jammed] applies permanent +2 DC modifier
- [ ] Critical success yields salvageable component
- [ ] Fumble creates FumbleConsequence with MechanismJammed type
- [ ] Tool requirements block attempts without proper equipment
- [ ] LockContext correctly converts to SkillContext

### 16.2 Quality

- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] All ~4 new unit tests pass
- [ ] Configuration files validate against schemas
- [ ] XML documentation complete on all public members

---

## 17. Dependencies

### 17.1 Required from Previous Versions

| Version | Component | Usage |
|---------|-----------|-------|
| v0.15.0 | `DiceRollResult` | Success/botch counting |
| v0.15.0 | `DiceService` | Dice rolling |
| v0.15.0c | `SkillCheckService` | Check execution |
| v0.15.0c | `SkillOutcome` | Outcome classification |
| v0.15.1a | `SkillContext` | Modifier aggregation |
| v0.15.1a | `EquipmentModifier` | Tool bonuses |
| v0.15.1b | `FumbleConsequence` | Consequence tracking |
| v0.15.1b | `FumbleType` | MechanismJammed enum value |
| v0.10.x | `CorruptionTier` | Lock corruption level |

### 17.2 Provides to Future Versions

| Version | Component | Usage |
|---------|-----------|-------|
| v0.15.4b | Terminal Hacking | Similar procedural bypass pattern |
| v0.15.4d | Trap Disarmament | Tool requirements pattern |
| v0.15.4g | Improvised Tools | Craftable lockpicks |
| v0.15.4i | Specialization | Scrap-Tinker abilities for locks |

---

## 18. Future Considerations

### 18.1 Deferred to v0.15.4b (Terminal Hacking)

- Multi-layer infiltration state machine
- ICE countermeasure system
- Access level progression

### 18.2 Deferred to v0.15.4g (Improvised Tool Crafting)

- Shim pick crafting from scrap
- Tool quality improvement
- Component requirements

### 18.3 Deferred to v0.15.4i (Specialization Integration)

- Scrap-Tinker [Master Craftsman] ability for masterwork tools
- Scrap-Tinker [Relock] ability to re-lock bypassed locks

### 18.4 Out of Scope

- Lock entity definition (container system responsibility)
- Key/keyhole mechanics (inventory system)
- Brute force alternative (v0.15.4h)
- UI for lockpicking minigame (future version)

---

## 19. Document Metadata

---

*Document Version: 1.1*
*Last Updated: 2026-01-18*
*Author: Claude*

---

### Revision History

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 2026-01-17 | Claude | Initial design specification |
| 1.1 | 2026-01-18 | Claude | Added service interaction diagram, JSON schema specifications |

---

*This design specification provides the detailed blueprint for implementing v0.15.4a Lockpicking System. This establishes the foundational patterns for all System Bypass subsystems in v0.15.4.*
