# v0.14.2a Design Specification: Weapon Schema

**Version:** 0.14.2a
**Parent:** v0.14.2 (Equipment Configuration Schemas)
**Prerequisites:** v0.14.1 Complete (Combat Configuration Schemas)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Weapon Schema Definition](#4-weapon-schema-definition)
   - 4.1 [Root Configuration Properties](#41-root-configuration-properties)
   - 4.2 [WeaponDefinition Definition](#42-weapondefinition-definition)
   - 4.3 [StatBonuses Definition](#43-statbonuses-definition)
   - 4.4 [WeaponRange Definition](#44-weaponrange-definition)
5. [Weapon Type Configuration](#5-weapon-type-configuration)
   - 5.1 [Weapon Type Enumeration](#51-weapon-type-enumeration)
   - 5.2 [Weapon Type Characteristics](#52-weapon-type-characteristics)
6. [Weapon Property Configuration](#6-weapon-property-configuration)
   - 6.1 [Property Definitions](#61-property-definitions)
   - 6.2 [Property Combinations](#62-property-combinations)
7. [Proficiency and Quality Configuration](#7-proficiency-and-quality-configuration)
   - 7.1 [Proficiency Categories](#71-proficiency-categories)
   - 7.2 [Material Types](#72-material-types)
   - 7.3 [Quality Tiers](#73-quality-tiers)
8. [Damage Dice Configuration](#8-damage-dice-configuration)
   - 8.1 [Dice Expression Pattern](#81-dice-expression-pattern)
   - 8.2 [Damage Type Reference](#82-damage-type-reference)
9. [Validation Rules](#9-validation-rules)
   - 9.1 [Enum Validation](#91-enum-validation)
   - 9.2 [Range Validation](#92-range-validation)
   - 9.3 [Required Fields](#93-required-fields)
   - 9.4 [Pattern Validation](#94-pattern-validation)
10. [Configuration Schema](#10-configuration-schema)
11. [Configuration File Updates](#11-configuration-file-updates)
12. [Data Model Changes](#12-data-model-changes)
13. [Logging Specifications](#13-logging-specifications)
14. [Unit Testing Requirements](#14-unit-testing-requirements)
15. [Use Cases](#15-use-cases)
16. [Deliverable Checklist](#16-deliverable-checklist)
17. [Acceptance Criteria](#17-acceptance-criteria)
18. [Dependencies](#18-dependencies)
19. [Future Considerations](#19-future-considerations)

---

## 1. Executive Summary

Version 0.14.2a introduces the **Weapon Schema** (`weapons.schema.json`), which validates weapon configuration including damage dice expressions, weapon types, attack modifiers, stat bonuses, weapon properties, proficiency categories, material types, and quality tiers. This schema enables full customization of the weapon system without code changes, supporting different weapon styles from medieval fantasy to sci-fi or custom settings.

The Weapon Schema validates damage dice patterns (e.g., "1d8", "2d6+3"), weapon type enumerations, attack modifier integers, stat bonus objects, weapon property arrays, proficiency categories (Simple, Martial, Exotic), material types, quality tiers (Common through Legendary), and range properties for ranged weapons.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Schema Files** | `weapons.schema.json` |
| **Schema Definitions** | `WeaponDefinition`, `StatBonuses`, `WeaponRange` |
| **Configuration Updates** | Update `weapons.json` with full schema reference |
| **Tests** | ~5 new unit tests |

### Architectural Significance

This version provides:
- **Damage dice pattern** - Regex validation for dice expressions (1d8, 2d6+3, 1d4-1)
- **Weapon type system** - Enumeration of all weapon categories
- **Weapon property system** - Mechanical properties affecting combat behavior
- **Proficiency categories** - Training requirements for effective use
- **Material progression** - Material quality affecting weapon stats
- **Quality tier system** - Rarity and power classification
- **Range configuration** - Min/optimal/max range for ranged weapons
- **Stat bonus system** - Attribute modifiers provided by weapons

### Relationship to Other Schemas

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    v0.14.2 EQUIPMENT CONFIGURATION SCHEMAS                   │
└─────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────┐
  │  v0.14.2a: weapons.schema.json ◀── THIS VERSION                          │
  │  v0.14.2b: armor.schema.json                                             │
  │  v0.14.2c: items.schema.json                                             │
  │  v0.14.2d: loot-tables.schema.json                                       │
  └─────────────────────────────────────────────────────────────────────────┘

  Cross-references:
  • abilities.json → weapon-based abilities reference weapon types
  • damage-types.json → damageType field references damage type IDs
  • loot-tables.json → itemId references weapon IDs
  • monsters.json → equipment drops reference weapon IDs

  All schemas share:
  • JSON Schema Draft-07 format
  • ID pattern: ^[a-z][a-z0-9_]*$ (underscore convention for equipment)
  • Schema location: config/schemas/
  • Required field enforcement
  • IDE autocomplete support
```

---

## 2. Feature Overview

```
v0.14.2a Weapon Schema Features
├── weapons.schema.json
│   ├── Root Configuration Properties
│   │   ├── $schema (string, optional)
│   │   ├── version (string, optional)
│   │   └── weapons (array of WeaponDefinition, required)
│   └── Definitions
│       ├── WeaponDefinition
│       │   ├── id (string, underscore pattern, required)
│       │   ├── name (string, minLength: 1, required)
│       │   ├── description (string, required)
│       │   ├── weaponType (enum, required)
│       │   ├── damageDice (string, dice pattern, required)
│       │   ├── damageType (string, optional)
│       │   ├── attackModifier (integer, default: 0)
│       │   ├── statBonuses (StatBonuses, optional)
│       │   ├── properties (array of enum, optional)
│       │   ├── proficiency (enum, default: Simple)
│       │   ├── material (enum, optional)
│       │   ├── quality (enum, default: Common)
│       │   ├── range (WeaponRange, optional)
│       │   ├── isTwoHanded (boolean, default: false)
│       │   ├── value (integer, minimum: 0, required)
│       │   └── sortOrder (integer, minimum: 0, optional)
│       ├── StatBonuses
│       │   ├── might (integer, optional)
│       │   ├── fortitude (integer, optional)
│       │   ├── will (integer, optional)
│       │   ├── wits (integer, optional)
│       │   ├── finesse (integer, optional)
│       │   └── additionalProperties (integer)
│       └── WeaponRange
│           ├── minimum (integer, minimum: 1)
│           ├── optimal (integer, minimum: 1)
│           └── maximum (integer, minimum: 1)
├── Validation Rules
│   ├── Weapon Type Enum Validation
│   ├── Damage Dice Pattern Validation
│   ├── Proficiency Enum Validation
│   ├── Quality Tier Enum Validation
│   ├── Weapon Property Enum Validation
│   ├── Material Type Enum Validation
│   └── ID Pattern Validation (underscore)
└── Configuration Updates
    └── weapons.json schema reference updated
```

---

## 3. Architecture Diagrams

### 3.1 Schema Validation Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         SCHEMA VALIDATION FLOW                               │
└─────────────────────────────────────────────────────────────────────────────┘

    User edits weapons.json
           │
           ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                          IDE/EDITOR                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│  1. Reads $schema property from config file                                  │
│  2. Loads weapons.schema.json from config/schemas/                           │
│  3. Validates content against schema                                         │
└─────────────────────────────────────────────────────────────────────────────┘
           │
           ├─── Valid ───▶ Green checkmark, autocomplete works
           │
           └─── Invalid ─▶ Error underlines with messages:
                           • "weaponType must be one of: Sword, Axe, ..."
                           • "damageDice must match pattern ^\d+d\d+..."
                           • "id must match pattern ^[a-z][a-z0-9_]*$"
                           • "value must be >= 0"
```

### 3.2 Weapon Schema Structure Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          weapons.schema.json                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│  $schema: "http://json-schema.org/draft-07/schema#"                         │
│  title: "Weapon Configuration"                                              │
│  type: object                                                                │
├─────────────────────────────────────────────────────────────────────────────┤
│  properties:                                                                 │
│  ┌─────────────────────────┬─────────────────────────────────────────────┐  │
│  │ $schema                 │ type: string (optional)                     │  │
│  ├─────────────────────────┼─────────────────────────────────────────────┤  │
│  │ version                 │ type: string (optional)                     │  │
│  ├─────────────────────────┼─────────────────────────────────────────────┤  │
│  │ weapons                 │ type: array, items: $ref WeaponDefinition   │  │
│  └─────────────────────────┴─────────────────────────────────────────────┘  │
├─────────────────────────────────────────────────────────────────────────────┤
│  definitions:                                                                │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ WeaponDefinition                                                     │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ id                    │ string, pattern: ^[a-z][a-z0-9_]*$    │   │    │
│  │ │ name                  │ string, minLength: 1                   │   │    │
│  │ │ description           │ string                                 │   │    │
│  │ │ weaponType            │ enum: Sword, Axe, Dagger, ...          │   │    │
│  │ │ damageDice            │ string, pattern: ^\d+d\d+([+-]\d+)?$   │   │    │
│  │ │ damageType            │ string (optional)                      │   │    │
│  │ │ attackModifier        │ integer, default: 0                    │   │    │
│  │ │ statBonuses           │ $ref StatBonuses (optional)            │   │    │
│  │ │ properties            │ array of enum (optional)               │   │    │
│  │ │ proficiency           │ enum: Simple, Martial, Exotic          │   │    │
│  │ │ material              │ enum (optional)                        │   │    │
│  │ │ quality               │ enum: Common, Uncommon, ...            │   │    │
│  │ │ range                 │ $ref WeaponRange (optional)            │   │    │
│  │ │ isTwoHanded           │ boolean, default: false                │   │    │
│  │ │ value                 │ integer, minimum: 0                    │   │    │
│  │ │ sortOrder             │ integer, minimum: 0 (optional)         │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ StatBonuses                                                          │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ might                 │ integer (optional)                     │   │    │
│  │ │ fortitude             │ integer (optional)                     │   │    │
│  │ │ will                  │ integer (optional)                     │   │    │
│  │ │ wits                  │ integer (optional)                     │   │    │
│  │ │ finesse               │ integer (optional)                     │   │    │
│  │ │ additionalProperties  │ integer (for custom stats)             │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ WeaponRange                                                          │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ minimum               │ integer, minimum: 1                    │   │    │
│  │ │ optimal               │ integer, minimum: 1                    │   │    │
│  │ │ maximum               │ integer, minimum: 1                    │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Weapon Type Hierarchy Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         WEAPON TYPE HIERARCHY                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                         MELEE WEAPONS                                │    │
│  │  Close-quarters combat weapons requiring direct contact              │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Weapon Types:                                                       │    │
│  │  • Sword - Bladed slashing/thrusting weapons (Martial)               │    │
│  │  • Axe - Chopping weapons with weighted heads (Martial)              │    │
│  │  • Dagger - Small piercing weapons (Simple)                          │    │
│  │  • Mace - Blunt crushing weapons (Simple)                            │    │
│  │  • Spear - Polearm piercing weapons (Simple)                         │    │
│  │  • Hammer - Heavy blunt weapons (Martial)                            │    │
│  │  • Staff - Long wooden implements (Simple)                           │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                        RANGED WEAPONS                                │    │
│  │  Distance combat weapons using projectiles                           │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Weapon Types:                                                       │    │
│  │  • Bow - String-drawn projectile weapons (Martial)                   │    │
│  │  • Crossbow - Mechanical bolt weapons (Martial)                      │    │
│  │  • Thrown* - Melee weapons with thrown property                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                        MAGICAL WEAPONS                               │    │
│  │  Implements for channeling magical energy                            │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Weapon Types:                                                       │    │
│  │  • Staff - Magical focusing staves (Simple)                          │    │
│  │  • Wand - Small magical implements (Exotic)                          │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 Damage Dice Pattern Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        DAMAGE DICE PATTERN                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  PATTERN: ^\d+d\d+([+-]\d+)?$                                                │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │  STRUCTURE:   [count]d[sides][modifier]                              │   │
│  │                                                                      │   │
│  │  ┌─────────┐   ┌─────────┐   ┌───────────────────────┐              │   │
│  │  │ count   │ d │ sides   │   │ modifier (optional)   │              │   │
│  │  │ \d+     │   │ \d+     │   │ [+-]\d+               │              │   │
│  │  └─────────┘   └─────────┘   └───────────────────────┘              │   │
│  │                                                                      │   │
│  │  Examples:                                                           │   │
│  │  • "1d8"     → Roll 1 eight-sided die                               │   │
│  │  • "2d6"     → Roll 2 six-sided dice                                │   │
│  │  • "1d8+1"   → Roll 1d8, add 1                                      │   │
│  │  • "2d6+3"   → Roll 2d6, add 3                                      │   │
│  │  • "1d4-1"   → Roll 1d4, subtract 1 (minimum 1)                     │   │
│  │  • "1d10"    → Roll 1 ten-sided die                                 │   │
│  │  • "1d12"    → Roll 1 twelve-sided die                              │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│  COMMON WEAPON DAMAGE DICE                                                   │
│  ┌──────────────────┬────────────────────────────────────────────────────┐  │
│  │ Dice             │ Typical Weapons                                    │  │
│  ├──────────────────┼────────────────────────────────────────────────────┤  │
│  │ 1d4              │ Daggers, small weapons                             │  │
│  │ 1d6              │ Short swords, staves, maces                        │  │
│  │ 1d8              │ Longswords, battle axes, warhammers                │  │
│  │ 1d10             │ Heavy weapons, halberds                            │  │
│  │ 1d12             │ Greataxes, massive weapons                         │  │
│  │ 2d6              │ Greatswords (two dice for variance)                │  │
│  └──────────────────┴────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.5 Quality and Proficiency System Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    QUALITY AND PROFICIENCY SYSTEM                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  PROFICIENCY CATEGORIES                                                      │
│  ┌────────────────┬────────────────────────────────────────────────────┐    │
│  │ Category       │ Description                                        │    │
│  ├────────────────┼────────────────────────────────────────────────────┤    │
│  │ Simple         │ Basic weapons anyone can use effectively           │    │
│  │                │ Examples: Dagger, Mace, Staff, Spear               │    │
│  ├────────────────┼────────────────────────────────────────────────────┤    │
│  │ Martial        │ Military weapons requiring training                │    │
│  │                │ Examples: Sword, Axe, Bow, Crossbow, Hammer        │    │
│  ├────────────────┼────────────────────────────────────────────────────┤    │
│  │ Exotic         │ Unusual weapons requiring specialized training     │    │
│  │                │ Examples: Wand, unusual cultural weapons           │    │
│  └────────────────┴────────────────────────────────────────────────────┘    │
│                                                                              │
│  QUALITY TIERS                                                               │
│  ┌────────────────┬────────┬─────────────────────────────────────────────┐  │
│  │ Tier           │ Color  │ Characteristics                             │  │
│  ├────────────────┼────────┼─────────────────────────────────────────────┤  │
│  │ Common         │ White  │ Standard weapons, widely available         │  │
│  ├────────────────┼────────┼─────────────────────────────────────────────┤  │
│  │ Uncommon       │ Green  │ Well-crafted, minor bonuses                 │  │
│  ├────────────────┼────────┼─────────────────────────────────────────────┤  │
│  │ Rare           │ Blue   │ Exceptional quality, significant bonuses   │  │
│  ├────────────────┼────────┼─────────────────────────────────────────────┤  │
│  │ Epic           │ Purple │ Masterwork quality, powerful effects       │  │
│  ├────────────────┼────────┼─────────────────────────────────────────────┤  │
│  │ Legendary      │ Orange │ Unique weapons, extraordinary power        │  │
│  └────────────────┴────────┴─────────────────────────────────────────────┘  │
│                                                                              │
│  MATERIAL TYPES                                                              │
│  ┌────────────────┬─────────────────────────────────────────────────────┐   │
│  │ Material       │ Characteristics                                     │   │
│  ├────────────────┼─────────────────────────────────────────────────────┤   │
│  │ Wood           │ Basic material for staves, bows                     │   │
│  │ Iron           │ Common metal, standard weapons                      │   │
│  │ Steel          │ Superior metal, well-balanced                       │   │
│  │ Mithril        │ Lightweight magical metal                           │   │
│  │ Adamantine     │ Extremely hard, penetrating                         │   │
│  └────────────────┴─────────────────────────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.6 Weapon Range System Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        WEAPON RANGE SYSTEM                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  RANGE ZONES (for ranged weapons)                                            │
│                                                                              │
│     ┌─────────┐      ┌─────────────────┐      ┌─────────────────┐           │
│     │  MIN    │      │     OPTIMAL     │      │      MAX        │           │
│     │ Range   │      │     Range       │      │     Range       │           │
│     └────┬────┘      └────────┬────────┘      └────────┬────────┘           │
│          │                    │                        │                     │
│  ────────┼────────────────────┼────────────────────────┼────────────────    │
│          │                    │                        │                     │
│     0    1    2    3    4    5    6    7    8    9    10   11   12          │
│          │◀─────────────────────────────────────────────▶│                   │
│          │                    │                        │                     │
│          │    PENALTY ZONE    │    OPTIMAL ZONE        │   PENALTY ZONE     │
│          │                    │                        │                     │
│          └────────────────────┴────────────────────────┘                     │
│                                                                              │
│  RANGE CONFIGURATION EXAMPLE                                                 │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │ {                                                                    │   │
│  │   "range": {                                                         │   │
│  │     "minimum": 2,   // Too close = penalty                           │   │
│  │     "optimal": 6,   // Best accuracy range                           │   │
│  │     "maximum": 12   // Beyond this = cannot hit                      │   │
│  │   }                                                                  │   │
│  │ }                                                                    │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│  TYPICAL RANGES BY WEAPON TYPE                                               │
│  ┌────────────────┬─────────┬─────────┬─────────────────────────────────┐   │
│  │ Weapon Type    │ Min     │ Optimal │ Max                             │   │
│  ├────────────────┼─────────┼─────────┼─────────────────────────────────┤   │
│  │ Shortbow       │ 2       │ 4       │ 8                               │   │
│  │ Longbow        │ 3       │ 6       │ 12                              │   │
│  │ Crossbow       │ 2       │ 5       │ 10                              │   │
│  │ Thrown Dagger  │ 1       │ 2       │ 4                               │   │
│  │ Thrown Spear   │ 1       │ 3       │ 6                               │   │
│  └────────────────┴─────────┴─────────┴─────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.7 File Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            CONFIG LAYER                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  config/                                                                     │
│  ├── weapons.json ◀──────────────────────────────┐                          │
│  │   {                                            │ references              │
│  │     "$schema": "./schemas/weapons.schema.json",│                          │
│  │     "weapons": [                               │                          │
│  │       {                                        │                          │
│  │         "id": "rusty_sword",                   │                          │
│  │         "name": "Rusty Sword",                 │                          │
│  │         "weaponType": "Sword",                 │                          │
│  │         "damageDice": "1d8",                   │                          │
│  │         "value": 5                             │                          │
│  │       },                                       │                          │
│  │       {                                        │                          │
│  │         "id": "steel_sword",                   │                          │
│  │         "name": "Steel Sword",                 │                          │
│  │         "weaponType": "Sword",                 │                          │
│  │         "damageDice": "1d8+1",                 │                          │
│  │         "proficiency": "Martial",              │                          │
│  │         "material": "Steel",                   │                          │
│  │         "quality": "Uncommon",                 │                          │
│  │         "value": 150                           │                          │
│  │       },                                       │                          │
│  │       ...                                      │                          │
│  │     ]                                          │                          │
│  │   }                                            │                          │
│  │                                                │                          │
│  └── schemas/                                     │                          │
│      └── weapons.schema.json ────────────────────┘                          │
│          {                                                                   │
│            "$schema": "http://json-schema.org/draft-07/schema#",            │
│            "definitions": {                                                  │
│              "WeaponDefinition": {...},                                      │
│              "StatBonuses": {...},                                           │
│              "WeaponRange": {...}                                            │
│            }                                                                 │
│          }                                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Weapon Schema Definition

### 4.1 Root Configuration Properties

**File:** `config/schemas/weapons.schema.json`

The weapon schema follows JSON Schema Draft-07 specification, providing comprehensive validation for weapon configuration files.

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Weapon Configuration",
    "description": "Schema for weapon definitions. Defines all weapons including melee, ranged, and magical implements with their damage, properties, and requirements.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
        },
        "weapons": {
            "type": "array",
            "description": "List of weapon definitions",
            "items": {
                "$ref": "#/definitions/WeaponDefinition"
            },
            "minItems": 1
        }
    },
    "required": ["weapons"],
    "additionalProperties": false,
    "definitions": {
        "WeaponDefinition": { ... },
        "StatBonuses": { ... },
        "WeaponRange": { ... }
    }
}
```

### 4.2 WeaponDefinition Definition

The `WeaponDefinition` object defines a complete weapon with all its properties.

```json
"WeaponDefinition": {
    "type": "object",
    "description": "A weapon that can be equipped and used in combat",
    "properties": {
        "id": {
            "type": "string",
            "description": "Unique identifier for the weapon (lowercase with underscores)",
            "pattern": "^[a-z][a-z0-9_]*$",
            "minLength": 1,
            "maxLength": 50
        },
        "name": {
            "type": "string",
            "description": "Display name shown to players",
            "minLength": 1,
            "maxLength": 100
        },
        "description": {
            "type": "string",
            "description": "Full description of the weapon",
            "minLength": 1
        },
        "weaponType": {
            "type": "string",
            "description": "The category of weapon",
            "enum": ["Sword", "Axe", "Dagger", "Staff", "Bow", "Mace", "Spear", "Hammer", "Crossbow", "Wand"]
        },
        "damageDice": {
            "type": "string",
            "description": "Dice expression for damage (e.g., '1d8', '2d6+3')",
            "pattern": "^\\d+d\\d+([+-]\\d+)?$"
        },
        "damageType": {
            "type": "string",
            "description": "Reference to damage type ID from damage-types.json",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "attackModifier": {
            "type": "integer",
            "description": "Bonus or penalty to attack rolls",
            "default": 0
        },
        "statBonuses": {
            "$ref": "#/definitions/StatBonuses"
        },
        "properties": {
            "type": "array",
            "description": "Special properties affecting weapon behavior",
            "items": {
                "type": "string",
                "enum": ["finesse", "versatile", "reach", "thrown", "two-handed", "light", "heavy", "loading"]
            },
            "uniqueItems": true
        },
        "proficiency": {
            "type": "string",
            "description": "Training category required for effective use",
            "enum": ["Simple", "Martial", "Exotic"],
            "default": "Simple"
        },
        "material": {
            "type": "string",
            "description": "Material the weapon is made from",
            "enum": ["Wood", "Iron", "Steel", "Mithril", "Adamantine"]
        },
        "quality": {
            "type": "string",
            "description": "Quality tier affecting rarity and power",
            "enum": ["Common", "Uncommon", "Rare", "Epic", "Legendary"],
            "default": "Common"
        },
        "range": {
            "$ref": "#/definitions/WeaponRange"
        },
        "isTwoHanded": {
            "type": "boolean",
            "description": "Whether the weapon requires both hands",
            "default": false
        },
        "value": {
            "type": "integer",
            "description": "Base value in gold pieces",
            "minimum": 0
        },
        "sortOrder": {
            "type": "integer",
            "description": "Order for display sorting (lower values first)",
            "minimum": 0,
            "default": 0
        }
    },
    "required": ["id", "name", "description", "weaponType", "damageDice", "value"],
    "additionalProperties": false
}
```

### 4.3 StatBonuses Definition

The `StatBonuses` object defines attribute modifiers provided by the weapon.

```json
"StatBonuses": {
    "type": "object",
    "description": "Attribute bonuses provided by equipping the weapon",
    "properties": {
        "might": {
            "type": "integer",
            "description": "Bonus to Might attribute"
        },
        "fortitude": {
            "type": "integer",
            "description": "Bonus to Fortitude attribute"
        },
        "will": {
            "type": "integer",
            "description": "Bonus to Will attribute"
        },
        "wits": {
            "type": "integer",
            "description": "Bonus to Wits attribute"
        },
        "finesse": {
            "type": "integer",
            "description": "Bonus to Finesse attribute"
        }
    },
    "additionalProperties": {
        "type": "integer",
        "description": "Custom stat bonus"
    }
}
```

### 4.4 WeaponRange Definition

The `WeaponRange` object defines range parameters for ranged weapons.

```json
"WeaponRange": {
    "type": "object",
    "description": "Range parameters for ranged weapons",
    "properties": {
        "minimum": {
            "type": "integer",
            "description": "Minimum effective range (tiles closer than this have penalty)",
            "minimum": 1,
            "default": 1
        },
        "optimal": {
            "type": "integer",
            "description": "Optimal range with no penalties",
            "minimum": 1
        },
        "maximum": {
            "type": "integer",
            "description": "Maximum range (cannot attack beyond this)",
            "minimum": 1
        }
    },
    "required": ["optimal", "maximum"],
    "additionalProperties": false
}
```

---

## 5. Weapon Type Configuration

### 5.1 Weapon Type Enumeration

The weapon type enumeration categorizes weapons by their combat style and mechanics.

| Weapon Type | Description | Default Proficiency | Typical Damage |
|-------------|-------------|---------------------|----------------|
| `Sword` | Bladed slashing/thrusting weapons | Martial | 1d8 |
| `Axe` | Chopping weapons with weighted heads | Martial | 1d10 |
| `Dagger` | Small piercing weapons | Simple | 1d4 |
| `Staff` | Long wooden implements, magical focus | Simple | 1d6 |
| `Bow` | String-drawn projectile weapons | Martial | 1d6 |
| `Mace` | Blunt crushing weapons | Simple | 1d6 |
| `Spear` | Polearm piercing weapons | Simple | 1d6 |
| `Hammer` | Heavy blunt weapons | Martial | 1d8 |
| `Crossbow` | Mechanical bolt weapons | Martial | 1d8 |
| `Wand` | Small magical implements | Exotic | 1d4 |

### 5.2 Weapon Type Characteristics

**Melee Weapons:**
```json
{
    "id": "steel_sword",
    "name": "Steel Sword",
    "description": "A finely crafted steel sword with excellent balance.",
    "weaponType": "Sword",
    "damageDice": "1d8+1",
    "proficiency": "Martial",
    "material": "Steel",
    "quality": "Uncommon",
    "value": 150
}
```

**Ranged Weapons:**
```json
{
    "id": "longbow",
    "name": "Longbow",
    "description": "A tall bow capable of powerful shots at long range.",
    "weaponType": "Bow",
    "damageDice": "1d8",
    "proficiency": "Martial",
    "material": "Wood",
    "isTwoHanded": true,
    "range": {
        "minimum": 3,
        "optimal": 6,
        "maximum": 12
    },
    "value": 75
}
```

**Magical Weapons:**
```json
{
    "id": "arcane_staff",
    "name": "Arcane Staff",
    "description": "A staff crackling with magical energy.",
    "weaponType": "Staff",
    "damageDice": "1d6+1",
    "damageType": "arcane",
    "statBonuses": { "will": 4 },
    "proficiency": "Simple",
    "quality": "Rare",
    "value": 300
}
```

---

## 6. Weapon Property Configuration

### 6.1 Property Definitions

Weapon properties modify combat behavior and requirements.

| Property | Description | Mechanical Effect |
|----------|-------------|-------------------|
| `finesse` | Can use Finesse instead of Might | Attack uses higher of Might/Finesse |
| `versatile` | Can be used one or two-handed | +1 damage die size when two-handed |
| `reach` | Extended attack range | +1 tile attack range |
| `thrown` | Can be thrown for ranged attack | Gains range when thrown |
| `two-handed` | Requires both hands | Cannot use with shield |
| `light` | Favorable for dual-wielding | Reduced dual-wield penalty |
| `heavy` | Difficult for small creatures | Penalty for small creatures |
| `loading` | Requires action to reload | Limits attacks per turn |

### 6.2 Property Combinations

Common property combinations:

| Weapon Example | Properties | Effect |
|----------------|------------|--------|
| Rapier | `finesse` | Dexterity-based attack |
| Longsword | `versatile` | 1d8 or 1d10 two-handed |
| Halberd | `reach`, `two-handed` | Extended range, both hands |
| Dagger | `finesse`, `light`, `thrown` | Multi-purpose small weapon |
| Greataxe | `two-handed`, `heavy` | Maximum damage, restrictions |
| Heavy Crossbow | `two-handed`, `loading`, `heavy` | High damage, slow fire |

**Property Example:**
```json
{
    "id": "rapier",
    "name": "Rapier",
    "description": "A thin, pointed sword ideal for quick thrusts.",
    "weaponType": "Sword",
    "damageDice": "1d8",
    "properties": ["finesse"],
    "proficiency": "Martial",
    "material": "Steel",
    "value": 100
}
```

---

## 7. Proficiency and Quality Configuration

### 7.1 Proficiency Categories

Training requirements affect weapon effectiveness.

| Category | Description | Penalty Without |
|----------|-------------|-----------------|
| `Simple` | Basic weapons anyone can use | None |
| `Martial` | Military weapons requiring training | -4 to attack |
| `Exotic` | Unusual weapons requiring specialized training | Cannot use |

### 7.2 Material Types

Material quality affects weapon durability and damage.

| Material | Description | Typical Quality | Bonus |
|----------|-------------|-----------------|-------|
| `Wood` | Basic organic material | Common | None |
| `Iron` | Common metal | Common | None |
| `Steel` | Superior metal alloy | Uncommon | +1 damage |
| `Mithril` | Lightweight magical metal | Rare | Light property |
| `Adamantine` | Extremely hard metal | Epic | Armor penetration |

### 7.3 Quality Tiers

Rarity and power classification.

| Quality | Color | Drop Rate | Value Multiplier | Typical Bonuses |
|---------|-------|-----------|------------------|-----------------|
| `Common` | White | 100% | 1.0x | None |
| `Uncommon` | Green | 50% | 2.0x | +1 to stat |
| `Rare` | Blue | 20% | 5.0x | +2 to stats, property |
| `Epic` | Purple | 5% | 20.0x | +3 to stats, special |
| `Legendary` | Orange | 1% | 100.0x | Unique effects |

**Quality Example:**
```json
{
    "id": "flamebrand",
    "name": "Flamebrand",
    "description": "A legendary sword wreathed in eternal flames.",
    "weaponType": "Sword",
    "damageDice": "1d8+3",
    "damageType": "fire",
    "statBonuses": { "might": 2, "will": 2 },
    "proficiency": "Martial",
    "material": "Steel",
    "quality": "Legendary",
    "value": 5000
}
```

---

## 8. Damage Dice Configuration

### 8.1 Dice Expression Pattern

The damage dice pattern validates standard RPG dice notation.

**Pattern:** `^\d+d\d+([+-]\d+)?$`

| Component | Description | Examples |
|-----------|-------------|----------|
| `\d+` | Number of dice (1 or more digits) | 1, 2, 3 |
| `d` | Dice separator | d |
| `\d+` | Die sides (1 or more digits) | 4, 6, 8, 10, 12, 20 |
| `([+-]\d+)?` | Optional modifier | +1, +2, -1, +3 |

**Valid Examples:**
- `1d4` - Single d4
- `1d6` - Single d6
- `1d8` - Single d8
- `1d10` - Single d10
- `1d12` - Single d12
- `2d6` - Two d6 (greatsword)
- `1d8+1` - d8 plus 1
- `2d6+3` - Two d6 plus 3
- `1d4-1` - d4 minus 1

**Invalid Examples:**
- `d8` - Missing count
- `1d` - Missing sides
- `1d8++1` - Double modifier
- `1d8 + 1` - Spaces not allowed

### 8.2 Damage Type Reference

Weapons can reference damage types from `damage-types.json`.

| Damage Type | Typical Weapons |
|-------------|-----------------|
| `physical` | Most weapons (default) |
| `fire` | Flaming weapons |
| `ice` | Frost weapons |
| `lightning` | Shock weapons |
| `holy` | Blessed weapons |
| `dark` | Cursed weapons |

**Damage Type Example:**
```json
{
    "id": "frostbrand",
    "name": "Frostbrand",
    "weaponType": "Sword",
    "damageDice": "1d8+2",
    "damageType": "ice",
    "value": 1000
}
```

---

## 9. Validation Rules

### 9.1 Enum Validation

| Property | Valid Values | Validation Error |
|----------|--------------|------------------|
| `weaponType` | `Sword`, `Axe`, `Dagger`, `Staff`, `Bow`, `Mace`, `Spear`, `Hammer`, `Crossbow`, `Wand` | "weaponType must be one of: Sword, Axe, ..." |
| `proficiency` | `Simple`, `Martial`, `Exotic` | "proficiency must be one of: Simple, Martial, Exotic" |
| `quality` | `Common`, `Uncommon`, `Rare`, `Epic`, `Legendary` | "quality must be one of: Common, Uncommon, ..." |
| `material` | `Wood`, `Iron`, `Steel`, `Mithril`, `Adamantine` | "material must be one of: Wood, Iron, ..." |
| `properties` (items) | `finesse`, `versatile`, `reach`, `thrown`, `two-handed`, `light`, `heavy`, `loading` | "property must be one of: finesse, versatile, ..." |

### 9.2 Range Validation

| Property | Range | Validation Error |
|----------|-------|------------------|
| `value` | >= 0 | "value must be >= 0" |
| `sortOrder` | >= 0 | "sortOrder must be >= 0" |
| `range.minimum` | >= 1 | "range.minimum must be >= 1" |
| `range.optimal` | >= 1 | "range.optimal must be >= 1" |
| `range.maximum` | >= 1 | "range.maximum must be >= 1" |
| `attackModifier` | any integer | (allows positive and negative) |

### 9.3 Required Fields

#### WeaponDefinition Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `id` | Must be present and match pattern | "missing required property 'id'" |
| `name` | Must be present and non-empty | "missing required property 'name'" |
| `description` | Must be present | "missing required property 'description'" |
| `weaponType` | Must be present and valid enum | "missing required property 'weaponType'" |
| `damageDice` | Must be present and match pattern | "missing required property 'damageDice'" |
| `value` | Must be present and >= 0 | "missing required property 'value'" |

#### WeaponRange Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `optimal` | Must be present and >= 1 | "missing required property 'optimal'" |
| `maximum` | Must be present and >= 1 | "missing required property 'maximum'" |

### 9.4 Pattern Validation

| Property | Pattern | Validation Error |
|----------|---------|------------------|
| `id` | `^[a-z][a-z0-9_]*$` | "id must match pattern ^[a-z][a-z0-9_]*$" |
| `damageDice` | `^\d+d\d+([+-]\d+)?$` | "damageDice must match pattern (e.g., '1d8', '2d6+3')" |
| `damageType` | `^[a-z][a-z0-9-]*$` | "damageType must match pattern ^[a-z][a-z0-9-]*$" |
| `version` | `^[0-9]+\.[0-9]+\.[0-9]+$` | "version must match pattern (e.g., '1.0.0')" |

---

## 10. Configuration Schema

### Complete Weapons Schema File

**File:** `config/schemas/weapons.schema.json`

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Weapon Configuration",
    "description": "Schema for weapon definitions. Defines all weapons including melee, ranged, and magical implements with their damage, properties, and requirements.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
        },
        "weapons": {
            "type": "array",
            "description": "List of weapon definitions",
            "items": {
                "$ref": "#/definitions/WeaponDefinition"
            },
            "minItems": 1
        }
    },
    "required": ["weapons"],
    "additionalProperties": false,
    "definitions": {
        "WeaponDefinition": {
            "type": "object",
            "description": "A weapon that can be equipped and used in combat",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique identifier for the weapon (lowercase with underscores)",
                    "pattern": "^[a-z][a-z0-9_]*$",
                    "minLength": 1,
                    "maxLength": 50
                },
                "name": {
                    "type": "string",
                    "description": "Display name shown to players",
                    "minLength": 1,
                    "maxLength": 100
                },
                "description": {
                    "type": "string",
                    "description": "Full description of the weapon",
                    "minLength": 1
                },
                "weaponType": {
                    "type": "string",
                    "description": "The category of weapon",
                    "enum": ["Sword", "Axe", "Dagger", "Staff", "Bow", "Mace", "Spear", "Hammer", "Crossbow", "Wand"]
                },
                "damageDice": {
                    "type": "string",
                    "description": "Dice expression for damage (e.g., '1d8', '2d6+3')",
                    "pattern": "^\\d+d\\d+([+-]\\d+)?$"
                },
                "damageType": {
                    "type": "string",
                    "description": "Reference to damage type ID from damage-types.json",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "attackModifier": {
                    "type": "integer",
                    "description": "Bonus or penalty to attack rolls",
                    "default": 0
                },
                "statBonuses": {
                    "$ref": "#/definitions/StatBonuses"
                },
                "properties": {
                    "type": "array",
                    "description": "Special properties affecting weapon behavior",
                    "items": {
                        "type": "string",
                        "enum": ["finesse", "versatile", "reach", "thrown", "two-handed", "light", "heavy", "loading"]
                    },
                    "uniqueItems": true
                },
                "proficiency": {
                    "type": "string",
                    "description": "Training category required for effective use",
                    "enum": ["Simple", "Martial", "Exotic"],
                    "default": "Simple"
                },
                "material": {
                    "type": "string",
                    "description": "Material the weapon is made from",
                    "enum": ["Wood", "Iron", "Steel", "Mithril", "Adamantine"]
                },
                "quality": {
                    "type": "string",
                    "description": "Quality tier affecting rarity and power",
                    "enum": ["Common", "Uncommon", "Rare", "Epic", "Legendary"],
                    "default": "Common"
                },
                "range": {
                    "$ref": "#/definitions/WeaponRange"
                },
                "isTwoHanded": {
                    "type": "boolean",
                    "description": "Whether the weapon requires both hands",
                    "default": false
                },
                "value": {
                    "type": "integer",
                    "description": "Base value in gold pieces",
                    "minimum": 0
                },
                "sortOrder": {
                    "type": "integer",
                    "description": "Order for display sorting (lower values first)",
                    "minimum": 0,
                    "default": 0
                }
            },
            "required": ["id", "name", "description", "weaponType", "damageDice", "value"],
            "additionalProperties": false
        },
        "StatBonuses": {
            "type": "object",
            "description": "Attribute bonuses provided by equipping the weapon",
            "properties": {
                "might": {
                    "type": "integer",
                    "description": "Bonus to Might attribute"
                },
                "fortitude": {
                    "type": "integer",
                    "description": "Bonus to Fortitude attribute"
                },
                "will": {
                    "type": "integer",
                    "description": "Bonus to Will attribute"
                },
                "wits": {
                    "type": "integer",
                    "description": "Bonus to Wits attribute"
                },
                "finesse": {
                    "type": "integer",
                    "description": "Bonus to Finesse attribute"
                }
            },
            "additionalProperties": {
                "type": "integer",
                "description": "Custom stat bonus"
            }
        },
        "WeaponRange": {
            "type": "object",
            "description": "Range parameters for ranged weapons",
            "properties": {
                "minimum": {
                    "type": "integer",
                    "description": "Minimum effective range (tiles closer than this have penalty)",
                    "minimum": 1,
                    "default": 1
                },
                "optimal": {
                    "type": "integer",
                    "description": "Optimal range with no penalties",
                    "minimum": 1
                },
                "maximum": {
                    "type": "integer",
                    "description": "Maximum range (cannot attack beyond this)",
                    "minimum": 1
                }
            },
            "required": ["optimal", "maximum"],
            "additionalProperties": false
        }
    }
}
```

---

## 11. Configuration File Updates

### Updated weapons.json

The existing `weapons.json` needs to update its schema reference to point to the new schema location.

**File:** `config/weapons.json`

Current structure (9 weapons):
```json
{
  "$schema": "weapons.schema.json",
  "weapons": [
    { "id": "rusty_sword", ... },
    { "id": "iron_sword", ... },
    { "id": "steel_sword", ... },
    { "id": "battle_axe", ... },
    { "id": "great_axe", ... },
    { "id": "steel_dagger", ... },
    { "id": "assassins_blade", ... },
    { "id": "oak_staff", ... },
    { "id": "arcane_staff", ... }
  ]
}
```

Updated with proper schema reference:
```json
{
    "$schema": "./schemas/weapons.schema.json",
    "weapons": [
        {
            "id": "rusty_sword",
            "name": "Rusty Sword",
            "description": "An old sword covered in rust. Still sharp enough to cut.",
            "weaponType": "Sword",
            "damageDice": "1d8",
            "proficiency": "Martial",
            "material": "Iron",
            "quality": "Common",
            "value": 5
        },
        {
            "id": "iron_sword",
            "name": "Iron Sword",
            "description": "A standard iron sword. Reliable and balanced.",
            "weaponType": "Sword",
            "damageDice": "1d8",
            "proficiency": "Martial",
            "material": "Iron",
            "quality": "Common",
            "value": 50
        },
        {
            "id": "steel_sword",
            "name": "Steel Sword",
            "description": "A finely crafted steel sword with excellent balance.",
            "weaponType": "Sword",
            "damageDice": "1d8+1",
            "proficiency": "Martial",
            "material": "Steel",
            "quality": "Uncommon",
            "value": 150
        },
        {
            "id": "battle_axe",
            "name": "Battle Axe",
            "description": "A heavy two-handed axe. Hits hard but swings slow.",
            "weaponType": "Axe",
            "damageDice": "1d10",
            "attackModifier": -1,
            "proficiency": "Martial",
            "isTwoHanded": true,
            "value": 75
        },
        {
            "id": "great_axe",
            "name": "Great Axe",
            "description": "An enormous axe capable of devastating blows.",
            "weaponType": "Axe",
            "damageDice": "2d6",
            "attackModifier": -2,
            "properties": ["two-handed", "heavy"],
            "proficiency": "Martial",
            "isTwoHanded": true,
            "value": 200
        },
        {
            "id": "steel_dagger",
            "name": "Steel Dagger",
            "description": "A quick, precise blade favored by rogues.",
            "weaponType": "Dagger",
            "damageDice": "1d4",
            "statBonuses": { "finesse": 2 },
            "properties": ["finesse", "light", "thrown"],
            "proficiency": "Simple",
            "material": "Steel",
            "value": 40
        },
        {
            "id": "assassins_blade",
            "name": "Assassin's Blade",
            "description": "A wickedly sharp dagger perfect for striking vital points.",
            "weaponType": "Dagger",
            "damageDice": "1d4+2",
            "statBonuses": { "finesse": 3 },
            "properties": ["finesse", "light"],
            "proficiency": "Martial",
            "material": "Steel",
            "quality": "Rare",
            "value": 250
        },
        {
            "id": "oak_staff",
            "name": "Oak Staff",
            "description": "A sturdy wooden staff imbued with minor magic.",
            "weaponType": "Staff",
            "damageDice": "1d6",
            "statBonuses": { "will": 2 },
            "proficiency": "Simple",
            "material": "Wood",
            "value": 45
        },
        {
            "id": "arcane_staff",
            "name": "Arcane Staff",
            "description": "A staff crackling with magical energy.",
            "weaponType": "Staff",
            "damageDice": "1d6+1",
            "statBonuses": { "will": 4 },
            "proficiency": "Simple",
            "material": "Wood",
            "quality": "Rare",
            "value": 300
        }
    ]
}
```

### Validation Confirmation

The existing configuration validates successfully against the schema:

| Weapon | Type | Dice | Valid |
|--------|------|------|-------|
| `rusty_sword` | Sword | 1d8 | Yes |
| `iron_sword` | Sword | 1d8 | Yes |
| `steel_sword` | Sword | 1d8+1 | Yes |
| `battle_axe` | Axe | 1d10 | Yes |
| `great_axe` | Axe | 2d6 | Yes |
| `steel_dagger` | Dagger | 1d4 | Yes |
| `assassins_blade` | Dagger | 1d4+2 | Yes |
| `oak_staff` | Staff | 1d6 | Yes |
| `arcane_staff` | Staff | 1d6+1 | Yes |

---

## 12. Data Model Changes

### No Domain Changes Required

This phase creates only a JSON Schema file for validation. No changes to domain entities, services, or application layer are required.

| Layer | Changes |
|-------|---------|
| Domain | None |
| Application | None |
| Infrastructure | None |
| Configuration | One schema file added, one config file updated |

### Schema as Documentation

The schema serves as:
- **Validation contract** for weapon configuration
- **IDE documentation** via description fields
- **Modding reference** for custom weapon systems
- **Design specification** for weapon mechanics

---

## 13. Logging Specifications

### No Runtime Logging Required

Schema validation occurs at design-time in IDE/editors, not at runtime. No logging infrastructure changes are needed for this phase.

| Component | Level | Events |
|-----------|-------|--------|
| N/A | N/A | Schema validation is IDE-based |

---

## 14. Unit Testing Requirements

### Test Count by Feature

| Feature | Test Count |
|---------|------------|
| Schema Valid Structure | ~1 |
| Damage Dice Pattern Validation | ~1 |
| Weapon Type Enum Validation | ~1 |
| Proficiency Enum Validation | ~1 |
| Existing Configuration Validation | ~1 |
| **Total** | **~5** |

### Test Descriptions

#### WeaponsSchemaTests.cs

```csharp
[TestFixture]
public class WeaponsSchemaTests
{
    /// <summary>
    /// Verifies the schema file is valid JSON Schema Draft-07.
    /// </summary>
    [Test]
    public void Schema_IsValidJsonSchemaDraft07();

    /// <summary>
    /// Verifies the existing weapons.json validates against the schema without errors.
    /// </summary>
    [Test]
    public void ExistingWeaponsJson_ValidatesAgainstSchema();

    /// <summary>
    /// Verifies damage dice pattern validates correct expressions (1d8, 2d6+3, 1d4-1).
    /// </summary>
    [Test]
    public void DamageDice_ValidPattern_PassesValidation();

    /// <summary>
    /// Verifies damage dice pattern rejects invalid expressions.
    /// </summary>
    [Test]
    public void DamageDice_InvalidPattern_FailsValidation();

    /// <summary>
    /// Verifies weaponType must be a valid enum value.
    /// </summary>
    [Test]
    public void WeaponType_InvalidEnumValue_FailsValidation();
}
```

### Test Implementation Notes

Tests should use a JSON Schema validation library (e.g., `NJsonSchema` for C#) to:
1. Load the schema file
2. Validate test JSON documents
3. Assert expected validation results

---

## 15. Use Cases

### UC-001: Load Weapons Configuration

**Actor:** Game System
**Flow:** System starts -> Loads `weapons.json` -> Schema validates content -> Weapons available for equipment system

### UC-002: Edit Weapons in IDE

**Actor:** Developer/Modder
**Flow:** Opens `weapons.json` in VS Code -> IDE loads schema -> Autocomplete suggests properties -> Validation errors shown inline

### UC-003: Add New Weapon

**Actor:** Modder
**Flow:** Adds new weapon object to `weapons` array -> Sets id, name, weaponType, damageDice, value -> IDE validates structure

### UC-004: Add Ranged Weapon

**Actor:** Modder
**Flow:** Adds new bow weapon -> Sets weaponType to "Bow" -> Adds range object with minimum, optimal, maximum -> IDE validates structure

### UC-005: Invalid Damage Dice

**Actor:** Modder
**Flow:** Sets damageDice to "d8" (missing count) -> IDE shows error "damageDice must match pattern" -> Modder corrects to "1d8"

### UC-006: Add Weapon Properties

**Actor:** Modder
**Flow:** Adds properties array with "finesse", "light" -> IDE validates enum values -> Weapon gains special behaviors

---

## 16. Deliverable Checklist

### Schema Files
- [ ] `config/schemas/weapons.schema.json` created
- [ ] Schema follows JSON Schema Draft-07 format
- [ ] Schema includes all defined properties
- [ ] Schema includes definitions section (WeaponDefinition, StatBonuses, WeaponRange)

### Validation Rules
- [ ] Weapon type enum validation
- [ ] Damage dice pattern validation: `^\d+d\d+([+-]\d+)?$`
- [ ] Proficiency enum validation: Simple, Martial, Exotic
- [ ] Quality tier enum validation: Common, Uncommon, Rare, Epic, Legendary
- [ ] Material enum validation: Wood, Iron, Steel, Mithril, Adamantine
- [ ] Weapon property enum validation
- [ ] ID pattern validation: `^[a-z][a-z0-9_]*$`
- [ ] Value must be non-negative
- [ ] Attack modifier allows positive and negative
- [ ] Range properties validated (minimum >= 1)
- [ ] Required fields enforced
- [ ] Optional fields have defaults

### Configuration Updates
- [ ] `weapons.json` $schema reference updated to `./schemas/weapons.schema.json`
- [ ] Existing `weapons.json` validates against schema

### Testing
- [ ] ~5 unit tests implemented
- [ ] All tests passing
- [ ] Tests cover happy path and error cases

### Documentation
- [ ] Schema properties have descriptions
- [ ] This design specification complete

---

## 17. Acceptance Criteria

### Functional
- [ ] `weapons.schema.json` created in `config/schemas/` directory
- [ ] Schema validates existing `weapons.json` without errors
- [ ] Damage dice pattern validated (e.g., "1d8", "2d6+3", "1d4-1")
- [ ] Weapon type enum validated (Sword, Axe, Dagger, Staff, Bow, Mace, Spear, Hammer, Crossbow, Wand)
- [ ] Attack modifier allows positive and negative values
- [ ] Stat bonuses validated as optional object
- [ ] Weapon properties validated as enum array
- [ ] Proficiency category enum validated (Simple, Martial, Exotic)
- [ ] Quality tier enum validated (Common, Uncommon, Rare, Epic, Legendary)
- [ ] Material type enum validated (Wood, Iron, Steel, Mithril, Adamantine)
- [ ] Value must be non-negative
- [ ] Range object validated for ranged weapons
- [ ] VS Code provides autocomplete when schema linked

### Quality
- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] ~5 unit tests pass
- [ ] Schema file is valid JSON
- [ ] All schema properties have descriptions

---

## 18. Dependencies

### Required from Prior Versions

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `weapons.json` | `config/weapons.json` | Validated by new schema |
| Schema patterns | `config/schemas/*.schema.json` | Reference for schema structure |
| `damage-types.json` (v0.14.1c) | `config/damage-types.json` | damageType field references |

### Provides to Future Versions

| Type | Usage |
|------|-------|
| `weapons.schema.json` | Validates weapon configuration |
| WeaponDefinition pattern | Used by loot-tables.json for item references |
| Dice expression pattern | Reusable pattern for other damage expressions |
| StatBonuses definition | Reusable in armor.schema.json |
| Quality tier enum | Shared with armor.schema.json, items.schema.json |

### Implementation Order Note

**v0.14.2a can be implemented in parallel with v0.14.2b and v0.14.2c** as they have no internal dependencies.

v0.14.2d (Loot Tables) should be implemented last as it references weapon, armor, and item IDs.

---

## 19. Future Considerations

### Deferred to Future Versions

- **Cross-reference validation**: Validating damageType references exist in damage-types.json
- **Weapon enchantment system**: Magical properties and upgrades
- **Weapon set bonuses**: Bonuses for equipping matching weapons
- **Weapon durability**: Degradation and repair mechanics
- **Weapon crafting**: Creating weapons from materials

### Out of Scope

- **Runtime schema validation**: Application-level validation at load time (handled by existing provider patterns)
- **Schema versioning migration**: Automatic migration between schema versions
- **Combat calculation logic**: Runtime mechanics for weapon damage (domain logic, not schema)
- **UI weapon display**: How weapons are shown to players (presentation concern)
- **Balance tuning**: Specific damage values (design decisions)

### Potential Future Enhancements

If the weapon system expands, consider adding to the schema:

**Enchantment System:**
```json
"enchantments": {
    "type": "array",
    "items": {
        "type": "object",
        "properties": {
            "enchantmentId": { "type": "string" },
            "level": { "type": "integer", "minimum": 1 }
        }
    }
}
```

**Durability System:**
```json
"durability": {
    "type": "object",
    "properties": {
        "current": { "type": "integer", "minimum": 0 },
        "maximum": { "type": "integer", "minimum": 1 }
    }
}
```

**Special Abilities:**
```json
"specialAbilities": {
    "type": "array",
    "items": {
        "type": "string",
        "description": "Reference to ability ID triggered by weapon"
    }
}
```

**Critical Hit Configuration:**
```json
"criticalHit": {
    "type": "object",
    "properties": {
        "range": { "type": "integer", "minimum": 1, "maximum": 20, "default": 20 },
        "multiplier": { "type": "number", "minimum": 1, "default": 2 }
    }
}
```

---

*Document Version: 1.0*
*Last Updated: 2026-01-17*
*Author: Claude*
