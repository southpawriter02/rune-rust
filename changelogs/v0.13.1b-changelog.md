# v0.13.1b Changelog: Boss Status Display

**Release Date:** 2026-01-20

---

## Summary

Implemented Boss Status Display UI components including phase indicator, enrage timer, and vulnerability window. These components provide critical tactical information about the boss's current state during encounters, enabling players to react to phase changes, prepare for enrage mechanics, and capitalize on vulnerability windows.

---

## Added

### DTOs

- **PhaseDisplayDto** — Phase indicator display data
  - `PhaseNumber`: Current phase number (1-based)
  - `PhaseName`: Display name of the phase
  - `Behavior`: Boss behavior pattern (`BossBehavior` enum)
  - `AbilityHints`: Phase-specific ability hints
  - `StatModifiers`: Stat multipliers for the phase

- **PhaseTransitionDto** — Phase transition effect data
  - `OldPhaseNumber/NewPhaseNumber`: Before/after phase numbers
  - `PhaseName`: New phase display name
  - `TransitionText`: Optional dramatic flavor text
  - `BossName`: Boss display name

- **EnrageStatusDto** — Enrage status display data
  - `IsEnraged`: Whether boss is currently enraged
  - `HealthPercentToEnrage`: Health until next enrage threshold
  - `StatModifiers`: Active enrage stat modifiers

- **VulnerabilityDisplayDto** — Vulnerability window data
  - `IsActive`: Whether vulnerability window is open
  - `TurnsRemaining`: Number of turns remaining
  - `DamageMultiplier`: Damage bonus multiplier (default 1.5)

### Configuration

- **BossStatusDisplayConfig** — Master configuration class
  - `PhaseIndicator`: Position and size settings
  - `EnrageTimer`: Position and warning threshold
  - `VulnerabilityWindow`: Position and timing settings
  - `TransitionEffect`: Centered box configuration
  - `Colors`: Behavior-based and warning colors

- **PhaseIndicatorConfig** — Phase indicator settings
  - `StartX/StartY`: Position (default 0, 7)
  - `Width/Height`: Dimensions (default 50 × 5)
  - `MaxHints`: Maximum ability hints (default 3)

- **EnrageTimerConfig** — Enrage timer settings
  - `StartX/StartY`: Position (default 0, 12)
  - `Width/Height`: Dimensions (default 60 × 2)
  - `WarningThreshold`: Show warning at N% (default 10)

- **VulnerabilityWindowConfig** — Vulnerability window settings
  - `StartX/StartY`: Position (default 0, 14)
  - `Width`: Width (default 70)
  - `DamageMultiplier`: Bonus multiplier (default 1.5)
  - `ClosedDisplayMs/FlashIntervalMs`: Timing

- **TransitionEffectConfig** — Phase transition effect settings
  - `CenterX/StartY`: Centered position
  - `BoxWidth`: Box width (default 55)
  - `DisplayDurationMs`: Hold duration (default 2000ms)

- **BossStatusColors** — Color configuration
  - 5 behavior colors: Aggressive, Tactical, Defensive, Enraged, Summoner
  - 3 warning colors: Critical, High, Low
  - Vulnerable, Urgent, WindowClosed, TransitionBox colors

### Renderers

- **BossStatusRenderer**
  - `FormatPhaseText()`: "Phase: N - NAME" format
  - `GetPhaseColor()`: Behavior → color mapping
  - `FormatTransitionBox()`: Centered transition box
  - `FormatEnrageWarning()`: "[!] Enrage in: N% health"
  - `FormatEnrageActive()`: "[!!!] ENRAGED"
  - `FormatEnrageModifiers()`: "+50% damage, +25% attack speed"
  - `GetWarningColor()`: Warning threshold → color
  - `FormatVulnerabilityWindow()`: "[!] VULNERABILITY WINDOW OPEN..."
  - `FormatVulnerabilityUrgent()`: "[!!!] LAST CHANCE..."
  - `FormatWindowClosed()`: "[x] Vulnerability window closed"
  - `FormatStatModifiers()`: Stat modifier string formatting

### UI Components

- **PhaseIndicator**
  - `RenderPhase()`: Display current phase with hints
  - `ShowTransitionEffect()`: Centered transition box with hold
  - `GetPhaseDescription()`: Generate hints from BossPhase
  - `Clear()`: Remove display

- **EnrageTimer**
  - `RenderTimer()`: Display enrage status
  - `ShowEnrageWarning()`: Warning with color by proximity
  - `ShowEnrageActive()`: Active enrage with modifiers
  - `Clear()`: Remove display

- **VulnerabilityWindow**
  - `RenderWindow()`: Display vulnerability status
  - `ShowWindowOpen()`: Turns remaining with bonus
  - `ShowWindowClosed()`: Brief closed notification
  - `Clear()`: Remove display
  - `FlashUrgency()`: Flash when 1 turn remaining

### Configuration Files

- `config/boss-status-display.json`
- `config/schemas/boss-status-display.schema.json`

### Tests

- `BossStatusRendererTests` (~20 tests)
  - Phase text formatting
  - Behavior → color mapping
  - Vulnerability window formatting
  - Enrage modifiers formatting
  - Warning colors
  - Transition box formatting

- `PhaseIndicatorTests` (~8 tests)
  - Render phase
  - Transition effect
  - Clear state
  - Constructor validation

- `EnrageTimerTests` (~8 tests)
  - Render timer states
  - Warning display
  - Active enrage
  - Clear state

- `VulnerabilityWindowTests` (~10 tests)
  - Render window states
  - Open/closed display
  - Urgency flash
  - Clear state

---

## Visual Examples

### Phase Indicator Display

```
Phase: 2 - EMPOWERED
  |-- Aggressive attacks
  |-- Attack +50%
  +-- Summons skeleton-minion
```

### Phase Transition Effect

```
+=====================================================+
|  [!]  PHASE TRANSITION                              |
+=====================================================+
|                                                     |
|  SKELETON KING enters Phase 2: Empowered            |
|                                                     |
|  "Rise, my minions!"                                |
|                                                     |
+=====================================================+
```

### Enrage Warning/Active

```
[!] Enrage in: 8% health
```
```
[!!!] ENRAGED
+50% damage, +25% attack speed
```

### Vulnerability Window

```
[!] VULNERABILITY WINDOW OPEN (2 turns) - Deal +50% damage!
```

---

## Dependencies

### Required (from v0.13.1a)

- `ITerminalService`: WriteAt, WriteColoredAt, FlashDelay methods
- `BossHealthBar`: Base component pattern

### Required (from v0.10.4b)

- `IBossMechanicsService`: Boss state retrieval
- `BossPhase`: Phase configuration with StatModifiers
- `ActiveBossState`: Runtime boss state
- `BossBehavior`: Behavior enumeration

### Provides (for v0.13.1c)

- `BossStatusRenderer`: Reusable rendering patterns
- `BossStatusDisplayConfig`: Shared configuration

---

## Test Results

```
Project total tests: 210
New tests added: ~55
     Passed: 210
Total time: 118ms
```
