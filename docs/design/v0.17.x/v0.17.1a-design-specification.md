# v0.17.1a Design Specification: Background Enum & Definition

**Version:** 0.17.1a  
**Phase Name:** Background Enum & Definition  
**Parent Version:** v0.17.1 (Background System)  
**Prerequisites:** v0.17.0 Complete (Lineage System)  
**Estimated Tests:** ~8 unit tests

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Background Enum](#4-background-enum)
5. [BackgroundDefinition Entity](#5-backgrounddefinition-entity)
6. [Data Model Changes](#6-data-model-changes)
7. [Configuration File Schemas](#7-configuration-file-schemas)
8. [Logging Specifications](#8-logging-specifications)
9. [Unit Testing Requirements](#9-unit-testing-requirements)
10. [Use Cases](#10-use-cases)
11. [User Stories](#11-user-stories)
12. [Deliverable Checklist](#12-deliverable-checklist)
13. [Acceptance Criteria](#13-acceptance-criteria)
14. [Dependencies](#14-dependencies)
15. [Future Considerations](#15-future-considerations)

---

## 1. Executive Summary

### 1.1 Purpose

This specification defines the Background enumeration and BackgroundDefinition entity that form the foundation of the v0.17.1 Background System. Unlike Lineage (inherited bloodline traits) or Archetype (combat role), Background represents what the character did before the Great Silence—their profession, learned skills, and accumulated possessions.

The six backgrounds represent distinct pre-catastrophe professions in Aethelgard:

- **Village Smith** — Blacksmith and metalworker, respected craftsperson
- **Traveling Healer** — Itinerant medicine practitioner, welcomed but sometimes distrusted
- **Ruin Delver** — Scavenger and explorer, useful but looked down upon
- **Clan Guard** — Warrior and protector, honored defender
- **Wandering Skald** — Storyteller and historian, keeper of lore
- **Outcast Scavenger** — Exile and lone survivor, pariah with survival skills

This phase establishes the enum and definition entity that all subsequent v0.17.1x phases depend upon for skill grants and equipment grants.

### 1.2 Key Deliverables

| Category          | Items                                                   |
| ----------------- | ------------------------------------------------------- |
| **Enums**         | `Background`                                            |
| **Entities**      | `BackgroundDefinition`                                  |
| **Configuration** | `backgrounds.json` (partial), `backgrounds.schema.json` |
| **Tests**         | ~8 unit tests                                           |

### 1.3 Architectural Significance

This version establishes the **Background Pattern** used throughout character creation:

- **Enum-Based Background Identification**: All characters reference a `Background` value
- **Definition Entity Pattern**: `BackgroundDefinition` holds all background data
- **Profession/Social Context**: Backgrounds provide narrative hooks and social standing
- **Pre-Silence Focus**: Backgrounds represent learned skills, not inherited traits
- **Configuration-Driven**: Background properties loaded from JSON for customization
- **Narrative Hook System**: Backgrounds provide quest hooks and dialogue options

---

## 2. Feature Overview

```
v0.17.1a Background Enum & Definition
├── Background Enum
│   ├── VillageSmith (0) — Craft and physical tools
│   ├── TravelingHealer (1) — Medicine and healing supplies
│   ├── RuinDelver (2) — Exploration and dungeoneering gear
│   ├── ClanGuard (3) — Combat and defensive equipment
│   ├── WanderingSkald (4) — Performance and lore items
│   └── OutcastScavenger (5) — Survival and wilderness gear
├── BackgroundDefinition Entity
│   ├── Id: Guid
│   ├── BackgroundId: Background enum
│   ├── DisplayName: string
│   ├── Description: string
│   ├── SelectionText: string (flavor text for creation UI)
│   ├── ProfessionBefore: string (what they did pre-Silence)
│   ├── SocialStanding: string (how others view this background)
│   └── NarrativeHooks: List<string> (potential quest hooks)
└── Configuration Files
    ├── backgrounds.json (partial - definition only)
    └── backgrounds.schema.json
```

### 2.1 Scope Alignment

**In Scope:**

- `Background` enum with six background values (0-5)
- `BackgroundDefinition` entity with core properties
- Profession and social standing descriptions
- Narrative hooks for quest integration
- Partial `backgrounds.json` configuration (definition section)
- `backgrounds.schema.json` validation schema
- Norse-inspired thematic naming and lore

**Out of Scope:**

- Skill grants (BackgroundSkillGrant, SkillGrantType) → v0.17.1b
- Equipment grants (BackgroundEquipmentGrant) → v0.17.1c
- BackgroundProvider service → v0.17.1d
- BackgroundApplicationService → v0.17.1e
- Integration with character creation workflow → v0.17.5

---

## 3. Architecture Diagrams

### 3.1 Background System Overview

```
┌─────────────────────────────────────────────────────────────────────┐
│                   BACKGROUND SYSTEM OVERVIEW                         │
└─────────────────────────────────────────────────────────────────────┘

    Character Creation UI (Step 2: Background)
           │
           │  Player selects background
           ▼
┌─────────────────────────────────────────────────────────────────────┐
│                         Background Enum                              │
├─────────────────────────────────────────────────────────────────────┤
│ VillageSmith(0) │ TravelingHealer(1) │ RuinDelver(2)               │
│ ClanGuard(3)    │ WanderingSkald(4)  │ OutcastScavenger(5)         │
└─────────────────────────────────────────────────────────────────────┘
           │
           │  Get definition for display/application
           ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    BackgroundDefinition Entity                       │
├─────────────────────────────────────────────────────────────────────┤
│  - BackgroundId: Background        (enum reference)                 │
│  - DisplayName: string             (e.g., "Village Smith")          │
│  - Description: string             (flavor text)                    │
│  - SelectionText: string           (UI selection description)       │
│  - ProfessionBefore: string        (pre-Silence occupation)         │
│  - SocialStanding: string          (how society views them)         │
│  - NarrativeHooks: List<string>    (quest/dialogue triggers)        │
└─────────────────────────────────────────────────────────────────────┘
```

### 3.2 Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────┐
│                        PRESENTATION LAYER                            │
├─────────────────────────────────────────────────────────────────────┤
│  CharacterCreationView (v0.17.5)                                     │
│  └── Uses BackgroundDefinition.DisplayName, SelectionText           │
│                                                                      │
│  BackgroundSelectionPanel (v0.17.5)                                  │
│  └── Uses BackgroundDefinition for UI rendering                      │
│                                                                      │
│  NarrativeEventHandler                                               │
│  └── Uses NarrativeHooks for quest/dialogue options                  │
└───────┬─────────────────────────────────────────────────────────────┘
        │
        ▼
┌─────────────────────────────────────────────────────────────────────┐
│                       APPLICATION LAYER                              │
├─────────────────────────────────────────────────────────────────────┤
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │               IBackgroundProvider (v0.17.1d)                  │  │
│  │                 (interface for background access)             │  │
│  ├───────────────────────────────────────────────────────────────┤  │
│  │  + GetAllBackgrounds(): IReadOnlyList<BackgroundDefinition>   │  │
│  │  + GetBackground(Background): BackgroundDefinition?           │  │
│  │  + GetSelectionText(Background): string                       │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                      │
│  IBackgroundApplicationService (v0.17.1e)                            │
│  └── Uses Background enum and BackgroundDefinition                   │
└───────┬─────────────────────────────────────────────────────────────┘
        │
        ▼
┌─────────────────────────────────────────────────────────────────────┐
│                         DOMAIN LAYER                                 │
├─────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────┐  ┌────────────────────────────────────┐   │
│  │     Background      │  │      BackgroundDefinition          │   │
│  │       (Enum)        │  │           (Entity)                 │   │
│  ├─────────────────────┤  ├────────────────────────────────────┤   │
│  │ VillageSmith = 0    │  │ Id: Guid                           │   │
│  │ TravelingHealer = 1 │  │ BackgroundId: Background           │   │
│  │ RuinDelver = 2      │  │ DisplayName: string                │   │
│  │ ClanGuard = 3       │  │ Description: string                │   │
│  │ WanderingSkald = 4  │  │ SelectionText: string              │   │
│  │ OutcastScavenger = 5│  │ ProfessionBefore: string           │   │
│  └─────────────────────┘  │ SocialStanding: string             │   │
│                           │ NarrativeHooks: List<string>       │   │
│                           └────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────┘
```

### 3.3 Character Creation Flow: Background Step

```
┌─────────────────────────────────────────────────────────────────────┐
│              CHARACTER CREATION FLOW: BACKGROUND STEP                │
└─────────────────────────────────────────────────────────────────────┘

    Player completes Step 1 (Lineage)
           │
           ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    STEP 2: BACKGROUND SELECTION                      │
├─────────────────────────────────────────────────────────────────────┤
│  1. Display all 6 backgrounds with SelectionText                    │
│  2. Player navigates between options                                 │
│  3. Show details:                                                    │
│     - Display Name                                                   │
│     - Description                                                    │
│     - Profession Before                                              │
│     - Social Standing                                                │
│     - Skill Preview (v0.17.1b)                                      │
│     - Equipment Preview (v0.17.1c)                                  │
└─────────────────────────────────────────────────────────────────────┘
           │
           ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    PLAYER SELECTS BACKGROUND                         │
├─────────────────────────────────────────────────────────────────────┤
│  Example: Player selects "Ruin Delver"                              │
│                                                                      │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │  RUIN DELVER                                                   │  │
│  │  ─────────────────────────────────────────────────────────────│  │
│  │  "While others feared the dark places, you saw opportunity.   │  │
│  │   Every ruin is a puzzle, every trap a challenge."            │  │
│  │                                                                │  │
│  │  Profession: Scavenger and explorer                           │  │
│  │  Standing:   Useful but looked down upon                       │  │
│  │                                                                │  │
│  │  Skills:     Exploration +2, Traps +1                          │  │
│  │  Equipment:  Lantern, Rope, Lockpicks                          │  │
│  └───────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────┘
           │
           ▼
    Store selection → Proceed to Step 3 (Attributes)
```

### 3.4 Background Social Standing Decision Tree

```
┌─────────────────────────────────────────────────────────────────────┐
│               BACKGROUND SOCIAL STANDING INFLUENCE                   │
└─────────────────────────────────────────────────────────────────────┘

    NPC Interaction or Dialogue Check
           │
           ▼
    ┌──────────────────────────────────────────────────────────────┐
    │           Check Character's Background                        │
    └──────────────────────────────────┬───────────────────────────┘
               ┌───────────────────────┼───────────────────────────┐
               ▼                       ▼                           ▼
    ┌───────────────────┐   ┌───────────────────┐   ┌───────────────────┐
    │   Village Smith   │   │    Clan Guard     │   │ Outcast Scavenger │
    │   or Clan Guard   │   │  or Wan. Skald    │   │  or Ruin Delver   │
    ├───────────────────┤   ├───────────────────┤   ├───────────────────┤
    │ High Social       │   │ Moderate Social   │   │ Low Social        │
    │ Standing          │   │ Standing          │   │ Standing          │
    │                   │   │                   │   │                   │
    │ • Trusted by      │   │ • Welcome at most │   │ • Viewed with     │
    │   settlements     │   │   hearths         │   │   suspicion       │
    │ • Discounts from  │   │ • Respected for   │   │ • Grudging        │
    │   allied NPCs     │   │   knowledge/skill │   │   respect for     │
    │ • Leadership      │   │ • May share       │   │   survival skills │
    │   dialogue opts   │   │   knowledge       │   │ • Outcast         │
    │                   │   │                   │   │   dialogue opts   │
    └───────────────────┘   └───────────────────┘   └───────────────────┘
               │                       │                           │
               └───────────────────────┼───────────────────────────┘
                                       ▼
    ┌──────────────────────────────────────────────────────────────┐
    │             Apply appropriate dialogue modifiers              │
    └──────────────────────────────────────────────────────────────┘
```

### 3.5 Narrative Hook Integration Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                  NARRATIVE HOOK INTEGRATION FLOW                     │
└─────────────────────────────────────────────────────────────────────┘

    Game Event Occurs (e.g., Player examines ruins)
           │
           ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    CHECK CHARACTER BACKGROUND                        │
├─────────────────────────────────────────────────────────────────────┤
│  1. Get character's BackgroundDefinition                            │
│  2. Retrieve NarrativeHooks list                                    │
│  3. Match event type against hook conditions                        │
└─────────────────────────────────────────────────────────────────────┘
           │
           ▼
    ┌──────────────────────┐
    │ Any hooks match?     │
    └──────────┬───────────┘
               │
        ┌──────┴──────┐
       YES            NO
        │              │
        ▼              ▼
┌───────────────┐  ┌───────────────┐
│ Display bonus │  │ Standard      │
│ dialogue or   │  │ interaction   │
│ interaction   │  │               │
└───────┬───────┘  └───────────────┘
        │
        ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    EXAMPLE: RUIN DELVER                              │
├─────────────────────────────────────────────────────────────────────┤
│  Event: Examine ancient ruins                                        │
│                                                                      │
│  Hook Match: "Know ruin layouts and hazards"                        │
│                                                                      │
│  Result: "Your experience as a Ruin Delver tells you these         │
│           foundations are Dvergr-made. There may be traps           │
│           behind the false wall to the east."                        │
│                                                                      │
│  Mechanical Effect: Reveal hidden passage without Exploration check  │
└─────────────────────────────────────────────────────────────────────┘
```

### 3.6 Background Comparison Matrix

```
┌─────────────────────────────────────────────────────────────────────┐
│                   BACKGROUND COMPARISON MATRIX                       │
└─────────────────────────────────────────────────────────────────────┘

    ┌─────────────────┬────────────────────┬────────────────────────┐
    │    Background   │   Profession       │   Social Standing      │
    ├─────────────────┼────────────────────┼────────────────────────┤
    │  Village Smith  │ Blacksmith &       │ Respected craftsperson,│
    │                 │ metalworker        │ essential to settlement│
    ├─────────────────┼────────────────────┼────────────────────────┤
    │Traveling Healer │ Itinerant medicine │ Welcomed but sometimes │
    │                 │ practitioner       │ distrusted             │
    ├─────────────────┼────────────────────┼────────────────────────┤
    │  Ruin Delver    │ Scavenger and      │ Useful but looked      │
    │                 │ explorer           │ down upon              │
    ├─────────────────┼────────────────────┼────────────────────────┤
    │   Clan Guard    │ Warrior and        │ Honored defender,      │
    │                 │ protector          │ trusted by leadership  │
    ├─────────────────┼────────────────────┼────────────────────────┤
    │ Wandering Skald │ Storyteller and    │ Entertainer, keeper of │
    │                 │ historian          │ lore, welcome at hearth│
    ├─────────────────┼────────────────────┼────────────────────────┤
    │Outcast Scavenger│ Exile and lone     │ Pariah, viewed with    │
    │                 │ survivor           │ suspicion              │
    └─────────────────┴────────────────────┴────────────────────────┘

    Design Notes:
    ┌─────────────────────────────────────────────────────────────────┐
    │ • Each background represents a distinct pre-Silence profession  │
    │ • Social standing affects NPC reactions and dialogue options    │
    │ • Narrative hooks provide unique quest and exploration options  │
    │ • Backgrounds complement but don't overlap with Lineage traits  │
    └─────────────────────────────────────────────────────────────────┘
```

---

## 4. Background Enum

### 4.1 Purpose

The `Background` enum defines the six pre-Silence profession options available during character creation. This enum is the foundation for all background-related mechanics including skill grants, equipment grants, and social standing effects.

### 4.2 Implementation

**File:** `src/Core/RuneAndRust.Domain/Enums/Background.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Defines the pre-Silence profession of a character.
/// </summary>
/// <remarks>
/// <para>
/// Background represents what a character did before the Great Silence.
/// Unlike Lineage (inherited traits) or Archetype (combat role), Background
/// reflects learned skills and accumulated possessions from the character's
/// previous profession.
/// </para>
/// <para>
/// The six backgrounds each offer distinct starting advantages:
/// - Village Smith: Craft expertise and physical tools
/// - Traveling Healer: Medical knowledge and healing supplies
/// - Ruin Delver: Exploration skills and dungeoneering gear
/// - Clan Guard: Combat training and defensive equipment
/// - Wandering Skald: Performance ability and lore items
/// - Outcast Scavenger: Survival skills and wilderness gear
/// </para>
/// <para>
/// Background values are explicitly assigned (0-5) to ensure stable serialization
/// and database storage. New backgrounds should be added at the end if needed.
/// </para>
/// </remarks>
public enum Background
{
    /// <summary>
    /// Village Smith - Blacksmith and metalworker who shaped tools of war and peace.
    /// </summary>
    /// <remarks>
    /// Village Smiths are respected craftspeople essential to any settlement.
    /// They begin with Craft and Might bonuses, along with smith tools and
    /// protective workwear. Their expertise allows them to recognize
    /// craftsmanship quality and repair broken equipment.
    /// </remarks>
    VillageSmith = 0,

    /// <summary>
    /// Traveling Healer - Itinerant medicine practitioner who walked between settlements.
    /// </summary>
    /// <remarks>
    /// Traveling Healers are welcomed but sometimes viewed with superstition.
    /// They begin with Medicine and Herbalism bonuses, along with healing
    /// supplies. Their knowledge of remedies and diseases grants unique
    /// dialogue options with Bone-Setters and other healers.
    /// </remarks>
    TravelingHealer = 1,

    /// <summary>
    /// Ruin Delver - Scavenger and explorer who sought treasures in the old places.
    /// </summary>
    /// <remarks>
    /// Ruin Delvers are useful but often looked down upon as grave robbers.
    /// They begin with Exploration and Traps bonuses, along with dungeoneering
    /// gear. Their familiarity with ancient ruins grants insight into layouts
    /// and hazards.
    /// </remarks>
    RuinDelver = 2,

    /// <summary>
    /// Clan Guard - Warrior and protector who defended their people from threats.
    /// </summary>
    /// <remarks>
    /// Clan Guards are honored defenders trusted by clan leadership.
    /// They begin with Combat and Vigilance bonuses, along with shield and
    /// spear. Their military experience grants recognition of tactics and
    /// formations.
    /// </remarks>
    ClanGuard = 3,

    /// <summary>
    /// Wandering Skald - Storyteller and historian who carried memories of what was.
    /// </summary>
    /// <remarks>
    /// Wandering Skalds are entertainers and keepers of lore, welcome at most
    /// hearths. They begin with Performance and Lore bonuses, along with
    /// instrument and journal. Their knowledge of old legends provides clues
    /// and earns hospitality.
    /// </remarks>
    WanderingSkald = 4,

    /// <summary>
    /// Outcast Scavenger - Exile and lone survivor who learned to survive in the wastes.
    /// </summary>
    /// <remarks>
    /// Outcast Scavengers are pariahs viewed with suspicion but grudging
    /// respect. They begin with Survival and Stealth bonuses, along with
    /// rations and travel cloak. Their wasteland experience grants knowledge
    /// of hidden dangers and paths.
    /// </remarks>
    OutcastScavenger = 5
}
```

### 4.3 Design Decisions

#### 4.3.1 Explicit Enum Values

**Decision:** Explicitly assign integer values (0-5) to enum members.

**Rationale:**

- Ensures stable serialization to JSON and database storage
- Prevents accidental value changes if enum order is modified
- Matches existing game patterns for enums (e.g., `Lineage`, `QualityTier`)
- Supports future addition of backgrounds at higher values

#### 4.3.2 Six-Background System

**Decision:** Use exactly six backgrounds as defined in the scope breakdown.

**Rationale:**

- Matches the design specification in v0.17.1-scope-breakdown.md
- Each background offers distinct mechanical and thematic identity
- Six options provide meaningful choice without overwhelming players
- Covers major pre-Silence profession archetypes in Aethelgard

#### 4.3.3 Naming Conventions

**Decision:** Use PascalCase names based on profession descriptions.

**Rationale:**

- `VillageSmith`: Immediate recognition as a craftsperson background
- `TravelingHealer`: Clear indication of itinerant medical profession
- `RuinDelver`: Evokes exploration and dungeoneering focus
- `ClanGuard`: References military/defensive profession
- `WanderingSkald`: Norse term for poet/historian adds flavor
- `OutcastScavenger`: Emphasizes both social status and survival focus

### 4.4 Background Reference Table

| Enum Value         | Integer | Display Name      | Theme Focus         |
| ------------------ | ------- | ----------------- | ------------------- |
| `VillageSmith`     | 0       | Village Smith     | Craft & Physical    |
| `TravelingHealer`  | 1       | Traveling Healer  | Medicine & Healing  |
| `RuinDelver`       | 2       | Ruin Delver       | Exploration & Traps |
| `ClanGuard`        | 3       | Clan Guard        | Combat & Defense    |
| `WanderingSkald`   | 4       | Wandering Skald   | Performance & Lore  |
| `OutcastScavenger` | 5       | Outcast Scavenger | Survival & Stealth  |

---

## 5. BackgroundDefinition Entity

### 5.1 Purpose

The `BackgroundDefinition` entity encapsulates all data for a single background, including display properties, profession/social context, and narrative hooks. This entity is loaded from configuration and serves as the source of truth for background presentation and effects.

### 5.2 Implementation

**File:** `src/Core/RuneAndRust.Domain/Entities/BackgroundDefinition.cs`

```csharp
namespace RuneAndRust.Domain.Entities;

using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.Interfaces;

/// <summary>
/// Represents a complete background definition including all properties and narrative context.
/// </summary>
/// <remarks>
/// <para>
/// BackgroundDefinition is an immutable entity loaded from configuration. It contains
/// all data needed to present background options during character creation and to
/// provide narrative context throughout gameplay.
/// </para>
/// <para>
/// This entity is extended by subsequent phases:
/// - v0.17.1b adds SkillGrants (skill bonuses from profession)
/// - v0.17.1c adds EquipmentGrants (starting items from profession)
/// </para>
/// <para>
/// Unlike LineageDefinition which represents inherited traits, BackgroundDefinition
/// represents learned skills and accumulated knowledge from the character's
/// pre-Silence profession.
/// </para>
/// </remarks>
public class BackgroundDefinition : IEntity
{
    /// <summary>
    /// Gets the unique identifier for this background definition.
    /// </summary>
    public Guid Id { get; private set; }

    /// <summary>
    /// Gets the background enum value this definition describes.
    /// </summary>
    public Background BackgroundId { get; private set; }

    /// <summary>
    /// Gets the display name shown in UI (e.g., "Village Smith").
    /// </summary>
    public string DisplayName { get; private set; }

    /// <summary>
    /// Gets the full description of the background for detail views.
    /// </summary>
    public string Description { get; private set; }

    /// <summary>
    /// Gets the flavor text shown during background selection in character creation.
    /// </summary>
    /// <remarks>
    /// Selection text is written in second person ("You worked...") to help
    /// players connect with the character's backstory. It should evoke the
    /// atmosphere and experiences of the profession.
    /// </remarks>
    public string SelectionText { get; private set; }

    /// <summary>
    /// Gets a brief description of what the character did before the Great Silence.
    /// </summary>
    /// <remarks>
    /// This is a concise profession label (e.g., "Blacksmith and metalworker")
    /// used in character sheets and summaries.
    /// </remarks>
    public string ProfessionBefore { get; private set; }

    /// <summary>
    /// Gets how society typically views characters with this background.
    /// </summary>
    /// <remarks>
    /// Social standing affects NPC reactions and may unlock or restrict
    /// certain dialogue options. It represents the general perception of
    /// the profession in post-Silence society.
    /// </remarks>
    public string SocialStanding { get; private set; }

    /// <summary>
    /// Gets narrative hooks that can trigger special dialogue or quest options.
    /// </summary>
    /// <remarks>
    /// Narrative hooks are string descriptions that the narrative system can
    /// match against event types. Examples:
    /// - "Recognize craftsmanship in ruins"
    /// - "Repair broken equipment more easily"
    /// - "Know ruin layouts and hazards"
    /// </remarks>
    public IReadOnlyList<string> NarrativeHooks { get; private set; }

    /// <summary>
    /// Private constructor for EF Core.
    /// </summary>
    private BackgroundDefinition()
    {
        DisplayName = null!;
        Description = null!;
        SelectionText = null!;
        ProfessionBefore = null!;
        SocialStanding = null!;
        NarrativeHooks = Array.Empty<string>();
    }

    /// <summary>
    /// Creates a new BackgroundDefinition with the specified properties.
    /// </summary>
    /// <param name="backgroundId">The background enum value.</param>
    /// <param name="displayName">The display name for UI.</param>
    /// <param name="description">The full description.</param>
    /// <param name="selectionText">The selection screen flavor text.</param>
    /// <param name="professionBefore">The pre-Silence profession description.</param>
    /// <param name="socialStanding">The social perception description.</param>
    /// <param name="narrativeHooks">Quest/dialogue trigger strings.</param>
    /// <returns>A new BackgroundDefinition instance.</returns>
    /// <exception cref="ArgumentException">
    /// Thrown when string parameters are null or whitespace.
    /// </exception>
    public static BackgroundDefinition Create(
        Background backgroundId,
        string displayName,
        string description,
        string selectionText,
        string professionBefore,
        string socialStanding,
        IReadOnlyList<string>? narrativeHooks = null)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(displayName);
        ArgumentException.ThrowIfNullOrWhiteSpace(description);
        ArgumentException.ThrowIfNullOrWhiteSpace(selectionText);
        ArgumentException.ThrowIfNullOrWhiteSpace(professionBefore);
        ArgumentException.ThrowIfNullOrWhiteSpace(socialStanding);

        return new BackgroundDefinition
        {
            Id = Guid.NewGuid(),
            BackgroundId = backgroundId,
            DisplayName = displayName,
            Description = description,
            SelectionText = selectionText,
            ProfessionBefore = professionBefore,
            SocialStanding = socialStanding,
            NarrativeHooks = narrativeHooks ?? Array.Empty<string>()
        };
    }

    /// <summary>
    /// Gets whether this background has any narrative hooks defined.
    /// </summary>
    /// <returns>True if narrative hooks exist.</returns>
    public bool HasNarrativeHooks() => NarrativeHooks.Count > 0;

    /// <summary>
    /// Gets the number of narrative hooks for this background.
    /// </summary>
    /// <returns>The count of narrative hooks.</returns>
    public int GetNarrativeHookCount() => NarrativeHooks.Count;

    /// <summary>
    /// Checks if this background has a specific narrative hook by keyword.
    /// </summary>
    /// <param name="keyword">The keyword to search for (case-insensitive).</param>
    /// <returns>True if any hook contains the keyword.</returns>
    public bool HasNarrativeHookContaining(string keyword)
    {
        if (string.IsNullOrWhiteSpace(keyword))
            return false;

        return NarrativeHooks.Any(hook =>
            hook.Contains(keyword, StringComparison.OrdinalIgnoreCase));
    }

    /// <summary>
    /// Gets a summary string suitable for character creation preview.
    /// </summary>
    /// <returns>A formatted summary with profession and standing.</returns>
    public string GetCreationSummary() =>
        $"Profession: {ProfessionBefore}\nStanding: {SocialStanding}";

    /// <inheritdoc />
    public override string ToString() =>
        $"{DisplayName} ({BackgroundId})";
}
```

### 5.3 Background Definitions Table

| Background       | Display Name      | Profession Before               | Social Standing                         |
| ---------------- | ----------------- | ------------------------------- | --------------------------------------- |
| VillageSmith     | Village Smith     | Blacksmith and metalworker      | Respected craftsperson, essential       |
| TravelingHealer  | Traveling Healer  | Itinerant medicine practitioner | Welcomed but sometimes distrusted       |
| RuinDelver       | Ruin Delver       | Scavenger and explorer          | Useful but looked down upon             |
| ClanGuard        | Clan Guard        | Warrior and protector           | Honored defender, trusted by leadership |
| WanderingSkald   | Wandering Skald   | Storyteller and historian       | Entertainer, keeper of lore             |
| OutcastScavenger | Outcast Scavenger | Exile and lone survivor         | Pariah, viewed with suspicion           |

### 5.4 Narrative Hooks Reference Table

| Background       | Narrative Hooks                                                                                                                |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------ |
| VillageSmith     | "Recognize craftsmanship in ruins", "Repair broken equipment more easily", "Clan smiths may offer discounts or quests"         |
| TravelingHealer  | "Recognize diseases and their cures", "Bone-Setters may share knowledge", "Some view you with superstitious fear"              |
| RuinDelver       | "Know ruin layouts and hazards", "Scrap-Tinkers respect your finds", "May have enemies among rival delvers"                    |
| ClanGuard        | "Recognize military formations and tactics", "Other guards trust you more quickly", "May have oaths to uphold or avenge"       |
| WanderingSkald   | "Know old legends that hold clues", "Earn room and board through performance", "Jötun-Readers value your historical knowledge" |
| OutcastScavenger | "Know the wasteland's secrets and dangers", "Other outcasts may offer aid", "Clans may remember why you were cast out"         |

---

## 6. Data Model Changes

### 6.1 New Types Summary

| Type                   | Layer  | Category | Description                             |
| ---------------------- | ------ | -------- | --------------------------------------- |
| `Background`           | Domain | Enum     | Six pre-Silence profession options      |
| `BackgroundDefinition` | Domain | Entity   | Complete background data and properties |

### 6.2 File Locations

```
src/Core/RuneAndRust.Domain/
├── Enums/
│   └── Background.cs                        ← NEW
├── Entities/
│   └── BackgroundDefinition.cs              ← NEW

config/
├── backgrounds.json                         ← NEW (partial)
└── schemas/
    └── backgrounds.schema.json              ← NEW
```

### 6.3 Entity Relationships

```
┌─────────────────┐         ┌─────────────────────┐
│    Background   │◄────────│ BackgroundDefinition│
│     (Enum)      │  1:1    │      (Entity)       │
└─────────────────┘         └─────────────────────┘
                                     │
                                     │ contains
                                     ▼
                           ┌─────────────────────┐
                           │   NarrativeHooks    │
                           │   (List<string>)    │
                           └─────────────────────┘
```

---

## 7. Configuration File Schemas

### 7.1 backgrounds.json (Partial - Definition Section)

**File:** `config/backgrounds.json`

```json
{
    "$schema": "./schemas/backgrounds.schema.json",
    "backgrounds": [
        {
            "backgroundId": "VillageSmith",
            "displayName": "Village Smith",
            "description": "You worked the forge, shaping metal into tools of war and peace. The ring of hammer on anvil was your morning song.",
            "selectionText": "The ring of hammer on anvil was your morning song. You knew the secrets of metal, the temperatures that forge and those that destroy. Every blade that left your hands carried a piece of your spirit.",
            "professionBefore": "Blacksmith and metalworker",
            "socialStanding": "Respected craftsperson, essential to any settlement",
            "narrativeHooks": [
                "Recognize craftsmanship in ruins",
                "Repair broken equipment more easily",
                "Clan smiths may offer discounts or quests"
            ]
        },
        {
            "backgroundId": "TravelingHealer",
            "displayName": "Traveling Healer",
            "description": "You walked between settlements, bringing medicine and hope. You learned the old ways—which herbs heal, which kill, and which do both.",
            "selectionText": "You learned the old ways—which herbs heal, which kill, and which do both. The sick blessed you; the superstitious cursed you. You walked the line between life and death, and death blinked first.",
            "professionBefore": "Itinerant medicine practitioner",
            "socialStanding": "Welcomed but sometimes distrusted",
            "narrativeHooks": [
                "Recognize diseases and their cures",
                "Bone-Setters may share knowledge",
                "Some view you with superstitious fear"
            ]
        },
        {
            "backgroundId": "RuinDelver",
            "displayName": "Ruin Delver",
            "description": "The old places called to you, their secrets waiting to be found. While others feared the dark places, you saw opportunity.",
            "selectionText": "While others feared the dark places, you saw opportunity. Every ruin is a puzzle, every trap a challenge. The dead have no use for treasure, and you have no use for fear.",
            "professionBefore": "Scavenger and explorer",
            "socialStanding": "Useful but looked down upon",
            "narrativeHooks": [
                "Know ruin layouts and hazards",
                "Scrap-Tinkers respect your finds",
                "May have enemies among rival delvers"
            ]
        },
        {
            "backgroundId": "ClanGuard",
            "displayName": "Clan Guard",
            "description": "You stood on the walls, shield in hand, protecting your people. You learned that walls mean nothing without warriors to defend them.",
            "selectionText": "The weight of the shield, the length of the spear—these were your teachers. You learned that walls mean nothing without warriors to defend them. Your oath was to protect, and you intend to keep it.",
            "professionBefore": "Warrior and protector",
            "socialStanding": "Honored defender, trusted by clan leadership",
            "narrativeHooks": [
                "Recognize military formations and tactics",
                "Other guards trust you more quickly",
                "May have oaths to uphold or avenge"
            ]
        },
        {
            "backgroundId": "WanderingSkald",
            "displayName": "Wandering Skald",
            "description": "You carried the stories, the songs, the memories of what was. In a world that has forgotten so much, you remember.",
            "selectionText": "In a world that has forgotten so much, you remember. The sagas live in your voice, and through you, the old heroes never truly die. Your words can inspire courage or bring tears.",
            "professionBefore": "Storyteller and historian",
            "socialStanding": "Entertainer, keeper of lore, welcome at most hearths",
            "narrativeHooks": [
                "Know old legends that hold clues",
                "Earn room and board through performance",
                "Jötun-Readers value your historical knowledge"
            ]
        },
        {
            "backgroundId": "OutcastScavenger",
            "displayName": "Outcast Scavenger",
            "description": "Cast out from your clan, you survived alone in the wastes. They called you unclean. You called yourself alive.",
            "selectionText": "They called you unclean. You called yourself alive. The wastes taught you what the clans never could—how to survive on nothing. Every day is borrowed, and you intend to collect on that debt.",
            "professionBefore": "Exile and lone survivor",
            "socialStanding": "Pariah, viewed with suspicion but grudging respect for survival skills",
            "narrativeHooks": [
                "Know the wasteland's secrets and dangers",
                "Other outcasts may offer aid",
                "Clans may remember why you were cast out"
            ]
        }
    ]
}
```

### 7.2 backgrounds.schema.json

**File:** `config/schemas/backgrounds.schema.json`

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "backgrounds.schema.json",
    "title": "Backgrounds Configuration",
    "description": "Defines background data for the character creation system",
    "type": "object",
    "required": ["backgrounds"],
    "properties": {
        "$schema": {
            "type": "string",
            "description": "JSON schema reference"
        },
        "backgrounds": {
            "type": "array",
            "description": "Array of background definitions",
            "minItems": 6,
            "maxItems": 6,
            "items": {
                "$ref": "#/$defs/backgroundDefinition"
            }
        }
    },
    "$defs": {
        "backgroundDefinition": {
            "type": "object",
            "description": "Definition of a single background",
            "required": [
                "backgroundId",
                "displayName",
                "description",
                "selectionText",
                "professionBefore",
                "socialStanding"
            ],
            "properties": {
                "backgroundId": {
                    "type": "string",
                    "description": "The enum name for this background",
                    "enum": [
                        "VillageSmith",
                        "TravelingHealer",
                        "RuinDelver",
                        "ClanGuard",
                        "WanderingSkald",
                        "OutcastScavenger"
                    ]
                },
                "displayName": {
                    "type": "string",
                    "description": "Display name shown in UI",
                    "minLength": 1,
                    "maxLength": 50
                },
                "description": {
                    "type": "string",
                    "description": "Full description of the background",
                    "minLength": 10,
                    "maxLength": 500
                },
                "selectionText": {
                    "type": "string",
                    "description": "Flavor text for character creation selection",
                    "minLength": 10,
                    "maxLength": 500
                },
                "professionBefore": {
                    "type": "string",
                    "description": "What the character did before the Great Silence",
                    "minLength": 1,
                    "maxLength": 100
                },
                "socialStanding": {
                    "type": "string",
                    "description": "How society views this background",
                    "minLength": 1,
                    "maxLength": 200
                },
                "narrativeHooks": {
                    "type": "array",
                    "description": "Quest and dialogue trigger strings",
                    "items": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 200
                    },
                    "minItems": 0,
                    "maxItems": 10
                }
            },
            "additionalProperties": false
        }
    }
}
```

---

## 8. Logging Specifications

### 8.1 Log Levels by Component

| Component              | Level       | Events                                       |
| ---------------------- | ----------- | -------------------------------------------- |
| `BackgroundDefinition` | Debug       | Definition created, hook lookup performed    |
| `BackgroundProvider`   | Information | Configuration loaded, validation complete    |
| `BackgroundProvider`   | Debug       | Individual background loaded, cache access   |
| `BackgroundProvider`   | Warning     | Missing background in config, using fallback |
| `BackgroundProvider`   | Error       | Configuration file not found, invalid format |

### 8.2 Structured Logging Templates

```csharp
// Debug - Definition created
_logger.LogDebug(
    "BackgroundDefinition created. BackgroundId={BackgroundId}, DisplayName={DisplayName}",
    backgroundId,
    displayName);

// Debug - Narrative hook lookup
_logger.LogDebug(
    "Checking narrative hooks. Background={Background}, Keyword={Keyword}, Found={Found}",
    background,
    keyword,
    found);

// Information - Configuration loaded
_logger.LogInformation(
    "Loaded {Count} background definitions from configuration",
    count);

// Warning - Missing background
_logger.LogWarning(
    "Background {BackgroundId} not found in configuration, using default",
    backgroundId);

// Error - Configuration failure
_logger.LogError(
    "Failed to load backgrounds configuration. Path={Path}, Error={Error}",
    path,
    error);
```

---

## 9. Unit Testing Requirements

### 9.1 Test Count by Feature

| Feature                     | Test Count |
| --------------------------- | ---------- |
| Background enum             | ~3         |
| BackgroundDefinition entity | ~5         |
| **Total**                   | **~8**     |

### 9.2 Test Specifications

#### BackgroundTests.cs

**File:** `tests/RuneAndRust.Domain.UnitTests/Enums/BackgroundTests.cs`

```csharp
[TestFixture]
public class BackgroundTests
{
    [Test]
    public void Background_HasSixValues_CountEquals6();

    [Test]
    public void Background_AllValuesHaveExpectedIntegers_ValuesMatchSpecification();

    [Test]
    public void Background_CanCastToInt_ReturnsCorrectValues();
}
```

#### BackgroundDefinitionTests.cs

**File:** `tests/RuneAndRust.Domain.UnitTests/Entities/BackgroundDefinitionTests.cs`

```csharp
[TestFixture]
public class BackgroundDefinitionTests
{
    [Test]
    public void Create_WithValidParameters_CreatesDefinition();

    [Test]
    public void Create_WithNullDisplayName_ThrowsArgumentException();

    [Test]
    public void Create_WithEmptyDescription_ThrowsArgumentException();

    [Test]
    public void Create_WithNullProfessionBefore_ThrowsArgumentException();

    [Test]
    public void Create_WithNullSocialStanding_ThrowsArgumentException();

    [Test]
    public void HasNarrativeHooks_WithHooks_ReturnsTrue();

    [Test]
    public void HasNarrativeHooks_WithoutHooks_ReturnsFalse();

    [Test]
    public void HasNarrativeHookContaining_WithMatchingKeyword_ReturnsTrue();

    [Test]
    public void HasNarrativeHookContaining_WithNonMatchingKeyword_ReturnsFalse();

    [Test]
    public void GetCreationSummary_ReturnsFormattedString();

    [Test]
    public void ToString_ReturnsDisplayNameAndId();
}
```

---

## 10. Use Cases

### UC-001: Display Background Options

**Actor:** Character Creation UI  
**Flow:** Request all backgrounds → Get definitions → Display names and selection text → Show profession and standing

### UC-002: Get Background Details for Preview

**Actor:** Character Creation Service  
**Flow:** Player hovers/selects background → Get definition → Extract profession, standing, hooks → Display to player

### UC-003: Check Narrative Hook Match

**Actor:** Narrative Event Handler  
**Flow:** Event occurs → Get character's background → Check narrative hooks for keyword → Apply special interaction if match

### UC-004: Display Character Background Summary

**Actor:** Character Sheet View  
**Flow:** Load character → Get background definition → Display profession and social standing → List narrative capabilities

---

## 11. User Stories

### US-001: View Background Selection

**As a** player creating a new character  
**I want to** see all available backgrounds with their descriptions  
**So that** I can choose a profession that fits my desired roleplaying experience

**Acceptance Criteria:**

- All 6 backgrounds displayed with display name
- Selection text shown for each background
- Profession and social standing clearly visible

### US-002: Understand Social Consequences

**As a** player selecting a background  
**I want to** understand how my background affects social interactions  
**So that** I can anticipate NPC reactions and dialogue options

**Acceptance Criteria:**

- Social standing prominently displayed
- Narrative hooks listed as potential advantages
- Warning shown for low-standing backgrounds

### US-003: Recognize Background During Play

**As a** player exploring the world  
**I want my** background to trigger special dialogue and insights  
**So that** my pre-Silence profession feels relevant to the story

**Acceptance Criteria:**

- Narrative hooks trigger when appropriate
- Special dialogue options appear for matching situations
- Background-specific insights provided during exploration

---

## 12. Deliverable Checklist

### Domain Layer

- [x] `Background.cs` enum created in `src/Core/RuneAndRust.Domain/Enums/`
- [x] `BackgroundDefinition.cs` entity created in `src/Core/RuneAndRust.Domain/Entities/`
- [x] All types have complete XML documentation

### Configuration Files

- [x] `config/backgrounds.json` created with all 6 backgrounds (partial - definition only)
- [x] `config/schemas/backgrounds.schema.json` created
- [x] Configuration validates against schema

### Testing

- [x] `BackgroundTests.cs` created
- [x] `BackgroundDefinitionTests.cs` created
- [x] ~8 unit tests passing (18 total: 3 enum + 15 entity)

### Documentation

- [x] `v0.17.1a-changelog.md` created
- [x] Inline code comments complete

---

## 13. Acceptance Criteria

### Functional

- [ ] `Background` enum defines exactly 6 backgrounds with values 0-5
- [ ] `BackgroundDefinition.Create()` validates all string parameters
- [ ] `BackgroundDefinition` stores background ID, display name, description
- [ ] `BackgroundDefinition` stores selection text, profession, social standing
- [ ] `BackgroundDefinition` stores narrative hooks as list of strings
- [ ] `HasNarrativeHooks()` returns true when hooks exist
- [ ] `HasNarrativeHookContaining()` performs case-insensitive search
- [ ] `GetCreationSummary()` returns formatted profession and standing string
- [ ] Village Smith has "Blacksmith and metalworker" as profession
- [ ] Outcast Scavenger has "Pariah" mentioned in social standing
- [ ] All backgrounds have at least 3 narrative hooks defined

### Quality

- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] ~8 unit tests pass
- [ ] Configuration validates against JSON schema
- [ ] All public types have XML documentation

---

## 14. Dependencies

### Required from Prior Versions

| Type           | Location                         | Usage                      |
| -------------- | -------------------------------- | -------------------------- |
| `IEntity`      | `RuneAndRust.Domain/Interfaces/` | Base interface for entity  |
| Config pattern | Various                          | JSON loading approach      |
| Lineage System | v0.17.0                          | Similar definition pattern |

### Provides to v0.17.1b

| Type                   | Usage                      |
| ---------------------- | -------------------------- |
| `Background`           | Referenced by skill grants |
| `BackgroundDefinition` | Extended with SkillGrants  |

### Provides to v0.17.1c

| Type                   | Usage                          |
| ---------------------- | ------------------------------ |
| `Background`           | Referenced by equipment grants |
| `BackgroundDefinition` | Extended with EquipmentGrants  |

### Provides to v0.17.1d-e

| Type                   | Usage                    |
| ---------------------- | ------------------------ |
| `Background`           | Key for provider lookups |
| `BackgroundDefinition` | Returned by provider     |

---

## 15. Future Considerations

### Deferred to v0.17.1b

- **BackgroundSkillGrant Value Object**: Skill bonuses from profession
- **SkillGrantType Enum**: Permanent, StartingBonus, Proficiency types
- **Extension of BackgroundDefinition**: Add SkillGrants property

### Deferred to v0.17.1c

- **BackgroundEquipmentGrant Value Object**: Starting equipment from profession
- **Equipment slot and quantity handling**
- **Extension of BackgroundDefinition**: Add EquipmentGrants property

### Deferred to v0.17.1d

- **IBackgroundProvider Interface**: Access pattern for background data
- **BackgroundProvider Implementation**: Configuration loading

### Deferred to v0.17.1e

- **IBackgroundApplicationService**: Application of background effects
- **BackgroundApplicationResult**: Result of applying background to character
- **BackgroundPreview**: Preview data for character creation UI

### Out of Scope

- **Seventh+ Background Expansion**: Six backgrounds are sufficient for initial release
- **Background Changes Post-Creation**: Background is permanent
- **Custom Background Builder**: Players use predefined backgrounds only
- **Background Synergy with Lineage**: No mechanical bonuses for specific combinations

---

_Document Version: 1.0_  
_Last Updated: 2026-01-27_  
_Author: AI Assistant_
