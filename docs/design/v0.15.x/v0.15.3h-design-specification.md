# v0.15.3h Design Specification: Extended Influence System

**Version:** 0.15.3h
**Theme:** Extended Influence System
**Author:** Claude
**Created:** 2026-01-17
**Status:** Draft
**Parent:** v0.15.3 (Rhetoric Skill Expansion)
**Prerequisites:** v0.15.3g Complete (Cultural Protocols), v0.15.1 Complete (Skill Infrastructure)

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Extended Influence Mechanics](#4-extended-influence-mechanics)
5. [Conviction Levels](#5-conviction-levels)
6. [Influence Pool Accumulation](#6-influence-pool-accumulation)
7. [Influence Status Tracking](#7-influence-status-tracking)
8. [Data Model Changes](#8-data-model-changes)
9. [Services](#9-services)
10. [Configuration](#10-configuration)
11. [Logging Specifications](#11-logging-specifications)
12. [Unit Testing Requirements](#12-unit-testing-requirements)
13. [Use Cases](#13-use-cases)
14. [Deliverable Checklist](#14-deliverable-checklist)
15. [Acceptance Criteria](#15-acceptance-criteria)
16. [Dependencies](#16-dependencies)
17. [Future Considerations](#17-future-considerations)
18. [Document Metadata](#18-document-metadata)

---

## 1. Executive Summary

### 1.1 Purpose

This document provides a comprehensive design specification for v0.15.3h, the Extended Influence System. This system enables players to gradually change deeply-held NPC beliefs over multiple interactions, representing the slow process of shifting someone's worldview, faction loyalty, or core convictions.

Unlike immediate persuasion (single check to grant a request) or negotiation (multi-round to reach a deal), Extended Influence represents sustained, long-term efforts to fundamentally change what an NPC believes. This is essential for faction diplomacy, converting enemies to allies, and story-driven character arcs.

### 1.2 Key Deliverables

| Category | Items | Details |
|----------|-------|---------|
| **Enums** | 2 | `ConvictionLevel`, `InfluenceStatus` |
| **Entities** | 1 | `ExtendedInfluence` |
| **Value Objects** | 1 | `InfluenceAttemptResult` |
| **Services** | 1 | `ExtendedInfluenceService` |
| **Interfaces** | 2 | `IExtendedInfluenceService`, `IExtendedInfluenceRepository` |
| **Configuration** | 1 | `conviction-levels.json` |
| **Unit Tests** | ~4-5 | Per scope breakdown specification |

### 1.3 Architectural Significance

This version establishes the **Accumulated Progress Pattern** for Rhetoric, which parallels:
- Climbing stages in Acrobatics (v0.15.2)
- Terminal infiltration layers in System Bypass (v0.15.4)
- Multi-phase tracking in Wasteland Survival (v0.15.5)

The Extended Influence system demonstrates how single interactions accumulate toward long-term goals, a pattern reusable for faction reputation, quest progression, and relationship building.

---

## 2. Feature Overview

### 2.1 ASCII Feature Tree

```
v0.15.3h Features
├── Extended Influence Entity
│   ├── InfluenceId (unique instance identifier)
│   ├── CharacterId (who is influencing)
│   ├── TargetId (who is being influenced)
│   ├── TargetConviction (belief depth)
│   ├── InfluencePool (accumulated successes)
│   ├── InteractionCount (number of attempts)
│   └── Status (tracking status)
├── Conviction Levels
│   ├── WeakOpinion (5 pool needed)
│   ├── ModerateBelief (10 pool needed)
│   ├── StrongConviction (15 pool needed)
│   ├── CoreBelief (20 pool needed)
│   └── Fanatical (25+ pool needed)
├── Influence Status Tracking
│   ├── Active (influence in progress)
│   ├── Successful (belief changed)
│   ├── Failed (target resistant)
│   └── Stalled (no progress, awaiting event)
└── Influence Mechanics
    ├── Pool accumulation on success
    ├── Resistance increase on failure
    └── Threshold detection for belief change
```

### 2.2 Scope Verification

**From v0.15.3-scope-breakdown.md (v0.15.3h section):**

| Specified Feature | Included | Section |
|-------------------|----------|---------|
| ExtendedInfluence Entity | ✓ | 4, 8 |
| InfluenceId, CharacterId, TargetId | ✓ | 4.2, 8.1 |
| TargetConviction (ConvictionLevel enum) | ✓ | 5 |
| InfluencePool (accumulated successes) | ✓ | 6 |
| InteractionCount | ✓ | 4.2 |
| Status (InfluenceStatus enum) | ✓ | 7 |
| ConvictionLevel Enum (5 levels) | ✓ | 5 |
| InfluenceStatus Enum (4 states) | ✓ | 7 |
| Extended Influence Logic (4 points) | ✓ | 6 |
| Unit Tests (~2 from spec) | ✓ | 12 |

---

## 3. Architecture Diagrams

### 3.1 Extended Influence Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      EXTENDED INFLUENCE FLOW                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  START: Player initiates influence attempt on NPC                           │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │              CHECK FOR EXISTING INFLUENCE                            │    │
│  │                                                                      │    │
│  │  Repository.GetByCharacterAndTarget(playerId, npcId)                │    │
│  │                                                                      │    │
│  │  If exists: Load existing ExtendedInfluence                         │    │
│  │  If not: Create new ExtendedInfluence with NPC's ConvictionLevel    │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    PERFORM RHETORIC CHECK                            │    │
│  │                                                                      │    │
│  │  SkillCheckService.PerformCheck(player, "rhetoric", DC 14)          │    │
│  │                                                                      │    │
│  │  DC based on ConvictionLevel:                                        │    │
│  │  - WeakOpinion: DC 10                                               │    │
│  │  - ModerateBelief: DC 12                                            │    │
│  │  - StrongConviction: DC 14                                          │    │
│  │  - CoreBelief: DC 16                                                │    │
│  │  - Fanatical: DC 18                                                 │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ├─────────────────┬──────────────────┐                            │
│           │ SUCCESS         │ FAILURE          │                            │
│           ▼                 ▼                  │                            │
│  ┌──────────────────┐  ┌──────────────────┐   │                            │
│  │ ADD TO POOL      │  │ ADD RESISTANCE   │   │                            │
│  │                  │  │                  │   │                            │
│  │ Pool += NetSucc  │  │ NPC resistance↑  │   │                            │
│  │ InteractionCount++│ │ (future DC +1)  │   │                            │
│  │                  │  │ InteractionCount++│  │                            │
│  └──────────────────┘  └──────────────────┘   │                            │
│           │                 │                  │                            │
│           └─────────────────┴──────────────────┘                            │
│                             │                                               │
│                             ▼                                               │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │              CHECK CONVICTION THRESHOLD                              │    │
│  │                                                                      │    │
│  │  If InfluencePool >= ConvictionThreshold:                           │    │
│  │      → Status = Successful                                          │    │
│  │      → Trigger belief change event                                  │    │
│  │      → Apply narrative consequences                                  │    │
│  │  Else:                                                              │    │
│  │      → Status remains Active                                        │    │
│  │      → Continue accumulating                                        │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  OUTPUT: InfluenceAttemptResult                                             │
│          {                                                                   │
│              SkillCheckResult: (from rhetoric check)                        │
│              PoolChange: +N or 0                                            │
│              NewPoolTotal: M                                                │
│              ThresholdRequired: T                                           │
│              IsConvictionChanged: bool                                      │
│              Status: InfluenceStatus                                        │
│          }                                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 Conviction Threshold Visualization

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      CONVICTION THRESHOLD LADDER                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ConvictionLevel        PoolRequired     Base DC     Description            │
│  ────────────────────────────────────────────────────────────────────────── │
│                                                                              │
│  ▲  Fanatical              25+           DC 18     "This is my identity"   │
│  │                                                                           │
│  │  ┌─────────────────────────────────────────────────────────────────┐     │
│  │  │                    25 points to shift                           │     │
│  │  │                                                                  │     │
│  │  │  "The Combine is my family. I would die for the Overseer."      │     │
│  │  │  Requires: Major life event + 25 accumulated influence          │     │
│  │  └─────────────────────────────────────────────────────────────────┘     │
│  │                                                                           │
│  │  CoreBelief              20           DC 16     "I know this is true"   │
│  │                                                                           │
│  │  ┌─────────────────────────────────────────────────────────────────┐     │
│  │  │                    20 points to shift                           │     │
│  │  │                                                                  │     │
│  │  │  "The Combine protects us from the wasteland's horrors."        │     │
│  │  │  Deeply held but can be challenged with evidence               │     │
│  │  └─────────────────────────────────────────────────────────────────┘     │
│  │                                                                           │
│  │  StrongConviction        15           DC 14     "I believe firmly"      │
│  │                                                                           │
│  │  ┌─────────────────────────────────────────────────────────────────┐     │
│  │  │                    15 points to shift                           │     │
│  │  │                                                                  │     │
│  │  │  "The Combine's rules exist for good reasons."                  │     │
│  │  │  Held with confidence but open to compelling arguments         │     │
│  │  └─────────────────────────────────────────────────────────────────┘     │
│  │                                                                           │
│  │  ModerateBelief          10           DC 12     "I think this is right" │
│  │                                                                           │
│  │  ┌─────────────────────────────────────────────────────────────────┐     │
│  │  │                    10 points to shift                           │     │
│  │  │                                                                  │     │
│  │  │  "The Combine seems to know what they're doing."                │     │
│  │  │  Casually held, can be swayed with good arguments              │     │
│  │  └─────────────────────────────────────────────────────────────────┘     │
│  │                                                                           │
│  ▼  WeakOpinion              5           DC 10     "I've heard..."         │
│                                                                              │
│     ┌─────────────────────────────────────────────────────────────────┐     │
│     │                     5 points to shift                           │     │
│     │                                                                  │     │
│     │  "I don't know much about the Combine either way."              │     │
│     │  Surface-level opinion, easily changed                          │     │
│     └─────────────────────────────────────────────────────────────────┘     │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Layer Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           LAYER ARCHITECTURE                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                      DOMAIN LAYER                                    │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Entities/                                                           │    │
│  │  └── ExtendedInfluence.cs           ←── NEW (aggregate root)        │    │
│  │                                                                      │    │
│  │  ValueObjects/                                                       │    │
│  │  └── InfluenceAttemptResult.cs      ←── NEW                         │    │
│  │                                                                      │    │
│  │  Enums/                                                              │    │
│  │  ├── ConvictionLevel.cs             ←── NEW                         │    │
│  │  └── InfluenceStatus.cs             ←── NEW                         │    │
│  │                                                                      │    │
│  │  Interfaces/                                                         │    │
│  │  └── IExtendedInfluenceRepository.cs ←── NEW                        │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                  │                                           │
│                                  │ implements                                │
│                                  ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    APPLICATION LAYER                                 │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Services/                                                           │    │
│  │  └── ExtendedInfluenceService.cs    ←── NEW                         │    │
│  │                                                                      │    │
│  │  Interfaces/                                                         │    │
│  │  └── IExtendedInfluenceService.cs   ←── NEW                         │    │
│  │                                                                      │    │
│  │  Dependencies:                                                       │    │
│  │  ├── ISkillCheckService (from v0.15.0c)                             │    │
│  │  ├── IExtendedInfluenceRepository                                   │    │
│  │  └── ILogger<ExtendedInfluenceService>                              │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                  │                                           │
│                                  ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                  CONFIGURATION LAYER                                 │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  config/                                                             │    │
│  │  └── conviction-levels.json         ←── NEW                         │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 Service Interaction Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      SERVICE INTERACTION DIAGRAM                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│                    ┌───────────────────────────────┐                        │
│                    │      Command Handler          │                        │
│                    │   (influence <npc> <belief>)  │                        │
│                    └───────────────┬───────────────┘                        │
│                                    │                                         │
│                                    ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                 IExtendedInfluenceService                            │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  + AttemptInfluence(playerId, targetId, belief, context)            │    │
│  │  + GetInfluenceProgress(playerId, targetId)                          │    │
│  │  + GetActiveInfluences(playerId)                                     │    │
│  │  + CheckConvictionThreshold(influenceId)                             │    │
│  │                                                                      │    │
│  └──────────┬────────────────────────────────┬──────────────────────────┘    │
│             │                                │                               │
│             ▼                                ▼                               │
│  ┌─────────────────────────┐    ┌─────────────────────────────────┐         │
│  │   ISkillCheckService    │    │  IExtendedInfluenceRepository   │         │
│  ├─────────────────────────┤    ├─────────────────────────────────┤         │
│  │                         │    │                                 │         │
│  │  PerformCheck()         │    │  GetById()                      │         │
│  │  (rhetoric skill)       │    │  GetByCharacterAndTarget()      │         │
│  │                         │    │  GetActiveByCharacter()         │         │
│  │  Returns:               │    │  Save()                         │         │
│  │  - NetSuccesses         │    │  Delete()                       │         │
│  │  - SkillOutcome         │    │                                 │         │
│  │                         │    │                                 │         │
│  └─────────────────────────┘    └─────────────────────────────────┘         │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Extended Influence Mechanics

### 4.1 Core Concept

Extended Influence represents a player's ongoing effort to shift an NPC's deeply-held belief. Unlike immediate persuasion checks:

| Aspect | Immediate Persuasion | Extended Influence |
|--------|---------------------|-------------------|
| **Goal** | Grant specific request | Change fundamental belief |
| **Duration** | Single check | Multiple interactions |
| **Progress** | Binary (success/fail) | Accumulated pool |
| **DC Scaling** | Request complexity | Conviction depth |
| **Failure** | Request denied | Resistance increases |
| **Success** | Request granted | Worldview shifts |

### 4.2 ExtendedInfluence Entity Structure

```
ExtendedInfluence (Aggregate Root)
├── Id: Guid (unique instance identifier)
├── CharacterId: Guid (who is influencing)
├── TargetId: Guid (NPC being influenced)
├── TargetName: string (for display)
├── BeliefId: string (which belief is being challenged)
├── BeliefDescription: string (human-readable belief statement)
├── TargetConviction: ConvictionLevel (how deeply held)
├── InfluencePool: int (accumulated successes toward threshold)
├── ResistanceModifier: int (accumulated failures, adds to DC)
├── InteractionCount: int (total attempts)
├── SuccessfulInteractions: int (attempts that added to pool)
├── Status: InfluenceStatus (tracking state)
├── CreatedAt: DateTime (when influence began)
├── LastInteractionAt: DateTime (most recent attempt)
└── ConvictionChangedAt: DateTime? (when belief shifted, if successful)
```

### 4.3 Influence Attempt Logic

**From v0.15.3-scope-breakdown.md:**

1. Each interaction: make Rhetoric check
2. Success: Add successes to pool
3. Failure: NPC resistance increases
4. When pool ≥ conviction threshold: belief changed

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      INFLUENCE ATTEMPT ALGORITHM                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  function AttemptInfluence(playerId, targetId, beliefId):                   │
│                                                                              │
│      // Step 1: Get or create influence tracking                            │
│      influence = repository.GetByCharacterAndTarget(playerId, targetId)     │
│      if influence is null:                                                  │
│          influence = ExtendedInfluence.Create(                              │
│              playerId, targetId, beliefId,                                  │
│              target.GetConvictionLevel(beliefId))                           │
│                                                                              │
│      // Step 2: Calculate DC based on conviction + resistance               │
│      baseDc = GetBaseDcForConviction(influence.TargetConviction)           │
│      adjustedDc = baseDc + influence.ResistanceModifier                     │
│                                                                              │
│      // Step 3: Perform rhetoric check                                      │
│      result = skillCheckService.PerformCheck(                               │
│          player, "rhetoric", adjustedDc)                                    │
│                                                                              │
│      // Step 4: Apply outcome                                               │
│      influence.IncrementInteractionCount()                                  │
│                                                                              │
│      if result.IsSuccess:                                                   │
│          poolGain = result.NetSuccesses  // Add actual successes            │
│          influence.AddToPool(poolGain)                                      │
│          influence.IncrementSuccessfulInteractions()                        │
│      else:                                                                  │
│          influence.IncrementResistance()  // +1 to future DCs              │
│                                                                              │
│      // Step 5: Check threshold                                             │
│      threshold = GetThresholdForConviction(influence.TargetConviction)      │
│      if influence.InfluencePool >= threshold:                               │
│          influence.MarkConvictionChanged()                                  │
│          triggerBeliefChangeEvent(targetId, beliefId)                       │
│                                                                              │
│      // Step 6: Save and return                                             │
│      repository.Save(influence)                                             │
│      return InfluenceAttemptResult.Create(result, influence)                │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. Conviction Levels

### 5.1 ConvictionLevel Enum

**File:** `src/Core/RuneAndRust.Domain/Enums/ConvictionLevel.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Represents how deeply an NPC holds a particular belief.
/// </summary>
/// <remarks>
/// <para>
/// Conviction levels determine:
/// <list type="bullet">
///   <item><description>Base DC for influence attempts</description></item>
///   <item><description>Pool threshold required to change the belief</description></item>
///   <item><description>Narrative weight of the belief change</description></item>
/// </list>
/// </para>
/// <para>
/// Higher conviction requires more accumulated influence points to shift.
/// </para>
/// </remarks>
public enum ConvictionLevel
{
    /// <summary>
    /// Surface-level opinion, easily changed.
    /// </summary>
    /// <remarks>
    /// Base DC: 10, Threshold: 5 pool points.
    /// Example: "I've heard the Combine is powerful."
    /// </remarks>
    WeakOpinion = 0,

    /// <summary>
    /// Casually held belief, can be swayed with good arguments.
    /// </summary>
    /// <remarks>
    /// Base DC: 12, Threshold: 10 pool points.
    /// Example: "The Combine seems to know what they're doing."
    /// </remarks>
    ModerateBelief = 1,

    /// <summary>
    /// Firmly held conviction, requires compelling evidence.
    /// </summary>
    /// <remarks>
    /// Base DC: 14, Threshold: 15 pool points.
    /// Example: "The Combine's rules exist for good reasons."
    /// </remarks>
    StrongConviction = 2,

    /// <summary>
    /// Deeply held core belief, fundamental to worldview.
    /// </summary>
    /// <remarks>
    /// Base DC: 16, Threshold: 20 pool points.
    /// Example: "The Combine protects us from the wasteland's horrors."
    /// </remarks>
    CoreBelief = 3,

    /// <summary>
    /// Identity-defining belief, part of who they are.
    /// </summary>
    /// <remarks>
    /// Base DC: 18, Threshold: 25 pool points.
    /// Example: "I am Combine. I would die for the Overseer."
    /// May require major life events to even begin challenging.
    /// </remarks>
    Fanatical = 4
}
```

### 5.2 Conviction Level Properties

| Level | Base DC | Pool Threshold | Resistance Bonus | Description |
|-------|---------|----------------|------------------|-------------|
| `WeakOpinion` | 10 | 5 | +0 | Surface-level, easily shifted |
| `ModerateBelief` | 12 | 10 | +0 | Casually held, needs good arguments |
| `StrongConviction` | 14 | 15 | +1 per 2 failures | Firm, needs evidence |
| `CoreBelief` | 16 | 20 | +1 per failure | Deep, fundamental to worldview |
| `Fanatical` | 18 | 25 | +2 per failure | Identity-defining, may need events |

### 5.3 Narrative Examples by Conviction Level

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    BELIEF EXAMPLES BY CONVICTION LEVEL                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  FACTION: The Combine                                                       │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  WeakOpinion (5 pool):                                                      │
│  "I've heard the Combine controls the water supply, but I don't know much."│
│  → Easy to sway with basic information                                      │
│                                                                              │
│  ModerateBelief (10 pool):                                                  │
│  "The Combine keeps things orderly. That's better than chaos."              │
│  → Can be convinced with alternative examples                               │
│                                                                              │
│  StrongConviction (15 pool):                                                │
│  "The Combine's rationing system saved my family during the Drought."       │
│  → Personal experience backing it; needs counter-evidence                   │
│                                                                              │
│  CoreBelief (20 pool):                                                      │
│  "Without the Combine, we'd all be dead. They ARE civilization."            │
│  → Fundamental worldview; requires sustained effort + experiences           │
│                                                                              │
│  Fanatical (25 pool):                                                       │
│  "I am a Combine Operative. The Overseer's will is my will."                │
│  → Identity is wrapped in belief; may need betrayal/revelation              │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 6. Influence Pool Accumulation

### 6.1 Pool Accumulation Rules

The influence pool represents accumulated progress toward shifting a belief. The pool grows through successful rhetoric checks.

**Pool Gain on Success:**
```
PoolGain = NetSuccesses from the rhetoric check
```

This means a Critical Success (net ≥ 5) adds significantly more progress than a marginal success (net = 1).

| Check Result | NetSuccesses | Pool Gain | Notes |
|--------------|-------------|-----------|-------|
| Marginal Success | 1 | +1 | Slow progress |
| Full Success | 2-3 | +2-3 | Standard progress |
| Exceptional | 4 | +4 | Good conversation |
| Critical (≥5) | 5+ | +5+ | Breakthrough moment |

### 6.2 Resistance Accumulation

**From Specification:** "Failure: NPC resistance increases"

When influence attempts fail, the NPC becomes more guarded against further attempts.

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      RESISTANCE ACCUMULATION                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  On Failed Influence Attempt:                                               │
│                                                                              │
│  ConvictionLevel        Resistance Increase       Effect on Future DC       │
│  ─────────────────────────────────────────────────────────────────────────  │
│  WeakOpinion            +0                        No penalty                │
│  ModerateBelief         +0                        No penalty                │
│  StrongConviction       +1 per 2 failures         +1 DC every 2nd failure   │
│  CoreBelief             +1 per failure            +1 DC per failure         │
│  Fanatical              +2 per failure            +2 DC per failure         │
│                                                                              │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  Example: Challenging a CoreBelief (base DC 16)                             │
│                                                                              │
│  Attempt 1: Failure → ResistanceModifier = +1 → Future DC = 17             │
│  Attempt 2: Success → Pool +3 → DC still 17                                 │
│  Attempt 3: Failure → ResistanceModifier = +2 → Future DC = 18             │
│  Attempt 4: Success → Pool +2 (total 5) → DC still 18                       │
│  ...                                                                         │
│                                                                              │
│  Maximum Resistance: The ResistanceModifier is capped at 6                  │
│  (prevents infinite DC escalation)                                          │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 6.3 Pool vs Threshold Calculation

```csharp
// Threshold based on conviction level
int threshold = TargetConviction switch
{
    ConvictionLevel.WeakOpinion => 5,
    ConvictionLevel.ModerateBelief => 10,
    ConvictionLevel.StrongConviction => 15,
    ConvictionLevel.CoreBelief => 20,
    ConvictionLevel.Fanatical => 25,
    _ => throw new InvalidOperationException($"Unknown conviction level: {TargetConviction}")
};

// Check if threshold reached
bool isConvictionChanged = InfluencePool >= threshold;
```

---

## 7. Influence Status Tracking

### 7.1 InfluenceStatus Enum

**File:** `src/Core/RuneAndRust.Domain/Enums/InfluenceStatus.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Represents the current state of an extended influence attempt.
/// </summary>
/// <remarks>
/// Extended influence tracking persists across multiple game sessions,
/// allowing players to work on changing NPC beliefs over time.
/// </remarks>
public enum InfluenceStatus
{
    /// <summary>
    /// Influence is in progress, player can continue making attempts.
    /// </summary>
    /// <remarks>
    /// The default state for ongoing influence efforts.
    /// Pool continues accumulating with successful checks.
    /// </remarks>
    Active = 0,

    /// <summary>
    /// Influence succeeded, NPC's belief has been changed.
    /// </summary>
    /// <remarks>
    /// Terminal state indicating the conviction threshold was reached.
    /// The NPC now holds a different belief on this topic.
    /// </remarks>
    Successful = 1,

    /// <summary>
    /// Influence failed, NPC is completely resistant to further attempts.
    /// </summary>
    /// <remarks>
    /// Terminal state reached when resistance becomes too high
    /// or specific failure conditions are triggered.
    /// The NPC may never change their mind on this topic.
    /// </remarks>
    Failed = 2,

    /// <summary>
    /// Influence is stalled, awaiting an external event to continue.
    /// </summary>
    /// <remarks>
    /// Paused state where no progress can be made through conversation.
    /// May require: witnessing contrary evidence, story events,
    /// or passage of time before attempts can resume.
    /// </remarks>
    Stalled = 3
}
```

### 7.2 Status Transitions

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      STATUS STATE MACHINE                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│                        ┌─────────────┐                                      │
│                        │   Active    │◄──────────── Initial State           │
│                        └──────┬──────┘                                      │
│                               │                                              │
│             ┌─────────────────┼─────────────────┬────────────────┐          │
│             │                 │                 │                │          │
│             ▼                 ▼                 ▼                ▼          │
│    ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌───────────┐     │
│    │ Successful  │   │  Continue   │   │   Stalled   │   │  Failed   │     │
│    │  (Terminal) │   │   Active    │   │             │   │ (Terminal)│     │
│    └─────────────┘   └──────┬──────┘   └──────┬──────┘   └───────────┘     │
│           ▲                 │                 │                 ▲          │
│           │                 │                 │                 │          │
│           │                 └─────────────────┘                 │          │
│           │                         │                           │          │
│           │                         ▼                           │          │
│           │                 ┌─────────────┐                     │          │
│           │                 │   Active    │                     │          │
│           │                 │  (resumed)  │                     │          │
│           │                 └──────┬──────┘                     │          │
│           │                        │                            │          │
│           └────────────────────────┴────────────────────────────┘          │
│                                                                              │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  TRANSITIONS:                                                               │
│                                                                              │
│  Active → Successful:   Pool >= Threshold                                   │
│  Active → Continue:     Successful attempt, pool < threshold               │
│  Active → Stalled:      Resistance too high OR fumble consequence          │
│  Active → Failed:       Maximum resistance reached OR quest failure        │
│  Stalled → Active:      External event resolves stall condition            │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 7.3 Stalled Conditions

The `Stalled` status represents situations where further dialogue won't help:

| Stall Trigger | Resume Condition | Example |
|---------------|------------------|---------|
| Resistance ≥ 4 | Wait 24+ hours game time | "I need time to think." |
| Fumble consequence | Complete related quest | "Prove yourself first." |
| Contradicted by evidence | Find counter-evidence | "Show me the records." |
| NPC emotional state | Wait for mood change | "I can't discuss this now." |

---

## 8. Data Model Changes

### 8.1 New Entity: ExtendedInfluence

**File:** `src/Core/RuneAndRust.Domain/Entities/ExtendedInfluence.cs`

```csharp
using RuneAndRust.Domain.Enums;

namespace RuneAndRust.Domain.Entities;

/// <summary>
/// Tracks a player's ongoing effort to change an NPC's deeply-held belief.
/// </summary>
/// <remarks>
/// <para>
/// Extended Influence represents sustained, multi-interaction efforts to shift
/// an NPC's worldview. Unlike single persuasion checks, this tracks accumulated
/// progress toward changing fundamental beliefs.
/// </para>
/// <para>
/// The influence pool accumulates through successful rhetoric checks, while
/// failures increase the NPC's resistance. When the pool reaches the conviction
/// threshold, the belief changes.
/// </para>
/// </remarks>
public class ExtendedInfluence
{
    /// <summary>
    /// Unique identifier for this influence tracking instance.
    /// </summary>
    public Guid Id { get; private set; }

    /// <summary>
    /// The character (player) attempting to influence the target.
    /// </summary>
    public Guid CharacterId { get; private set; }

    /// <summary>
    /// The NPC being influenced.
    /// </summary>
    public Guid TargetId { get; private set; }

    /// <summary>
    /// Display name of the target NPC.
    /// </summary>
    public string TargetName { get; private set; } = string.Empty;

    /// <summary>
    /// Identifier for the specific belief being challenged.
    /// </summary>
    /// <remarks>
    /// Examples: "combine-loyalty", "dvergr-superiority", "magic-distrust"
    /// </remarks>
    public string BeliefId { get; private set; } = string.Empty;

    /// <summary>
    /// Human-readable description of the belief.
    /// </summary>
    /// <remarks>
    /// Examples: "The Combine protects us from chaos."
    /// </remarks>
    public string BeliefDescription { get; private set; } = string.Empty;

    /// <summary>
    /// How deeply the target holds this belief.
    /// </summary>
    /// <remarks>
    /// Determines the base DC and pool threshold required to change it.
    /// </remarks>
    public ConvictionLevel TargetConviction { get; private set; }

    /// <summary>
    /// Accumulated successful influence points toward the threshold.
    /// </summary>
    /// <remarks>
    /// Grows by NetSuccesses on successful rhetoric checks.
    /// When this reaches the threshold for TargetConviction, the belief changes.
    /// </remarks>
    public int InfluencePool { get; private set; }

    /// <summary>
    /// Accumulated DC modifier from failed attempts.
    /// </summary>
    /// <remarks>
    /// Represents the NPC becoming more guarded against influence.
    /// Capped at 6 to prevent impossible DCs.
    /// </remarks>
    public int ResistanceModifier { get; private set; }

    /// <summary>
    /// Total number of influence attempts made.
    /// </summary>
    public int InteractionCount { get; private set; }

    /// <summary>
    /// Number of successful influence attempts (those that added to pool).
    /// </summary>
    public int SuccessfulInteractions { get; private set; }

    /// <summary>
    /// Current tracking status.
    /// </summary>
    public InfluenceStatus Status { get; private set; }

    /// <summary>
    /// When this influence tracking was created.
    /// </summary>
    public DateTime CreatedAt { get; private set; }

    /// <summary>
    /// When the most recent influence attempt was made.
    /// </summary>
    public DateTime LastInteractionAt { get; private set; }

    /// <summary>
    /// When the belief was successfully changed (null if not yet changed).
    /// </summary>
    public DateTime? ConvictionChangedAt { get; private set; }

    /// <summary>
    /// Reason for stall if Status is Stalled.
    /// </summary>
    public string? StallReason { get; private set; }

    /// <summary>
    /// Condition required to resume if stalled.
    /// </summary>
    public string? ResumeCondition { get; private set; }

    // Private constructor for EF Core
    private ExtendedInfluence() { }

    /// <summary>
    /// Creates a new extended influence tracking instance.
    /// </summary>
    /// <param name="characterId">The influencing character's ID.</param>
    /// <param name="targetId">The target NPC's ID.</param>
    /// <param name="targetName">The target's display name.</param>
    /// <param name="beliefId">The belief being challenged.</param>
    /// <param name="beliefDescription">Human-readable belief description.</param>
    /// <param name="conviction">How deeply the target holds this belief.</param>
    /// <returns>A new ExtendedInfluence instance.</returns>
    public static ExtendedInfluence Create(
        Guid characterId,
        Guid targetId,
        string targetName,
        string beliefId,
        string beliefDescription,
        ConvictionLevel conviction)
    {
        ArgumentNullException.ThrowIfNull(targetName);
        ArgumentNullException.ThrowIfNull(beliefId);
        ArgumentNullException.ThrowIfNull(beliefDescription);

        return new ExtendedInfluence
        {
            Id = Guid.NewGuid(),
            CharacterId = characterId,
            TargetId = targetId,
            TargetName = targetName,
            BeliefId = beliefId,
            BeliefDescription = beliefDescription,
            TargetConviction = conviction,
            InfluencePool = 0,
            ResistanceModifier = 0,
            InteractionCount = 0,
            SuccessfulInteractions = 0,
            Status = InfluenceStatus.Active,
            CreatedAt = DateTime.UtcNow,
            LastInteractionAt = DateTime.UtcNow,
            ConvictionChangedAt = null,
            StallReason = null,
            ResumeCondition = null
        };
    }

    /// <summary>
    /// Gets the pool threshold required to change this conviction level.
    /// </summary>
    public int GetThreshold() => TargetConviction switch
    {
        ConvictionLevel.WeakOpinion => 5,
        ConvictionLevel.ModerateBelief => 10,
        ConvictionLevel.StrongConviction => 15,
        ConvictionLevel.CoreBelief => 20,
        ConvictionLevel.Fanatical => 25,
        _ => throw new InvalidOperationException($"Unknown conviction level: {TargetConviction}")
    };

    /// <summary>
    /// Gets the base DC for influence attempts against this conviction level.
    /// </summary>
    public int GetBaseDc() => TargetConviction switch
    {
        ConvictionLevel.WeakOpinion => 10,
        ConvictionLevel.ModerateBelief => 12,
        ConvictionLevel.StrongConviction => 14,
        ConvictionLevel.CoreBelief => 16,
        ConvictionLevel.Fanatical => 18,
        _ => throw new InvalidOperationException($"Unknown conviction level: {TargetConviction}")
    };

    /// <summary>
    /// Gets the current effective DC including resistance modifier.
    /// </summary>
    public int GetEffectiveDc() => GetBaseDc() + ResistanceModifier;

    /// <summary>
    /// Gets the progress toward the threshold as a percentage.
    /// </summary>
    public double GetProgressPercentage() => (double)InfluencePool / GetThreshold() * 100;

    /// <summary>
    /// Checks if the conviction threshold has been reached.
    /// </summary>
    public bool IsThresholdReached() => InfluencePool >= GetThreshold();

    /// <summary>
    /// Adds successful influence points to the pool.
    /// </summary>
    /// <param name="netSuccesses">Net successes from the rhetoric check.</param>
    /// <exception cref="InvalidOperationException">If influence is not active.</exception>
    public void AddToPool(int netSuccesses)
    {
        if (Status != InfluenceStatus.Active)
        {
            throw new InvalidOperationException(
                $"Cannot add to pool when status is {Status}");
        }

        if (netSuccesses <= 0)
        {
            throw new ArgumentException(
                "Net successes must be positive", nameof(netSuccesses));
        }

        InfluencePool += netSuccesses;
        SuccessfulInteractions++;
        LastInteractionAt = DateTime.UtcNow;

        // Check if threshold reached
        if (IsThresholdReached())
        {
            Status = InfluenceStatus.Successful;
            ConvictionChangedAt = DateTime.UtcNow;
        }
    }

    /// <summary>
    /// Increases NPC resistance after a failed attempt.
    /// </summary>
    /// <exception cref="InvalidOperationException">If influence is not active.</exception>
    public void IncrementResistance()
    {
        if (Status != InfluenceStatus.Active)
        {
            throw new InvalidOperationException(
                $"Cannot increment resistance when status is {Status}");
        }

        // Resistance increment varies by conviction level
        int increment = TargetConviction switch
        {
            ConvictionLevel.WeakOpinion => 0,
            ConvictionLevel.ModerateBelief => 0,
            ConvictionLevel.StrongConviction => InteractionCount % 2 == 0 ? 1 : 0,
            ConvictionLevel.CoreBelief => 1,
            ConvictionLevel.Fanatical => 2,
            _ => 1
        };

        ResistanceModifier = Math.Min(6, ResistanceModifier + increment);
        LastInteractionAt = DateTime.UtcNow;

        // Check for stall condition (resistance too high relative to progress)
        if (ResistanceModifier >= 4 && InfluencePool < GetThreshold() / 2)
        {
            Stall("Target has become too guarded.", "Wait for time to pass or find evidence.");
        }
    }

    /// <summary>
    /// Increments the interaction count.
    /// </summary>
    public void IncrementInteractionCount()
    {
        InteractionCount++;
        LastInteractionAt = DateTime.UtcNow;
    }

    /// <summary>
    /// Marks the influence as stalled.
    /// </summary>
    /// <param name="reason">Why the influence is stalled.</param>
    /// <param name="resumeCondition">What's needed to resume.</param>
    public void Stall(string reason, string resumeCondition)
    {
        ArgumentNullException.ThrowIfNull(reason);
        ArgumentNullException.ThrowIfNull(resumeCondition);

        Status = InfluenceStatus.Stalled;
        StallReason = reason;
        ResumeCondition = resumeCondition;
    }

    /// <summary>
    /// Resumes a stalled influence attempt.
    /// </summary>
    /// <exception cref="InvalidOperationException">If not stalled.</exception>
    public void Resume()
    {
        if (Status != InfluenceStatus.Stalled)
        {
            throw new InvalidOperationException(
                $"Cannot resume when status is {Status}");
        }

        Status = InfluenceStatus.Active;
        StallReason = null;
        ResumeCondition = null;

        // Reduce resistance on resume (time heals)
        ResistanceModifier = Math.Max(0, ResistanceModifier - 2);
    }

    /// <summary>
    /// Marks the influence as permanently failed.
    /// </summary>
    /// <param name="reason">Why it failed permanently.</param>
    public void Fail(string reason)
    {
        Status = InfluenceStatus.Failed;
        StallReason = reason;
    }

    /// <summary>
    /// Marks the conviction as changed (called when threshold reached).
    /// </summary>
    public void MarkConvictionChanged()
    {
        Status = InfluenceStatus.Successful;
        ConvictionChangedAt = DateTime.UtcNow;
    }
}
```

### 8.2 New Value Object: InfluenceAttemptResult

**File:** `src/Core/RuneAndRust.Domain/ValueObjects/InfluenceAttemptResult.cs`

```csharp
using RuneAndRust.Domain.Enums;

namespace RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Result of a single extended influence attempt.
/// </summary>
/// <remarks>
/// Combines the skill check outcome with influence progress tracking.
/// </remarks>
/// <param name="SkillCheckSucceeded">Whether the rhetoric check succeeded.</param>
/// <param name="NetSuccesses">Net successes from the roll.</param>
/// <param name="PoolChange">How much the influence pool changed (+N or 0).</param>
/// <param name="NewPoolTotal">Current pool total after this attempt.</param>
/// <param name="ThresholdRequired">Pool required to change the belief.</param>
/// <param name="ResistanceChange">How much resistance increased (0 on success).</param>
/// <param name="NewResistanceTotal">Current resistance modifier.</param>
/// <param name="IsConvictionChanged">True if threshold was reached.</param>
/// <param name="Status">Current influence status after this attempt.</param>
/// <param name="InteractionNumber">Which attempt this was (1-indexed).</param>
public readonly record struct InfluenceAttemptResult(
    bool SkillCheckSucceeded,
    int NetSuccesses,
    int PoolChange,
    int NewPoolTotal,
    int ThresholdRequired,
    int ResistanceChange,
    int NewResistanceTotal,
    bool IsConvictionChanged,
    InfluenceStatus Status,
    int InteractionNumber)
{
    /// <summary>
    /// Progress toward threshold as a value between 0 and 1.
    /// </summary>
    public double ProgressRatio => ThresholdRequired > 0
        ? Math.Min(1.0, (double)NewPoolTotal / ThresholdRequired)
        : 0;

    /// <summary>
    /// Progress as a percentage (0-100).
    /// </summary>
    public int ProgressPercentage => (int)(ProgressRatio * 100);

    /// <summary>
    /// Remaining pool points needed to change conviction.
    /// </summary>
    public int RemainingPool => Math.Max(0, ThresholdRequired - NewPoolTotal);

    /// <summary>
    /// Whether this was a breakthrough interaction (pool change ≥ 3).
    /// </summary>
    public bool IsBreakthrough => PoolChange >= 3;

    /// <summary>
    /// Whether the influence attempt is still active.
    /// </summary>
    public bool IsActive => Status == InfluenceStatus.Active;

    /// <summary>
    /// Creates a result for a successful influence attempt.
    /// </summary>
    public static InfluenceAttemptResult Success(
        int netSuccesses,
        int newPoolTotal,
        int threshold,
        int interactionNumber,
        InfluenceStatus status) => new(
            SkillCheckSucceeded: true,
            NetSuccesses: netSuccesses,
            PoolChange: netSuccesses,
            NewPoolTotal: newPoolTotal,
            ThresholdRequired: threshold,
            ResistanceChange: 0,
            NewResistanceTotal: 0,
            IsConvictionChanged: status == InfluenceStatus.Successful,
            Status: status,
            InteractionNumber: interactionNumber);

    /// <summary>
    /// Creates a result for a failed influence attempt.
    /// </summary>
    public static InfluenceAttemptResult Failure(
        int resistanceIncrease,
        int newResistanceTotal,
        int currentPool,
        int threshold,
        int interactionNumber,
        InfluenceStatus status) => new(
            SkillCheckSucceeded: false,
            NetSuccesses: 0,
            PoolChange: 0,
            NewPoolTotal: currentPool,
            ThresholdRequired: threshold,
            ResistanceChange: resistanceIncrease,
            NewResistanceTotal: newResistanceTotal,
            IsConvictionChanged: false,
            Status: status,
            InteractionNumber: interactionNumber);

    /// <summary>
    /// Gets a description of the result for display.
    /// </summary>
    public string ToDisplayString()
    {
        if (IsConvictionChanged)
        {
            return $"Conviction changed! ({NewPoolTotal}/{ThresholdRequired} pool)";
        }

        if (SkillCheckSucceeded)
        {
            if (IsBreakthrough)
            {
                return $"Breakthrough! +{PoolChange} influence ({ProgressPercentage}% progress)";
            }
            return $"Progress made: +{PoolChange} influence ({ProgressPercentage}% toward goal)";
        }

        if (Status == InfluenceStatus.Stalled)
        {
            return $"Stalled - target needs time. ({ProgressPercentage}% progress)";
        }

        if (Status == InfluenceStatus.Failed)
        {
            return "Failed - target is now completely resistant.";
        }

        if (ResistanceChange > 0)
        {
            return $"No progress. Target is more guarded (+{ResistanceChange} resistance)";
        }

        return $"No progress made. ({ProgressPercentage}% toward goal)";
    }
}
```

### 8.3 Entity Summary Table

| Entity | Type | File | Description |
|--------|------|------|-------------|
| `ExtendedInfluence` | Entity (Aggregate Root) | `Domain/Entities/ExtendedInfluence.cs` | Tracks influence progress |

### 8.4 Value Object Summary Table

| Value Object | Type | File | Description |
|--------------|------|------|-------------|
| `InfluenceAttemptResult` | Record Struct | `Domain/ValueObjects/InfluenceAttemptResult.cs` | Single attempt outcome |

### 8.5 Enum Summary Table

| Enum | File | Values |
|------|------|--------|
| `ConvictionLevel` | `Domain/Enums/ConvictionLevel.cs` | `WeakOpinion`, `ModerateBelief`, `StrongConviction`, `CoreBelief`, `Fanatical` |
| `InfluenceStatus` | `Domain/Enums/InfluenceStatus.cs` | `Active`, `Successful`, `Failed`, `Stalled` |

---

## 9. Services

### 9.1 IExtendedInfluenceService Interface

**File:** `src/Core/RuneAndRust.Application/Interfaces/IExtendedInfluenceService.cs`

```csharp
using RuneAndRust.Domain.Entities;
using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.ValueObjects;

namespace RuneAndRust.Application.Interfaces;

/// <summary>
/// Service for managing extended influence attempts on NPC beliefs.
/// </summary>
public interface IExtendedInfluenceService
{
    /// <summary>
    /// Attempts to influence an NPC's belief.
    /// </summary>
    /// <param name="characterId">The influencing character's ID.</param>
    /// <param name="targetId">The target NPC's ID.</param>
    /// <param name="beliefId">The belief being challenged.</param>
    /// <param name="advantageType">Advantage/disadvantage for the check.</param>
    /// <returns>Result of the influence attempt.</returns>
    InfluenceAttemptResult AttemptInfluence(
        Guid characterId,
        Guid targetId,
        string beliefId,
        AdvantageType advantageType = AdvantageType.Normal);

    /// <summary>
    /// Gets the current influence progress for a character-target pair.
    /// </summary>
    /// <param name="characterId">The influencing character's ID.</param>
    /// <param name="targetId">The target NPC's ID.</param>
    /// <returns>The influence tracking, or null if none exists.</returns>
    ExtendedInfluence? GetInfluenceProgress(Guid characterId, Guid targetId);

    /// <summary>
    /// Gets the influence progress for a specific belief.
    /// </summary>
    /// <param name="characterId">The influencing character's ID.</param>
    /// <param name="targetId">The target NPC's ID.</param>
    /// <param name="beliefId">The specific belief.</param>
    /// <returns>The influence tracking, or null if none exists.</returns>
    ExtendedInfluence? GetInfluenceProgress(Guid characterId, Guid targetId, string beliefId);

    /// <summary>
    /// Gets all active influence attempts for a character.
    /// </summary>
    /// <param name="characterId">The character's ID.</param>
    /// <returns>List of active influence tracking instances.</returns>
    IReadOnlyList<ExtendedInfluence> GetActiveInfluences(Guid characterId);

    /// <summary>
    /// Gets all influence attempts on a specific NPC.
    /// </summary>
    /// <param name="targetId">The target NPC's ID.</param>
    /// <returns>List of influence tracking instances targeting this NPC.</returns>
    IReadOnlyList<ExtendedInfluence> GetInfluencesOnTarget(Guid targetId);

    /// <summary>
    /// Resumes a stalled influence attempt.
    /// </summary>
    /// <param name="influenceId">The influence tracking ID.</param>
    /// <returns>True if successfully resumed.</returns>
    bool ResumeInfluence(Guid influenceId);

    /// <summary>
    /// Checks if conviction threshold is reached for an influence.
    /// </summary>
    /// <param name="influenceId">The influence tracking ID.</param>
    /// <returns>True if threshold reached.</returns>
    bool CheckConvictionThreshold(Guid influenceId);
}
```

### 9.2 IExtendedInfluenceRepository Interface

**File:** `src/Core/RuneAndRust.Domain/Interfaces/IExtendedInfluenceRepository.cs`

```csharp
using RuneAndRust.Domain.Entities;
using RuneAndRust.Domain.Enums;

namespace RuneAndRust.Domain.Interfaces;

/// <summary>
/// Repository for extended influence tracking persistence.
/// </summary>
public interface IExtendedInfluenceRepository
{
    /// <summary>
    /// Gets an influence tracking instance by ID.
    /// </summary>
    ExtendedInfluence? GetById(Guid id);

    /// <summary>
    /// Gets influence tracking for a character-target pair.
    /// </summary>
    ExtendedInfluence? GetByCharacterAndTarget(Guid characterId, Guid targetId);

    /// <summary>
    /// Gets influence tracking for a specific belief.
    /// </summary>
    ExtendedInfluence? GetByCharacterTargetAndBelief(
        Guid characterId, Guid targetId, string beliefId);

    /// <summary>
    /// Gets all active influences for a character.
    /// </summary>
    IReadOnlyList<ExtendedInfluence> GetActiveByCharacter(Guid characterId);

    /// <summary>
    /// Gets all influences by status.
    /// </summary>
    IReadOnlyList<ExtendedInfluence> GetByStatus(InfluenceStatus status);

    /// <summary>
    /// Gets all influences targeting an NPC.
    /// </summary>
    IReadOnlyList<ExtendedInfluence> GetByTarget(Guid targetId);

    /// <summary>
    /// Saves an influence tracking instance.
    /// </summary>
    void Save(ExtendedInfluence influence);

    /// <summary>
    /// Deletes an influence tracking instance.
    /// </summary>
    void Delete(Guid id);
}
```

### 9.3 ExtendedInfluenceService Implementation

**File:** `src/Core/RuneAndRust.Application/Services/ExtendedInfluenceService.cs`

```csharp
using Microsoft.Extensions.Logging;
using RuneAndRust.Application.Interfaces;
using RuneAndRust.Domain.Entities;
using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.Interfaces;
using RuneAndRust.Domain.ValueObjects;

namespace RuneAndRust.Application.Services;

/// <summary>
/// Service for managing extended influence attempts on NPC beliefs.
/// </summary>
/// <remarks>
/// <para>
/// Extended influence represents sustained, multi-interaction efforts to shift
/// an NPC's worldview. This service handles:
/// <list type="bullet">
///   <item><description>Tracking influence progress per character-target-belief</description></item>
///   <item><description>Performing rhetoric checks with conviction-based DCs</description></item>
///   <item><description>Accumulating pool points and resistance</description></item>
///   <item><description>Detecting when conviction thresholds are reached</description></item>
/// </list>
/// </para>
/// </remarks>
public class ExtendedInfluenceService : IExtendedInfluenceService
{
    private readonly IExtendedInfluenceRepository _repository;
    private readonly ISkillCheckService _skillCheckService;
    private readonly INpcService _npcService;
    private readonly IPlayerService _playerService;
    private readonly ILogger<ExtendedInfluenceService> _logger;

    /// <summary>
    /// Creates a new ExtendedInfluenceService.
    /// </summary>
    public ExtendedInfluenceService(
        IExtendedInfluenceRepository repository,
        ISkillCheckService skillCheckService,
        INpcService npcService,
        IPlayerService playerService,
        ILogger<ExtendedInfluenceService> logger)
    {
        _repository = repository ?? throw new ArgumentNullException(nameof(repository));
        _skillCheckService = skillCheckService ?? throw new ArgumentNullException(nameof(skillCheckService));
        _npcService = npcService ?? throw new ArgumentNullException(nameof(npcService));
        _playerService = playerService ?? throw new ArgumentNullException(nameof(playerService));
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));

        _logger.LogInformation("ExtendedInfluenceService initialized");
    }

    /// <inheritdoc />
    public InfluenceAttemptResult AttemptInfluence(
        Guid characterId,
        Guid targetId,
        string beliefId,
        AdvantageType advantageType = AdvantageType.Normal)
    {
        ArgumentNullException.ThrowIfNull(beliefId);

        _logger.LogDebug(
            "Influence attempt: {CharacterId} -> {TargetId} on belief '{BeliefId}'",
            characterId, targetId, beliefId);

        // Get player and NPC
        var player = _playerService.GetById(characterId);
        if (player is null)
        {
            _logger.LogWarning("Player not found: {CharacterId}", characterId);
            throw new InvalidOperationException($"Player not found: {characterId}");
        }

        var npc = _npcService.GetById(targetId);
        if (npc is null)
        {
            _logger.LogWarning("NPC not found: {TargetId}", targetId);
            throw new InvalidOperationException($"NPC not found: {targetId}");
        }

        // Get or create influence tracking
        var influence = _repository.GetByCharacterTargetAndBelief(characterId, targetId, beliefId);
        if (influence is null)
        {
            var conviction = npc.GetConvictionLevel(beliefId);
            var beliefDescription = npc.GetBeliefDescription(beliefId);

            influence = ExtendedInfluence.Create(
                characterId,
                targetId,
                npc.Name,
                beliefId,
                beliefDescription,
                conviction);

            _logger.LogInformation(
                "Created new influence tracking: {CharacterId} -> {TargetName} ({BeliefId}, {Conviction})",
                characterId, npc.Name, beliefId, conviction);
        }

        // Check if influence can continue
        if (influence.Status != InfluenceStatus.Active)
        {
            _logger.LogDebug(
                "Influence not active: {InfluenceId} has status {Status}",
                influence.Id, influence.Status);

            return InfluenceAttemptResult.Failure(
                resistanceIncrease: 0,
                newResistanceTotal: influence.ResistanceModifier,
                currentPool: influence.InfluencePool,
                threshold: influence.GetThreshold(),
                interactionNumber: influence.InteractionCount,
                status: influence.Status);
        }

        // Calculate effective DC
        int effectiveDc = influence.GetEffectiveDc();

        _logger.LogDebug(
            "Performing rhetoric check: DC {DC} (base {Base} + {Resistance} resistance)",
            effectiveDc, influence.GetBaseDc(), influence.ResistanceModifier);

        // Perform rhetoric check
        var checkResult = _skillCheckService.PerformCheckWithDC(
            player,
            "rhetoric",
            effectiveDc,
            $"Influence {beliefId}",
            advantageType);

        // Increment interaction count
        influence.IncrementInteractionCount();

        // Process result
        InfluenceAttemptResult result;
        int previousResistance = influence.ResistanceModifier;

        if (checkResult.IsSuccess)
        {
            int netSuccesses = checkResult.DiceResult.NetSuccesses;
            influence.AddToPool(netSuccesses);

            _logger.LogInformation(
                "Influence success: +{Pool} to pool (now {Total}/{Threshold}), status {Status}",
                netSuccesses, influence.InfluencePool, influence.GetThreshold(), influence.Status);

            result = InfluenceAttemptResult.Success(
                netSuccesses: netSuccesses,
                newPoolTotal: influence.InfluencePool,
                threshold: influence.GetThreshold(),
                interactionNumber: influence.InteractionCount,
                status: influence.Status);
        }
        else
        {
            influence.IncrementResistance();
            int resistanceChange = influence.ResistanceModifier - previousResistance;

            _logger.LogDebug(
                "Influence failure: resistance +{Change} (now {Total}), status {Status}",
                resistanceChange, influence.ResistanceModifier, influence.Status);

            result = InfluenceAttemptResult.Failure(
                resistanceIncrease: resistanceChange,
                newResistanceTotal: influence.ResistanceModifier,
                currentPool: influence.InfluencePool,
                threshold: influence.GetThreshold(),
                interactionNumber: influence.InteractionCount,
                status: influence.Status);
        }

        // Save updated influence
        _repository.Save(influence);

        return result;
    }

    /// <inheritdoc />
    public ExtendedInfluence? GetInfluenceProgress(Guid characterId, Guid targetId)
    {
        return _repository.GetByCharacterAndTarget(characterId, targetId);
    }

    /// <inheritdoc />
    public ExtendedInfluence? GetInfluenceProgress(
        Guid characterId, Guid targetId, string beliefId)
    {
        return _repository.GetByCharacterTargetAndBelief(characterId, targetId, beliefId);
    }

    /// <inheritdoc />
    public IReadOnlyList<ExtendedInfluence> GetActiveInfluences(Guid characterId)
    {
        return _repository.GetActiveByCharacter(characterId);
    }

    /// <inheritdoc />
    public IReadOnlyList<ExtendedInfluence> GetInfluencesOnTarget(Guid targetId)
    {
        return _repository.GetByTarget(targetId);
    }

    /// <inheritdoc />
    public bool ResumeInfluence(Guid influenceId)
    {
        var influence = _repository.GetById(influenceId);
        if (influence is null)
        {
            _logger.LogWarning("Influence not found: {InfluenceId}", influenceId);
            return false;
        }

        if (influence.Status != InfluenceStatus.Stalled)
        {
            _logger.LogDebug(
                "Cannot resume influence {InfluenceId}: status is {Status}",
                influenceId, influence.Status);
            return false;
        }

        influence.Resume();
        _repository.Save(influence);

        _logger.LogInformation(
            "Resumed influence {InfluenceId}: {CharacterId} -> {TargetName}",
            influenceId, influence.CharacterId, influence.TargetName);

        return true;
    }

    /// <inheritdoc />
    public bool CheckConvictionThreshold(Guid influenceId)
    {
        var influence = _repository.GetById(influenceId);
        if (influence is null)
        {
            return false;
        }

        return influence.IsThresholdReached();
    }
}
```

### 9.4 Service Dependencies

| Service | Dependency | Purpose |
|---------|------------|---------|
| `ExtendedInfluenceService` | `IExtendedInfluenceRepository` | Persistence |
| `ExtendedInfluenceService` | `ISkillCheckService` | Rhetoric checks |
| `ExtendedInfluenceService` | `INpcService` | NPC data access |
| `ExtendedInfluenceService` | `IPlayerService` | Player data access |
| `ExtendedInfluenceService` | `ILogger<>` | Logging |

---

## 10. Configuration

### 10.1 conviction-levels.json

**File:** `config/conviction-levels.json`

```json
{
  "$schema": "./schemas/conviction-levels.schema.json",
  "convictionLevels": [
    {
      "id": "weak-opinion",
      "name": "Weak Opinion",
      "description": "Surface-level opinion, easily changed.",
      "poolRequired": 5,
      "baseDc": 10,
      "resistancePerFailure": 0,
      "examples": [
        "I've heard the Combine is powerful.",
        "I don't know much about the Dvergr."
      ]
    },
    {
      "id": "moderate-belief",
      "name": "Moderate Belief",
      "description": "Casually held belief, can be swayed with good arguments.",
      "poolRequired": 10,
      "baseDc": 12,
      "resistancePerFailure": 0,
      "examples": [
        "The Combine keeps things orderly.",
        "Magic seems dangerous to me."
      ]
    },
    {
      "id": "strong-conviction",
      "name": "Strong Conviction",
      "description": "Firmly held conviction, requires compelling evidence.",
      "poolRequired": 15,
      "baseDc": 14,
      "resistancePerFailure": 0.5,
      "resistanceNote": "+1 per 2 failures",
      "examples": [
        "The Combine's rules saved my family.",
        "The old ways are better."
      ]
    },
    {
      "id": "core-belief",
      "name": "Core Belief",
      "description": "Deeply held core belief, fundamental to worldview.",
      "poolRequired": 20,
      "baseDc": 16,
      "resistancePerFailure": 1,
      "examples": [
        "The Combine IS civilization.",
        "Magic corrupts absolutely."
      ]
    },
    {
      "id": "fanatical",
      "name": "Fanatical",
      "description": "Identity-defining belief, part of who they are.",
      "poolRequired": 25,
      "baseDc": 18,
      "resistancePerFailure": 2,
      "requiresEvent": true,
      "eventNote": "May require life-changing event before challenging",
      "examples": [
        "I am Combine. The Overseer's will is my will.",
        "The runes speak through me."
      ]
    }
  ],
  "globalSettings": {
    "maxResistance": 6,
    "stallThreshold": 4,
    "resumeResistanceReduction": 2
  }
}
```

### 10.2 Configuration Schema

**File:** `config/schemas/conviction-levels.schema.json`

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Conviction Levels Configuration",
  "type": "object",
  "required": ["convictionLevels", "globalSettings"],
  "properties": {
    "convictionLevels": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "name", "description", "poolRequired", "baseDc", "resistancePerFailure"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for this conviction level"
          },
          "name": {
            "type": "string",
            "description": "Display name"
          },
          "description": {
            "type": "string",
            "description": "Description of this conviction level"
          },
          "poolRequired": {
            "type": "integer",
            "minimum": 1,
            "description": "Influence pool points required to change this conviction"
          },
          "baseDc": {
            "type": "integer",
            "minimum": 1,
            "description": "Base DC for rhetoric checks at this conviction level"
          },
          "resistancePerFailure": {
            "type": "number",
            "minimum": 0,
            "description": "Resistance increase per failed attempt"
          },
          "resistanceNote": {
            "type": "string",
            "description": "Clarification of resistance calculation"
          },
          "requiresEvent": {
            "type": "boolean",
            "description": "Whether external event is needed before challenging"
          },
          "eventNote": {
            "type": "string",
            "description": "Description of event requirement"
          },
          "examples": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Example belief statements at this level"
          }
        }
      }
    },
    "globalSettings": {
      "type": "object",
      "required": ["maxResistance", "stallThreshold", "resumeResistanceReduction"],
      "properties": {
        "maxResistance": {
          "type": "integer",
          "description": "Maximum resistance modifier cap"
        },
        "stallThreshold": {
          "type": "integer",
          "description": "Resistance level that triggers stall"
        },
        "resumeResistanceReduction": {
          "type": "integer",
          "description": "Resistance reduction when resuming"
        }
      }
    }
  }
}
```

---

## 11. Logging Specifications

### 11.1 Log Levels by Component

| Component | Level | Events |
|-----------|-------|--------|
| `ExtendedInfluenceService` | Information | New influence created, success with pool gain, conviction changed |
| `ExtendedInfluenceService` | Debug | Rhetoric check details, resistance changes, stall conditions |
| `ExtendedInfluenceService` | Warning | Player/NPC not found, influence not active |
| `ExtendedInfluence` (Entity) | Debug | Pool additions, resistance increments, status transitions |

### 11.2 Log Message Formats

```
[Information] Created new influence tracking: {CharacterId} -> {TargetName} ({BeliefId}, {Conviction})
[Information] Influence success: +{Pool} to pool (now {Total}/{Threshold}), status {Status}
[Information] Conviction changed: {TargetName} on belief {BeliefId}
[Information] Resumed influence {InfluenceId}: {CharacterId} -> {TargetName}
[Debug] Influence attempt: {CharacterId} -> {TargetId} on belief '{BeliefId}'
[Debug] Performing rhetoric check: DC {DC} (base {Base} + {Resistance} resistance)
[Debug] Influence failure: resistance +{Change} (now {Total}), status {Status}
[Debug] Influence not active: {InfluenceId} has status {Status}
[Warning] Player not found: {CharacterId}
[Warning] NPC not found: {TargetId}
[Warning] Influence not found: {InfluenceId}
```

---

## 12. Unit Testing Requirements

### 12.1 Test Count by Feature

**From v0.15.3-scope-breakdown.md:** ~2 tests specified

| Feature | Test Count | Notes |
|---------|------------|-------|
| Influence pool accumulation | 1 | Pool increases on success |
| Belief change on threshold | 1 | Status changes when pool >= threshold |
| **Total** | **~2** | Per specification |

### 12.2 Test Specifications

**File:** `tests/RuneAndRust.Domain.UnitTests/Entities/ExtendedInfluenceTests.cs`

```csharp
[TestFixture]
public class ExtendedInfluenceTests
{
    [Test]
    public void AddToPool_AccumulatesSuccessesCorrectly()
    {
        // Arrange
        var influence = ExtendedInfluence.Create(
            characterId: Guid.NewGuid(),
            targetId: Guid.NewGuid(),
            targetName: "Test NPC",
            beliefId: "test-belief",
            beliefDescription: "A test belief",
            conviction: ConvictionLevel.ModerateBelief);

        // Act
        influence.AddToPool(3);  // First success: +3
        influence.AddToPool(2);  // Second success: +2

        // Assert
        Assert.That(influence.InfluencePool, Is.EqualTo(5));
        Assert.That(influence.SuccessfulInteractions, Is.EqualTo(2));
    }

    [Test]
    public void AddToPool_TriggersConvictionChange_WhenThresholdReached()
    {
        // Arrange: ModerateBelief requires 10 pool
        var influence = ExtendedInfluence.Create(
            characterId: Guid.NewGuid(),
            targetId: Guid.NewGuid(),
            targetName: "Test NPC",
            beliefId: "test-belief",
            beliefDescription: "A test belief",
            conviction: ConvictionLevel.ModerateBelief);

        // Act: Add enough to reach threshold
        influence.AddToPool(5);
        Assert.That(influence.Status, Is.EqualTo(InfluenceStatus.Active));

        influence.AddToPool(5);  // Now at 10, threshold reached

        // Assert
        Assert.That(influence.InfluencePool, Is.EqualTo(10));
        Assert.That(influence.Status, Is.EqualTo(InfluenceStatus.Successful));
        Assert.That(influence.ConvictionChangedAt, Is.Not.Null);
    }
}
```

**File:** `tests/RuneAndRust.Application.UnitTests/Services/ExtendedInfluenceServiceTests.cs`

```csharp
[TestFixture]
public class ExtendedInfluenceServiceTests
{
    private Mock<IExtendedInfluenceRepository> _mockRepository = null!;
    private Mock<ISkillCheckService> _mockSkillCheckService = null!;
    private Mock<INpcService> _mockNpcService = null!;
    private Mock<IPlayerService> _mockPlayerService = null!;
    private Mock<ILogger<ExtendedInfluenceService>> _mockLogger = null!;
    private ExtendedInfluenceService _service = null!;

    [SetUp]
    public void SetUp()
    {
        _mockRepository = new Mock<IExtendedInfluenceRepository>();
        _mockSkillCheckService = new Mock<ISkillCheckService>();
        _mockNpcService = new Mock<INpcService>();
        _mockPlayerService = new Mock<IPlayerService>();
        _mockLogger = new Mock<ILogger<ExtendedInfluenceService>>();

        _service = new ExtendedInfluenceService(
            _mockRepository.Object,
            _mockSkillCheckService.Object,
            _mockNpcService.Object,
            _mockPlayerService.Object,
            _mockLogger.Object);
    }

    [Test]
    public void AttemptInfluence_CreatesNewTracking_WhenNoneExists()
    {
        // Arrange
        var playerId = Guid.NewGuid();
        var npcId = Guid.NewGuid();
        var beliefId = "combine-loyalty";

        var player = CreateTestPlayer(playerId);
        var npc = CreateTestNpc(npcId, ConvictionLevel.StrongConviction);

        _mockPlayerService.Setup(s => s.GetById(playerId)).Returns(player);
        _mockNpcService.Setup(s => s.GetById(npcId)).Returns(npc);
        _mockRepository.Setup(r => r.GetByCharacterTargetAndBelief(playerId, npcId, beliefId))
            .Returns((ExtendedInfluence?)null);

        var successfulCheck = CreateSuccessfulSkillCheckResult(netSuccesses: 2);
        _mockSkillCheckService
            .Setup(s => s.PerformCheckWithDC(player, "rhetoric", 14, It.IsAny<string>(), AdvantageType.Normal))
            .Returns(successfulCheck);

        // Act
        var result = _service.AttemptInfluence(playerId, npcId, beliefId);

        // Assert
        Assert.That(result.SkillCheckSucceeded, Is.True);
        Assert.That(result.PoolChange, Is.EqualTo(2));
        _mockRepository.Verify(r => r.Save(It.IsAny<ExtendedInfluence>()), Times.Once);
    }

    [Test]
    public void AttemptInfluence_IncrementsResistance_OnFailure()
    {
        // Arrange
        var playerId = Guid.NewGuid();
        var npcId = Guid.NewGuid();
        var beliefId = "combine-loyalty";

        var player = CreateTestPlayer(playerId);
        var npc = CreateTestNpc(npcId, ConvictionLevel.CoreBelief);  // +1 resistance per failure

        var existingInfluence = ExtendedInfluence.Create(
            playerId, npcId, "Test NPC", beliefId, "Test", ConvictionLevel.CoreBelief);

        _mockPlayerService.Setup(s => s.GetById(playerId)).Returns(player);
        _mockNpcService.Setup(s => s.GetById(npcId)).Returns(npc);
        _mockRepository.Setup(r => r.GetByCharacterTargetAndBelief(playerId, npcId, beliefId))
            .Returns(existingInfluence);

        var failedCheck = CreateFailedSkillCheckResult();
        _mockSkillCheckService
            .Setup(s => s.PerformCheckWithDC(player, "rhetoric", 16, It.IsAny<string>(), AdvantageType.Normal))
            .Returns(failedCheck);

        // Act
        var result = _service.AttemptInfluence(playerId, npcId, beliefId);

        // Assert
        Assert.That(result.SkillCheckSucceeded, Is.False);
        Assert.That(result.ResistanceChange, Is.EqualTo(1));
        Assert.That(result.NewResistanceTotal, Is.EqualTo(1));
    }

    // Helper methods
    private static Player CreateTestPlayer(Guid id) => /* create test player */;
    private static NpcEntity CreateTestNpc(Guid id, ConvictionLevel conviction) => /* create test NPC */;
    private static SkillCheckResult CreateSuccessfulSkillCheckResult(int netSuccesses) => /* create result */;
    private static SkillCheckResult CreateFailedSkillCheckResult() => /* create result */;
}
```

---

## 13. Use Cases

### 13.1 UC-1533h-001: Begin Extended Influence

**Actor:** Player
**Flow:** Player initiates influence on NPC belief → System creates tracking → First attempt made

**Steps:**
1. Player selects NPC and chooses "Influence Belief" option
2. System displays NPC's beliefs that can be challenged
3. Player selects target belief (e.g., "Combine Loyalty")
4. System determines NPC's `ConvictionLevel` for that belief
5. System creates `ExtendedInfluence` tracking instance
6. First rhetoric check is performed
7. Result displayed with pool progress

### 13.2 UC-1533h-002: Continue Influence Attempt

**Actor:** Player
**Flow:** Player returns to NPC → Continues previous influence → Pool accumulates

**Steps:**
1. Player interacts with NPC they're already influencing
2. System retrieves existing `ExtendedInfluence` tracking
3. System calculates effective DC (base + resistance)
4. Player makes rhetoric check
5. On success: `NetSuccesses` added to pool
6. On failure: Resistance incremented (if applicable)
7. Progress update displayed

### 13.3 UC-1533h-003: Conviction Changed

**Actor:** System
**Flow:** Pool reaches threshold → Belief changes → Consequences apply

**Steps:**
1. Player's rhetoric check succeeds
2. Pool increase brings total to threshold (or beyond)
3. `Status` set to `Successful`
4. `ConvictionChangedAt` timestamp recorded
5. Belief change event triggered
6. Narrative consequences apply (dialogue options, faction response)
7. Player notified of breakthrough

### 13.4 UC-1533h-004: Influence Stalled

**Actor:** System
**Flow:** Resistance too high → Influence stalls → Await event to continue

**Steps:**
1. Rhetoric check fails
2. Resistance incremented to stall threshold (4+)
3. Pool progress less than 50% of threshold
4. `Status` set to `Stalled`
5. `StallReason` and `ResumeCondition` set
6. Player informed that NPC needs time or evidence
7. Future attempts blocked until resume condition met

---

## 14. Deliverable Checklist

### 14.1 Domain Layer

- [ ] `ConvictionLevel.cs` enum created in `Domain/Enums/`
- [ ] `InfluenceStatus.cs` enum created in `Domain/Enums/`
- [ ] `ExtendedInfluence.cs` entity created in `Domain/Entities/`
- [ ] `InfluenceAttemptResult.cs` value object created in `Domain/ValueObjects/`
- [ ] `IExtendedInfluenceRepository.cs` interface created in `Domain/Interfaces/`

### 14.2 Application Layer

- [ ] `IExtendedInfluenceService.cs` interface created in `Application/Interfaces/`
- [ ] `ExtendedInfluenceService.cs` implementation created in `Application/Services/`

### 14.3 Configuration Files

- [ ] `config/conviction-levels.json` created
- [ ] `config/schemas/conviction-levels.schema.json` created

### 14.4 Unit Tests

- [ ] `ExtendedInfluenceTests.cs` created (~2 tests per spec)
- [ ] Influence pool accumulation verified
- [ ] Belief change on threshold verified

### 14.5 Documentation

- [ ] This design specification complete
- [ ] Code XML documentation complete on all public members

---

## 15. Acceptance Criteria

### 15.1 Functional

- [ ] Influence pool accumulates on successful rhetoric checks
- [ ] Pool gain equals `NetSuccesses` from the check
- [ ] Conviction level determines base DC and threshold
- [ ] Resistance increases on failure (per conviction rules)
- [ ] Belief changes when pool ≥ threshold
- [ ] Status transitions correctly (Active → Successful/Stalled/Failed)
- [ ] Stalled influences can be resumed
- [ ] Maximum resistance cap (6) enforced

### 15.2 Quality

- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] ~2 unit tests pass (per specification)
- [ ] XML documentation complete on all public members
- [ ] Configuration files validate against schema

---

## 16. Dependencies

### 16.1 Required from Prior Versions

| Version | Component | Usage in v0.15.3h |
|---------|-----------|-------------------|
| v0.15.0c | `ISkillCheckService` | Performs rhetoric checks |
| v0.15.0c | `SkillCheckResult` | Provides `NetSuccesses` |
| v0.15.0a | `DiceRollResult` | Provides `NetSuccesses`, `IsFumble` |
| v0.15.1a | `SkillContext` | Contextual modifiers for checks |
| v0.15.3a | `NpcDisposition` | May affect influence DC |
| v0.10.x | Status effects | Potential status applications |

### 16.2 Provides to Future Versions

| Consumer | Component | Usage |
|----------|-----------|-------|
| Dialogue System | `ExtendedInfluence` | Track belief state for conversation options |
| Faction System | `InfluenceStatus.Successful` | Trigger faction relationship changes |
| Quest System | Conviction changes | Unlock/alter quest paths |
| NPC AI | Belief changes | Alter NPC behavior patterns |

---

## 17. Future Considerations

### 17.1 Deferred to v0.15.3i (Specialization Integration)

- Thul's `[Voice of Reason]` - Failed persuasion doesn't lock options
- Kupmaðr's `[Sniff Out Lies]` - Bonus to detect NPC deception
- Myrk-gengr's `[Maintain Cover]` - Stay in character under pressure
- These abilities may affect extended influence mechanics

### 17.2 Out of Scope

- **Faction-wide influence** - Influencing entire factions (future version)
- **Belief network effects** - Changing one belief affecting others (future)
- **Evidence items** - Physical proof that boosts influence (may tie to inventory)
- **Time-based decay** - Influence pool degrading over time (not in spec)

---

## 18. Document Metadata

---

*Document Version: 1.0*
*Last Updated: 2026-01-17*
*Author: Claude*

---

*This design specification provides the detailed blueprint for implementing v0.15.3h Extended Influence System. This is part of the Rhetoric Skill Expansion (v0.15.3) and depends on the Skill Infrastructure (v0.15.1) and Dice Pool Refactor (v0.15.0).*
