{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "attributes.schema.json",
    "title": "Attributes Configuration",
    "description": "Configuration for core character attributes, archetype-recommended builds for Simple mode allocation, point-buy cost structure for Advanced mode, and derived stat formulas. Defines the five fundamental attributes (Might, Finesse, Wits, Will, Sturdiness) with display properties, relationship mappings to derived stats and skills, pre-configured attribute allocations for each archetype, the tiered cost table for point-buy allocation, and configurable formulas for calculating derived stats (HP, Stamina, Aether Pool, Initiative, Soak, Movement Speed, Carrying Capacity).",
    "type": "object",
    "required": ["attributes", "recommendedBuilds", "pointBuy", "derivedStats"],
    "properties": {
        "$schema": {
            "type": "string",
            "description": "JSON schema reference for editor support"
        },
        "attributes": {
            "type": "array",
            "description": "Array of core attribute definitions. Must contain exactly 5 attributes, one for each CoreAttribute enum value.",
            "minItems": 5,
            "maxItems": 5,
            "items": {
                "$ref": "#/definitions/attributeDefinition"
            }
        },
        "recommendedBuilds": {
            "type": "array",
            "description": "Archetype-recommended attribute builds for Simple mode. Each entry defines a pre-configured allocation that totals to the archetype's point budget (15 for most, 14 for Adept).",
            "minItems": 1,
            "maxItems": 10,
            "items": {
                "$ref": "#/definitions/recommendedBuild"
            }
        },
        "pointBuy": {
            "$ref": "#/definitions/pointBuyConfiguration"
        },
        "derivedStats": {
            "$ref": "#/definitions/derivedStatsConfiguration"
        }
    },
    "additionalProperties": false,
    "definitions": {
        "attributeDefinition": {
            "type": "object",
            "description": "Definition of a single core attribute with display properties and relationship mappings.",
            "required": [
                "attribute",
                "displayName",
                "shortDescription",
                "detailedDescription",
                "affectedStats",
                "affectedSkills"
            ],
            "properties": {
                "attribute": {
                    "type": "string",
                    "description": "The CoreAttribute enum value name. Must match the C# enum exactly.",
                    "enum": ["Might", "Finesse", "Wits", "Will", "Sturdiness"]
                },
                "displayName": {
                    "type": "string",
                    "description": "Uppercase display name for UI presentation (e.g., 'MIGHT', 'FINESSE').",
                    "pattern": "^[A-Z]+$",
                    "minLength": 1,
                    "maxLength": 20
                },
                "shortDescription": {
                    "type": "string",
                    "description": "One-line summary for tooltips and compact displays.",
                    "minLength": 10,
                    "maxLength": 100
                },
                "detailedDescription": {
                    "type": "string",
                    "description": "Full explanation for help screens and detailed views.",
                    "minLength": 50,
                    "maxLength": 500
                },
                "affectedStats": {
                    "type": "array",
                    "description": "Derived stats influenced by this attribute (e.g., 'Melee Damage', 'Max HP').",
                    "items": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 50
                    },
                    "minItems": 1,
                    "maxItems": 10
                },
                "affectedSkills": {
                    "type": "array",
                    "description": "Skills that use this attribute for checks (e.g., 'Combat', 'Lore').",
                    "items": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 50
                    },
                    "minItems": 1,
                    "maxItems": 10
                }
            },
            "additionalProperties": false
        },
        "recommendedBuild": {
            "type": "object",
            "description": "A pre-configured attribute allocation for a specific archetype, used in Simple mode during character creation.",
            "required": [
                "archetypeId",
                "might",
                "finesse",
                "wits",
                "will",
                "sturdiness",
                "totalPoints"
            ],
            "properties": {
                "archetypeId": {
                    "type": "string",
                    "description": "Lowercase archetype identifier matching the archetype system (e.g., 'warrior', 'mystic').",
                    "pattern": "^[a-z][a-z0-9-]*$",
                    "minLength": 1,
                    "maxLength": 50
                },
                "might": {
                    "type": "integer",
                    "description": "Recommended Might attribute value (1-10).",
                    "minimum": 1,
                    "maximum": 10
                },
                "finesse": {
                    "type": "integer",
                    "description": "Recommended Finesse attribute value (1-10).",
                    "minimum": 1,
                    "maximum": 10
                },
                "wits": {
                    "type": "integer",
                    "description": "Recommended Wits attribute value (1-10).",
                    "minimum": 1,
                    "maximum": 10
                },
                "will": {
                    "type": "integer",
                    "description": "Recommended Will attribute value (1-10).",
                    "minimum": 1,
                    "maximum": 10
                },
                "sturdiness": {
                    "type": "integer",
                    "description": "Recommended Sturdiness attribute value (1-10).",
                    "minimum": 1,
                    "maximum": 10
                },
                "totalPoints": {
                    "type": "integer",
                    "description": "Total point cost of this build. Typically 15 for most archetypes, 14 for Adept.",
                    "minimum": 1,
                    "maximum": 50
                }
            },
            "additionalProperties": false
        },
        "pointBuyConfiguration": {
            "type": "object",
            "description": "Configuration for the point-buy attribute allocation system used in Advanced mode during character creation. Defines starting point pools, attribute value constraints, and the tiered cost table.",
            "required": [
                "startingPoints",
                "adeptStartingPoints",
                "minAttributeValue",
                "maxAttributeValue",
                "costTable"
            ],
            "properties": {
                "startingPoints": {
                    "type": "integer",
                    "description": "Standard starting point pool for most archetypes (Warrior, Skirmisher, Mystic).",
                    "minimum": 1,
                    "maximum": 50
                },
                "adeptStartingPoints": {
                    "type": "integer",
                    "description": "Reduced starting point pool for the Adept archetype, balancing broader utility access.",
                    "minimum": 1,
                    "maximum": 50
                },
                "minAttributeValue": {
                    "type": "integer",
                    "description": "Minimum value for any attribute. All attributes start at this value in Advanced mode.",
                    "minimum": 1,
                    "maximum": 5
                },
                "maxAttributeValue": {
                    "type": "integer",
                    "description": "Maximum value any attribute can reach through point-buy allocation.",
                    "minimum": 5,
                    "maximum": 20
                },
                "costTable": {
                    "type": "array",
                    "description": "Ordered cost entries for each target value above the minimum. Standard tier (values 2-8) costs 1 point each, premium tier (values 9-10) costs 2 points each.",
                    "minItems": 1,
                    "maxItems": 20,
                    "items": {
                        "$ref": "#/definitions/pointBuyCostEntry"
                    }
                }
            },
            "additionalProperties": false
        },
        "pointBuyCostEntry": {
            "type": "object",
            "description": "A single entry in the point-buy cost table, defining the cost to reach a specific attribute value.",
            "required": [
                "targetValue",
                "individualCost",
                "cumulativeCost"
            ],
            "properties": {
                "targetValue": {
                    "type": "integer",
                    "description": "The attribute value this cost applies to (2-10). Base value of 1 has no cost entry.",
                    "minimum": 2,
                    "maximum": 20
                },
                "individualCost": {
                    "type": "integer",
                    "description": "Points required to increment from the previous value to this value. 1 for standard tier (2-8), 2 for premium tier (9-10).",
                    "minimum": 1,
                    "maximum": 10
                },
                "cumulativeCost": {
                    "type": "integer",
                    "description": "Total points required to reach this value from the base value of 1.",
                    "minimum": 1,
                    "maximum": 50
                }
            },
            "additionalProperties": false
        },
        "derivedStatsConfiguration": {
            "type": "object",
            "description": "Configuration for derived stat formulas. Each property defines a formula for calculating one derived stat from core attributes, archetype bonuses, and lineage bonuses/multipliers.",
            "required": [
                "maxHp",
                "maxStamina",
                "maxAetherPool",
                "initiative",
                "soak",
                "movementSpeed",
                "carryingCapacity"
            ],
            "properties": {
                "maxHp": {
                    "$ref": "#/definitions/derivedStatFormula",
                    "description": "Formula for maximum hit points. Primarily scaled by Sturdiness with archetype and lineage bonuses."
                },
                "maxStamina": {
                    "$ref": "#/definitions/derivedStatFormula",
                    "description": "Formula for maximum stamina. Scaled by Finesse and Might with archetype bonuses."
                },
                "maxAetherPool": {
                    "$ref": "#/definitions/derivedStatFormula",
                    "description": "Formula for maximum Aether pool. Scaled by Will and Wits with archetype bonuses and Rune-Marked lineage multiplier."
                },
                "initiative": {
                    "$ref": "#/definitions/derivedStatFormula",
                    "description": "Formula for combat initiative. Scaled by Finesse and Wits (half)."
                },
                "soak": {
                    "$ref": "#/definitions/derivedStatFormula",
                    "description": "Formula for passive damage reduction. Scaled by Sturdiness (half) with Iron-Blooded lineage bonus."
                },
                "movementSpeed": {
                    "$ref": "#/definitions/derivedStatFormula",
                    "description": "Formula for base movement speed in tiles per turn. Base of 5 with Vargr-Kin lineage bonus."
                },
                "carryingCapacity": {
                    "$ref": "#/definitions/derivedStatFormula",
                    "description": "Formula for maximum carrying weight. Scaled by Might."
                }
            },
            "additionalProperties": false
        },
        "derivedStatFormula": {
            "type": "object",
            "description": "A formula for calculating a single derived stat. Combines a base value with attribute scaling, optional archetype bonuses, optional lineage bonuses, and optional lineage multipliers.",
            "required": [
                "baseValue"
            ],
            "properties": {
                "baseValue": {
                    "type": "integer",
                    "description": "The flat base value added before any scaling or bonuses (e.g., 50 for Max HP, 20 for Max Stamina, 5 for Movement Speed).",
                    "minimum": 0,
                    "maximum": 1000
                },
                "attributeScaling": {
                    "type": "object",
                    "description": "Mapping of CoreAttribute names to their scaling multipliers. Keys must match CoreAttribute enum values (Might, Finesse, Wits, Will, Sturdiness). Values can be integers or decimals (e.g., 10 for Sturdiness in HP, 0.5 for Wits in Initiative).",
                    "patternProperties": {
                        "^(Might|Finesse|Wits|Will|Sturdiness)$": {
                            "type": "number",
                            "description": "Scaling multiplier for this attribute. The attribute value is multiplied by this factor and added to the stat.",
                            "minimum": 0,
                            "maximum": 100
                        }
                    },
                    "additionalProperties": false
                },
                "archetypeBonuses": {
                    "type": "object",
                    "description": "Mapping of lowercase archetype identifiers to flat bonus values added to the stat.",
                    "patternProperties": {
                        "^[a-z][a-z0-9-]*$": {
                            "type": "integer",
                            "description": "Flat bonus added for this archetype.",
                            "minimum": 0,
                            "maximum": 1000
                        }
                    },
                    "additionalProperties": false
                },
                "lineageBonuses": {
                    "type": "object",
                    "description": "Mapping of lowercase lineage identifiers to flat bonus values added to the stat.",
                    "patternProperties": {
                        "^[a-z][a-z0-9-]*$": {
                            "type": "integer",
                            "description": "Flat bonus added for this lineage.",
                            "minimum": 0,
                            "maximum": 1000
                        }
                    },
                    "additionalProperties": false
                },
                "lineageMultipliers": {
                    "type": "object",
                    "description": "Mapping of lowercase lineage identifiers to multiplicative factors applied after all additive bonuses. A value of 1.1 means +10%.",
                    "patternProperties": {
                        "^[a-z][a-z0-9-]*$": {
                            "type": "number",
                            "description": "Multiplicative factor for this lineage. Applied after base + scaling + bonuses.",
                            "minimum": 0.1,
                            "maximum": 10.0
                        }
                    },
                    "additionalProperties": false
                }
            },
            "additionalProperties": false
        }
    }
}
