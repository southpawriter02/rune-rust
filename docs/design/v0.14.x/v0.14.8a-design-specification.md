# v0.14.8a Design Specification: Dice Types Schema

**Version:** 0.14.8a
**Parent:** v0.14.8 (Dice Configuration Schemas)
**Prerequisites:** v0.14.7 Complete (Descriptor Configuration Schemas)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Schema Root Definition](#4-schema-root-definition)
   - 4.1 [Root Configuration Properties](#41-root-configuration-properties)
   - 4.2 [DieTypes Array Structure](#42-dietypes-array-structure)
5. [DieType Definition](#5-dietype-definition)
   - 5.1 [Core Properties](#51-core-properties)
   - 5.2 [Computed Properties](#52-computed-properties)
   - 5.3 [Display Properties](#53-display-properties)
6. [DiceExpression Definition](#6-diceexpression-definition)
   - 6.1 [Expression Components](#61-expression-components)
   - 6.2 [Expression Parsing](#62-expression-parsing)
7. [DiceExpressionPattern Definition](#7-diceexpressionpattern-definition)
   - 7.1 [Pattern Syntax](#71-pattern-syntax)
   - 7.2 [Capture Groups](#72-capture-groups)
8. [Standard Die Types](#8-standard-die-types)
   - 8.1 [Standard RPG Dice](#81-standard-rpg-dice)
   - 8.2 [Custom Die Support](#82-custom-die-support)
9. [Validation Rules](#9-validation-rules)
   - 9.1 [Die Type ID Pattern](#91-die-type-id-pattern)
   - 9.2 [Faces Validation](#92-faces-validation)
   - 9.3 [Value Range Validation](#93-value-range-validation)
   - 9.4 [Expression Pattern Validation](#94-expression-pattern-validation)
10. [Configuration Schema](#10-configuration-schema)
11. [Configuration File](#11-configuration-file)
12. [Data Model Changes](#12-data-model-changes)
13. [Logging Specifications](#13-logging-specifications)
14. [Unit Testing Requirements](#14-unit-testing-requirements)
15. [Use Cases](#15-use-cases)
16. [Deliverable Checklist](#16-deliverable-checklist)
17. [Acceptance Criteria](#17-acceptance-criteria)
18. [Dependencies](#18-dependencies)
19. [Future Considerations](#19-future-considerations)
20. [Appendix: Schema Validation Examples](#20-appendix-schema-validation-examples)

---

## 1. Executive Summary

Version 0.14.8a introduces the **Dice Types Schema** (`dice-types.schema.json`), which provides a comprehensive JSON schema for defining valid die types, dice expression patterns, and validation rules. This schema enables full customization of dice types used throughout the game system without code changes.

The Dice Types Schema validates die definitions including standard RPG dice (d4, d6, d8, d10, d12, d20, d100) and supports custom die types with arbitrary face counts. It also defines the dice expression pattern (`^\d+d\d+([+-]\d+)?$`) used by other configuration files such as skills.json, weapons.json, hazards.json, and terrain.json.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Schema Files** | `dice-types.schema.json` |
| **Schema Definitions** | `DieType`, `DiceExpression`, `DiceExpressionPattern` |
| **Configuration Files** | `dice-types.json` with standard dice |
| **Tests** | ~6 new unit tests |

### Architectural Significance

This version provides:
- **Standardized die types** - Central definition of valid dice (d4, d6, d8, d10, d12, d20, d100)
- **Custom die support** - Arbitrary face counts (d7, d30, etc.) for modding
- **Expression validation** - Pattern for validating dice notation across all configs
- **Display metadata** - Color, icon, and description for UI rendering
- **Computed statistics** - Min, max, and average values for probability display

### Relationship to Other Schemas

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                   v0.14.8 DICE CONFIGURATION SCHEMAS                         │
└─────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────┐
  │  v0.14.8a: dice-types.schema.json ◀── THIS VERSION (DIE DEFINITIONS)   │
  │  v0.14.8b: dice-mechanics.schema.json (pools, criticals, advantage)    │
  └─────────────────────────────────────────────────────────────────────────┘

  Configuration Files Using Dice Expressions:
  ├── config/skills.json → baseDicePool: "1d10"
  ├── config/weapons.json → damageDice: "1d8", "2d6"
  ├── config/hazards.json → dice: "1d6", "2d6"
  ├── config/terrain.json → damageOnEntry: "1d6", "1d8"
  └── config/dice-types.json → Die type definitions (NEW)

  Shared Definitions:
  • Die type ID pattern: ^d\d+$ (d followed by number)
  • Dice expression pattern: ^\d+d\d+([+-]\d+)?$
  • Schema location: config/schemas/
  • Minimum faces: 2 (coin flip minimum)
```

---

## 2. Feature Overview

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      DICE TYPES SCHEMA FEATURE TREE                          │
└─────────────────────────────────────────────────────────────────────────────┘

dice-types.schema.json
├── Root Configuration
│   ├── $schema reference
│   ├── version (optional)
│   ├── dieTypes[] array
│   └── expressionPattern definition
│
├── DieType Definition
│   ├── Core Properties
│   │   ├── id (d followed by number, e.g., "d6")
│   │   ├── name (display name)
│   │   └── faces (integer >= 2)
│   │
│   ├── Value Range
│   │   ├── minValue (default: 1)
│   │   ├── maxValue (computed: minValue + faces - 1)
│   │   └── average (computed: (min + max) / 2)
│   │
│   ├── Classification
│   │   ├── isStandard (boolean, default: true)
│   │   └── sortOrder (integer >= 0)
│   │
│   └── Display Properties
│       ├── color (optional, hex color)
│       ├── iconId (optional, icon reference)
│       └── description (optional, usage notes)
│
├── DiceExpression Definition
│   ├── count (number of dice)
│   ├── dieType (references DieType.id)
│   ├── modifier (+N or -N bonus)
│   └── raw (original expression string)
│
└── DiceExpressionPattern
    ├── pattern (regex for validation)
    ├── captureGroups (regex group descriptions)
    └── examples (valid expression examples)
```

---

## 3. Architecture Diagrams

### 3.1 Dice Types Configuration Structure

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     DICE TYPES CONFIGURATION STRUCTURE                       │
└─────────────────────────────────────────────────────────────────────────────┘

                            dice-types.json
                 ┌──────────────────────────────────────┐
                 │  $schema: reference                  │
                 │  version: "1.0.0" (optional)         │
                 │  dieTypes: [ ... ]                   │
                 │  expressionPattern: { ... }          │
                 └──────────────┬───────────────────────┘
                                │
        ┌───────────────────────┴───────────────────────────┐
        │                                                   │
        ▼                                                   ▼
┌───────────────────────────┐                  ┌───────────────────────────┐
│       dieTypes[]          │                  │    expressionPattern      │
│───────────────────────────│                  │───────────────────────────│
│ [0]: DieType (d4)         │                  │ pattern: regex string     │
│ [1]: DieType (d6)         │                  │ captureGroups: { ... }    │
│ [2]: DieType (d8)         │                  │ examples: [ ... ]         │
│ [3]: DieType (d10)        │                  └───────────────────────────┘
│ [4]: DieType (d12)        │
│ [5]: DieType (d20)        │
│ [6]: DieType (d100)       │
│ ... (extensible)          │
└───────────────┬───────────┘
                │
                ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                               DieType                                        │
│─────────────────────────────────────────────────────────────────────────────│
│  id: "d6"                                                                   │
│  name: "Six-sided Die"                                                      │
│  faces: 6                                                                   │
│  minValue: 1 (default)                                                      │
│  maxValue: 6 (computed)                                                     │
│  average: 3.5 (computed)                                                    │
│  isStandard: true (default)                                                 │
│  sortOrder: 1                                                               │
│  color: "#4CAF50" (optional)                                                │
│  iconId: "dice_d6" (optional)                                               │
│  description: "Common damage die, hazard effects" (optional)                │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 Dice Expression Parsing Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       DICE EXPRESSION PARSING FLOW                           │
└─────────────────────────────────────────────────────────────────────────────┘

                      Input: "2d6+3"
                              │
                              ▼
                  ┌───────────────────────┐
                  │ Match against pattern │
                  │ ^\d+d\d+([+-]\d+)?$   │
                  └───────────┬───────────┘
                              │
                              ▼
                  ┌───────────────────────┐
                  │ Pattern match?        │
                  └───────────┬───────────┘
                              │
              ┌───────────────┴───────────────┐
              │ No                            │ Yes
              ▼                               ▼
    ┌───────────────────┐         ┌───────────────────────┐
    │ Invalid expression│         │ Extract capture groups│
    │ Log error         │         └───────────┬───────────┘
    │ Return null       │                     │
    └───────────────────┘                     ▼
                              ┌─────────────────────────────┐
                              │ Group 1: Count = "2"        │
                              │ Group 2: Die type = "d6"    │
                              │ Group 3: Modifier = "+3"    │
                              └───────────────┬─────────────┘
                                              │
                                              ▼
                              ┌─────────────────────────────┐
                              │ Validate die type exists    │
                              │ "d6" in dieTypes[]?         │
                              └───────────────┬─────────────┘
                                              │
                              ┌───────────────┴───────────────┐
                              │ No                            │ Yes
                              ▼                               ▼
                    ┌───────────────────┐      ┌───────────────────────────┐
                    │ Unknown die type  │      │ Create DiceExpression     │
                    │ Log warning       │      │ {                         │
                    └───────────────────┘      │   count: 2,               │
                                               │   dieType: "d6",          │
                                               │   modifier: 3,            │
                                               │   raw: "2d6+3"            │
                                               │ }                         │
                                               └───────────────────────────┘
```

### 3.3 Schema Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           SCHEMA LAYER DIAGRAM                               │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                              PRESENTATION                                    │
│                                                                              │
│  Game UI displays dice information and roll results                          │
│  • Die type icons (d4, d6, d8, etc.)                                         │
│  • Dice expression display ("2d6+3")                                         │
│  • Probability tooltips (average: 10)                                        │
│  • Custom dice colors                                                        │
└─────────────────────────────────────────────────────────────────────────────┘
                                     │
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              APPLICATION                                     │
│                                                                              │
│  DiceService validates and parses dice expressions                           │
│  • ParseExpression(raw) → DiceExpression?                                    │
│  • ValidateExpression(raw) → bool                                            │
│  • GetDieType(id) → DieType?                                                 │
│  • GetAllDieTypes() → IEnumerable<DieType>                                   │
│  • GetStandardDice() → IEnumerable<DieType>                                  │
└─────────────────────────────────────────────────────────────────────────────┘
                                     │
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                             DOMAIN LAYER                                     │
│                                                                              │
│  Die type definitions loaded from JSON                                       │
│  • DieType (id, name, faces, minValue, maxValue, average)                    │
│  • DiceExpression (count, dieType, modifier, raw)                            │
│  • DiceExpressionPattern (pattern, captureGroups, examples)                  │
└─────────────────────────────────────────────────────────────────────────────┘
                                     │
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           INFRASTRUCTURE                                     │
│                                                                              │
│  DiceProvider loads from JSON with schema validation                         │
│  • LoadDiceTypes() → reads config/dice-types.json                            │
│  • Validates against config/schemas/dice-types.schema.json                   │
│  • Caches loaded definitions for performance                                 │
│  • Logs warnings for invalid entries                                         │
└─────────────────────────────────────────────────────────────────────────────┘
                                     │
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            CONFIGURATION                                     │
│                                                                              │
│  config/schemas/dice-types.schema.json                                       │
│  config/dice-types.json                                                      │
│                                                                              │
│  Consumers (use dice expressions):                                           │
│  • config/skills.json → baseDicePool                                         │
│  • config/weapons.json → damageDice                                          │
│  • config/hazards.json → dice                                                │
│  • config/terrain.json → damageOnEntry                                       │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 Die Type Statistics

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         DIE TYPE STATISTICS                                  │
└─────────────────────────────────────────────────────────────────────────────┘

  ┌─────────┬────────┬─────────┬─────────┬─────────┬───────────────────────────┐
  │ Die     │ Faces  │ Min     │ Max     │ Average │ Common Use                │
  ├─────────┼────────┼─────────┼─────────┼─────────┼───────────────────────────┤
  │ d4      │    4   │    1    │    4    │   2.5   │ Small weapons, healing    │
  │ d6      │    6   │    1    │    6    │   3.5   │ Common damage, hazards    │
  │ d8      │    8   │    1    │    8    │   4.5   │ Medium weapons            │
  │ d10     │   10   │    1    │   10    │   5.5   │ Skill checks, large wpns  │
  │ d12     │   12   │    1    │   12    │   6.5   │ Heavy weapons             │
  │ d20     │   20   │    1    │   20    │  10.5   │ Attack rolls, saves       │
  │ d100    │  100   │    1    │  100    │  50.5   │ Random tables, percentages│
  └─────────┴────────┴─────────┴─────────┴─────────┴───────────────────────────┘

  Probability Distribution Visual:
  ════════════════════════════════

  d4:   ████ (1-4)
  d6:   ██████ (1-6)
  d8:   ████████ (1-8)
  d10:  ██████████ (1-10)
  d12:  ████████████ (1-12)
  d20:  ████████████████████ (1-20)
  d100: ████████████████████████████████████████████████████████████... (1-100)

  Average Calculation:
  ═══════════════════
  average = (minValue + maxValue) / 2

  For standard d6:
  average = (1 + 6) / 2 = 3.5
```

---

## 4. Schema Root Definition

### 4.1 Root Configuration Properties

The root schema defines the top-level structure of the dice types configuration file.

| Property | Type | Required | Default | Description |
|----------|------|----------|---------|-------------|
| `$schema` | string | No | - | Reference to the JSON schema for validation |
| `version` | string | No | - | Configuration file version for compatibility |
| `dieTypes` | array | **Yes** | - | Array of DieType definitions |
| `expressionPattern` | object | No | - | DiceExpressionPattern for expression validation |

### 4.2 DieTypes Array Structure

The `dieTypes` property is an array of `DieType` objects. At least one die type must be defined.

```
dieTypes: [
  DieType (d4),
  DieType (d6),
  DieType (d8),
  DieType (d10),
  DieType (d12),
  DieType (d20),
  DieType (d100),
  ... (custom dice)
]
```

---

## 5. DieType Definition

### 5.1 Core Properties

Each die type defines a single die with its face count and value range.

| Property | Type | Required | Default | Description |
|----------|------|----------|---------|-------------|
| `id` | string | **Yes** | - | Die identifier (pattern: `^d\d+$`, e.g., "d6", "d20") |
| `name` | string | **Yes** | - | Human-readable display name |
| `faces` | integer | **Yes** | - | Number of faces on the die (minimum: 2) |

### 5.2 Computed Properties

These properties describe the value range and can be computed from `faces` and `minValue`.

| Property | Type | Required | Default | Description |
|----------|------|----------|---------|-------------|
| `minValue` | integer | No | 1 | Minimum value on the die (typically 1) |
| `maxValue` | integer | No | (computed) | Maximum value (minValue + faces - 1) |
| `average` | number | No | (computed) | Average roll value ((min + max) / 2) |

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        VALUE RANGE COMPUTATION                               │
└─────────────────────────────────────────────────────────────────────────────┘

  Standard Die (minValue: 1):
  ═══════════════════════════
  maxValue = minValue + faces - 1
  maxValue = 1 + faces - 1
  maxValue = faces

  Example: d6
  faces = 6
  minValue = 1
  maxValue = 1 + 6 - 1 = 6
  average = (1 + 6) / 2 = 3.5

  Custom Die (minValue: 0):
  ═════════════════════════
  d6 starting at 0:
  faces = 6
  minValue = 0
  maxValue = 0 + 6 - 1 = 5
  average = (0 + 5) / 2 = 2.5
```

### 5.3 Display Properties

Optional properties for UI rendering and documentation.

| Property | Type | Required | Default | Description |
|----------|------|----------|---------|-------------|
| `isStandard` | boolean | No | true | Whether this is a standard RPG die |
| `sortOrder` | integer | No | 0 | Sort order for UI display (minimum: 0) |
| `color` | string | No | - | Hex color code for display (e.g., "#FF5722") |
| `iconId` | string | No | - | Icon identifier for UI (e.g., "dice_d6") |
| `description` | string | No | - | Usage notes for this die type |

---

## 6. DiceExpression Definition

### 6.1 Expression Components

A dice expression represents a parsed dice roll notation.

| Property | Type | Required | Default | Description |
|----------|------|----------|---------|-------------|
| `count` | integer | No | 1 | Number of dice to roll (minimum: 1) |
| `dieType` | string | **Yes** | - | Reference to DieType.id (e.g., "d6") |
| `modifier` | integer | No | 0 | Flat bonus/penalty to the roll |
| `raw` | string | No | - | Original expression string (e.g., "2d6+3") |

### 6.2 Expression Parsing

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         EXPRESSION PARSING                                   │
└─────────────────────────────────────────────────────────────────────────────┘

  Expression: "2d6+3"
  ═══════════════════

  ┌───────────────────────────────────────────────────────────────────────────┐
  │     2       d       6       +       3                                     │
  │     │       │       │       │       │                                     │
  │     │       │       │       └───────┴────── modifier: +3                  │
  │     │       └───────┴────────────────────── dieType: "d6"                 │
  │     └────────────────────────────────────── count: 2                      │
  └───────────────────────────────────────────────────────────────────────────┘

  Parsed Result:
  ═══════════════
  {
    "count": 2,
    "dieType": "d6",
    "modifier": 3,
    "raw": "2d6+3"
  }

  Range Calculation:
  ══════════════════
  Minimum: count × minValue + modifier = 2 × 1 + 3 = 5
  Maximum: count × maxValue + modifier = 2 × 6 + 3 = 15
  Average: count × average + modifier = 2 × 3.5 + 3 = 10

  More Examples:
  ══════════════
  "1d8"     → count: 1, dieType: "d8", modifier: 0   → Range: 1-8
  "3d6"     → count: 3, dieType: "d6", modifier: 0   → Range: 3-18
  "1d20+5"  → count: 1, dieType: "d20", modifier: 5  → Range: 6-25
  "2d4-1"   → count: 2, dieType: "d4", modifier: -1  → Range: 1-7
```

---

## 7. DiceExpressionPattern Definition

### 7.1 Pattern Syntax

The dice expression pattern validates dice notation strings.

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `pattern` | string | **Yes** | Regex pattern for validation |
| `captureGroups` | object | No | Describes regex capture groups |
| `examples` | array | No | Array of valid expression examples |

**Standard Pattern:**

```
^\d+d\d+([+-]\d+)?$

Breakdown:
• ^        Start of string
• \d+      One or more digits (count)
• d        Literal 'd' character
• \d+      One or more digits (faces)
• (        Start optional group
•   [+-]   Plus or minus sign
•   \d+    One or more digits (modifier)
• )?       End optional group
• $        End of string
```

### 7.2 Capture Groups

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          CAPTURE GROUPS                                      │
└─────────────────────────────────────────────────────────────────────────────┘

  Pattern: ^(\d+)d(\d+)([+-]\d+)?$

  Expression: "2d6+3"
               ↓ ↓  ↓
  Groups:     (1)(2)(3)

  ┌──────────┬─────────────────────┬─────────────────────────────────────────┐
  │ Group    │ Captures            │ Description                             │
  ├──────────┼─────────────────────┼─────────────────────────────────────────┤
  │ Group 0  │ "2d6+3"             │ Full match                              │
  │ Group 1  │ "2"                 │ Dice count                              │
  │ Group 2  │ "6"                 │ Number of faces                         │
  │ Group 3  │ "+3"                │ Modifier with sign (optional)           │
  └──────────┴─────────────────────┴─────────────────────────────────────────┘

  Example Matches:
  ════════════════
  "1d6"     → Group 1: "1", Group 2: "6", Group 3: null
  "2d10"    → Group 1: "2", Group 2: "10", Group 3: null
  "1d8+2"   → Group 1: "1", Group 2: "8", Group 3: "+2"
  "3d6-1"   → Group 1: "3", Group 2: "6", Group 3: "-1"
  "10d4+10" → Group 1: "10", Group 2: "4", Group 3: "+10"
```

---

## 8. Standard Die Types

### 8.1 Standard RPG Dice

The following standard dice are defined in `dice-types.json`:

| ID | Name | Faces | Min | Max | Average | Sort | Use Case |
|----|------|-------|-----|-----|---------|------|----------|
| `d4` | Four-sided Die | 4 | 1 | 4 | 2.5 | 0 | Small weapons, healing |
| `d6` | Six-sided Die | 6 | 1 | 6 | 3.5 | 1 | Common damage, hazards |
| `d8` | Eight-sided Die | 8 | 1 | 8 | 4.5 | 2 | Medium weapons |
| `d10` | Ten-sided Die | 10 | 1 | 10 | 5.5 | 3 | Skill checks, large weapons |
| `d12` | Twelve-sided Die | 12 | 1 | 12 | 6.5 | 4 | Heavy weapons |
| `d20` | Twenty-sided Die | 20 | 1 | 20 | 10.5 | 5 | Attack rolls, saves |
| `d100` | Percentile Die | 100 | 1 | 100 | 50.5 | 6 | Random tables, percentages |

### 8.2 Custom Die Support

Custom dice can be added for modding scenarios:

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         CUSTOM DIE SUPPORT                                   │
└─────────────────────────────────────────────────────────────────────────────┘

  Custom Die Examples:
  ═══════════════════

  ┌────────────────────────────────────────────────────────────────────────┐
  │ Fate/Fudge Die (d3 with values -1, 0, +1)                              │
  │ Note: Requires minValue adjustment, not natively supported             │
  └────────────────────────────────────────────────────────────────────────┘
  {
    "id": "d3",
    "name": "Three-sided Die",
    "faces": 3,
    "minValue": 1,
    "maxValue": 3,
    "isStandard": false,
    "description": "Rare die for special mechanics"
  }

  ┌────────────────────────────────────────────────────────────────────────┐
  │ d30 for random encounter tables                                        │
  └────────────────────────────────────────────────────────────────────────┘
  {
    "id": "d30",
    "name": "Thirty-sided Die",
    "faces": 30,
    "minValue": 1,
    "maxValue": 30,
    "average": 15.5,
    "isStandard": false,
    "description": "Used for extended random tables"
  }

  ┌────────────────────────────────────────────────────────────────────────┐
  │ d2 (coin flip)                                                         │
  └────────────────────────────────────────────────────────────────────────┘
  {
    "id": "d2",
    "name": "Coin Flip",
    "faces": 2,
    "minValue": 1,
    "maxValue": 2,
    "average": 1.5,
    "isStandard": false,
    "description": "Binary outcome (heads/tails)"
  }

  Validation Rules:
  ═════════════════
  • ID must match pattern: ^d\d+$
  • Faces must be >= 2
  • Custom dice should set isStandard: false
```

---

## 9. Validation Rules

### 9.1 Die Type ID Pattern

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       DIE TYPE ID PATTERN VALIDATION                         │
└─────────────────────────────────────────────────────────────────────────────┘

  Pattern: ^d\d+$
  ═══════════════
  • Starts with lowercase 'd'
  • Followed by one or more digits
  • No other characters allowed

  ✓ Valid:     d4, d6, d8, d10, d12, d20, d100, d30, d2
  ✗ Invalid:   D6, d-6, d6+, dice6, 6d, d, dd6, d06

  Examples:
  ═════════
  "d6"   → ✓ Valid (standard)
  "d100" → ✓ Valid (percentile)
  "d7"   → ✓ Valid (custom)
  "D20"  → ✗ Invalid (uppercase)
  "d0"   → ✓ Pattern valid, but faces would fail (< 2)
```

### 9.2 Faces Validation

| Rule | Constraint | Notes |
|------|------------|-------|
| Type | integer | Must be whole number |
| Minimum | 2 | Coin flip minimum |
| Maximum | (none) | Theoretically unlimited |

### 9.3 Value Range Validation

| Rule | Constraint | Notes |
|------|------------|-------|
| `minValue` | integer >= 0 | Typically 1 for standard dice |
| `maxValue` | integer > minValue | Must be greater than minValue |
| `average` | number | Should equal (min + max) / 2 |
| `sortOrder` | integer >= 0 | Display ordering |

### 9.4 Expression Pattern Validation

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    EXPRESSION PATTERN VALIDATION                             │
└─────────────────────────────────────────────────────────────────────────────┘

  Pattern: ^\d+d\d+([+-]\d+)?$

  Valid Expressions:
  ══════════════════
  "1d6"      → ✓ 1 six-sided die
  "2d10"     → ✓ 2 ten-sided dice
  "1d8+2"    → ✓ 1 eight-sided die plus 2
  "3d6-1"    → ✓ 3 six-sided dice minus 1
  "1d20"     → ✓ 1 twenty-sided die
  "10d4+10"  → ✓ 10 four-sided dice plus 10
  "1d100"    → ✓ 1 percentile die

  Invalid Expressions:
  ════════════════════
  "d6"       → ✗ Missing count
  "1d"       → ✗ Missing faces
  "1d6+"     → ✗ Modifier without value
  "1d6+2+1"  → ✗ Multiple modifiers
  "1d6*2"    → ✗ Invalid operator
  "1D6"      → ✗ Uppercase D
  "one d six"→ ✗ Non-numeric
  "-1d6"     → ✗ Negative count
  "1d-6"     → ✗ Negative faces
  "1.5d6"    → ✗ Decimal count
  "1d6.5"    → ✗ Decimal faces
```

---

## 10. Configuration Schema

### Complete `dice-types.schema.json`

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://rune-game.com/schemas/dice-types.schema.json",
  "title": "Dice Types Configuration",
  "description": "Schema for die type definitions, dice expressions, and validation patterns",
  "type": "object",
  "properties": {
    "$schema": {
      "type": "string",
      "description": "Reference to this schema for validation"
    },
    "version": {
      "type": "string",
      "description": "Configuration file version for compatibility tracking"
    },
    "dieTypes": {
      "type": "array",
      "description": "Array of die type definitions",
      "items": {
        "$ref": "#/definitions/DieType"
      },
      "minItems": 1
    },
    "expressionPattern": {
      "$ref": "#/definitions/DiceExpressionPattern",
      "description": "Pattern definition for validating dice expressions"
    }
  },
  "required": ["dieTypes"],
  "additionalProperties": false,
  "definitions": {
    "DieType": {
      "type": "object",
      "description": "A single die type definition",
      "properties": {
        "id": {
          "type": "string",
          "description": "Die identifier (d followed by number)",
          "pattern": "^d\\d+$",
          "minLength": 2
        },
        "name": {
          "type": "string",
          "description": "Human-readable display name",
          "minLength": 1
        },
        "faces": {
          "type": "integer",
          "description": "Number of faces on the die",
          "minimum": 2
        },
        "minValue": {
          "type": "integer",
          "description": "Minimum value on the die (typically 1)",
          "minimum": 0,
          "default": 1
        },
        "maxValue": {
          "type": "integer",
          "description": "Maximum value on the die (computed from faces + minValue - 1)",
          "minimum": 1
        },
        "average": {
          "type": "number",
          "description": "Average roll value ((minValue + maxValue) / 2)"
        },
        "isStandard": {
          "type": "boolean",
          "description": "Whether this is a standard RPG die",
          "default": true
        },
        "sortOrder": {
          "type": "integer",
          "description": "Sort order for UI display",
          "minimum": 0,
          "default": 0
        },
        "color": {
          "type": "string",
          "description": "Hex color code for display (e.g., #FF5722)",
          "pattern": "^#[0-9A-Fa-f]{6}$"
        },
        "iconId": {
          "type": "string",
          "description": "Icon identifier for UI rendering",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "description": "Usage notes for this die type"
        }
      },
      "required": ["id", "name", "faces"],
      "additionalProperties": false
    },
    "DiceExpression": {
      "type": "object",
      "description": "A parsed dice expression",
      "properties": {
        "count": {
          "type": "integer",
          "description": "Number of dice to roll",
          "minimum": 1,
          "default": 1
        },
        "dieType": {
          "type": "string",
          "description": "Reference to DieType.id",
          "pattern": "^d\\d+$"
        },
        "modifier": {
          "type": "integer",
          "description": "Flat bonus or penalty to the roll",
          "default": 0
        },
        "raw": {
          "type": "string",
          "description": "Original expression string",
          "pattern": "^\\d+d\\d+([+-]\\d+)?$"
        }
      },
      "required": ["dieType"],
      "additionalProperties": false
    },
    "DiceExpressionPattern": {
      "type": "object",
      "description": "Pattern definition for validating dice expressions",
      "properties": {
        "pattern": {
          "type": "string",
          "description": "Regex pattern for validation",
          "default": "^\\d+d\\d+([+-]\\d+)?$"
        },
        "captureGroups": {
          "type": "object",
          "description": "Describes regex capture groups",
          "properties": {
            "count": {
              "type": "string",
              "description": "Description of count capture group"
            },
            "faces": {
              "type": "string",
              "description": "Description of faces capture group"
            },
            "modifier": {
              "type": "string",
              "description": "Description of modifier capture group"
            }
          },
          "additionalProperties": false
        },
        "examples": {
          "type": "array",
          "description": "Array of valid expression examples",
          "items": {
            "type": "string",
            "pattern": "^\\d+d\\d+([+-]\\d+)?$"
          }
        }
      },
      "required": ["pattern"],
      "additionalProperties": false
    }
  }
}
```

---

## 11. Configuration File

### Complete `dice-types.json`

```json
{
  "$schema": "./schemas/dice-types.schema.json",
  "version": "1.0.0",
  "dieTypes": [
    {
      "id": "d4",
      "name": "Four-sided Die",
      "faces": 4,
      "minValue": 1,
      "maxValue": 4,
      "average": 2.5,
      "isStandard": true,
      "sortOrder": 0,
      "color": "#9C27B0",
      "iconId": "dice_d4",
      "description": "Tetrahedron die used for small weapons and minor healing"
    },
    {
      "id": "d6",
      "name": "Six-sided Die",
      "faces": 6,
      "minValue": 1,
      "maxValue": 6,
      "average": 3.5,
      "isStandard": true,
      "sortOrder": 1,
      "color": "#4CAF50",
      "iconId": "dice_d6",
      "description": "Cube die used for common damage rolls and hazard effects"
    },
    {
      "id": "d8",
      "name": "Eight-sided Die",
      "faces": 8,
      "minValue": 1,
      "maxValue": 8,
      "average": 4.5,
      "isStandard": true,
      "sortOrder": 2,
      "color": "#2196F3",
      "iconId": "dice_d8",
      "description": "Octahedron die used for medium weapons"
    },
    {
      "id": "d10",
      "name": "Ten-sided Die",
      "faces": 10,
      "minValue": 1,
      "maxValue": 10,
      "average": 5.5,
      "isStandard": true,
      "sortOrder": 3,
      "color": "#FF9800",
      "iconId": "dice_d10",
      "description": "Pentagonal trapezohedron used for skill checks and large weapons"
    },
    {
      "id": "d12",
      "name": "Twelve-sided Die",
      "faces": 12,
      "minValue": 1,
      "maxValue": 12,
      "average": 6.5,
      "isStandard": true,
      "sortOrder": 4,
      "color": "#E91E63",
      "iconId": "dice_d12",
      "description": "Dodecahedron die used for heavy weapons"
    },
    {
      "id": "d20",
      "name": "Twenty-sided Die",
      "faces": 20,
      "minValue": 1,
      "maxValue": 20,
      "average": 10.5,
      "isStandard": true,
      "sortOrder": 5,
      "color": "#F44336",
      "iconId": "dice_d20",
      "description": "Icosahedron die used for attack rolls, saves, and critical determinations"
    },
    {
      "id": "d100",
      "name": "Percentile Die",
      "faces": 100,
      "minValue": 1,
      "maxValue": 100,
      "average": 50.5,
      "isStandard": true,
      "sortOrder": 6,
      "color": "#607D8B",
      "iconId": "dice_d100",
      "description": "Percentile die (or 2d10) used for random tables and percentage chances"
    }
  ],
  "expressionPattern": {
    "pattern": "^\\d+d\\d+([+-]\\d+)?$",
    "captureGroups": {
      "count": "First \\d+ captures the number of dice to roll",
      "faces": "Second \\d+ (after 'd') captures the number of faces",
      "modifier": "Optional [+-]\\d+ captures the modifier with sign"
    },
    "examples": [
      "1d6",
      "2d6",
      "1d8+2",
      "3d6-1",
      "1d20",
      "1d10+5",
      "2d4",
      "1d100"
    ]
  }
}
```

---

## 12. Data Model Changes

### Schema Definitions Summary

This version introduces JSON Schema definitions only—no C# domain entities. Future runtime implementation would include:

| Component | Type | Purpose |
|-----------|------|---------|
| `DieType` | Value Object | Single die definition with properties |
| `DiceExpression` | Value Object | Parsed dice expression |
| `DiceExpressionPattern` | Value Object | Pattern for expression validation |

### No Cross-Reference Changes

The dice types schema is self-contained. Other configuration files (skills.json, weapons.json, hazards.json, terrain.json) use dice expressions as strings, which can be validated against the `expressionPattern`.

---

## 13. Logging Specifications

### Schema Validation Logging

| Event | Level | Message Format |
|-------|-------|----------------|
| Schema loaded | INFO | `Dice types schema loaded from {path}` |
| Validation success | DEBUG | `Dice types validated ({dieCount} die types, pattern defined)` |
| Validation failure | ERROR | `Dice types configuration validation failed: {errors}` |
| Missing required | WARN | `Die type missing required field: {field}` |
| Invalid pattern | WARN | `Die type {id}: ID does not match pattern ^d\d+$` |
| Invalid faces | ERROR | `Die type {id}: faces must be >= 2, got {value}` |
| Invalid color | WARN | `Die type {id}: color does not match hex pattern` |
| Duplicate ID | ERROR | `Duplicate die type ID: {id}` |

### Runtime Logging (Future)

| Event | Level | Message Format |
|-------|-------|----------------|
| Die type loaded | DEBUG | `Loaded die type {id} ({faces} faces)` |
| Expression parsed | DEBUG | `Parsed dice expression {raw} → {count}d{faces}+{modifier}` |
| Invalid expression | WARN | `Invalid dice expression: {raw}` |
| Unknown die type | WARN | `Unknown die type in expression: {dieType}` |
| All types loaded | INFO | `Loaded {count} die types ({standardCount} standard, {customCount} custom)` |

---

## 14. Unit Testing Requirements

### Test Summary

| Test ID | Test Name | Description |
|---------|-----------|-------------|
| DTS-001 | ValidDiceTypesConfiguration | Validates complete configuration with all fields |
| DTS-002 | DieTypeStructureValidation | Validates die type required/optional fields |
| DTS-003 | FacesValidation | Validates faces as integer >= 2 |
| DTS-004 | DieTypeIdPatternValidation | Validates die type ID pattern (^d\d+$) |
| DTS-005 | ExpressionPatternValidation | Validates dice expression pattern matching |
| DTS-006 | ColorHexPatternValidation | Validates optional color as hex pattern |

### Test Specifications

#### DTS-001: ValidDiceTypesConfiguration

```
Test: Valid complete dice types configuration passes schema validation
Given: A dice types JSON file with all required and optional fields populated correctly
When: Schema validation is performed
Then: Validation passes with no errors
And: All die types are accessible
And: Expression pattern is defined
```

#### DTS-002: DieTypeStructureValidation

```
Test: Die type structure validates required and optional fields correctly
Given: Die type definitions with various configurations
When: Schema validation is performed:
  - { "id": "d6", "name": "Six-sided", "faces": 6 } → passes (minimal)
  - { "id": "d8", "name": "Eight-sided", "faces": 8, "color": "#2196F3" } → passes
  - { "id": "d6", "faces": 6 } → fails (missing name)
  - { "name": "Six-sided", "faces": 6 } → fails (missing id)
  - { "id": "d6", "name": "Six-sided" } → fails (missing faces)
  - { "id": "d6", "name": "Six-sided", "faces": 6, "unknownField": true } → fails
Then: Required fields enforced, optional fields allowed, unknown fields rejected
```

#### DTS-003: FacesValidation

```
Test: Faces values validate as integers >= 2
Given: Die types with various faces configurations
When: Schema validation is performed:
  - faces: 2 → passes (minimum, coin flip)
  - faces: 4 → passes
  - faces: 6 → passes
  - faces: 100 → passes
  - faces: 1 → fails (below minimum)
  - faces: 0 → fails (below minimum)
  - faces: -1 → fails (negative)
  - faces: 3.5 → fails (not integer)
Then: Invalid faces values produce validation errors
```

#### DTS-004: DieTypeIdPatternValidation

```
Test: Die type ID pattern validates correctly
Given: Die types with various ID formats
When: Schema validation is performed:
  - id: "d4" → passes
  - id: "d6" → passes
  - id: "d20" → passes
  - id: "d100" → passes
  - id: "d7" → passes (custom)
  - id: "D6" → fails (uppercase)
  - id: "d-6" → fails (hyphen)
  - id: "dice6" → fails (wrong prefix)
  - id: "6d" → fails (wrong order)
  - id: "d" → fails (no number)
Then: Pattern violations produce validation errors
```

#### DTS-005: ExpressionPatternValidation

```
Test: Dice expression pattern validates expressions correctly
Given: Dice expressions to validate against pattern
When: Pattern validation is performed:
  - "1d6" → passes
  - "2d10" → passes
  - "1d8+2" → passes
  - "3d6-1" → passes
  - "10d4+10" → passes
  - "1d100" → passes
  - "d6" → fails (missing count)
  - "1d" → fails (missing faces)
  - "1d6+" → fails (modifier without value)
  - "1D6" → fails (uppercase)
  - "1d6*2" → fails (invalid operator)
Then: Invalid expressions are rejected by pattern
```

#### DTS-006: ColorHexPatternValidation

```
Test: Color values validate as hex pattern
Given: Die types with various color configurations
When: Schema validation is performed:
  - color: "#FF5722" → passes
  - color: "#4CAF50" → passes
  - color: "#000000" → passes
  - color: "#FFFFFF" → passes
  - color: "#fff" → fails (3-digit hex not supported)
  - color: "FF5722" → fails (missing #)
  - color: "#GGGGGG" → fails (invalid hex chars)
  - color: "red" → fails (named color not supported)
  - color omitted → passes (optional field)
Then: Invalid color values produce validation errors
```

---

## 15. Use Cases

### UC-001: Load Dice Types Configuration

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ UC-001: Load Dice Types Configuration                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│ Actors: Game System                                                          │
│ Trigger: Game startup or configuration reload                                │
│ Preconditions: dice-types.json exists in config directory                    │
├─────────────────────────────────────────────────────────────────────────────┤
│ Flow:                                                                        │
│ 1. System loads dice-types.schema.json                                       │
│ 2. System reads config/dice-types.json                                       │
│ 3. Validate configuration against schema                                     │
│ 4. Parse die types into memory                                               │
│ 5. Build die type lookup by ID                                               │
│ 6. Store expression pattern for validation                                   │
│ 7. Log successful load with die type count                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│ Postconditions: Die types available for expression parsing                   │
│ Exceptions: Invalid JSON → log error, use defaults                           │
└─────────────────────────────────────────────────────────────────────────────┘
```

### UC-002: Validate Dice Expression

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ UC-002: Validate Dice Expression                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│ Actors: Configuration Loader                                                 │
│ Trigger: Loading configuration file with dice expression field               │
│ Preconditions: Dice types configuration loaded                               │
├─────────────────────────────────────────────────────────────────────────────┤
│ Flow:                                                                        │
│ 1. Receive dice expression string (e.g., "2d6+3")                            │
│ 2. Match against expression pattern                                          │
│ 3. If pattern matches:                                                       │
│    a. Extract count, faces, modifier                                         │
│    b. Build die type ID ("d" + faces)                                        │
│    c. Verify die type exists in configuration                                │
│    d. Return validation success                                              │
│ 4. If pattern doesn't match → return validation failure                      │
├─────────────────────────────────────────────────────────────────────────────┤
│ Postconditions: Expression validated as correct format and known die type    │
│ Exceptions: Unknown die type → log warning, validation succeeds (lenient)    │
└─────────────────────────────────────────────────────────────────────────────┘
```

### UC-003: Parse Dice Expression

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ UC-003: Parse Dice Expression                                                │
├─────────────────────────────────────────────────────────────────────────────┤
│ Actors: Game System                                                          │
│ Trigger: Combat roll, skill check, or damage calculation                     │
│ Preconditions: Expression validated                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│ Flow:                                                                        │
│ 1. Receive dice expression string (e.g., "2d6+3")                            │
│ 2. Apply regex pattern with capture groups                                   │
│ 3. Extract components:                                                       │
│    - count = first number (2)                                                │
│    - dieType = "d" + second number ("d6")                                    │
│    - modifier = optional third group (+3)                                    │
│ 4. Create DiceExpression object                                              │
│ 5. Return parsed expression                                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│ Postconditions: DiceExpression object ready for rolling                      │
│ Exceptions: Invalid expression → return null, log warning                    │
└─────────────────────────────────────────────────────────────────────────────┘
```

### UC-004: Get Die Type Statistics

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ UC-004: Get Die Type Statistics                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ Actors: UI System                                                            │
│ Trigger: Display dice information in inventory or combat UI                  │
│ Preconditions: Dice types configuration loaded                               │
├─────────────────────────────────────────────────────────────────────────────┤
│ Flow:                                                                        │
│ 1. Receive die type ID (e.g., "d6")                                          │
│ 2. Look up die type in configuration                                         │
│ 3. Return die type properties:                                               │
│    - name: "Six-sided Die"                                                   │
│    - faces: 6                                                                │
│    - min: 1, max: 6, average: 3.5                                            │
│    - color: "#4CAF50"                                                        │
│    - iconId: "dice_d6"                                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│ Postconditions: Die type statistics available for display                    │
│ Exceptions: Unknown die type → return null                                   │
└─────────────────────────────────────────────────────────────────────────────┘
```

### UC-005: Calculate Expression Range

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ UC-005: Calculate Expression Range                                           │
├─────────────────────────────────────────────────────────────────────────────┤
│ Actors: UI System                                                            │
│ Trigger: Display damage range tooltip                                        │
│ Preconditions: DiceExpression parsed, DieType loaded                         │
├─────────────────────────────────────────────────────────────────────────────┤
│ Flow:                                                                        │
│ 1. Receive DiceExpression (e.g., count: 2, dieType: "d6", modifier: 3)       │
│ 2. Look up die type for min/max values                                       │
│ 3. Calculate range:                                                          │
│    - minimum = count × dieType.minValue + modifier                           │
│    - maximum = count × dieType.maxValue + modifier                           │
│    - average = count × dieType.average + modifier                            │
│ 4. Return { min: 5, max: 15, average: 10 }                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│ Postconditions: Range displayed to player                                    │
│ Exceptions: Unknown die type → use faces from expression                     │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 16. Deliverable Checklist

### Configuration Files

| Status | File | Description |
|--------|------|-------------|
| ☐ | `config/schemas/dice-types.schema.json` | JSON Schema for dice type validation |
| ☐ | `config/dice-types.json` | Die type definitions with standard dice |

### Unit Tests

| Status | Test | Description |
|--------|------|-------------|
| ☐ | DTS-001 | Valid complete dice types configuration |
| ☐ | DTS-002 | Die type structure validation |
| ☐ | DTS-003 | Faces validation |
| ☐ | DTS-004 | Die type ID pattern validation |
| ☐ | DTS-005 | Expression pattern validation |
| ☐ | DTS-006 | Color hex pattern validation |

### Documentation

| Status | Document | Description |
|--------|----------|-------------|
| ☑ | Design Specification | This document |
| ☐ | Schema Documentation | Inline in schema file |

---

## 17. Acceptance Criteria

### Functional Criteria

- [ ] `dice-types.schema.json` created in `config/schemas/`
- [ ] `dice-types.json` created with 7 standard die types
- [ ] Die type ID pattern validated (`^d\d+$`)
- [ ] Faces validated as integer >= 2
- [ ] minValue/maxValue/average fields supported
- [ ] isStandard and sortOrder fields supported
- [ ] Color validated as optional hex pattern (`^#[0-9A-Fa-f]{6}$`)
- [ ] iconId and description fields supported
- [ ] Expression pattern defined (`^\d+d\d+([+-]\d+)?$`)
- [ ] Capture groups documented
- [ ] Example expressions included
- [ ] ~6 unit tests pass

### Quality Criteria

- [ ] Schema follows JSON Schema Draft-07 specification
- [ ] All properties include descriptive comments
- [ ] Default values documented for optional fields
- [ ] Range constraints clearly specified
- [ ] Expression pattern matches existing config usage

### Integration Criteria

- [ ] Schema follows patterns from v0.14.7 schemas
- [ ] Expression pattern compatible with skills.json, weapons.json, hazards.json, terrain.json
- [ ] Can be referenced by v0.14.8b dice-mechanics schema

---

## 18. Dependencies

### Required From

| Version | Dependency | Usage |
|---------|------------|-------|
| v0.14.7 | Descriptor Configuration Schemas | Schema infrastructure patterns |
| Existing | `config/skills.json` | Uses baseDicePool expressions |
| Existing | `config/weapons.json` | Uses damageDice expressions |
| Existing | `config/hazards.json` | Uses dice expressions |
| Existing | `config/terrain.json` | Uses damageOnEntry expressions |

### Provides To

| Version | Consumer | Usage |
|---------|----------|-------|
| v0.14.8b | Dice Mechanics Schema | Die type references |
| Future | DiceService | Die type loading and expression parsing |
| Future | CombatService | Damage roll calculations |
| Future | SkillService | Skill check dice pools |
| Future | HazardService | Hazard damage dice |

---

## 19. Future Considerations

### Deferred to Later Versions

| Feature | Rationale |
|---------|-----------|
| Dice mechanics schema | v0.14.8b scope |
| Roll execution logic | Runtime concern |
| Probability calculations | Runtime concern |
| Dice animation/rendering | UI concern |
| Roll history tracking | Future logging version |

### Potential Enhancements

| Enhancement | Description |
|-------------|-------------|
| Custom expression patterns | Support alternative notations (e.g., "6d" instead of "d6") |
| Die type inheritance | Base types that custom dice extend |
| Weighted faces | Non-uniform probability distributions |
| Fate dice support | Negative minValue for -1 to +1 dice |
| Die type groups | Categorize dice (standard, custom, special) |
| Localized names | Multi-language die type names |

---

## 20. Appendix: Schema Validation Examples

### Valid Die Type (Minimal)

```json
{
  "id": "d6",
  "name": "Six-sided Die",
  "faces": 6
}
```

### Valid Die Type (Complete)

```json
{
  "id": "d20",
  "name": "Twenty-sided Die",
  "faces": 20,
  "minValue": 1,
  "maxValue": 20,
  "average": 10.5,
  "isStandard": true,
  "sortOrder": 5,
  "color": "#F44336",
  "iconId": "dice_d20",
  "description": "Icosahedron die used for attack rolls, saves, and critical determinations"
}
```

### Valid Custom Die Type

```json
{
  "id": "d30",
  "name": "Thirty-sided Die",
  "faces": 30,
  "minValue": 1,
  "maxValue": 30,
  "average": 15.5,
  "isStandard": false,
  "sortOrder": 10,
  "description": "Used for extended random encounter tables"
}
```

### Valid Expression Pattern

```json
{
  "pattern": "^\\d+d\\d+([+-]\\d+)?$",
  "captureGroups": {
    "count": "First \\d+ captures the number of dice to roll",
    "faces": "Second \\d+ (after 'd') captures the number of faces",
    "modifier": "Optional [+-]\\d+ captures the modifier with sign"
  },
  "examples": [
    "1d6",
    "2d6",
    "1d8+2",
    "3d6-1"
  ]
}
```

### Invalid Examples

```json
// Invalid: Missing dieTypes
{
  "$schema": "./schemas/dice-types.schema.json",
  "expressionPattern": { ... }
}
// Error: Missing required property 'dieTypes'

// Invalid: Empty dieTypes array
{
  "dieTypes": []
}
// Error: 'dieTypes' must have at least 1 item

// Invalid: Missing required die type field
{
  "dieTypes": [
    {
      "id": "d6",
      "name": "Six-sided"
      // Missing: "faces"
    }
  ]
}
// Error: Missing required property 'faces'

// Invalid: Faces below minimum
{
  "dieTypes": [
    {
      "id": "d1",
      "name": "One-sided",
      "faces": 1
    }
  ]
}
// Error: 'faces' must be >= 2

// Invalid: Die type ID pattern
{
  "dieTypes": [
    {
      "id": "D6",
      "name": "Six-sided",
      "faces": 6
    }
  ]
}
// Error: 'id' does not match pattern ^d\d+$

// Invalid: Color hex pattern
{
  "dieTypes": [
    {
      "id": "d6",
      "name": "Six-sided",
      "faces": 6,
      "color": "red"
    }
  ]
}
// Error: 'color' does not match pattern ^#[0-9A-Fa-f]{6}$

// Invalid: Unknown property
{
  "dieTypes": [
    {
      "id": "d6",
      "name": "Six-sided",
      "faces": 6,
      "weight": 100
    }
  ]
}
// Error: Additional properties not allowed: 'weight'

// Invalid: Expression pattern examples
{
  "expressionPattern": {
    "pattern": "^\\d+d\\d+([+-]\\d+)?$",
    "examples": [
      "1d6",
      "d6"  // Invalid: missing count
    ]
  }
}
// Error: 'examples[1]' does not match pattern
```

---

*End of v0.14.8a Design Specification*
