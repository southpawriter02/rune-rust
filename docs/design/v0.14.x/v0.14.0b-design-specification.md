# v0.14.0b Design Specification: Class Schema

**Version:** 0.14.0b
**Parent:** v0.14.0 (Character Configuration Schemas)
**Prerequisites:** v0.14.0d Complete (Skill & Archetype Schemas)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Class Schema Definition](#4-class-schema-definition)
   - 4.1 [Schema Structure](#41-schema-structure)
   - 4.2 [ClassDefinition Object](#42-classdefinition-object)
   - 4.3 [StatModifiers Object](#43-statmodifiers-object)
   - 4.4 [GrowthRates Object](#44-growthrates-object)
5. [Validation Rules](#5-validation-rules)
   - 5.1 [ID Pattern Validation](#51-id-pattern-validation)
   - 5.2 [Resource Type Validation](#52-resource-type-validation)
   - 5.3 [Required Fields](#53-required-fields)
6. [Configuration Schema](#6-configuration-schema)
7. [Configuration File Updates](#7-configuration-file-updates)
8. [Data Model Changes](#8-data-model-changes)
9. [Logging Specifications](#9-logging-specifications)
10. [Unit Testing Requirements](#10-unit-testing-requirements)
11. [Use Cases](#11-use-cases)
12. [Deliverable Checklist](#12-deliverable-checklist)
13. [Acceptance Criteria](#13-acceptance-criteria)
14. [Dependencies](#14-dependencies)
15. [Future Considerations](#15-future-considerations)

---

## 1. Executive Summary

Version 0.14.0b introduces the Class Schema (`classes.schema.json`), a comprehensive JSON Schema Draft-07 specification that validates character class configuration files. This schema enables full customization of character classes including stat modifiers, growth rates, resource types, and starting abilities without code changes.

The Class Schema builds upon the archetype schema (v0.14.0d) by referencing archetype IDs, establishing the relationship between classes and their parent archetypes. This supports modding scenarios where users create custom classes like sci-fi soldiers, historical knights, or entirely new fantasy archetypes.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Schema Files** | `classes.schema.json` |
| **Schema Definitions** | `ClassDefinition`, `StatModifiers`, `GrowthRates` |
| **Configuration Updates** | Update `classes.json` schema reference |
| **Tests** | ~5 new unit tests |

### Architectural Significance

This version establishes the **class-archetype relationship pattern** that connects character classes to their parent archetypes:
- Classes reference archetypes via `archetypeId`
- Stat modifiers can be positive or negative (unlike race modifiers)
- Growth rates define per-level stat progression
- Resource types are validated against an enum

---

## 2. Feature Overview

```
v0.14.0b Class Schema Features
├── classes.schema.json
│   ├── Root Object Properties
│   │   ├── $schema (string, optional)
│   │   ├── version (string, optional)
│   │   └── classes (array of ClassDefinition, required)
│   └── Definitions
│       ├── ClassDefinition
│       │   ├── id (string, kebab-case pattern)
│       │   ├── name (string, minLength: 1)
│       │   ├── description (string)
│       │   ├── archetypeId (string, references archetype)
│       │   ├── statModifiers (StatModifiers)
│       │   ├── growthRates (GrowthRates)
│       │   ├── primaryResourceId (enum: mana, rage, energy, focus, faith, stamina)
│       │   ├── startingAbilityIds (array of string)
│       │   ├── requirements (object or null, optional)
│       │   └── sortOrder (integer, minimum: 0)
│       ├── StatModifiers
│       │   ├── maxHealth (integer)
│       │   ├── attack (integer)
│       │   ├── defense (integer)
│       │   ├── might (integer)
│       │   ├── fortitude (integer)
│       │   ├── will (integer)
│       │   ├── wits (integer)
│       │   └── finesse (integer)
│       └── GrowthRates
│           ├── maxHealth (integer, minimum: 0)
│           ├── attack (integer, minimum: 0)
│           ├── defense (integer, minimum: 0)
│           ├── might (integer, minimum: 0)
│           ├── fortitude (integer, minimum: 0)
│           ├── will (integer, minimum: 0)
│           ├── wits (integer, minimum: 0)
│           └── finesse (integer, minimum: 0)
├── Validation Rules
│   ├── ID Pattern Enforcement
│   ├── Resource Type Enum Validation
│   ├── Archetype ID Reference Validation
│   └── Required Field Enforcement
└── Configuration Updates
    └── classes.json $schema reference addition
```

---

## 3. Architecture Diagrams

### 3.1 Schema Validation Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         SCHEMA VALIDATION FLOW                               │
└─────────────────────────────────────────────────────────────────────────────┘

    User edits classes.json
           │
           ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                          IDE/EDITOR                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│  1. Reads $schema property from classes.json                                 │
│  2. Loads config/schemas/classes.schema.json                                 │
│  3. Validates content against schema                                         │
└─────────────────────────────────────────────────────────────────────────────┘
           │
           ├─── Valid ───▶ Green checkmark, autocomplete works
           │
           └─── Invalid ─▶ Error underlines with messages:
                           • "primaryResourceId must be one of: mana, rage, energy, focus, faith, stamina"
                           • "growthRates.maxHealth must be >= 0"
                           • "missing required property 'archetypeId'"
```

### 3.2 Class-Archetype Relationship

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    CLASS-ARCHETYPE RELATIONSHIP                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                          archetypes.json                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │  warrior    │  │ skirmisher  │  │   adept     │  │   mystic    │        │
│  │ (defensive) │  │ (offensive) │  │ (balanced)  │  │ (offensive) │        │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘        │
│         │                │                │                │                │
└─────────│────────────────│────────────────│────────────────│────────────────┘
          │                │                │                │
          ▼                ▼                ▼                ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           classes.json                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐│
│  │ shieldmaiden│  │shadow-walker│  │scrap-tinker │  │galdr-caster │blood- ││
│  │archetypeId: │  │archetypeId: │  │archetypeId: │  │archetypeId: │priest ││
│  │  "warrior"  │  │"skirmisher" │  │   "adept"   │  │  "mystic"   │"mystic"│
│  │resource:    │  │resource:    │  │resource:    │  │resource:    │resource│
│  │  "rage"     │  │  "energy"   │  │  "focus"    │  │  "mana"     │"faith" │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────────────┘│
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Schema Structure Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         classes.schema.json                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│  $schema: "http://json-schema.org/draft-07/schema#"                         │
│  title: "Class Configuration"                                                │
│  type: object                                                                │
├─────────────────────────────────────────────────────────────────────────────┤
│  properties:                                                                 │
│  ┌─────────────────┬───────────────────────────────────────────────────┐    │
│  │ $schema         │ type: string (optional)                           │    │
│  ├─────────────────┼───────────────────────────────────────────────────┤    │
│  │ version         │ type: string (optional)                           │    │
│  ├─────────────────┼───────────────────────────────────────────────────┤    │
│  │ classes         │ type: array, items: $ref ClassDefinition          │    │
│  └─────────────────┴───────────────────────────────────────────────────┘    │
├─────────────────────────────────────────────────────────────────────────────┤
│  definitions:                                                                │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ ClassDefinition                                                      │    │
│  │ ┌─────────────────────┬─────────────────────────────────────────┐   │    │
│  │ │ id                  │ string, pattern: ^[a-z][a-z0-9-]*$      │   │    │
│  │ │ name                │ string, minLength: 1                    │   │    │
│  │ │ description         │ string                                  │   │    │
│  │ │ archetypeId         │ string, pattern: ^[a-z][a-z0-9-]*$      │   │    │
│  │ │ statModifiers       │ $ref StatModifiers                      │   │    │
│  │ │ growthRates         │ $ref GrowthRates                        │   │    │
│  │ │ primaryResourceId   │ enum: mana, rage, energy, focus, faith, │   │    │
│  │ │                     │       stamina                           │   │    │
│  │ │ startingAbilityIds  │ array of string                         │   │    │
│  │ │ requirements        │ object or null (optional)               │   │    │
│  │ │ sortOrder           │ integer, minimum: 0                     │   │    │
│  │ └─────────────────────┴─────────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ StatModifiers (allows negative values)                               │    │
│  │ ┌─────────────────────┬─────────────────────────────────────────┐   │    │
│  │ │ maxHealth           │ integer (no range restriction)          │   │    │
│  │ │ attack              │ integer (no range restriction)          │   │    │
│  │ │ defense             │ integer (no range restriction)          │   │    │
│  │ │ might               │ integer (no range restriction)          │   │    │
│  │ │ fortitude           │ integer (no range restriction)          │   │    │
│  │ │ will                │ integer (no range restriction)          │   │    │
│  │ │ wits                │ integer (no range restriction)          │   │    │
│  │ │ finesse             │ integer (no range restriction)          │   │    │
│  │ └─────────────────────┴─────────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ GrowthRates (non-negative values only)                               │    │
│  │ ┌─────────────────────┬─────────────────────────────────────────┐   │    │
│  │ │ maxHealth           │ integer, minimum: 0                     │   │    │
│  │ │ attack              │ integer, minimum: 0                     │   │    │
│  │ │ defense             │ integer, minimum: 0                     │   │    │
│  │ │ might               │ integer, minimum: 0                     │   │    │
│  │ │ fortitude           │ integer, minimum: 0                     │   │    │
│  │ │ will                │ integer, minimum: 0                     │   │    │
│  │ │ wits                │ integer, minimum: 0                     │   │    │
│  │ │ finesse             │ integer, minimum: 0                     │   │    │
│  │ └─────────────────────┴─────────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 File Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            CONFIG LAYER                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  config/                                                                     │
│  ├── archetypes.json ◀─────────────────────────────────────────┐            │
│  │   (validated by v0.14.0d)                                    │            │
│  │                                                              │ references │
│  ├── classes.json ◀──────────────────────────┐                  │            │
│  │   {                                        │ references       │            │
│  │     "$schema": "./schemas/classes.schema.json",              │            │
│  │     "classes": [                           │                  │            │
│  │       {                                    │                  │            │
│  │         "archetypeId": "warrior" ──────────│──────────────────┘            │
│  │       }                                    │                              │
│  │     ]                                      │                              │
│  │   }                                        │                              │
│  │                                            │                              │
│  └── schemas/                                 │                              │
│      ├── archetypes.schema.json (v0.14.0d)   │                              │
│      └── classes.schema.json ─────────────────┘                              │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Class Schema Definition

### 4.1 Schema Structure

**File:** `config/schemas/classes.schema.json`

The class schema follows JSON Schema Draft-07 specification, providing comprehensive validation for character class configuration files.

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Class Configuration",
    "description": "Schema for character class definitions in the game. Validates stat modifiers, growth rates, resource types, and ability references.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Configuration file version for compatibility tracking",
            "pattern": "^[0-9]+\\.[0-9]+$"
        },
        "classes": {
            "type": "array",
            "description": "List of character class definitions",
            "items": {
                "$ref": "#/definitions/ClassDefinition"
            },
            "minItems": 1
        }
    },
    "required": ["classes"],
    "additionalProperties": false,
    "definitions": {
        "ClassDefinition": { ... },
        "StatModifiers": { ... },
        "GrowthRates": { ... }
    }
}
```

### 4.2 ClassDefinition Object

The `ClassDefinition` object represents a single character class with all associated properties including stat modifiers, growth rates, and starting abilities.

```json
"ClassDefinition": {
    "type": "object",
    "description": "A single character class definition with stats, abilities, and progression",
    "properties": {
        "id": {
            "type": "string",
            "description": "Unique identifier for the class (lowercase kebab-case)",
            "pattern": "^[a-z][a-z0-9-]*$",
            "minLength": 1,
            "maxLength": 50
        },
        "name": {
            "type": "string",
            "description": "Display name for the class shown to players",
            "minLength": 1,
            "maxLength": 100
        },
        "description": {
            "type": "string",
            "description": "Detailed description of the class playstyle and lore",
            "minLength": 1,
            "maxLength": 1000
        },
        "archetypeId": {
            "type": "string",
            "description": "Reference to the parent archetype (must match an archetype ID)",
            "pattern": "^[a-z][a-z0-9-]*$",
            "minLength": 1,
            "maxLength": 50
        },
        "statModifiers": {
            "$ref": "#/definitions/StatModifiers",
            "description": "Base stat adjustments applied to characters of this class"
        },
        "growthRates": {
            "$ref": "#/definitions/GrowthRates",
            "description": "Per-level stat increases for characters of this class"
        },
        "primaryResourceId": {
            "type": "string",
            "description": "The primary resource type used by this class for abilities",
            "enum": ["mana", "rage", "energy", "focus", "faith", "stamina"]
        },
        "startingAbilityIds": {
            "type": "array",
            "description": "Ability IDs granted to characters of this class at creation",
            "items": {
                "type": "string",
                "pattern": "^[a-z][a-z0-9-]*$"
            },
            "uniqueItems": true
        },
        "requirements": {
            "oneOf": [
                { "type": "null" },
                {
                    "type": "object",
                    "description": "Optional unlock conditions for this class",
                    "properties": {
                        "level": {
                            "type": "integer",
                            "description": "Minimum character level to unlock",
                            "minimum": 1
                        },
                        "achievementIds": {
                            "type": "array",
                            "description": "Achievement IDs required to unlock",
                            "items": {
                                "type": "string",
                                "pattern": "^[a-z][a-z0-9-]*$"
                            }
                        },
                        "questIds": {
                            "type": "array",
                            "description": "Quest IDs that must be completed",
                            "items": {
                                "type": "string",
                                "pattern": "^[a-z][a-z0-9-]*$"
                            }
                        }
                    },
                    "additionalProperties": false
                }
            ]
        },
        "sortOrder": {
            "type": "integer",
            "description": "Display order in character creation UI (lower = earlier)",
            "minimum": 0,
            "default": 0
        }
    },
    "required": [
        "id",
        "name",
        "description",
        "archetypeId",
        "statModifiers",
        "growthRates",
        "primaryResourceId",
        "startingAbilityIds"
    ],
    "additionalProperties": false
}
```

### 4.3 StatModifiers Object

The `StatModifiers` object defines base stat adjustments for a class. Unlike race attribute modifiers, class stat modifiers can be any integer value (positive or negative) to represent significant class differences.

```json
"StatModifiers": {
    "type": "object",
    "description": "Base stat adjustments applied at character creation",
    "properties": {
        "maxHealth": {
            "type": "integer",
            "description": "Bonus or penalty to maximum health points",
            "default": 0
        },
        "attack": {
            "type": "integer",
            "description": "Bonus or penalty to attack power",
            "default": 0
        },
        "defense": {
            "type": "integer",
            "description": "Bonus or penalty to defense rating",
            "default": 0
        },
        "might": {
            "type": "integer",
            "description": "Bonus or penalty to physical power attribute",
            "default": 0
        },
        "fortitude": {
            "type": "integer",
            "description": "Bonus or penalty to physical resilience attribute",
            "default": 0
        },
        "will": {
            "type": "integer",
            "description": "Bonus or penalty to mental fortitude attribute",
            "default": 0
        },
        "wits": {
            "type": "integer",
            "description": "Bonus or penalty to mental acuity attribute",
            "default": 0
        },
        "finesse": {
            "type": "integer",
            "description": "Bonus or penalty to dexterity attribute",
            "default": 0
        }
    },
    "required": ["maxHealth", "attack", "defense", "might", "fortitude", "will", "wits", "finesse"],
    "additionalProperties": false
}
```

### 4.4 GrowthRates Object

The `GrowthRates` object defines per-level stat progression. All growth rates must be non-negative since stats should not decrease on level-up.

```json
"GrowthRates": {
    "type": "object",
    "description": "Per-level stat increases for character progression",
    "properties": {
        "maxHealth": {
            "type": "integer",
            "description": "Health points gained per level",
            "minimum": 0,
            "default": 0
        },
        "attack": {
            "type": "integer",
            "description": "Attack power gained per level",
            "minimum": 0,
            "default": 0
        },
        "defense": {
            "type": "integer",
            "description": "Defense rating gained per level",
            "minimum": 0,
            "default": 0
        },
        "might": {
            "type": "integer",
            "description": "Might attribute growth per level",
            "minimum": 0,
            "default": 0
        },
        "fortitude": {
            "type": "integer",
            "description": "Fortitude attribute growth per level",
            "minimum": 0,
            "default": 0
        },
        "will": {
            "type": "integer",
            "description": "Will attribute growth per level",
            "minimum": 0,
            "default": 0
        },
        "wits": {
            "type": "integer",
            "description": "Wits attribute growth per level",
            "minimum": 0,
            "default": 0
        },
        "finesse": {
            "type": "integer",
            "description": "Finesse attribute growth per level",
            "minimum": 0,
            "default": 0
        }
    },
    "required": ["maxHealth", "attack", "defense", "might", "fortitude", "will", "wits", "finesse"],
    "additionalProperties": false
}
```

---

## 5. Validation Rules

### 5.1 ID Pattern Validation

All identifier fields use kebab-case pattern validation for consistency.

| Field | Pattern | Valid Examples | Invalid Examples |
|-------|---------|----------------|------------------|
| `id` | `^[a-z][a-z0-9-]*$` | `shieldmaiden`, `shadow-walker`, `blood-priest` | `Shieldmaiden`, `shadow_walker`, `123class` |
| `archetypeId` | `^[a-z][a-z0-9-]*$` | `warrior`, `skirmisher`, `mystic` | `Warrior`, `warrior_type` |
| `startingAbilityIds[]` | `^[a-z][a-z0-9-]*$` | `shield-bash`, `flame-bolt` | `ShieldBash`, `flame_bolt` |

### 5.2 Resource Type Validation

The `primaryResourceId` field is validated against a predefined enum of resource types.

| Resource ID | Display Name | Typical Use | Example Classes |
|-------------|--------------|-------------|-----------------|
| `mana` | Mana | Arcane spellcasting | Galdr-Caster |
| `rage` | Rage | Building fury in combat | Shieldmaiden |
| `energy` | Energy | Quick recovery, precision | Shadow-Walker |
| `focus` | Focus | Concentration, gadgets | Scrap-Tinker |
| `faith` | Faith | Divine power, sacrifice | Blood-Priest |
| `stamina` | Stamina | Physical exertion | Generic martial classes |

**Validation Error Example:**
```
Error: classes[0].primaryResourceId must be one of: mana, rage, energy, focus, faith, stamina
```

### 5.3 Required Fields

The following fields are required for each class definition:

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `id` | Must be present and non-empty | "missing required property 'id'" |
| `name` | Must be present with minLength 1 | "missing required property 'name'" |
| `description` | Must be present | "missing required property 'description'" |
| `archetypeId` | Must be present and match pattern | "missing required property 'archetypeId'" |
| `statModifiers` | Must be present with all 8 stats | "missing required property 'statModifiers'" |
| `growthRates` | Must be present with all 8 stats | "missing required property 'growthRates'" |
| `primaryResourceId` | Must be present and valid enum | "missing required property 'primaryResourceId'" |
| `startingAbilityIds` | Must be present (can be empty array) | "missing required property 'startingAbilityIds'" |

**Optional Fields:**
- `requirements` - Unlock conditions (null or object)
- `sortOrder` - Defaults to `0`

---

## 6. Configuration Schema

### Complete Schema File

**File:** `config/schemas/classes.schema.json`

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Class Configuration",
    "description": "Schema for character class definitions in the game. Validates stat modifiers, growth rates, resource types, and ability references.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Configuration file version for compatibility tracking",
            "pattern": "^[0-9]+\\.[0-9]+$"
        },
        "classes": {
            "type": "array",
            "description": "List of character class definitions",
            "items": {
                "$ref": "#/definitions/ClassDefinition"
            },
            "minItems": 1
        }
    },
    "required": ["classes"],
    "additionalProperties": false,
    "definitions": {
        "ClassDefinition": {
            "type": "object",
            "description": "A single character class definition with stats, abilities, and progression",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique identifier for the class (lowercase kebab-case)",
                    "pattern": "^[a-z][a-z0-9-]*$",
                    "minLength": 1,
                    "maxLength": 50
                },
                "name": {
                    "type": "string",
                    "description": "Display name for the class shown to players",
                    "minLength": 1,
                    "maxLength": 100
                },
                "description": {
                    "type": "string",
                    "description": "Detailed description of the class playstyle and lore",
                    "minLength": 1,
                    "maxLength": 1000
                },
                "archetypeId": {
                    "type": "string",
                    "description": "Reference to the parent archetype (must match an archetype ID)",
                    "pattern": "^[a-z][a-z0-9-]*$",
                    "minLength": 1,
                    "maxLength": 50
                },
                "statModifiers": {
                    "$ref": "#/definitions/StatModifiers",
                    "description": "Base stat adjustments applied to characters of this class"
                },
                "growthRates": {
                    "$ref": "#/definitions/GrowthRates",
                    "description": "Per-level stat increases for characters of this class"
                },
                "primaryResourceId": {
                    "type": "string",
                    "description": "The primary resource type used by this class for abilities",
                    "enum": ["mana", "rage", "energy", "focus", "faith", "stamina"]
                },
                "startingAbilityIds": {
                    "type": "array",
                    "description": "Ability IDs granted to characters of this class at creation",
                    "items": {
                        "type": "string",
                        "pattern": "^[a-z][a-z0-9-]*$"
                    },
                    "uniqueItems": true
                },
                "requirements": {
                    "oneOf": [
                        { "type": "null" },
                        {
                            "type": "object",
                            "description": "Optional unlock conditions for this class",
                            "properties": {
                                "level": {
                                    "type": "integer",
                                    "description": "Minimum character level to unlock",
                                    "minimum": 1
                                },
                                "achievementIds": {
                                    "type": "array",
                                    "description": "Achievement IDs required to unlock",
                                    "items": {
                                        "type": "string",
                                        "pattern": "^[a-z][a-z0-9-]*$"
                                    }
                                },
                                "questIds": {
                                    "type": "array",
                                    "description": "Quest IDs that must be completed",
                                    "items": {
                                        "type": "string",
                                        "pattern": "^[a-z][a-z0-9-]*$"
                                    }
                                }
                            },
                            "additionalProperties": false
                        }
                    ]
                },
                "sortOrder": {
                    "type": "integer",
                    "description": "Display order in character creation UI (lower = earlier)",
                    "minimum": 0,
                    "default": 0
                }
            },
            "required": [
                "id",
                "name",
                "description",
                "archetypeId",
                "statModifiers",
                "growthRates",
                "primaryResourceId",
                "startingAbilityIds"
            ],
            "additionalProperties": false
        },
        "StatModifiers": {
            "type": "object",
            "description": "Base stat adjustments applied at character creation (can be positive or negative)",
            "properties": {
                "maxHealth": {
                    "type": "integer",
                    "description": "Bonus or penalty to maximum health points",
                    "default": 0
                },
                "attack": {
                    "type": "integer",
                    "description": "Bonus or penalty to attack power",
                    "default": 0
                },
                "defense": {
                    "type": "integer",
                    "description": "Bonus or penalty to defense rating",
                    "default": 0
                },
                "might": {
                    "type": "integer",
                    "description": "Bonus or penalty to physical power attribute",
                    "default": 0
                },
                "fortitude": {
                    "type": "integer",
                    "description": "Bonus or penalty to physical resilience attribute",
                    "default": 0
                },
                "will": {
                    "type": "integer",
                    "description": "Bonus or penalty to mental fortitude attribute",
                    "default": 0
                },
                "wits": {
                    "type": "integer",
                    "description": "Bonus or penalty to mental acuity attribute",
                    "default": 0
                },
                "finesse": {
                    "type": "integer",
                    "description": "Bonus or penalty to dexterity attribute",
                    "default": 0
                }
            },
            "required": ["maxHealth", "attack", "defense", "might", "fortitude", "will", "wits", "finesse"],
            "additionalProperties": false
        },
        "GrowthRates": {
            "type": "object",
            "description": "Per-level stat increases for character progression (must be non-negative)",
            "properties": {
                "maxHealth": {
                    "type": "integer",
                    "description": "Health points gained per level",
                    "minimum": 0,
                    "default": 0
                },
                "attack": {
                    "type": "integer",
                    "description": "Attack power gained per level",
                    "minimum": 0,
                    "default": 0
                },
                "defense": {
                    "type": "integer",
                    "description": "Defense rating gained per level",
                    "minimum": 0,
                    "default": 0
                },
                "might": {
                    "type": "integer",
                    "description": "Might attribute growth per level",
                    "minimum": 0,
                    "default": 0
                },
                "fortitude": {
                    "type": "integer",
                    "description": "Fortitude attribute growth per level",
                    "minimum": 0,
                    "default": 0
                },
                "will": {
                    "type": "integer",
                    "description": "Will attribute growth per level",
                    "minimum": 0,
                    "default": 0
                },
                "wits": {
                    "type": "integer",
                    "description": "Wits attribute growth per level",
                    "minimum": 0,
                    "default": 0
                },
                "finesse": {
                    "type": "integer",
                    "description": "Finesse attribute growth per level",
                    "minimum": 0,
                    "default": 0
                }
            },
            "required": ["maxHealth", "attack", "defense", "might", "fortitude", "will", "wits", "finesse"],
            "additionalProperties": false
        }
    }
}
```

---

## 7. Configuration File Updates

### Updated classes.json

The existing `classes.json` needs a `$schema` reference added. All existing class definitions validate against the new schema without content changes.

**File:** `config/classes.json`

Required change - add `$schema` reference:
```json
{
    "$schema": "./schemas/classes.schema.json",
    "classes": [
        ...existing classes...
    ]
}
```

### Validation Confirmation

The existing five classes validate successfully:

| Class | ID Pattern | Archetype Ref | Resource Type | Growth Rates |
|-------|------------|---------------|---------------|--------------|
| Shieldmaiden | `shieldmaiden` ✓ | `warrior` ✓ | `rage` ✓ | All >= 0 ✓ |
| Shadow-Walker | `shadow-walker` ✓ | `skirmisher` ✓ | `energy` ✓ | All >= 0 ✓ |
| Scrap-Tinker | `scrap-tinker` ✓ | `adept` ✓ | `focus` ✓ | All >= 0 ✓ |
| Galdr-Caster | `galdr-caster` ✓ | `mystic` ✓ | `mana` ✓ | All >= 0 ✓ |
| Blood-Priest | `blood-priest` ✓ | `mystic` ✓ | `faith` ✓ | All >= 0 ✓ |

### Current Class Statistics Summary

| Class | maxHealth Mod | Attack Mod | Defense Mod | Resource |
|-------|---------------|------------|-------------|----------|
| Shieldmaiden | +20 | -2 | +5 | rage |
| Shadow-Walker | -10 | +5 | -2 | energy |
| Scrap-Tinker | 0 | 0 | 0 | focus |
| Galdr-Caster | -15 | +8 | -3 | mana |
| Blood-Priest | +5 | +2 | 0 | faith |

---

## 8. Data Model Changes

### No Domain Changes Required

This phase creates only a JSON Schema file for validation. No changes to domain entities, services, or application layer are required.

| Layer | Changes |
|-------|---------|
| Domain | None |
| Application | None |
| Infrastructure | None |
| Configuration | Schema file added, `$schema` reference added to classes.json |

### Schema as Documentation

The schema serves as:
- **Validation contract** for configuration files
- **IDE documentation** via description fields
- **Modding reference** for custom class creation
- **Archetype relationship enforcement** via archetypeId pattern

---

## 9. Logging Specifications

### No Runtime Logging Required

Schema validation occurs at design-time in IDE/editors, not at runtime. No logging infrastructure changes are needed for this phase.

| Component | Level | Events |
|-----------|-------|--------|
| N/A | N/A | Schema validation is IDE-based |

---

## 10. Unit Testing Requirements

### Test Count by Feature

| Feature | Test Count |
|---------|------------|
| Schema Valid Structure | ~1 |
| ID Pattern Validation | ~1 |
| Resource Type Enum Validation | ~1 |
| Growth Rate Non-Negative Validation | ~1 |
| Required Fields Validation | ~1 |
| **Total** | **~5** |

### Test Descriptions

#### ClassSchemaTests.cs

```csharp
[TestFixture]
public class ClassSchemaTests
{
    /// <summary>
    /// Verifies the schema file is valid JSON Schema Draft-07.
    /// </summary>
    [Test]
    public void Schema_IsValidJsonSchemaDraft07();

    /// <summary>
    /// Verifies the existing classes.json validates against the schema without errors.
    /// </summary>
    [Test]
    public void ExistingClassesJson_ValidatesAgainstSchema();

    /// <summary>
    /// Verifies class IDs must follow the kebab-case pattern.
    /// </summary>
    [Test]
    public void ClassId_InvalidPattern_FailsValidation();

    /// <summary>
    /// Verifies primaryResourceId must be one of the valid enum values.
    /// </summary>
    [Test]
    public void PrimaryResourceId_InvalidValue_FailsValidation();

    /// <summary>
    /// Verifies growth rates must be non-negative values.
    /// </summary>
    [Test]
    public void GrowthRates_NegativeValue_FailsValidation();
}
```

### Test Implementation Notes

Tests should use a JSON Schema validation library (e.g., `NJsonSchema` for C#) to:
1. Load the schema file
2. Validate test JSON documents
3. Assert expected validation results

---

## 11. Use Cases

### UC-001: Load Class Configuration

**Actor:** Game System
**Flow:** System starts → Loads `classes.json` → Schema validates content → Classes available for character creation

### UC-002: Edit Class in IDE

**Actor:** Developer/Modder
**Flow:** Opens `classes.json` in VS Code → IDE loads schema → Autocomplete suggests properties → Validation errors shown inline → Resource type enum shown in dropdown

### UC-003: Create Custom Class

**Actor:** Modder
**Flow:** Adds new class object to `classes.json` → IDE validates against schema → Errors shown for missing fields → Modder selects archetype from existing IDs → Modder selects resource from enum → Class validates successfully

### UC-004: Invalid Resource Type

**Actor:** Modder
**Flow:** Sets `primaryResourceId: "ki"` in class definition → IDE shows error "must be one of: mana, rage, energy, focus, faith, stamina" → Modder selects valid resource type

### UC-005: Negative Growth Rate

**Actor:** Modder
**Flow:** Sets `growthRates.maxHealth: -5` in class definition → IDE shows error "must be >= 0" → Modder corrects to non-negative value

---

## 12. Deliverable Checklist

### Schema Files
- [ ] `config/schemas/classes.schema.json` created
- [ ] Schema follows JSON Schema Draft-07 format
- [ ] Schema includes all defined properties
- [ ] Schema includes definitions section with ClassDefinition, StatModifiers, GrowthRates

### Validation Rules
- [ ] ID pattern validation: `^[a-z][a-z0-9-]*$`
- [ ] Archetype ID pattern validation
- [ ] Starting ability IDs pattern validation
- [ ] Resource type enum: mana, rage, energy, focus, faith, stamina
- [ ] Growth rates minimum: 0
- [ ] Required fields enforced
- [ ] Optional requirements field accepts null or object

### Configuration Updates
- [ ] `classes.json` updated with `$schema` reference
- [ ] Existing classes validate against schema
- [ ] No changes required to class data

### Testing
- [ ] ~5 unit tests implemented
- [ ] All tests passing
- [ ] Tests cover happy path and error cases

### Documentation
- [ ] Schema properties have descriptions
- [ ] This design specification complete

---

## 13. Acceptance Criteria

### Functional
- [ ] `classes.schema.json` created in `config/schemas/` directory
- [ ] Schema validates existing `classes.json` without errors
- [ ] Stat modifiers allow positive and negative values
- [ ] Growth rates require non-negative values (minimum: 0)
- [ ] Primary resource ID validated against enum (mana, rage, energy, focus, faith, stamina)
- [ ] Archetype ID reference format validated (kebab-case)
- [ ] Starting ability IDs validated as array of strings
- [ ] ID pattern enforced (lowercase kebab-case)
- [ ] Required fields enforced
- [ ] VS Code provides autocomplete when schema linked

### Quality
- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] ~5 unit tests pass
- [ ] Schema file is valid JSON
- [ ] All schema properties have descriptions

---

## 14. Dependencies

### Required from Prior Versions

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `classes.json` | `config/classes.json` | Validated by new schema |
| `archetypes.json` | `config/archetypes.json` | Archetype IDs referenced by classes |
| `archetypes.schema.json` | `config/schemas/archetypes.schema.json` | Pattern reference (from v0.14.0d) |
| Schema patterns | `config/schemas/terrain.schema.json` | Reference for schema structure |

### Provides to v0.14.0c

| Type | Usage |
|------|-------|
| Schema pattern | Background schema will follow same Draft-07 structure |
| ID validation | Same `^[a-z][a-z0-9-]*$` pattern reused |
| Stat structure | Similar stat-related definitions for backgrounds |

---

## 15. Future Considerations

### Deferred to v0.14.1 (Ability Cross-Reference Validation)

- **startingAbilityIds validation**: Cross-reference to abilities.json to verify ability IDs exist
- **archetypeId validation**: Cross-reference to archetypes.json to verify archetype exists

### Deferred to Future Versions

- **Multiclassing rules**: Requirements for taking additional classes
- **Prestige classes**: Advanced classes with prerequisites
- **Class ability trees**: Skill trees tied to class progression
- **Resource type definitions**: Custom resource types beyond the current enum

### Out of Scope

- **Runtime schema validation**: Application-level validation at load time (handled by existing provider patterns)
- **Schema versioning migration**: Automatic migration between schema versions
- **Class balance calculations**: Automated balance checking for stat distributions

---

*Document Version: 1.0*
*Last Updated: 2026-01-17*
*Author: Claude*
