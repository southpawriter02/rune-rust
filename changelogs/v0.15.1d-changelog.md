# Changelog v0.15.1d - Extended Check Mechanics

**Date:** 2026-01-22
**Version:** v0.15.1d
**Status:** Complete âœ…

## Summary

This version introduces **Cooperative Checks** and **Chained Checks** to the skill check system, enabling multi-participant coordinated checks and multi-step procedural checks with retry mechanics.

---

## Added

### Domain Layer - Enums

| Component | Description |
|-----------|-------------|
| `CooperationType` | 4 cooperation modes: WeakestLink, BestAttempt, Combined, Assisted |
| `ChainedCheckStatus` | 5 chain states: NotStarted, InProgress, AwaitingRetry, Succeeded, Failed |

### Domain Layer - Value Objects

| Component | Description |
|-----------|-------------|
| `CooperativeCheckResult` | Encapsulates cooperative check outcomes with participant IDs, helper contributions, and combined results |
| `ChainedCheckStep` | Configures individual chain steps with skill, DC, retry counts, and display messages |
| `HelperContribution` | Tracks helper roll results and bonus granting in Assisted checks |

### Domain Layer - Entities

| Component | Description |
|-----------|-------------|
| `ChainedCheckState` | Tracks multi-step chain progress with step results, retry counts, and completion status |
| `ChainedStepResult` | Records individual step outcomes including retry flags |

### Application Layer - Interfaces

| Component | Description |
|-----------|-------------|
| `IExtendedSkillCheckService` | Service contract for cooperative and chained check resolution |
| `IChainedCheckRepository` | Persistence interface for chained check states |

### Application Layer - Services

| Component | Description |
|-----------|-------------|
| `ExtendedSkillCheckService` | Full implementation of all 4 cooperation types and chained check mechanics |

### Infrastructure Layer

| Component | Description |
|-----------|-------------|
| `InMemoryChainedCheckRepository` | Thread-safe in-memory repository using `ConcurrentDictionary` |

### Unit Tests

| Test Class | Tests |
|------------|-------|
| `ChainedCheckStateTests` | 8 tests covering creation, step processing, retries, abandonment |
| `CooperativeCheckResultTests` | 4 tests covering IsSuccess, Margin, display formatting |
| `ChainedCheckStepTests` | 5 tests covering creation, difficulty naming, display formatting |

---

## Cooperation Types

| Type | Mechanic |
|------|----------|
| **WeakestLink** | Lowest dice pool participant rolls; group fails if they fail |
| **BestAttempt** | Everyone rolls; best result becomes group result |
| **Combined** | Sum all net successes against shared DC |
| **Assisted** | Primary roller gets +1d10 per helper with 2+ net successes |

---

## Verification

```
Build succeeded.
    0 Warning(s)
    0 Error(s)

Test summary: total: 17, failed: 0, succeeded: 17, skipped: 0
```

---

## Dependencies

- v0.15.1c Master Abilities (master ability integration)
- v0.15.1b Outcome Classification (skill outcomes)
- v0.15.1a Skill Context (contextual modifiers)

---

## File Summary

| Layer | Files Added |
|-------|-------------|
| Domain/Enums | `CooperationType.cs`, `ChainedCheckStatus.cs` |
| Domain/ValueObjects | `CooperativeCheckResult.cs`, `ChainedCheckStep.cs` |
| Domain/Entities | `ChainedCheckState.cs` |
| Application/Interfaces | `IExtendedSkillCheckService.cs`, `IChainedCheckRepository.cs` |
| Application/Services | `ExtendedSkillCheckService.cs` |
| Infrastructure/Repositories | `InMemoryChainedCheckRepository.cs` |
| Tests/Domain | `ChainedCheckStateTests.cs`, `CooperativeCheckResultTests.cs`, `ChainedCheckStepTests.cs` |
