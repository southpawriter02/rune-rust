# v0.0.11c Changelog - Environmental & Sensory Descriptors

**Release Date:** 2026-01-08
**Focus:** Multi-sensory environmental descriptions with lighting, sounds, smells, temperature, weather, and time-of-day

## Summary

This release implements a comprehensive multi-sensory descriptor system that generates immersive atmospheric descriptions based on environment context. The system layers lighting, ambient sounds, smells, temperature, and weather effects into coherent environmental narratives.

## New Features

### SmellIntensity Enum
- **4 intensity levels** defined:
  - Faint - "barely noticeable"
  - Noticeable - "clearly present"
  - Strong - "dominant odor"
  - Overwhelming - "nearly unbearable"

### LightingDescription Value Object
- Combines light source type, darkness level, and description text
- Supports 10 light source types: torch, crystal, bioluminescence, magical, sunlight, moonlight, lava_glow, pitch_black, dim, bright
- Biome-aware light source inference

### SoundDescription Value Object
- **3 layered sound levels**:
  - Distant - background atmosphere (echoes, wind, thunder)
  - Nearby - room-level sounds (dripping, creaking, breathing)
  - Immediate - close sounds (heartbeat, combat sounds)
- `HasSounds` property for validation
- `Primary` property returns first non-null layer
- `ToFullDescription()` combines all layers

### SmellDescription Value Object
- Biome-specific smell pools (cave, dungeon, volcanic, frozen, swamp, forest, ruins)
- Intensity-aware formatting
- Smell type extraction

### SensoryDescription Value Object
- Complete multi-sense output combining:
  - Lighting (visual)
  - Sounds (auditory)
  - Smell (olfactory)
  - Temperature (tactile)
  - Weather (environmental)
  - TimeOfDay (temporal)
- `HasDescriptions` property for validation
- `ToNarrative(maxSenses)` generates combined atmosphere text

### SensoryContext Record
- Captures all context for sensory generation:
  - `Environment` - EnvironmentContext from v0.0.11a
  - `LightSource` - explicit light source override
  - `Weather` - current weather condition
  - `TimeOfDay` - current time period
  - `IsIndoor` - indoor/outdoor flag
  - `InCombat` - combat state flag
  - `AdditionalTags` - extra filtering tags
- `GetAllTags()` combines environment and context tags

### SensoryDescriptorService
- `GenerateSensoryDescription()` - complete multi-sense generation
- `GetLightingDescription()` - light source with biome inference
- `GetSoundDescription()` - layered biome-specific sounds
- `GetSmellDescription()` - biome smell with intensity
- `GetTemperatureDescription()` - climate-integrated temperature
- `GetWeatherDescription()` - indoor/outdoor weather variants with climate validation
- `GetTimeOfDayDescription()` - outdoor-only time effects
- `GenerateBriefAtmosphere()` - condensed 3-sense output
- `GenerateDetailedAtmosphere()` - full sound layers + all senses

### SensoryConfiguration
- `LightSources` - light source definitions with pools and biome associations
- `DarknessLevels` - darkness level definitions with visibility and implied tags
- `WeatherConditions` - weather definitions with indoor/outdoor pools and climate validation
- `TimesOfDay` - time period definitions with outdoor pools and implied tags

### Configuration JSON Files
- **lighting.json** - 10 lighting pools with 46 descriptors
- **sounds.json** - 11 sound pools with 45 descriptors
- **smells.json** - 8 smell pools with 32 descriptors
- **weather.json** - 10 weather pools with 38 descriptors

## Files Created

### Domain Value Objects
- `src/Core/RuneAndRust.Domain/ValueObjects/SensoryDescription.cs`

### Application Configuration
- `src/Core/RuneAndRust.Application/Configuration/SensoryConfiguration.cs`

### Application Services
- `src/Core/RuneAndRust.Application/Services/SensoryDescriptorService.cs`

### Configuration Files
- `config/descriptors/lighting.json`
- `config/descriptors/sounds.json`
- `config/descriptors/smells.json`
- `config/descriptors/weather.json`

### Unit Tests
- `tests/RuneAndRust.Domain.UnitTests/ValueObjects/SensoryDescriptionTests.cs` (12 tests)
- `tests/RuneAndRust.Application.UnitTests/Services/SensoryDescriptorServiceTests.cs` (13 tests)

## Files Modified

- `src/Core/RuneAndRust.Application/Interfaces/IConfigurationProvider.cs` - Added `GetSensoryConfiguration()` method
- `src/Infrastructure/RuneAndRust.Infrastructure/Configuration/JsonConfigurationProvider.cs` - Implemented `GetSensoryConfiguration()` with default configuration
- `src/Infrastructure/RuneAndRust.Infrastructure/DependencyInjection.cs` - Registered SensoryDescriptorService
- `tests/RuneAndRust.TestUtilities/Mocks/MockConfigurationProvider.cs` - Added `GetSensoryConfiguration()` implementation

## Test Results

- **25 new tests** added (exceeded estimated ~18)
- **All 860 tests pass** (build verified)
- **0 warnings**

## Breaking Changes

None. All changes are additive and backwards compatible.

## Dependencies

- Requires v0.0.11a (Descriptor Framework Expansion) complete
- Requires v0.0.11b (Combat & Ability Descriptors) complete
- No new NuGet package dependencies

## Usage Example

```csharp
// Generate complete sensory description
var context = new SensoryContext
{
    Environment = new EnvironmentContext(
        new Dictionary<string, string>
        {
            ["biome"] = "cave",
            ["climate"] = "cold",
            ["lighting"] = "dim"
        },
        ["underground", "natural"]),
    LightSource = "bioluminescence",
    Weather = null, // Indoor, no weather
    IsIndoor = true,
    InCombat = false
};

var sensory = sensoryDescriptorService.GenerateSensoryDescription(context);
// sensory.Lighting.Description = "Phosphorescent fungi cast an eerie green glow across the cavern"
// sensory.Sounds.Distant = "Distant echoes from the cave depths"
// sensory.Smell.Description = "The sharp scent of minerals and wet stone"
// sensory.Smell.Intensity = SmellIntensity.Noticeable

var briefAtmosphere = sensoryDescriptorService.GenerateBriefAtmosphere(context);
// Returns: "Phosphorescent fungi cast an eerie green glow across the cavern. Distant echoes from the cave depths. The sharp scent of minerals and wet stone."

// Weather-aware outdoor description
var outdoorContext = new SensoryContext
{
    Environment = new EnvironmentContext(
        new Dictionary<string, string>
        {
            ["biome"] = "forest",
            ["climate"] = "temperate",
            ["lighting"] = "dim"
        },
        ["outdoor", "natural"]),
    Weather = "rain",
    TimeOfDay = "dusk",
    IsIndoor = false
};

var weatherDesc = sensoryDescriptorService.GetWeatherDescription(outdoorContext);
// Returns: "Steady rain patters against you"
```

## Descriptor Pool Summary

| Category | Pool Count | Descriptor Count |
|----------|------------|------------------|
| Lighting | 10 | 46 |
| Sounds | 11 | 45 |
| Smells | 8 | 32 |
| Weather | 10 | 38 |
| **Total** | **39** | **161** |

## Light Source Types

| Light Source | Biomes | Flickering |
|--------------|--------|------------|
| torch | dungeon, cave, ruins | Yes |
| crystal | cave, frozen | No |
| bioluminescence | cave, swamp | No |
| magical | ruins, dungeon | No |
| sunlight | forest | No |
| moonlight | forest | No |
| lava_glow | volcanic | Yes |

## Weather Climate Validation

| Weather | Valid Climates |
|---------|---------------|
| rain | temperate, tropical |
| storm | temperate, tropical |
| snow | cold, frozen |
| fog | temperate, swamp |
| wind | all |

## Next Steps

- **v0.0.11d**: Interactive Objects & Polish (object descriptions, ambient events, caching)
