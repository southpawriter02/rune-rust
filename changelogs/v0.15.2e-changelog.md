# v0.15.2e Changelog - Chase Sequences

**Release Date:** 2026-01-23
**Focus:** Chase sequence mechanics with distance track and dynamic obstacles
**Prerequisites:** v0.15.2a-d Complete (Climbing, Leaping, Fall Damage, Stealth Movement)

---

## Summary

This release implements the chase sequence system, enabling dramatic pursuit encounters where characters pursue or flee from each other across a distance track. The system features dynamic obstacle generation, round-by-round resolution, and multiple outcome states.

---

## Added

### Domain Layer

#### Enums
- **`ChaseStatus`**: Chase outcome states
  - `InProgress`: Chase is ongoing
  - `Caught`: Fleeing character caught (distance ≤ 0)
  - `Escaped`: Fleeing character escaped (distance ≥ 6)
  - `Abandoned`: Participant voluntarily quit
  - `TimedOut`: Max rounds reached without resolution

- **`ObstacleType`**: Obstacle categories
  - `Gap`: Leap check (rooftop gaps, chasms)
  - `Climb`: Climb check (walls, fences)
  - `Debris`: Balance check (rubble, crates)
  - `Crowd`: Dodge check (civilians, crowds)
  - `Hazard`: Avoid check (steam, hazards)

#### Entities
- **`ChaseState`**: Chase encounter state tracking
  - `ChaseId`: Unique identifier
  - `FleeingId` / `PursuerId`: Participant IDs
  - `Distance`: Position on track (0-6+)
  - `ObstacleHistory`: Obstacles encountered
  - `RoundHistory`: Round results
  - `Status`: Current chase status
  - `MaxRounds`: Optional time limit
  - Factory method `Create()` with validation

#### Value Objects
- **`ChaseObstacle`**: Obstacle configuration
  - Type, DC, skill required
  - Success/failure descriptions
  - Factory methods: `CreateGap`, `CreateClimb`, `CreateDebris`, `CreateCrowd`, `CreateHazard`

- **`ChaseRoundResult`**: Round outcome capture
  - Both participants' outcomes and distance changes
  - Net distance calculation
  - Narrative generation with `GetNarrative()`

### Application Layer

#### Interfaces
- **`IChaseService`**: Chase operations contract
  - `StartChase()`: Initiate chase
  - `GenerateObstacle()`: Create round obstacle
  - `ProcessRound()`: Resolve round with dice
  - `AbandonChase()`: End chase early
  - `GetChase()` / `GetActiveChases()`: Query state

#### Services
- **`ChaseService`**: Full chase implementation
  - In-memory chase registry
  - Automatic obstacle variety (avoids last 2 types)
  - Dice pool integration via `IDiceService`
  - Comprehensive structured logging
  - Distance change calculation per outcome

### Configuration

- **`config/chase-obstacles.json`**: Data-driven configuration
  - Distance track zones and thresholds
  - Obstacle type definitions with DC ranges
  - Environment-weighted obstacle selection
  - Narrative templates for outcomes

- **`config/schemas/chase-obstacles.schema.json`**: JSON Schema validation

---

## Mechanics

### Distance Track
```
0        1        2        3        4        5        6+
│        │        │        │        │        │        │
▼        ▼        ▼        ▼        ▼        ▼        ▼
CAUGHT   CLOSE    CLOSE    NEAR     FAR      FAR      ESCAPED
```

### Distance Changes
| Outcome | Fleeing | Pursuer |
|---------|---------|---------|
| Critical Success | +2 | -2 |
| Success | +1 | -1 |
| Failure | -1 | +1 |
| Critical Failure | -2 | +2 |

### Round Resolution
1. Generate obstacle (varies by environment)
2. Fleeing character attempts obstacle check
3. Pursuer attempts same obstacle check
4. Apply distance changes from both outcomes
5. Check for catch/escape thresholds

### Obstacle Skill Mapping
| Type | Skill | Base DC |
|------|-------|---------|
| Gap | Acrobatics | 2-4 |
| Climb | Acrobatics | 2-4 |
| Debris | Acrobatics | 2-3 |
| Crowd | Acrobatics | 3-4 |
| Hazard | Acrobatics | 2-5 |

---

## Testing

Added 31 unit tests in `ChaseServiceTests`:
- Chase initialization (5 tests)
- Distance movement (5 tests)
- Chase end conditions (6 tests)
- Obstacle generation (3 tests)
- Chase queries (4 tests)
- ChaseState entity (3 tests)
- ChaseObstacle value object (4 tests)
- ChaseRoundResult value object (2 tests)

---

## Files Changed

### Added
- `src/Core/RuneAndRust.Domain/Enums/ChaseStatus.cs`
- `src/Core/RuneAndRust.Domain/Enums/ObstacleType.cs`
- `src/Core/RuneAndRust.Domain/Entities/ChaseState.cs`
- `src/Core/RuneAndRust.Domain/ValueObjects/ChaseObstacle.cs`
- `src/Core/RuneAndRust.Domain/ValueObjects/ChaseRoundResult.cs`
- `src/Core/RuneAndRust.Application/Interfaces/IChaseService.cs`
- `src/Core/RuneAndRust.Application/Services/ChaseService.cs`
- `config/chase-obstacles.json`
- `config/schemas/chase-obstacles.schema.json`
- `tests/RuneAndRust.Application.UnitTests/Services/ChaseServiceTests.cs`
- `changelogs/v0.15.2e-changelog.md`

---

## Breaking Changes

None.

---

## Migration Guide

No migration required. Chase service is opt-in via dependency injection.
