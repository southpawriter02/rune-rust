{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://rune-game.com/schemas/ability-descriptors.schema.json",
    "title": "Ability Descriptor Configuration",
    "description": "Schema for ability and Galdr flavor text descriptors. Supports casting sequences, manifestation descriptions, outcome narratives, miscast effects, weapon art descriptions, and skill usage flavor text. Version: 0.14.9b.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "JSON Schema reference for validation tooling."
        },
        "version": {
            "type": "string",
            "description": "Schema version in semver format (e.g., '1.0.0').",
            "pattern": "^\\d+\\.\\d+\\.\\d+$"
        },
        "category": {
            "type": "string",
            "description": "Descriptor category type. Determines which descriptor definition applies to pool contents.",
            "enum": [
                "galdr-actions",
                "galdr-manifestations",
                "galdr-outcomes",
                "galdr-miscasts",
                "weapon-arts",
                "skill-usage"
            ]
        },
        "pools": {
            "type": "object",
            "description": "Map of pool ID to descriptor array. Pool IDs follow pattern: {runeSchool}_{abilityName}_{successLevel} or {category}_{context}.",
            "additionalProperties": {
                "type": "array",
                "description": "Array of descriptors for weighted random selection.",
                "items": {
                    "oneOf": [
                        {
                            "$ref": "#/definitions/GaldrActionDescriptor"
                        },
                        {
                            "$ref": "#/definitions/GaldrManifestationDescriptor"
                        },
                        {
                            "$ref": "#/definitions/GaldrOutcomeDescriptor"
                        },
                        {
                            "$ref": "#/definitions/GaldrMiscastDescriptor"
                        },
                        {
                            "$ref": "#/definitions/WeaponArtDescriptor"
                        },
                        {
                            "$ref": "#/definitions/SkillUsageDescriptor"
                        }
                    ]
                },
                "minItems": 1
            },
            "propertyNames": {
                "pattern": "^[a-z][a-z0-9_]*$",
                "description": "Pool IDs must be snake_case starting with a lowercase letter."
            }
        }
    },
    "required": [
        "version",
        "category",
        "pools"
    ],
    "additionalProperties": false,
    "definitions": {
        "GaldrActionDescriptor": {
            "type": "object",
            "description": "Galdr casting sequence descriptor. Used for invocation, chant, rune manifestation, discharge, and aftermath phases of magic casting.",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique descriptor identifier. Must be lowercase with underscores/hyphens.",
                    "pattern": "^[a-z][a-z0-9_-]*$"
                },
                "text": {
                    "type": "string",
                    "description": "Descriptor text with {Variable} placeholders (e.g., {Target}, {Damage}, {Rune}).",
                    "minLength": 1
                },
                "weight": {
                    "type": "integer",
                    "description": "Selection weight for weighted random. Higher values = more likely to be selected.",
                    "minimum": 1,
                    "default": 10
                },
                "actionType": {
                    "type": "string",
                    "description": "Casting phase this descriptor applies to.",
                    "enum": [
                        "Invocation",
                        "Chant",
                        "RuneManifestation",
                        "Discharge",
                        "Aftermath",
                        "EffectTrigger",
                        "Activation"
                    ]
                },
                "runeSchool": {
                    "oneOf": [
                        {
                            "$ref": "#/definitions/RuneSchool"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "description": "Associated rune school from Elder Futhark. Null for generic descriptors."
                },
                "abilityName": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Specific ability name (e.g., 'FlameBolt'). Null for generic descriptors."
                },
                "successLevel": {
                    "oneOf": [
                        {
                            "$ref": "#/definitions/SuccessLevel"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "description": "Success level filter. Null to apply to any success level."
                },
                "biome": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Biome-specific variant (e.g., 'Muspelheim', 'Niflheim'). Null for universal."
                },
                "tags": {
                    "type": "array",
                    "description": "Metadata tags for filtering and categorization (e.g., 'Verbose', 'Concise', 'Dramatic').",
                    "items": {
                        "type": "string"
                    },
                    "default": []
                }
            },
            "required": [
                "id",
                "text",
                "actionType"
            ],
            "additionalProperties": false
        },
        "GaldrManifestationDescriptor": {
            "type": "object",
            "description": "Galdr sensory manifestation descriptor. Describes visual, auditory, tactile, and supernatural effects of magic.",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique descriptor identifier.",
                    "pattern": "^[a-z][a-z0-9_-]*$"
                },
                "text": {
                    "type": "string",
                    "description": "Manifestation description with {Variable} placeholders.",
                    "minLength": 1
                },
                "weight": {
                    "type": "integer",
                    "description": "Selection weight for weighted random.",
                    "minimum": 1,
                    "default": 10
                },
                "manifestationType": {
                    "type": "string",
                    "description": "Sensory type of the manifestation.",
                    "enum": [
                        "Visual",
                        "Auditory",
                        "Tactile",
                        "Supernatural",
                        "RunicGlyph"
                    ]
                },
                "runeSchool": {
                    "$ref": "#/definitions/RuneSchool",
                    "description": "Associated rune school from Elder Futhark."
                },
                "element": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Element type (e.g., 'Fire', 'Ice', 'Lightning', 'Poison', 'Shadow'). Null if non-elemental."
                },
                "powerLevel": {
                    "type": "string",
                    "description": "Power intensity of the manifestation.",
                    "enum": [
                        "Weak",
                        "Moderate",
                        "Strong",
                        "Devastating",
                        "Catastrophic"
                    ],
                    "default": "Moderate"
                },
                "biome": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Biome-specific variant. Null for universal."
                },
                "environmentalInteraction": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Description of how magic interacts with the environment."
                },
                "tags": {
                    "type": "array",
                    "description": "Metadata tags for filtering.",
                    "items": {
                        "type": "string"
                    },
                    "default": []
                }
            },
            "required": [
                "id",
                "text",
                "manifestationType",
                "runeSchool"
            ],
            "additionalProperties": false
        },
        "GaldrOutcomeDescriptor": {
            "type": "object",
            "description": "Galdr ability outcome descriptor. Describes the result of an ability (hit, miss, critical, etc.).",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique descriptor identifier.",
                    "pattern": "^[a-z][a-z0-9_-]*$"
                },
                "text": {
                    "type": "string",
                    "description": "Outcome narrative with {Variable} placeholders (e.g., {Target}, {Damage}, {Target_Location}).",
                    "minLength": 1
                },
                "weight": {
                    "type": "integer",
                    "description": "Selection weight for weighted random.",
                    "minimum": 1,
                    "default": 10
                },
                "outcomeType": {
                    "type": "string",
                    "description": "Result type of the ability.",
                    "enum": [
                        "Hit",
                        "Miss",
                        "CriticalHit",
                        "PartialEffect",
                        "FullEffect",
                        "Resisted",
                        "Immune",
                        "Amplified"
                    ]
                },
                "abilityName": {
                    "type": "string",
                    "description": "Associated ability name (e.g., 'FlameBolt', 'HealingChant').",
                    "minLength": 1
                },
                "successCount": {
                    "type": [
                        "integer",
                        "null"
                    ],
                    "description": "Specific success count filter. Null to apply to any count.",
                    "minimum": 0
                },
                "targetType": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Target classification for more specific matching.",
                    "enum": [
                        "Enemy",
                        "Self",
                        "Ally",
                        "Area",
                        "Environment",
                        null
                    ]
                },
                "enemyArchetype": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Enemy archetype for archetype-specific descriptors (e.g., 'Forlorn', 'Servitor')."
                },
                "effectCategory": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Effect type classification for the ability.",
                    "enum": [
                        "Damage",
                        "Healing",
                        "Buff",
                        "Debuff",
                        "Control",
                        "Utility",
                        "Summon",
                        null
                    ]
                },
                "tags": {
                    "type": "array",
                    "description": "Metadata tags for filtering.",
                    "items": {
                        "type": "string"
                    },
                    "default": []
                }
            },
            "required": [
                "id",
                "text",
                "outcomeType",
                "abilityName"
            ],
            "additionalProperties": false
        },
        "GaldrMiscastDescriptor": {
            "type": "object",
            "description": "Galdr miscast/failure descriptor. Describes magical failures including Blight corruption, paradox, backlash, etc.",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique descriptor identifier.",
                    "pattern": "^[a-z][a-z0-9_-]*$"
                },
                "text": {
                    "type": "string",
                    "description": "Miscast narrative describing the failure.",
                    "minLength": 1
                },
                "weight": {
                    "type": "integer",
                    "description": "Selection weight for weighted random.",
                    "minimum": 1,
                    "default": 10
                },
                "miscastType": {
                    "type": "string",
                    "description": "Type of magical failure.",
                    "enum": [
                        "BlightCorruption",
                        "Paradox",
                        "Backlash",
                        "Fizzle",
                        "WildMagic",
                        "AlfheimDistortion",
                        "RunicInversion"
                    ]
                },
                "severity": {
                    "type": "string",
                    "description": "Severity level of the miscast. Determines mechanical impact.",
                    "enum": [
                        "Minor",
                        "Moderate",
                        "Severe",
                        "Catastrophic"
                    ]
                },
                "runeSchool": {
                    "oneOf": [
                        {
                            "$ref": "#/definitions/RuneSchool"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "description": "Affected rune school. Null for generic miscasts."
                },
                "abilityName": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Specific ability that misfired. Null for generic miscasts."
                },
                "corruptionSource": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Cause of the corruption.",
                    "enum": [
                        "RunicBlight",
                        "AlfheimCursedChoir",
                        "AethericOverload",
                        null
                    ]
                },
                "biome": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Biome-specific variant (e.g., Alfheim for Cursed Choir)."
                },
                "mechanicalEffect": {
                    "type": [
                        "object",
                        "null"
                    ],
                    "description": "Game mechanical effects of the miscast. Applied during runtime.",
                    "properties": {
                        "damage": {
                            "type": "integer",
                            "description": "Damage dealt to caster or targets.",
                            "minimum": 0
                        },
                        "status": {
                            "type": "string",
                            "description": "Status effect applied (e.g., 'Corrupted', 'Stunned')."
                        },
                        "duration": {
                            "type": "integer",
                            "description": "Duration of effect in turns.",
                            "minimum": 0
                        },
                        "target": {
                            "type": "string",
                            "description": "Target of the effect (e.g., 'Self', 'Enemy', 'Area', 'All')."
                        },
                        "ap_loss": {
                            "type": "integer",
                            "description": "Action points lost.",
                            "minimum": 0
                        },
                        "healing_to_enemy": {
                            "type": "integer",
                            "description": "Healing given to enemy (for drain reversals).",
                            "minimum": 0
                        },
                        "random_effect": {
                            "type": "boolean",
                            "description": "Whether to trigger random effect table."
                        },
                        "corruption": {
                            "type": "integer",
                            "description": "Corruption points gained.",
                            "minimum": 0
                        },
                        "permanent_effect": {
                            "type": "string",
                            "description": "Permanent effect applied (e.g., 'Choir_Touched')."
                        },
                        "cosmetic": {
                            "type": "boolean",
                            "description": "Whether the effect is purely cosmetic."
                        }
                    },
                    "additionalProperties": true
                },
                "tags": {
                    "type": "array",
                    "description": "Metadata tags for filtering.",
                    "items": {
                        "type": "string"
                    },
                    "default": []
                }
            },
            "required": [
                "id",
                "text",
                "miscastType",
                "severity"
            ],
            "additionalProperties": false
        },
        "WeaponArtDescriptor": {
            "type": "object",
            "description": "Weapon art ability descriptor. Describes non-magical combat abilities and special attacks.",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique descriptor identifier.",
                    "pattern": "^[a-z][a-z0-9_-]*$"
                },
                "text": {
                    "type": "string",
                    "description": "Ability description with {Variable} placeholders (e.g., {Weapon}, {Target}).",
                    "minLength": 1
                },
                "weight": {
                    "type": "integer",
                    "description": "Selection weight for weighted random.",
                    "minimum": 1,
                    "default": 10
                },
                "abilityCategory": {
                    "type": "string",
                    "description": "Type of combat ability.",
                    "enum": [
                        "WeaponArt",
                        "TacticalAbility",
                        "DefensiveAbility",
                        "PassiveAbility",
                        "ResourceAbility"
                    ]
                },
                "abilityName": {
                    "type": "string",
                    "description": "Specific ability name (e.g., 'WhirlwindStrike', 'ShieldBash').",
                    "minLength": 1
                },
                "weaponType": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Associated weapon type for weapon-specific descriptors.",
                    "enum": [
                        "TwoHanded",
                        "OneHanded",
                        "DualWield",
                        "Bow",
                        "Crossbow",
                        "Unarmed",
                        "Shield",
                        null
                    ]
                },
                "specialization": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Player specialization for specialization-specific descriptors."
                },
                "successLevel": {
                    "oneOf": [
                        {
                            "$ref": "#/definitions/SuccessLevel"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "description": "Success level filter. Null to apply to any success level."
                },
                "tags": {
                    "type": "array",
                    "description": "Metadata tags for filtering (e.g., 'Melee', 'AoE', 'Single-Target').",
                    "items": {
                        "type": "string"
                    },
                    "default": []
                }
            },
            "required": [
                "id",
                "text",
                "abilityCategory",
                "abilityName"
            ],
            "additionalProperties": false
        },
        "SkillUsageDescriptor": {
            "type": "object",
            "description": "Skill usage descriptor. Describes flavor text for skill-based actions outside of combat.",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique descriptor identifier.",
                    "pattern": "^[a-z][a-z0-9_-]*$"
                },
                "text": {
                    "type": "string",
                    "description": "Skill usage description with {Variable} placeholders.",
                    "minLength": 1
                },
                "weight": {
                    "type": "integer",
                    "description": "Selection weight for weighted random.",
                    "minimum": 1,
                    "default": 10
                },
                "skillName": {
                    "type": "string",
                    "description": "Associated skill name (e.g., 'Lockpicking', 'Persuasion').",
                    "minLength": 1
                },
                "successLevel": {
                    "oneOf": [
                        {
                            "$ref": "#/definitions/SuccessLevel"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "description": "Success level filter. Null to apply to any success level."
                },
                "difficulty": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Task difficulty level.",
                    "enum": [
                        "trivial",
                        "easy",
                        "moderate",
                        "hard",
                        "very_hard",
                        "near_impossible",
                        null
                    ]
                },
                "tags": {
                    "type": "array",
                    "description": "Metadata tags for filtering.",
                    "items": {
                        "type": "string"
                    },
                    "default": []
                }
            },
            "required": [
                "id",
                "text",
                "skillName"
            ],
            "additionalProperties": false
        },
        "RuneSchool": {
            "type": "string",
            "description": "Elder Futhark rune school. The 24 runes form the foundation of the Galdr magic system.",
            "enum": [
                "Fehu",
                "Uruz",
                "Thurisaz",
                "Ansuz",
                "Raido",
                "Kenaz",
                "Gebo",
                "Wunjo",
                "Hagalaz",
                "Naudiz",
                "Isa",
                "Jera",
                "Eihwaz",
                "Perthro",
                "Algiz",
                "Sowilo",
                "Tiwaz",
                "Berkanan",
                "Ehwaz",
                "Mannaz",
                "Laguz",
                "Ingwaz",
                "Dagaz",
                "Othala"
            ]
        },
        "SuccessLevel": {
            "type": "string",
            "description": "Ability success level based on dice pool successes.",
            "enum": [
                "MinorSuccess",
                "SolidSuccess",
                "ExceptionalSuccess",
                "Failure",
                "CriticalFailure"
            ]
        }
    }
}