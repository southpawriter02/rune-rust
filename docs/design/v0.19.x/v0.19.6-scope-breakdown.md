# v0.19.6 Biome Integration, Transitions & Descriptors - Scope Breakdown

**Version:** 0.19.6
**Theme:** Biome Integration, Navigation, Transitions & Descriptors
**Prerequisites:** v0.19.5 (Alfheim & Asgard)
**Total Estimated Tests:** ~52 new tests
**Lore References:** All realm .md files (§12, §14), biomes-overview.md

---

## Executive Summary

v0.19.6 completes the biome system by implementing four major integration systems:

1. **Transition Zone Generation** — Property interpolation between compatible realms
2. **Navigation Service** — Route classification, travel times, choke points from all realm lore
3. **Descriptor Service** — Procedural room descriptions using thematic modifiers from lore §12
4. **Validation Service** — Configuration validation and adjacency rule enforcement

This integration phase ties together all 9 realm implementations into a cohesive, lore-compliant system.

| Phase | Name | Focus | Est. Tests |
|-------|------|-------|------------|
| v0.19.6a | Transition System | Zone generation, property interpolation | ~14 |
| v0.19.6b | Navigation System | Routes, travel times, choke points | ~14 |
| v0.19.6c | Descriptor System | Thematic modifiers, room descriptions | ~14 |
| v0.19.6d | Validation & Integration | Config validation, system tests | ~10 |

---

## Feature Analysis & Categorization

| Feature | Complexity | Dependencies | Assigned Phase | Lore Ref |
|---------|------------|--------------|----------------|----------|
| ITransitionZoneGenerator | High | All realm configs | **v0.19.6a** | biomes-overview.md |
| Property Interpolation | High | BiomeProperties | **v0.19.6a** | biomes-overview.md |
| Adjacency Enforcement | Medium | IBiomeAdjacencyService | **v0.19.6a** | biomes-overview.md |
| INavigationService | High | Route registry | **v0.19.6b** | all realm §14 |
| Route Classification | Medium | Route data | **v0.19.6b** | all realm §14 |
| Choke Point Registry | Medium | Choke point data | **v0.19.6b** | all realm §14 |
| IDescriptorService | High | Thematic modifiers | **v0.19.6c** | all realm §12 |
| Room Description Templates | High | Template registry | **v0.19.6c** | all realm §12 |
| Ambient Sound Library | Medium | Sound registry | **v0.19.6c** | all realm §12 |
| IBiomeValidationService | Medium | All biome services | **v0.19.6d** | — |
| ISectorAssignmentService | Medium | DungeonGenerator | **v0.19.6d** | — |

---

## Phase Definitions

## v0.19.6a: Transition Zone System

### Scope

**In Scope:**
- `ITransitionZoneGenerator` interface and implementation
- Property interpolation between compatible realms (linear blend)
- Transition environmental condition handling
- Adjacency compatibility enforcement
- Transition room count based on compatibility level

**Out of Scope:**
- Visual transition effects (UI concern)
- Dynamic biome generation (procedural content)
- Weather systems

### Service Interface

```csharp
public interface ITransitionZoneGenerator
{
    TransitionZone? GenerateTransition(RealmId fromRealm, RealmId toRealm);
    IReadOnlyList<TransitionZone> GenerateTransitionSequence(
        RealmId fromRealm, RealmId toRealm, int roomCount);
    BiomeProperties InterpolateProperties(
        BiomeProperties from, BiomeProperties to, float blend);
    bool CanGenerateTransition(RealmId fromRealm, RealmId toRealm);
    AdjacencyCompatibility GetCompatibility(RealmId fromRealm, RealmId toRealm);
}

public record TransitionZone(
    RealmId FromRealm,
    RealmId ToRealm,
    BiomeProperties BlendedProperties,
    EnvironmentalCondition? TransitionCondition,
    string TransitionTheme,
    float BlendFactor);

public enum AdjacencyCompatibility
{
    Compatible,         // Direct transition, 0-1 rooms
    RequiresTransition, // Gradual transition, 1-3 rooms
    Incompatible        // No transition possible
}
```

### Adjacency Matrix (biomes-overview.md)

| From | To | Compatibility | Transition Theme | Notes |
|------|-----|---------------|------------------|-------|
| Midgard | Vanaheim | Compatible | "River routes upward" | Primary supply route |
| Midgard | Muspelheim | RequiresTransition | "Heat increases gradually" | Thermal preparation |
| Midgard | Niflheim | RequiresTransition | "Cold seeps in" | Thermal preparation |
| Midgard | Svartalfheim | Compatible | "Descent into darkness" | Mining access |
| Midgard | Jötunheim | RequiresTransition | "Scale increases" | Industrial frontier |
| Muspelheim | Niflheim | **Incompatible** | — | Fire/Ice |
| Muspelheim | Vanaheim | **Incompatible** | — | Fire/Bio |
| Muspelheim | Svartalfheim | RequiresTransition | "Forges cool" | Trade routes |
| Niflheim | Helheim | RequiresTransition | "Cold to decay" | — |
| Vanaheim | Alfheim | Compatible | "Bio to Aether" | Shared heritage |
| Alfheim | Asgard | RequiresTransition | "Reality tears" | Extreme hazard |
| Svartalfheim | Helheim | RequiresTransition | "Garm's Watch" | Dangerous passage |
| Svartalfheim | Jötunheim | Compatible | "Industry scales up" | Manufacturing link |

### Property Interpolation

Transition zones blend properties from adjacent realms at specified blend factor:

```csharp
public BiomeProperties InterpolateProperties(
    BiomeProperties from, BiomeProperties to, float blend)
{
    return new BiomeProperties
    {
        Temperature = Lerp(from.Temperature, to.Temperature, blend),
        AethericIntensity = Lerp(from.AethericIntensity, to.AethericIntensity, blend),
        Humidity = Lerp(from.Humidity, to.Humidity, blend),
        LightLevel = Lerp(from.LightLevel, to.LightLevel, blend),
        ScaleFactor = Lerp(from.ScaleFactor, to.ScaleFactor, blend),
        CorrosionRate = Lerp(from.CorrosionRate, to.CorrosionRate, blend)
    };
}
```

**Example: Midgard → Vanaheim (50% blend)**

| Property | Midgard | Vanaheim | Transition |
|----------|---------|----------|------------|
| Temperature | 18°C | 28°C | 23°C |
| Aetheric | 0.3 | 0.5 | 0.4 |
| Humidity | 60% | 85% | 72% |
| Light | 0.7 | 0.6 | 0.65 |
| Scale | 1.0 | 1.0 | 1.0 |
| Corrosion | 0.2 | 0.4 | 0.3 |

### Transition Room Count

| Compatibility | Min Rooms | Max Rooms | Condition Handling |
|---------------|-----------|-----------|-------------------|
| Compatible | 0 | 1 | No condition in transition |
| RequiresTransition | 1 | 3 | Blend conditions or use milder DC |
| Incompatible | N/A | N/A | No transition possible |

### v0.19.6a Acceptance Criteria

- [ ] Transition zones generate between compatible realms
- [ ] Property interpolation blends values correctly (50% default)
- [ ] Incompatible realms (Fire/Ice, Fire/Bio) refuse to generate transition
- [ ] Transition room count respects compatibility limits
- [ ] Transition theme from adjacency matrix applied
- [ ] CanGenerateTransition returns correct boolean
- [ ] ~14 unit tests pass

---

## v0.19.6b: Navigation System

### Scope

**In Scope:**
- `INavigationService` interface and implementation
- Route classification from all realm lore (§14)
- Travel time estimation
- Choke point registry from all realm lore
- Route safety calculation
- Inter-realm route definitions

**Out of Scope:**
- Dynamic route changes (weather/events)
- Pathfinding algorithms
- Map visualization

### Service Interface

```csharp
public interface INavigationService
{
    RouteClassification ClassifyRoute(RealmId fromRealm, RealmId toRealm);
    RouteClassification ClassifyIntraRealmRoute(RealmId realm, string fromZone, string toZone);
    TimeSpan EstimateTravelTime(RealmId fromRealm, RealmId toRealm);
    RouteSafety GetRouteSafety(RouteClassification classification);
    IReadOnlyList<ChokePoint> GetChokePoints(RealmId realm);
    IReadOnlyList<InterRealmRoute> GetAllInterRealmRoutes();
    bool IsRouteAvailable(RealmId fromRealm, RealmId toRealm);
}

public record RouteClassification(
    RouteClass Class,
    string Description,
    float TravelSpeedKmPerDay,
    string[] Requirements,
    int EnvironmentalDc,
    int CombatModifier);

public enum RouteClass
{
    A,  // Major arteries, well-maintained
    B,  // Secondary routes, moderate difficulty
    C,  // Frontier routes, significant hazards
    D   // Extreme routes, maximum danger
}

public enum RouteSafety
{
    Safe,       // Well-traveled, no hazards
    Moderate,   // Some hazards, occasional combat
    Dangerous,  // Significant hazards, frequent combat
    Extreme     // Severe hazards, constant threat
}
```

### Route Classification by Realm (all realm §14)

#### Midgard Routes (midgard.md §14)

| Class | Route Type | Speed | Requirements |
|-------|-----------|-------|--------------|
| **A** | Hold-to-Hold roads | 15-25 km/day | None |
| **B** | Frontier trails | 10-15 km/day | Local knowledge |
| **C** | Scar perimeter | 5-10 km/day | Specialized gear |
| **D** | Deep Scar penetration | <5 km/day | Maximum protocols |

#### Muspelheim Routes (muspelheim.md §14)

| Class | Route Type | Speed | Requirements |
|-------|-----------|-------|--------------|
| **B** | Hearth-to-Hearth corridors | 8-12 km/day | Thermal protection |
| **C** | Slag crossing | 4-8 km/day | Heat resistance, probing |
| **D** | Gjöllflow crossing | <4 km/day | Maximum thermal protocols |

#### Niflheim Routes (niflheim.md §14)

| Class | Route Type | Speed | Requirements |
|-------|-----------|-------|--------------|
| **B** | Archive approaches | 6-10 km/day | Cold protection |
| **C** | Permafrost traversal | 3-6 km/day | Thermal gear, escort |
| **D** | Hvergelmir approach | <3 km/day | Maximum cold protocols |

#### Vanaheim Routes (vanaheim.md §14)

| Class | Route Type | Speed | Requirements |
|-------|-----------|-------|--------------|
| **B** | Canopy Sea Skyways | 6-10 km/day | Sky Looms certification |
| **C** | Gloom-Veil passages | 3-6 km/day | Warden escort, masks |
| **D** | Under-growth penetration | <1 km/day | Maximum contamination protocols |

#### Alfheim Routes (alfheim.md §14)

| Class | Route Type | Speed | Requirements |
|-------|-----------|-------|--------------|
| **B** | Luminous approaches | 8-12 km/day | Reality anchors |
| **C** | Prismatic traversal | 4-8 km/day | Dökkálfar guidance |
| **D** | Dreaming core approach | <4 km/day | Maximum cognitive protocols |

#### Asgard Routes (asgard.md §14)

| Class | Route Type | Speed | Requirements |
|-------|-----------|-------|--------------|
| **C** | Debris fields | 3-6 km/day | Zero-G experience |
| **D** | CPS zones | <2 km/day | Full CPS protocols, time limits |

#### Svartalfheim Routes (svartalfheim.md §14)

| Class | Route Type | Speed | Requirements |
|-------|-----------|-------|--------------|
| **A** | Guild highways | 12-18 km/day | Dvergr safe-conduct |
| **B** | Mining passages | 8-12 km/day | Light sources |
| **C** | Blackvein depths | 4-8 km/day | Blight containment |
| **D** | Garm's Watch | <4 km/day | Maximum security |

#### Jötunheim Routes (jotunheim.md §14)

| Class | Route Type | Speed | Requirements |
|-------|-----------|-------|--------------|
| **B** | Bone Yard paths | 6-10 km/day | Scale navigation |
| **C** | Utgard approaches | 3-6 km/day | Giant-scale climbing |
| **D** | Grinding Hall | <3 km/day | Industrial hazard protocols |

#### Helheim Routes (helheim.md §14)

| Class | Route Type | Speed | Requirements |
|-------|-----------|-------|--------------|
| **C** | Labyrinth passages | 3-6 km/day | Corrosion protection |
| **D** | Sump approaches | <2 km/day | Full hazmat, time limits |

### Route Safety Mapping

| Class | Safety | Environmental DC | Combat Modifier | Description |
|-------|--------|-----------------|-----------------|-------------|
| **A** | Safe | None | 0 | Well-traveled, no hazards |
| **B** | Moderate | DC 10 | +1 | Some hazards, occasional combat |
| **C** | Dangerous | DC 14 | +2 | Significant hazards, frequent combat |
| **D** | Extreme | DC 18 | +3 | Severe hazards, constant threat |

### Inter-Realm Route Registry

```json
{
  "interRealmRoutes": [
    {
      "id": "midgard-vanaheim-river",
      "from": "Midgard",
      "to": "Vanaheim",
      "name": "Up-River Ferry",
      "travelDays": "6-9",
      "class": "B/C",
      "notes": "Flood detours possible",
      "loreRef": "vanaheim.md §17"
    },
    {
      "id": "midgard-muspelheim-thermal",
      "from": "Midgard",
      "to": "Muspelheim",
      "name": "Thermal Gradient Descent",
      "travelDays": "3-5",
      "class": "C",
      "notes": "Requires thermal acclimation",
      "loreRef": "muspelheim.md §17"
    },
    {
      "id": "svartalfheim-helheim-garm",
      "from": "Svartalfheim",
      "to": "Helheim",
      "name": "Garm's Watch Passage",
      "travelDays": "2-4",
      "class": "D",
      "notes": "Extremely dangerous",
      "loreRef": "helheim.md §17"
    },
    {
      "id": "alfheim-asgard-torn",
      "from": "Alfheim",
      "to": "Asgard",
      "name": "Reality Tear Approach",
      "travelDays": "1-3",
      "class": "D",
      "notes": "CPS exposure, time distortion",
      "loreRef": "asgard.md §17"
    },
    {
      "id": "muspelheim-svartalfheim-forge",
      "from": "Muspelheim",
      "to": "Svartalfheim",
      "name": "Forge Trade Route",
      "travelDays": "4-6",
      "class": "C",
      "notes": "Temperature transition",
      "loreRef": "svartalfheim.md §17"
    },
    {
      "id": "svartalfheim-jotunheim-industrial",
      "from": "Svartalfheim",
      "to": "Jötunheim",
      "name": "Industrial Ascent",
      "travelDays": "3-5",
      "class": "B/C",
      "notes": "Scale transition",
      "loreRef": "jotunheim.md §17"
    },
    {
      "id": "niflheim-helheim-cold",
      "from": "Niflheim",
      "to": "Helheim",
      "name": "Cold Decay Passage",
      "travelDays": "2-4",
      "class": "C/D",
      "notes": "Temperature/contamination shift",
      "loreRef": "helheim.md §17"
    }
  ]
}
```

### Choke Point Registry (all realm §14)

```json
{
  "chokePoints": {
    "midgard": [
      {"id": "CP-MID-001", "name": "Scar Perimeter Gates", "type": "Fortified", "controlledBy": "Ridge Holds"},
      {"id": "CP-MID-002", "name": "Mire Ferry Crossings", "type": "Seasonal", "controlledBy": "Ferry Guild"},
      {"id": "CP-MID-003", "name": "Fjord Harbor Entrances", "type": "Naval", "controlledBy": "Serpent Fjord clans"}
    ],
    "muspelheim": [
      {"id": "CP-MUS-001", "name": "Hearth Gates", "type": "Thermal", "controlledBy": "Hearth-Clans"},
      {"id": "CP-MUS-002", "name": "Gjöllflow Crossings", "type": "Natural", "controlledBy": "None"},
      {"id": "CP-MUS-003", "name": "Ashfall Beacons", "type": "Navigation", "controlledBy": "Trade caravans"}
    ],
    "niflheim": [
      {"id": "CP-NIF-001", "name": "Archive Entrances", "type": "Fortified", "controlledBy": "Einherjar"},
      {"id": "CP-NIF-002", "name": "Hvergelmir Perimeter", "type": "Natural", "controlledBy": "None"}
    ],
    "vanaheim": [
      {"id": "CP-VAN-001", "name": "Sky Looms Stations", "type": "Ferry", "controlledBy": "Sky Looms Guild"},
      {"id": "CP-VAN-002", "name": "Gloom-Veil Entry Points", "type": "Vertical", "controlledBy": "Wardens"},
      {"id": "CP-VAN-003", "name": "Under-growth Boundary", "type": "Territorial", "controlledBy": "The Unraveled"}
    ],
    "alfheim": [
      {"id": "CP-ALF-001", "name": "Luminous Gates", "type": "Reality", "controlledBy": "Dökkálfar"},
      {"id": "CP-ALF-002", "name": "Dreaming Approaches", "type": "Cognitive", "controlledBy": "None"}
    ],
    "asgard": [
      {"id": "CP-ASG-001", "name": "Debris Field Entry", "type": "Navigational", "controlledBy": "None"},
      {"id": "CP-ASG-002", "name": "Heimdallr Array", "type": "Surveillance", "controlledBy": "Automated"}
    ],
    "svartalfheim": [
      {"id": "CP-SVA-001", "name": "Guild Gate Checkpoints", "type": "Economic", "controlledBy": "Dvergr Guilds"},
      {"id": "CP-SVA-002", "name": "Garm's Watch", "type": "Fortified", "controlledBy": "Dvergr Military"}
    ],
    "jotunheim": [
      {"id": "CP-JOT-001", "name": "Bone Yard Entrances", "type": "Scale", "controlledBy": "None"},
      {"id": "CP-JOT-002", "name": "Grinding Hall Access", "type": "Industrial", "controlledBy": "Automated"}
    ],
    "helheim": [
      {"id": "CP-HEL-001", "name": "Labyrinth Gates", "type": "Contamination", "controlledBy": "None"},
      {"id": "CP-HEL-002", "name": "Sump Boundaries", "type": "Hazmat", "controlledBy": "None"}
    ]
  }
}
```

### v0.19.6b Acceptance Criteria

- [ ] Route classification returns correct class for all realm pairs
- [ ] Travel time estimation within lore ranges
- [ ] Choke points loaded for all 9 realms
- [ ] Inter-realm routes registry complete
- [ ] Route safety correctly maps to class
- [ ] Incompatible routes (Fire/Ice, Fire/Bio) return unavailable
- [ ] ~14 unit tests pass

---

## v0.19.6c: Descriptor System

### Scope

**In Scope:**
- `IDescriptorService` interface and implementation
- Thematic modifiers from all realm lore (§12.1)
- Room description template system
- Ambient sound library per zone
- Temperature and light descriptors
- Color palette registry

**Out of Scope:**
- Audio playback (UI concern)
- Visual rendering
- Dynamic descriptor changes (weather)

### Service Interface

```csharp
public interface IDescriptorService
{
    string GenerateRoomDescription(Room room, DescriptorContext context);
    string[] GetAmbientSounds(BiomeZone zone);
    string GetTemperatureDescriptor(float celsius);
    string GetLightDescriptor(float lightLevel);
    string GetModifierAdjective(RealmId realm);
    ThematicModifier GetThematicModifier(RealmId realm);
    string[] GetColorPalette(RealmId realm);
}

public class DescriptorContext
{
    public BiomeDefinition Biome { get; set; }
    public BiomeZone Zone { get; set; }
    public RoomTemplate Template { get; set; }
    public EnvironmentalCondition[] ActiveConditions { get; set; }
    public TimeOfDay TimeOfDay { get; set; }
    public WeatherCondition Weather { get; set; }
}

public record ThematicModifier(
    string Id,
    string Name,
    string Adjective,
    string DetailFragment,
    string[] ColorPalette,
    string[] AmbientSounds,
    string LoreReference);
```

### Thematic Modifier Registry (all realm §12.1)

| Realm | Modifier | Adjective | Detail Fragment | Color Palette | Lore Ref |
|-------|----------|-----------|-----------------|---------------|----------|
| **Midgard** | Tamed | "tamed" | "carved from catastrophe by stubborn survivors" | green-brown-gray-rust | midgard.md §12.1 |
| **Muspelheim** | Scorched | "scorched" | "radiates intense heat and shows signs of fire damage" | red-orange-black-rust | muspelheim.md §12.1 |
| **Niflheim** | Frozen | "frozen" | "encased in layers of ice, preserved in eternal cold" | white-blue-gray-black | niflheim.md §12.1 |
| **Vanaheim** | Verdant | "verdant" | "pulses with hungry green growth, a garden that forgot how to stop" | emerald-gold-amber-black | vanaheim.md §12.1 |
| **Alfheim** | Glimmering | "glimmering" | "warped by intense Aetheric saturation" | prismatic-white-gold-violet | alfheim.md §12.1 |
| **Asgard** | Shattered | "shattered" | "broken by orbital descent and temporal decay" | gold-black-red-void | asgard.md §12.1 |
| **Svartalfheim** | Forged | "forged" | "precision-crafted by Dvergr engineering" | orange-black-steel-copper | svartalfheim.md §12.1 |
| **Jötunheim** | Titanic | "titanic" | "built to a scale that dwarfs human comprehension" | rust-gray-brown-shadow | jotunheim.md §12.1 |
| **Helheim** | Gangrenous | "gangrenous" | "corroded by industrial waste and biological decay" | green-brown-gray-bile | helheim.md §12.1 |

### Ambient Sound Library (all realm §12)

```json
{
  "ambientSounds": {
    "midgard": {
      "universal": ["wind through ruins", "distant livestock", "wolf howl"],
      "greatwood": ["rustling leaves", "bird calls", "branch creaking"],
      "scar": ["static discharge", "metal stress", "silence punctuated by echoes"],
      "mires": ["bubbling water", "insect buzz", "splash"],
      "fjords": ["wave crash", "seabird cry", "ship creak"]
    },
    "muspelheim": {
      "universal": ["crackling flames", "hissing steam", "metal groaning", "distant rumbling"],
      "slag": ["glass cracking", "heat shimmer hum"],
      "gjollflow": ["molten burble", "sizzling"],
      "ashfall": ["wind howl", "muffled footsteps", "drift shifting"],
      "hearths": ["forge clang", "voices", "water drip"]
    },
    "niflheim": {
      "universal": ["wind howling", "ice cracking", "distant echoes", "silence"],
      "permafrost": ["frost creep", "machinery groan"],
      "hvergelmir": ["thermal drain hum", "deep cold vibration"],
      "archive": ["crystal resonance", "whispered voices", "frozen breath"]
    },
    "vanaheim": {
      "universal": ["rustling leaves", "insect chorus", "dripping water", "creaking"],
      "canopy": ["bird calls", "wind through leaves", "distant falls"],
      "gloom": ["fungal pop", "creature movement", "humid drip"],
      "undergrowth": ["root shift", "spore release", "predator call"]
    },
    "alfheim": {
      "universal": ["crystalline chimes", "static hum", "whispers", "reality tear"],
      "luminous": ["light crackle", "echo distortion"],
      "prismatic": ["color shift hum", "spatial warble"],
      "dreaming": ["distant voices", "memory fragment", "time skip"]
    },
    "asgard": {
      "universal": ["silence", "distant signal", "metal stress", "void echo"],
      "spire": ["debris shift", "structural groan"],
      "heimdallr": ["signal pulse", "antenna hum"],
      "archive": ["data whisper", "power fluctuation", "Odin-tone"]
    },
    "svartalfheim": {
      "universal": ["hammer strikes", "bellows", "machinery", "darkness"],
      "guildlands": ["forge roar", "chain clank", "Dvergr voices"],
      "blackveins": ["dripping", "skittering", "absolute silence"],
      "grottos": ["crystal hum", "blight pulse"]
    },
    "jotunheim": {
      "universal": ["groaning metal", "distant crashes", "wind through giants"],
      "boneyards": ["metal settling", "rust flake"],
      "utgard": ["loom rumble", "titanic footstep echo"],
      "grinding": ["machinery thunder", "chain rattle"]
    },
    "helheim": {
      "universal": ["bubbling", "dripping", "hissing gas", "structural collapse"],
      "labyrinth": ["acid drip", "corroded metal creak"],
      "sump": ["chemical burble", "gas vent"],
      "sunken": ["flooding water", "structure groan"]
    }
  }
}
```

### Temperature Descriptors

| Range (°C) | Descriptor |
|------------|------------|
| < -50 | "killing cold" |
| -50 to -20 | "bitter cold" |
| -20 to 0 | "freezing" |
| 0 to 10 | "cold" |
| 10 to 20 | "cool" |
| 20 to 30 | "warm" |
| 30 to 50 | "hot" |
| 50 to 80 | "sweltering" |
| 80 to 120 | "scorching" |
| > 120 | "lethal heat" |

### Light Level Descriptors

| Range (0-1) | Descriptor |
|-------------|------------|
| 0.0 - 0.1 | "absolute darkness" |
| 0.1 - 0.3 | "deep shadow" |
| 0.3 - 0.5 | "dim light" |
| 0.5 - 0.7 | "moderate light" |
| 0.7 - 0.9 | "bright light" |
| 0.9 - 1.0 | "blinding light" |

### Description Template System

```
{modifier} {room_type} {specific_detail}. {environmental_observation}. {sensory_detail}.
```

**Variables:**
- `{modifier}` — Biome adjective (e.g., "scorched", "frozen", "verdant")
- `{room_type}` — Room template category
- `{specific_detail}` — Zone-specific feature
- `{environmental_observation}` — Condition-based detail
- `{sensory_detail}` — Sound/smell/feeling from ambient library
- `{light}` — Light level descriptor
- `{temperature}` — Temperature descriptor

### v0.19.6c Acceptance Criteria

- [ ] All 9 realms have thematic modifiers defined
- [ ] GetModifierAdjective returns correct adjective for each realm
- [ ] Ambient sounds loaded for all zones
- [ ] Temperature descriptors cover full range
- [ ] Light descriptors cover full range
- [ ] GenerateRoomDescription produces valid output
- [ ] Color palettes available for UI theming
- [ ] ~14 unit tests pass

---

## v0.19.6d: Validation & Integration

### Scope

**In Scope:**
- `IBiomeValidationService` interface and implementation
- `ISectorAssignmentService` interface and implementation
- Configuration validation for all biomes
- Adjacency rule validation
- Full system integration tests
- Performance validation

### Validation Service

```csharp
public interface IBiomeValidationService
{
    ValidationResult ValidateAllBiomes();
    ValidationResult ValidateBiome(RealmId realmId);
    ValidationResult ValidateAdjacencyRules();
    ValidationResult ValidateZoneConfiguration(RealmId realmId);
    ValidationResult ValidateDescriptors();
    ValidationResult ValidateNavigation();
}

public record ValidationResult(
    bool IsValid,
    string[] Errors,
    string[] Warnings);
```

### Sector Assignment Service

```csharp
public interface ISectorAssignmentService
{
    SectorBiomeAssignment AssignBiome(int sectorNumber, int totalSectors);
    RealmId GetPrimaryRealmForSector(int sectorNumber);
    IReadOnlyList<SectorBiomeAssignment> GenerateAssignments(int totalSectors);
}

public record SectorBiomeAssignment(
    int SectorNumber,
    RealmId PrimaryRealm,
    RealmId? SecondaryRealm,
    bool IsTransitionSector,
    float Difficulty);
```

### Standard Dungeon Layout (9 Sectors)

```
Sector 1: Midgard (Entry) — Difficulty 1.0
Sector 2: Transition (Midgard → Secondary) — Difficulty 1.2
Sector 3: Secondary Realm — Difficulty 1.4
Sector 4: Secondary Realm (Deep) — Difficulty 1.6
Sector 5: Transition (Secondary → Tertiary) — Difficulty 1.8
Sector 6: Tertiary Realm — Difficulty 2.0
Sector 7: Tertiary Realm (Deep) — Difficulty 2.2
Sector 8: Transition (Tertiary → Boss) — Difficulty 2.4
Sector 9: Boss Realm — Difficulty 2.5+
```

### Dungeon Type Templates

| Dungeon Type | Sector 1 | Sectors 2-8 | Sector 9 | Notes |
|--------------|----------|-------------|----------|-------|
| Standard | Midgard | Varies | Boss Realm | Default progression |
| Elemental | Muspelheim/Niflheim | Extreme thermal | Extreme | Fire or Ice themed |
| Underdark | Svartalfheim | Dark realms | Helheim | Industrial/decay |
| Skyward | Midgard | Vanaheim/Alfheim | Asgard | Bio/Aether/Space |
| Giant | Jötunheim | Scale realms | Grinding Hall | GiantScale throughout |

### Validation Rules

| Rule | Validation | Severity |
|------|------------|----------|
| Zone count | Each realm has at least 3 zones | Error |
| DC range | All DCs between 8-22 | Warning |
| Temperature | Matches realm theme | Warning |
| Adjacency | No Fire/Ice or Fire/Bio direct transitions | Error |
| Descriptors | All modifiers defined | Error |
| Navigation | All routes have travel times | Warning |
| Choke points | At least 2 per realm | Warning |

### v0.19.6d Acceptance Criteria

- [ ] ValidateAllBiomes passes for correct configuration
- [ ] Validation catches missing zones
- [ ] Validation catches DC errors
- [ ] Validation catches adjacency violations
- [ ] Sector assignment produces valid dungeon layouts
- [ ] All 9 realms integrate correctly
- [ ] Performance: validation < 100ms
- [ ] ~10 unit tests pass

---

## Dependencies & Prerequisites

```
v0.19.5 (Alfheim & Asgard) - REQUIRED
v0.19.4 (Jötunheim & Vanaheim) - REQUIRED
v0.19.3 (Muspelheim & Niflheim) - REQUIRED
v0.19.2 (Svartalfheim & Helheim) - REQUIRED
v0.19.1 (Midgard) - REQUIRED
v0.19.0 (Core Infrastructure) - REQUIRED
    │
    └── All realm configurations loaded
            │
            ▼
v0.19.6a (Transition System)
    │
    ├── ITransitionZoneGenerator
    └── Property interpolation
            │
            ▼
v0.19.6b (Navigation System)
    │
    ├── INavigationService
    ├── Route classification
    └── Choke point registry
            │
            ▼
v0.19.6c (Descriptor System)
    │
    ├── IDescriptorService
    ├── Thematic modifiers
    └── Ambient sound library
            │
            ▼
v0.19.6d (Validation & Integration)
    │
    ├── IBiomeValidationService
    ├── ISectorAssignmentService
    └── Full integration
            │
            ▼
v0.20.x (Player Specializations)
```

---

## Risk Assessment

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Interpolation edge cases | Medium | Medium | Explicit handling for incompatible |
| Navigation data completeness | Medium | Medium | Validate all lore references |
| Descriptor template variety | Low | Medium | Minimum 3 templates per zone |
| Performance at scale | Medium | Low | Cache route calculations |
| Validation false positives | Medium | Medium | Comprehensive test coverage |

---

## Design Decisions (Confirmed)

| Decision | Value | Notes | Lore Ref |
|----------|-------|-------|----------|
| Interpolation method | Linear (50% blend) | Simple and predictable | biomes-overview.md |
| Default transition rooms | 1-3 | Based on adjacency | biomes-overview.md |
| Sector count | 9 (standard) | Matches Nine Realms | — |
| Route caching | Enabled | Calculate once, reuse | — |
| Validation on startup | Optional flag | Performance concern | — |
| Sound library format | JSON array | Easy to extend | — |
| Template variables | 7 standard | Extensible | — |

---

## Unit Testing Requirements (~52 tests)

### v0.19.6a Tests (~14)

**TransitionZoneGenerator Tests (10):**
- GenerateTransition returns valid zone for compatible realms
- GenerateTransition returns null for incompatible realms
- InterpolateProperties calculates correctly (50% blend)
- GenerateTransitionSequence returns correct count
- CanGenerateTransition returns false for Muspelheim-Niflheim
- CanGenerateTransition returns false for Muspelheim-Vanaheim
- Transition zone has blended environmental condition
- Edge case: same realm returns null
- Transition room count respects limits (0-1, 1-3, N/A)
- Transition theme from adjacency matrix applied

**Adjacency Tests (4):**
- GetCompatibility returns Compatible for Midgard-Vanaheim
- GetCompatibility returns RequiresTransition for Midgard-Muspelheim
- GetCompatibility returns Incompatible for Fire/Ice
- GetCompatibility returns Incompatible for Fire/Bio

### v0.19.6b Tests (~14)

**Navigation Tests (8):**
- ClassifyRoute returns correct class for all realm pairs
- Midgard-Vanaheim returns B/C class
- Alfheim-Asgard returns D class (Extreme)
- Muspelheim-Niflheim returns unavailable
- EstimateTravelTime within lore ranges
- GetAllInterRealmRoutes returns all valid routes
- Route symmetry (A→B same as B→A)
- Self-route returns zero time

**Choke Point Tests (6):**
- GetChokePoints returns at least 2 per realm
- All 9 realms have choke points
- Choke point IDs are unique
- Controlled by field populated
- Type field populated
- Midgard has 3 specific choke points

### v0.19.6c Tests (~14)

**Descriptor Tests (8):**
- GetModifierAdjective returns "scorched" for Muspelheim
- GetModifierAdjective returns "frozen" for Niflheim
- GetModifierAdjective returns "verdant" for Vanaheim
- GetThematicModifier returns complete modifier for all realms
- GetColorPalette returns 4+ colors
- GetAmbientSounds returns at least 3 sounds per zone
- GetTemperatureDescriptor covers full range
- GetLightDescriptor covers full range

**Room Description Tests (6):**
- GenerateRoomDescription produces non-empty string
- Description includes modifier adjective
- Description includes zone-specific detail
- Description includes sensory detail
- Context environmental conditions affect output
- Template variables all replaced

### v0.19.6d Tests (~10)

**Validation Tests (6):**
- ValidateAllBiomes passes for good config
- ValidateBiome catches missing zones
- ValidateAdjacencyRules passes for default rules
- ValidateAdjacencyRules fails for Fire/Ice pair
- ValidateZoneConfiguration catches DC errors
- Validation result includes error messages

**Sector Assignment Tests (4):**
- AssignBiome returns Midgard for sector 1
- GenerateAssignments returns correct count
- GetPrimaryRealmForSector handles all 9 sectors
- Boss sector (9) has highest difficulty

---

## Architecture Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       v0.19.6 Biome Integration                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────┐    │
│  │                      Integration Services                          │    │
│  │                                                                     │    │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐   │    │
│  │  │   Transition    │  │   Navigation    │  │   Descriptor    │   │    │
│  │  │    Service      │  │    Service      │  │    Service      │   │    │
│  │  │                 │  │                 │  │                 │   │    │
│  │  │ • Interpolation │  │ • Routes A-D   │  │ • Modifiers     │   │    │
│  │  │ • Compatibility │  │ • Travel time  │  │ • Sounds        │   │    │
│  │  │ • Room count    │  │ • Choke points │  │ • Templates     │   │    │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘   │    │
│  │                                                                     │    │
│  │  ┌─────────────────┐  ┌─────────────────┐                         │    │
│  │  │   Validation    │  │     Sector      │                         │    │
│  │  │    Service      │  │   Assignment    │                         │    │
│  │  │                 │  │    Service      │                         │    │
│  │  │ • Config check  │  │ • Dungeon map  │                         │    │
│  │  │ • Adjacency     │  │ • Difficulty   │                         │    │
│  │  │ • Completeness  │  │ • 9 sectors    │                         │    │
│  │  └─────────────────┘  └─────────────────┘                         │    │
│  └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────┐    │
│  │                        Nine Realms                                  │    │
│  │                                                                     │    │
│  │    Asgard ═══ Alfheim ═══ Vanaheim ═══ Midgard                    │    │
│  │      ║         ║           ║            ║                          │    │
│  │      ║         ║           ║            ║                          │    │
│  │    (D)       (C)         (B)          (A)                          │    │
│  │      ║         ║           ║            ║                          │    │
│  │      ╠═════════╬═══════════╬════════════╣                          │    │
│  │      ║         ║           ║            ║                          │    │
│  │  Jötunheim ═══╝           ║    Svartalfheim                       │    │
│  │      ║                     ║        ║                              │    │
│  │      ║              Niflheim    Helheim                            │    │
│  │      ║                     ║        ║                              │    │
│  │      ╚═════ Muspelheim ═══╩════════╝                              │    │
│  │              (Fire ✗ Ice) (Fire ✗ Bio)                            │    │
│  │                                                                     │    │
│  │   Route Classes: A=Safe, B=Moderate, C=Dangerous, D=Extreme       │    │
│  └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## Deliverable Checklist

### Application Layer

- [ ] `ITransitionZoneGenerator` interface
- [ ] `TransitionZoneGenerator` implementation
- [ ] `INavigationService` interface
- [ ] `NavigationService` implementation
- [ ] `IDescriptorService` interface
- [ ] `DescriptorService` implementation
- [ ] `IBiomeValidationService` interface
- [ ] `BiomeValidationService` implementation
- [ ] `ISectorAssignmentService` interface
- [ ] `SectorAssignmentService` implementation

### DTOs

- [ ] `TransitionZone` record
- [ ] `RouteClassification` record
- [ ] `ThematicModifier` record
- [ ] `ChokePoint` record
- [ ] `InterRealmRoute` record
- [ ] `SectorBiomeAssignment` record
- [ ] `ValidationResult` record
- [ ] `DescriptorContext` class

### Configuration

- [ ] `config/descriptors/biome-modifiers.json`
- [ ] `config/descriptors/ambient-sounds.json`
- [ ] `config/descriptors/temperature-descriptors.json`
- [ ] `config/descriptors/light-descriptors.json`
- [ ] `config/navigation/routes.json`
- [ ] `config/navigation/choke-points.json`
- [ ] `config/transitions/adjacency-matrix.json`

### Tests

- [ ] v0.19.6a: Transition tests (~14)
- [ ] v0.19.6b: Navigation tests (~14)
- [ ] v0.19.6c: Descriptor tests (~14)
- [ ] v0.19.6d: Validation tests (~10)

---

## v0.19.x Completion Summary

With v0.19.6, the complete biome system is implemented:

| Version | Focus | Realms | Tests | Key Features |
|---------|-------|--------|-------|--------------|
| v0.19.0 | Core Infrastructure | — | ~20 | Entities, enums, schema |
| v0.19.1 | Midgard | 1 | ~32 | 4 canonical zones, hazards |
| v0.19.2 | Svartalfheim & Helheim | 2 | ~24 | Darkness, decay mechanics |
| v0.19.3 | Muspelheim & Niflheim | 2 | ~48 | Thermal extremes, Ice-Debt |
| v0.19.4 | Jötunheim & Vanaheim | 2 | ~44 | GiantScale, vertical stratification |
| v0.19.5 | Alfheim & Asgard | 2 | ~24 | Reality flux, CPS exposure |
| v0.19.6 | Integration | — | ~52 | Transitions, navigation, descriptors |
| **Total** | **Complete System** | **9** | **~244** | Full lore compliance |

---

## Lore Cross-Reference Index

| System | Primary Reference | Additional References |
|--------|-------------------|----------------------|
| Transitions | biomes-overview.md | All realm §17 |
| Navigation | All realm §14 | biomes-overview.md |
| Descriptors | All realm §12 | — |
| Routes | All realm §14.1 | — |
| Choke Points | All realm §14.4 | — |
| Thematic Modifiers | All realm §12.1 | — |
| Ambient Sounds | All realm §12 | — |

---

_This scope breakdown completes the v0.19.x biome system with full integration, navigation, transitions, and descriptor mechanics, all cross-referenced to canonical lore sources._
