# v0.16.2b Design Specification: Armor Category System

**Version:** 0.16.2b  
**Phase Name:** Armor Category System  
**Parent Version:** v0.16.2 (Armor Proficiency System)  
**Prerequisites:** v0.16.2a Complete (Armor Proficiency Level Enum)  
**Estimated Tests:** ~2 unit tests

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [ArmorCategory Enum](#4-armorcategory-enum)
5. [ArmorPenalties Value Object](#5-armorpenalties-value-object)
6. [ArmorCategoryDefinition Value Object](#6-armorcategorydefinition-value-object)
7. [IArmorCategoryProvider Interface](#7-iarmorcategoryprovider-interface)
8. [Data Model Changes](#8-data-model-changes)
9. [Configuration File Schemas](#9-configuration-file-schemas)
10. [Logging Specifications](#10-logging-specifications)
11. [Unit Testing Requirements](#11-unit-testing-requirements)
12. [Use Cases](#12-use-cases)
13. [Deliverable Checklist](#13-deliverable-checklist)
14. [Acceptance Criteria](#14-acceptance-criteria)
15. [Dependencies](#15-dependencies)
16. [Future Considerations](#16-future-considerations)

---

## 1. Executive Summary

### 1.1 Purpose

This specification defines the armor category enumeration and associated penalty/metadata structures. Armor categories classify protective equipment by weight class, determining base penalties to agility, stamina cost, movement speed, and stealth capability.

The five armor categories are:

- **Light**: Cloth, padded, leather — No penalties, no stealth disadvantage
- **Medium**: Chain mail, scale mail, brigandine — Moderate penalties, stealth disadvantage
- **Heavy**: Half plate, full plate — Severe penalties, stealth disadvantage
- **Shields**: Bucklers to tower shields — Minor stamina cost, no stealth impact
- **Specialized**: Servitor shell, symbiotic carapace — Requires special training

This phase establishes the category definitions and base penalties that v0.16.2c-f depend upon.

### 1.2 Key Deliverables

| Category          | Items                                                   |
| ----------------- | ------------------------------------------------------- |
| **Enums**         | `ArmorCategory`                                         |
| **Value Objects** | `ArmorPenalties`, `ArmorCategoryDefinition`             |
| **Interfaces**    | `IArmorCategoryProvider`                                |
| **Configuration** | `armor-categories.json`, `armor-categories.schema.json` |
| **Tests**         | ~2 unit tests                                           |

### 1.3 Architectural Significance

This version establishes the **Armor Classification Pattern**:

- **Enum-Based Category Identification**: All armor references an `ArmorCategory` value
- **Penalty Structure**: Each category has distinct agility, stamina, movement, and stealth impacts
- **Weight Tier System**: Categories form a hierarchy (Light < Medium < Heavy) for tier reduction
- **Provider Pattern**: `IArmorCategoryProvider` centralizes category metadata access

---

## 2. Feature Overview

```
v0.16.2b Armor Category System
├── ArmorCategory Enum (5 categories)
│   ├── Light (0) — No penalties
│   ├── Medium (1) — Moderate penalties, stealth disadvantage
│   ├── Heavy (2) — Severe penalties, stealth disadvantage
│   ├── Shields (3) — Minor stamina cost
│   └── Specialized (4) — Requires special training
├── ArmorPenalties Value Object
│   ├── AgilityDicePenalty: int (0, -1, -2)
│   ├── StaminaCostModifier: int (0, +2, +5)
│   ├── MovementPenalty: int (0, -5, -10 ft)
│   └── HasStealthDisadvantage: bool
├── ArmorCategoryDefinition Value Object
│   ├── Category: ArmorCategory
│   ├── DisplayName: string
│   ├── Description: string
│   ├── ExampleArmors: IReadOnlyList<string>
│   ├── Penalties: ArmorPenalties
│   ├── WeightTier: int (0-2)
│   └── RequiresSpecialTraining: bool
└── IArmorCategoryProvider Interface
    ├── GetDefinition(category): ArmorCategoryDefinition
    ├── GetAllDefinitions(): IReadOnlyList<ArmorCategoryDefinition>
    ├── GetPenalties(category): ArmorPenalties
    └── GetWeightTier(category): int
```

### 2.1 Scope Alignment

**In Scope:**

- `ArmorCategory` enum with 5 categories
- `ArmorPenalties` value object with agility/stamina/movement/stealth penalties
- `ArmorCategoryDefinition` value object with full category metadata
- `IArmorCategoryProvider` interface for category data access
- `armor-categories.json` configuration file
- `armor-categories.schema.json` validation schema

**Out of Scope:**

- Archetype restrictions (v0.16.2c)
- Galdr interference (v0.16.2c)
- Non-proficiency penalty doubling (v0.16.2d)
- Proficiency acquisition (v0.16.2e)
- Combat integration (v0.16.2f)

---

## 3. Architecture Diagrams

### 3.1 Armor Category System Overview

```
┌─────────────────────────────────────────────────────────────────────┐
│                 ARMOR CATEGORY SYSTEM OVERVIEW                       │
└─────────────────────────────────────────────────────────────────────┘

    Armor Entity
         │
         │  Has category assignment
         ▼
┌─────────────────────────────────────────────────────────────────────┐
│                       ArmorCategory Enum                             │
├─────────────────────────────────────────────────────────────────────┤
│   Light (0)  │  Medium (1)  │  Heavy (2)  │ Shields (3) │ Spec (4) │
└─────────────────────────────────────────────────────────────────────┘
         │
         │  Get category metadata
         ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    IArmorCategoryProvider                            │
├─────────────────────────────────────────────────────────────────────┤
│  + GetDefinition(category): ArmorCategoryDefinition                 │
│  + GetAllDefinitions(): IReadOnlyList<ArmorCategoryDefinition>      │
│  + GetPenalties(category): ArmorPenalties                           │
│  + GetWeightTier(category): int                                     │
└─────────────────────────────────────────────────────────────────────┘
         │
         │  Returns category data
         ▼
┌─────────────────────────────────────────────────────────────────────┐
│                   ArmorCategoryDefinition                            │
├─────────────────────────────────────────────────────────────────────┤
│  Category: ArmorCategory       (e.g., Heavy)                        │
│  DisplayName: string           (e.g., "Heavy Armor")                │
│  Description: string           (e.g., "Plate mail protection...")  │
│  ExampleArmors: List<string>   (e.g., ["Half Plate", "Full Plate"])│
│  Penalties: ArmorPenalties     (see below)                          │
│  WeightTier: int               (e.g., 2 for Heavy)                  │
│  RequiresSpecialTraining: bool (e.g., false)                        │
└─────────────────────────────────────────────────────────────────────┘
         │
         │  Contains penalty data
         ▼
┌─────────────────────────────────────────────────────────────────────┐
│                       ArmorPenalties                                 │
├─────────────────────────────────────────────────────────────────────┤
│  AgilityDicePenalty: int       (e.g., -2 dice to Agility rolls)    │
│  StaminaCostModifier: int      (e.g., +5 Stamina per action)       │
│  MovementPenalty: int          (e.g., -10 ft movement)             │
│  HasStealthDisadvantage: bool  (e.g., true)                        │
└─────────────────────────────────────────────────────────────────────┘
```

### 3.2 Category Penalty Reference Matrix

```
┌─────────────────────────────────────────────────────────────────────┐
│                    ARMOR PENALTY MATRIX                              │
└─────────────────────────────────────────────────────────────────────┘

Category     │ WeightTier │ Agility │ Stamina │ Movement │ Stealth  │
─────────────┼────────────┼─────────┼─────────┼──────────┼──────────┤
Light        │     0      │    0    │    0    │    0     │   No     │
Medium       │     1      │   -1d10 │   +2    │   -5 ft  │   Yes    │
Heavy        │     2      │   -2d10 │   +5    │  -10 ft  │   Yes    │
Shields      │     -      │    0    │   +1    │    0     │   No     │
Specialized  │   Varies   │  Varies │  Varies │  Varies  │  Varies  │
─────────────┴────────────┴─────────┴─────────┴──────────┴──────────┘

NOTES:
- Agility: Penalty dice removed from Agility-based rolls
- Stamina: Additional Stamina cost per combat action
- Movement: Reduction to base movement speed per round
- Stealth: Whether armor imposes disadvantage on stealth checks
- Shields: Do not use WeightTier system (not affected by tier reduction)
- Specialized: Configured per-item, requires special training
```

### 3.3 Weight Tier Hierarchy (for Tier Reduction)

```
┌─────────────────────────────────────────────────────────────────────┐
│                    WEIGHT TIER HIERARCHY                             │
└─────────────────────────────────────────────────────────────────────┘

    WeightTier 2 (Heavy)
         │
         │  Expert/Master reduces penalties
         ▼
    WeightTier 1 (Medium)
         │
         │  Expert/Master reduces penalties
         ▼
    WeightTier 0 (Light)
         │
         ▼
    No penalties to reduce


TIER REDUCTION EXAMPLES:

┌────────────────────────────────────────────────────────────────────┐
│  Character: Expert proficiency in Heavy Armor                      │
│  Equipped: Full Plate (Heavy, WeightTier = 2)                      │
│                                                                    │
│  Tier Reduction: 1 (from Expert level)                             │
│  Effective Tier: 2 - 1 = 1 (Medium)                                │
│                                                                    │
│  Base Heavy Penalties:   -2d10 Agility, +5 Stamina, -10 ft         │
│  Applied Penalties:      -1d10 Agility, +2 Stamina, -5 ft          │
│  (Uses Medium penalties due to tier reduction)                     │
└────────────────────────────────────────────────────────────────────┘
```

### 3.4 Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────┐
│                        PRESENTATION LAYER                            │
├─────────────────────────────────────────────────────────────────────┤
│  EquipmentView                                                       │
│  └── Shows armor category with penalty summary                      │
│                                                                      │
│  CharacterSheet                                                      │
│  └── Displays current armor penalties                               │
│                                                                      │
│  ArmorTooltip                                                        │
│  └── Shows category details and penalty breakdown                   │
└───────┬─────────────────────────────────────────────────────────────┘
        │
        ▼
┌─────────────────────────────────────────────────────────────────────┐
│                       APPLICATION LAYER                              │
├─────────────────────────────────────────────────────────────────────┤
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │              ArmorCategoryProvider                             │  │
│  │          (implements IArmorCategoryProvider)                   │  │
│  ├───────────────────────────────────────────────────────────────┤  │
│  │  + GetDefinition(category): ArmorCategoryDefinition           │  │
│  │  + GetAllDefinitions(): IReadOnlyList                         │  │
│  │  + GetPenalties(category): ArmorPenalties                     │  │
│  │  + GetWeightTier(category): int                               │  │
│  │  + RequiresSpecialTraining(category): bool                    │  │
│  │                                                               │  │
│  │  - LoadConfiguration(): void (from JSON)                      │  │
│  │  - _definitions: Dictionary<ArmorCategory, Definition>        │  │
│  └───────────────────────────────────────────────────────────────┘  │
└───────┬─────────────────────────────────────────────────────────────┘
        │
        ▼
┌─────────────────────────────────────────────────────────────────────┐
│                         DOMAIN LAYER                                 │
├─────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────┐  ┌────────────────────────────────┐   │
│  │    ArmorCategory        │  │   ArmorCategoryDefinition      │   │
│  │        (Enum)           │  │       (Value Object)           │   │
│  ├─────────────────────────┤  ├────────────────────────────────┤   │
│  │ Light = 0               │  │ Category: ArmorCategory        │   │
│  │ Medium = 1              │  │ DisplayName: string            │   │
│  │ Heavy = 2               │  │ Description: string            │   │
│  │ Shields = 3             │  │ ExampleArmors: List<string>    │   │
│  │ Specialized = 4         │  │ Penalties: ArmorPenalties      │   │
│  └─────────────────────────┘  │ WeightTier: int                │   │
│                               │ RequiresSpecialTraining: bool  │   │
│  ┌─────────────────────────┐  └────────────────────────────────┘   │
│  │    ArmorPenalties       │                                        │
│  │    (Value Object)       │                                        │
│  ├─────────────────────────┤                                        │
│  │ AgilityDicePenalty: int │                                        │
│  │ StaminaCostModifier: int│                                        │
│  │ MovementPenalty: int    │                                        │
│  │ HasStealthDisadvantage  │                                        │
│  └─────────────────────────┘                                        │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 4. ArmorCategory Enum

### 4.1 Purpose

The `ArmorCategory` enum classifies armor into 5 distinct categories for proficiency tracking and penalty determination.

### 4.2 Implementation

**File:** `src/Core/RuneAndRust.Domain/Enums/ArmorCategory.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Classifies armor into categories for proficiency and penalty tracking.
/// </summary>
/// <remarks>
/// <para>
/// Armor categories group protective equipment by weight class, determining
/// base penalties to agility, stamina costs, movement speed, and stealth.
/// </para>
/// <para>
/// Categories Light, Medium, and Heavy form a weight tier hierarchy (0-2)
/// used by the proficiency tier reduction system. Shields and Specialized
/// armor are handled separately.
/// </para>
/// <para>
/// Values are explicitly assigned (0-4) for stable serialization.
/// </para>
/// </remarks>
public enum ArmorCategory
{
    /// <summary>
    /// Light protective gear including cloth, padded, leather, and hide.
    /// </summary>
    /// <remarks>
    /// Light armor has no penalties and does not impose stealth disadvantage.
    /// WeightTier: 0
    /// </remarks>
    Light = 0,

    /// <summary>
    /// Medium protective gear including chain mail, scale mail, and brigandine.
    /// </summary>
    /// <remarks>
    /// Medium armor imposes moderate penalties: -1d10 Agility, +2 Stamina,
    /// -5 ft movement, and stealth disadvantage.
    /// WeightTier: 1
    /// </remarks>
    Medium = 1,

    /// <summary>
    /// Heavy protective gear including half plate and full plate.
    /// </summary>
    /// <remarks>
    /// Heavy armor imposes severe penalties: -2d10 Agility, +5 Stamina,
    /// -10 ft movement, and stealth disadvantage.
    /// WeightTier: 2
    /// </remarks>
    Heavy = 2,

    /// <summary>
    /// Defensive equipment held in hand including bucklers and tower shields.
    /// </summary>
    /// <remarks>
    /// Shields impose minor stamina cost (+1) but no other penalties.
    /// Does not use the weight tier system.
    /// </remarks>
    Shields = 3,

    /// <summary>
    /// Exotic protective equipment requiring special training.
    /// </summary>
    /// <remarks>
    /// Includes Servitor shell, symbiotic carapace, and similar unusual armor.
    /// RequiresSpecialTraining: true. Penalties vary by specific item.
    /// </remarks>
    Specialized = 4
}
```

### 4.3 Category Reference Table

| Enum Value    | Int | Weight Tier | Agility | Stamina | Movement | Stealth | Special Training |
| ------------- | --- | ----------- | ------- | ------- | -------- | ------- | ---------------- |
| `Light`       | 0   | 0           | 0       | 0       | 0        | No      | No               |
| `Medium`      | 1   | 1           | -1d10   | +2      | -5 ft    | Yes     | No               |
| `Heavy`       | 2   | 2           | -2d10   | +5      | -10 ft   | Yes     | No               |
| `Shields`     | 3   | N/A         | 0       | +1      | 0        | No      | No               |
| `Specialized` | 4   | Varies      | Varies  | Varies  | Varies   | Varies  | **Yes**          |

---

## 5. ArmorPenalties Value Object

### 5.1 Purpose

The `ArmorPenalties` value object encapsulates all base penalties for an armor category. These penalties are modified by proficiency level (doubled for NonProficient, reduced tier for Expert/Master).

### 5.2 Implementation

**File:** `src/Core/RuneAndRust.Domain/ValueObjects/ArmorPenalties.cs`

```csharp
namespace RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Contains base penalties for an armor category.
/// </summary>
/// <remarks>
/// <para>
/// ArmorPenalties defines the agility dice reduction, stamina cost increase,
/// movement penalty, and stealth disadvantage for an armor category.
/// </para>
/// <para>
/// These base values are modified by proficiency level:
/// - NonProficient: Penalties doubled
/// - Expert/Master: May use lower tier penalties
/// </para>
/// </remarks>
/// <param name="AgilityDicePenalty">Dice removed from Agility rolls (0, -1, -2).</param>
/// <param name="StaminaCostModifier">Additional Stamina per action (0, +1, +2, +5).</param>
/// <param name="MovementPenalty">Movement speed reduction in feet (0, -5, -10).</param>
/// <param name="HasStealthDisadvantage">Whether stealth checks have disadvantage.</param>
public readonly record struct ArmorPenalties(
    int AgilityDicePenalty,
    int StaminaCostModifier,
    int MovementPenalty,
    bool HasStealthDisadvantage)
{
    /// <summary>
    /// Gets penalties representing no hindrance (Light armor).
    /// </summary>
    public static ArmorPenalties None => new(0, 0, 0, false);

    /// <summary>
    /// Gets whether this has any agility penalty.
    /// </summary>
    public bool HasAgilityPenalty => AgilityDicePenalty < 0;

    /// <summary>
    /// Gets whether this has any stamina cost increase.
    /// </summary>
    public bool HasStaminaCost => StaminaCostModifier > 0;

    /// <summary>
    /// Gets whether this has any movement penalty.
    /// </summary>
    public bool HasMovementPenalty => MovementPenalty < 0;

    /// <summary>
    /// Gets whether this category has any penalties at all.
    /// </summary>
    public bool HasAnyPenalty =>
        HasAgilityPenalty || HasStaminaCost || HasMovementPenalty || HasStealthDisadvantage;

    /// <summary>
    /// Creates ArmorPenalties with validation.
    /// </summary>
    public static ArmorPenalties Create(
        int agilityDicePenalty,
        int staminaCostModifier,
        int movementPenalty,
        bool hasStealthDisadvantage)
    {
        ArgumentOutOfRangeException.ThrowIfGreaterThan(agilityDicePenalty, 0);
        ArgumentOutOfRangeException.ThrowIfLessThan(agilityDicePenalty, -10);
        ArgumentOutOfRangeException.ThrowIfNegative(staminaCostModifier);
        ArgumentOutOfRangeException.ThrowIfGreaterThan(staminaCostModifier, 20);
        ArgumentOutOfRangeException.ThrowIfGreaterThan(movementPenalty, 0);
        ArgumentOutOfRangeException.ThrowIfLessThan(movementPenalty, -30);

        return new ArmorPenalties(
            agilityDicePenalty,
            staminaCostModifier,
            movementPenalty,
            hasStealthDisadvantage);
    }

    /// <summary>
    /// Returns penalties with values multiplied by a factor (for non-proficiency).
    /// </summary>
    /// <param name="multiplier">The multiplier to apply (e.g., 2.0 for doubled).</param>
    /// <returns>New ArmorPenalties with multiplied values.</returns>
    public ArmorPenalties Multiply(decimal multiplier)
    {
        return new ArmorPenalties(
            (int)(AgilityDicePenalty * multiplier),
            (int)(StaminaCostModifier * multiplier),
            (int)(MovementPenalty * multiplier),
            HasStealthDisadvantage);  // Stealth disadvantage is not multiplied
    }

    /// <summary>
    /// Formats agility penalty for display.
    /// </summary>
    public string FormatAgilityPenalty() =>
        AgilityDicePenalty == 0 ? "None" : $"{AgilityDicePenalty}d10";

    /// <summary>
    /// Formats stamina cost for display.
    /// </summary>
    public string FormatStaminaCost() =>
        StaminaCostModifier == 0 ? "None" : $"+{StaminaCostModifier}";

    /// <summary>
    /// Formats movement penalty for display.
    /// </summary>
    public string FormatMovementPenalty() =>
        MovementPenalty == 0 ? "None" : $"{MovementPenalty} ft";

    /// <summary>
    /// Creates a display string for debug/logging.
    /// </summary>
    public override string ToString() =>
        $"Agility: {FormatAgilityPenalty()}, Stamina: {FormatStaminaCost()}, " +
        $"Movement: {FormatMovementPenalty()}, Stealth: {(HasStealthDisadvantage ? "Disadvantage" : "Normal")}";
}
```

---

## 6. ArmorCategoryDefinition Value Object

### 6.1 Purpose

The `ArmorCategoryDefinition` value object contains all metadata for an armor category, including display information, example armors, penalties, and weight tier.

### 6.2 Implementation

**File:** `src/Core/RuneAndRust.Domain/ValueObjects/ArmorCategoryDefinition.cs`

```csharp
namespace RuneAndRust.Domain.ValueObjects;

using RuneAndRust.Domain.Enums;

/// <summary>
/// Contains metadata for an armor category.
/// </summary>
/// <remarks>
/// <para>
/// ArmorCategoryDefinition is loaded from configuration and provides
/// all display and gameplay information for an armor category.
/// </para>
/// </remarks>
/// <param name="Category">The armor category this definition describes.</param>
/// <param name="DisplayName">Human-readable category name.</param>
/// <param name="Description">Flavor text describing the category.</param>
/// <param name="ExampleArmors">List of example armor names.</param>
/// <param name="Penalties">Base penalties for this category.</param>
/// <param name="WeightTier">Tier for penalty reduction (0=Light, 1=Medium, 2=Heavy).</param>
/// <param name="RequiresSpecialTraining">Whether extra training is needed.</param>
public readonly record struct ArmorCategoryDefinition(
    ArmorCategory Category,
    string DisplayName,
    string Description,
    IReadOnlyList<string> ExampleArmors,
    ArmorPenalties Penalties,
    int WeightTier,
    bool RequiresSpecialTraining)
{
    /// <summary>
    /// Gets the category as an integer value.
    /// </summary>
    public int CategoryValue => (int)Category;

    /// <summary>
    /// Gets whether this is light armor (no penalties).
    /// </summary>
    public bool IsLight => Category == ArmorCategory.Light;

    /// <summary>
    /// Gets whether this is medium armor.
    /// </summary>
    public bool IsMedium => Category == ArmorCategory.Medium;

    /// <summary>
    /// Gets whether this is heavy armor.
    /// </summary>
    public bool IsHeavy => Category == ArmorCategory.Heavy;

    /// <summary>
    /// Gets whether this is a shield.
    /// </summary>
    public bool IsShield => Category == ArmorCategory.Shields;

    /// <summary>
    /// Gets whether this category uses the weight tier system.
    /// </summary>
    public bool UsesWeightTierSystem =>
        Category is ArmorCategory.Light or ArmorCategory.Medium or ArmorCategory.Heavy;

    /// <summary>
    /// Gets the penalties for a reduced tier (for Expert/Master proficiency).
    /// </summary>
    /// <param name="tierReduction">Number of tiers to reduce.</param>
    /// <param name="categoryProvider">Provider to get lower tier penalties.</param>
    /// <returns>Penalties from the reduced tier, or current if no reduction possible.</returns>
    public ArmorPenalties GetReducedTierPenalties(
        int tierReduction,
        IArmorCategoryProvider categoryProvider)
    {
        if (!UsesWeightTierSystem || tierReduction <= 0)
            return Penalties;

        var effectiveTier = Math.Max(0, WeightTier - tierReduction);

        return effectiveTier switch
        {
            0 => ArmorPenalties.None,  // Light
            1 => categoryProvider.GetPenalties(ArmorCategory.Medium),
            _ => Penalties  // Still Heavy or higher
        };
    }

    /// <summary>
    /// Creates ArmorCategoryDefinition with validation.
    /// </summary>
    public static ArmorCategoryDefinition Create(
        ArmorCategory category,
        string displayName,
        string description,
        IReadOnlyList<string> exampleArmors,
        ArmorPenalties penalties,
        int weightTier,
        bool requiresSpecialTraining)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(displayName);
        ArgumentException.ThrowIfNullOrWhiteSpace(description);
        ArgumentNullException.ThrowIfNull(exampleArmors);
        ArgumentOutOfRangeException.ThrowIfNegative(weightTier);
        ArgumentOutOfRangeException.ThrowIfGreaterThan(weightTier, 3);

        return new ArmorCategoryDefinition(
            category,
            displayName,
            description,
            exampleArmors,
            penalties,
            weightTier,
            requiresSpecialTraining);
    }

    /// <summary>
    /// Formats example armors as a comma-separated string.
    /// </summary>
    public string FormatExamples() => string.Join(", ", ExampleArmors);

    /// <summary>
    /// Creates a display string for debug/logging.
    /// </summary>
    public override string ToString() =>
        $"{DisplayName} (Tier {WeightTier})" +
        (RequiresSpecialTraining ? " [Special Training]" : "");
}
```

---

## 7. IArmorCategoryProvider Interface

### 7.1 Purpose

The `IArmorCategoryProvider` interface abstracts access to armor category metadata, enabling configuration-driven category definitions.

### 7.2 Implementation

**File:** `src/Core/RuneAndRust.Application/Interfaces/IArmorCategoryProvider.cs`

```csharp
namespace RuneAndRust.Application.Interfaces;

using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Provides access to armor category metadata.
/// </summary>
public interface IArmorCategoryProvider
{
    /// <summary>
    /// Gets the definition for a specific armor category.
    /// </summary>
    ArmorCategoryDefinition GetDefinition(ArmorCategory category);

    /// <summary>
    /// Gets definitions for all armor categories.
    /// </summary>
    IReadOnlyList<ArmorCategoryDefinition> GetAllDefinitions();

    /// <summary>
    /// Gets the base penalties for an armor category.
    /// </summary>
    ArmorPenalties GetPenalties(ArmorCategory category);

    /// <summary>
    /// Gets the weight tier for an armor category (0-2).
    /// </summary>
    /// <returns>Weight tier, or -1 if category doesn't use tier system.</returns>
    int GetWeightTier(ArmorCategory category);

    /// <summary>
    /// Checks if a category requires special training.
    /// </summary>
    bool RequiresSpecialTraining(ArmorCategory category);

    /// <summary>
    /// Gets the display name for a category.
    /// </summary>
    string GetDisplayName(ArmorCategory category);

    /// <summary>
    /// Gets categories that use the weight tier system.
    /// </summary>
    IReadOnlyList<ArmorCategory> GetTieredCategories();

    /// <summary>
    /// Validates that all categories have definitions.
    /// </summary>
    bool ValidateConfiguration();
}
```

### 7.3 Usage Examples

```csharp
// Get definition for Heavy armor
var heavyDef = _categoryProvider.GetDefinition(ArmorCategory.Heavy);
Console.WriteLine($"{heavyDef.DisplayName}: {heavyDef.Penalties}");
// Output: "Heavy Armor: Agility: -2d10, Stamina: +5, Movement: -10 ft, Stealth: Disadvantage"

// Get penalties for Medium armor
var penalties = _categoryProvider.GetPenalties(ArmorCategory.Medium);
Console.WriteLine($"Agility penalty: {penalties.FormatAgilityPenalty()}");
// Output: "Agility penalty: -1d10"

// Check if Light armor has any penalties
var lightPenalties = _categoryProvider.GetPenalties(ArmorCategory.Light);
Console.WriteLine($"Light has penalties: {lightPenalties.HasAnyPenalty}");
// Output: "Light has penalties: False"

// Get weight tier for tier reduction calculation
var heavyTier = _categoryProvider.GetWeightTier(ArmorCategory.Heavy);
Console.WriteLine($"Heavy armor weight tier: {heavyTier}");
// Output: "Heavy armor weight tier: 2"
```

---

## 8. Data Model Changes

### 8.1 New Types Summary

| Type                      | Layer       | Category     | Description                        |
| ------------------------- | ----------- | ------------ | ---------------------------------- |
| `ArmorCategory`           | Domain      | Enum         | 5 armor classifications            |
| `ArmorPenalties`          | Domain      | Value Object | Agility/Stamina/Movement penalties |
| `ArmorCategoryDefinition` | Domain      | Value Object | Complete category metadata         |
| `IArmorCategoryProvider`  | Application | Interface    | Category data access               |

### 8.2 File Locations

```
src/Core/RuneAndRust.Domain/
├── Enums/
│   └── ArmorCategory.cs                  ← NEW
└── ValueObjects/
    ├── ArmorPenalties.cs                 ← NEW
    └── ArmorCategoryDefinition.cs        ← NEW

src/Core/RuneAndRust.Application/
└── Interfaces/
    └── IArmorCategoryProvider.cs         ← NEW

config/
├── armor-categories.json                 ← NEW
└── schemas/
    └── armor-categories.schema.json      ← NEW
```

---

## 9. Configuration File Schemas

### 9.1 armor-categories.json

**File:** `config/armor-categories.json`

```json
{
    "$schema": "./schemas/armor-categories.schema.json",
    "categories": [
        {
            "category": "Light",
            "categoryValue": 0,
            "displayName": "Light Armor",
            "description": "Flexible protective gear that prioritizes mobility. Includes cloth, padded, leather, hide, and studded leather armor.",
            "exampleArmors": [
                "Cloth Armor",
                "Padded Armor",
                "Leather Armor",
                "Hide Armor",
                "Studded Leather"
            ],
            "penalties": {
                "agilityDicePenalty": 0,
                "staminaCostModifier": 0,
                "movementPenalty": 0,
                "hasStealthDisadvantage": false
            },
            "weightTier": 0,
            "requiresSpecialTraining": false
        },
        {
            "category": "Medium",
            "categoryValue": 1,
            "displayName": "Medium Armor",
            "description": "Balanced protection trading some mobility for defense. Includes chain mail, scale mail, ring mail, brigandine, and splint armor.",
            "exampleArmors": [
                "Chain Mail",
                "Scale Mail",
                "Ring Mail",
                "Brigandine",
                "Splint Armor"
            ],
            "penalties": {
                "agilityDicePenalty": -1,
                "staminaCostModifier": 2,
                "movementPenalty": -5,
                "hasStealthDisadvantage": true
            },
            "weightTier": 1,
            "requiresSpecialTraining": false
        },
        {
            "category": "Heavy",
            "categoryValue": 2,
            "displayName": "Heavy Armor",
            "description": "Maximum protection at the cost of mobility. Includes half plate, full plate, and fortress armor.",
            "exampleArmors": ["Half Plate", "Full Plate", "Fortress Armor"],
            "penalties": {
                "agilityDicePenalty": -2,
                "staminaCostModifier": 5,
                "movementPenalty": -10,
                "hasStealthDisadvantage": true
            },
            "weightTier": 2,
            "requiresSpecialTraining": false
        },
        {
            "category": "Shields",
            "categoryValue": 3,
            "displayName": "Shields",
            "description": "Defensive equipment held in hand for blocking attacks. Includes bucklers, round shields, kite shields, and tower shields.",
            "exampleArmors": [
                "Buckler",
                "Round Shield",
                "Kite Shield",
                "Tower Shield"
            ],
            "penalties": {
                "agilityDicePenalty": 0,
                "staminaCostModifier": 1,
                "movementPenalty": 0,
                "hasStealthDisadvantage": false
            },
            "weightTier": -1,
            "requiresSpecialTraining": false
        },
        {
            "category": "Specialized",
            "categoryValue": 4,
            "displayName": "Specialized Armor",
            "description": "Exotic protective equipment requiring special training to use effectively. Includes Servitor shell, symbiotic carapace, and similar unusual armor.",
            "exampleArmors": [
                "Servitor Shell",
                "Symbiotic Carapace",
                "Rune-Bonded Plate"
            ],
            "penalties": {
                "agilityDicePenalty": -1,
                "staminaCostModifier": 3,
                "movementPenalty": -5,
                "hasStealthDisadvantage": false
            },
            "weightTier": 1,
            "requiresSpecialTraining": true
        }
    ]
}
```

### 9.2 armor-categories.schema.json

**File:** `config/schemas/armor-categories.schema.json`

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "armor-categories.schema.json",
    "title": "Armor Categories Configuration",
    "description": "Defines armor category metadata and penalties",
    "type": "object",
    "required": ["categories"],
    "properties": {
        "$schema": { "type": "string" },
        "categories": {
            "type": "array",
            "minItems": 5,
            "maxItems": 5,
            "items": { "$ref": "#/$defs/categoryDefinition" }
        }
    },
    "$defs": {
        "categoryDefinition": {
            "type": "object",
            "required": [
                "category",
                "categoryValue",
                "displayName",
                "description",
                "exampleArmors",
                "penalties",
                "weightTier",
                "requiresSpecialTraining"
            ],
            "properties": {
                "category": {
                    "type": "string",
                    "enum": [
                        "Light",
                        "Medium",
                        "Heavy",
                        "Shields",
                        "Specialized"
                    ]
                },
                "categoryValue": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 4
                },
                "displayName": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 50
                },
                "description": {
                    "type": "string",
                    "minLength": 10,
                    "maxLength": 500
                },
                "exampleArmors": {
                    "type": "array",
                    "minItems": 1,
                    "items": { "type": "string" }
                },
                "penalties": { "$ref": "#/$defs/penalties" },
                "weightTier": {
                    "type": "integer",
                    "minimum": -1,
                    "maximum": 3
                },
                "requiresSpecialTraining": { "type": "boolean" }
            }
        },
        "penalties": {
            "type": "object",
            "required": [
                "agilityDicePenalty",
                "staminaCostModifier",
                "movementPenalty",
                "hasStealthDisadvantage"
            ],
            "properties": {
                "agilityDicePenalty": {
                    "type": "integer",
                    "minimum": -10,
                    "maximum": 0
                },
                "staminaCostModifier": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 20
                },
                "movementPenalty": {
                    "type": "integer",
                    "minimum": -30,
                    "maximum": 0
                },
                "hasStealthDisadvantage": { "type": "boolean" }
            }
        }
    }
}
```

---

## 10. Logging Specifications

### 10.1 Log Levels by Component

| Component               | Level       | Events                                  |
| ----------------------- | ----------- | --------------------------------------- |
| `ArmorCategoryProvider` | Information | Configuration loaded, validation passed |
| `ArmorCategoryProvider` | Debug       | Individual definition retrieved         |
| `ArmorCategoryProvider` | Warning     | Missing definition for category         |
| `ArmorCategoryProvider` | Error       | Configuration validation failed         |

### 10.2 Log Message Templates

```csharp
// Information - Configuration loaded
_logger.LogInformation(
    "Loaded {CategoryCount} armor category definitions from configuration",
    definitions.Count);

// Debug - Definition retrieved
_logger.LogDebug(
    "Retrieved armor category {Category}: WeightTier={Tier}, Penalties={Penalties}",
    category, definition.WeightTier, definition.Penalties);

// Warning - Missing definition
_logger.LogWarning(
    "No armor category definition configured for {Category}, using defaults",
    category);
```

---

## 11. Unit Testing Requirements

### 11.1 Test Count by Feature

| Feature            | Test Count |
| ------------------ | ---------- |
| ArmorCategory Enum | ~1         |
| ArmorPenalties VO  | ~1         |
| **Total**          | **~2**     |

### 11.2 Test Specifications

**File:** `tests/RuneAndRust.Domain.UnitTests/ValueObjects/ArmorPenaltiesTests.cs`

```csharp
[TestFixture]
public class ArmorPenaltiesTests
{
    [Test]
    public void None_ReturnsZeroPenalties()
    {
        // Arrange & Act
        var penalties = ArmorPenalties.None;

        // Assert
        penalties.AgilityDicePenalty.Should().Be(0);
        penalties.StaminaCostModifier.Should().Be(0);
        penalties.MovementPenalty.Should().Be(0);
        penalties.HasStealthDisadvantage.Should().BeFalse();
        penalties.HasAnyPenalty.Should().BeFalse();
    }

    [Test]
    public void Multiply_DoublesNumericalPenalties_NotStealthDisadvantage()
    {
        // Arrange
        var heavyPenalties = ArmorPenalties.Create(-2, 5, -10, true);

        // Act
        var doubled = heavyPenalties.Multiply(2.0m);

        // Assert
        doubled.AgilityDicePenalty.Should().Be(-4);
        doubled.StaminaCostModifier.Should().Be(10);
        doubled.MovementPenalty.Should().Be(-20);
        doubled.HasStealthDisadvantage.Should().BeTrue(); // Not multiplied
    }
}
```

---

## 12. Use Cases

### UC-001: Get Armor Category Penalties

**Actor:** System  
**Flow:** Character equips armor → System retrieves category → System gets penalties → System applies to combat

### UC-002: Calculate Tier-Reduced Penalties

**Actor:** System  
**Flow:** Expert equips Heavy armor → System gets tier reduction → System applies Medium penalties instead

### UC-003: Display Category Information

**Actor:** Player  
**Flow:** Player inspects armor → UI requests category definition → UI displays penalties and examples

---

## 13. Deliverable Checklist

### Domain Layer

- [ ] `ArmorCategory` enum created
- [ ] `ArmorPenalties` value object created
- [ ] `ArmorCategoryDefinition` value object created

### Application Layer

- [ ] `IArmorCategoryProvider` interface created

### Configuration Files

- [ ] `config/armor-categories.json` created
- [ ] `config/schemas/armor-categories.schema.json` created

### Testing

- [ ] ~2 unit tests implemented
- [ ] All tests passing

---

## 14. Acceptance Criteria

### Functional

- [ ] `ArmorCategory` enum has exactly 5 values (0-4)
- [ ] Light armor has no penalties (`ArmorPenalties.None`)
- [ ] Heavy armor has -2d10 Agility, +5 Stamina, -10 ft movement
- [ ] Medium armor has -1d10 Agility, +2 Stamina, -5 ft movement
- [ ] Shields have only +1 Stamina cost
- [ ] Specialized category has `RequiresSpecialTraining = true`
- [ ] Weight tier hierarchy: Light=0, Medium=1, Heavy=2

### Quality

- [ ] Build succeeds with 0 errors/warnings
- [ ] All ~2 tests pass
- [ ] XML documentation complete

---

## 15. Dependencies

### 15.1 Required from v0.16.2a

| Type                     | Usage in this phase          |
| ------------------------ | ---------------------------- |
| `ArmorProficiencyLevel`  | Future integration reference |
| `ArmorProficiencyEffect` | Tier reduction reference     |

### 15.2 Provides to Future Phases

| Type                      | Usage                                 |
| ------------------------- | ------------------------------------- |
| `ArmorCategory`           | v0.16.2c-f: All subsequent phases     |
| `ArmorPenalties`          | v0.16.2d: Penalty calculation service |
| `ArmorCategoryDefinition` | v0.16.2c: Archetype matrix            |
| `IArmorCategoryProvider`  | v0.16.2d-f: Category data access      |

---

## 16. Future Considerations

### 16.1 Deferred to v0.16.2c

- **Archetype Armor Matrix**: Which archetypes are proficient with which categories
- **Galdr Interference**: -2 Galdr in Medium, blocked in Heavy

### 16.2 Deferred to v0.16.2d

- **Penalty Doubling**: NonProficient penalty multiplication
- **Effective Penalty Calculation Service**

### 16.3 Out of Scope

- **Individual Armor Items**: Specific armor definitions (e.g., "Iron Chainmail +2")
- **Armor Durability**: Maintenance and wear systems

---

_Document Version: 1.0_  
_Last Updated: 2026-01-27_  
_Author: Assistant_
