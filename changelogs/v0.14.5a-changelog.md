# v0.14.5a Changelog - Currency Schema

## Summary

Introduced the comprehensive **Currency Schema** (`currency.schema.json`) which validates currency definitions including display formatting, exchange rates, maximum capacity caps, and visual representation. This schema enables full customization of economic currencies without code changes, supporting modding scenarios such as multi-tier fantasy currencies (gold/silver/copper), sci-fi credit systems, faction tokens, or barter economies. The schema validates the existing 1 currency definition (gold). This is the first schema in the v0.14.5 Economy Configuration Schemas series.

## Added

### Schema File
- **[config/schemas/currency.schema.json](file:///Volumes/GitHub/github/southpawriter02/rune-rust/config/schemas/currency.schema.json)** - Comprehensive JSON Schema Draft-07

### Schema Definitions (2 Total)

| Definition | Description | Required Fields |
|------------|-------------|-----------------|
| `CurrencyDefinition` | Core currency with display and exchange properties | id, name, symbol, color |
| `ExchangeRate` | Currency conversion configuration | targetCurrencyId, rate |

### CurrencyDefinition Properties
| Property | Type | Constraint | Description |
|----------|------|------------|-------------|
| `id` | string | kebab-case pattern | Unique identifier |
| `name` | string | minLength: 1 | Display name (singular) |
| `pluralName` | string | (optional) | Plural form |
| `symbol` | string | 1-3 characters | Display symbol (G, $, ğŸ’) |
| `symbolPosition` | enum | Before/After | Symbol placement |
| `color` | string | minLength: 1 | UI display color |
| `decimalPlaces` | integer | 0-4, default: 0 | Display precision |
| `maxAmount` | integer | >= 1 (optional) | Capacity cap |
| `exchangeRates` | array | (optional) | Conversion rates |
| `isTradeOnly` | boolean | default: false | Loot restriction |
| `description` | string | (optional) | Flavor text |
| `sortOrder` | integer | >= 0, default: 0 | Display order |

### ExchangeRate Properties
| Property | Type | Constraint | Description |
|----------|------|------------|-------------|
| `targetCurrencyId` | string | kebab-case pattern | Target currency |
| `rate` | number | >= 0.001 | Conversion ratio |
| `bidirectional` | boolean | default: true | Two-way exchange |

### Symbol Position Enumeration (2 values)
| Position | Display | Example |
|----------|---------|---------|
| `Before` | Symbol precedes amount | G100, $50.00, ğŸ’25 |
| `After` | Symbol follows amount | 100G, 50â‚¬, 25ğŸ’ |

### Unit Tests
- **[CurrencySchemaTests.cs](file:///Volumes/GitHub/github/southpawriter02/rune-rust/tests/RuneAndRust.Infrastructure.IntegrationTests/Schemas/CurrencySchemaTests.cs)** - 9 tests
  - `Schema_IsValidJsonSchemaDraft07` - Schema structure validation (2 definitions)
  - `CurrencyJson_ValidatesAgainstSchema` - Backwards compatibility (1 currency)
  - `SymbolPosition_InvalidEnum_FailsValidation` - Position enum (2 values)
  - `DecimalPlaces_OutOfRange_FailsValidation` - Decimal places 0-4 range
  - `ExchangeRate_BelowMinimum_FailsValidation` - Rate >= 0.001 validation
  - `MaxAmount_LessThanOne_FailsValidation` - MaxAmount >= 1 validation
  - `CurrencyId_InvalidPattern_FailsValidation` - Kebab-case pattern
  - `Symbol_TooLong_FailsValidation` - Symbol 1-3 chars
  - `RequiredFields_Missing_FailsValidation` - Required fields check

## Changed

### Configuration Files
- **[config/currency.json](file:///Volumes/GitHub/github/southpawriter02/rune-rust/config/currency.json)** - Added `$schema` reference

## Files Changed

| File | Change Type |
|------|-------------|
| `config/schemas/currency.schema.json` | Added |
| `config/currency.json` | Modified ($schema added) |
| `tests/.../Schemas/CurrencySchemaTests.cs` | Added |
| `changelogs/v0.14.5a-changelog.md` | Added |

## Test Results

```
Test summary: total: 9, failed: 0, succeeded: 9, skipped: 0
Build succeeded with 0 errors
```

## Backward Compatibility

The schema validates the existing gold currency without modification:
- `gold` - Standard currency used throughout the realm

## Example Enhanced Currency Configuration

```json
{
    "$schema": "./schemas/currency.schema.json",
    "currencies": [
        {
            "id": "gold",
            "name": "Gold",
            "pluralName": "Gold",
            "symbol": "G",
            "symbolPosition": "Before",
            "color": "yellow",
            "decimalPlaces": 0,
            "exchangeRates": [
                { "targetCurrencyId": "silver", "rate": 10, "bidirectional": true },
                { "targetCurrencyId": "copper", "rate": 100, "bidirectional": true }
            ],
            "description": "The standard currency used throughout the realm",
            "sortOrder": 0
        },
        {
            "id": "silver",
            "name": "Silver",
            "pluralName": "Silver",
            "symbol": "S",
            "symbolPosition": "Before",
            "color": "silver",
            "decimalPlaces": 0,
            "sortOrder": 1
        },
        {
            "id": "gems",
            "name": "Gem",
            "pluralName": "Gems",
            "symbol": "ğŸ’",
            "symbolPosition": "After",
            "color": "cyan",
            "maxAmount": 999,
            "isTradeOnly": true,
            "description": "Rare premium currency",
            "sortOrder": 10
        }
    ]
}
```

## Display System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SYMBOL POSITION OPTIONS                                          â”‚
â”‚                                                                   â”‚
â”‚  symbolPosition: "Before"      symbolPosition: "After"            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚
â”‚                                                                   â”‚
â”‚  G100   (Gold: symbol before)  100G   (Gold: symbol after)        â”‚
â”‚  $50.00 (Credits: before)      50CR   (Credits: after)            â”‚
â”‚  ğŸ’10   (Gems: emoji before)   10ğŸ’   (Gems: emoji after)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Exchange Rate System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MULTI-TIER CURRENCY EXAMPLE                                      â”‚
â”‚                                                                   â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                    â”‚  Gold  â”‚                                     â”‚
â”‚                    â”‚   G    â”‚                                     â”‚
â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                                     â”‚
â”‚                         â”‚ 1:10                                    â”‚
â”‚                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”                                     â”‚
â”‚                    â”‚ Silver â”‚                                     â”‚
â”‚                    â”‚   S    â”‚                                     â”‚
â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                                     â”‚
â”‚                         â”‚ 1:10                                    â”‚
â”‚                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”                                     â”‚
â”‚                    â”‚ Copper â”‚                                     â”‚
â”‚                    â”‚   C    â”‚                                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                                   â”‚
â”‚  1 Gold = 10 Silver = 100 Copper                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Modding Scenarios Enabled

After this implementation, modders can:
- Define new currencies with custom symbols and colors
- Configure symbol position (before/after amounts)
- Set decimal precision for fractional currencies
- Create exchange rate systems for currency conversion
- Set maximum capacity caps for scarce currencies
- Mark currencies as trade-only (no loot drops)
- Support multi-tier economy systems

---

*First entry in v0.14.5 Economy Configuration Schemas series. See also: v0.14.5b (Resources Schema), v0.14.5c (Recipes Schema), v0.14.5d (Vendors Schema).*
