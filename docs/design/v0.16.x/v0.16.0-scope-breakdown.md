# v0.16.0 Quality Tier System - Scope Breakdown

**Version:** 0.16.0  
**Theme:** Quality Tier System  
**Prerequisites:** v0.15.x Complete (Advanced Skill Systems)  
**Total Estimated Tests:** ~15 new tests

---

## Executive Summary

This version establishes the foundational quality tier system that all equipment uses. Items are classified into five tiers from Jury-Rigged (trash) to Myth-Forged (legendary), with each tier providing progressively better stats. Drop tables determine which tiers enemies can drop based on their classification.

The work is divided into **4 sub-phases**:

| Phase    | Name                     | Focus                                                    | Est. Tests |
| -------- | ------------------------ | -------------------------------------------------------- | ---------- |
| v0.16.0a | Quality Tier Enum        | QualityTier enum, TierMetadata VO                        | ~3         |
| v0.16.0b | Stat Scaling System      | Weapon/Armor tier scaling, ITierScalingService           | ~3         |
| v0.16.0c | Drop Probability Tables  | EnemyDropClass, DropProbabilityEntry, IDropTableProvider | ~4         |
| v0.16.0d | Loot Service Integration | Enhanced ILootService, LootDrop updates                  | ~5         |

---

## Feature Analysis & Categorization

### From loot-generation.md - Quality Tiers

| Feature                    | Complexity | Dependencies | Assigned Phase |
| -------------------------- | ---------- | ------------ | -------------- |
| QualityTier enum (5 tiers) | Low        | None         | **v0.16.0a**   |
| TierMetadata VO            | Low        | QualityTier  | **v0.16.0a**   |
| quality-tiers.json config  | Low        | TierMetadata | **v0.16.0a**   |

### From loot-generation.md - Stat Scaling

| Feature                  | Complexity | Dependencies        | Assigned Phase |
| ------------------------ | ---------- | ------------------- | -------------- |
| WeaponTierScaling VO     | Medium     | QualityTier         | **v0.16.0b**   |
| ArmorTierScaling VO      | Medium     | QualityTier         | **v0.16.0b**   |
| ITierScalingService      | Medium     | Both VOs            | **v0.16.0b**   |
| Attribute bonus rolling  | Low        | ITierScalingService | **v0.16.0b**   |
| tier-scaling.json config | Low        | Scaling VOs         | **v0.16.0b**   |

### From loot-generation.md - Drop Tables

| Feature                 | Complexity | Dependencies                | Assigned Phase |
| ----------------------- | ---------- | --------------------------- | -------------- |
| EnemyDropClass enum     | Low        | None                        | **v0.16.0c**   |
| DropProbabilityEntry VO | Medium     | QualityTier, EnemyDropClass | **v0.16.0c**   |
| IDropTableProvider      | Medium     | DropProbabilityEntry        | **v0.16.0c**   |
| drop-tables.json config | Low        | DropProbabilityEntry        | **v0.16.0c**   |

### From loot-generation.md - Integration

| Feature                      | Complexity | Dependencies   | Assigned Phase |
| ---------------------------- | ---------- | -------------- | -------------- |
| Enhanced ILootService        | Medium     | All v0.16.0a-c | **v0.16.0d**   |
| LootDrop enhancement         | Low        | QualityTier    | **v0.16.0d**   |
| DroppedItem enhancement      | Low        | QualityTier    | **v0.16.0d**   |
| Monster to DropClass mapping | Low        | EnemyDropClass | **v0.16.0d**   |

---

## Phase Definitions

---

## v0.16.0a: Quality Tier Enum

[v0.16.0a Design Specification](v0.16.0a-design-specification.md)

### Overview

Defines the foundational QualityTier enum and TierMetadata value object, establishing the five-tier quality system with color coding and rarity labels.

### Scope

**In Scope:**

- QualityTier enum with 5 values (JuryRigged, Scavenged, ClanForged, Optimized, MythForged)
- TierMetadata value object (tier, display name, color hex, color name, rarity)
- quality-tiers.json configuration file
- Color constants for UI integration

**Out of Scope:**

- Stat scaling (v0.16.0b)
- Drop probabilities (v0.16.0c)
- Loot service changes (v0.16.0d)

### Key Deliverables

| Type                 | Count | Details              |
| -------------------- | ----- | -------------------- |
| Domain Enums         | 1     | `QualityTier`        |
| Domain Value Objects | 1     | `TierMetadata`       |
| Configuration        | 1     | `quality-tiers.json` |
| Unit Tests           | ~3    |                      |

### Data Model Changes

```
NEW: QualityTier (Enum)
├── JuryRigged = 0
├── Scavenged = 1
├── ClanForged = 2
├── Optimized = 3
└── MythForged = 4

NEW: TierMetadata (Value Object)
├── Tier: QualityTier
├── DisplayName: string
├── ColorHex: string
├── ColorName: string
└── DropRarity: string
```

### Quality Tier Definitions

| Tier       | Value | Color  | Hex     | Rarity    |
| ---------- | ----- | ------ | ------- | --------- |
| JuryRigged | 0     | Gray   | #808080 | Common    |
| Scavenged  | 1     | White  | #FFFFFF | Common    |
| ClanForged | 2     | Green  | #00FF00 | Uncommon  |
| Optimized  | 3     | Purple | #800080 | Rare      |
| MythForged | 4     | Gold   | #FFD700 | Legendary |

### Acceptance Criteria

- [ ] QualityTier enum has exactly 5 values
- [ ] TierMetadata maps correctly from configuration
- [ ] Color hex values are valid 6-digit hex codes
- [ ] ~3 unit tests pass

---

## v0.16.0b: Stat Scaling System

[v0.16.0b Design Specification](v0.16.0b-design-specification.md)

### Overview

Implements tier-based stat scaling for weapons and armor, including attribute bonus rolling for higher-tier items.

### Scope

**In Scope:**

- WeaponTierScaling value object
- ArmorTierScaling value object
- ITierScalingService interface
- Attribute bonus rolling logic (1d2 for Tier 3, 1d3 for Tier 4)
- tier-scaling.json configuration file

**Out of Scope:**

- Drop probability tables (v0.16.0c)
- Loot service integration (v0.16.0d)

### Key Deliverables

| Type                   | Count | Details                                 |
| ---------------------- | ----- | --------------------------------------- |
| Domain Value Objects   | 2     | `WeaponTierScaling`, `ArmorTierScaling` |
| Application Interfaces | 1     | `ITierScalingService`                   |
| Configuration          | 1     | `tier-scaling.json`                     |
| Unit Tests             | ~3    |                                         |

### Data Model Changes

```
NEW: WeaponTierScaling (Value Object)
├── Tier: QualityTier
├── DamageDice: string
├── AccuracyModifier: int
├── AttributeBonus: int?
└── BonusAttribute: string?

NEW: ArmorTierScaling (Value Object)
├── Tier: QualityTier
├── HpBonus: int
├── DefenseBonus: int
├── AttributeBonus: int?
├── BonusAttribute: string?
└── PenaltyReduction: int
```

### Stat Scaling Tables

**Weapon Scaling:**
| Tier | Damage | Accuracy | Attr Bonus |
|------|--------|----------|------------|
| 0 | 1d6 | -1 | None |
| 1 | 1d6+1 | 0 | None |
| 2 | 1d6+3 | 0 | +1 |
| 3 | 2d6 | +1 | +1 to +2 |
| 4 | 2d6+4 | +2 | +2 to +4 |

**Armor Scaling:**
| Tier | HP | Defense | Attr Bonus |
|------|-----|---------|------------|
| 0 | +5 | +1 | None |
| 1 | +10 | +1 | None |
| 2 | +15 | +2 | +1 |
| 3 | +20 | +2 | +1 to +2 |
| 4 | +30 | +3 | +2 to +4 |

### Acceptance Criteria

- [ ] Weapon scaling matches tier correctly
- [ ] Armor scaling matches tier correctly
- [ ] Attribute bonus rolling within expected range
- [ ] ~3 unit tests pass

---

## v0.16.0c: Drop Probability Tables

[v0.16.0c Design Specification](v0.16.0c-design-specification.md)

### Overview

Implements enemy-class-based drop probability tables that determine item quality tier drops.

### Scope

**In Scope:**

- EnemyDropClass enum (Trash, Standard, Elite, MiniBoss, Boss)
- DropProbabilityEntry value object
- IDropTableProvider interface
- Drop roll logic (weighted probability selection)
- drop-tables.json configuration file

**Out of Scope:**

- Loot service changes (v0.16.0d)
- Smart loot filtering (v0.16.3)
- Container loot (v0.16.4)

### Key Deliverables

| Type                   | Count | Details                |
| ---------------------- | ----- | ---------------------- |
| Domain Enums           | 1     | `EnemyDropClass`       |
| Domain Value Objects   | 1     | `DropProbabilityEntry` |
| Application Interfaces | 1     | `IDropTableProvider`   |
| Configuration          | 1     | `drop-tables.json`     |
| Unit Tests             | ~4    |                        |

### Data Model Changes

```
NEW: EnemyDropClass (Enum)
├── Trash (Servitor)
├── Standard (Drone)
├── Elite (Warden)
├── MiniBoss
└── Boss

NEW: DropProbabilityEntry (Value Object)
├── EnemyClass: EnemyDropClass
├── TierProbabilities: Dictionary<QualityTier, float>
└── NoDropChance: float
```

### Probability Matrix

| Enemy Class | T0  | T1  | T2  | T3  | T4  | None |
| ----------- | --- | --- | --- | --- | --- | ---- |
| Trash       | 60% | 30% | 0%  | 0%  | 0%  | 10%  |
| Standard    | 0%  | 40% | 40% | 20% | 0%  | 0%   |
| Elite       | 0%  | 0%  | 40% | 50% | 10% | 0%   |
| MiniBoss    | 0%  | 0%  | 20% | 50% | 30% | 0%   |
| Boss        | 0%  | 0%  | 0%  | 30% | 70% | 0%   |

### Acceptance Criteria

- [ ] Trash enemies never drop Tier 2+
- [ ] Boss enemies always drop something (0% no-drop)
- [ ] Boss enemies have 70% Myth-Forged chance
- [ ] Probability roll distributes correctly over many runs
- [ ] ~4 unit tests pass

---

## v0.16.0d: Loot Service Integration

[v0.16.0d Design Specification](v0.16.0d-design-specification.md)

### Overview

Integrates the quality tier system into the existing loot service, enhancing loot generation with tier-based mechanics.

### Scope

**In Scope:**

- Enhanced ILootService interface
- LootDrop enhancement (QualityTier tracking)
- DroppedItem enhancement (tier, attribute bonus)
- Monster to EnemyDropClass mapping

**Out of Scope:**

- Smart loot (v0.16.3)
- Container loot (v0.16.4)
- Unique items (v0.16.5)

### Key Deliverables

| Type                   | Count | Details                          |
| ---------------------- | ----- | -------------------------------- |
| Application Interfaces | 1     | Update `ILootService`            |
| Domain Value Objects   | 2     | Update `LootDrop`, `DroppedItem` |
| Unit Tests             | ~5    |                                  |

### Data Model Changes

```
MODIFY: LootDrop
├── ADD: QualityTier: QualityTier?
└── ADD: HasMythForged: bool

MODIFY: DroppedItem
├── ADD: QualityTier: QualityTier
├── ADD: AttributeBonus: int?
└── ADD: BonusAttribute: string?
```

### Acceptance Criteria

- [ ] GenerateLoot uses quality tier system
- [ ] Monster type maps to correct drop class
- [ ] Generated items have tier-appropriate stats
- [ ] LootDrop tracks highest tier correctly
- [ ] HasMythForged flag set when applicable
- [ ] ~5 unit tests pass

---

## Dependencies & Prerequisites

```
v0.15.x (Advanced Skill Systems) - REQUIRED
    │
    └── Complete
            │
            ▼
v0.16.0 (Quality Tier System)
    │
    ├── v0.16.0a: Quality Tier Enum ────────────────┐
    │       Dependencies: None                       │
    │                                                │
    ├── v0.16.0b: Stat Scaling System ──────────────┤
    │       Dependencies: v0.16.0a                   │
    │                                                │
    ├── v0.16.0c: Drop Probability Tables ──────────┤
    │       Dependencies: v0.16.0a                   │
    │                                                │
    └── v0.16.0d: Loot Service Integration ─────────┘
            Dependencies: v0.16.0a, v0.16.0b, v0.16.0c
```

---

## Configuration Files

| File                 | Purpose                                 | Phase    |
| -------------------- | --------------------------------------- | -------- |
| `quality-tiers.json` | Tier definitions, colors, rarity labels | v0.16.0a |
| `tier-scaling.json`  | Weapon and armor stat scaling by tier   | v0.16.0b |
| `drop-tables.json`   | Enemy class probability matrices        | v0.16.0c |

---

## Estimated Effort Summary

| Phase     | New Files | Modified Files | Est. Tests | Complexity |
| --------- | --------- | -------------- | ---------- | ---------- |
| v0.16.0a  | ~3        | 0              | ~3         | Low        |
| v0.16.0b  | ~3        | 0              | ~3         | Medium     |
| v0.16.0c  | ~3        | 0              | ~4         | Medium     |
| v0.16.0d  | ~1        | ~2             | ~5         | Medium     |
| **Total** | **~10**   | **~2**         | **~15**    |            |

---

## Risk Assessment

| Risk                                 | Impact | Probability | Mitigation                             |
| ------------------------------------ | ------ | ----------- | -------------------------------------- |
| Attribute bonus rolling imbalance    | Medium | Low         | Extensive testing of roll distribution |
| Probability tables don't sum to 100% | High   | Low         | Validation in config loader            |
| Tier scaling too weak/strong         | Medium | Medium      | Balance testing post-implementation    |

---

## Design Decisions (Confirmed)

### Quality Tier Values

| Decision             | Value          | Notes                               |
| -------------------- | -------------- | ----------------------------------- |
| **Tier Count**       | 5              | Matches common RPG rarity systems   |
| **Tier 0 Name**      | Jury-Rigged    | Thematic to scavenger setting       |
| **MythForged Color** | Gold (#FFD700) | High visibility for legendary items |

### Stat Scaling

| Decision                | Value    | Notes                       |
| ----------------------- | -------- | --------------------------- |
| **Tier 3-4 Damage**     | 2d6 base | ~50% increase over 1d6 base |
| **Max Attribute Bonus** | +4       | Tier 4 only, rolled 1d3+1   |

---

## Next Steps

1. **Review & Approve** - Confirm scope breakdown
2. **v0.16.0a Design Spec** - Create detailed design specification
3. **Implement v0.16.0a** - Build QualityTier enum and TierMetadata
4. **Repeat for v0.16.0b, v0.16.0c, v0.16.0d**
5. **Proceed to v0.16.1** - Weapon Proficiency System

---

_This scope breakdown provides a structured approach to implementing v0.16.0 Quality Tier System. Each sub-phase builds on the previous, allowing for incremental development and testing._
