# v0.14.0 Character Configuration Schemas - Scope Breakdown

**Version:** 0.14.0
**Theme:** Character Configuration Schemas
**Prerequisites:** v0.13.5 Complete (UI Standardization)
**Total Estimated Tests:** ~24 new tests

---

## Executive Summary

The Character Configuration Schemas version creates comprehensive JSON schemas for all character-related configuration files, enabling full customization of races, classes, backgrounds, skills, archetypes, and progression without code changes. This establishes the foundation for data-driven character creation and supports modding scenarios like sci-fi settings, historical campaigns, or custom fantasy worlds.

The work is divided into **five sub-parts**:

| Part | Name | Focus | Est. Tests |
|------|------|-------|------------|
| v0.14.0a | Race Schema | races.schema.json with attribute modifiers, traits, lore | ~5 |
| v0.14.0b | Class Schema | classes.schema.json with growth rates, resources, abilities | ~5 |
| v0.14.0c | Background Schema | backgrounds.schema.json with bonuses, items, abilities | ~5 |
| v0.14.0d | Skill & Archetype Schemas | skills.schema.json, archetypes.schema.json | ~5 |
| v0.14.0e | Progression Schema | progression.schema.json with XP curves, level rewards | ~4 |

---

## Feature Analysis & Categorization

### From v0.14.x-overview.md - Character Configuration Schemas

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| races.schema.json | Medium | None | **v0.14.0a** |
| Race attribute modifiers | Low | races.schema.json | **v0.14.0a** |
| Race traits | Low | races.schema.json | **v0.14.0a** |
| Race lore fields | Low | races.schema.json | **v0.14.0a** |
| Starting equipment references | Low | races.schema.json | **v0.14.0a** |
| classes.schema.json | Medium | archetypes.schema.json | **v0.14.0b** |
| Class resource types | Low | classes.schema.json | **v0.14.0b** |
| Growth rate definitions | Medium | classes.schema.json | **v0.14.0b** |
| Class ability references | Low | classes.schema.json | **v0.14.0b** |
| Archetype associations | Low | archetypes.schema.json | **v0.14.0b** |
| backgrounds.schema.json | Medium | None | **v0.14.0c** |
| Skill proficiency grants | Low | skills.schema.json | **v0.14.0c** |
| Starting gold ranges | Low | backgrounds.schema.json | **v0.14.0c** |
| Background traits | Low | backgrounds.schema.json | **v0.14.0c** |
| skills.schema.json | Medium | attributes reference | **v0.14.0d** |
| Skill attribute links | Low | skills.schema.json | **v0.14.0d** |
| Skill categories | Low | skills.schema.json | **v0.14.0d** |
| archetypes.schema.json | Low | None | **v0.14.0d** |
| progression.schema.json | Medium | None | **v0.14.0e** |
| XP thresholds | Low | progression.schema.json | **v0.14.0e** |
| Ability point grants | Low | progression.schema.json | **v0.14.0e** |
| Attribute increases | Low | progression.schema.json | **v0.14.0e** |

---

## Existing Infrastructure

### Current Configuration Files

| File | Current State | Schema Exists |
|------|---------------|---------------|
| `config/races.json` | 4 races (human, elf, dwarf, halfling) | Partial ($schema reference exists) |
| `config/classes.json` | 5 classes (shieldmaiden, shadow-walker, etc.) | No |
| `config/backgrounds.json` | 8 backgrounds (4 professions, 4 lineages) | Partial ($schema reference exists) |
| `config/skills.json` | 10 skills across 4 categories | Partial ($schema reference exists) |
| `config/archetypes.json` | 4 archetypes (warrior, skirmisher, adept, mystic) | No |
| `config/progression.json` | 20-level progression with milestones | No |

### Existing Schema Patterns (Reference)

| Schema File | Pattern Used |
|-------------|--------------|
| `config/schemas/terrain.schema.json` | Draft-07, definitions section, enum validation |
| `config/abilities.schema.json` | Draft-07, pattern validation, nested definitions |

### Key Schema Conventions

- JSON Schema Draft-07 format
- ID pattern: `^[a-z][a-z0-9-]*$` (lowercase kebab-case)
- Definitions section for reusable types
- Required fields explicitly listed
- Descriptions on all properties
- Enum validation for categorical values

---

## Phase Definitions

---

## v0.14.0a: Race Schema

[v0.14.0a Design Specification](v0.14.0a-design-specification.md)

### Overview

Create a comprehensive JSON schema for race definitions that validates attribute modifiers, racial traits, lore fields, and starting equipment references.

### Scope

**In Scope:**
- `races.schema.json` - Full schema for race definitions
- Attribute modifier validation (range -3 to +3)
- Trait definition format (id, name, description)
- Lore field structure (description, history)
- Starting equipment item ID references
- Playability flag and sort order
- Schema validation unit tests

**Out of Scope:**
- Class schema (v0.14.0b)
- Background schema (v0.14.0c)
- Cross-reference validation to items (v0.14.2)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `races.schema.json` |
| Schema Definitions | 2 | `RaceDefinition`, `AttributeModifiers` |
| Configuration Updates | 1 | Update `races.json` to reference new schema |
| Unit Tests | ~5 | Schema validation tests |

### Schema Structure

```
races.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Race Configuration"
|-- description: "Schema for playable race definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string (semver pattern)
|   +-- races: array of RaceDefinition
|-- required: ["races"]
+-- definitions:
    |-- RaceDefinition
    |   |-- id: string (kebab-case pattern)
    |   |-- name: string (minLength: 1)
    |   |-- description: string
    |   |-- lore: string (optional)
    |   |-- attributeModifiers: AttributeModifiers
    |   |-- traitId: string (kebab-case)
    |   |-- traitName: string
    |   |-- traitDescription: string
    |   |-- startingItems: array of string (optional)
    |   |-- isPlayable: boolean (default: true)
    |   +-- sortOrder: integer (minimum: 0)
    +-- AttributeModifiers
        |-- might: integer (-3 to +3)
        |-- fortitude: integer (-3 to +3)
        |-- will: integer (-3 to +3)
        |-- wits: integer (-3 to +3)
        +-- finesse: integer (-3 to +3)
```

### User-Facing Changes

**VS Code Autocomplete:**
When editing `races.json`, users will receive:
- Property name suggestions
- Value type hints
- Validation errors for invalid values
- Description tooltips on hover

**Validation Error Examples:**
```
Error: races[0].attributeModifiers.might must be >= -3
Error: races[1].id must match pattern "^[a-z][a-z0-9-]*$"
Error: races[2] missing required property "name"
```

### Acceptance Criteria

- [x] `races.schema.json` created in `config/schemas/`
- [x] Schema validates existing `races.json` without errors
- [x] Attribute modifier range validated (-3 to +3)
- [x] ID pattern enforced (lowercase kebab-case)
- [x] Required fields enforced (id, name, description, attributeModifiers, traitId, traitName, traitDescription)
- [x] Optional fields allow null/missing (lore, startingItems)
- [x] VS Code provides autocomplete when schema linked
- [x] ~5 unit tests pass

---

## v0.14.0b: Class Schema

[v0.14.0b Design Specification](v0.14.0b-design-specification.md)

### Overview

Create a comprehensive JSON schema for class definitions that validates stat modifiers, growth rates, resource type references, starting abilities, and archetype associations.

### Scope

**In Scope:**
- `classes.schema.json` - Full schema for class definitions
- Stat modifier validation (all stats)
- Growth rate definitions per level
- Primary resource type reference (mana, rage, energy, focus, faith)
- Starting ability ID references
- Archetype ID reference validation
- Class requirements (optional unlock conditions)

**Out of Scope:**
- Background schema (v0.14.0c)
- Ability cross-reference validation (v0.14.1)
- Archetype schema (v0.14.0d - created first as dependency)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `classes.schema.json` |
| Schema Definitions | 3 | `ClassDefinition`, `StatModifiers`, `GrowthRates` |
| Configuration Updates | 1 | Update `classes.json` to reference schema |
| Unit Tests | ~5 | Schema validation tests |

### Schema Structure

```
classes.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Class Configuration"
|-- description: "Schema for character class definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string (optional)
|   +-- classes: array of ClassDefinition
|-- required: ["classes"]
+-- definitions:
    |-- ClassDefinition
    |   |-- id: string (kebab-case pattern)
    |   |-- name: string (minLength: 1)
    |   |-- description: string
    |   |-- archetypeId: string (kebab-case, references archetype)
    |   |-- statModifiers: StatModifiers
    |   |-- growthRates: GrowthRates
    |   |-- primaryResourceId: string (enum: mana, rage, energy, focus, faith, stamina)
    |   |-- startingAbilityIds: array of string
    |   |-- requirements: object or null (optional unlock conditions)
    |   +-- sortOrder: integer (minimum: 0)
    |-- StatModifiers
    |   |-- maxHealth: integer
    |   |-- attack: integer
    |   |-- defense: integer
    |   |-- might: integer
    |   |-- fortitude: integer
    |   |-- will: integer
    |   |-- wits: integer
    |   +-- finesse: integer
    +-- GrowthRates
        |-- maxHealth: integer (minimum: 0)
        |-- attack: integer (minimum: 0)
        |-- defense: integer (minimum: 0)
        |-- might: integer (minimum: 0)
        |-- fortitude: integer (minimum: 0)
        |-- will: integer (minimum: 0)
        |-- wits: integer (minimum: 0)
        +-- finesse: integer (minimum: 0)
```

### Resource Type Enum

| Resource ID | Display Name | Typical Classes |
|-------------|--------------|-----------------|
| `mana` | Mana | Galdr-Caster |
| `rage` | Rage | Shieldmaiden |
| `energy` | Energy | Shadow-Walker |
| `focus` | Focus | Scrap-Tinker |
| `faith` | Faith | Blood-Priest |
| `stamina` | Stamina | Generic melee |

### Acceptance Criteria

- [x] `classes.schema.json` created in `config/schemas/`
- [x] Schema validates existing `classes.json` without errors
- [x] Stat modifiers allow positive and negative values
- [x] Growth rates require non-negative values
- [x] Primary resource ID validated against enum
- [x] Archetype ID reference format validated
- [x] Starting ability IDs validated as array of strings
- [x] ~5 unit tests pass

---

## v0.14.0c: Background Schema

[v0.14.0c Design Specification](v0.14.0c-design-specification.md)

### Overview

Create a comprehensive JSON schema for background definitions that validates attribute bonuses, starting items, starter abilities, and background categories.

### Scope

**In Scope:**
- `backgrounds.schema.json` - Full schema for background definitions
- Attribute bonus validation (limited to 1-2 points total)
- Category enumeration (Profession, Lineage)
- Starting item ID references
- Starter ability definition (id, name, description)
- Lore and description fields

**Out of Scope:**
- Skill schema (v0.14.0d)
- Item cross-reference validation (v0.14.2)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `backgrounds.schema.json` |
| Schema Definitions | 2 | `BackgroundDefinition`, `AttributeBonuses` |
| Configuration Updates | 1 | Update `backgrounds.json` to reference schema |
| Unit Tests | ~5 | Schema validation tests |

### Schema Structure

```
backgrounds.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Background Configuration"
|-- description: "Schema for character background definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string
|   +-- backgrounds: array of BackgroundDefinition
|-- required: ["backgrounds"]
+-- definitions:
    |-- BackgroundDefinition
    |   |-- id: string (kebab-case pattern)
    |   |-- name: string (minLength: 1)
    |   |-- category: string (enum: Profession, Lineage)
    |   |-- description: string
    |   |-- lore: string (optional)
    |   |-- attributeBonuses: AttributeBonuses
    |   |-- starterAbilityId: string (kebab-case)
    |   |-- starterAbilityName: string
    |   |-- starterAbilityDescription: string
    |   |-- startingItems: array of string
    |   |-- isPlayable: boolean (default: true)
    |   +-- sortOrder: integer (minimum: 0)
    +-- AttributeBonuses
        |-- might: integer (0 to 2, optional)
        |-- fortitude: integer (0 to 2, optional)
        |-- will: integer (0 to 2, optional)
        |-- wits: integer (0 to 2, optional)
        +-- finesse: integer (0 to 2, optional)
```

### Background Categories

| Category | Description | Examples |
|----------|-------------|----------|
| `Profession` | Trained occupation | Soldier, Scholar, Thief, Healer |
| `Lineage` | Cultural/geographical origin | Mountainborn, Coastlander, Forestkin, Cityfolk |

### Acceptance Criteria

- [x] `backgrounds.schema.json` created in `config/schemas/`
- [x] Schema validates existing `backgrounds.json` without errors
- [x] Category enum validated (Profession, Lineage)
- [x] Attribute bonuses limited to 0-2 range
- [x] Starting items validated as array of strings
- [x] Starter ability fields all required together
- [x] ~5 unit tests pass

---

## v0.14.0d: Skill & Archetype Schemas

[v0.14.0d Design Specification](v0.14.0d-design-specification.md)

### Overview

Create JSON schemas for skill and archetype definitions, establishing attribute links, skill categories, and archetype playstyle metadata.

### Scope

**In Scope:**
- `skills.schema.json` - Full schema for skill definitions
- Attribute link validation (primary/secondary)
- Skill category enumeration
- Trained/untrained mechanics
- `archetypes.schema.json` - Full schema for archetype definitions
- Stat tendency enumeration
- Playstyle summary fields

**Out of Scope:**
- Progression schema (v0.14.0e)
- Difficulty class references (future version)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 2 | `skills.schema.json`, `archetypes.schema.json` |
| Schema Definitions | 2 | `SkillDefinition`, `ArchetypeDefinition` |
| Configuration Updates | 2 | Update `skills.json`, `archetypes.json` |
| Unit Tests | ~5 | Schema validation tests |

### Skills Schema Structure

```
skills.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Skills Configuration"
|-- description: "Schema for skill definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   +-- skills: array of SkillDefinition
|-- required: ["skills"]
+-- definitions:
    +-- SkillDefinition
        |-- id: string (kebab-case pattern)
        |-- name: string (minLength: 1)
        |-- description: string
        |-- primaryAttribute: string (enum: might, fortitude, will, wits, finesse)
        |-- secondaryAttribute: string (optional, same enum)
        |-- baseDicePool: string (dice pattern, e.g., "1d10")
        |-- allowUntrained: boolean (default: true)
        |-- untrainedPenalty: integer (minimum: 0, default: 0)
        |-- category: string (enum: Physical, Mental, Social, Knowledge, Specialty)
        |-- tags: array of string
        +-- sortOrder: integer (minimum: 0)
```

### Archetypes Schema Structure

```
archetypes.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Archetypes Configuration"
|-- description: "Schema for class archetype definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   +-- archetypes: array of ArchetypeDefinition
|-- required: ["archetypes"]
+-- definitions:
    +-- ArchetypeDefinition
        |-- id: string (kebab-case pattern)
        |-- name: string (minLength: 1)
        |-- description: string
        |-- playstyleSummary: string
        |-- statTendency: string (enum: offensive, defensive, balanced)
        +-- sortOrder: integer (minimum: 0)
```

### Skill Categories

| Category | Description | Examples |
|----------|-------------|----------|
| `Physical` | Body-based skills | Athletics, Acrobatics, Stealth, Endurance |
| `Mental` | Mind-based skills | Perception, Investigation |
| `Social` | Interaction skills | Intimidation, Persuasion |
| `Knowledge` | Learned skills | Arcana |
| `Specialty` | Trained-only skills | Lockpicking |

### Acceptance Criteria

- [x] `skills.schema.json` created in `config/schemas/`
- [x] `archetypes.schema.json` created in `config/schemas/`
- [x] Skills schema validates existing `skills.json` without errors
- [x] Archetypes schema validates existing `archetypes.json` without errors
- [x] Attribute enum validated (might, fortitude, will, wits, finesse)
- [x] Skill category enum validated
- [x] Stat tendency enum validated (offensive, defensive, balanced)
- [x] ~5 unit tests pass

---

## v0.14.0e: Progression Schema

[v0.14.0e Design Specification](v0.14.0e-design-specification.md)

### Overview

Create a JSON schema for level progression configuration, validating XP curves, level milestones, stat bonuses, and custom rewards.

### Scope

**In Scope:**
- `progression.schema.json` - Full schema for progression definitions
- XP curve configuration (linear, exponential)
- Level milestone definitions
- Default stat bonuses per level
- Custom reward definitions
- Heal-on-level-up toggle

**Out of Scope:**
- Ability point allocation rules (future version)
- Prestige/multiclass mechanics (future version)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `progression.schema.json` |
| Schema Definitions | 2 | `ProgressionConfig`, `LevelMilestone` |
| Configuration Updates | 1 | Update `progression.json` to reference schema |
| Unit Tests | ~4 | Schema validation tests |

### Schema Structure

```
progression.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Progression Configuration"
|-- description: "Schema for level progression and XP requirements"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- experienceTerminology: string (default: "XP")
|   |-- levelTerminology: string (default: "Level")
|   |-- maxLevel: integer (minimum: 1, maximum: 100)
|   |-- curveType: string (enum: Linear, Exponential, Custom)
|   |-- baseXpRequirement: integer (minimum: 1)
|   |-- xpMultiplier: number (minimum: 1.0)
|   |-- healOnLevelUp: boolean (default: true)
|   |-- defaultStatBonuses: StatBonuses
|   +-- levels: array of LevelMilestone
|-- required: ["maxLevel", "baseXpRequirement"]
+-- definitions:
    |-- StatBonuses
    |   |-- maxHealth: integer (minimum: 0)
    |   |-- attack: integer (minimum: 0)
    |   +-- defense: integer (minimum: 0)
    +-- LevelMilestone
        |-- level: integer (minimum: 1)
        |-- title: string (optional, e.g., "Veteran")
        |-- customRewards: array of string (optional)
        +-- statOverrides: StatBonuses (optional)
```

### XP Curve Types

| Curve Type | Formula | Use Case |
|------------|---------|----------|
| `Linear` | `baseXP * level` | Steady progression |
| `Exponential` | `baseXP * (multiplier ^ level)` | Accelerating difficulty |
| `Custom` | Defined per-level in milestones | Full control |

### Acceptance Criteria

- [x] `progression.schema.json` created in `config/schemas/`
- [x] Schema validates existing `progression.json` without errors
- [x] Max level range validated (1-100)
- [x] Curve type enum validated
- [x] Base XP requirement must be positive
- [x] XP multiplier must be >= 1.0
- [x] Level milestones reference valid level numbers
- [x] ~4 unit tests pass

---

## Dependencies & Prerequisites

```
v0.13.5 (UI Standardization) - REQUIRED
    |
    +-- All UI standardization complete ────────────────────────────────┐
                                                                        |
                                    v
v0.14.0 (Character Configuration Schemas)
    |
    |-- v0.14.0a: Race Schema ──────────────────────────────────────────┐
    |       Dependencies: None                                           |
    |       Provides: races.schema.json, AttributeModifiers definition   |
    |                                                                    |
    |-- v0.14.0b: Class Schema ─────────────────────────────────────────┤
    |       Dependencies: v0.14.0d (archetypes.schema.json)              |
    |       Provides: classes.schema.json, StatModifiers, GrowthRates    |
    |                                                                    |
    |-- v0.14.0c: Background Schema ────────────────────────────────────┤
    |       Dependencies: None                                           |
    |       Provides: backgrounds.schema.json                            |
    |                                                                    |
    |-- v0.14.0d: Skill & Archetype Schemas ────────────────────────────┤
    |       Dependencies: None                                           |
    |       Provides: skills.schema.json, archetypes.schema.json         |
    |                                                                    |
    +-- v0.14.0e: Progression Schema ───────────────────────────────────┘
            Dependencies: None
            Provides: progression.schema.json

Note: v0.14.0d should be implemented before v0.14.0b due to archetype reference
```

---

## Estimated Effort Summary

| Part | New Files | Modified Files | Est. Tests | Complexity |
|------|-----------|----------------|------------|------------|
| v0.14.0a | 1 | 1 | ~5 | Medium |
| v0.14.0b | 1 | 1 | ~5 | Medium |
| v0.14.0c | 1 | 1 | ~5 | Medium |
| v0.14.0d | 2 | 2 | ~5 | Low-Medium |
| v0.14.0e | 1 | 1 | ~4 | Low-Medium |
| **Total** | **6** | **6** | **~24** | |

---

## Risk Assessment

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Existing configs fail validation | Medium | Low | Review all configs before finalizing schema |
| Schema too strict breaks modding | Medium | Medium | Use optional fields, allow additional properties |
| Cross-reference validation complexity | Low | Low | Defer to v0.14.x cross-cutting concerns |
| VS Code schema integration issues | Low | Low | Test with multiple editors |

---

## Design Decisions (Confirmed)

### Schema Standards

| Decision | Value | Notes |
|----------|-------|-------|
| **JSON Schema Version** | Draft-07 | Widely supported, good tooling |
| **ID Pattern** | `^[a-z][a-z0-9-]*$` | Lowercase kebab-case |
| **Schema Location** | `config/schemas/` | Centralized schema storage |
| **Reference Style** | `$ref` to definitions | Reusable type definitions |

### Validation Approach

| Decision | Value | Notes |
|----------|-------|-------|
| **Additional Properties** | Allowed by default | Supports forward compatibility |
| **Required Fields** | Explicitly listed | Clear contract |
| **Default Values** | Documented in schema | IDE support |
| **Enum Validation** | Used for categorical fields | Prevents typos |

### Attribute Modifiers

| Decision | Value | Notes |
|----------|-------|-------|
| **Race modifier range** | -3 to +3 | Balanced racial differences |
| **Background bonus range** | 0 to +2 | Minor bonuses only |
| **Attribute names** | might, fortitude, will, wits, finesse | Consistent with existing system |

---

## Next Steps

1. **Review & Approve** - Confirm scope breakdown
2. **v0.14.0d Design Spec** - Create archetypes schema first (dependency for classes)
3. **v0.14.0d Implementation** - Build archetypes.schema.json, skills.schema.json
4. **v0.14.0a Design Spec** - Create detailed design for Race Schema
5. **v0.14.0a Implementation** - Build races.schema.json
6. **v0.14.0b Design Spec** - Create detailed design for Class Schema
7. **v0.14.0b Implementation** - Build classes.schema.json
8. **v0.14.0c Design Spec** - Create detailed design for Background Schema
9. **v0.14.0c Implementation** - Build backgrounds.schema.json
10. **v0.14.0e Design Spec** - Create detailed design for Progression Schema
11. **v0.14.0e Implementation** - Build progression.schema.json

---

*This scope breakdown provides a structured approach to implementing v0.14.0 Character Configuration Schemas. Each sub-part creates a complete, validated JSON schema for character-related configuration files. The recommended implementation order is v0.14.0d (archetypes/skills) first, then v0.14.0a (races), v0.14.0b (classes), v0.14.0c (backgrounds), and finally v0.14.0e (progression), ensuring dependencies are satisfied.*
