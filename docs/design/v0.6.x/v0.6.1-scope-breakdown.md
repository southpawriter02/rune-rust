# v0.6.1 Visual Components - Scope Breakdown

**Version:** 0.6.1
**Theme:** Visual Components
**Prerequisites:** v0.6.0c Complete (Core UI Framework - Color Themes)
**Total Estimated Tests:** ~35 new tests

---

## Executive Summary

The Visual Components sub-version implements rich visual elements that leverage the screen layout framework from v0.6.1. This includes ASCII health bars with color-coded thresholds, ASCII art room representations, a persistent mini-map showing explored areas, and a visual inventory grid. These components transform the TUI from plain text to an engaging visual experience.

Key focus areas:
- **Health Bars**: Visual HP/resource representation with color thresholds
- **ASCII Rooms**: Room visual art with configurable templates
- **Mini-Map**: Persistent exploration map
- **Inventory Grid**: Visual item slot display

The work is divided into **four sub-parts**:

| Part | Name | Focus | Est. Tests |
|------|------|-------|------------|
| v0.6.1a | Health Bars | Visual HP bars, color thresholds, resource bars | ~8 |
| v0.6.1b | ASCII Room Renderer | Room art templates, legend rendering | ~10 |
| v0.6.0c | Mini-Map | Exploration tracking, room connections, current position | ~10 |
| v0.6.1d | Inventory Grid | Item slots, selection, capacity display | ~7 |

---

## Existing Infrastructure

### Already Implemented (from v0.6.1)

| Feature | Location | Notes |
|---------|----------|-------|
| ScreenLayout | `Presentation/UI/ScreenLayout.cs` | Panel management |
| Panel | `Presentation/UI/Panel.cs` | Panel value object |
| StatusBar | `Presentation/UI/StatusBar.cs` | Footer display |
| IColorThemeService | `Application/Interfaces/IColorThemeService.cs` | Color management |
| ITerminalService | `Application/Interfaces/ITerminalService.cs` | Terminal operations |

### Already Implemented (from prior versions)

| Feature | Location | Notes |
|---------|----------|-------|
| Player | `Domain/Entities/Player.cs` | HP, resources, stats |
| Inventory | `Domain/Entities/Inventory.cs` | Item storage |
| Room | `Domain/Entities/Room.cs` | Room definitions |
| RoomConnection | `Domain/ValueObjects/RoomConnection.cs` | Room links |
| Item | `Domain/Entities/Item.cs` | Item data |

### Needs Implementation (v0.6.1)

| Feature | Part | Notes |
|---------|------|-------|
| HealthBar | v0.6.1a | Visual bar component |
| ResourceBar | v0.6.1a | Generic resource display |
| AsciiRoomRenderer | v0.6.1b | Room art rendering |
| RoomArtDefinition | v0.6.1b | Room art templates |
| MiniMap | v0.6.0c | Map component |
| ExplorationTracker | v0.6.0c | Visited rooms tracking |
| InventoryGrid | v0.6.1d | Grid display component |

---

## Feature Analysis & Categorization

### Health Bar Features

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| Health bar rendering | Low | ColorThemeService | **v0.6.1a** |
| Color thresholds | Low | ColorThemeService | **v0.6.1a** |
| Resource bars | Low | Health bar | **v0.6.1a** |

### Room Art Features

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| Room art templates | Medium | JSON config | **v0.6.1b** |
| Art rendering | Medium | ScreenLayout | **v0.6.1b** |
| Legend display | Low | Room art | **v0.6.1b** |

### Mini-Map Features

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| Exploration tracking | Medium | Room connections | **v0.6.0c** |
| Map rendering | High | ScreenLayout | **v0.6.0c** |
| Current position | Low | Map component | **v0.6.0c** |

### Inventory Grid Features

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| Grid layout | Medium | ScreenLayout | **v0.6.1d** |
| Item slots | Low | Inventory | **v0.6.1d** |
| Selection highlight | Low | Grid layout | **v0.6.1d** |

---

## Part Definitions

---

## v0.6.1a: Health Bars

[v0.6.1a Design Specification](v0.6.1a-design-specification.md)

### Overview

Implement visual health bar components that display HP, MP, and other resources as filled bar graphics. Bars change color based on percentage thresholds to indicate danger levels.

### Scope

**In Scope:**
- `HealthBar` component class
- Bar character rendering (â–ˆ, â–‘)
- Color threshold configuration
- HP bar (red/yellow/green)
- MP/Mana bar (blue)
- XP bar (purple/cyan)
- Generic `ResourceBar` for other resources
- Sidebar integration
- Compact vs detailed format
- Critical health blinking (optional)

**Out of Scope:**
- Room art (v0.6.1b)
- Mini-map (v0.6.0c)
- Inventory grid (v0.6.1d)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Presentation Classes | 2 | `HealthBar`, `ResourceBar` |
| Configuration | 1 | `ui.json` (thresholds section) |
| Unit Tests | ~8 | Bar rendering, threshold tests |

### HealthBar Component

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Renders a visual health/resource bar.
/// </summary>
public class HealthBar
{
    private readonly IColorThemeService _colorService;
    
    public HealthBar(IColorThemeService colorService)
    {
        _colorService = colorService;
    }
    
    /// <summary>Renders a health bar to a string.</summary>
    public string Render(int current, int max, int width, BarStyle style = BarStyle.Standard);
    
    /// <summary>Gets the color based on percentage.</summary>
    public ConsoleColor GetThresholdColor(int current, int max, BarType type);
    
    /// <summary>Renders a labeled health bar.</summary>
    public string RenderLabeled(string label, int current, int max, int totalWidth);
}

public enum BarStyle
{
    Standard,   // â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘
    Detailed,   // [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 80/100
    Compact,    // â–ˆâ–ˆâ–ˆâ–ˆ80
    Numeric     // 80/100
}

public enum BarType
{
    Health,     // Green â†’ Yellow â†’ Red
    Mana,       // Blue (no threshold)
    Experience, // Purple/Cyan (no threshold)
    Stamina,    // Yellow â†’ Orange
    Custom      // User-defined colors
}
```

### Health Bar Designs

```
STANDARD BAR STYLES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Full Health (100%):
  HP: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100/100    [Green]

High Health (80%):
  HP: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  80/100    [Green]

Medium Health (50%):
  HP: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  50/100    [Yellow]

Low Health (25%):
  HP: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  25/100    [Red]

Critical Health (5%):
  HP: â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   5/100    [Dark Red, blinking]


RESOURCE BARS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Mana (always blue):
  MP: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  70/100    [Blue]

Experience (always purple):
  XP: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  400/1000  [Magenta]

Rage (warrior resource):
  RAGE: â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  20/100   [DarkRed â†’ Red as fills]


COMPACT STYLES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Sidebar format:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ HP â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  80   â”‚
  â”‚ MP â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  60   â”‚
  â”‚ XP â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  40%  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Color Threshold Configuration

```json
{
  "$schema": "./schemas/ui.schema.json",
  "healthBars": {
    "thresholds": {
      "health": [
        { "percent": 75, "color": "Green" },
        { "percent": 50, "color": "Yellow" },
        { "percent": 25, "color": "Red" },
        { "percent": 10, "color": "DarkRed" }
      ],
      "mana": [
        { "percent": 0, "color": "Blue" }
      ],
      "experience": [
        { "percent": 0, "color": "Magenta" }
      ]
    },
    "characters": {
      "filled": "â–ˆ",
      "empty": "â–‘",
      "filledFallback": "#",
      "emptyFallback": "-"
    },
    "enableBlinking": true,
    "blinkThreshold": 10
  }
}
```

### Acceptance Criteria

- [ ] Health bar renders filled/empty portions
- [ ] Bar color changes based on percentage
- [ ] Green at >75%, yellow at >50%, red at â‰¤50%
- [ ] Critical health (<10%) shows dark red
- [ ] Mana bar renders in blue
- [ ] XP bar renders in magenta
- [ ] Compact and detailed styles work
- [ ] Fallback characters for non-Unicode terminals
- [ ] ~8 unit tests pass

---

## v0.6.1b: ASCII Room Renderer

[v0.6.1b Design Specification](v0.6.1b-design-specification.md)

### Overview

Implement ASCII art room rendering with configurable room templates. Each room can have custom ASCII art that displays in the main content panel, with an optional legend explaining symbols.

### Scope

**In Scope:**
- `AsciiRoomRenderer` component
- `RoomArtDefinition` for templates
- Room art JSON configuration
- Art rendering to main panel
- Symbol legend display
- Dynamic art elements (player position, monsters)
- Fallback for rooms without custom art
- Art scaling for terminal width

**Out of Scope:**
- Mini-map (v0.6.0c)
- Inventory grid (v0.6.1d)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Presentation Classes | 1 | `AsciiRoomRenderer` |
| Domain Value Objects | 1 | `RoomArtDefinition` |
| Configuration | 1 | `room-art.json` |
| Unit Tests | ~10 | Rendering, scaling tests |

### AsciiRoomRenderer Component

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Renders ASCII art for rooms.
/// </summary>
public class AsciiRoomRenderer
{
    private readonly IRoomArtProvider _artProvider;
    private readonly IColorThemeService _colorService;
    private readonly ScreenLayout _layout;
    
    public AsciiRoomRenderer(
        IRoomArtProvider artProvider,
        IColorThemeService colorService,
        ScreenLayout layout)
    {
        _artProvider = artProvider;
        _colorService = colorService;
        _layout = layout;
    }
    
    /// <summary>Renders the room art to the main panel.</summary>
    public void RenderRoom(Room room);
    
    /// <summary>Renders the room with dynamic elements.</summary>
    public void RenderRoom(Room room, IReadOnlyList<Entity> entities);
    
    /// <summary>Renders the legend for the room art.</summary>
    public void RenderLegend(RoomArtDefinition art);
    
    /// <summary>Gets scaled art for the available width.</summary>
    private IReadOnlyList<string> ScaleArt(IReadOnlyList<string> art, int targetWidth);
}
```

### Room Art Definition

```csharp
namespace RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Defines ASCII art for a room type.
/// </summary>
public record RoomArtDefinition(
    string RoomId,
    IReadOnlyList<string> ArtLines,
    IReadOnlyDictionary<char, string> Legend,
    IReadOnlyDictionary<char, ConsoleColor>? SymbolColors = null,
    bool ShowLegend = true
);
```

### Room Art Examples

```
DARK CAVE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
   â•”â•                                       â•šâ•—
  â•”â•   ~~~   â–²   ~~~                         â•šâ•—
 â•”â•    ~~~  â–²â–²â–²  ~~~    â˜                      â•šâ•—
â•”â•         â–²â–²â–²â–²â–²                               â•šâ•—
â•‘    â–‘â–‘     cave     â–‘â–‘                         â•‘
â•šâ•—        entrance                             â•”â•
 â•šâ•—   â–‘â–‘â–‘           â–‘â–‘â–‘                       â•”â•
  â•šâ•—                                         â•”â•
   â•šâ•—                                       â•”â•
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Legend: ~ = water  â–² = stalagmite  â˜  = skeleton  â–‘ = shadow


THRONE ROOM:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  â—Š   â—Š   â—Š       THRONE ROOM       â—Š   â—Š   â—Šâ•‘
    â•‘                                             â•‘
    â•‘   â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“   â•‘
    â•‘   â–“                                   â–“   â•‘
    â•‘   â–“    []      []      []      []     â–“   â•‘
    â•‘   â–“   pillar  pillar  pillar pillar   â–“   â•‘
    â•‘   â–“                                   â–“   â•‘
    â•‘   â–“              â•”â•â•â•â•—                â–“   â•‘
    â•‘   â–“              â•‘ â™” â•‘                â–“   â•‘
    â•‘   â–“              â•šâ•â•â•â•                â–“   â•‘
    â•‘   â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“   â•‘
    â•‘                 entrance                   â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Legend: â—Š = torch  â–“ = carpet  [] = pillar  â™” = throne


DEFAULT (No custom art):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                             â”‚
    â”‚                 [Room Name]                 â”‚
    â”‚                                             â”‚
    â”‚              (No art defined)               â”‚
    â”‚                                             â”‚
    â”‚  Exits: North, South, East                  â”‚
    â”‚                                             â”‚
    â”‚  You see: Goblin, Rusty Key                 â”‚
    â”‚                                             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Room Art Configuration

```json
{
  "$schema": "./schemas/room-art.schema.json",
  "rooms": {
    "dark-cave": {
      "art": [
        "    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—",
        "   â•”â•                                       â•šâ•—",
        "  â•”â•   ~~~   â–²   ~~~                         â•šâ•—",
        " â•”â•    ~~~  â–²â–²â–²  ~~~    â˜                      â•šâ•—",
        "â•”â•         â–²â–²â–²â–²â–²                               â•šâ•—",
        "â•‘    â–‘â–‘     cave     â–‘â–‘                         â•‘",
        "â•šâ•—        entrance                             â•”â•",
        " â•šâ•—   â–‘â–‘â–‘           â–‘â–‘â–‘                       â•”â•",
        "  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
      ],
      "legend": {
        "~": "water",
        "â–²": "stalagmite",
        "â˜ ": "skeleton",
        "â–‘": "shadow"
      },
      "symbolColors": {
        "~": "Blue",
        "â–²": "DarkGray",
        "â˜ ": "White",
        "â–‘": "DarkGray"
      },
      "showLegend": true
    }
  },
  "defaultArt": {
    "template": "simple-box",
    "showExits": true,
    "showContents": true
  }
}
```

### Acceptance Criteria

- [ ] Room art loads from JSON configuration
- [ ] Art renders to main content panel
- [ ] Legend displays below art
- [ ] Symbols render with colors if defined
- [ ] Default art for rooms without custom art
- [ ] Art scales to fit available width
- [ ] Dynamic elements can be overlaid
- [ ] Unicode fallback for limited terminals
- [ ] ~10 unit tests pass

---

## v0.6.0c: Mini-Map

[v0.6.0c Design Specification](v0.6.0c-design-specification.md)

### Overview

Implement a persistent mini-map that displays in the sidebar, showing explored rooms, room connections, and the player's current position. Unexplored rooms show as unknown until visited.

### Scope

**In Scope:**
- `MiniMap` component class
- `IExplorationTracker` interface
- `ExplorationTracker` for visited rooms
- Room box rendering
- Connection line rendering
- Current room highlighting (@)
- Unexplored room indicators (?)
- Map scrolling for large dungeons
- Sidebar integration
- Exploration persistence

**Out of Scope:**
- Inventory grid (v0.6.1d)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Presentation Classes | 1 | `MiniMap` |
| Application Interfaces | 1 | `IExplorationTracker` |
| Application Services | 1 | `ExplorationTracker` |
| Unit Tests | ~10 | Map rendering, tracking tests |

### MiniMap Component

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Renders a mini-map of explored rooms.
/// </summary>
public class MiniMap
{
    private readonly IExplorationTracker _exploration;
    private readonly ScreenLayout _layout;
    private readonly ILogger<MiniMap> _logger;
    
    private int _scrollX = 0;
    private int _scrollY = 0;
    
    public MiniMap(
        IExplorationTracker exploration,
        ScreenLayout layout,
        ILogger<MiniMap> logger)
    {
        _exploration = exploration;
        _layout = layout;
        _logger = logger;
    }
    
    /// <summary>Renders the mini-map to the sidebar.</summary>
    public void Render(Room currentRoom);
    
    /// <summary>Centers the map on a room.</summary>
    public void CenterOn(Room room);
    
    /// <summary>Scrolls the map view.</summary>
    public void Scroll(int dx, int dy);
    
    /// <summary>Renders a single room on the map.</summary>
    private void RenderRoom(Room room, int mapX, int mapY, bool isCurrent);
    
    /// <summary>Renders connections between rooms.</summary>
    private void RenderConnection(RoomConnection connection, int mapX, int mapY);
}
```

### IExplorationTracker Interface

```csharp
namespace RuneAndRust.Application.Interfaces;

/// <summary>
/// Tracks which rooms the player has explored.
/// </summary>
public interface IExplorationTracker
{
    /// <summary>Marks a room as explored.</summary>
    void MarkExplored(Guid roomId);
    
    /// <summary>Checks if a room has been explored.</summary>
    bool IsExplored(Guid roomId);
    
    /// <summary>Gets all explored room IDs.</summary>
    IReadOnlySet<Guid> ExploredRooms { get; }
    
    /// <summary>Gets rooms adjacent to explored rooms (partially known).</summary>
    IReadOnlySet<Guid> KnownAdjacentRooms { get; }
    
    /// <summary>Clears exploration data.</summary>
    void Reset();
    
    /// <summary>Event raised when exploration changes.</summary>
    event Action<Guid>? OnRoomExplored;
}
```

### Mini-Map Designs

```
SIMPLE MAP (Small dungeon):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mini-Map    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â” â”Œâ”€â”    â”‚     
â”‚  â”‚?â”œâ”€â”¤?â”‚    â”‚     ? = Unexplored (known exit)
â”‚  â””â”€â”˜ â””â”¬â”˜    â”‚     â”€â”‚ = Passage
â”‚       â”‚     â”‚     @ = Current room
â”‚    â”Œâ”€â”€â”´â”€â”€â”  â”‚     â–ˆ = Explored room
â”‚    â”‚  @  â”‚  â”‚
â”‚    â””â”€â”€â”¬â”€â”€â”˜  â”‚
â”‚       â”‚     â”‚
â”‚    â”Œâ”€â”€â”´â”€â”€â”  â”‚
â”‚    â”‚ â–ˆ  â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DETAILED MAP (Larger view):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Mini-Map         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚   â”Œâ”€â”€â”€â”     â”Œâ”€â”€â”€â”       â”‚
â”‚   â”‚ â–ˆ â”œâ”€â”€â”€â”€â”€â”¤ â–ˆ â”‚       â”‚     Legend:
â”‚   â””â”€â”¬â”€â”˜     â””â”€â”¬â”€â”˜       â”‚     â–ˆ = Explored
â”‚     â”‚         â”‚         â”‚     @ = You are here
â”‚   â”Œâ”€â”´â”€â”     â”Œâ”€â”´â”€â”       â”‚     ? = Unknown
â”‚   â”‚ â–ˆ â”œâ”€â”€â”€â”€â”€â”¤ @ â”‚       â”‚     â”€ â”‚ = Passage
â”‚   â””â”€â”¬â”€â”˜     â””â”€â”€â”€â”˜       â”‚
â”‚     â”‚                   â”‚
â”‚   â”Œâ”€â”´â”€â”                 â”‚
â”‚   â”‚ ? â”‚                 â”‚
â”‚   â””â”€â”€â”€â”˜                 â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SCROLLABLE MAP (Large dungeon):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Mini-Map    [â—„][â–²][â–¼][â–º]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Â·  Â·  Â·  Â·  Â·  Â·  Â·    â”‚     Dots = out of view
â”‚  Â·  â”Œâ”€â”€â”€â”  â”Œâ”€â”€â”€â”  Â·     â”‚
â”‚  Â·  â”‚ â–ˆ â”œâ”€â”€â”¤ â–ˆ â”‚  Â·     â”‚
â”‚     â””â”€â”¬â”€â”˜  â””â”€â”¬â”€â”˜        â”‚
â”‚       â”‚      â”‚          â”‚
â”‚     â”Œâ”€â”´â”€â”  â”Œâ”€â”´â”€â”        â”‚
â”‚     â”‚ @ â”œâ”€â”€â”¤ â–ˆ â”‚        â”‚
â”‚     â””â”€â”€â”€â”˜  â””â”€â”€â”€â”˜        â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Map Position Calculation

```
MAP COORDINATE SYSTEM:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Each room occupies a 5x3 character cell:
  â”Œâ”€â”€â”€â”
  â”‚ @ â”‚   (5 wide x 3 tall)
  â””â”€â”€â”€â”˜

Connections use 2 characters:
  Horizontal: â”€â”€
  Vertical:   â”‚
              â”‚

Grid layout example:
  Position (0,0)  Position (1,0)  Position (2,0)
  â”Œâ”€â”€â”€â”           â”Œâ”€â”€â”€â”           â”Œâ”€â”€â”€â”
  â”‚ â–ˆ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â–ˆ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ @ â”‚
  â””â”€â”¬â”€â”˜           â””â”€â”¬â”€â”˜           â””â”€â”€â”€â”˜
    â”‚               â”‚
  â”Œâ”€â”´â”€â”           â”Œâ”€â”´â”€â”
  â”‚ â–ˆ â”‚           â”‚ ? â”‚
  â””â”€â”€â”€â”˜           â””â”€â”€â”€â”˜
  Position (0,1)  Position (1,1)
```

### Acceptance Criteria

- [ ] Mini-map renders in sidebar
- [ ] Explored rooms show as filled boxes
- [ ] Current room shows @ marker
- [ ] Unexplored adjacent rooms show ?
- [ ] Connections render between rooms
- [ ] Map centers on current room
- [ ] Map scrolls for large dungeons
- [ ] Exploration persists during session
- [ ] Map updates on room change
- [ ] ~10 unit tests pass

---

## v0.6.1d: Inventory Grid

[v0.6.1d Design Specification](v0.6.1d-design-specification.md)

### Overview

Implement a visual inventory grid that displays items in a slot-based layout. The grid shows item icons, names, and supports selection highlighting. Capacity is displayed at the bottom.

### Scope

**In Scope:**
- `InventoryGrid` component class
- Slot rendering with item icons
- Item name abbreviation
- Selection highlighting
- Empty slot display
- Capacity indicator
- Sidebar integration
- Scroll for large inventories
- Item category icons

**Out of Scope:**
- Drag-and-drop (v0.7.0 GUI)
- Item context menu (TUI uses commands)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Presentation Classes | 1 | `InventoryGrid` |
| Configuration | 1 | `ui.json` (icons section) |
| Unit Tests | ~7 | Grid rendering, selection tests |

### InventoryGrid Component

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Renders the inventory as a visual grid.
/// </summary>
public class InventoryGrid
{
    private readonly ScreenLayout _layout;
    private readonly IColorThemeService _colorService;
    private readonly IItemIconProvider _iconProvider;
    
    private int _selectedIndex = -1;
    private int _scrollOffset = 0;
    
    public InventoryGrid(
        ScreenLayout layout,
        IColorThemeService colorService,
        IItemIconProvider iconProvider)
    {
        _layout = layout;
        _colorService = colorService;
        _iconProvider = iconProvider;
    }
    
    /// <summary>Gets or sets the selected item index.</summary>
    public int SelectedIndex { get; set; }
    
    /// <summary>Renders the inventory grid.</summary>
    public void Render(Inventory inventory);
    
    /// <summary>Moves selection up/down.</summary>
    public void MoveSelection(int delta);
    
    /// <summary>Gets the currently selected item.</summary>
    public Item? GetSelectedItem(Inventory inventory);
    
    /// <summary>Scrolls the grid view.</summary>
    public void Scroll(int rows);
}
```

### Inventory Grid Design

```
FULL INVENTORY GRID (Sidebar):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           INVENTORY                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”      â”‚
â”‚ â”‚ âš” â”‚ â”‚ ğŸ›¡ â”‚ â”‚ ğŸ§ªâ”‚ â”‚ ğŸ§ªâ”‚ â”‚ ğŸ”‘â”‚      â”‚  Row 1
â”‚ â”‚Swdâ”‚ â”‚Shdâ”‚ â”‚Potâ”‚ â”‚Potâ”‚ â”‚Keyâ”‚      â”‚
â”‚ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜      â”‚
â”‚ â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”      â”‚
â”‚ â”‚ ğŸ“œâ”‚ â”‚ ğŸ’â”‚ â”‚[â–ˆ]â”‚ â”‚   â”‚ â”‚   â”‚      â”‚  Row 2 (â–ˆ = selected)
â”‚ â”‚Scrâ”‚ â”‚Rngâ”‚ â”‚Gemâ”‚ â”‚   â”‚ â”‚   â”‚      â”‚
â”‚ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜      â”‚
â”‚ â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”      â”‚
â”‚ â”‚   â”‚ â”‚   â”‚ â”‚   â”‚ â”‚   â”‚ â”‚   â”‚      â”‚  Row 3 (empty)
â”‚ â”‚   â”‚ â”‚   â”‚ â”‚   â”‚ â”‚   â”‚ â”‚   â”‚      â”‚
â”‚ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Selected: Red Gem                   â”‚
â”‚ A brilliant red gemstone.           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Capacity: 8/15                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


COMPACT GRID (Narrow sidebar):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    INVENTORY      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš”Sword   ğŸ›¡Shield â”‚
â”‚ ğŸ§ªPotion ğŸ§ªPotion â”‚
â”‚ ğŸ”‘Key    ğŸ“œScroll â”‚
â”‚ ğŸ’Ring  [â–ˆ]Gem   â”‚
â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 8/15 slots        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ASCII FALLBACK (No Unicode):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           INVENTORY                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [W]Sword  [A]Shield [P]Potion [P]Potionâ”‚
â”‚ [K]Key    [S]Scroll [R]Ring   [*]Gem  â”‚ (* = selected)
â”‚ [ ]       [ ]       [ ]       [ ]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Capacity: 8/15                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Item Icon Configuration

```json
{
  "$schema": "./schemas/ui.schema.json",
  "inventoryGrid": {
    "columns": 5,
    "showDescription": true,
    "iconMode": "unicode",
    "icons": {
      "weapon": { "unicode": "âš”", "ascii": "W" },
      "armor": { "unicode": "ğŸ›¡", "ascii": "A" },
      "potion": { "unicode": "ğŸ§ª", "ascii": "P" },
      "key": { "unicode": "ğŸ”‘", "ascii": "K" },
      "scroll": { "unicode": "ğŸ“œ", "ascii": "S" },
      "ring": { "unicode": "ğŸ’", "ascii": "R" },
      "gem": { "unicode": "ğŸ’", "ascii": "G" },
      "gold": { "unicode": "ğŸ’°", "ascii": "$" },
      "food": { "unicode": "ğŸ–", "ascii": "F" },
      "default": { "unicode": "ğŸ“¦", "ascii": "?" }
    },
    "selection": {
      "marker": "â–ˆ",
      "color": "Cyan"
    }
  }
}
```

### Acceptance Criteria

- [ ] Inventory grid renders in sidebar
- [ ] Items show with category icons
- [ ] Item names show (abbreviated if needed)
- [ ] Selected item is highlighted
- [ ] Empty slots display correctly
- [ ] Capacity indicator shows current/max
- [ ] Selection can move through items
- [ ] Grid scrolls for large inventories
- [ ] ~7 unit tests pass

---

## Dependencies & Prerequisites

```
v0.6.0c (Color Themes) - REQUIRED
    â”‚
    â””â”€â”€ ScreenLayout, ColorThemeService â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                     â”‚
v0.6.1 (Visual Components)                                           â”‚
    â”‚                                                                â”‚
    â”œâ”€â”€ v0.6.1a: Health Bars â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚       Dependencies: ColorThemeService                          â”‚
    â”‚       Provides: HealthBar, ResourceBar                         â”‚
    â”‚                                                                â”‚
    â”œâ”€â”€ v0.6.1b: ASCII Room Renderer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚       Dependencies: ScreenLayout, ColorThemeService            â”‚
    â”‚       Provides: AsciiRoomRenderer, RoomArtDefinition           â”‚
    â”‚                                                                â”‚
    â”œâ”€â”€ v0.6.0c: Mini-Map â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚       Dependencies: ScreenLayout, Room connections             â”‚
    â”‚       Provides: MiniMap, ExplorationTracker                    â”‚
    â”‚                                                                â”‚
    â””â”€â”€ v0.6.1d: Inventory Grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            Dependencies: ScreenLayout, Inventory
            Provides: InventoryGrid
```

---

## Estimated Effort Summary

| Part | New Files | Modified Files | Est. Tests | Complexity |
|------|-----------|----------------|------------|------------|
| v0.6.1a | ~2 | ~1 | ~8 | Low |
| v0.6.1b | ~2 | ~1 | ~10 | Medium |
| v0.6.0c | ~3 | ~1 | ~10 | High |
| v0.6.1d | ~1 | ~1 | ~7 | Medium |
| **Total** | **~8** | **~4** | **~35** | |

---

## Risk Assessment

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Unicode support varies | Medium | Medium | ASCII fallback for all components |
| Mini-map complexity | Medium | Low | Start simple, iterate |
| Sidebar width constraints | Low | Medium | Compact layouts |
| Color rendering issues | Low | Low | Test multiple terminals |

---

## Design Decisions (Confirmed)

### Health Bars

| Decision | Value | Notes |
|----------|-------|-------|
| **Bar Characters** | â–ˆ and â–‘ | ASCII fallback: # and - |
| **Thresholds** | 75/50/25/10 | Green/Yellow/Red/DarkRed |
| **Blinking** | Optional | For critical health |

### Room Art

| Decision | Value | Notes |
|----------|-------|-------|
| **Art Size** | Variable | Scales to panel width |
| **Legend** | Below art | Optional per room |
| **Default** | Simple box | For rooms without art |

### Mini-Map

| Decision | Value | Notes |
|----------|-------|-------|
| **Room Size** | 5x3 chars | Readable but compact |
| **Scroll** | Arrow keys | For large maps |
| **Center** | On current room | Auto-adjust |

### Inventory Grid

| Decision | Value | Notes |
|----------|-------|-------|
| **Columns** | 5 default | Configurable |
| **Icons** | Category-based | Unicode with ASCII fallback |
| **Selection** | Keyboard nav | Arrow keys |

---

## Next Steps

1. **Review & Approve** - Confirm scope breakdown
2. **v0.6.1a Design Spec** - Create detailed design for Health Bars
3. **v0.6.1a Implementation** - Build health bar components
4. **v0.6.1b Design Spec** - Create specification for ASCII Room Renderer
5. **v0.6.1b Implementation** - Build room art system
6. **v0.6.0c Design Spec** - Create specification for Mini-Map
7. **v0.6.0c Implementation** - Build exploration tracking and map
8. **v0.6.1d Design Spec** - Create specification for Inventory Grid
9. **v0.6.1d Implementation** - Build inventory grid component

---

*This scope breakdown provides a structured approach to implementing v0.6.1 Visual Components. Each sub-part adds a distinct visual element, leveraging the screen layout framework from v0.6.1.*
