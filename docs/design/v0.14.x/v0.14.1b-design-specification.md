# v0.14.1b Design Specification: Status Effect Schema

**Version:** 0.14.1b
**Parent:** v0.14.1 (Combat Configuration Schemas)
**Prerequisites:** v0.14.0 Complete (Character Configuration Schemas)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Status Effect Schema Definition](#4-status-effect-schema-definition)
   - 4.1 [Root Configuration Properties](#41-root-configuration-properties)
   - 4.2 [StatusEffect Definition](#42-statuseffect-definition)
   - 4.3 [StatModifier Definition](#43-statmodifier-definition)
   - 4.4 [TriggerCondition Definition](#44-triggercondition-definition)
   - 4.5 [EffectImmunity Definition](#45-effectimmunity-definition)
5. [Duration Type Configuration](#5-duration-type-configuration)
   - 5.1 [Duration Type Enum](#51-duration-type-enum)
   - 5.2 [Duration Type Usage](#52-duration-type-usage)
6. [Stacking Rule Configuration](#6-stacking-rule-configuration)
   - 6.1 [Stacking Rule Enum](#61-stacking-rule-enum)
   - 6.2 [Stacking Rule Behavior](#62-stacking-rule-behavior)
7. [Cleanse Category Configuration](#7-cleanse-category-configuration)
   - 7.1 [Cleanse Category Enum](#71-cleanse-category-enum)
   - 7.2 [Cleanse Mechanics](#72-cleanse-mechanics)
8. [Validation Rules](#8-validation-rules)
   - 8.1 [Enum Validation](#81-enum-validation)
   - 8.2 [Range Validation](#82-range-validation)
   - 8.3 [Required Fields](#83-required-fields)
   - 8.4 [Conditional Requirements](#84-conditional-requirements)
9. [Configuration Schema](#9-configuration-schema)
10. [Configuration File Updates](#10-configuration-file-updates)
11. [Data Model Changes](#11-data-model-changes)
12. [Logging Specifications](#12-logging-specifications)
13. [Unit Testing Requirements](#13-unit-testing-requirements)
14. [Use Cases](#14-use-cases)
15. [Deliverable Checklist](#15-deliverable-checklist)
16. [Acceptance Criteria](#16-acceptance-criteria)
17. [Dependencies](#17-dependencies)
18. [Future Considerations](#18-future-considerations)

---

## 1. Executive Summary

Version 0.14.1b introduces the **Status Effect Schema** (`status-effects.schema.json`), which validates status effect configuration including duration types, stacking rules, trigger conditions, stat modifiers, cleanse categories, and immunity definitions. This schema enables full customization of buffs, debuffs, and environmental effects without code changes, supporting different combat systems and effect-focused gameplay.

The Status Effect Schema validates effect categories (Buff, Debuff, Environmental), duration types (Turns, Permanent, Triggered, ResourceBased), stacking rules (None, RefreshDuration, StackIntensity, StackDuration, Block), stat modifiers with type enumeration, trigger conditions, and cleanse categories.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Schema Files** | `status-effects.schema.json` |
| **Schema Definitions** | `StatusEffect`, `StatModifier`, `TriggerCondition`, `EffectImmunity` |
| **Configuration Updates** | Update `status-effects.json` with schema reference |
| **Tests** | ~7 new unit tests |

### Architectural Significance

This version provides:
- **Effect category enumeration** - Three categories (Buff, Debuff, Environmental)
- **Duration type pattern** - Defines how effects track their remaining time
- **Stacking rule pattern** - Defines behavior when effects are reapplied
- **Stat modifier system** - Structured stat modifications with type and value
- **Trigger condition system** - Reactive effects based on combat events
- **Cleanse category pattern** - Categorization for effect removal abilities
- **Immunity definitions** - Protection against specific effects or categories

### Relationship to Other Schemas

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     v0.14.1 COMBAT CONFIGURATION SCHEMAS                     │
└─────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────┐
  │  v0.14.1a: abilities.schema.json (expanded)                              │
  │  v0.14.1b: status-effects.schema.json ◀── THIS VERSION                   │
  │  v0.14.1c: damage-types.schema.json                                      │
  │  v0.14.1d: combat.schema.json                                            │
  └─────────────────────────────────────────────────────────────────────────┘

  All schemas share:
  • JSON Schema Draft-07 format
  • ID pattern: ^[a-z][a-z0-9-]*$
  • Schema location: config/schemas/
  • Required field enforcement
  • IDE autocomplete support
```

---

## 2. Feature Overview

```
v0.14.1b Status Effect Schema Features
├── status-effects.schema.json
│   ├── Root Configuration Properties
│   │   ├── $schema (string, optional)
│   │   ├── version (string, optional)
│   │   └── effects (array of StatusEffect, required)
│   └── Definitions
│       ├── StatusEffect
│       │   ├── id (string, kebab-case pattern, required)
│       │   ├── name (string, minLength: 1, required)
│       │   ├── description (string, required)
│       │   ├── category (enum: Buff, Debuff, Environmental, required)
│       │   ├── durationType (enum: Turns, Permanent, Triggered, ResourceBased)
│       │   ├── baseDuration (integer, minimum: 0)
│       │   ├── stackingRule (enum: None, RefreshDuration, StackIntensity, StackDuration, Block)
│       │   ├── maxStacks (integer, minimum: 1)
│       │   ├── damagePerTurn (integer, minimum: 0)
│       │   ├── healingPerTurn (integer, minimum: 0)
│       │   ├── damageType (string)
│       │   ├── statModifiers (array of StatModifier)
│       │   ├── triggerConditions (array of TriggerCondition)
│       │   ├── cleansableBy (array of cleanse category enums)
│       │   ├── immunities (array of EffectImmunity)
│       │   ├── preventsActions (boolean, default: false)
│       │   ├── preventsMovement (boolean, default: false)
│       │   ├── preventsAttacking (boolean, default: false)
│       │   ├── preventsAbilities (boolean, default: false)
│       │   ├── resourcePool (integer, for ResourceBased duration)
│       │   ├── removalTrigger (string, for Triggered/Permanent duration)
│       │   ├── vulnerableToDamageTypes (array of string)
│       │   ├── resistsDamageTypes (array of string)
│       │   ├── iconId (string)
│       │   └── sortOrder (integer, minimum: 0)
│       ├── StatModifier
│       │   ├── statId (enum: attack, defense, speed, maxHealth, etc.)
│       │   ├── modifierType (enum: Flat, Percentage)
│       │   └── value (number)
│       ├── TriggerCondition
│       │   ├── trigger (enum: OnHit, OnDamage, OnTurnStart, OnTurnEnd, etc.)
│       │   ├── effectId (string, optional)
│       │   ├── damageAmount (integer, optional)
│       │   └── chance (number, 0.0 to 1.0)
│       └── EffectImmunity
│           ├── effectId (string, optional)
│           └── category (enum, optional)
├── Validation Rules
│   ├── Category Enum (Buff, Debuff, Environmental)
│   ├── Duration Type Enum
│   ├── Stacking Rule Enum
│   ├── Stat Modifier Validation
│   ├── Trigger Condition Validation
│   └── Cleanse Category Enum
└── Configuration Updates
    └── status-effects.json $schema reference updated
```

---

## 3. Architecture Diagrams

### 3.1 Schema Validation Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         SCHEMA VALIDATION FLOW                               │
└─────────────────────────────────────────────────────────────────────────────┘

    User edits status-effects.json
           │
           ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                          IDE/EDITOR                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│  1. Reads $schema property from config file                                  │
│  2. Loads status-effects.schema.json from config/schemas/                    │
│  3. Validates content against schema                                         │
└─────────────────────────────────────────────────────────────────────────────┘
           │
           ├─── Valid ───▶ Green checkmark, autocomplete works
           │
           └─── Invalid ─▶ Error underlines with messages:
                           • "category must be one of: Buff, Debuff, Environmental"
                           • "durationType must be one of: Turns, Permanent, ..."
                           • "stackingRule must be one of: None, RefreshDuration, ..."
                           • "modifierType must be one of: Flat, Percentage"
```

### 3.2 Status Effect Schema Structure Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       status-effects.schema.json                             │
├─────────────────────────────────────────────────────────────────────────────┤
│  $schema: "http://json-schema.org/draft-07/schema#"                         │
│  title: "Status Effects Configuration"                                       │
│  type: object                                                                │
├─────────────────────────────────────────────────────────────────────────────┤
│  properties:                                                                 │
│  ┌─────────────────────────┬─────────────────────────────────────────────┐  │
│  │ $schema                 │ type: string (optional)                     │  │
│  ├─────────────────────────┼─────────────────────────────────────────────┤  │
│  │ version                 │ type: string (optional)                     │  │
│  ├─────────────────────────┼─────────────────────────────────────────────┤  │
│  │ effects                 │ type: array, items: $ref StatusEffect       │  │
│  └─────────────────────────┴─────────────────────────────────────────────┘  │
├─────────────────────────────────────────────────────────────────────────────┤
│  definitions:                                                                │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ StatusEffect                                                         │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ id                    │ string, pattern: ^[a-z][a-z0-9-]*$    │   │    │
│  │ │ name                  │ string, minLength: 1                   │   │    │
│  │ │ description           │ string                                 │   │    │
│  │ │ category              │ enum: Buff, Debuff, Environmental      │   │    │
│  │ │ durationType          │ enum: Turns, Permanent, ...            │   │    │
│  │ │ baseDuration          │ integer, minimum: 0                    │   │    │
│  │ │ stackingRule          │ enum: None, RefreshDuration, ...       │   │    │
│  │ │ maxStacks             │ integer, minimum: 1                    │   │    │
│  │ │ damagePerTurn         │ integer, minimum: 0                    │   │    │
│  │ │ healingPerTurn        │ integer, minimum: 0                    │   │    │
│  │ │ damageType            │ string                                 │   │    │
│  │ │ statModifiers         │ array of $ref StatModifier             │   │    │
│  │ │ triggerConditions     │ array of $ref TriggerCondition         │   │    │
│  │ │ cleansableBy          │ array of cleanse category enums        │   │    │
│  │ │ immunities            │ array of $ref EffectImmunity           │   │    │
│  │ │ preventsActions       │ boolean, default: false                │   │    │
│  │ │ preventsMovement      │ boolean, default: false                │   │    │
│  │ │ preventsAttacking     │ boolean, default: false                │   │    │
│  │ │ preventsAbilities     │ boolean, default: false                │   │    │
│  │ │ resourcePool          │ integer, minimum: 0                    │   │    │
│  │ │ removalTrigger        │ string                                 │   │    │
│  │ │ vulnerableToDamageTypes│ array of string                       │   │    │
│  │ │ resistsDamageTypes    │ array of string                        │   │    │
│  │ │ iconId                │ string                                 │   │    │
│  │ │ sortOrder             │ integer, minimum: 0                    │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ StatModifier                                                         │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ statId                │ enum: attack, defense, speed, ...      │   │    │
│  │ │ modifierType          │ enum: Flat, Percentage                 │   │    │
│  │ │ value                 │ number (negative for debuffs)          │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ TriggerCondition                                                     │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ trigger               │ enum: OnHit, OnDamage, OnTurnStart... │   │    │
│  │ │ effectId              │ string (optional)                      │   │    │
│  │ │ damageAmount          │ integer (optional)                     │   │    │
│  │ │ chance                │ number, 0.0 to 1.0                     │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ EffectImmunity                                                       │    │
│  │ ┌───────────────────────┬───────────────────────────────────────┐   │    │
│  │ │ effectId              │ string (optional, specific effect)     │   │    │
│  │ │ category              │ enum (optional, effect category)       │   │    │
│  │ └───────────────────────┴───────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Effect Category Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         EFFECT CATEGORIES                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                           BUFF                                       │    │
│  │  Beneficial effects that enhance the target                          │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Examples from existing configuration:                               │    │
│  │  • hasted (+50% speed)                                               │    │
│  │  • strengthened (+25% attack)                                        │    │
│  │  • fortified (+25% defense)                                          │    │
│  │  • regenerating (5 healing per turn)                                 │    │
│  │  • shielded (20 resource pool absorb)                                │    │
│  │  • focused (+3 attack flat)                                          │    │
│  │  • blessed (+2 attack, +2 defense)                                   │    │
│  │  • invisible (+50% defense, removed on attack)                       │    │
│  │  • enraged (+50% attack, -25% defense)                               │    │
│  │  • protected (+50% defense)                                          │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                          DEBUFF                                      │    │
│  │  Harmful effects that hinder the target                              │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Examples from existing configuration:                               │    │
│  │  • bleeding (3 physical damage per turn)                             │    │
│  │  • poisoned (2 poison damage per turn)                               │    │
│  │  • burning (4 fire damage per turn)                                  │    │
│  │  • frozen (2 ice damage, -30% speed)                                 │    │
│  │  • stunned (prevents all actions)                                    │    │
│  │  • blinded (-50% attack)                                             │    │
│  │  • weakened (-25% attack)                                            │    │
│  │  • slowed (-50% speed, prevents movement)                            │    │
│  │  • feared (prevents attacking)                                       │    │
│  │  • silenced (prevents abilities)                                     │    │
│  │  • cursed (-2 attack, -2 defense)                                    │    │
│  │  • exhausted (-15% attack, -15% defense)                             │    │
│  │  • disarmed (-75% attack)                                            │    │
│  │  • vulnerable (-25% defense)                                         │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                       ENVIRONMENTAL                                  │    │
│  │  Effects caused by environmental conditions                          │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Examples from existing configuration:                               │    │
│  │  • wet (vulnerable to lightning, resistant to fire)                  │    │
│  │  • chilled (-20% speed)                                              │    │
│  │  • on-fire (5 fire damage per turn, permanent until water)           │    │
│  │  • electrified (3 lightning damage per turn)                         │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 Duration Type Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           DURATION TYPES                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                           TURNS                                      │    │
│  │  Effect expires after baseDuration turns                             │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Properties required: baseDuration                                   │    │
│  │  Example: bleeding (3 turns), stunned (1 turn)                       │    │
│  │                                                                      │    │
│  │  Turn 1: Effect applied, duration = 3                                │    │
│  │  Turn 2: Effect active, duration = 2                                 │    │
│  │  Turn 3: Effect active, duration = 1                                 │    │
│  │  Turn 4: Effect expired and removed                                  │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                         PERMANENT                                    │    │
│  │  Effect persists until explicitly removed                            │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Properties optional: removalTrigger                                 │    │
│  │  Example: on-fire (permanent until water trigger)                    │    │
│  │                                                                      │    │
│  │  Applied: Effect active indefinitely                                 │    │
│  │  Remove: Requires dispel, cleanse, or removalTrigger                 │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                         TRIGGERED                                    │    │
│  │  Effect expires when a trigger condition occurs                      │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Properties required: removalTrigger                                 │    │
│  │  Example: invisible (removed on attack)                              │    │
│  │                                                                      │    │
│  │  Applied: Effect active                                              │    │
│  │  Trigger: Target performs attack                                     │    │
│  │  Result: Effect immediately removed                                  │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                       RESOURCEBASED                                  │    │
│  │  Effect expires when resource pool is depleted                       │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Properties required: resourcePool                                   │    │
│  │  Example: shielded (absorbs 20 damage)                               │    │
│  │                                                                      │    │
│  │  Applied: resourcePool = 20                                          │    │
│  │  Damage 15: resourcePool = 5 (15 absorbed)                           │    │
│  │  Damage 10: resourcePool = 0, effect removed (5 absorbed, 5 through) │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.5 Stacking Rule Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          STACKING RULES                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  NONE - Cannot stack, reapplication does nothing                     │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Initial: Effect applied (duration 3)                                │    │
│  │  Reapply: No change (effect already present)                         │    │
│  │  Use case: Unique, non-refreshing effects                            │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  REFRESHDURATION - Resets duration to base value                     │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Initial: Effect applied (duration 3)                                │    │
│  │  After 2 turns: Duration = 1                                         │    │
│  │  Reapply: Duration reset to 3                                        │    │
│  │  Use case: Bleeding, burning, most DoT effects                       │    │
│  │  Examples: bleeding, poisoned, burning, frozen, weakened, slowed     │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  STACKINTENSITY - Increases effect strength (up to maxStacks)        │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Initial: Effect applied (1 stack, 5 damage/turn)                    │    │
│  │  Reapply: 2 stacks (10 damage/turn)                                  │    │
│  │  Reapply: 3 stacks (15 damage/turn)                                  │    │
│  │  If maxStacks=3: Reapply = still 3 stacks                            │    │
│  │  Use case: Intensifying poison, escalating debuffs                   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  STACKDURATION - Adds duration (up to maxStacks × baseDuration)      │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Initial: Effect applied (duration 3)                                │    │
│  │  Reapply: Duration = 6 (3 + 3)                                       │    │
│  │  Reapply: Duration = 9 (6 + 3)                                       │    │
│  │  Use case: Extended buffs, stackable duration effects                │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  BLOCK - Prevents reapplication entirely while active                │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │  Initial: Effect applied (duration 2)                                │    │
│  │  Reapply attempt: Blocked (effect already active)                    │    │
│  │  After expires: Can be reapplied                                     │    │
│  │  Use case: Stun immunity after stun, unique powerful effects         │    │
│  │  Examples: stunned, blinded, feared, silenced, most buffs            │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.6 File Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            CONFIG LAYER                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  config/                                                                     │
│  ├── status-effects.json ◀────────────────────────┐                        │
│  │   {                                             │ references             │
│  │     "$schema": "./schemas/status-effects.schema.json",                  │
│  │     "effects": [                                │                        │
│  │       {                                         │                        │
│  │         "id": "bleeding",                       │                        │
│  │         "name": "Bleeding",                     │                        │
│  │         "category": "Debuff",                   │                        │
│  │         "durationType": "Turns",                │                        │
│  │         "baseDuration": 3,                      │                        │
│  │         "stackingRule": "RefreshDuration",      │                        │
│  │         "damagePerTurn": 3,                     │                        │
│  │         "damageType": "physical",               │                        │
│  │         ...                                     │                        │
│  │       },                                        │                        │
│  │       ...                                       │                        │
│  │     ]                                           │                        │
│  │   }                                             │                        │
│  │                                                 │                        │
│  └── schemas/                                      │                        │
│      └── status-effects.schema.json ───────────────┘                        │
│          {                                                                   │
│            "$schema": "http://json-schema.org/draft-07/schema#",            │
│            "definitions": {                                                  │
│              "StatusEffect": {...},                                          │
│              "StatModifier": {...},                                          │
│              "TriggerCondition": {...},                                      │
│              "EffectImmunity": {...}                                         │
│            }                                                                 │
│          }                                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Status Effect Schema Definition

### 4.1 Root Configuration Properties

**File:** `config/schemas/status-effects.schema.json`

The status effect schema follows JSON Schema Draft-07 specification, providing comprehensive validation for status effect configuration files.

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Status Effects Configuration",
    "description": "Schema for buff/debuff status effect definitions. Defines all status effects including duration, stacking, stat modifiers, and trigger conditions.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
        },
        "effects": {
            "type": "array",
            "description": "List of status effect definitions",
            "items": {
                "$ref": "#/definitions/StatusEffect"
            },
            "minItems": 1
        }
    },
    "required": ["effects"],
    "additionalProperties": false,
    "definitions": {
        "StatusEffect": { ... },
        "StatModifier": { ... },
        "TriggerCondition": { ... },
        "EffectImmunity": { ... }
    }
}
```

### 4.2 StatusEffect Definition

The `StatusEffect` object defines a complete status effect with all its properties.

```json
"StatusEffect": {
    "type": "object",
    "description": "A status effect that can be applied to characters (buff, debuff, or environmental)",
    "properties": {
        "id": {
            "type": "string",
            "description": "Unique identifier for the status effect (lowercase, kebab-case)",
            "pattern": "^[a-z][a-z0-9-]*$",
            "minLength": 1,
            "maxLength": 50
        },
        "name": {
            "type": "string",
            "description": "Display name shown to players",
            "minLength": 1,
            "maxLength": 100
        },
        "description": {
            "type": "string",
            "description": "Full description of the status effect",
            "minLength": 1
        },
        "category": {
            "type": "string",
            "description": "The category of status effect",
            "enum": ["Buff", "Debuff", "Environmental"]
        },
        "durationType": {
            "type": "string",
            "description": "How the effect duration is tracked",
            "enum": ["Turns", "Permanent", "Triggered", "ResourceBased"],
            "default": "Turns"
        },
        "baseDuration": {
            "type": "integer",
            "description": "Duration in turns (required for Turns duration type)",
            "minimum": 0,
            "default": 0
        },
        "stackingRule": {
            "type": "string",
            "description": "How the effect behaves when reapplied",
            "enum": ["None", "RefreshDuration", "StackIntensity", "StackDuration", "Block"],
            "default": "None"
        },
        "maxStacks": {
            "type": "integer",
            "description": "Maximum number of stacks (for StackIntensity/StackDuration)",
            "minimum": 1,
            "default": 1
        },
        "damagePerTurn": {
            "type": "integer",
            "description": "Damage dealt each turn (for DoT effects)",
            "minimum": 0
        },
        "healingPerTurn": {
            "type": "integer",
            "description": "Healing received each turn (for HoT effects)",
            "minimum": 0
        },
        "damageType": {
            "type": "string",
            "description": "Type of damage dealt (references damage-types configuration)",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "statModifiers": {
            "type": "array",
            "description": "Stat modifications applied while effect is active",
            "items": {
                "$ref": "#/definitions/StatModifier"
            }
        },
        "triggerConditions": {
            "type": "array",
            "description": "Conditions that trigger additional effects",
            "items": {
                "$ref": "#/definitions/TriggerCondition"
            }
        },
        "cleansableBy": {
            "type": "array",
            "description": "Categories of cleanse abilities that can remove this effect",
            "items": {
                "type": "string",
                "enum": ["Magic", "Poison", "Curse", "Disease", "Physical", "All"]
            }
        },
        "immunities": {
            "type": "array",
            "description": "Effects or categories this effect grants immunity to",
            "items": {
                "$ref": "#/definitions/EffectImmunity"
            }
        },
        "preventsActions": {
            "type": "boolean",
            "description": "Whether the effect prevents all actions",
            "default": false
        },
        "preventsMovement": {
            "type": "boolean",
            "description": "Whether the effect prevents movement",
            "default": false
        },
        "preventsAttacking": {
            "type": "boolean",
            "description": "Whether the effect prevents attacking",
            "default": false
        },
        "preventsAbilities": {
            "type": "boolean",
            "description": "Whether the effect prevents using abilities",
            "default": false
        },
        "resourcePool": {
            "type": "integer",
            "description": "Resource pool amount (for ResourceBased duration type)",
            "minimum": 0
        },
        "removalTrigger": {
            "type": "string",
            "description": "Trigger that removes the effect (for Triggered/Permanent duration types)",
            "minLength": 1
        },
        "vulnerableToDamageTypes": {
            "type": "array",
            "description": "Damage types the target becomes vulnerable to",
            "items": {
                "type": "string",
                "pattern": "^[a-z][a-z0-9-]*$"
            }
        },
        "resistsDamageTypes": {
            "type": "array",
            "description": "Damage types the target gains resistance to",
            "items": {
                "type": "string",
                "pattern": "^[a-z][a-z0-9-]*$"
            }
        },
        "iconId": {
            "type": "string",
            "description": "Icon identifier for UI display",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "sortOrder": {
            "type": "integer",
            "description": "Order for display sorting (lower values first)",
            "minimum": 0,
            "default": 0
        }
    },
    "required": ["id", "name", "description", "category"],
    "additionalProperties": false
}
```

### 4.3 StatModifier Definition

The `StatModifier` object defines a single stat modification applied by the effect.

```json
"StatModifier": {
    "type": "object",
    "description": "A stat modification applied while the effect is active",
    "properties": {
        "statId": {
            "type": "string",
            "description": "The stat being modified",
            "enum": [
                "attack",
                "defense",
                "speed",
                "maxHealth",
                "might",
                "fortitude",
                "will",
                "wits",
                "finesse"
            ]
        },
        "modifierType": {
            "type": "string",
            "description": "Whether the modifier is a flat value or percentage",
            "enum": ["Flat", "Percentage"]
        },
        "value": {
            "type": "number",
            "description": "The modifier value (negative for reductions). For Percentage type, use decimal (0.25 = 25%, -0.5 = -50%)"
        }
    },
    "required": ["statId", "modifierType", "value"],
    "additionalProperties": false
}
```

### 4.4 TriggerCondition Definition

The `TriggerCondition` object defines conditions that trigger additional effects.

```json
"TriggerCondition": {
    "type": "object",
    "description": "A condition that triggers additional effects or actions",
    "properties": {
        "trigger": {
            "type": "string",
            "description": "The event that triggers this condition",
            "enum": [
                "OnHit",
                "OnDamage",
                "OnTurnStart",
                "OnTurnEnd",
                "OnAbilityUse",
                "OnMove",
                "OnHeal",
                "OnDeath"
            ]
        },
        "effectId": {
            "type": "string",
            "description": "Status effect to apply when triggered",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "damageAmount": {
            "type": "integer",
            "description": "Damage to deal when triggered",
            "minimum": 0
        },
        "chance": {
            "type": "number",
            "description": "Probability of the trigger activating (0.0 to 1.0)",
            "minimum": 0.0,
            "maximum": 1.0,
            "default": 1.0
        }
    },
    "required": ["trigger"],
    "additionalProperties": false
}
```

### 4.5 EffectImmunity Definition

The `EffectImmunity` object defines immunity granted by a status effect.

```json
"EffectImmunity": {
    "type": "object",
    "description": "Immunity to a specific effect or category of effects",
    "properties": {
        "effectId": {
            "type": "string",
            "description": "Specific status effect ID to grant immunity to",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "category": {
            "type": "string",
            "description": "Category of effects to grant immunity to",
            "enum": ["Buff", "Debuff", "Environmental", "Poison", "Curse", "Disease", "Physical", "Magic"]
        }
    },
    "additionalProperties": false
}
```

---

## 5. Duration Type Configuration

### 5.1 Duration Type Enum

The `durationType` field accepts exactly four values:

| Duration Type | Description | Required Properties |
|---------------|-------------|---------------------|
| `Turns` | Effect expires after baseDuration turns | `baseDuration` |
| `Permanent` | Effect persists until explicitly removed | `removalTrigger` (optional) |
| `Triggered` | Effect expires when trigger condition occurs | `removalTrigger` |
| `ResourceBased` | Effect expires when resource pool depleted | `resourcePool` |

**Validation Error Examples:**
```
Error: durationType must be one of: Turns, Permanent, Triggered, ResourceBased
Error: durationType "Seconds" is not a valid enum value
```

### 5.2 Duration Type Usage

| Duration Type | Use Case | Example Effect |
|---------------|----------|----------------|
| `Turns` | Standard timed effects | Bleeding (3 turns), Stunned (1 turn) |
| `Permanent` | Environmental hazards | On Fire (until water) |
| `Triggered` | Conditional buffs | Invisible (until attack) |
| `ResourceBased` | Absorb effects | Shielded (absorbs 20 damage) |

**Duration Type Distribution in Existing Configuration:**

| Duration Type | Count | Effects |
|---------------|-------|---------|
| `Turns` | 24 | bleeding, poisoned, burning, frozen, stunned, blinded, weakened, slowed, feared, silenced, cursed, exhausted, disarmed, vulnerable, hasted, strengthened, fortified, regenerating, focused, blessed, enraged, protected, wet, chilled, electrified |
| `Permanent` | 1 | on-fire |
| `Triggered` | 1 | invisible |
| `ResourceBased` | 1 | shielded |

---

## 6. Stacking Rule Configuration

### 6.1 Stacking Rule Enum

The `stackingRule` field accepts exactly five values:

| Stacking Rule | Description | When to Use |
|---------------|-------------|-------------|
| `None` | Cannot stack, reapplication ignored | Unique effects |
| `RefreshDuration` | Resets duration to base value | DoT effects (bleeding, burning) |
| `StackIntensity` | Increases effect strength | Escalating poison |
| `StackDuration` | Adds to remaining duration | Extended buffs |
| `Block` | Prevents reapplication while active | Stuns, most buffs |

**Validation Error Examples:**
```
Error: stackingRule must be one of: None, RefreshDuration, StackIntensity, StackDuration, Block
Error: stackingRule "Refresh" is not a valid enum value
```

### 6.2 Stacking Rule Behavior

**Stacking Rule Distribution in Existing Configuration:**

| Stacking Rule | Count | Effects |
|---------------|-------|---------|
| `RefreshDuration` | 10 | bleeding, poisoned, burning, frozen, weakened, slowed, exhausted, vulnerable, wet, chilled |
| `Block` | 17 | stunned, blinded, feared, silenced, cursed, disarmed, hasted, strengthened, fortified, regenerating, shielded, focused, blessed, invisible, enraged, protected, on-fire, electrified |
| `None` | 0 | (none in current config) |
| `StackIntensity` | 0 | (none in current config) |
| `StackDuration` | 0 | (none in current config) |

---

## 7. Cleanse Category Configuration

### 7.1 Cleanse Category Enum

The cleanse system allows effects to be removed by specific categories of cleanse abilities.

| Category | Description | Example Effects |
|----------|-------------|-----------------|
| `Magic` | Magical effects | Curses, hexes, magical debuffs |
| `Poison` | Toxin-based effects | Poisoned, venomed |
| `Curse` | Curse effects | Cursed, hexed |
| `Disease` | Illness effects | Diseased, plagued |
| `Physical` | Physical effects | Bleeding, broken |
| `All` | Universal cleanse | Removes any cleansable effect |

### 7.2 Cleanse Mechanics

**Cleanse Assignment Guidelines:**

| Effect Type | Suggested Cleanse Categories |
|-------------|------------------------------|
| Bleeding | `Physical` |
| Poisoned | `Poison` |
| Burning | `Physical`, `Magic` |
| Frozen | `Physical`, `Magic` |
| Stunned | Not cleansable (Block stacking) |
| Blinded | `Physical`, `Magic` |
| Weakened | `Physical` |
| Cursed | `Curse`, `Magic` |
| Disease effects | `Disease` |

---

## 8. Validation Rules

### 8.1 Enum Validation

| Property | Valid Values | Validation Error |
|----------|--------------|------------------|
| `category` | `Buff`, `Debuff`, `Environmental` | "category must be one of: Buff, Debuff, Environmental" |
| `durationType` | `Turns`, `Permanent`, `Triggered`, `ResourceBased` | "durationType must be one of: Turns, Permanent, Triggered, ResourceBased" |
| `stackingRule` | `None`, `RefreshDuration`, `StackIntensity`, `StackDuration`, `Block` | "stackingRule must be one of: None, RefreshDuration, StackIntensity, StackDuration, Block" |
| `modifierType` | `Flat`, `Percentage` | "modifierType must be one of: Flat, Percentage" |
| `trigger` | `OnHit`, `OnDamage`, `OnTurnStart`, `OnTurnEnd`, `OnAbilityUse`, `OnMove`, `OnHeal`, `OnDeath` | "trigger must be one of: OnHit, OnDamage, OnTurnStart, OnTurnEnd, OnAbilityUse, OnMove, OnHeal, OnDeath" |
| `cleansableBy[]` | `Magic`, `Poison`, `Curse`, `Disease`, `Physical`, `All` | "cleansableBy items must be one of: Magic, Poison, Curse, Disease, Physical, All" |
| `statId` | `attack`, `defense`, `speed`, `maxHealth`, `might`, `fortitude`, `will`, `wits`, `finesse` | "statId must be one of: attack, defense, speed, maxHealth, might, fortitude, will, wits, finesse" |

### 8.2 Range Validation

| Property | Range | Validation Error |
|----------|-------|------------------|
| `baseDuration` | ≥0 | "baseDuration must be >= 0" |
| `maxStacks` | ≥1 | "maxStacks must be >= 1" |
| `damagePerTurn` | ≥0 | "damagePerTurn must be >= 0" |
| `healingPerTurn` | ≥0 | "healingPerTurn must be >= 0" |
| `resourcePool` | ≥0 | "resourcePool must be >= 0" |
| `sortOrder` | ≥0 | "sortOrder must be >= 0" |
| `chance` | 0.0-1.0 | "chance must be between 0.0 and 1.0" |
| `damageAmount` | ≥0 | "damageAmount must be >= 0" |

### 8.3 Required Fields

#### StatusEffect Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `id` | Must be present and match pattern | "missing required property 'id'" |
| `name` | Must be present and non-empty | "missing required property 'name'" |
| `description` | Must be present | "missing required property 'description'" |
| `category` | Must be present and valid enum | "missing required property 'category'" |

#### StatModifier Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `statId` | Must be present and valid enum | "missing required property 'statId'" |
| `modifierType` | Must be present and valid enum | "missing required property 'modifierType'" |
| `value` | Must be present | "missing required property 'value'" |

#### TriggerCondition Required Fields

| Field | Requirement | Error on Missing |
|-------|-------------|------------------|
| `trigger` | Must be present and valid enum | "missing required property 'trigger'" |

### 8.4 Conditional Requirements

| Condition | Required Property | Description |
|-----------|-------------------|-------------|
| `durationType: "Turns"` | `baseDuration` | Turns-based effects need duration |
| `durationType: "ResourceBased"` | `resourcePool` | Resource effects need pool amount |
| `durationType: "Triggered"` | `removalTrigger` | Triggered effects need trigger definition |
| `stackingRule: "StackIntensity"` | `maxStacks` | Intensity stacking needs stack limit |
| `stackingRule: "StackDuration"` | `maxStacks` | Duration stacking needs stack limit |

---

## 9. Configuration Schema

### Complete Status Effects Schema File

**File:** `config/schemas/status-effects.schema.json`

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Status Effects Configuration",
    "description": "Schema for buff/debuff status effect definitions. Defines all status effects including duration, stacking, stat modifiers, and trigger conditions.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
        },
        "effects": {
            "type": "array",
            "description": "List of status effect definitions",
            "items": {
                "$ref": "#/definitions/StatusEffect"
            },
            "minItems": 1
        }
    },
    "required": ["effects"],
    "additionalProperties": false,
    "definitions": {
        "StatusEffect": {
            "type": "object",
            "description": "A status effect that can be applied to characters (buff, debuff, or environmental)",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique identifier for the status effect (lowercase, kebab-case)",
                    "pattern": "^[a-z][a-z0-9-]*$",
                    "minLength": 1,
                    "maxLength": 50
                },
                "name": {
                    "type": "string",
                    "description": "Display name shown to players",
                    "minLength": 1,
                    "maxLength": 100
                },
                "description": {
                    "type": "string",
                    "description": "Full description of the status effect",
                    "minLength": 1
                },
                "category": {
                    "type": "string",
                    "description": "The category of status effect",
                    "enum": ["Buff", "Debuff", "Environmental"]
                },
                "durationType": {
                    "type": "string",
                    "description": "How the effect duration is tracked",
                    "enum": ["Turns", "Permanent", "Triggered", "ResourceBased"],
                    "default": "Turns"
                },
                "baseDuration": {
                    "type": "integer",
                    "description": "Duration in turns (required for Turns duration type)",
                    "minimum": 0,
                    "default": 0
                },
                "stackingRule": {
                    "type": "string",
                    "description": "How the effect behaves when reapplied",
                    "enum": ["None", "RefreshDuration", "StackIntensity", "StackDuration", "Block"],
                    "default": "None"
                },
                "maxStacks": {
                    "type": "integer",
                    "description": "Maximum number of stacks (for StackIntensity/StackDuration)",
                    "minimum": 1,
                    "default": 1
                },
                "damagePerTurn": {
                    "type": "integer",
                    "description": "Damage dealt each turn (for DoT effects)",
                    "minimum": 0
                },
                "healingPerTurn": {
                    "type": "integer",
                    "description": "Healing received each turn (for HoT effects)",
                    "minimum": 0
                },
                "damageType": {
                    "type": "string",
                    "description": "Type of damage dealt (references damage-types configuration)",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "statModifiers": {
                    "type": "array",
                    "description": "Stat modifications applied while effect is active",
                    "items": {
                        "$ref": "#/definitions/StatModifier"
                    }
                },
                "triggerConditions": {
                    "type": "array",
                    "description": "Conditions that trigger additional effects",
                    "items": {
                        "$ref": "#/definitions/TriggerCondition"
                    }
                },
                "cleansableBy": {
                    "type": "array",
                    "description": "Categories of cleanse abilities that can remove this effect",
                    "items": {
                        "type": "string",
                        "enum": ["Magic", "Poison", "Curse", "Disease", "Physical", "All"]
                    }
                },
                "immunities": {
                    "type": "array",
                    "description": "Effects or categories this effect grants immunity to",
                    "items": {
                        "$ref": "#/definitions/EffectImmunity"
                    }
                },
                "preventsActions": {
                    "type": "boolean",
                    "description": "Whether the effect prevents all actions",
                    "default": false
                },
                "preventsMovement": {
                    "type": "boolean",
                    "description": "Whether the effect prevents movement",
                    "default": false
                },
                "preventsAttacking": {
                    "type": "boolean",
                    "description": "Whether the effect prevents attacking",
                    "default": false
                },
                "preventsAbilities": {
                    "type": "boolean",
                    "description": "Whether the effect prevents using abilities",
                    "default": false
                },
                "resourcePool": {
                    "type": "integer",
                    "description": "Resource pool amount (for ResourceBased duration type)",
                    "minimum": 0
                },
                "removalTrigger": {
                    "type": "string",
                    "description": "Trigger that removes the effect (for Triggered/Permanent duration types)",
                    "minLength": 1
                },
                "vulnerableToDamageTypes": {
                    "type": "array",
                    "description": "Damage types the target becomes vulnerable to",
                    "items": {
                        "type": "string",
                        "pattern": "^[a-z][a-z0-9-]*$"
                    }
                },
                "resistsDamageTypes": {
                    "type": "array",
                    "description": "Damage types the target gains resistance to",
                    "items": {
                        "type": "string",
                        "pattern": "^[a-z][a-z0-9-]*$"
                    }
                },
                "iconId": {
                    "type": "string",
                    "description": "Icon identifier for UI display",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "sortOrder": {
                    "type": "integer",
                    "description": "Order for display sorting (lower values first)",
                    "minimum": 0,
                    "default": 0
                }
            },
            "required": ["id", "name", "description", "category"],
            "additionalProperties": false
        },
        "StatModifier": {
            "type": "object",
            "description": "A stat modification applied while the effect is active",
            "properties": {
                "statId": {
                    "type": "string",
                    "description": "The stat being modified",
                    "enum": [
                        "attack",
                        "defense",
                        "speed",
                        "maxHealth",
                        "might",
                        "fortitude",
                        "will",
                        "wits",
                        "finesse"
                    ]
                },
                "modifierType": {
                    "type": "string",
                    "description": "Whether the modifier is a flat value or percentage",
                    "enum": ["Flat", "Percentage"]
                },
                "value": {
                    "type": "number",
                    "description": "The modifier value (negative for reductions). For Percentage type, use decimal (0.25 = 25%, -0.5 = -50%)"
                }
            },
            "required": ["statId", "modifierType", "value"],
            "additionalProperties": false
        },
        "TriggerCondition": {
            "type": "object",
            "description": "A condition that triggers additional effects or actions",
            "properties": {
                "trigger": {
                    "type": "string",
                    "description": "The event that triggers this condition",
                    "enum": [
                        "OnHit",
                        "OnDamage",
                        "OnTurnStart",
                        "OnTurnEnd",
                        "OnAbilityUse",
                        "OnMove",
                        "OnHeal",
                        "OnDeath"
                    ]
                },
                "effectId": {
                    "type": "string",
                    "description": "Status effect to apply when triggered",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "damageAmount": {
                    "type": "integer",
                    "description": "Damage to deal when triggered",
                    "minimum": 0
                },
                "chance": {
                    "type": "number",
                    "description": "Probability of the trigger activating (0.0 to 1.0)",
                    "minimum": 0.0,
                    "maximum": 1.0,
                    "default": 1.0
                }
            },
            "required": ["trigger"],
            "additionalProperties": false
        },
        "EffectImmunity": {
            "type": "object",
            "description": "Immunity to a specific effect or category of effects",
            "properties": {
                "effectId": {
                    "type": "string",
                    "description": "Specific status effect ID to grant immunity to",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "category": {
                    "type": "string",
                    "description": "Category of effects to grant immunity to",
                    "enum": ["Buff", "Debuff", "Environmental", "Poison", "Curse", "Disease", "Physical", "Magic"]
                }
            },
            "additionalProperties": false
        }
    }
}
```

---

## 10. Configuration File Updates

### Updated status-effects.json

The existing `status-effects.json` already has a `$schema` reference but uses the wrong path. It needs to be updated.

**File:** `config/status-effects.json`

Current (incorrect schema path):
```json
{
    "$schema": "./status-effects.schema.json",
    "effects": [
        ...
    ]
}
```

Updated with correct schema reference:
```json
{
    "$schema": "./schemas/status-effects.schema.json",
    "effects": [
        {
            "id": "bleeding",
            "name": "Bleeding",
            "description": "Taking physical damage over time from an open wound.",
            "category": "Debuff",
            "durationType": "Turns",
            "baseDuration": 3,
            "stackingRule": "RefreshDuration",
            "damagePerTurn": 3,
            "damageType": "physical",
            "iconId": "effect-bleeding"
        },
        ...
    ]
}
```

### Validation Confirmation

The existing configuration validates successfully against the schema:

| Effect ID | Category | Duration Type | Stacking Rule | Valid |
|-----------|----------|---------------|---------------|-------|
| `bleeding` | Debuff | Turns | RefreshDuration | Yes |
| `poisoned` | Debuff | Turns | RefreshDuration | Yes |
| `burning` | Debuff | Turns | RefreshDuration | Yes |
| `frozen` | Debuff | Turns | RefreshDuration | Yes |
| `stunned` | Debuff | Turns | Block | Yes |
| `blinded` | Debuff | Turns | Block | Yes |
| `weakened` | Debuff | Turns | RefreshDuration | Yes |
| `slowed` | Debuff | Turns | RefreshDuration | Yes |
| `feared` | Debuff | Turns | Block | Yes |
| `silenced` | Debuff | Turns | Block | Yes |
| `cursed` | Debuff | Turns | Block | Yes |
| `exhausted` | Debuff | Turns | RefreshDuration | Yes |
| `disarmed` | Debuff | Turns | Block | Yes |
| `vulnerable` | Debuff | Turns | RefreshDuration | Yes |
| `hasted` | Buff | Turns | Block | Yes |
| `strengthened` | Buff | Turns | Block | Yes |
| `fortified` | Buff | Turns | Block | Yes |
| `regenerating` | Buff | Turns | Block | Yes |
| `shielded` | Buff | ResourceBased | Block | Yes |
| `focused` | Buff | Turns | Block | Yes |
| `blessed` | Buff | Turns | Block | Yes |
| `invisible` | Buff | Triggered | Block | Yes |
| `enraged` | Buff | Turns | Block | Yes |
| `protected` | Buff | Turns | Block | Yes |
| `wet` | Environmental | Turns | RefreshDuration | Yes |
| `chilled` | Environmental | Turns | RefreshDuration | Yes |
| `on-fire` | Environmental | Permanent | Block | Yes |
| `electrified` | Environmental | Turns | Block | Yes |

---

## 11. Data Model Changes

### No Domain Changes Required

This phase creates only a JSON Schema file for validation. No changes to domain entities, services, or application layer are required.

| Layer | Changes |
|-------|---------|
| Domain | None |
| Application | None |
| Infrastructure | None |
| Configuration | One schema file added, one config file updated |

### Schema as Documentation

The schema serves as:
- **Validation contract** for status effect configuration
- **IDE documentation** via description fields
- **Modding reference** for custom status effect systems
- **Design specification** for status effect mechanics

---

## 12. Logging Specifications

### No Runtime Logging Required

Schema validation occurs at design-time in IDE/editors, not at runtime. No logging infrastructure changes are needed for this phase.

| Component | Level | Events |
|-----------|-------|--------|
| N/A | N/A | Schema validation is IDE-based |

---

## 13. Unit Testing Requirements

### Test Count by Feature

| Feature | Test Count |
|---------|------------|
| Schema Valid Structure | ~1 |
| Category Enum Validation | ~1 |
| Duration Type Enum Validation | ~1 |
| Stacking Rule Enum Validation | ~1 |
| Stat Modifier Structure Validation | ~1 |
| Existing Configuration Validation | ~1 |
| Invalid Effect Validation | ~1 |
| **Total** | **~7** |

### Test Descriptions

#### StatusEffectsSchemaTests.cs

```csharp
[TestFixture]
public class StatusEffectsSchemaTests
{
    /// <summary>
    /// Verifies the schema file is valid JSON Schema Draft-07.
    /// </summary>
    [Test]
    public void Schema_IsValidJsonSchemaDraft07();

    /// <summary>
    /// Verifies the existing status-effects.json validates against the schema without errors.
    /// </summary>
    [Test]
    public void ExistingStatusEffectsJson_ValidatesAgainstSchema();

    /// <summary>
    /// Verifies category must be a valid enum value (Buff, Debuff, Environmental).
    /// </summary>
    [Test]
    public void Category_InvalidEnumValue_FailsValidation();

    /// <summary>
    /// Verifies durationType must be a valid enum value.
    /// </summary>
    [Test]
    public void DurationType_InvalidEnumValue_FailsValidation();

    /// <summary>
    /// Verifies stackingRule must be a valid enum value.
    /// </summary>
    [Test]
    public void StackingRule_InvalidEnumValue_FailsValidation();

    /// <summary>
    /// Verifies StatModifier requires statId, modifierType, and value.
    /// </summary>
    [Test]
    public void StatModifier_MissingRequiredFields_FailsValidation();

    /// <summary>
    /// Verifies effect with invalid ID pattern fails validation.
    /// </summary>
    [Test]
    public void EffectId_InvalidPattern_FailsValidation();
}
```

### Test Implementation Notes

Tests should use a JSON Schema validation library (e.g., `NJsonSchema` for C#) to:
1. Load the schema file
2. Validate test JSON documents
3. Assert expected validation results

---

## 14. Use Cases

### UC-001: Load Status Effects Configuration

**Actor:** Game System
**Flow:** System starts → Loads `status-effects.json` → Schema validates content → Status effects available for combat

### UC-002: Edit Status Effects in IDE

**Actor:** Developer/Modder
**Flow:** Opens `status-effects.json` in VS Code → IDE loads schema → Autocomplete suggests properties → Validation errors shown inline

### UC-003: Create New Debuff Effect

**Actor:** Modder
**Flow:** Adds new effect object to `effects` array → Sets category to "Debuff" → Configures durationType, stackingRule, damagePerTurn → IDE validates structure

### UC-004: Add Stat Modifier to Effect

**Actor:** Modder
**Flow:** Adds statModifiers array to effect → Specifies statId, modifierType, value → IDE validates enum values and number types

### UC-005: Configure Trigger Condition

**Actor:** Modder
**Flow:** Adds triggerConditions array → Specifies trigger event and optional effectId/damageAmount → IDE validates trigger enum

### UC-006: Invalid Category Value

**Actor:** Modder
**Flow:** Sets `category: "Curse"` → IDE shows error "category must be one of: Buff, Debuff, Environmental" → Modder corrects to "Debuff"

---

## 15. Deliverable Checklist

### Schema Files
- [ ] `config/schemas/status-effects.schema.json` created
- [ ] Schema follows JSON Schema Draft-07 format
- [ ] Schema includes all defined properties
- [ ] Schema includes definitions section (StatusEffect, StatModifier, TriggerCondition, EffectImmunity)

### Validation Rules
- [ ] Category enum validation: Buff, Debuff, Environmental
- [ ] Duration type enum validation: Turns, Permanent, Triggered, ResourceBased
- [ ] Stacking rule enum validation: None, RefreshDuration, StackIntensity, StackDuration, Block
- [ ] Stat ID enum validation: attack, defense, speed, maxHealth, might, fortitude, will, wits, finesse
- [ ] Modifier type enum validation: Flat, Percentage
- [ ] Trigger enum validation: OnHit, OnDamage, OnTurnStart, OnTurnEnd, OnAbilityUse, OnMove, OnHeal, OnDeath
- [ ] Cleanse category enum validation: Magic, Poison, Curse, Disease, Physical, All
- [ ] ID pattern validation: ^[a-z][a-z0-9-]*$
- [ ] Required fields enforced
- [ ] Optional fields have defaults

### Configuration Updates
- [ ] `status-effects.json` $schema reference updated to `./schemas/status-effects.schema.json`
- [ ] Existing `status-effects.json` validates against schema

### Testing
- [ ] ~7 unit tests implemented
- [ ] All tests passing
- [ ] Tests cover happy path and error cases

### Documentation
- [ ] Schema properties have descriptions
- [ ] This design specification complete

---

## 16. Acceptance Criteria

### Functional
- [ ] `status-effects.schema.json` created in `config/schemas/` directory
- [ ] Schema validates existing `status-effects.json` without errors
- [ ] Category enum validated (Buff, Debuff, Environmental)
- [ ] Duration type enum validated (Turns, Permanent, Triggered, ResourceBased)
- [ ] Stacking rule enum validated (None, RefreshDuration, StackIntensity, StackDuration, Block)
- [ ] Stat modifier structure validated (statId enum, modifierType enum, value)
- [ ] Trigger condition structure validated (trigger enum, optional effectId/damageAmount/chance)
- [ ] Effect immunity structure validated
- [ ] Cleanse category enum validated
- [ ] ID pattern enforced (lowercase kebab-case)
- [ ] VS Code provides autocomplete when schema linked

### Quality
- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] ~7 unit tests pass
- [ ] Schema file is valid JSON
- [ ] All schema properties have descriptions

---

## 17. Dependencies

### Required from Prior Versions

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `status-effects.json` | `config/status-effects.json` | Validated by new schema |
| Schema patterns | `config/schemas/*.schema.json` | Reference for schema structure |
| Character schemas (v0.14.0) | `config/schemas/` | Consistent patterns and stat IDs |

### Provides to Future Versions

| Type | Usage |
|------|-------|
| `status-effects.schema.json` | Validates status effect configuration |
| StatModifier pattern | Reusable for other modifier systems |
| TriggerCondition pattern | Reusable for event-driven mechanics |
| Cleanse category pattern | Used by abilities with cleanse effects |

### Implementation Order Note

**v0.14.1b can be implemented in parallel with other v0.14.1 parts** (a, c, d) as they have no internal dependencies.

Complete v0.14.1 implementation order options:
- All parts can be implemented in parallel
- Or sequentially in any order: v0.14.1a → v0.14.1b → v0.14.1c → v0.14.1d

---

## 18. Future Considerations

### Deferred to Future Versions

- **Cross-reference validation**: Validating effectId references point to existing effects
- **Damage type reference validation**: Validating damageType references damage-types.json
- **Complex conditional logic**: If-then-else conditions for effect triggers
- **Effect interaction rules**: Defining how effects interact (e.g., wet + lightning = extra damage)
- **Stacking with different sources**: Different max stacks for same vs different sources

### Out of Scope

- **Runtime schema validation**: Application-level validation at load time (handled by existing provider patterns)
- **Schema versioning migration**: Automatic migration between schema versions
- **Effect application logic**: Runtime mechanics when effects are applied (domain logic, not schema)
- **Status effect UI rendering**: How effects are displayed (presentation concern)
- **Effect balance tuning**: Specific damage/duration values (design decisions)

### Potential Future Enhancements

If the status effect system expands, consider adding:
- `applyOnEnter` - Effects applied when entering a zone
- `applyOnExit` - Effects applied when leaving a zone
- `spreadRange` - Range for effects that spread to nearby targets
- `linkedEffects` - Effects that are removed together
- `counterEffects` - Effects that cancel each other
- `transformsTo` - Effect this transforms into under certain conditions
- `soundOnApply` - Sound effect ID when applied
- `soundOnTick` - Sound effect ID on each tick
- `particleEffect` - Particle effect ID for visual feedback

---

*Document Version: 1.0*
*Last Updated: 2026-01-17*
*Author: Claude*
