# v0.14.10 Game Systems Configuration Schemas - Scope Breakdown

**Version:** 0.14.10
**Theme:** Game Systems Configuration Schemas
**Prerequisites:** v0.14.9 Complete (Advanced Descriptor Configuration Schemas)
**Total Estimated Tests:** ~36 new tests

---

## Executive Summary

The Game Systems Configuration Schemas version creates comprehensive JSON schemas for core game systems that were not addressed in earlier v0.14.x versions: factions, quests, codex entries, command syntax, glossary terms, and combat stances. These schemas complete the configuration infrastructure needed for full game customization without code changes.

The work is divided into **six sub-parts**:

| Part | Name | Focus | Est. Tests |
|------|------|-------|------------|
| v0.14.10a | Faction Schema | factions.schema.json with reputation, relationships, perks | ~6 |
| v0.14.10b | Quest Schema | quests.schema.json with objectives, stages, rewards | ~6 |
| v0.14.10c | Codex Schema | codex.schema.json with entries, categories, unlock conditions | ~6 |
| v0.14.10d | Command Schema | commands.schema.json with syntax, aliases, argument patterns | ~6 |
| v0.14.10e | Glossary Schema | glossary.schema.json with terms, definitions, cross-references | ~6 |
| v0.14.10f | Combat Stance Schema | stances.schema.json with modifiers, restrictions, switching rules | ~6 |

---

## Feature Analysis & Categorization

### Faction Configuration

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| factions.schema.json | High | None | **v0.14.10a** |
| Faction definitions | Medium | factions.schema.json | **v0.14.10a** |
| Reputation thresholds | Medium | factions.schema.json | **v0.14.10a** |
| Inter-faction relationships | Medium | factions.schema.json | **v0.14.10a** |
| Reputation rewards/penalties | Medium | factions.schema.json | **v0.14.10a** |
| Faction perks | Low | factions.schema.json | **v0.14.10a** |

### Quest Configuration

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| quests.schema.json | High | factions.schema.json | **v0.14.10b** |
| Quest definitions | Medium | quests.schema.json | **v0.14.10b** |
| Objective types | Medium | quests.schema.json | **v0.14.10b** |
| Quest stages/phases | Medium | quests.schema.json | **v0.14.10b** |
| Reward definitions | Medium | quests.schema.json | **v0.14.10b** |
| Prerequisites and branching | Medium | quests.schema.json | **v0.14.10b** |

### Codex Configuration

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| codex.schema.json | Medium | capture-templates.schema.json | **v0.14.10c** |
| Entry definitions | Medium | codex.schema.json | **v0.14.10c** |
| Category classification | Low | codex.schema.json | **v0.14.10c** |
| Unlock conditions | Medium | codex.schema.json | **v0.14.10c** |
| Keyword matching | Low | codex.schema.json | **v0.14.10c** |
| Progression tracking | Low | codex.schema.json | **v0.14.10c** |

### Command Configuration

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| commands.schema.json | Medium | None | **v0.14.10d** |
| Command definitions | Medium | commands.schema.json | **v0.14.10d** |
| Alias mappings | Low | commands.schema.json | **v0.14.10d** |
| Argument patterns | Medium | commands.schema.json | **v0.14.10d** |
| Context rules | Medium | commands.schema.json | **v0.14.10d** |
| Help text | Low | commands.schema.json | **v0.14.10d** |

### Glossary Configuration

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| glossary.schema.json | Low | None | **v0.14.10e** |
| Term definitions | Low | glossary.schema.json | **v0.14.10e** |
| Category classification | Low | glossary.schema.json | **v0.14.10e** |
| Cross-references | Low | glossary.schema.json | **v0.14.10e** |
| Display rules | Low | glossary.schema.json | **v0.14.10e** |

### Combat Stance Configuration

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| stances.schema.json | Medium | combat.schema.json | **v0.14.10f** |
| Stance definitions | Medium | stances.schema.json | **v0.14.10f** |
| Stat modifiers | Low | stances.schema.json | **v0.14.10f** |
| Ability restrictions | Medium | stances.schema.json | **v0.14.10f** |
| Switching rules | Low | stances.schema.json | **v0.14.10f** |
| AI behavior patterns | Low | stances.schema.json | **v0.14.10f** |

---

## Existing Infrastructure

### Cross-System References

These schemas integrate with systems defined in earlier v0.14.x versions:

| System | Reference Point | Integration |
|--------|-----------------|-------------|
| **Dialogue** (v0.14.9a) | `AffectedFaction` in outcomes | Factions referenced by dialogue |
| **Dialogue** (v0.14.9a) | `QuestUpdate` outcome type | Quests updated via dialogue |
| **Capture Templates** (v0.14.9e) | `matchKeywords` | Codex entries matched by captures |
| **Combat** (v0.14.1) | `combat.schema.json` | Stances modify combat rules |
| **Abilities** (v0.14.1) | `abilities.schema.json` | Stances restrict/grant abilities |

### Current Faction Usage (from dialogue files)

```json
{
  "Outcome": {
    "Type": "ReputationChange",
    "Data": "Successfully negotiated with Bjorn",
    "ReputationChange": 10,
    "AffectedFaction": "RustClans"
  }
}
```

Known faction references in existing content:
- `RustClans` - Exile raiders and scavengers
- `MidgardCombine` - Industrial faction
- `Seidkona` - Magic practitioners
- `Dvergr` - Dwarven craftsmen

### Current Quest References (from dialogue outcomes)

```json
{
  "Outcome": {
    "Type": "QuestUpdate",
    "Data": "boss_location_revealed"
  }
}
```

### Key Schema Conventions

- JSON Schema Draft-07 format
- ID pattern: `^[a-z][a-z0-9-]*$` (lowercase kebab-case)
- Definitions section for reusable types
- Required fields explicitly listed
- Descriptions on all properties

---

## Phase Definitions

---

## v0.14.10a: Faction Schema

[v0.14.10a Design Specification](v0.14.10a-design-specification.md)

### Overview

Create a comprehensive JSON schema for faction definitions that validates faction identities, reputation thresholds, inter-faction relationships, reputation change rules, and faction-specific perks and vendor access.

### Scope

**In Scope:**
- `factions.schema.json` - Schema for faction definitions
- Faction identity (ID, name, description, iconId)
- Reputation thresholds (hostile, unfriendly, neutral, friendly, allied, exalted)
- Reputation value ranges for each threshold
- Inter-faction relationships (ally, enemy, neutral, at war)
- Reputation modifiers (actions that change reputation)
- Faction perks by reputation level
- Faction-specific vendor access
- Faction headquarters/territory references

**Out of Scope:**
- Quest schema (v0.14.10b)
- Reputation calculation logic (runtime concern)
- Faction AI behavior (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `factions.schema.json` |
| Schema Definitions | 6 | `Faction`, `ReputationThreshold`, `FactionRelationship`, `ReputationModifier`, `FactionPerk`, `VendorAccess` |
| Configuration Files | 1 | `factions.json` with known factions |
| Unit Tests | ~6 | Schema validation tests |

### Schema Structure

```
factions.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Faction Configuration"
|-- description: "Schema for faction definitions and reputation systems"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string
|   |-- factions: array of Faction
|   +-- defaultThresholds: ReputationThresholds (optional, global defaults)
|-- required: ["factions"]
+-- definitions:
    |-- Faction
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- name: string (minLength: 1)
    |   |-- description: string
    |   |-- iconId: string | null
    |   |-- color: string | null (hex color for UI)
    |   |-- thresholds: ReputationThresholds (overrides defaults)
    |   |-- relationships: array of FactionRelationship
    |   |-- reputationModifiers: array of ReputationModifier
    |   |-- perks: array of FactionPerk
    |   |-- vendors: array of VendorAccess
    |   |-- headquarters: string | null (location ID)
    |   |-- isHidden: boolean (default: false, for secret factions)
    |   +-- tags: array of string
    |-- ReputationThresholds
    |   |-- hostile: object { min: -1000, max: -501, label: "Hostile" }
    |   |-- unfriendly: object { min: -500, max: -1, label: "Unfriendly" }
    |   |-- neutral: object { min: 0, max: 499, label: "Neutral" }
    |   |-- friendly: object { min: 500, max: 2999, label: "Friendly" }
    |   |-- allied: object { min: 3000, max: 8999, label: "Allied" }
    |   +-- exalted: object { min: 9000, max: 10000, label: "Exalted" }
    |-- FactionRelationship
    |   |-- factionId: string (reference to another faction)
    |   |-- relationship: string (enum: Allied, Friendly, Neutral, Unfriendly, Hostile, AtWar)
    |   |-- reputationLink: number | null (% of rep change that propagates)
    |   +-- description: string | null
    |-- ReputationModifier
    |   |-- action: string (enum: KillMember, HelpMember, CompleteQuest, FailQuest, Theft, Gift, Betrayal, Discovery)
    |   |-- amount: integer (positive or negative)
    |   |-- conditions: array of Condition | null
    |   +-- description: string
    |-- FactionPerk
    |   |-- id: string
    |   |-- name: string
    |   |-- description: string
    |   |-- requiredThreshold: string (enum: friendly, allied, exalted)
    |   |-- effect: object (perk effect definition)
    |   +-- isPassive: boolean (default: true)
    +-- VendorAccess
        |-- vendorId: string (reference to vendor definition)
        |-- requiredThreshold: string (enum: neutral, friendly, allied, exalted)
        |-- priceModifier: number (default: 1.0, multiplier)
        +-- exclusiveItems: array of string | null (item IDs only available at this rep)
```

### Reputation Thresholds

| Threshold | Range | Description | Typical Effects |
|-----------|-------|-------------|-----------------|
| `hostile` | -1000 to -501 | Kill on sight | Attacked, no services |
| `unfriendly` | -500 to -1 | Distrusted | Limited services, higher prices |
| `neutral` | 0 to 499 | Indifferent | Basic services |
| `friendly` | 500 to 2999 | Welcomed | Discounts, more quests |
| `allied` | 3000 to 8999 | Trusted member | Special items, faction perks |
| `exalted` | 9000 to 10000 | Revered hero | Best prices, unique rewards |

### Known Factions

| ID | Name | Description |
|----|------|-------------|
| `rust-clans` | Rust Clans | Exile raiders and desperate scavengers in The Roots |
| `midgard-combine` | Midgard Combine | Industrial faction maintaining old technology |
| `seidkona-circle` | Seiðkona Circle | Practitioners of Norse magic |
| `dvergr-guild` | Dvergr Guild | Dwarven craftsmen and engineers |
| `forlorn` | The Forlorn | Corrupted beings (hostile to all) |

### Acceptance Criteria

- [x] `factions.schema.json` created in `config/schemas/`
- [x] Faction ID pattern validated
- [x] Reputation thresholds validated with min/max ranges
- [x] Inter-faction relationships validated
- [x] Reputation modifiers validated with action types
- [x] Faction perks validated with threshold requirements
- [x] Vendor access validated
- [x] ~63 unit tests pass

---

## v0.14.10b: Quest Schema

[v0.14.10b Design Specification](v0.14.10b-design-specification.md)

### Overview

Create a comprehensive JSON schema for quest definitions that validates quest structure, objective types, stages, prerequisites, rewards, and branching paths for both main story and side quests.

### Scope

**In Scope:**
- `quests.schema.json` - Schema for quest definitions
- Quest identity (ID, name, description, category)
- Quest stages with sequential progression
- Objective types (kill, collect, talk, explore, escort, defend, craft, discover)
- Objective conditions (target, quantity, location, time limit)
- Prerequisites (level, faction reputation, completed quests, items)
- Reward definitions (XP, gold, items, reputation, abilities)
- Branching paths and multiple endings
- Failure conditions and consequences
- Quest giver and turn-in NPCs
- Quest log display settings

**Out of Scope:**
- Codex schema (v0.14.10c)
- Quest tracking logic (runtime concern)
- Quest UI implementation (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `quests.schema.json` |
| Schema Definitions | 8 | `Quest`, `QuestStage`, `Objective`, `Prerequisite`, `Reward`, `QuestBranch`, `FailureCondition`, `QuestGiver` |
| Configuration Files | 1 | `quests.json` with example quests |
| Unit Tests | ~6 | Schema validation tests |

### Schema Structure

```
quests.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Quest Configuration"
|-- description: "Schema for quest definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string
|   +-- quests: array of Quest
|-- required: ["quests"]
+-- definitions:
    |-- Quest
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- name: string (minLength: 1)
    |   |-- description: string (quest log description)
    |   |-- category: QuestCategory
    |   |-- level: integer | null (recommended level)
    |   |-- isRepeatable: boolean (default: false)
    |   |-- isHidden: boolean (default: false, secret quests)
    |   |-- prerequisites: array of Prerequisite
    |   |-- questGiver: QuestGiver | null
    |   |-- stages: array of QuestStage (minItems: 1)
    |   |-- rewards: array of Reward
    |   |-- failureConditions: array of FailureCondition | null
    |   |-- failureConsequences: array of Consequence | null
    |   |-- timeLimit: integer | null (turns, null = no limit)
    |   |-- branches: array of QuestBranch | null
    |   +-- tags: array of string
    |-- QuestCategory (enum)
    |   +-- MainStory, SideQuest, FactionQuest, Bounty, Exploration, Crafting, Daily, Event
    |-- QuestStage
    |   |-- id: string
    |   |-- name: string
    |   |-- description: string (stage-specific description)
    |   |-- objectives: array of Objective (minItems: 1)
    |   |-- onComplete: array of Action | null (triggered actions)
    |   |-- nextStageId: string | null (null = quest complete)
    |   +-- isOptional: boolean (default: false)
    |-- Objective
    |   |-- id: string
    |   |-- type: ObjectiveType
    |   |-- description: string (objective text)
    |   |-- target: string | null (enemy ID, item ID, NPC ID, location ID)
    |   |-- quantity: integer (default: 1)
    |   |-- currentQuantity: integer (default: 0, for tracking)
    |   |-- location: string | null (required location)
    |   |-- isOptional: boolean (default: false)
    |   |-- isHidden: boolean (default: false, revealed on discovery)
    |   +-- conditions: array of Condition | null
    |-- ObjectiveType (enum)
    |   +-- Kill, Collect, Talk, Explore, Escort, Defend, Craft, Discover, Deliver, Use, Survive, Reach
    |-- Prerequisite
    |   |-- type: PrerequisiteType
    |   |-- target: string (quest ID, faction ID, item ID, etc.)
    |   |-- value: integer | string (level, reputation amount, etc.)
    |   +-- operator: string (enum: equals, greaterThan, lessThan, has, notHas)
    |-- PrerequisiteType (enum)
    |   +-- Level, QuestComplete, QuestActive, FactionReputation, HasItem, HasAbility, HasFlag, ClassIs, RaceIs
    |-- Reward
    |   |-- type: RewardType
    |   |-- target: string | null (item ID, ability ID, faction ID)
    |   |-- amount: integer | null
    |   |-- isOptional: boolean (default: false, for choice rewards)
    |   +-- description: string | null
    |-- RewardType (enum)
    |   +-- Experience, Gold, Item, Reputation, Ability, Title, Unlock, Flag
    |-- QuestBranch
    |   |-- id: string
    |   |-- condition: Condition (what triggers branch)
    |   |-- targetStageId: string (stage to jump to)
    |   +-- description: string | null
    |-- FailureCondition
    |   |-- type: string (enum: NPCDeath, TimeExpired, ItemLost, LocationLeft, PlayerDeath, FactionHostile)
    |   |-- target: string | null
    |   +-- description: string
    +-- QuestGiver
        |-- npcId: string
        |-- dialogueNodeId: string | null (starting dialogue)
        |-- turnInNpcId: string | null (different NPC for turn-in)
        +-- turnInDialogueNodeId: string | null
```

### Objective Types

| Type | Target | Description |
|------|--------|-------------|
| `Kill` | Enemy ID | Defeat specific enemies |
| `Collect` | Item ID | Gather items (drops or world) |
| `Talk` | NPC ID | Speak with an NPC |
| `Explore` | Location ID | Visit a location |
| `Escort` | NPC ID | Protect NPC to destination |
| `Defend` | Location ID | Protect location for duration |
| `Craft` | Item ID | Create specific item |
| `Discover` | Codex Entry ID | Find lore/knowledge |
| `Deliver` | Item ID + NPC ID | Bring item to NPC |
| `Use` | Item/Object ID | Interact with object |
| `Survive` | - | Stay alive for duration |
| `Reach` | Location ID | Arrive at destination |

### Quest Categories

| Category | Description | Typical Rewards |
|----------|-------------|-----------------|
| `MainStory` | Primary narrative quests | High XP, story progression |
| `SideQuest` | Optional character stories | Moderate XP, unique items |
| `FactionQuest` | Faction-specific tasks | Reputation, faction items |
| `Bounty` | Kill target quests | Gold, minor XP |
| `Exploration` | Discover locations | Codex entries, lore |
| `Crafting` | Create items | Recipes, materials |
| `Daily` | Repeatable dailies | Currency, resources |
| `Event` | Limited-time quests | Unique rewards |

### Acceptance Criteria

- [x] `quests.schema.json` created in `config/schemas/`
- [x] Quest ID pattern validated
- [x] Quest categories validated (8 types)
- [x] Objective types validated (12 types)
- [x] Prerequisites validated
- [x] Rewards validated with types
- [x] Quest stages validated (at least one required)
- [x] Branching paths validated
- [x] Failure conditions validated
- [x] ~48 unit tests pass

---

## v0.14.10c: Codex Schema

[v0.14.10c Design Specification](v0.14.10c-design-specification.md)

### Overview

Create a comprehensive JSON schema for codex/journal entries that validates lore entries, bestiary records, item catalogs, location descriptions, and discovery mechanics that integrate with capture templates from v0.14.9e.

### Scope

**In Scope:**
- `codex.schema.json` - Schema for codex entry definitions
- Entry identity (ID, title, category, subcategory)
- Entry content (text, sections, images)
- Category classification (lore, bestiary, items, locations, characters, mechanics)
- Unlock conditions (discovery triggers, quest completion, capture collection)
- Keyword matching (integration with capture templates)
- Progression tracking (fragments → partial → complete)
- Entry relationships (see also, prerequisites)
- Display settings (icon, sort order, spoiler warnings)

**Out of Scope:**
- Command schema (v0.14.10d)
- Codex UI implementation (runtime concern)
- Capture template schema (v0.14.9e, already defined)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `codex.schema.json` |
| Schema Definitions | 6 | `CodexEntry`, `CodexCategory`, `EntrySection`, `UnlockCondition`, `EntryRelation`, `ProgressionLevel` |
| Configuration Files | 1 | `codex.json` with example entries |
| Unit Tests | ~6 | Schema validation tests |

### Schema Structure

```
codex.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Codex Configuration"
|-- description: "Schema for codex/journal entry definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string
|   |-- categories: array of CodexCategory
|   +-- entries: array of CodexEntry
|-- required: ["categories", "entries"]
+-- definitions:
    |-- CodexCategory
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- name: string
    |   |-- description: string
    |   |-- iconId: string | null
    |   |-- sortOrder: integer (default: 0)
    |   |-- subcategories: array of CodexSubcategory | null
    |   +-- isHidden: boolean (default: false)
    |-- CodexSubcategory
    |   |-- id: string
    |   |-- name: string
    |   |-- sortOrder: integer
    |   +-- parentCategoryId: string
    |-- CodexEntry
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- title: string (minLength: 1)
    |   |-- categoryId: string (reference to category)
    |   |-- subcategoryId: string | null
    |   |-- summary: string (brief description for list view)
    |   |-- sections: array of EntrySection (minItems: 1)
    |   |-- matchKeywords: array of string (for capture template matching)
    |   |-- unlockConditions: array of UnlockCondition
    |   |-- progressionLevels: array of ProgressionLevel | null
    |   |-- relatedEntries: array of EntryRelation | null
    |   |-- iconId: string | null
    |   |-- imageId: string | null (illustration)
    |   |-- sortOrder: integer (default: 0)
    |   |-- isSpoiler: boolean (default: false)
    |   |-- isHidden: boolean (default: false, for secret entries)
    |   +-- tags: array of string
    |-- EntrySection
    |   |-- id: string
    |   |-- title: string | null (null = no section header)
    |   |-- content: string (markdown supported)
    |   |-- unlockCondition: UnlockCondition | null (section-level unlock)
    |   |-- sortOrder: integer
    |   +-- isSpoiler: boolean (default: false)
    |-- UnlockCondition
    |   |-- type: UnlockType
    |   |-- target: string | null (capture ID, quest ID, etc.)
    |   |-- quantity: integer (default: 1, for capture collection)
    |   |-- qualityThreshold: integer | null (minimum capture quality)
    |   +-- description: string | null
    |-- UnlockType (enum)
    |   +-- CaptureCollected, QuestComplete, EnemyKilled, LocationVisited, ItemObtained, FactionReputation, LevelReached, ManualUnlock
    |-- ProgressionLevel
    |   |-- level: integer (1, 2, 3, etc.)
    |   |-- name: string (e.g., "Fragment", "Partial", "Complete")
    |   |-- requiredUnlocks: integer (number of unlock conditions met)
    |   |-- visibleSections: array of string (section IDs visible at this level)
    |   +-- description: string | null
    +-- EntryRelation
        |-- entryId: string (reference to related entry)
        |-- relationType: string (enum: SeeAlso, Prerequisite, Sequel, Contradiction, Expansion)
        +-- description: string | null
```

### Codex Categories

| Category | Description | Example Entries |
|----------|-------------|-----------------|
| `lore` | World history and mythology | The Glitch, Runic Blight origins |
| `bestiary` | Creature information | Servitor variants, Forlorn types |
| `items` | Equipment and consumables | Weapon lore, artifact history |
| `locations` | Places and regions | The Roots, Muspelheim |
| `characters` | NPCs and factions | Sigrun, Rust Clans |
| `mechanics` | Game system explanations | Galdr magic, corruption |

### Progression Levels

| Level | Name | Description |
|-------|------|-------------|
| 1 | Fragment | Initial discovery, minimal info |
| 2 | Partial | Some details revealed |
| 3 | Complete | Full entry unlocked |
| 4 | Mastery | Bonus lore/secrets (optional) |

### Capture Template Integration

Codex entries use `matchKeywords` to automatically associate with capture templates:

```json
// Codex Entry
{
  "id": "servitor-origin",
  "title": "The Servitors",
  "matchKeywords": ["servitor", "aesir", "construct"]
}

// Capture Template (from v0.14.9e)
{
  "id": "servitor-fungal-infection",
  "matchKeywords": ["servitor", "blight"]
}
// → Contributes to "servitor-origin" codex entry
```

### Acceptance Criteria

- [x] `codex.schema.json` created in `config/schemas/`
- [x] Entry ID pattern validated
- [x] Categories and subcategories validated
- [x] Entry sections validated (at least one required)
- [x] Unlock conditions validated (8 types)
- [x] Keyword matching validated
- [x] Progression levels validated
- [x] Entry relations validated
- [x] ~55 unit tests pass

---

## v0.14.10d: Command Schema

[v0.14.10d Design Specification](v0.14.10d-design-specification.md)

### Overview

Create a comprehensive JSON schema for command syntax definitions that validates command names, aliases, argument patterns, context restrictions, and help text for the text-based interface.

### Scope

**In Scope:**
- `commands.schema.json` - Schema for command definitions
- Command identity (ID, name, aliases)
- Argument patterns (required, optional, variadic)
- Argument types (string, number, direction, target, item)
- Context restrictions (combat, exploration, dialogue, inventory)
- Help text (description, usage, examples)
- Command categories (movement, combat, interaction, inventory, system)
- Shorthand notation (l → look, x → examine)
- Command chaining rules

**Out of Scope:**
- Glossary schema (v0.14.10e)
- Command execution logic (runtime concern)
- Parser implementation (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `commands.schema.json` |
| Schema Definitions | 6 | `Command`, `CommandArgument`, `ArgumentType`, `CommandContext`, `CommandHelp`, `CommandAlias` |
| Configuration Files | 1 | `commands.json` with all game commands |
| Unit Tests | ~6 | Schema validation tests |

### Schema Structure

```
commands.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Command Configuration"
|-- description: "Schema for command syntax definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string
|   |-- globalAliases: object (shorthand mappings)
|   +-- commands: array of Command
|-- required: ["commands"]
+-- definitions:
    |-- Command
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- name: string (primary command word)
    |   |-- aliases: array of string (alternative names)
    |   |-- category: CommandCategory
    |   |-- description: string (brief description)
    |   |-- arguments: array of CommandArgument
    |   |-- contexts: array of CommandContext (where command is valid)
    |   |-- help: CommandHelp
    |   |-- isHidden: boolean (default: false, for debug commands)
    |   |-- requiresTarget: boolean (default: false)
    |   |-- canChain: boolean (default: false, can combine with other commands)
    |   +-- cooldown: integer | null (turns between uses)
    |-- CommandCategory (enum)
    |   +-- Movement, Combat, Interaction, Inventory, Information, Social, System, Debug
    |-- CommandArgument
    |   |-- name: string (argument identifier)
    |   |-- type: ArgumentType
    |   |-- description: string
    |   |-- isRequired: boolean (default: true)
    |   |-- isVariadic: boolean (default: false, accepts multiple values)
    |   |-- defaultValue: string | null
    |   |-- validValues: array of string | null (enum-like restriction)
    |   +-- pattern: string | null (regex for validation)
    |-- ArgumentType (enum)
    |   +-- String, Number, Direction, Target, Item, Ability, NPC, Location, Quantity, Boolean
    |-- CommandContext (enum)
    |   +-- Exploration, Combat, Dialogue, Inventory, Menu, Rest, Crafting, Trading, Any
    |-- CommandHelp
    |   |-- usage: string (syntax pattern)
    |   |-- examples: array of CommandExample
    |   |-- notes: string | null (additional information)
    |   +-- seeAlso: array of string | null (related command IDs)
    +-- CommandExample
        |-- input: string (example command)
        +-- description: string (what it does)
```

### Command Categories

| Category | Description | Example Commands |
|----------|-------------|------------------|
| `Movement` | Navigation commands | go, north, south, enter, exit |
| `Combat` | Battle actions | attack, defend, use, cast |
| `Interaction` | Object/NPC interaction | look, examine, talk, take, open |
| `Inventory` | Item management | inventory, equip, drop, use |
| `Information` | Status and info | status, map, quest, codex |
| `Social` | Communication | say, shout, whisper |
| `System` | Meta commands | save, load, settings, quit |
| `Debug` | Developer commands | teleport, spawn, godmode |

### Argument Types

| Type | Description | Example |
|------|-------------|---------|
| `String` | Free text | say <message> |
| `Number` | Integer value | give 5 gold |
| `Direction` | Cardinal/relative | go north |
| `Target` | Enemy or object | attack goblin |
| `Item` | Inventory item | equip sword |
| `Ability` | Skill/spell name | cast fireball |
| `NPC` | Character name | talk to bjorn |
| `Location` | Place name | travel to town |
| `Quantity` | Amount | take 3 potions |
| `Boolean` | On/off toggle | music on |

### Standard Commands

| Command | Aliases | Category | Usage |
|---------|---------|----------|-------|
| `look` | l, examine, x | Interaction | look [target] |
| `go` | move, walk | Movement | go <direction> |
| `take` | get, grab, pick | Interaction | take <item> [quantity] |
| `attack` | hit, strike, a | Combat | attack <target> |
| `inventory` | inv, i, items | Inventory | inventory |
| `talk` | speak, converse | Interaction | talk [to] <npc> |
| `use` | activate | Interaction | use <item/ability> [on target] |
| `cast` | spell | Combat | cast <spell> [at target] |
| `status` | stats, st | Information | status |
| `help` | ?, h | System | help [command] |

### Acceptance Criteria

- [x] `commands.schema.json` created in `config/schemas/`
- [x] Command ID pattern validated
- [x] Command categories validated (8 types)
- [x] Argument types validated (10 types)
- [x] Context restrictions validated (9 contexts)
- [x] Help text structure validated
- [x] Aliases validated
- [x] Examples validated
- [x] ~62 unit tests pass

---

## v0.14.10e: Glossary Schema

[v0.14.10e Design Specification](v0.14.10e-design-specification.md)

### Overview

Create a comprehensive JSON schema for glossary/terminology definitions that validates game terms, tooltips, help text, and cross-references for the in-game help system.

### Scope

**In Scope:**
- `glossary.schema.json` - Schema for term definitions
- Term identity (ID, term, definition)
- Category classification (combat, magic, lore, items, UI, mechanics)
- Cross-references to related terms
- Context-sensitive display rules
- Tooltip formatting
- Abbreviation mappings
- Localization key references

**Out of Scope:**
- Combat stance schema (v0.14.10f)
- Tooltip rendering (runtime concern)
- Localization system (separate concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `glossary.schema.json` |
| Schema Definitions | 4 | `GlossaryTerm`, `TermCategory`, `CrossReference`, `DisplayRule` |
| Configuration Files | 1 | `glossary.json` with game terms |
| Unit Tests | ~6 | Schema validation tests |

### Schema Structure

```
glossary.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Glossary Configuration"
|-- description: "Schema for game terminology and tooltips"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string
|   |-- categories: array of TermCategory
|   +-- terms: array of GlossaryTerm
|-- required: ["terms"]
+-- definitions:
    |-- TermCategory
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- name: string
    |   |-- description: string
    |   |-- iconId: string | null
    |   +-- sortOrder: integer
    |-- GlossaryTerm
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- term: string (the word/phrase)
    |   |-- definition: string (explanation)
    |   |-- shortDefinition: string | null (tooltip-length version)
    |   |-- categoryId: string
    |   |-- aliases: array of string (alternative terms)
    |   |-- abbreviation: string | null (e.g., "HP" for "Hit Points")
    |   |-- crossReferences: array of CrossReference | null
    |   |-- displayRules: array of DisplayRule | null
    |   |-- examples: array of string | null
    |   |-- localizationKey: string | null
    |   |-- sortOrder: integer
    |   +-- tags: array of string
    |-- CrossReference
    |   |-- termId: string (reference to another term)
    |   |-- relationship: string (enum: SeeAlso, Contrast, Prerequisite, Related)
    |   +-- note: string | null
    |-- DisplayRule
    |   |-- context: string (enum: Tooltip, Help, Codex, Combat, Inventory)
    |   |-- showDefinition: boolean (default: true)
    |   |-- showExamples: boolean (default: false)
    |   |-- maxLength: integer | null (character limit)
    |   +-- highlightInText: boolean (default: true)
```

### Term Categories

| Category | Description | Example Terms |
|----------|-------------|---------------|
| `combat` | Battle mechanics | Attack, Defense, Critical Hit, Flanking |
| `magic` | Galdr and runes | Rune School, Miscast, Blight Corruption |
| `lore` | World terminology | The Glitch, Forlorn, Aesir |
| `items` | Equipment terms | Rarity, Quality, Durability |
| `ui` | Interface elements | Action Bar, Codex, Quest Log |
| `mechanics` | Game systems | Experience, Reputation, Stress |
| `status` | Conditions | Burning, Frozen, Corrupted |
| `attributes` | Character stats | Might, Finesse, Will, Intellect |

### Example Terms

| Term | Category | Definition |
|------|----------|------------|
| `critical-hit` | combat | "A critical hit occurs when you roll the maximum value on your attack die, dealing double damage." |
| `runic-blight` | lore | "A corruption that spreads through The Roots, tainting both technology and living beings." |
| `stress` | mechanics | "Mental strain accumulated through combat, trauma, and environmental pressure. High stress can trigger psychological effects." |
| `galdr` | magic | "The Norse magical tradition of runic chanting. Galdr practitioners invoke rune power through specific vocal patterns." |

### Acceptance Criteria

- [x] `glossary.schema.json` created in `config/schemas/`
- [x] Term ID pattern validated
- [x] Categories validated (8 categories)
- [x] Cross-references validated (4 relationship types)
- [x] Display rules validated (5 contexts)
- [x] Aliases validated
- [x] Abbreviations validated
- [x] ~49 unit tests pass

---

## v0.14.10f: Combat Stance Schema

[v0.14.10f Design Specification](v0.14.10f-design-specification.md)

### Overview

Create a comprehensive JSON schema for combat stance definitions that validates stance configurations, stat modifiers, ability restrictions, switching rules, and AI behavior patterns.

### Scope

**In Scope:**
- `stances.schema.json` - Schema for combat stance definitions
- Stance identity (ID, name, description, iconId)
- Stat modifiers (attack bonus, defense bonus, speed modifier)
- Ability restrictions (abilities disabled in stance)
- Ability grants (abilities enabled by stance)
- Switching rules (action cost, cooldown, conditions)
- Incompatible stances (mutually exclusive)
- AI behavior patterns (when AI uses stance)
- Visual/audio feedback references

**Out of Scope:**
- Stance execution logic (runtime concern)
- Combat AI implementation (runtime concern)
- Animation system (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `stances.schema.json` |
| Schema Definitions | 5 | `CombatStance`, `StatModifier`, `AbilityRestriction`, `SwitchingRule`, `AIBehavior` |
| Configuration Files | 1 | `stances.json` with standard stances |
| Unit Tests | ~6 | Schema validation tests |

### Schema Structure

```
stances.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Combat Stance Configuration"
|-- description: "Schema for combat stance definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string
|   |-- defaultStance: string (ID of default stance)
|   +-- stances: array of CombatStance
|-- required: ["stances", "defaultStance"]
+-- definitions:
    |-- CombatStance
    |   |-- id: string (pattern: ^[a-z][a-z0-9-]*$)
    |   |-- name: string (minLength: 1)
    |   |-- description: string
    |   |-- iconId: string | null
    |   |-- color: string | null (UI color)
    |   |-- statModifiers: array of StatModifier
    |   |-- abilityRestrictions: array of AbilityRestriction | null
    |   |-- abilityGrants: array of string | null (ability IDs enabled)
    |   |-- switchingRule: SwitchingRule
    |   |-- incompatibleStances: array of string | null (stance IDs)
    |   |-- aiBehavior: AIBehavior | null
    |   |-- visualEffectId: string | null
    |   |-- soundEffectId: string | null
    |   |-- isDefault: boolean (default: false)
    |   |-- requiresUnlock: boolean (default: false)
    |   |-- unlockCondition: object | null
    |   +-- tags: array of string
    |-- StatModifier
    |   |-- stat: string (enum: attack, defense, speed, accuracy, evasion, criticalChance, criticalDamage, damageReduction)
    |   |-- value: number (positive or negative)
    |   |-- type: string (enum: flat, percentage)
    |   +-- description: string | null
    |-- AbilityRestriction
    |   |-- type: string (enum: Category, Specific, Tag)
    |   |-- target: string (ability category, ID, or tag)
    |   +-- description: string | null
    |-- SwitchingRule
    |   |-- actionCost: string (enum: Free, Swift, Standard, Full)
    |   |-- cooldown: integer (default: 0, turns before can switch again)
    |   |-- conditions: array of Condition | null
    |   |-- canSwitchDuringEnemyTurn: boolean (default: false)
    |   +-- triggerEffects: array of Effect | null (effects on switch)
    +-- AIBehavior
        |-- priority: integer (higher = more preferred)
        |-- useWhen: array of AICondition
        |-- avoidWhen: array of AICondition | null
        +-- stickiness: number (0-1, likelihood to stay in stance)
```

### Standard Stances

| Stance | Description | Modifiers |
|--------|-------------|-----------|
| `balanced` | Default neutral stance | No modifiers |
| `aggressive` | Offensive focus | +20% attack, -20% defense |
| `defensive` | Protective focus | +20% defense, -20% attack |
| `evasive` | Mobility focus | +20% evasion, +10% speed, -10% attack |
| `reckless` | High risk/reward | +30% damage, +20% crit, -30% defense |
| `focused` | Precision focus | +25% accuracy, +15% crit chance, -10% speed |

### Stat Modifiers

| Stat | Description | Typical Range |
|------|-------------|---------------|
| `attack` | Damage dealt | ±10% to ±30% |
| `defense` | Damage reduction | ±10% to ±30% |
| `speed` | Turn order and movement | ±10% to ±20% |
| `accuracy` | Hit chance | ±10% to ±25% |
| `evasion` | Dodge chance | ±10% to ±25% |
| `criticalChance` | Crit probability | ±5% to ±20% |
| `criticalDamage` | Crit multiplier | ±10% to ±50% |
| `damageReduction` | Flat damage absorbed | ±2 to ±10 |

### Switching Rules

| Action Cost | Description |
|-------------|-------------|
| `Free` | No action required |
| `Swift` | Minor action |
| `Standard` | Main action |
| `Full` | Entire turn |

### AI Behavior Conditions

| Condition | Description |
|-----------|-------------|
| `HealthBelow` | HP below threshold |
| `HealthAbove` | HP above threshold |
| `EnemyCount` | Number of enemies |
| `AllyCount` | Number of allies |
| `StatusActive` | Has specific status effect |
| `TargetWeak` | Target has vulnerability |
| `OutNumbered` | More enemies than allies |

### Acceptance Criteria

- [x] `stances.schema.json` created in `config/schemas/`
- [x] Stance ID pattern validated
- [x] Stat modifiers validated (8 stats)
- [x] Modifier types validated (flat, percentage)
- [x] Ability restrictions validated (3 types)
- [x] Switching rules validated (4 action costs, 7 condition types, 6 effect types)
- [x] AI behavior validated (7 condition types, priority, stickiness)
- [x] Incompatible stances validated
- [x] ~73 unit tests pass

---

## Dependencies & Prerequisites

```
v0.14.9 (Advanced Descriptor Configuration Schemas) - REQUIRED
    |
    +-- capture-templates.schema.json ──────────────────────────────────────────┐
    |   (v0.14.9e provides keyword matching for codex)                          |
    |                                                                           |
    +-- dialogue.schema.json ───────────────────────────────────────────────────┤
        (v0.14.9a references factions and quests in outcomes)                   |
                                                                                |
                                        v
v0.14.10 (Game Systems Configuration Schemas)
    |
    |-- v0.14.10a: Faction Schema ──────────────────────────────────────────────┐
    |       Dependencies: None                                                   |
    |       Provides: factions.schema.json                                       |
    |       Referenced by: Dialogue outcomes, Quest rewards                      |
    |                                                                            |
    |-- v0.14.10b: Quest Schema ────────────────────────────────────────────────┤
    |       Dependencies: factions.schema.json (reputation rewards)              |
    |       Provides: quests.schema.json                                         |
    |       Referenced by: Dialogue outcomes, Codex unlocks                      |
    |                                                                            |
    |-- v0.14.10c: Codex Schema ────────────────────────────────────────────────┤
    |       Dependencies: capture-templates.schema.json (keyword matching)       |
    |       Provides: codex.schema.json                                          |
    |       Referenced by: Quest objectives                                      |
    |                                                                            |
    |-- v0.14.10d: Command Schema ──────────────────────────────────────────────┤
    |       Dependencies: None                                                   |
    |       Provides: commands.schema.json                                       |
    |                                                                            |
    |-- v0.14.10e: Glossary Schema ─────────────────────────────────────────────┤
    |       Dependencies: None                                                   |
    |       Provides: glossary.schema.json                                       |
    |                                                                            |
    +-- v0.14.10f: Combat Stance Schema ────────────────────────────────────────┘
            Dependencies: combat.schema.json (v0.14.1), abilities.schema.json
            Provides: stances.schema.json

Recommended Order:
1. v0.14.10a (Factions) - No dependencies, referenced by others
2. v0.14.10d (Commands) - No dependencies
3. v0.14.10e (Glossary) - No dependencies
4. v0.14.10b (Quests) - Depends on Factions
5. v0.14.10c (Codex) - Depends on Capture Templates
6. v0.14.10f (Stances) - Depends on Combat schema
```

---

## Estimated Effort Summary

| Part | New Files | Modified Files | Est. Tests | Complexity |
|------|-----------|----------------|------------|------------|
| v0.14.10a | 2 | 0 | ~6 | High |
| v0.14.10b | 2 | 0 | ~6 | High |
| v0.14.10c | 2 | 0 | ~6 | Medium |
| v0.14.10d | 2 | 0 | ~6 | Medium |
| v0.14.10e | 2 | 0 | ~6 | Low |
| v0.14.10f | 2 | 0 | ~6 | Medium |
| **Total** | **12** | **0** | **~36** | |

---

## Risk Assessment

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Cross-schema dependencies | Medium | Medium | Define interfaces early, validate references |
| Quest complexity creep | Medium | Medium | Keep schema focused, defer advanced features |
| Command parser coupling | Low | Medium | Schema defines syntax only, not parsing logic |
| Faction balance concerns | Low | Low | Schema validates structure, not game balance |
| AI behavior complexity | Medium | Low | Keep AI conditions simple and enumerated |

---

## Design Decisions (Confirmed)

### Schema Standards

| Decision | Value | Notes |
|----------|-------|-------|
| **JSON Schema Version** | Draft-07 | Consistent with v0.14.0-v0.14.9 |
| **ID Pattern** | `^[a-z][a-z0-9-]*$` | Lowercase kebab-case |
| **Schema Location** | `config/schemas/` | Centralized schema storage |

### Faction Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Reputation Range** | -1000 to 10000 | Wide range for granularity |
| **Threshold Count** | 6 levels | Hostile → Exalted |
| **Relationship Types** | 6 types | Allied to AtWar |
| **Reputation Propagation** | Percentage-based | Allied factions share rep changes |

### Quest Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Quest Categories** | 8 types | MainStory through Event |
| **Objective Types** | 12 types | Comprehensive action coverage |
| **Prerequisite Types** | 9 types | Level, quest, faction, item, etc. |
| **Reward Types** | 8 types | XP, gold, items, reputation, etc. |

### Codex Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Unlock Types** | 8 types | Captures, quests, kills, etc. |
| **Progression Levels** | 4 levels | Fragment → Mastery |
| **Keyword Matching** | Array intersection | Any matching keyword contributes |

### Command Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Argument Types** | 10 types | String through Boolean |
| **Contexts** | 9 contexts | Exploration through Any |
| **Categories** | 8 categories | Movement through Debug |

### Glossary Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Categories** | 8 categories | Combat through Attributes |
| **Display Contexts** | 5 contexts | Tooltip through Inventory |
| **Cross-Reference Types** | 4 types | SeeAlso through Related |

### Stance Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Standard Stances** | 6 stances | Balanced through Focused |
| **Stat Types** | 8 stats | Attack through DamageReduction |
| **Modifier Types** | 2 types | Flat and Percentage |
| **Action Costs** | 4 costs | Free through Full |

---

## Integration with Existing Systems

### Dialogue Integration (v0.14.9a)

The faction and quest schemas integrate with dialogue outcomes:

```json
// Dialogue outcome referencing faction
{
  "Type": "ReputationChange",
  "AffectedFaction": "rust-clans",  // Validated against factions.schema.json
  "ReputationChange": 10
}

// Dialogue outcome referencing quest
{
  "Type": "QuestUpdate",
  "Data": "main-quest-stage-2"  // Validated against quests.schema.json
}
```

### Capture Template Integration (v0.14.9e)

The codex schema integrates with capture template keywords:

```json
// Capture template
{
  "matchKeywords": ["servitor", "blight"]
}

// Codex entry
{
  "matchKeywords": ["servitor", "aesir", "construct"]
}
// "servitor" keyword matches → capture contributes to codex entry
```

### Combat Integration (v0.14.1)

The stance schema integrates with combat rules:

```json
// Stance modifying combat stats
{
  "statModifiers": [
    { "stat": "attack", "value": 20, "type": "percentage" }
  ]
}
// Applied during combat resolution defined in combat.schema.json
```

---

## Next Steps

1. **Review & Approve** - Confirm scope breakdown
2. **v0.14.10a Design Spec** - Create faction schema
3. **v0.14.10a Implementation** - Build factions.schema.json
4. **v0.14.10b Design Spec** - Create quest schema
5. **v0.14.10b Implementation** - Build quests.schema.json
6. **v0.14.10c Design Spec** - Create codex schema
7. **v0.14.10c Implementation** - Build codex.schema.json
8. **v0.14.10d Design Spec** - Create command schema
9. **v0.14.10d Implementation** - Build commands.schema.json
10. **v0.14.10e Design Spec** - Create glossary schema
11. **v0.14.10e Implementation** - Build glossary.schema.json
12. **v0.14.10f Design Spec** - Create stance schema
13. **v0.14.10f Implementation** - Build stances.schema.json
14. **Update v0.14.x-overview.md** - Add v0.14.10 section

---

## Appendix: Feature Origin Tracking

These schemas address items identified in `docs/design/features.md`:

| features.md Item | Addressed In | Status |
|------------------|--------------|--------|
| Command syntax configuration schema | v0.14.10d | ✅ Included |
| Creature configuration schema template | v0.14.3 | Already covered |
| Archetype renaming | N/A | Design decision, not schema |
| Faction configuration schema template | v0.14.10a | ✅ Included |
| Combat stances | v0.14.10f | ✅ Included |
| Glossary configuration schema template | v0.14.10e | ✅ Included |
| Data capture configuration schema template | v0.14.9e | Already covered |
| Quest configuration schema template | v0.14.10b | ✅ Included |
| Codex configuration schema template | v0.14.10c | ✅ Included |

---

*This scope breakdown provides a structured approach to implementing v0.14.10 Game Systems Configuration Schemas. These schemas complete the configuration infrastructure by addressing factions, quests, codex entries, commands, glossary terms, and combat stances—enabling full game customization without code changes.*
