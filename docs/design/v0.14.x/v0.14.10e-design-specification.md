# v0.14.10e Design Specification: Glossary Schema

## Document Information

| Field | Value |
|-------|-------|
| **Version** | v0.14.10e |
| **Feature** | Glossary Schema |
| **Status** | Draft |
| **Created** | 2026-01-17 |
| **Depends On** | None |
| **Provides To** | v0.15.x (Tooltip System), Help System, Codex Integration |

---

## 1. Executive Summary

### 1.1 Overview

This specification defines the Glossary Schema for configuring game terminology, tooltips, and help text in Aethelgard. The schema enables definition of game terms with their definitions, cross-references, context-sensitive display rules, and abbreviation mappings for the in-game help system.

The schema enables:
- **Term Definitions**: Game terms with full and tooltip-length definitions
- **Category Organization**: Terms grouped by topic (combat, magic, lore, etc.)
- **Cross-References**: Typed relationships between related terms
- **Display Rules**: Context-sensitive formatting for tooltips, help screens, and codex
- **Abbreviation Mapping**: Common abbreviations linked to full terms
- **Localization Ready**: Keys for future localization support

### 1.2 Deliverables

| Deliverable | Layer | Description |
|-------------|-------|-------------|
| `glossary.schema.json` | Configuration | JSON Schema Draft-07 validation schema |
| `glossary.json` | Configuration | Term definitions |
| `GlossaryTerm` | Schema Definition | Term with definition and metadata |
| `TermCategory` | Schema Definition | Category for organizing terms |
| `CrossReference` | Schema Definition | Typed relationship to other terms |
| `DisplayRule` | Schema Definition | Context-specific display configuration |
| ~6 Unit Tests | Testing | Schema validation and loading tests |

### 1.3 Architectural Significance

The Glossary Schema serves as the central terminology reference:

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      GLOSSARY SCHEMA INTEGRATION                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌──────────────────┐     ┌──────────────────┐     ┌─────────────────┐  │
│  │   Tooltip UI     │     │  Glossary Schema │     │   Codex System  │  │
│  │                  │────▶│   (v0.14.10e)    │◀────│   (v0.14.10c)   │  │
│  │  Hover display   │     │                  │     │                 │  │
│  │  Quick reference │     │  - GlossaryTerm  │     │  Term linking   │  │
│  └──────────────────┘     │  - Categories    │     │  in entries     │  │
│                           │  - CrossRefs     │     └─────────────────┘  │
│  ┌──────────────────┐     │  - DisplayRules  │                          │
│  │   Help System    │────▶│                  │                          │
│  │                  │     └────────┬─────────┘                          │
│  │  Term lookup     │              │                                    │
│  │  Search          │              ▼                                    │
│  └──────────────────┘     ┌──────────────────┐                          │
│                           │   Combat UI      │                          │
│                           │                  │                          │
│                           │  Status effects  │                          │
│                           │  Stat displays   │                          │
│                           └──────────────────┘                          │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 2. Feature Overview

```
v0.14.10e Glossary Schema
├── Schema Definitions
│   ├── GlossaryTerm
│   │   ├── id (kebab-case identifier)
│   │   ├── term (the word/phrase)
│   │   ├── definition (full explanation)
│   │   ├── shortDefinition (tooltip version)
│   │   ├── categoryId (reference to category)
│   │   ├── aliases[] (alternative terms)
│   │   ├── abbreviation (e.g., "HP")
│   │   ├── crossReferences[] (related terms)
│   │   ├── displayRules[] (context settings)
│   │   ├── examples[] (usage examples)
│   │   ├── localizationKey (i18n reference)
│   │   ├── sortOrder (display priority)
│   │   └── tags[] (searchable tags)
│   │
│   ├── TermCategory
│   │   ├── id (category identifier)
│   │   ├── name (display name)
│   │   ├── description (category summary)
│   │   ├── iconId (UI icon reference)
│   │   └── sortOrder (display ordering)
│   │
│   ├── CrossReference
│   │   ├── termId (reference to another term)
│   │   ├── relationship (4 relationship types)
│   │   └── note (optional context)
│   │
│   └── DisplayRule
│       ├── context (5 display contexts)
│       ├── showDefinition (visibility flag)
│       ├── showExamples (include examples)
│       ├── maxLength (character limit)
│       └── highlightInText (link terms)
│
├── Configuration Files
│   ├── glossary.schema.json (validation schema)
│   └── glossary.json (term definitions)
│
└── Unit Tests (~6 tests)
    ├── GLO-001: Valid schema loads successfully
    ├── GLO-002: Invalid term ID rejected
    ├── GLO-003: Category reference validation
    ├── GLO-004: Cross-reference validation
    ├── GLO-005: Display rule validation
    └── GLO-006: Abbreviation uniqueness
```

---

## 3. Architecture Diagrams

### 3.1 Glossary Data Structure

```
┌─────────────────────────────────────────────────────────────────────────┐
│                       GLOSSARY SCHEMA STRUCTURE                          │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  glossary.json                                                           │
│  ┌───────────────────────────────────────────────────────────────────┐  │
│  │                                                                    │  │
│  │  categories[]                     terms[]                          │  │
│  │  ┌─────────────────────┐         ┌─────────────────────────────┐  │  │
│  │  │ TermCategory        │    ┌───▶│ GlossaryTerm                │  │  │
│  │  │                     │    │    │                             │  │  │
│  │  │ ├─ id: "combat"     │    │    │ ├─ id: "critical-hit"      │  │  │
│  │  │ ├─ name: "Combat"   │◀───┼────│ ├─ categoryId: "combat"    │  │  │
│  │  │ ├─ description      │    │    │ ├─ term: "Critical Hit"    │  │  │
│  │  │ └─ sortOrder: 1     │    │    │ ├─ abbreviation: "Crit"    │  │  │
│  │  └─────────────────────┘    │    │ ├─ definition: "..."       │  │  │
│  │                              │    │ ├─ crossReferences[]       │  │  │
│  │  ┌─────────────────────┐    │    │ └─ displayRules[]          │  │  │
│  │  │ TermCategory        │    │    └─────────────────────────────┘  │  │
│  │  │                     │    │                                      │  │
│  │  │ ├─ id: "magic"      │    │    ┌─────────────────────────────┐  │  │
│  │  │ ├─ name: "Magic"    │◀───┼───▶│ GlossaryTerm                │  │  │
│  │  │ └─ sortOrder: 2     │    │    │ ├─ id: "galdr"             │  │  │
│  │  └─────────────────────┘    │    │ └─ categoryId: "magic"     │  │  │
│  │                              │    └─────────────────────────────┘  │  │
│  │  ... (8 categories)         │                                      │  │
│  │                              │                                      │  │
│  └──────────────────────────────┴────────────────────────────────────┘  │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.2 Term Resolution Flow

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         TERM RESOLUTION FLOW                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  Text Contains Term                                                      │
│         │                                                                │
│         ▼                                                                │
│  ┌──────────────────┐                                                   │
│  │ Scan for Known   │  "You deal a critical hit for 25 damage"         │
│  │ Terms & Aliases  │                                                   │
│  └────────┬─────────┘                                                   │
│           │                                                              │
│           ▼                                                              │
│  ┌──────────────────┐    ┌─────────────────────────────────────────┐   │
│  │ Match Against    │───▶│ GlossaryTerm.term: "Critical Hit"       │   │
│  │ Term Index       │    │ GlossaryTerm.aliases: ["crit", "crit hit"]│  │
│  │                  │    │ GlossaryTerm.abbreviation: "Crit"        │   │
│  └────────┬─────────┘    └─────────────────────────────────────────┘   │
│           │                                                              │
│           ▼                                                              │
│  ┌──────────────────┐                                                   │
│  │ Check Display    │  Context: Tooltip                                 │
│  │ Rules for        │  → showDefinition: true                           │
│  │ Current Context  │  → maxLength: 100                                 │
│  └────────┬─────────┘  → highlightInText: true                          │
│           │                                                              │
│           ▼                                                              │
│  ┌──────────────────┐                                                   │
│  │ Render Term      │  "Critical Hit" becomes clickable/hoverable       │
│  │ with Styling     │  Tooltip shows shortDefinition                    │
│  └──────────────────┘                                                   │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Cross-Reference System

```
┌─────────────────────────────────────────────────────────────────────────┐
│                       CROSS-REFERENCE SYSTEM                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                    RELATIONSHIP TYPES (4)                        │    │
│  │                                                                  │    │
│  │  ┌─────────────┐   ┌─────────────┐                              │    │
│  │  │   SeeAlso   │   │  Contrast   │                              │    │
│  │  │             │   │             │                              │    │
│  │  │ General     │   │ Opposite or │                              │    │
│  │  │ relation    │   │ comparison  │                              │    │
│  │  │             │   │             │                              │    │
│  │  │ "See also   │   │ "Unlike X,  │                              │    │
│  │  │  Evasion"   │   │  this..."   │                              │    │
│  │  └─────────────┘   └─────────────┘                              │    │
│  │                                                                  │    │
│  │  ┌─────────────┐   ┌─────────────┐                              │    │
│  │  │Prerequisite │   │   Related   │                              │    │
│  │  │             │   │             │                              │    │
│  │  │ Should      │   │ Same topic  │                              │    │
│  │  │ understand  │   │ or system   │                              │    │
│  │  │ first       │   │             │                              │    │
│  │  │             │   │ "Related:   │                              │    │
│  │  │ "Requires   │   │  Damage,    │                              │    │
│  │  │  knowledge  │   │  Defense"   │                              │    │
│  │  │  of..."     │   │             │                              │    │
│  │  └─────────────┘   └─────────────┘                              │    │
│  │                                                                  │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
│  Example: "Critical Hit" term                                            │
│  ├─ SeeAlso: "damage", "combat"                                         │
│  ├─ Contrast: "glancing-blow" (opposite outcome)                        │
│  ├─ Related: "critical-damage", "critical-chance"                       │
│  └─ Prerequisite: "attack" (base concept)                               │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.4 Display Context System

```
┌─────────────────────────────────────────────────────────────────────────┐
│                       DISPLAY CONTEXT SYSTEM                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                    DISPLAY CONTEXTS (5)                          │    │
│  │                                                                  │    │
│  │  ┌────────────┐  ┌────────────┐  ┌────────────┐                 │    │
│  │  │  Tooltip   │  │    Help    │  │   Codex    │                 │    │
│  │  │            │  │            │  │            │                 │    │
│  │  │ Hover UI   │  │ Help menu  │  │ Journal    │                 │    │
│  │  │ Quick ref  │  │ Full docs  │  │ Knowledge  │                 │    │
│  │  │            │  │            │  │            │                 │    │
│  │  │ maxLen:100 │  │ maxLen:500 │  │ maxLen:nil │                 │    │
│  │  │ short def  │  │ full def   │  │ full+refs  │                 │    │
│  │  └────────────┘  └────────────┘  └────────────┘                 │    │
│  │                                                                  │    │
│  │  ┌────────────┐  ┌────────────┐                                 │    │
│  │  │  Combat    │  │ Inventory  │  Display Rule Flags:            │    │
│  │  │            │  │            │  ┌────────────────────────────┐ │    │
│  │  │ Battle UI  │  │ Item info  │  │ showDefinition: boolean    │ │    │
│  │  │ Status bar │  │ Stats      │  │ showExamples: boolean      │ │    │
│  │  │            │  │            │  │ maxLength: integer|null    │ │    │
│  │  │ maxLen:50  │  │ maxLen:150 │  │ highlightInText: boolean   │ │    │
│  │  │ abbrev ok  │  │ full term  │  └────────────────────────────┘ │    │
│  │  └────────────┘  └────────────┘                                 │    │
│  │                                                                  │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.5 Configuration Layer Architecture

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      CONFIGURATION LAYER PLACEMENT                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌───────────────────────────────────────────────────────────────────┐  │
│  │ PRESENTATION LAYER                                                 │  │
│  │                                                                    │  │
│  │  Tooltip System ─────────────────────────────────────────────────▶│  │
│  │    │ Renders term tooltips on hover                               │  │
│  │    │ Highlights known terms in text                               │  │
│  └────┼──────────────────────────────────────────────────────────────┘  │
│       │                                                                  │
│  ┌────▼──────────────────────────────────────────────────────────────┐  │
│  │ APPLICATION LAYER (v0.15.x - Future)                              │  │
│  │                                                                    │  │
│  │  IGlossaryService                                                  │  │
│  │    │ ├─ GetTermById(termId) → GlossaryTerm                        │  │
│  │    │ ├─ GetTermByWord(word) → GlossaryTerm?                       │  │
│  │    │ ├─ GetTermsByCategory(categoryId) → GlossaryTerm[]           │  │
│  │    │ ├─ SearchTerms(query) → GlossaryTerm[]                       │  │
│  │    │ ├─ GetRelatedTerms(termId) → GlossaryTerm[]                  │  │
│  │    │ └─ ResolveAbbreviation(abbrev) → GlossaryTerm?               │  │
│  └────┼──────────────────────────────────────────────────────────────┘  │
│       │                                                                  │
│  ┌────▼──────────────────────────────────────────────────────────────┐  │
│  │ INFRASTRUCTURE LAYER                                               │  │
│  │                                                                    │  │
│  │  GlossaryProvider (v0.15.x - Future)                              │  │
│  │    │ ├─ LoadFromJson(path)                                        │  │
│  │    │ ├─ ValidateAgainstSchema()                                   │  │
│  │    │ ├─ BuildTermIndex()                                          │  │
│  │    │ └─ BuildAbbreviationIndex()                                  │  │
│  └────┼──────────────────────────────────────────────────────────────┘  │
│       │                                                                  │
│  ┌────▼──────────────────────────────────────────────────────────────┐  │
│  │ CONFIGURATION LAYER ◀─────────────────── v0.14.10e (This Version) │  │
│  │                                                                    │  │
│  │  glossary.schema.json                                             │  │
│  │    │ JSON Schema Draft-07 validation                              │  │
│  │    │                                                              │  │
│  │  glossary.json                                                    │  │
│  │    ├─ categories[] ─── TermCategory definitions                   │  │
│  │    └─ terms[] ──────── GlossaryTerm definitions                   │  │
│  └───────────────────────────────────────────────────────────────────┘  │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Schema Root Definition

### 4.1 Root Object

The root object defines the glossary configuration file structure.

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "glossary.schema.json",
  "title": "Glossary Configuration Schema",
  "description": "Defines game terminology, tooltips, and help text",
  "type": "object",
  "required": ["version", "terms"],
  "additionalProperties": false,
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Schema version (semver format)",
      "examples": ["1.0.0"]
    },
    "categories": {
      "type": "array",
      "description": "Term category definitions",
      "items": { "$ref": "#/definitions/TermCategory" }
    },
    "terms": {
      "type": "array",
      "description": "Glossary term definitions",
      "minItems": 1,
      "items": { "$ref": "#/definitions/GlossaryTerm" }
    },
    "defaultDisplayRules": {
      "type": "array",
      "description": "Default display rules applied to all terms",
      "items": { "$ref": "#/definitions/DisplayRule" }
    }
  }
}
```

### 4.2 Root Properties

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `version` | string | Yes | Schema version in semver format |
| `categories` | array | No | Category definitions |
| `terms` | array | Yes | Term definitions (min 1) |
| `defaultDisplayRules` | array | No | Default display rules for all terms |

---

## 5. GlossaryTerm Definition

### 5.1 Term Schema

```json
{
  "GlossaryTerm": {
    "type": "object",
    "description": "A glossary term with definition and metadata",
    "required": ["id", "term", "definition", "categoryId"],
    "additionalProperties": false,
    "properties": {
      "id": {
        "type": "string",
        "pattern": "^[a-z][a-z0-9-]*$",
        "description": "Unique term identifier",
        "examples": ["critical-hit", "runic-blight", "stress"]
      },
      "term": {
        "type": "string",
        "minLength": 1,
        "maxLength": 100,
        "description": "The word or phrase as displayed"
      },
      "definition": {
        "type": "string",
        "minLength": 1,
        "description": "Full explanation of the term"
      },
      "shortDefinition": {
        "type": "string",
        "maxLength": 150,
        "description": "Tooltip-length version of definition"
      },
      "categoryId": {
        "type": "string",
        "pattern": "^[a-z][a-z0-9-]*$",
        "description": "Reference to parent category"
      },
      "aliases": {
        "type": "array",
        "description": "Alternative terms or spellings",
        "items": {
          "type": "string",
          "minLength": 1
        },
        "uniqueItems": true
      },
      "abbreviation": {
        "type": "string",
        "maxLength": 10,
        "description": "Common abbreviation (e.g., 'HP' for Hit Points)"
      },
      "crossReferences": {
        "type": "array",
        "description": "References to related terms",
        "items": { "$ref": "#/definitions/CrossReference" }
      },
      "displayRules": {
        "type": "array",
        "description": "Context-specific display configuration",
        "items": { "$ref": "#/definitions/DisplayRule" }
      },
      "examples": {
        "type": "array",
        "description": "Usage examples",
        "items": {
          "type": "string"
        }
      },
      "localizationKey": {
        "type": "string",
        "pattern": "^[a-z][a-z0-9_.]*$",
        "description": "Key for localization lookup"
      },
      "sortOrder": {
        "type": "integer",
        "default": 0,
        "description": "Display ordering within category"
      },
      "tags": {
        "type": "array",
        "description": "Searchable tags",
        "items": { "type": "string" }
      },
      "isGameMechanics": {
        "type": "boolean",
        "default": true,
        "description": "If true, term refers to game mechanics (not lore)"
      },
      "firstAppearance": {
        "type": "string",
        "description": "When player typically first encounters this term"
      }
    }
  }
}
```

### 5.2 Term Properties Reference

| Property | Type | Required | Default | Description |
|----------|------|----------|---------|-------------|
| `id` | string | Yes | - | Unique identifier (kebab-case) |
| `term` | string | Yes | - | Display term (1-100 chars) |
| `definition` | string | Yes | - | Full explanation |
| `shortDefinition` | string | No | - | Tooltip version (max 150 chars) |
| `categoryId` | string | Yes | - | Parent category reference |
| `aliases` | array | No | - | Alternative terms |
| `abbreviation` | string | No | - | Short form (max 10 chars) |
| `crossReferences` | array | No | - | Related term references |
| `displayRules` | array | No | - | Context display configuration |
| `examples` | array | No | - | Usage examples |
| `localizationKey` | string | No | - | i18n lookup key |
| `sortOrder` | integer | No | `0` | Category sort order |
| `tags` | array | No | - | Searchable tags |
| `isGameMechanics` | boolean | No | `true` | Mechanics vs lore |
| `firstAppearance` | string | No | - | Where player first sees term |

---

## 6. TermCategory Definition

### 6.1 Category Schema

```json
{
  "TermCategory": {
    "type": "object",
    "description": "A category for organizing glossary terms",
    "required": ["id", "name"],
    "additionalProperties": false,
    "properties": {
      "id": {
        "type": "string",
        "pattern": "^[a-z][a-z0-9-]*$",
        "description": "Unique category identifier"
      },
      "name": {
        "type": "string",
        "minLength": 1,
        "maxLength": 50,
        "description": "Display name for the category"
      },
      "description": {
        "type": "string",
        "maxLength": 200,
        "description": "Brief category description"
      },
      "iconId": {
        "type": "string",
        "description": "Icon asset reference"
      },
      "sortOrder": {
        "type": "integer",
        "minimum": 0,
        "default": 0,
        "description": "Display ordering (lower = first)"
      },
      "color": {
        "type": "string",
        "pattern": "^#[0-9A-Fa-f]{6}$",
        "description": "Category highlight color"
      }
    }
  }
}
```

### 6.2 Standard Categories

The following eight standard categories are defined per the scope breakdown:

| Category ID | Name | Description |
|-------------|------|-------------|
| `combat` | Combat | Battle mechanics and combat terms |
| `magic` | Magic | Galdr, runes, and magical systems |
| `lore` | Lore | World terminology and history |
| `items` | Items | Equipment, artifacts, and consumables |
| `ui` | Interface | UI elements and controls |
| `mechanics` | Mechanics | Game systems and rules |
| `status` | Status Effects | Conditions, buffs, and debuffs |
| `attributes` | Attributes | Character stats and abilities |

---

## 7. CrossReference Definition

### 7.1 Cross-Reference Schema

```json
{
  "CrossReference": {
    "type": "object",
    "description": "A typed reference to another glossary term",
    "required": ["termId", "relationship"],
    "additionalProperties": false,
    "properties": {
      "termId": {
        "type": "string",
        "pattern": "^[a-z][a-z0-9-]*$",
        "description": "Reference to another term ID"
      },
      "relationship": {
        "type": "string",
        "enum": ["SeeAlso", "Contrast", "Prerequisite", "Related"],
        "description": "Type of relationship"
      },
      "note": {
        "type": "string",
        "maxLength": 100,
        "description": "Optional context for the relationship"
      }
    }
  }
}
```

### 7.2 Relationship Types

| Relationship | Description | UI Presentation |
|--------------|-------------|-----------------|
| `SeeAlso` | General related content | "See also: X, Y" |
| `Contrast` | Opposite or contrasting concept | "Compare with: X" |
| `Prerequisite` | Should understand first | "Requires knowledge of: X" |
| `Related` | Same topic or system | "Related terms: X, Y" |

---

## 8. DisplayRule Definition

### 8.1 Display Rule Schema

```json
{
  "DisplayRule": {
    "type": "object",
    "description": "Context-specific display configuration",
    "required": ["context"],
    "additionalProperties": false,
    "properties": {
      "context": {
        "type": "string",
        "enum": ["Tooltip", "Help", "Codex", "Combat", "Inventory"],
        "description": "Display context"
      },
      "showDefinition": {
        "type": "boolean",
        "default": true,
        "description": "Whether to show the definition"
      },
      "showExamples": {
        "type": "boolean",
        "default": false,
        "description": "Whether to include usage examples"
      },
      "maxLength": {
        "type": "integer",
        "minimum": 10,
        "description": "Maximum character length for display"
      },
      "highlightInText": {
        "type": "boolean",
        "default": true,
        "description": "Whether to highlight/link term in text"
      },
      "useAbbreviation": {
        "type": "boolean",
        "default": false,
        "description": "Whether to use abbreviation instead of full term"
      },
      "showCrossReferences": {
        "type": "boolean",
        "default": false,
        "description": "Whether to show related terms"
      }
    }
  }
}
```

### 8.2 Display Contexts Reference

| Context | Description | Typical Settings |
|---------|-------------|------------------|
| `Tooltip` | Hover/popup display | shortDefinition, maxLength: 100-150 |
| `Help` | Help system/manual | Full definition, examples, cross-refs |
| `Codex` | Journal/codex entries | Full content, cross-references |
| `Combat` | Battle UI | Abbreviation, maxLength: 50 |
| `Inventory` | Item/equipment screens | Short definition, no examples |

---

## 9. Configuration Schema

### 9.1 Complete JSON Schema (glossary.schema.json)

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "glossary.schema.json",
  "title": "Glossary Configuration Schema",
  "description": "Defines game terminology, tooltips, and help text for Aethelgard",
  "type": "object",
  "required": ["version", "terms"],
  "additionalProperties": false,
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Schema version (semver format)"
    },
    "categories": {
      "type": "array",
      "description": "Term category definitions",
      "items": { "$ref": "#/definitions/TermCategory" }
    },
    "terms": {
      "type": "array",
      "description": "Glossary term definitions",
      "minItems": 1,
      "items": { "$ref": "#/definitions/GlossaryTerm" }
    },
    "defaultDisplayRules": {
      "type": "array",
      "description": "Default display rules for all terms",
      "items": { "$ref": "#/definitions/DisplayRule" }
    }
  },
  "definitions": {
    "TermCategory": {
      "type": "object",
      "required": ["id", "name"],
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$"
        },
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 50
        },
        "description": {
          "type": "string",
          "maxLength": 200
        },
        "iconId": { "type": "string" },
        "sortOrder": {
          "type": "integer",
          "minimum": 0,
          "default": 0
        },
        "color": {
          "type": "string",
          "pattern": "^#[0-9A-Fa-f]{6}$"
        }
      }
    },
    "GlossaryTerm": {
      "type": "object",
      "required": ["id", "term", "definition", "categoryId"],
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$"
        },
        "term": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100
        },
        "definition": {
          "type": "string",
          "minLength": 1
        },
        "shortDefinition": {
          "type": "string",
          "maxLength": 150
        },
        "categoryId": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$"
        },
        "aliases": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "uniqueItems": true
        },
        "abbreviation": {
          "type": "string",
          "maxLength": 10
        },
        "crossReferences": {
          "type": "array",
          "items": { "$ref": "#/definitions/CrossReference" }
        },
        "displayRules": {
          "type": "array",
          "items": { "$ref": "#/definitions/DisplayRule" }
        },
        "examples": {
          "type": "array",
          "items": { "type": "string" }
        },
        "localizationKey": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9_.]*$"
        },
        "sortOrder": {
          "type": "integer",
          "default": 0
        },
        "tags": {
          "type": "array",
          "items": { "type": "string" }
        },
        "isGameMechanics": {
          "type": "boolean",
          "default": true
        },
        "firstAppearance": { "type": "string" }
      }
    },
    "CrossReference": {
      "type": "object",
      "required": ["termId", "relationship"],
      "additionalProperties": false,
      "properties": {
        "termId": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$"
        },
        "relationship": {
          "type": "string",
          "enum": ["SeeAlso", "Contrast", "Prerequisite", "Related"]
        },
        "note": {
          "type": "string",
          "maxLength": 100
        }
      }
    },
    "DisplayRule": {
      "type": "object",
      "required": ["context"],
      "additionalProperties": false,
      "properties": {
        "context": {
          "type": "string",
          "enum": ["Tooltip", "Help", "Codex", "Combat", "Inventory"]
        },
        "showDefinition": {
          "type": "boolean",
          "default": true
        },
        "showExamples": {
          "type": "boolean",
          "default": false
        },
        "maxLength": {
          "type": "integer",
          "minimum": 10
        },
        "highlightInText": {
          "type": "boolean",
          "default": true
        },
        "useAbbreviation": {
          "type": "boolean",
          "default": false
        },
        "showCrossReferences": {
          "type": "boolean",
          "default": false
        }
      }
    }
  }
}
```

---

## 10. Example Configuration File

### 10.1 glossary.json Example

```json
{
  "$schema": "./glossary.schema.json",
  "version": "1.0.0",
  "defaultDisplayRules": [
    {
      "context": "Tooltip",
      "showDefinition": true,
      "showExamples": false,
      "maxLength": 120,
      "highlightInText": true
    },
    {
      "context": "Help",
      "showDefinition": true,
      "showExamples": true,
      "highlightInText": true,
      "showCrossReferences": true
    }
  ],
  "categories": [
    {
      "id": "combat",
      "name": "Combat",
      "description": "Battle mechanics and combat-related terms",
      "iconId": "icon-sword",
      "sortOrder": 1,
      "color": "#CC3333"
    },
    {
      "id": "magic",
      "name": "Magic",
      "description": "Galdr, runes, and magical systems",
      "iconId": "icon-rune",
      "sortOrder": 2,
      "color": "#6633CC"
    },
    {
      "id": "lore",
      "name": "Lore",
      "description": "World terminology, history, and cultural terms",
      "iconId": "icon-book",
      "sortOrder": 3,
      "color": "#996633"
    },
    {
      "id": "items",
      "name": "Items",
      "description": "Equipment, artifacts, and consumable terminology",
      "iconId": "icon-chest",
      "sortOrder": 4,
      "color": "#339933"
    },
    {
      "id": "ui",
      "name": "Interface",
      "description": "User interface elements and controls",
      "iconId": "icon-interface",
      "sortOrder": 5,
      "color": "#336699"
    },
    {
      "id": "mechanics",
      "name": "Mechanics",
      "description": "Game systems, rules, and progression",
      "iconId": "icon-gear",
      "sortOrder": 6,
      "color": "#666666"
    },
    {
      "id": "status",
      "name": "Status Effects",
      "description": "Conditions, buffs, debuffs, and temporary effects",
      "iconId": "icon-status",
      "sortOrder": 7,
      "color": "#CC6633"
    },
    {
      "id": "attributes",
      "name": "Attributes",
      "description": "Character statistics and ability scores",
      "iconId": "icon-stats",
      "sortOrder": 8,
      "color": "#3399CC"
    }
  ],
  "terms": [
    {
      "id": "critical-hit",
      "term": "Critical Hit",
      "definition": "A critical hit occurs when you roll the maximum value on your attack die, or when specific abilities trigger a critical. Critical hits deal double damage and ignore a portion of the target's armor. Some abilities and equipment can increase your critical hit chance or enhance critical damage.",
      "shortDefinition": "Maximum damage roll dealing double damage and ignoring armor.",
      "categoryId": "combat",
      "abbreviation": "Crit",
      "aliases": ["crit", "critical", "crit hit"],
      "crossReferences": [
        { "termId": "critical-chance", "relationship": "Related" },
        { "termId": "critical-damage", "relationship": "Related" },
        { "termId": "glancing-blow", "relationship": "Contrast" },
        { "termId": "attack", "relationship": "Prerequisite" }
      ],
      "examples": [
        "Your strike finds a gap in the goblin's armor—Critical Hit! 24 damage.",
        "The assassin's precise blow lands a critical, bypassing your shield."
      ],
      "tags": ["damage", "luck", "combat-basics"],
      "sortOrder": 5
    },
    {
      "id": "critical-chance",
      "term": "Critical Chance",
      "definition": "The percentage probability that an attack will result in a critical hit. Base critical chance is typically 5% for most weapons, but can be increased through equipment, abilities, and buffs. Some weapons, like rapiers and daggers, have inherently higher critical chances.",
      "shortDefinition": "Percentage chance to score a critical hit on attacks.",
      "categoryId": "combat",
      "abbreviation": "Crit%",
      "aliases": ["crit chance", "critical rate"],
      "crossReferences": [
        { "termId": "critical-hit", "relationship": "Related" },
        { "termId": "critical-damage", "relationship": "Related" }
      ],
      "tags": ["damage", "statistics"],
      "sortOrder": 6
    },
    {
      "id": "attack",
      "term": "Attack",
      "definition": "The primary offensive action in combat. An attack roll is made against the target's defense value. If the roll meets or exceeds the defense, the attack hits and deals damage. Attack values are modified by your Might attribute, weapon quality, and active buffs.",
      "shortDefinition": "Offensive combat action; roll against target's defense to deal damage.",
      "categoryId": "combat",
      "abbreviation": "ATK",
      "aliases": ["atk", "strike"],
      "crossReferences": [
        { "termId": "defense", "relationship": "Contrast" },
        { "termId": "damage", "relationship": "Related" },
        { "termId": "might", "relationship": "Prerequisite" }
      ],
      "examples": [
        "Attack: Roll 15 vs Defense 12 = Hit!",
        "Your attack value is increased by +3 from your enchanted blade."
      ],
      "tags": ["combat-basics", "offense"],
      "sortOrder": 1
    },
    {
      "id": "defense",
      "term": "Defense",
      "definition": "Your ability to avoid or reduce incoming attacks. Defense is calculated from your base value, armor, shield, and active stances. When an enemy attacks, they must roll equal to or higher than your defense value to hit. Higher defense means fewer hits land.",
      "shortDefinition": "Value attackers must meet or exceed to hit you.",
      "categoryId": "combat",
      "abbreviation": "DEF",
      "aliases": ["def", "armor class", "ac"],
      "crossReferences": [
        { "termId": "attack", "relationship": "Contrast" },
        { "termId": "evasion", "relationship": "Related" },
        { "termId": "damage-reduction", "relationship": "Related" }
      ],
      "tags": ["combat-basics", "defensive"],
      "sortOrder": 2
    },
    {
      "id": "galdr",
      "term": "Galdr",
      "definition": "The Norse magical tradition of runic chanting. Galdr practitioners invoke rune power through specific vocal patterns and inscribed symbols. Unlike sorcery which draws from internal reserves, Galdr channels ambient runic energy through disciplined incantation. Miscast Galdr can result in Blight corruption.",
      "shortDefinition": "Norse runic magic invoked through chanting and inscribed runes.",
      "categoryId": "magic",
      "aliases": ["galdor", "rune magic", "runic chanting"],
      "crossReferences": [
        { "termId": "rune", "relationship": "Prerequisite" },
        { "termId": "miscast", "relationship": "Related" },
        { "termId": "blight-corruption", "relationship": "Related" }
      ],
      "examples": [
        "The skald's galdr echoes through the hall, runes glowing in response.",
        "She traced the protective galdr, warding the camp against spirits."
      ],
      "tags": ["magic-system", "norse", "runes"],
      "isGameMechanics": false,
      "sortOrder": 1
    },
    {
      "id": "rune",
      "term": "Rune",
      "definition": "Ancient symbols of power that form the basis of Galdr magic. Each rune represents a concept—fire, protection, strength—and can be inscribed, spoken, or gestured to invoke its power. Runes are organized into schools, and mastering a school unlocks more potent applications.",
      "shortDefinition": "Magical symbol representing a concept; basis of Galdr magic.",
      "categoryId": "magic",
      "aliases": ["runes", "elder rune"],
      "crossReferences": [
        { "termId": "galdr", "relationship": "Related" },
        { "termId": "rune-school", "relationship": "Related" }
      ],
      "tags": ["magic-system", "norse"],
      "sortOrder": 2
    },
    {
      "id": "runic-blight",
      "term": "Runic Blight",
      "definition": "A corruption that spreads through The Roots, tainting both technology and living beings. Runic Blight is believed to be a side effect of the catastrophe that ended the old world. Exposure to heavy Blight can cause mutations, madness, and transformation into Blighted creatures.",
      "shortDefinition": "Corruption spreading through the land, tainting life and technology.",
      "categoryId": "lore",
      "aliases": ["blight", "the blight", "corruption"],
      "crossReferences": [
        { "termId": "blight-corruption", "relationship": "Related" },
        { "termId": "the-glitch", "relationship": "Prerequisite" }
      ],
      "tags": ["world-lore", "danger", "corruption"],
      "isGameMechanics": false,
      "sortOrder": 1
    },
    {
      "id": "stress",
      "term": "Stress",
      "definition": "Mental strain accumulated through combat, trauma, environmental pressure, and difficult decisions. High stress can trigger psychological effects including panic, rage, or despair. Stress is reduced through rest, positive interactions, and certain abilities. Managing stress is crucial for long expeditions.",
      "shortDefinition": "Mental strain; high levels trigger psychological effects.",
      "categoryId": "mechanics",
      "aliases": ["mental stress", "strain"],
      "crossReferences": [
        { "termId": "rest", "relationship": "Related" },
        { "termId": "panic", "relationship": "Related" },
        { "termId": "resolve", "relationship": "Contrast" }
      ],
      "examples": [
        "Witnessing the horror adds 15 Stress.",
        "Your stress reaches critical levels—roll for affliction."
      ],
      "displayRules": [
        {
          "context": "Combat",
          "showDefinition": true,
          "maxLength": 50,
          "useAbbreviation": false
        }
      ],
      "tags": ["mental-health", "resource", "survival"],
      "sortOrder": 5
    },
    {
      "id": "might",
      "term": "Might",
      "definition": "Physical power and raw strength. Might determines melee damage bonuses, carrying capacity, and success in feats of strength like breaking doors or grappling. Warriors and berserkers benefit most from high Might.",
      "shortDefinition": "Physical strength; affects melee damage and carrying capacity.",
      "categoryId": "attributes",
      "abbreviation": "MIG",
      "aliases": ["str", "strength"],
      "crossReferences": [
        { "termId": "finesse", "relationship": "Contrast" },
        { "termId": "attack", "relationship": "Related" }
      ],
      "tags": ["attribute", "physical", "combat"],
      "sortOrder": 1
    },
    {
      "id": "finesse",
      "term": "Finesse",
      "definition": "Agility, precision, and quick reflexes. Finesse affects ranged accuracy, dodge chance, and delicate tasks like lockpicking. Rogues and archers benefit most from high Finesse.",
      "shortDefinition": "Agility and precision; affects ranged accuracy and dodge.",
      "categoryId": "attributes",
      "abbreviation": "FIN",
      "aliases": ["dex", "dexterity", "agility"],
      "crossReferences": [
        { "termId": "might", "relationship": "Contrast" },
        { "termId": "evasion", "relationship": "Related" }
      ],
      "tags": ["attribute", "physical", "precision"],
      "sortOrder": 2
    },
    {
      "id": "burning",
      "term": "Burning",
      "definition": "A damage-over-time status effect caused by fire. Burning targets take fire damage at the start of each turn and may spread the effect to adjacent allies. Burning can be removed by water, rolling on the ground (takes an action), or specific abilities.",
      "shortDefinition": "Fire DoT; deals damage each turn, may spread to allies.",
      "categoryId": "status",
      "aliases": ["on fire", "ablaze", "ignited"],
      "crossReferences": [
        { "termId": "frozen", "relationship": "Contrast" },
        { "termId": "damage-over-time", "relationship": "Prerequisite" }
      ],
      "examples": [
        "The dragon's breath leaves you Burning (3 damage/turn for 3 turns).",
        "Roll to extinguish or take 5 fire damage."
      ],
      "displayRules": [
        {
          "context": "Combat",
          "showDefinition": true,
          "maxLength": 80
        }
      ],
      "tags": ["debuff", "fire", "dot"],
      "sortOrder": 1
    },
    {
      "id": "frozen",
      "term": "Frozen",
      "definition": "A disabling status effect caused by extreme cold. Frozen targets cannot act and have reduced defense. The effect ends after a set duration or when the target takes fire damage. Frozen targets take double damage from physical attacks but are immune to additional cold effects.",
      "shortDefinition": "Disabled by cold; cannot act, reduced defense, weak to physical.",
      "categoryId": "status",
      "aliases": ["ice", "encased", "frozen solid"],
      "crossReferences": [
        { "termId": "burning", "relationship": "Contrast" },
        { "termId": "stunned", "relationship": "Related" }
      ],
      "displayRules": [
        {
          "context": "Combat",
          "showDefinition": true,
          "maxLength": 80
        }
      ],
      "tags": ["debuff", "cold", "disable"],
      "sortOrder": 2
    },
    {
      "id": "rarity",
      "term": "Rarity",
      "definition": "The quality tier of equipment and items. Rarity affects base statistics, available enchantment slots, and resale value. From lowest to highest: Common (white), Uncommon (green), Rare (blue), Epic (purple), Legendary (orange), Artifact (red).",
      "shortDefinition": "Item quality tier affecting stats and enchantment potential.",
      "categoryId": "items",
      "aliases": ["quality", "tier", "grade"],
      "crossReferences": [
        { "termId": "enchantment", "relationship": "Related" }
      ],
      "examples": [
        "You found a Rare quality longsword with one enchantment slot.",
        "Legendary items have unique abilities that cannot be replicated."
      ],
      "tags": ["equipment", "loot", "progression"],
      "sortOrder": 1
    },
    {
      "id": "codex",
      "term": "Codex",
      "definition": "Your journal's knowledge repository. The Codex automatically collects information about creatures, locations, items, and lore as you discover them. Entries unlock progressively as you gather Data Captures and complete related content. A complete Codex contributes to your Legend.",
      "shortDefinition": "Journal knowledge base; entries unlock through discovery.",
      "categoryId": "ui",
      "aliases": ["journal", "encyclopedia", "bestiary"],
      "crossReferences": [
        { "termId": "legend", "relationship": "Related" },
        { "termId": "data-capture", "relationship": "Prerequisite" }
      ],
      "tags": ["journal", "progression", "knowledge"],
      "sortOrder": 1
    },
    {
      "id": "legend",
      "term": "Legend",
      "definition": "Your character's renown and accumulated accomplishments. Legend increases by completing quests, discovering secrets, filling the Codex, and performing heroic deeds. Higher Legend unlocks new dialogue options, faction opportunities, and end-game content.",
      "shortDefinition": "Renown from accomplishments; unlocks content and opportunities.",
      "categoryId": "mechanics",
      "aliases": ["fame", "renown", "reputation"],
      "crossReferences": [
        { "termId": "codex", "relationship": "Related" }
      ],
      "tags": ["progression", "reputation", "endgame"],
      "sortOrder": 1
    }
  ]
}
```

---

## 11. Logging Specifications

### 11.1 Log Categories

| Category | Level | Description |
|----------|-------|-------------|
| `Glossary.Load` | Info | Schema loading and parsing events |
| `Glossary.Lookup` | Debug | Term lookup operations |
| `Glossary.Validate` | Warning/Error | Validation failures |
| `Glossary.Display` | Debug | Display rule applications |

### 11.2 Log Message Formats

```
[INFO] Glossary.Load: Loaded {count} terms in {categories} categories
[INFO] Glossary.Load: Built term index with {termCount} entries, {aliasCount} aliases
[DEBUG] Glossary.Lookup: Resolved "{word}" → term "{termId}"
[DEBUG] Glossary.Lookup: Abbreviation "{abbrev}" → term "{termId}"
[WARN] Glossary.Validate: Term {termId} references unknown category {categoryId}
[ERROR] Glossary.Validate: Duplicate abbreviation "{abbrev}" in terms {term1}, {term2}
[DEBUG] Glossary.Display: Applied {context} rules to term {termId}: maxLength={len}
```

---

## 12. Unit Testing Requirements

### 12.1 Test Matrix

| Test ID | Test Name | Description | Expected Result |
|---------|-----------|-------------|-----------------|
| GLO-001 | ValidSchemaLoads | Load valid glossary.json against schema | Loads without errors |
| GLO-002 | InvalidTermIdRejected | Term ID not matching pattern | Validation error |
| GLO-003 | CategoryReferenceValidation | Terms reference valid categories | Unknown category rejected |
| GLO-004 | CrossReferenceValidation | Cross-references point to existing terms | Unknown term rejected |
| GLO-005 | DisplayRuleValidation | Display rules have valid contexts | Invalid context rejected |
| GLO-006 | AbbreviationUniqueness | Abbreviations are unique across terms | Duplicate rejected |

### 12.2 Test Specifications

#### GLO-001: ValidSchemaLoads

```
GIVEN a valid glossary.json file
WHEN validated against glossary.schema.json
THEN validation succeeds
AND all terms are parsed
AND term index is built
AND abbreviation index is built
```

#### GLO-002: InvalidTermIdRejected

```
GIVEN a term with id "Invalid_ID"
WHEN validated against schema
THEN validation fails
AND error message indicates pattern mismatch
AND error specifies the invalid ID
```

#### GLO-003: CategoryReferenceValidation

```
GIVEN a term with categoryId "nonexistent-category"
WHEN cross-referenced against categories array
THEN validation fails
AND error identifies the orphaned term
AND error lists the invalid category reference
```

#### GLO-004: CrossReferenceValidation

```
GIVEN a term with crossReference to "unknown-term"
WHEN validated
THEN validation fails
AND error identifies the broken reference
AND both source and target term IDs are named
```

#### GLO-005: DisplayRuleValidation

```
GIVEN a display rule with context "InvalidContext"
WHEN validated against schema
THEN validation fails
AND error indicates context must be one of enum values
```

#### GLO-006: AbbreviationUniqueness

```
GIVEN two terms with abbreviation "HP"
WHEN validated
THEN validation fails
AND error identifies both conflicting terms
AND error specifies the duplicate abbreviation
```

---

## 13. Use Cases

### 13.1 Load Glossary Configuration

```
┌─────────────────────────────────────────────────────────────────────────┐
│ USE CASE: Load Glossary Configuration                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│ Actors: GlossaryProvider, Configuration System                          │
│ Trigger: Game initialization or configuration reload                     │
│                                                                          │
│ Main Flow:                                                               │
│   1. GlossaryProvider locates glossary.json and glossary.schema.json    │
│   2. JSON content is parsed                                              │
│   3. Content is validated against schema                                 │
│   4. Categories array is indexed by id                                   │
│   5. Terms are indexed by id, term text, and aliases                    │
│   6. Abbreviation-to-term mappings are built                            │
│   7. Cross-references are validated (all point to existing terms)       │
│   8. Configuration is cached for runtime access                          │
│                                                                          │
│ Alternate Flow (Validation Failure):                                     │
│   3a. Schema validation fails                                            │
│   3b. Error logged with specific validation failure                      │
│   3c. System continues with empty glossary or cached version             │
│                                                                          │
│ Postconditions:                                                          │
│   - All terms accessible by ID, term text, or alias                      │
│   - Abbreviations resolve to terms                                       │
│   - Category groupings available                                         │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 13.2 Display Term Tooltip

```
┌─────────────────────────────────────────────────────────────────────────┐
│ USE CASE: Display Term Tooltip                                           │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│ Actors: Player, Tooltip System, GlossaryService                         │
│ Trigger: Player hovers over highlighted term                             │
│                                                                          │
│ Main Flow:                                                               │
│   1. Text scanned for known terms during render                          │
│   2. Matched terms highlighted with underline/color                      │
│   3. Player hovers over highlighted term                                 │
│   4. Term looked up by text or alias                                     │
│   5. Display rules for "Tooltip" context applied                         │
│   6. If shortDefinition exists, use it; else truncate definition        │
│   7. Apply maxLength if specified                                        │
│   8. Render tooltip near cursor                                          │
│                                                                          │
│ Tooltip Content:                                                         │
│   ┌────────────────────────────────────────┐                            │
│   │ Critical Hit (Crit)                    │                            │
│   │ Maximum damage roll dealing double     │                            │
│   │ damage and ignoring armor.             │                            │
│   └────────────────────────────────────────┘                            │
│                                                                          │
│ Postconditions:                                                          │
│   - Tooltip displayed with appropriate content                           │
│   - Content respects display rule limits                                 │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 13.3 Search Glossary Terms

```
┌─────────────────────────────────────────────────────────────────────────┐
│ USE CASE: Search Glossary Terms                                          │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│ Actors: Player, Help System, GlossaryService                            │
│ Trigger: Player searches for term in help menu                           │
│                                                                          │
│ Main Flow:                                                               │
│   1. Player opens help/glossary                                          │
│   2. Player enters search query (e.g., "damage")                        │
│   3. Search performed against:                                           │
│      a. Term text (exact and partial match)                             │
│      b. Aliases                                                          │
│      c. Abbreviations                                                    │
│      d. Tags                                                             │
│      e. Definition text (lower priority)                                │
│   4. Results ranked by match quality                                     │
│   5. Results displayed grouped by category                               │
│   6. Player selects result to view full entry                           │
│                                                                          │
│ Search Results Example:                                                  │
│   Query: "damage"                                                        │
│   ┌────────────────────────────────────────┐                            │
│   │ COMBAT                                 │                            │
│   │  • Damage                              │                            │
│   │  • Critical Hit                        │                            │
│   │  • Damage Reduction                    │                            │
│   │ STATUS                                 │                            │
│   │  • Burning (damage over time)          │                            │
│   └────────────────────────────────────────┘                            │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 13.4 Display Full Term Entry

```
┌─────────────────────────────────────────────────────────────────────────┐
│ USE CASE: Display Full Term Entry                                        │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│ Actors: Player, Help System, GlossaryService                            │
│ Trigger: Player selects term in help menu                                │
│                                                                          │
│ Main Flow:                                                               │
│   1. Term looked up by ID                                                │
│   2. Display rules for "Help" context applied                           │
│   3. Full entry rendered:                                                │
│      a. Term name and abbreviation                                       │
│      b. Category badge                                                   │
│      c. Full definition                                                  │
│      d. Examples (if showExamples = true)                               │
│      e. Cross-references (if showCrossReferences = true)                │
│   4. Cross-reference links are clickable                                 │
│                                                                          │
│ Full Entry Example:                                                      │
│   ┌────────────────────────────────────────────────────────────────┐   │
│   │ CRITICAL HIT (Crit)                              [COMBAT]       │   │
│   │                                                                 │   │
│   │ A critical hit occurs when you roll the maximum value on your  │   │
│   │ attack die, or when specific abilities trigger a critical.     │   │
│   │ Critical hits deal double damage and ignore a portion of the   │   │
│   │ target's armor.                                                 │   │
│   │                                                                 │   │
│   │ EXAMPLES                                                        │   │
│   │ • Your strike finds a gap in the goblin's armor—Critical Hit!  │   │
│   │                                                                 │   │
│   │ RELATED TERMS                                                   │   │
│   │ • Critical Chance • Critical Damage                             │   │
│   │ CONTRAST: Glancing Blow                                         │   │
│   │ REQUIRES: Attack                                                │   │
│   └────────────────────────────────────────────────────────────────┘   │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 13.5 Resolve Abbreviation

```
┌─────────────────────────────────────────────────────────────────────────┐
│ USE CASE: Resolve Abbreviation                                           │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│ Actors: Combat UI, GlossaryService                                      │
│ Trigger: UI displays abbreviated stat (e.g., "ATK +5")                  │
│                                                                          │
│ Main Flow:                                                               │
│   1. UI element contains abbreviation "ATK"                              │
│   2. Abbreviation looked up in index                                     │
│   3. Term "attack" found                                                 │
│   4. Display rules for "Combat" context applied                          │
│   5. Tooltip prepared with combat-appropriate content                    │
│   6. On hover, short tooltip displayed                                   │
│                                                                          │
│ Abbreviation Resolution:                                                 │
│   "ATK" → attack                                                        │
│   "DEF" → defense                                                       │
│   "MIG" → might                                                         │
│   "FIN" → finesse                                                       │
│   "Crit" → critical-hit                                                 │
│   "HP" → hit-points                                                     │
│                                                                          │
│ Postconditions:                                                          │
│   - Abbreviation resolved to full term                                   │
│   - Context-appropriate display provided                                 │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 14. Deliverable Checklist

### Configuration Files

| Item | Status | Notes |
|------|--------|-------|
| `glossary.schema.json` | Pending | JSON Schema Draft-07 validation |
| `glossary.json` | Pending | Term definitions |

### Schema Definitions

| Item | Status | Notes |
|------|--------|-------|
| `GlossaryTerm` | Defined | Section 5 |
| `TermCategory` | Defined | Section 6 |
| `CrossReference` | Defined | Section 7 |
| `DisplayRule` | Defined | Section 8 |

### Unit Tests

| Item | Status | Notes |
|------|--------|-------|
| GLO-001: ValidSchemaLoads | Pending | Schema validation |
| GLO-002: InvalidTermIdRejected | Pending | ID pattern enforcement |
| GLO-003: CategoryReferenceValidation | Pending | Category cross-reference |
| GLO-004: CrossReferenceValidation | Pending | Term cross-reference |
| GLO-005: DisplayRuleValidation | Pending | Context enum validation |
| GLO-006: AbbreviationUniqueness | Pending | Uniqueness enforcement |

---

## 15. Acceptance Criteria

### Functional Criteria

| ID | Criterion | Verification |
|----|-----------|--------------|
| AC-01 | Schema validates GlossaryTerm definitions | Run test GLO-001 |
| AC-02 | Term IDs follow kebab-case pattern | Run test GLO-002 |
| AC-03 | Category references validated | Run test GLO-003 |
| AC-04 | Cross-references point to existing terms | Run test GLO-004 |
| AC-05 | Display contexts from enum only | Run test GLO-005 |
| AC-06 | Abbreviations are unique | Run test GLO-006 |
| AC-07 | 8 standard categories defined | Inspect configuration |
| AC-08 | 4 relationship types defined | Inspect schema |
| AC-09 | 5 display contexts defined | Inspect schema |
| AC-10 | Aliases are unique per term | Schema validation |

### Quality Criteria

| ID | Criterion | Verification |
|----|-----------|--------------|
| QC-01 | Schema follows JSON Schema Draft-07 | Schema linter validation |
| QC-02 | All properties have descriptions | Manual inspection |
| QC-03 | Examples provided for term entries | Manual inspection |
| QC-04 | Default values documented | Manual inspection |
| QC-05 | shortDefinition respects maxLength | Manual inspection |

---

## 16. Dependencies

### Required From

| Version | Component | Usage |
|---------|-----------|-------|
| None | - | Glossary Schema has no external dependencies |

### Provides To

| Version | Component | Usage |
|---------|-----------|-------|
| v0.15.x | Tooltip System | Term resolution and display |
| v0.15.x | Help System | Term lookup and search |
| v0.14.10c | Codex Schema | Term linking in entries |
| v0.15.x | Combat UI | Abbreviation resolution |

---

## 17. Future Considerations

### Deferred to Future Versions

| Feature | Rationale |
|---------|-----------|
| Localization content | Localization system separate concern |
| Dynamic term generation | Runtime complexity beyond schema scope |
| User-defined terms | Player customization not in scope |
| Voice pronunciation | Audio system beyond current scope |
| Term versioning | Content management separate concern |

### Extension Points

| Extension | Mechanism |
|-----------|-----------|
| Additional categories | Extend categories array |
| New relationship types | Extend relationship enum |
| Additional display contexts | Extend context enum |
| Custom display rules | Per-term displayRules override |
| Localization | localizationKey for i18n lookup |

---

## 18. Appendix

### A. ID Pattern Reference

| Entity | Pattern | Example |
|--------|---------|---------|
| Term ID | `[a-z][a-z0-9-]*` | `critical-hit`, `runic-blight` |
| Category ID | `[a-z][a-z0-9-]*` | `combat`, `magic` |
| Abbreviation | `[A-Z]{2,10}` | `ATK`, `DEF`, `Crit` |
| Localization Key | `[a-z][a-z0-9_.]*` | `glossary.combat.critical_hit` |

### B. Standard Abbreviations

| Abbreviation | Term | Category |
|--------------|------|----------|
| `ATK` | Attack | Combat |
| `DEF` | Defense | Combat |
| `MIG` | Might | Attributes |
| `FIN` | Finesse | Attributes |
| `WIL` | Will | Attributes |
| `INT` | Intellect | Attributes |
| `HP` | Hit Points | Mechanics |
| `MP` | Mana Points | Mechanics |
| `Crit` | Critical Hit | Combat |
| `DoT` | Damage over Time | Status |

### C. Category Color Reference

| Category | Color | Hex |
|----------|-------|-----|
| Combat | Red | `#CC3333` |
| Magic | Purple | `#6633CC` |
| Lore | Brown | `#996633` |
| Items | Green | `#339933` |
| Interface | Blue | `#336699` |
| Mechanics | Gray | `#666666` |
| Status | Orange | `#CC6633` |
| Attributes | Cyan | `#3399CC` |

### D. Display Context Settings

| Context | Default maxLength | showExamples | showCrossRefs |
|---------|-------------------|--------------|---------------|
| Tooltip | 120 | false | false |
| Help | unlimited | true | true |
| Codex | unlimited | true | true |
| Combat | 50 | false | false |
| Inventory | 150 | false | false |

---

*End of v0.14.10e Design Specification*
