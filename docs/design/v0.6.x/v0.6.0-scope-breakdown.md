# v0.6.0 Core UI Framework - Scope Breakdown

**Version:** 0.6.0
**Theme:** Core UI Framework
**Prerequisites:** v0.5.3c Complete (Area Effects)
**Total Estimated Tests:** ~30 new tests

---

## Executive Summary

The Core UI Framework sub-version establishes the foundational infrastructure for all TUI enhancements. This includes a panel-based screen layout system, a persistent status bar for player information, and a colored text theme system for consistent message styling. These components form the base layer that all subsequent v0.6.x features build upon.

Key focus areas:
- **Screen Layout**: Panel management, positioning, and rendering
- **Status Bar**: Always-visible player status display
- **Color Themes**: Configurable message colorization

The work is divided into **three sub-parts**:

| Part | Name | Focus | Est. Tests |
|------|------|-------|------------|
| v0.6.0a | Screen Layout System | Panel management, terminal detection, responsive sizing | ~12 |
| v0.6.0b | Status Bar | Persistent status display, auto-refresh | ~8 |
| v0.6.0c | Color Themes | Theme configuration, message type colors | ~10 |

---

## Existing Infrastructure

### Already Implemented (from v0.5.x)

| Feature | Location | Notes |
|---------|----------|-------|
| GridRenderer | `Presentation/Adapters/GridRenderer.cs` | ASCII grid rendering |
| GameRenderer | `Presentation/Adapters/GameRenderer.cs` | Output rendering |
| CommandHandler | `Presentation/Commands/CommandHandler.cs` | Input processing |
| Player | `Domain/Entities/Player.cs` | Player state (HP, inventory) |
| Console output | `System.Console` | Basic console operations |

### Needs Implementation (v0.6.0)

| Feature | Part | Notes |
|---------|------|-------|
| ITerminalService | v0.6.0a | Terminal abstraction |
| TerminalService | v0.6.0a | Terminal operations |
| Panel | v0.6.0a | Panel value object |
| ScreenLayout | v0.6.0a | Layout manager |
| StatusBar | v0.6.0b | Status component |
| IColorThemeService | v0.6.0c | Theme interface |
| ColorThemeService | v0.6.0c | Theme management |
| ColorThemeConfig | v0.6.0c | Theme configuration |

---

## Feature Analysis & Categorization

### Screen Layout Features

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| Terminal size detection | Medium | Console API | **v0.6.0a** |
| Panel value object | Low | None | **v0.6.0a** |
| ScreenLayout manager | High | Terminal service | **v0.6.0a** |
| Responsive resizing | Medium | Terminal events | **v0.6.0a** |

### Status Bar Features

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| StatusBar component | Medium | ScreenLayout | **v0.6.0b** |
| Auto-refresh on change | Medium | Player state events | **v0.6.0b** |

### Color Theme Features

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| Theme configuration | Low | JSON loading | **v0.6.0c** |
| ColorThemeService | Medium | Configuration | **v0.6.0c** |
| Message type colors | Low | Theme service | **v0.6.0c** |

---

## Part Definitions

---

## v0.6.0a: Screen Layout System

[v0.6.0a Design Specification](v0.6.0a-design-specification.md)

### Overview

Implement the foundational screen layout system including terminal abstraction, panel management, and responsive sizing. This establishes the container framework that all UI components render within.

### Scope

**In Scope:**
- `ITerminalService` interface for terminal abstraction
- `TerminalService` implementation
- Terminal size detection (`Console.WindowWidth`, `Console.WindowHeight`)
- Terminal resize event handling
- `Panel` value object with position, size, content
- `PanelPosition` enum (MainContent, Sidebar, Footer, Input)
- `ScreenLayout` class for panel management
- Panel registration and ordering
- Panel content rendering
- Responsive resize behavior
- Minimum terminal size validation
- Border drawing utilities

**Out of Scope:**
- Status bar content (v0.6.0b)
- Color themes (v0.6.0c)
- Visual components (v0.6.1)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Application Interfaces | 1 | `ITerminalService` |
| Infrastructure Services | 1 | `TerminalService` |
| Presentation Classes | 1 | `ScreenLayout` |
| Value Objects | 2 | `Panel`, `PanelPosition` |
| Unit Tests | ~12 | Layout, panel, resize tests |

### Terminal Service Architecture

```
┌─────────────────────────────────────────────────────────────────────┐
│                    TERMINAL SERVICE ARCHITECTURE                     │
└─────────────────────────────────────────────────────────────────────┘

    ┌────────────────────────────────────────────────────────────┐
    │                    ITerminalService                         │
    ├────────────────────────────────────────────────────────────┤
    │ + GetSize(): (int Width, int Height)                       │
    │ + SetCursorPosition(x, y): void                            │
    │ + Write(text): void                                        │
    │ + WriteLine(text): void                                    │
    │ + Clear(): void                                            │
    │ + OnResize: event Action<(int, int)>                       │
    │ + SupportsColor: bool                                      │
    │ + SupportsUnicode: bool                                    │
    └────────────────────────────────────────────────────────────┘
                              │
                              ▼
    ┌────────────────────────────────────────────────────────────┐
    │                    TerminalService                          │
    ├────────────────────────────────────────────────────────────┤
    │ (Wraps System.Console with abstraction)                    │
    │ (Handles resize polling for terminals without events)      │
    │ (Detects color/unicode capability)                         │
    └────────────────────────────────────────────────────────────┘
```

### ITerminalService Interface

```csharp
namespace RuneAndRust.Application.Interfaces;

/// <summary>
/// Abstracts terminal operations for cross-platform compatibility.
/// </summary>
public interface ITerminalService
{
    /// <summary>Gets the current terminal size.</summary>
    (int Width, int Height) GetSize();
    
    /// <summary>Sets the cursor position.</summary>
    void SetCursorPosition(int x, int y);
    
    /// <summary>Writes text at current position.</summary>
    void Write(string text);
    
    /// <summary>Writes a line at current position.</summary>
    void WriteLine(string text);
    
    /// <summary>Clears the terminal.</summary>
    void Clear();
    
    /// <summary>Clears a specific region.</summary>
    void ClearRegion(int x, int y, int width, int height);
    
    /// <summary>Event raised when terminal is resized.</summary>
    event Action<(int Width, int Height)>? OnResize;
    
    /// <summary>Gets whether color output is supported.</summary>
    bool SupportsColor { get; }
    
    /// <summary>Gets whether Unicode output is supported.</summary>
    bool SupportsUnicode { get; }
}
```

### Panel Value Object

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Represents a rectangular panel in the screen layout.
/// </summary>
public readonly record struct Panel(
    PanelPosition Position,
    int X,
    int Y,
    int Width,
    int Height,
    string? Title = null,
    bool HasBorder = true
)
{
    /// <summary>Gets the inner content area dimensions.</summary>
    public (int X, int Y, int Width, int Height) ContentArea =>
        HasBorder 
            ? (X + 1, Y + 1, Width - 2, Height - 2)
            : (X, Y, Width, Height);
}

/// <summary>
/// Defines standard panel positions in the layout.
/// </summary>
public enum PanelPosition
{
    MainContent,   // Primary content area (left/center)
    Sidebar,       // Right sidebar for status
    Footer,        // Bottom status bar
    Input,         // Command input area
    Popup          // Modal/overlay panels
}
```

### ScreenLayout Class

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Manages screen layout with multiple panels.
/// </summary>
public class ScreenLayout
{
    private readonly ITerminalService _terminal;
    private readonly Dictionary<PanelPosition, Panel> _panels = new();
    private readonly ILogger<ScreenLayout> _logger;
    
    public ScreenLayout(ITerminalService terminal, ILogger<ScreenLayout> logger)
    {
        _terminal = terminal;
        _logger = logger;
        _terminal.OnResize += HandleResize;
        RecalculateLayout();
    }
    
    /// <summary>Gets a panel by position.</summary>
    public Panel? GetPanel(PanelPosition position);
    
    /// <summary>Renders content to a specific panel.</summary>
    public void RenderToPanel(PanelPosition position, IReadOnlyList<string> lines);
    
    /// <summary>Clears a panel's content.</summary>
    public void ClearPanel(PanelPosition position);
    
    /// <summary>Recalculates all panel positions based on terminal size.</summary>
    public void RecalculateLayout();
    
    /// <summary>Draws borders for all panels.</summary>
    public void DrawBorders();
    
    /// <summary>Gets minimum required terminal size.</summary>
    public static (int Width, int Height) MinimumSize => (80, 24);
}
```

### Screen Layout Design

```
MINIMUM LAYOUT (80x24):
┌──────────────────────────────────────────────────────────────────────────────┐
│                                                                              │
│  ┌───────────────────────────────────────────┐ ┌──────────────────────────┐  │
│  │             MAIN CONTENT                  │ │        SIDEBAR           │  │
│  │                                           │ │                          │  │
│  │   (60 chars wide, 18 lines tall)          │ │  (16 chars wide)         │  │
│  │                                           │ │                          │  │
│  │   Room descriptions, combat log,          │ │  Quick stats,            │  │
│  │   messages, ASCII art, etc.               │ │  location, etc.          │  │
│  │                                           │ │                          │  │
│  │                                           │ │                          │  │
│  │                                           │ │                          │  │
│  │                                           │ │                          │  │
│  └───────────────────────────────────────────┘ └──────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────────────────────┐   │
│  │                           FOOTER (Status Bar)                         │   │
│  └───────────────────────────────────────────────────────────────────────┘   │
│  > [INPUT]                                                                   │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

EXPANDED LAYOUT (120x40):
┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  ┌──────────────────────────────────────────────────────────────────────────┐ ┌─────────────────────────────────────┐  │
│  │                              MAIN CONTENT                                 │ │              SIDEBAR                │  │
│  │                                                                           │ │                                     │  │
│  │                          (Expands to fill)                                │ │         (Fixed width: 30)           │  │
│  │                                                                           │ │                                     │  │
...
```

### Layout Calculation Algorithm

```
RESPONSIVE LAYOUT ALGORITHM:
────────────────────────────

1. Get terminal size (w, h)
2. Validate minimum size (80x24)
3. Calculate layout:
   
   SIDEBAR_WIDTH = min(30, w * 0.25)  // 25% or max 30 chars
   MAIN_WIDTH = w - SIDEBAR_WIDTH - 3  // Remaining minus borders
   
   FOOTER_HEIGHT = 1
   INPUT_HEIGHT = 1
   CONTENT_HEIGHT = h - FOOTER_HEIGHT - INPUT_HEIGHT - 2
   
   Panels:
   - MainContent: (1, 1, MAIN_WIDTH, CONTENT_HEIGHT)
   - Sidebar: (MAIN_WIDTH + 2, 1, SIDEBAR_WIDTH, CONTENT_HEIGHT)
   - Footer: (1, CONTENT_HEIGHT + 1, w - 2, FOOTER_HEIGHT)
   - Input: (1, h - 1, w - 2, INPUT_HEIGHT)

4. On resize: Recalculate and redraw borders
```

### Acceptance Criteria

- [ ] TerminalService wraps Console operations
- [ ] Terminal size detection works
- [ ] Resize events are handled
- [ ] Panel positions calculate correctly
- [ ] ScreenLayout manages multiple panels
- [ ] Content renders to correct panel
- [ ] Borders draw correctly
- [ ] Minimum size validation works
- [ ] Responsive resizing recalculates layout
- [ ] ~12 unit tests pass

---

## v0.6.0b: Status Bar

[v0.6.0b Design Specification](v0.6.0b-design-specification.md)

### Overview

Implement the persistent status bar component that displays always-visible player information in the footer panel. The status bar auto-refreshes when player state changes.

### Scope

**In Scope:**
- `StatusBar` component class
- Status bar content formatting
- HP/MP/XP display
- Gold display
- Location display
- Turn/round indicator (in combat)
- `IStatusBarDataProvider` interface
- Auto-refresh on player state changes
- Status bar update events
- Compact vs expanded format

**Out of Scope:**
- Color themes (v0.6.0c)
- Health bar visualization (v0.6.1)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Presentation Classes | 1 | `StatusBar` |
| Application Interfaces | 1 | `IStatusBarDataProvider` |
| Event Handlers | 1 | State change listener |
| Unit Tests | ~8 | Status bar rendering, refresh tests |

### StatusBar Component

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Renders the persistent status bar in the footer panel.
/// </summary>
public class StatusBar
{
    private readonly IStatusBarDataProvider _dataProvider;
    private readonly ScreenLayout _layout;
    private readonly ILogger<StatusBar> _logger;
    
    public StatusBar(
        IStatusBarDataProvider dataProvider,
        ScreenLayout layout,
        ILogger<StatusBar> logger)
    {
        _dataProvider = dataProvider;
        _layout = layout;
        _logger = logger;
        
        _dataProvider.OnDataChanged += Refresh;
    }
    
    /// <summary>Renders the status bar to the footer panel.</summary>
    public void Render();
    
    /// <summary>Refreshes the status bar content.</summary>
    public void Refresh();
    
    /// <summary>Formats the status bar content for the available width.</summary>
    private string FormatContent(int availableWidth);
}
```

### IStatusBarDataProvider Interface

```csharp
namespace RuneAndRust.Application.Interfaces;

/// <summary>
/// Provides data for the status bar display.
/// </summary>
public interface IStatusBarDataProvider
{
    /// <summary>Gets current HP.</summary>
    (int Current, int Max) Health { get; }
    
    /// <summary>Gets current primary resource (MP, Rage, etc.).</summary>
    (int Current, int Max, string Name)? PrimaryResource { get; }
    
    /// <summary>Gets current XP progress.</summary>
    (int Current, int ToNext) Experience { get; }
    
    /// <summary>Gets current gold.</summary>
    int Gold { get; }
    
    /// <summary>Gets current location name.</summary>
    string Location { get; }
    
    /// <summary>Gets combat turn info if in combat.</summary>
    (int Round, bool IsPlayerTurn)? CombatInfo { get; }
    
    /// <summary>Event raised when any data changes.</summary>
    event Action? OnDataChanged;
}
```

### Status Bar Formats

```
COMPACT FORMAT (< 100 width):
┌────────────────────────────────────────────────────────────────────┐
│ HP:80/100 | MP:60/100 | XP:450/1000 | Gold:150 | Dark Cave         │
└────────────────────────────────────────────────────────────────────┘

EXPANDED FORMAT (>= 100 width):
┌────────────────────────────────────────────────────────────────────────────────────────────┐
│ Health: 80/100 | Mana: 60/100 | XP: 450/1000 (Level 5) | Gold: 150 | Location: Dark Cave  │
└────────────────────────────────────────────────────────────────────────────────────────────┘

COMBAT FORMAT:
┌────────────────────────────────────────────────────────────────────┐
│ HP:80/100 | MP:60/100 | Round 3 | YOUR TURN | Dark Cave            │
└────────────────────────────────────────────────────────────────────┘

LOW HP WARNING:
┌────────────────────────────────────────────────────────────────────┐
│ HP:15/100 ⚠ | MP:60/100 | XP:450/1000 | Gold:150 | Dark Cave       │
└────────────────────────────────────────────────────────────────────┘
```

### Auto-Refresh Flow

```
    Player State Change              StatusBar
    ──────────────────              ─────────
    
    [HP Changed] ──────────┐
                           │   ┌─────────────────────────┐
    [Gold Changed] ────────┼──▶│   IStatusBarDataProvider │
                           │   │   OnDataChanged event    │
    [Room Changed] ────────┘   └───────────┬─────────────┘
                                           │
                                           ▼
                               ┌─────────────────────────┐
                               │       StatusBar         │
                               │       Refresh()         │
                               │       Render()          │
                               └───────────┬─────────────┘
                                           │
                                           ▼
                               ┌─────────────────────────┐
                               │     Footer Panel        │
                               │     (Updated)           │
                               └─────────────────────────┘
```

### Acceptance Criteria

- [ ] StatusBar renders to footer panel
- [ ] HP displays correctly (current/max)
- [ ] MP/resource displays correctly
- [ ] XP displays correctly
- [ ] Gold displays correctly
- [ ] Location name displays
- [ ] Combat mode shows round/turn
- [ ] Auto-refresh on player state change
- [ ] Compact format for narrow terminals
- [ ] ~8 unit tests pass

---

## v0.6.0c: Color Themes

[v0.6.0c Design Specification](v0.6.0c-design-specification.md)

### Overview

Implement the color theme system including theme configuration, a color theme service for managing themes, and message type color mapping for consistent styled output.

### Scope

**In Scope:**
- `ColorThemeConfig` value object
- `IColorThemeService` interface
- `ColorThemeService` implementation
- Theme loading from `themes.json`
- Message type color mapping
- Default theme (dark)
- Optional light theme
- Color fallback for limited terminals
- Console color application
- `ColoredText` value object

**Out of Scope:**
- Custom user themes (future)
- RGB/256-color support (future)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Application Interfaces | 1 | `IColorThemeService` |
| Application Services | 1 | `ColorThemeService` |
| Value Objects | 2 | `ColorThemeConfig`, `ColoredText` |
| Configuration | 1 | `themes.json` |
| Unit Tests | ~10 | Theme loading, color application tests |

### Color Theme Architecture

```
┌─────────────────────────────────────────────────────────────────────┐
│                    COLOR THEME ARCHITECTURE                          │
└─────────────────────────────────────────────────────────────────────┘

    Configuration                   Service                    Output
    ─────────────                   ───────                    ──────
    
    ┌─────────────┐            ┌──────────────────┐       ┌───────────┐
    │ themes.json │──────────▶│ ColorThemeService │──────▶│ Console   │
    │             │            │                  │       │ (Colored) │
    │ dark:       │            │ GetColor(type)   │       └───────────┘
    │   combat-hit│            │ WriteColored()   │
    │   combat-miss            │ CurrentTheme     │
    │   ...       │            │                  │
    └─────────────┘            └──────────────────┘
```

### IColorThemeService Interface

```csharp
namespace RuneAndRust.Application.Interfaces;

/// <summary>
/// Manages color themes for styled console output.
/// </summary>
public interface IColorThemeService
{
    /// <summary>Gets the current theme name.</summary>
    string CurrentTheme { get; }
    
    /// <summary>Sets the active theme.</summary>
    void SetTheme(string themeName);
    
    /// <summary>Gets the color for a message type.</summary>
    ConsoleColor GetColor(MessageType type);
    
    /// <summary>Gets available theme names.</summary>
    IReadOnlyList<string> AvailableThemes { get; }
    
    /// <summary>Writes colored text to the terminal.</summary>
    void WriteColored(string text, MessageType type);
    
    /// <summary>Writes colored text to a specific position.</summary>
    void WriteColoredAt(int x, int y, string text, MessageType type);
}

/// <summary>
/// Defines message types for color mapping.
/// </summary>
public enum MessageType
{
    // System messages
    Default,
    Info,
    Warning,
    Error,
    
    // Combat messages
    CombatHit,
    CombatMiss,
    CombatHeal,
    CombatDamage,
    CombatCritical,
    
    // Loot/items
    LootCommon,
    LootUncommon,
    LootRare,
    LootEpic,
    LootLegendary,
    
    // Other
    Dialogue,
    Description,
    Command,
    Success,
    Failure
}
```

### Theme Configuration

```json
{
  "$schema": "./schemas/themes.schema.json",
  "defaultTheme": "dark",
  "themes": {
    "dark": {
      "name": "Dark Theme",
      "background": "Black",
      "foreground": "Gray",
      "messageColors": {
        "default": "Gray",
        "info": "Cyan",
        "warning": "Yellow",
        "error": "Red",
        "combat-hit": "Red",
        "combat-miss": "DarkGray",
        "combat-heal": "Green",
        "combat-damage": "DarkRed",
        "combat-critical": "Magenta",
        "loot-common": "White",
        "loot-uncommon": "Green",
        "loot-rare": "Blue",
        "loot-epic": "Magenta",
        "loot-legendary": "Yellow",
        "dialogue": "Yellow",
        "description": "DarkGray",
        "command": "White",
        "success": "Green",
        "failure": "Red"
      }
    },
    "light": {
      "name": "Light Theme",
      "background": "White",
      "foreground": "Black",
      "messageColors": {
        "default": "Black",
        "info": "DarkCyan",
        "warning": "DarkYellow",
        "error": "DarkRed",
        "combat-hit": "DarkRed",
        "combat-miss": "Gray",
        "combat-heal": "DarkGreen",
        "combat-damage": "Red",
        "combat-critical": "DarkMagenta",
        "loot-common": "Black",
        "loot-uncommon": "DarkGreen",
        "loot-rare": "DarkBlue",
        "loot-epic": "DarkMagenta",
        "loot-legendary": "DarkYellow",
        "dialogue": "DarkYellow",
        "description": "Gray",
        "command": "Black",
        "success": "DarkGreen",
        "failure": "DarkRed"
      }
    }
  }
}
```

### ColoredText Value Object

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Represents text with associated color information.
/// </summary>
public readonly record struct ColoredText(
    string Text,
    MessageType Type,
    ConsoleColor? ExplicitColor = null
)
{
    /// <summary>Creates default colored text.</summary>
    public static ColoredText Default(string text) => new(text, MessageType.Default);
    
    /// <summary>Creates info colored text.</summary>
    public static ColoredText Info(string text) => new(text, MessageType.Info);
    
    /// <summary>Creates combat hit colored text.</summary>
    public static ColoredText CombatHit(string text) => new(text, MessageType.CombatHit);
    
    // ... more factory methods
}
```

### Color Application Example

```
COMBAT OUTPUT WITH COLORS:
──────────────────────────

You attack the Skeleton!            [Default - Gray]
  * SLASH *                         [CombatHit - Red]
  ──────▶ 12 damage!                [CombatDamage - DarkRed]

Skeleton attacks you!               [Default - Gray]
  MISS!                             [CombatMiss - DarkGray]
The Skeleton's attack misses.       [Description - DarkGray]

You cast Healing Light!             [Default - Gray]
  +15 HP                            [CombatHeal - Green]

CRITICAL HIT!                       [CombatCritical - Magenta]
  ──────▶ 24 damage!                [CombatDamage - DarkRed]

You found: Legendary Sword          [LootLegendary - Yellow]
```

### Acceptance Criteria

- [ ] Themes load from JSON configuration
- [ ] Default theme applies on startup
- [ ] Theme can be changed at runtime
- [ ] Message types map to correct colors
- [ ] WriteColored outputs correct color
- [ ] Color fallback works for limited terminals
- [ ] Available themes are listable
- [ ] ColoredText creates typed text
- [ ] Combat messages use combat colors
- [ ] Loot messages use rarity colors
- [ ] ~10 unit tests pass

---

## Dependencies & Prerequisites

```
v0.5.3c (Area Effects) - REQUIRED
    │
    └── Combat grid, console output ─────────────────────────────────┐
                                                                     │
v0.6.0 (Core UI Framework)                                           │
    │                                                                │
    ├── v0.6.0a: Screen Layout System ───────────────────────────────┤
    │       Dependencies: System.Console                             │
    │       Provides: ITerminalService, ScreenLayout, Panel          │
    │                                                                │
    ├── v0.6.0b: Status Bar ─────────────────────────────────────────┤
    │       Dependencies: v0.6.0a (ScreenLayout)                     │
    │       Provides: StatusBar, IStatusBarDataProvider              │
    │                                                                │
    └── v0.6.0c: Color Themes ───────────────────────────────────────┘
            Dependencies: v0.6.0a (TerminalService)
            Provides: IColorThemeService, MessageType colors
```

---

## Estimated Effort Summary

| Part | New Files | Modified Files | Est. Tests | Complexity |
|------|-----------|----------------|------------|------------|
| v0.6.0a | ~4 | ~2 | ~12 | High |
| v0.6.0b | ~2 | ~2 | ~8 | Medium |
| v0.6.0c | ~3 | ~1 | ~10 | Medium |
| **Total** | **~9** | **~5** | **~30** | |

---

## Risk Assessment

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Cross-platform terminal behavior | High | Medium | Abstract via ITerminalService |
| Resize event reliability | Medium | Medium | Polling fallback |
| Color support variations | Medium | Low | Detect support, provide fallback |
| Layout calculation edge cases | Low | Medium | Thorough testing, minimum size |

---

## Design Decisions (Confirmed)

### Terminal Abstraction

| Decision | Value | Notes |
|----------|-------|-------|
| **API** | ITerminalService | Enables testing, cross-platform |
| **Resize Detection** | Event + Polling | Fallback for terminals without events |
| **Minimum Size** | 80x24 | Standard terminal size |

### Panel System

| Decision | Value | Notes |
|----------|-------|-------|
| **Layout Algorithm** | Percentage-based | Responsive to terminal size |
| **Sidebar Width** | 25% or max 30 | Reasonable info display |
| **Border Style** | Unicode box drawing | ASCII fallback available |

### Color Themes

| Decision | Value | Notes |
|----------|-------|-------|
| **Default Theme** | Dark | Most common terminal background |
| **Color Depth** | 16 colors | Maximum compatibility |
| **Fallback** | Monochrome | For terminals without color |

---

## Next Steps

1. **Review & Approve** - Confirm scope breakdown
2. **v0.6.0a Design Spec** - Create detailed design for Screen Layout System
3. **v0.6.0a Implementation** - Build terminal service, layout, panels
4. **v0.6.0b Design Spec** - Create specification for Status Bar
5. **v0.6.0b Implementation** - Build status bar component
6. **v0.6.0c Design Spec** - Create specification for Color Themes
7. **v0.6.0c Implementation** - Build theme service and configuration

---

*This scope breakdown provides a structured approach to implementing v0.6.0 Core UI Framework. Each sub-part builds naturally, with v0.6.0a establishing the layout system that the status bar and color themes integrate with.*
