{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "creation-workflow.schema.json",
    "title": "Character Creation Workflow Configuration",
    "description": "Defines the character creation workflow steps, navigation rules, name validation parameters, and initialization defaults. Part of v0.17.5a Creation Step Enum & State implementation.",
    "type": "object",
    "required": ["workflow", "nameValidation", "initialization"],
    "additionalProperties": false,
    "properties": {
        "$schema": {
            "type": "string",
            "description": "JSON Schema reference for editor validation."
        },
        "workflow": {
            "type": "object",
            "description": "Defines the six-step creation workflow with ordering, navigation rules, and permanent choice markers.",
            "required": ["steps"],
            "additionalProperties": false,
            "properties": {
                "steps": {
                    "type": "array",
                    "description": "The ordered list of creation steps. Must contain exactly 6 entries.",
                    "minItems": 6,
                    "maxItems": 6,
                    "items": {
                        "$ref": "#/definitions/WorkflowStep"
                    }
                }
            }
        },
        "nameValidation": {
            "$ref": "#/definitions/NameValidation"
        },
        "initialization": {
            "$ref": "#/definitions/Initialization"
        }
    },
    "definitions": {
        "WorkflowStep": {
            "type": "object",
            "description": "Defines a single step in the character creation workflow.",
            "required": [
                "step",
                "order",
                "displayName",
                "description",
                "canGoBack",
                "isPermanent"
            ],
            "additionalProperties": false,
            "properties": {
                "step": {
                    "type": "string",
                    "description": "The CharacterCreationStep enum value name.",
                    "enum": [
                        "Lineage",
                        "Background",
                        "Attributes",
                        "Archetype",
                        "Specialization",
                        "Summary"
                    ]
                },
                "order": {
                    "type": "integer",
                    "description": "The 1-based display order of this step.",
                    "minimum": 1,
                    "maximum": 6
                },
                "displayName": {
                    "type": "string",
                    "description": "Human-readable step name for UI headers.",
                    "minLength": 1,
                    "maxLength": 50
                },
                "description": {
                    "type": "string",
                    "description": "Atmospheric step description for display below the title.",
                    "minLength": 1,
                    "maxLength": 200
                },
                "canGoBack": {
                    "type": "boolean",
                    "description": "Whether backward navigation is allowed from this step. False for Step 1 (Lineage)."
                },
                "isPermanent": {
                    "type": "boolean",
                    "description": "Whether this step represents a permanent, irreversible choice. True only for Archetype (Step 4)."
                },
                "permanentWarning": {
                    "type": "string",
                    "description": "Warning message displayed when isPermanent is true. Optional for non-permanent steps.",
                    "minLength": 1,
                    "maxLength": 200
                }
            }
        },
        "NameValidation": {
            "type": "object",
            "description": "Validation rules for character names entered during the Summary step.",
            "required": ["minLength", "maxLength", "allowedPattern"],
            "additionalProperties": false,
            "properties": {
                "minLength": {
                    "type": "integer",
                    "description": "Minimum character name length.",
                    "minimum": 1,
                    "maximum": 10
                },
                "maxLength": {
                    "type": "integer",
                    "description": "Maximum character name length.",
                    "minimum": 10,
                    "maximum": 50
                },
                "allowedPattern": {
                    "type": "string",
                    "description": "Regex pattern for allowed character name characters."
                },
                "profanityFilter": {
                    "type": "array",
                    "description": "List of disallowed name strings.",
                    "items": {
                        "type": "string"
                    }
                }
            }
        },
        "Initialization": {
            "type": "object",
            "description": "Default values for character initialization upon creation confirmation.",
            "required": [
                "startingLegend",
                "startingPP",
                "startingMilestone",
                "legendToNextMilestone",
                "startingStress",
                "resourcesAtMax"
            ],
            "additionalProperties": false,
            "properties": {
                "startingLegend": {
                    "type": "integer",
                    "description": "Initial Legend Points value.",
                    "minimum": 0
                },
                "startingPP": {
                    "type": "integer",
                    "description": "Initial Progression Points value.",
                    "minimum": 0
                },
                "startingMilestone": {
                    "type": "integer",
                    "description": "Initial Milestone value.",
                    "minimum": 0
                },
                "legendToNextMilestone": {
                    "type": "integer",
                    "description": "Legend Points required to reach the next milestone.",
                    "minimum": 100
                },
                "startingStress": {
                    "type": "integer",
                    "description": "Initial Psychic Stress value.",
                    "minimum": 0
                },
                "resourcesAtMax": {
                    "type": "boolean",
                    "description": "Whether to initialize HP, Stamina, and AP at their maximum values."
                }
            }
        }
    }
}
