# v0.0.5c Changelog - Combat Integration

**Released:** 2026-01-07

## Overview

This version integrates the Dice Pool System into combat mechanics, replacing fixed-value combat with dice-based attack and damage rolls. It builds on the Skill Check System (v0.0.5b) to create dynamic, unpredictable combat encounters.

## Features

### Domain Layer

- **CombatRoundResult**: Value object containing full combat round outcome with dice breakdown
- **MonsterCounterAttackResult**: Value object for monster counterattack outcomes
- **AttackSuccessLevel**: Enum for CriticalHit, Hit, Miss, CriticalMiss
- **Updated CombatService**: Integrated DiceService for attack/damage resolution

### Application Layer

- **CombatRoundResultDto**: DTO with full dice breakdown for rendering
- **MonsterCounterAttackResultDto**: DTO for counterattack display

### Combat Resolution Logic

- Attack roll: 1d10 + player attack bonus vs monster defense
- Critical hit on natural 10 (auto-hit, double damage dice)
- Critical miss on natural 1 (auto-miss)
- Damage roll: Weapon dice (default 1d6) + attack bonus
- Monster counterattack follows same rules

## Technical Changes

### Combat Flow
1. Roll 1d10 for attack
2. Add player attack bonus
3. Compare to monster defense
4. On hit: roll damage dice + bonus
5. Apply damage to monster
6. If monster survives: counterattack phase
7. Return complete round result with all dice

### Files Modified
| File | Changes |
|------|---------|
| `CombatService.cs` | Integrated DiceService, dice-based resolution |
| `CombatDtos.cs` | Added full dice breakdown DTOs |

## Testing Summary

| Test File | Tests |
|-----------|-------|
| `CombatServiceDiceTests.cs` | 16 |
| **Total New** | **16** |

**Test Results:**
- Previous: 259 tests
- Current: 275 tests (+16)
- All passing ✓
- Build: 0 errors, 0 warnings

## Acceptance Criteria

| ID | Criterion | Status |
|----|-----------|--------|
| AC-1 | Attack uses 1d10 + bonus | ✓ |
| AC-2 | Critical hit on natural 10 | ✓ |
| AC-3 | Critical miss on natural 1 | ✓ |
| AC-4 | Damage uses weapon dice | ✓ |
| AC-5 | Critical doubles damage dice | ✓ |
| AC-6 | Monster counterattack uses same system | ✓ |
| AC-7 | Results include full dice breakdown | ✓ |

## Dependencies

- **v0.0.5a** (Core Dice Engine): DiceService, DicePool, DiceRollResult
- **v0.0.5b** (Skill Check System): SuccessLevel enum pattern
- **v0.0.4** (Combat System): Existing CombatService refactored

## Next Steps

- **v0.0.5d**: Configuration & Polish (commands, rendering, descriptors)
