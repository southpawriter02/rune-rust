# v0.0.5b Changelog - Skill Check System

**Released:** 2026-01-07

## Overview

This version implements the complete Skill Check System, integrating dice rolling with player attributes and configuration-driven skills and difficulty classes. It builds on the Core Dice Engine (v0.0.5a) to provide a framework for testing abilities against challenges.

## Features

### Domain Layer

- **SkillDefinition**: Configuration-driven skill with primary/secondary attributes, dice pool, category, tags, and untrained penalty support
- **DifficultyClassDefinition**: Named DC thresholds (Trivial through Legendary) with target numbers and colors
- **SkillCheckResult**: Immutable value object with automatic success level determination (CriticalSuccess, Success, Failure, CriticalFailure)

### Application Layer

- **SkillCheckService**: Performs skill checks against named DCs or explicit values, with advantage/disadvantage support
- **DTOs**: `SkillCheckResultDto`, `SkillDefinitionDto`, `DifficultyClassDto`, `ContestedCheckResultDto`

### Infrastructure

- Extended `IGameConfigurationProvider` with 4 new methods: `GetSkills()`, `GetSkillById()`, `GetDifficultyClasses()`, `GetDifficultyClassById()`
- Updated `JsonConfigurationProvider` with lazy-loading and fallback defaults

### Configuration Files

- **skills.json**: 10 skills across 4 categories (Physical, Mental, Social, Specialty/Knowledge)
- **difficulty.json**: 8 difficulty classes from Trivial (DC 5) to Legendary (DC 30)

## Technical Changes

### Skill Check Flow
1. Look up skill definition by ID
2. Calculate attribute bonus (primary + secondary/2)
3. Apply untrained penalty if applicable
4. Roll dice pool with optional advantage
5. Determine success level based on natural roll and total vs DC

### Files Created
| File | Lines |
|------|-------|
| `Domain/Definitions/SkillDefinition.cs` | ~160 |
| `Domain/Definitions/DifficultyClassDefinition.cs` | ~90 |
| `Domain/ValueObjects/SkillCheckResult.cs` | ~130 |
| `Application/Services/SkillCheckService.cs` | ~230 |
| `Application/DTOs/SkillCheckDtos.cs` | ~120 |
| `config/skills.json` | ~120 |
| `config/difficulty.json` | ~70 |

### Files Modified
| File | Changes |
|------|---------|
| `IConfigurationProvider.cs` | +26 lines (4 methods) |
| `JsonConfigurationProvider.cs` | +165 lines |

## API Examples

```csharp
// Perform a skill check against a named DC
var result = skillCheckService.PerformCheck(player, "perception", "moderate");
Console.WriteLine($"{result.SkillName}: {result.TotalResult} vs DC {result.DifficultyClass}");
Console.WriteLine($"Result: {result.SuccessLevel} (Margin: {result.Margin})");

// With advantage
var advantageResult = skillCheckService.PerformCheck(
    player, "stealth", "hard", AdvantageType.Advantage);

// Using explicit DC
var customResult = skillCheckService.PerformCheckWithDC(
    player, "athletics", 22, "Climbing Sheer Cliff");
```

## Testing Summary

| Test File | Tests |
|-----------|-------|
| `SkillDefinitionTests.cs` | 5 |
| `DifficultyClassDefinitionTests.cs` | 4 |
| `SkillCheckResultTests.cs` | 5 |
| `SkillCheckServiceTests.cs` | 7 |
| **Total New** | **21** |

**Test Results:**
- Previous: 238 tests
- Current: 259 tests (+21)
- All passing ✓
- Build: 0 errors, 0 warnings

## Acceptance Criteria

| ID | Criterion | Status |
|----|-----------|--------|
| AC-1 | 10 skills defined | ✓ |
| AC-2 | 8 difficulty classes defined | ✓ |
| AC-3 | Primary attribute bonus applied | ✓ |
| AC-4 | Secondary attributes provide half bonus | ✓ |
| AC-5 | Untrained penalty supported | ✓ |
| AC-6 | Critical success on natural max | ✓ |
| AC-7 | Critical failure on natural 1 | ✓ |
| AC-8 | Advantage/disadvantage supported | ✓ |
| AC-9 | Results include full breakdown | ✓ |
| AC-10 | Unknown skill throws exception | ✓ |

## Dependencies

- **v0.0.5a** (Core Dice Engine): DiceService, DicePool, DiceRollResult
- **v0.0.4** (Player System): PlayerAttributes entity

## Next Steps

- **v0.0.5c**: Combat Integration (dice-based attack/damage rolls)
- **v0.0.5d**: Configuration & Polish (commands, rendering, descriptors)
