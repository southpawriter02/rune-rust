## v0.17.x - Advanced Character Creation System

**Focus:** Complete character creation workflow with lineage selection, backgrounds, attribute allocation, archetype/specialization choices, and creation UI

### Overview

This version implements the comprehensive character creation system that serves as the player's first meaningful decision point in Aethelgard. Every choice has permanent consequences that shape the entire saga. The system supports both quick-start (simple mode) and advanced (point-buy) customization options.

**Design Philosophy:**
- **Permanent Choices** - Lineage, archetype, and specialization cannot be changed after creation
- **Meaningful Differentiation** - Each combination creates a distinct playstyle
- **Thematic Integration** - Choices connect to the world's lore (Runic Blight, Trauma Economy)
- **Quick Start Option** - Simple mode with recommended builds for new players
- **Advanced Customization** - Point-buy system for experienced players
- **Clear Consequences** - UI shows effects before confirming each choice

---

### Version Structure

| Version | Focus | Primary Deliverables |
|---------|-------|----------------------|
| v0.17.0 | Lineage System | Lineage enum, traits, Blight interaction, attribute modifiers |
| v0.17.1 | Background System | Background definitions, starting skills, starting equipment |
| v0.17.2 | Attribute System | Point-buy logic, cost scaling, derived stat calculation |
| v0.17.3 | Archetype System | Archetype definitions, starting abilities, resource pools |
| v0.17.4 | Specialization System | Specialization trees, tier unlocks, path types |
| v0.17.5 | Creation Workflow | Step navigation, validation, persistence, UI |

---

### v0.17.0 - Lineage System

**Source:** Legacy lineage specifications, character-creation.md

#### Lineage Enum
```
Lineage
├── ClanBorn - The Stable Code (baseline humanity)
├── RuneMarked - The Tainted Aether (Mystic affinity)
├── IronBlooded - The Corrupted Earth (physical resilience)
├── VargrKin - The Uncorrupted Echo (primal connection)
```

#### Lineage Bonuses & Traits
| Lineage | Attribute Mod | Passive Bonus | Unique Trait |
|---------|---------------|---------------|--------------|
| Clan-Born | +1 any (choice) | +5 Max HP, +1 Social | `[Survivor's Resolve]` +1d10 to Rhetoric with Clan-Born NPCs |
| Rune-Marked | +2 WILL, -1 STURDINESS | +5 Max AP, +1 Lore | `[Aether-Tainted]` +10% Max AP |
| Iron-Blooded | +2 STURDINESS, -1 WILL | +2 Soak, +1 Craft | `[Hazard Acclimation]` +1d10 vs environmental hazards |
| Vargr-Kin | +1 MIGHT, +1 FINESSE, -1 WILL | +1 Movement, +1 Survival | `[Primal Clarity]` -10% Psychic Stress from all sources |

#### Trauma Economy Integration
| Lineage | Starting Corruption | Starting Stress | Special Vulnerability |
|---------|--------------------|-----------------|-----------------------|
| Clan-Born | 0 | 0 | None (baseline) |
| Rune-Marked | 5 (permanent) | 0 | -1 to resist Corruption |
| Iron-Blooded | 0 | 0 | -1 to resist Psychic Stress |
| Vargr-Kin | 0 | 0 | None (Primal Clarity compensates) |

#### Deliverables
- [ ] `Lineage` enum with 4 values
- [ ] `LineageDefinition` entity with all properties
- [ ] `LineageTrait` value object
- [ ] `ILineageProvider` interface
- [ ] `LineageProvider` with JSON loading
- [ ] Trauma Economy integration hooks
- [ ] Configuration file: `lineages.json`

---

### v0.17.1 - Background System

**Source:** character-creation.md

#### Background Enum
```
Background
├── VillageSmith - Craft focus, physical tools
├── TravelingHealer - Medicine focus, healing supplies
├── RuinDelver - Exploration focus, dungeoneering gear
├── ClanGuard - Combat focus, defensive equipment
├── WanderingSkald - Performance focus, lore items
├── OutcastScavenger - Survival focus, wilderness gear
```

#### Background Effects
| Background | Starting Skills | Starting Equipment |
|------------|-----------------|-------------------|
| Village Smith | Craft +2, Might +1 | Smith's Hammer, Leather Apron |
| Traveling Healer | Medicine +2, Herbalism +1 | Healer's Kit, Bandages ×5 |
| Ruin Delver | Exploration +2, Traps +1 | Lantern, Rope, Lockpicks |
| Clan Guard | Combat +2, Vigilance +1 | Shield, Spear |
| Wandering Skald | Performance +2, Lore +1 | Instrument, Journal |
| Outcast Scavenger | Survival +2, Stealth +1 | Rations ×3, Cloak |

#### Deliverables
- [x] `Background` enum with 6 values
- [x] `BackgroundDefinition` entity
- [x] `StartingSkillGrant` value object
- [x] `StartingEquipmentGrant` value object
- [x] `IBackgroundProvider` interface
- [x] `BackgroundProvider` with JSON loading
- [x] Configuration file: `backgrounds.json`

---

### v0.17.2 - Attribute System

**Source:** character-creation.md

#### Core Attributes
```
CoreAttribute
├── Might - Physical power, melee damage
├── Finesse - Agility, precision, ranged accuracy
├── Wits - Perception, knowledge, crafting
├── Will - Mental fortitude, Aether channeling
├── Sturdiness - Endurance, HP, resilience
```

#### Point-Buy System
```
Starting Pool: 15 Points (14 for Adept)
All Attributes Start at: 1
Maximum: 10 per attribute
Minimum: 1 per attribute

Point Costs:
  Value 2-8: 1 point each
  Value 9: 2 points (cumulative: 9)
  Value 10: 2 points (cumulative: 11)
```

#### Point Cost Table
| Target Value | Individual Cost | Cumulative Cost |
|--------------|-----------------|-----------------|
| 2 | 1 | 1 |
| 3 | 1 | 2 |
| 4 | 1 | 3 |
| 5 | 1 | 4 |
| 6 | 1 | 5 |
| 7 | 1 | 6 |
| 8 | 1 | 7 |
| 9 | 2 | 9 |
| 10 | 2 | 11 |

#### Archetype Recommended Builds (Simple Mode)
| Archetype | MIGHT | FINESSE | WITS | WILL | STURDINESS |
|-----------|-------|---------|------|------|------------|
| Warrior | 4 | 3 | 2 | 2 | 4 |
| Skirmisher | 3 | 4 | 3 | 2 | 3 |
| Mystic | 2 | 3 | 4 | 4 | 2 |
| Adept | 3 | 3 | 3 | 2 | 3 |

#### Derived Stats Calculation
```
Max HP = (STURDINESS × 10) + 50 + (Archetype Bonus) + (Lineage Bonus)
Max Stamina = (FINESSE × 5) + (MIGHT × 5) + 20 + (Archetype Bonus)
Max AP = (WILL × 10) + (WITS × 5) + (Archetype Bonus) + (Lineage Bonus)
```

#### Deliverables
- [ ] `CoreAttribute` enum with 5 values
- [ ] `AttributeAllocationMode` enum (Simple, Advanced)
- [ ] `AttributeSet` value object
- [x] `PointBuyCost` value object
- [x] `IAttributeAllocationService` interface
- [x] `AttributeAllocationService` implementation
- [x] `IDerivedStatCalculator` interface
- [ ] Configuration file: `attribute-costs.json`

---

### v0.17.3 - Archetype System

**Source:** character-creation.md, archetype specifications

#### Archetype Enum
```
Archetype
├── Warrior - Tank / Melee DPS (Stamina-based)
├── Skirmisher - Mobile DPS (Stamina-based)
├── Mystic - Caster / Control (Aether-based)
├── Adept - Support / Utility (Stamina-based)
```

#### Archetype Definitions
| Archetype | Role | Resource | HP Bonus | Key Strength |
|-----------|------|----------|----------|--------------|
| Warrior | Tank / Melee DPS | Stamina | +49 | Highest HP, defensive abilities |
| Skirmisher | Mobile DPS | Stamina | +30 | +1 Movement, evasion |
| Mystic | Caster / Control | Aether Pool | +20 | Ranged Aetheric power |
| Adept | Support / Utility | Stamina | +30 | +20% Consumable effectiveness |

#### Starting Abilities by Archetype
| Archetype | Ability 1 | Ability 2 | Ability 3 |
|-----------|-----------|-----------|-----------|
| Warrior | Strike | Defensive Stance | Warrior's Vigor |
| Skirmisher | Quick Strike | Evasive Stance | Fleet Footed |
| Mystic | Aether Dart | Focus Aether | Aetheric Attunement |
| Adept | Exploit Weakness | Scavenge | Resourceful |

#### Deliverables
- [x] `Archetype` enum with 4 values
- [x] `ArchetypeDefinition` entity
- [x] `ArchetypeResourceBonus` value object
- [x] `ArchetypeAbilityGrant` value object
- [ ] `IArchetypeProvider` interface
- [ ] `ArchetypeProvider` with JSON loading
- [ ] Configuration file: `archetypes.json`

---

### v0.17.4 - Specialization System

**Source:** character-creation.md, specialization specifications

#### Specialization Structure
```
Specialization
├── Archetype: Parent archetype
├── PathType: Coherent or Heretical
├── SpecialResource: Unique resource (if any)
├── AbilityTiers: 3 tiers of unlockable abilities
```

#### Specializations by Archetype
| Archetype | Specializations |
|-----------|-----------------|
| Warrior | Berserkr, Iron-Bane, Skjaldmaer, Skar-Horde, Atgeir-Wielder, Gorge-Maw |
| Skirmisher | Veiðimaðr, Myrk-gengr, Strandhögg, Hlekkr-master |
| Mystic | Seiðkona, Echo-Caller |
| Adept | Bone-Setter, Jötun-Reader, Skald, Scrap-Tinker, Einbúi |

#### Path Types
| Path | Description | Trauma Interaction |
|------|-------------|-------------------|
| Coherent | Works within stable reality | No special Corruption risk |
| Heretical | Interfaces with corrupted Aether | May gain Corruption from abilities |

#### Specialization Unlock Costs
| Unlock | Cost | Notes |
|--------|------|-------|
| First Specialization | Free | Granted at character creation |
| Additional Specialization | 3 PP | Can unlock multiple specializations |
| Tier 1 Abilities | Free | 3 abilities unlocked at selection |
| Tier 2 Abilities | 1 PP each | Requires Tier 1 completion |
| Tier 3 Abilities | 2 PP each | Requires Tier 2 completion |

#### Deliverables
- [ ] `SpecializationPathType` enum (Coherent, Heretical)
- [ ] `SpecializationDefinition` entity
- [ ] `SpecializationAbilityTier` value object
- [ ] `SpecialResourceDefinition` value object
- [ ] `ISpecializationProvider` interface
- [ ] `SpecializationProvider` with JSON loading
- [ ] Configuration file: `specializations.json`

---

### v0.17.5 - Creation Workflow & UI

**Source:** character-creation.md

#### Creation Steps
```
CharacterCreationStep
├── Lineage (Step 1) - Blood heritage
├── Background (Step 2) - Pre-Silence profession
├── Attributes (Step 3) - Point allocation
├── Archetype (Step 4) - Combat role
├── Specialization (Step 5) - Tactical identity
├── Summary (Step 6) - Review & name
```

#### Workflow State Machine
```
┌─────────────────────────────────────────────────────┐
│                  CHARACTER CREATION                  │
├─────────────────────────────────────────────────────┤
│                                                     │
│  [1. Lineage] → [2. Background] → [3. Attributes]  │
│                                                     │
│       ↓                                             │
│                                                     │
│  [4. Archetype] → [5. Specialization] → [6. Summary]│
│                                                     │
│       ↓                                             │
│                                                     │
│  [Confirm] ──→ Initialize Character ──→ Begin Saga │
│                                                     │
│  [Cancel] ──→ Discard & Return to Menu             │
│                                                     │
└─────────────────────────────────────────────────────┘
```

#### Name Validation Rules
| Rule | Requirement |
|------|-------------|
| Length | 2-20 characters |
| Characters | ASCII only (a-z, A-Z, spaces, hyphens) |
| Profanity | Filtered |
| Uniqueness | Not required (per-account) |

#### Character Initialization
```
On Confirm:
  1. Set Saga progression (Legend: 0, PP: 0, Milestone: 0)
  2. Set resources to maximum (HP, Stamina, AP)
  3. Set Trauma values (Stress, Corruption from Lineage)
  4. Grant starting abilities (Archetype + Specialization Tier 1)
  5. Grant starting equipment (from Background)
  6. Grant starting skills (from Background)
  7. Apply Lineage attribute modifiers
  8. Set starting location (Sector entrance)
  9. Persist to database
```

#### Deliverables
- [ ] `CharacterCreationStep` enum
- [ ] `CharacterCreationState` entity
- [ ] `CharacterCreationViewModel` value object
- [ ] `ICharacterCreationController` interface
- [ ] `CharacterCreationController` implementation
- [ ] `ICharacterFactory` interface
- [ ] `CharacterFactory` implementation
- [ ] `NameValidator` service
- [ ] TUI screens for all 6 steps
- [ ] Configuration file: `creation-workflow.json`

---

### Implementation Estimates

| Version | Focus | Entities | Services | Tests |
|---------|-------|----------|----------|-------|
| v0.17.0 | Lineage System | ~3 | ~2 | ~15 |
| v0.17.1 | Background System | ~3 | ~2 | ~12 |
| v0.17.2 | Attribute System | ~3 | ~3 | ~18 |
| v0.17.3 | Archetype System | ~3 | ~2 | ~15 |
| v0.17.4 | Specialization System | ~4 | ~2 | ~15 |
| v0.17.5 | Creation Workflow | ~4 | ~4 | ~20 |
| **Total** | | **~20** | **~15** | **~95** |

---

### Cross-Cutting Concerns

#### Trauma Economy Integration
- Lineage determines starting Corruption (Rune-Marked: 5)
- Lineage affects resistance to gaining Stress/Corruption
- Heretical specializations may grant Corruption-generating abilities
- UI displays Trauma baseline before confirmation

#### Combat System Integration
- Archetype determines base combat stats and abilities
- Specialization grants combat techniques
- Attributes affect attack rolls, damage, and defenses
- Lineage traits provide situational bonuses

#### Progression System Integration
- First specialization is free at creation
- Saga progression (Legend, PP, Milestones) initialized to 0
- Additional specializations cost 3 PP
- Ability tier unlocks cost PP

#### UI/UX Integration
- Six-step wizard with back/forward navigation
- Live preview of derived stats during attribute allocation
- Mode toggle (Simple/Advanced) for attributes
- Clear "permanent choice" warnings for Archetype/Lineage
- ASCII art presentation for each option

---

### Dependencies

**Requires from Previous Versions:**
- v0.4.x-v0.5.x: Basic item/equipment system (for starting equipment)
- v0.10.x: Status effects (for trait implementation)
- v0.11.x: Combat system (for archetype abilities)
- v0.15.x: Dice pool system (for trait bonus dice)

**Provides to Future Versions:**
- Character entity with all creation choices
- Trait system for lineage-specific effects
- Archetype/specialization foundation for ability trees
- Attribute system for all stat-based checks

---

### Configuration Files

| File | Purpose |
|------|---------|
| `lineages.json` | Lineage definitions, traits, modifiers |
| `backgrounds.json` | Background definitions, skills, equipment |
| `attribute-costs.json` | Point-buy cost scaling |
| `archetypes.json` | Archetype definitions, abilities, resources |
| `specializations.json` | Specialization trees, paths, tiers |
| `creation-workflow.json` | Step order, validation rules |

---

### Acceptance Criteria (Overall)

- [ ] Lineage enum has 4 values with unique traits
- [ ] Each lineage has distinct Trauma Economy interaction
- [ ] Clan-Born provides +1 to any attribute (player choice)
- [ ] Rune-Marked starts with 5 permanent Corruption
- [ ] Background provides starting skills and equipment
- [ ] Point-buy system allows 15 points (14 for Adept)
- [ ] Attributes 9-10 cost 2 points each
- [ ] Simple mode applies archetype-recommended builds
- [x] Derived stats calculate correctly from attributes
- [ ] Archetype choice is permanent (cannot be changed)
- [ ] Archetype grants 3 starting abilities
- [ ] First specialization is free
- [ ] Specialization grants Tier 1 abilities (3 abilities)
- [ ] Path type (Coherent/Heretical) is tracked
- [ ] Six-step creation wizard functions correctly
- [ ] Back navigation preserves previous choices
- [ ] Name validation enforces 2-20 characters, ASCII only
- [ ] Character initializes with full resources
- [ ] Starting location is set to sector entrance
- [ ] ~95 unit tests pass
