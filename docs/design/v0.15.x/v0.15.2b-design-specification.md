# v0.15.2b Design Specification: Leaping System

**Version:** 0.15.2b
**Theme:** Leaping System
**Author:** Claude
**Created:** 2026-01-17
**Status:** Draft
**Prerequisites:** v0.15.2a Complete (Climbing System with FallResult, FallSource)

---

## Table of Contents

1. [Overview](#1-overview)
2. [Dependencies](#2-dependencies)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [LeapDistance Enum](#4-leapdistance-enum)
5. [LandingType Enum](#5-landingtype-enum)
6. [LeapContext Value Object](#6-leapcontext-value-object)
7. [LeapResult Value Object](#7-leapresult-value-object)
8. [ILeapingService Interface](#8-ileapingservice-interface)
9. [LeapingService Implementation](#9-leapingservice-implementation)
10. [TheLongFall Fumble Integration](#10-thelongfall-fumble-integration)
11. [Configuration](#11-configuration)
12. [Commands](#12-commands)
13. [User-Facing Changes](#13-user-facing-changes)
14. [Logging Specifications](#14-logging-specifications)
15. [Unit Testing Requirements](#15-unit-testing-requirements)
16. [Use Cases](#16-use-cases)
17. [Deliverable Checklist](#17-deliverable-checklist)
18. [Acceptance Criteria](#18-acceptance-criteria)
19. [Future Considerations](#19-future-considerations)
20. [Implementation Notes](#20-implementation-notes)
21. [Document Metadata](#21-document-metadata)

---

## 1. Overview

### 1.1 Purpose

This document provides a comprehensive design specification for v0.15.2b, the Leaping System phase. This part introduces distance-based leaping mechanics that allow characters to jump across gaps, onto platforms, and over obstacles. The key components are:

1. **LeapDistance Enum**: Categorizes leap distances with associated base DCs ranging from Short (5ft, DC 8) to Heroic (25ft, DC 24).

2. **LeapContext Value Object**: Encapsulates all factors affecting a leap including distance, running start, landing type, encumbrance, and gravity modifiers.

3. **LeapResult Value Object**: Captures the outcome of a leap attempt including success/failure, fall triggering, and stamina costs.

4. **LeapingService**: Orchestrates the leaping system, calculating DCs, processing modifiers, and triggering fall consequences.

This infrastructure enables dynamic horizontal traversal mechanics that complement the vertical climbing system from v0.15.2a.

### 1.2 Current vs. Target Implementation

| Aspect | Current Implementation | Target Implementation |
|--------|------------------------|----------------------|
| **Leap Checks** | Not implemented | Distance-based DC calculation |
| **Running Start** | Not implemented | -2 DC or +5ft effective distance |
| **Landing Modifiers** | Not implemented | Precision (+1 DC), Glitched (+2 DC) |
| **Encumbrance Effects** | Not tracked | +2 DC when encumbered |
| **Gravity Modifiers** | Not implemented | [Low Gravity] -2 DC |
| **Fall Consequences** | Basic from v0.15.2a | Enhanced with `TheLongFall` fumble |
| **Critical Success** | Not implemented | Perfect landing, halved stamina cost |
| **Stamina Integration** | Not implemented | Movement cost for leaps |

### 1.3 Scope

**In Scope:**
- Define `LeapDistance` enum with distance-to-DC mapping
- Define `LandingType` enum for landing surface classification
- Define `LeapContext` value object for leap configuration
- Define `LeapResult` value object for leap outcomes
- Create `ILeapingService` interface for leaping operations
- Implement `LeapingService` with DC calculation and modifier logic
- Integrate `TheLongFall` fumble consequence
- Configuration file `leap-distances.json`
- Unit tests for leaping mechanics (~4 tests)

**Out of Scope:**
- Fall damage calculation - v0.15.2c
- Stealth movement - v0.15.2d
- Chase sequences - v0.15.2e
- Balance checks - v0.15.2f
- Specialization integration (Gantry-Runner `[Death-Defying Leap]`) - v0.15.2g

### 1.4 Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Enums | 2 | `LeapDistance`, `LandingType` |
| Value Objects | 2 | `LeapContext`, `LeapResult` |
| Interfaces | 1 | `ILeapingService` |
| Services | 1 | `LeapingService` |
| Configuration | 1 | `leap-distances.json` |
| Unit Tests | ~4 | DC calculation, running start, fall triggering, fumble handling |

---

## 2. Dependencies

### 2.1 Required from v0.15.0 (Dice Pool Refactor)

| Component | Location | Usage in v0.15.2b |
|-----------|----------|-------------------|
| `DiceRollResult` | `Domain/ValueObjects/DiceRollResult.cs` | Provides `NetSuccesses`, `IsFumble`, `IsCriticalSuccess` |
| `DiceConstants` | `Domain/Constants/DiceConstants.cs` | Success threshold (8), botch value (1) |
| `IDiceRollerService` | `Application/Interfaces/IDiceRollerService.cs` | Performs leap attempt dice rolls |

### 2.2 Required from v0.15.1a (Skill Context & Modifiers)

| Component | Location | Usage in v0.15.2b |
|-----------|----------|-------------------|
| `SkillContext` | `Domain/ValueObjects/SkillContext.cs` | Passed to leap attempts with modifiers |
| `SkillContextBuilder` | `Application/Services/SkillContextBuilder.cs` | Builds context for leap attempts |
| `EquipmentModifier` | `Domain/ValueObjects/EquipmentModifier.cs` | Equipment affecting leaps |
| `EnvironmentModifier` | `Domain/ValueObjects/EnvironmentModifier.cs` | Landing surface, gravity modifiers |

### 2.3 Required from v0.15.1b (Outcome Classification)

| Component | Location | Usage in v0.15.2b |
|-----------|----------|-------------------|
| `SkillOutcome` | `Domain/Enums/SkillOutcome.cs` | Leap result classification |
| `FumbleType` | `Domain/Enums/FumbleType.cs` | `TheLongFall` for leaping fumbles |
| `FumbleConsequenceService` | `Application/Services/FumbleConsequenceService.cs` | Triggers `TheLongFall` on fumble |

### 2.4 Required from v0.15.2a (Climbing System)

| Component | Location | Usage in v0.15.2b |
|-----------|----------|-------------------|
| `FallResult` | `Domain/ValueObjects/FallResult.cs` | Reused for leap fall outcomes |
| `FallSource` | `Domain/Enums/FallSource.cs` | `FallSource.Leaping` for leap falls |

### 2.5 Provides to Future Versions

| Version | Component | Usage |
|---------|-----------|-------|
| v0.15.2c | Fall Damage System | Uses `FallResult` from failed leaps |
| v0.15.2e | Chase Sequences | Uses leaping checks for `Gap` obstacles |
| v0.15.2g | Gantry-Runner | Extends max leap distance via `[Death-Defying Leap]` |

---

## 3. Architecture Diagrams

### 3.1 Leaping System Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         LEAPING SYSTEM FLOW                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  LEAP REQUEST                                                               │
│  Player: "leap 15ft" or "jump gap"                                          │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    DETERMINE BASE DC                                 │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Distance: 15ft                                                     │    │
│  │                                                                      │    │
│  │  Distance-to-DC Mapping:                                            │    │
│  │  ├── 5ft   = DC 8  (Short)                                          │    │
│  │  ├── 10ft  = DC 12 (Medium)                                         │    │
│  │  ├── 15ft  = DC 16 (Long)                                           │    │
│  │  ├── 20ft  = DC 20 (Extreme)                                        │    │
│  │  └── 25ft  = DC 24 (Heroic, Master only)                            │    │
│  │                                                                      │    │
│  │  Base DC: 16                                                        │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    APPLY DC MODIFIERS                                │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  LeapContext                                                        │    │
│  │  ├── Distance: 15ft                                                 │    │
│  │  ├── HasRunningStart: true    → -2 DC                               │    │
│  │  ├── LandingType: Normal      → +0 DC                               │    │
│  │  ├── IsEncumbered: false      → +0 DC                               │    │
│  │  └── HasLowGravity: false     → +0 DC                               │    │
│  │                                                                      │    │
│  │  Base DC: 16                                                        │    │
│  │  Running Start: -2                                                  │    │
│  │  ────────────────                                                   │    │
│  │  Final DC: 14                                                       │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    PERFORM SKILL CHECK                               │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Dice Pool: 5d10 (Acrobatics 3 + Finesse 2)                         │    │
│  │  Roll: [8, 10, 4, 9, 3] → 3 successes, 0 botches                    │    │
│  │  vs DC 14                                                           │    │
│  │                                                                      │    │
│  │  Wait - DC 14 means we need 14 net successes?                       │    │
│  │  No! DC in success-counting = target successes needed               │    │
│  │  We rolled 3 successes vs DC 3 (adjusted from distance)             │    │
│  │                                                                      │    │
│  │  Recalculating with success-counting DCs:                           │    │
│  │  ├── 5ft   = DC 1 (Short)                                           │    │
│  │  ├── 10ft  = DC 2 (Medium)                                          │    │
│  │  ├── 15ft  = DC 3 (Long)                                            │    │
│  │  ├── 20ft  = DC 4 (Extreme)                                         │    │
│  │  └── 25ft  = DC 5 (Heroic)                                          │    │
│  │                                                                      │    │
│  │  Final DC: 3 - 0 (running start halves effective distance) = 3      │    │
│  │  Actually: Running start = +5ft effective OR -1 DC                  │    │
│  │  DC 3 - 1 = DC 2                                                    │    │
│  │                                                                      │    │
│  │  3 successes vs DC 2 = Margin +1 = Success!                         │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    DETERMINE OUTCOME                                 │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  SUCCESS OUTCOMES:                                                  │    │
│  │  ├── Margin ≥ 5 (Critical) → Perfect landing, halved stamina       │    │
│  │  ├── Margin 1-4           → Clean landing                           │    │
│  │  └── Margin 0             → Awkward landing (full stamina)          │    │
│  │                                                                      │    │
│  │  FAILURE OUTCOMES:                                                  │    │
│  │  ├── Margin < 0           → Fall into gap                           │    │
│  │  └── Fumble (0 + botch)   → [The Long Fall] - bonus damage + stress │    │
│  │                                                                      │    │
│  │  Result: Full Success (margin 1), clean landing                     │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│           │                                                                  │
│           ▼                                                                  │
│  OUTPUT: LeapResult.Landed = true, StaminaCost = 1                         │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 Distance-to-DC Mapping

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       DISTANCE-TO-DC MAPPING                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  LEAP DISTANCE SCALE (Success-Counting DCs)                                 │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│      5ft        10ft       15ft       20ft       25ft                       │
│       │          │          │          │          │                         │
│       ▼          ▼          ▼          ▼          ▼                         │
│  ┌─────────┬─────────┬─────────┬─────────┬─────────┐                        │
│  │  SHORT  │ MEDIUM  │  LONG   │ EXTREME │ HEROIC  │                        │
│  │  DC 1   │  DC 2   │  DC 3   │  DC 4   │  DC 5   │                        │
│  │ (Easy)  │(Moderate│ (Hard)  │ (Very   │(Master  │                        │
│  │         │         │         │  Hard)  │  Only)  │                        │
│  └─────────┴─────────┴─────────┴─────────┴─────────┘                        │
│                                                                              │
│  DC MODIFIERS:                                                              │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────┐      │
│  │  MODIFIER             │ DC CHANGE │ CONDITION                      │     │
│  ├───────────────────────┼───────────┼───────────────────────────────┤      │
│  │  Running Start        │    -1     │ 10ft clear run-up             │      │
│  │  Precision Landing    │    +1     │ Small target (< 5ft)          │      │
│  │  [Glitched] Landing   │    +2     │ Corruption-affected surface   │      │
│  │  Encumbered           │    +1     │ Carrying capacity exceeded    │      │
│  │  [Low Gravity]        │    -1     │ Environmental modifier        │      │
│  │  Standing Jump        │    +1     │ No run-up space available     │      │
│  │  Downward Leap        │    -1     │ Jumping to lower elevation    │      │
│  └───────────────────────┴───────────┴───────────────────────────────┘      │
│                                                                              │
│  MINIMUM DC: 1 (regardless of modifiers)                                    │
│                                                                              │
│  EXAMPLE CALCULATIONS:                                                      │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  Example 1: 15ft leap with running start                                    │
│  ├── Base DC: 3 (Long)                                                      │
│  ├── Running Start: -1                                                      │
│  └── Final DC: 2                                                            │
│                                                                              │
│  Example 2: 10ft leap to precision landing in Glitched zone                 │
│  ├── Base DC: 2 (Medium)                                                    │
│  ├── Precision: +1                                                          │
│  ├── Glitched: +2                                                           │
│  └── Final DC: 5                                                            │
│                                                                              │
│  Example 3: 20ft leap while encumbered, no run-up                           │
│  ├── Base DC: 4 (Extreme)                                                   │
│  ├── Encumbered: +1                                                         │
│  ├── Standing Jump: +1                                                      │
│  └── Final DC: 6                                                            │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 Outcome Matrix

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         LEAP OUTCOME MATRIX                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  OUTCOME              │ RESULT                │ STAMINA COST         │   │
│  ├───────────────────────┼───────────────────────┼─────────────────────┤    │
│  │                       │                       │                     │    │
│  │  CRITICAL SUCCESS     │ Perfect landing       │ Halved (round down) │    │
│  │  (Margin ≥ 5)         │ "Graceful arc!"       │                     │    │
│  │                       │                       │                     │    │
│  ├───────────────────────┼───────────────────────┼─────────────────────┤    │
│  │                       │                       │                     │    │
│  │  FULL SUCCESS         │ Clean landing         │ Normal (1 per 10ft) │    │
│  │  (Margin 1-4)         │ "You clear the gap"   │                     │    │
│  │                       │                       │                     │    │
│  ├───────────────────────┼───────────────────────┼─────────────────────┤    │
│  │                       │                       │                     │    │
│  │  MARGINAL SUCCESS     │ Awkward landing       │ +1 additional       │    │
│  │  (Margin 0)           │ "Barely made it!"     │                     │    │
│  │                       │                       │                     │    │
│  ├───────────────────────┼───────────────────────┼─────────────────────┤    │
│  │                       │                       │                     │    │
│  │  FAILURE              │ Fall into gap         │ N/A (fall damage)   │    │
│  │  (Margin < 0)         │ "You don't make it"   │                     │    │
│  │                       │                       │                     │    │
│  ├───────────────────────┼───────────────────────┼─────────────────────┤    │
│  │                       │                       │                     │    │
│  │  FUMBLE               │ [The Long Fall]       │ N/A (fall damage)   │    │
│  │  (0 successes +       │ Bonus 1d10 damage     │ + 2 Stress          │    │
│  │   ≥1 botch)           │ [Disoriented] 2 rds   │                     │    │
│  │                       │                       │                     │    │
│  └───────────────────────┴───────────────────────┴─────────────────────┘    │
│                                                                              │
│  FALL DEPTH CALCULATION:                                                    │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  Fall depth is determined by the gap environment:                           │
│  ├── Known depth (e.g., "10ft pit") → Specific fall height                  │
│  ├── Unknown depth → Default 20ft or environment-specific                   │
│  └── Bottomless → Instant death or major consequence                        │
│                                                                              │
│  STAMINA COST FORMULA:                                                      │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  Base Cost = Distance / 10 (round up)                                       │
│  ├── 5ft   = 1 stamina                                                      │
│  ├── 10ft  = 1 stamina                                                      │
│  ├── 15ft  = 2 stamina                                                      │
│  ├── 20ft  = 2 stamina                                                      │
│  └── 25ft  = 3 stamina                                                      │
│                                                                              │
│  Modified by outcome:                                                       │
│  ├── Critical Success: Base ÷ 2 (round down, min 0)                         │
│  ├── Marginal Success: Base + 1                                             │
│  └── Failure/Fumble: No stamina cost (fall damage instead)                  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 Layer Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           LAYER ARCHITECTURE                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                      DOMAIN LAYER                                    │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  ValueObjects/                                                      │    │
│  │  ├── LeapContext.cs               ←── NEW                           │    │
│  │  ├── LeapResult.cs                ←── NEW                           │    │
│  │  └── FallResult.cs                ←── FROM v0.15.2a                 │    │
│  │                                                                      │    │
│  │  Enums/                                                             │    │
│  │  ├── LeapDistance.cs              ←── NEW                           │    │
│  │  ├── LandingType.cs               ←── NEW                           │    │
│  │  ├── FallSource.cs                ←── FROM v0.15.2a (includes Leaping)│   │
│  │  └── FumbleType.cs                ←── FROM v0.15.1b (TheLongFall)   │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                  │                                           │
│                                  │ uses                                      │
│                                  ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    APPLICATION LAYER                                 │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Interfaces/                                                        │    │
│  │  └── ILeapingService.cs           ←── NEW                           │    │
│  │                                                                      │    │
│  │  Services/                                                          │    │
│  │  └── LeapingService.cs            ←── NEW                           │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                  │                                           │
│                                  │ uses                                      │
│                                  ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                  INFRASTRUCTURE LAYER                                │    │
│  ├─────────────────────────────────────────────────────────────────────┤    │
│  │                                                                      │    │
│  │  Configuration/                                                     │    │
│  │  └── leap-distances.json          ←── NEW                           │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. LeapDistance Enum

### 4.1 Enum Definition

**File:** `src/Core/RuneAndRust.Domain/Enums/LeapDistance.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Categorizes leap distances with associated difficulty classes.
/// </summary>
/// <remarks>
/// <para>
/// Each leap distance category represents a range of horizontal distances
/// with an associated base DC for the Acrobatics skill check.
/// </para>
/// <para>
/// DCs are expressed in success-counting terms (number of net successes required):
/// <list type="bullet">
///   <item><description>Short (5ft): DC 1 - Easy for trained characters</description></item>
///   <item><description>Medium (10ft): DC 2 - Standard athletic feat</description></item>
///   <item><description>Long (15ft): DC 3 - Challenging, requires good Acrobatics</description></item>
///   <item><description>Extreme (20ft): DC 4 - Very difficult, approaching limits</description></item>
///   <item><description>Heroic (25ft): DC 5 - Near-impossible, Master rank recommended</description></item>
/// </list>
/// </para>
/// </remarks>
public enum LeapDistance
{
    /// <summary>
    /// Short leap of up to 5 feet. DC 1.
    /// </summary>
    /// <remarks>
    /// Trivial for most characters. Useful for small gaps, stepping stones.
    /// </remarks>
    Short = 0,

    /// <summary>
    /// Medium leap of 6-10 feet. DC 2.
    /// </summary>
    /// <remarks>
    /// Standard athletic jump. Most gaps in urban environments.
    /// </remarks>
    Medium = 1,

    /// <summary>
    /// Long leap of 11-15 feet. DC 3.
    /// </summary>
    /// <remarks>
    /// Challenging jump requiring commitment. Rooftop gaps, wide chasms.
    /// </remarks>
    Long = 2,

    /// <summary>
    /// Extreme leap of 16-20 feet. DC 4.
    /// </summary>
    /// <remarks>
    /// Pushing physical limits. Running start highly recommended.
    /// </remarks>
    Extreme = 3,

    /// <summary>
    /// Heroic leap of 21-25 feet. DC 5.
    /// </summary>
    /// <remarks>
    /// Near-impossible without Master rank or specialization abilities.
    /// Gantry-Runner [Death-Defying Leap] extends this range.
    /// </remarks>
    Heroic = 4
}
```

### 4.2 LeapDistance Extensions

**File:** `src/Core/RuneAndRust.Domain/Extensions/LeapDistanceExtensions.cs`

```csharp
namespace RuneAndRust.Domain.Extensions;

using RuneAndRust.Domain.Enums;

/// <summary>
/// Extension methods for <see cref="LeapDistance"/> enum.
/// </summary>
public static class LeapDistanceExtensions
{
    /// <summary>
    /// Gets the base DC (in successes required) for this leap distance.
    /// </summary>
    /// <param name="distance">The leap distance category.</param>
    /// <returns>The number of net successes required.</returns>
    public static int GetBaseDc(this LeapDistance distance)
    {
        return distance switch
        {
            LeapDistance.Short => 1,
            LeapDistance.Medium => 2,
            LeapDistance.Long => 3,
            LeapDistance.Extreme => 4,
            LeapDistance.Heroic => 5,
            _ => 2
        };
    }

    /// <summary>
    /// Gets the maximum distance in feet for this category.
    /// </summary>
    /// <param name="distance">The leap distance category.</param>
    /// <returns>Maximum feet for this category.</returns>
    public static int GetMaxFeet(this LeapDistance distance)
    {
        return distance switch
        {
            LeapDistance.Short => 5,
            LeapDistance.Medium => 10,
            LeapDistance.Long => 15,
            LeapDistance.Extreme => 20,
            LeapDistance.Heroic => 25,
            _ => 10
        };
    }

    /// <summary>
    /// Gets the minimum distance in feet for this category.
    /// </summary>
    /// <param name="distance">The leap distance category.</param>
    /// <returns>Minimum feet for this category.</returns>
    public static int GetMinFeet(this LeapDistance distance)
    {
        return distance switch
        {
            LeapDistance.Short => 1,
            LeapDistance.Medium => 6,
            LeapDistance.Long => 11,
            LeapDistance.Extreme => 16,
            LeapDistance.Heroic => 21,
            _ => 1
        };
    }

    /// <summary>
    /// Gets the base stamina cost for this leap distance.
    /// </summary>
    /// <param name="distance">The leap distance category.</param>
    /// <returns>Stamina points consumed by the leap.</returns>
    public static int GetBaseStaminaCost(this LeapDistance distance)
    {
        return distance switch
        {
            LeapDistance.Short => 1,
            LeapDistance.Medium => 1,
            LeapDistance.Long => 2,
            LeapDistance.Extreme => 2,
            LeapDistance.Heroic => 3,
            _ => 1
        };
    }

    /// <summary>
    /// Gets a human-readable description of the leap distance.
    /// </summary>
    /// <param name="distance">The leap distance category.</param>
    /// <returns>A descriptive string for UI display.</returns>
    public static string GetDescription(this LeapDistance distance)
    {
        return distance switch
        {
            LeapDistance.Short => "Short (up to 5ft) - DC 1",
            LeapDistance.Medium => "Medium (6-10ft) - DC 2",
            LeapDistance.Long => "Long (11-15ft) - DC 3",
            LeapDistance.Extreme => "Extreme (16-20ft) - DC 4",
            LeapDistance.Heroic => "Heroic (21-25ft) - DC 5",
            _ => "Unknown distance"
        };
    }

    /// <summary>
    /// Determines the leap distance category from a distance in feet.
    /// </summary>
    /// <param name="distanceFeet">The distance to leap in feet.</param>
    /// <returns>The appropriate LeapDistance category.</returns>
    /// <exception cref="ArgumentOutOfRangeException">
    /// Thrown when distance exceeds 25 feet (Heroic maximum).
    /// </exception>
    public static LeapDistance FromFeet(int distanceFeet)
    {
        return distanceFeet switch
        {
            <= 0 => throw new ArgumentOutOfRangeException(
                nameof(distanceFeet), "Distance must be positive."),
            <= 5 => LeapDistance.Short,
            <= 10 => LeapDistance.Medium,
            <= 15 => LeapDistance.Long,
            <= 20 => LeapDistance.Extreme,
            <= 25 => LeapDistance.Heroic,
            _ => throw new ArgumentOutOfRangeException(
                nameof(distanceFeet),
                $"Distance {distanceFeet}ft exceeds maximum leap distance of 25ft.")
        };
    }
}
```

---

## 5. LandingType Enum

### 5.1 Enum Definition

**File:** `src/Core/RuneAndRust.Domain/Enums/LandingType.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Classifies the type of landing surface or target for a leap.
/// </summary>
/// <remarks>
/// <para>
/// Landing type affects the difficulty of a leap. Precision landings on small
/// targets or corrupted surfaces increase the DC, while normal landings have
/// no modifier.
/// </para>
/// </remarks>
public enum LandingType
{
    /// <summary>
    /// Normal landing on a standard surface (5+ feet wide).
    /// DC modifier: +0.
    /// </summary>
    Normal = 0,

    /// <summary>
    /// Precision landing on a small target (less than 5 feet wide).
    /// DC modifier: +1.
    /// </summary>
    /// <remarks>
    /// Examples: narrow ledge, small platform, single beam.
    /// </remarks>
    Precision = 1,

    /// <summary>
    /// Landing on a corruption-affected [Glitched] surface.
    /// DC modifier: +2.
    /// </summary>
    /// <remarks>
    /// The landing zone is unstable due to corruption effects.
    /// Distances may fluctuate, surfaces may shift.
    /// </remarks>
    Glitched = 2,

    /// <summary>
    /// Precision landing on a Glitched surface (combines both penalties).
    /// DC modifier: +3 (Precision +1, Glitched +2).
    /// </summary>
    PrecisionGlitched = 3,

    /// <summary>
    /// Landing at a lower elevation (jumping down).
    /// DC modifier: -1.
    /// </summary>
    /// <remarks>
    /// Gravity assists the leap. Still triggers fall damage if landing zone missed.
    /// </remarks>
    Downward = 4
}
```

### 5.2 LandingType Extensions

**File:** `src/Core/RuneAndRust.Domain/Extensions/LandingTypeExtensions.cs`

```csharp
namespace RuneAndRust.Domain.Extensions;

using RuneAndRust.Domain.Enums;

/// <summary>
/// Extension methods for <see cref="LandingType"/> enum.
/// </summary>
public static class LandingTypeExtensions
{
    /// <summary>
    /// Gets the DC modifier for this landing type.
    /// </summary>
    /// <param name="landingType">The landing type.</param>
    /// <returns>DC modifier to apply.</returns>
    public static int GetDcModifier(this LandingType landingType)
    {
        return landingType switch
        {
            LandingType.Normal => 0,
            LandingType.Precision => 1,
            LandingType.Glitched => 2,
            LandingType.PrecisionGlitched => 3,
            LandingType.Downward => -1,
            _ => 0
        };
    }

    /// <summary>
    /// Gets a human-readable description of the landing type.
    /// </summary>
    /// <param name="landingType">The landing type.</param>
    /// <returns>A descriptive string for UI display.</returns>
    public static string GetDescription(this LandingType landingType)
    {
        return landingType switch
        {
            LandingType.Normal => "Normal landing",
            LandingType.Precision => "Precision landing (DC +1)",
            LandingType.Glitched => "Glitched surface (DC +2)",
            LandingType.PrecisionGlitched => "Precision on Glitched (DC +3)",
            LandingType.Downward => "Downward leap (DC -1)",
            _ => "Unknown landing type"
        };
    }

    /// <summary>
    /// Gets whether this landing type involves corruption effects.
    /// </summary>
    /// <param name="landingType">The landing type.</param>
    /// <returns>True if the landing involves Glitched terrain.</returns>
    public static bool IsGlitched(this LandingType landingType)
    {
        return landingType is LandingType.Glitched or LandingType.PrecisionGlitched;
    }

    /// <summary>
    /// Gets whether this landing type is a precision landing.
    /// </summary>
    /// <param name="landingType">The landing type.</param>
    /// <returns>True if the landing requires precision.</returns>
    public static bool IsPrecision(this LandingType landingType)
    {
        return landingType is LandingType.Precision or LandingType.PrecisionGlitched;
    }
}
```

---

## 6. LeapContext Value Object

### 6.1 Class Definition

**File:** `src/Core/RuneAndRust.Domain/ValueObjects/LeapContext.cs`

```csharp
namespace RuneAndRust.Domain.ValueObjects;

using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.Extensions;

/// <summary>
/// Encapsulates all factors affecting a leap attempt.
/// </summary>
/// <remarks>
/// <para>
/// The leap context aggregates distance, modifiers, and environmental factors
/// to calculate the final DC for the leap skill check.
/// </para>
/// <para>
/// DC modifiers are applied in the following order:
/// <list type="number">
///   <item><description>Base DC from distance</description></item>
///   <item><description>Running start modifier (-1 DC)</description></item>
///   <item><description>Landing type modifier</description></item>
///   <item><description>Encumbrance modifier (+1 DC)</description></item>
///   <item><description>Gravity modifier ([Low Gravity] -1 DC)</description></item>
///   <item><description>Standing jump modifier (+1 DC if no run-up)</description></item>
/// </list>
/// </para>
/// </remarks>
/// <param name="DistanceFeet">The horizontal distance to leap in feet.</param>
/// <param name="HasRunningStart">Whether the character has a 10ft run-up.</param>
/// <param name="LandingType">The type of landing surface/target.</param>
/// <param name="IsEncumbered">Whether the character is over carrying capacity.</param>
/// <param name="HasLowGravity">Whether the area has [Low Gravity] modifier.</param>
/// <param name="FallDepth">The depth of fall if the leap fails (in feet).</param>
/// <param name="IsStandingJump">Whether forced to jump without run-up space.</param>
public readonly record struct LeapContext(
    int DistanceFeet,
    bool HasRunningStart = false,
    LandingType LandingType = LandingType.Normal,
    bool IsEncumbered = false,
    bool HasLowGravity = false,
    int FallDepth = 20,
    bool IsStandingJump = false)
{
    /// <summary>
    /// Gets the leap distance category for this context.
    /// </summary>
    public LeapDistance DistanceCategory => LeapDistanceExtensions.FromFeet(
        Math.Min(25, Math.Max(1, DistanceFeet)));

    /// <summary>
    /// Gets the base DC from distance before modifiers.
    /// </summary>
    public int BaseDc => DistanceCategory.GetBaseDc();

    /// <summary>
    /// Gets the running start DC modifier.
    /// </summary>
    public int RunningStartModifier => HasRunningStart ? -1 : 0;

    /// <summary>
    /// Gets the standing jump DC modifier (penalty for no run-up space).
    /// </summary>
    public int StandingJumpModifier => IsStandingJump ? 1 : 0;

    /// <summary>
    /// Gets the landing type DC modifier.
    /// </summary>
    public int LandingModifier => LandingType.GetDcModifier();

    /// <summary>
    /// Gets the encumbrance DC modifier.
    /// </summary>
    public int EncumbranceModifier => IsEncumbered ? 1 : 0;

    /// <summary>
    /// Gets the low gravity DC modifier.
    /// </summary>
    public int GravityModifier => HasLowGravity ? -1 : 0;

    /// <summary>
    /// Gets the total DC modifier from all factors.
    /// </summary>
    public int TotalDcModifier =>
        RunningStartModifier +
        StandingJumpModifier +
        LandingModifier +
        EncumbranceModifier +
        GravityModifier;

    /// <summary>
    /// Gets the final DC for the leap (minimum 1).
    /// </summary>
    public int FinalDc => Math.Max(1, BaseDc + TotalDcModifier);

    /// <summary>
    /// Gets the base stamina cost for this leap.
    /// </summary>
    public int BaseStaminaCost => DistanceCategory.GetBaseStaminaCost();

    /// <summary>
    /// Gets whether this leap requires Master rank (Heroic distance with high DC).
    /// </summary>
    public bool RequiresMasterRank =>
        DistanceCategory == LeapDistance.Heroic && FinalDc >= 5;

    /// <summary>
    /// Creates a simple leap context with just distance.
    /// </summary>
    /// <param name="distanceFeet">Distance to leap in feet.</param>
    /// <param name="fallDepth">Depth of fall if failed (default 20ft).</param>
    /// <returns>A new LeapContext with default modifiers.</returns>
    public static LeapContext Simple(int distanceFeet, int fallDepth = 20)
    {
        return new LeapContext(
            DistanceFeet: distanceFeet,
            FallDepth: fallDepth);
    }

    /// <summary>
    /// Creates a leap context with running start.
    /// </summary>
    /// <param name="distanceFeet">Distance to leap in feet.</param>
    /// <param name="fallDepth">Depth of fall if failed.</param>
    /// <returns>A new LeapContext with running start enabled.</returns>
    public static LeapContext WithRunningStart(int distanceFeet, int fallDepth = 20)
    {
        return new LeapContext(
            DistanceFeet: distanceFeet,
            HasRunningStart: true,
            FallDepth: fallDepth);
    }

    /// <summary>
    /// Creates a leap context for a precision landing.
    /// </summary>
    /// <param name="distanceFeet">Distance to leap in feet.</param>
    /// <param name="hasRunningStart">Whether a running start is available.</param>
    /// <param name="fallDepth">Depth of fall if failed.</param>
    /// <returns>A new LeapContext for precision landing.</returns>
    public static LeapContext PrecisionLanding(
        int distanceFeet,
        bool hasRunningStart = false,
        int fallDepth = 20)
    {
        return new LeapContext(
            DistanceFeet: distanceFeet,
            HasRunningStart: hasRunningStart,
            LandingType: LandingType.Precision,
            FallDepth: fallDepth);
    }

    /// <summary>
    /// Gets a detailed description of the leap context for display.
    /// </summary>
    /// <returns>A multi-line string describing all leap factors.</returns>
    public string ToDescription()
    {
        var lines = new List<string>
        {
            $"Leap {DistanceFeet}ft ({DistanceCategory})",
            $"Base DC: {BaseDc}"
        };

        var modifiers = new List<string>();
        if (HasRunningStart) modifiers.Add($"Running Start ({RunningStartModifier:+#;-#;+0})");
        if (IsStandingJump) modifiers.Add($"Standing Jump ({StandingJumpModifier:+#;-#;+0})");
        if (LandingModifier != 0) modifiers.Add($"{LandingType} ({LandingModifier:+#;-#;+0})");
        if (IsEncumbered) modifiers.Add($"Encumbered ({EncumbranceModifier:+#;-#;+0})");
        if (HasLowGravity) modifiers.Add($"[Low Gravity] ({GravityModifier:+#;-#;+0})");

        if (modifiers.Count > 0)
        {
            lines.Add($"Modifiers: {string.Join(", ", modifiers)}");
        }

        lines.Add($"Final DC: {FinalDc}");
        lines.Add($"Fall Depth (on failure): {FallDepth}ft");
        lines.Add($"Stamina Cost: {BaseStaminaCost}");

        return string.Join(Environment.NewLine, lines);
    }

    /// <inheritdoc/>
    public override string ToString() =>
        $"Leap {DistanceFeet}ft (DC {FinalDc}, fall {FallDepth}ft)";
}
```

---

## 7. LeapResult Value Object

### 7.1 Class Definition

**File:** `src/Core/RuneAndRust.Domain/ValueObjects/LeapResult.cs`

```csharp
namespace RuneAndRust.Domain.ValueObjects;

using RuneAndRust.Domain.Enums;

/// <summary>
/// Represents the outcome of a leap attempt.
/// </summary>
/// <remarks>
/// <para>
/// Captures all relevant information about a completed leap including:
/// <list type="bullet">
///   <item><description>Success or failure status</description></item>
///   <item><description>Fall triggering and depth</description></item>
///   <item><description>Stamina cost (modified by outcome)</description></item>
///   <item><description>Fumble effects ([The Long Fall])</description></item>
/// </list>
/// </para>
/// </remarks>
/// <param name="Context">The leap context that was attempted.</param>
/// <param name="Outcome">The skill check outcome.</param>
/// <param name="NetSuccesses">Number of net successes from the dice roll.</param>
/// <param name="Margin">Margin of success or failure (NetSuccesses - DC).</param>
/// <param name="Landed">Whether the character successfully landed.</param>
/// <param name="FallTriggered">Whether a fall was triggered by failure.</param>
/// <param name="FallResult">Fall details if a fall was triggered.</param>
/// <param name="StaminaCost">Final stamina cost after outcome modification.</param>
/// <param name="IsFumble">Whether this was a fumble ([The Long Fall]).</param>
/// <param name="BonusDamage">Bonus damage dice from fumble.</param>
/// <param name="StressGained">Stress gained from fumble.</param>
/// <param name="StatusApplied">Status effect applied (e.g., [Disoriented]).</param>
/// <param name="Description">Narrative description of the outcome.</param>
public readonly record struct LeapResult(
    LeapContext Context,
    SkillOutcome Outcome,
    int NetSuccesses,
    int Margin,
    bool Landed,
    bool FallTriggered = false,
    FallResult? FallResult = null,
    int StaminaCost = 0,
    bool IsFumble = false,
    int BonusDamage = 0,
    int StressGained = 0,
    string? StatusApplied = null,
    string? Description = null)
{
    /// <summary>
    /// Gets a value indicating whether this was a successful leap.
    /// </summary>
    public bool IsSuccess => Outcome >= SkillOutcome.MarginalSuccess;

    /// <summary>
    /// Gets a value indicating whether this was a critical success.
    /// </summary>
    public bool IsCriticalSuccess => Outcome == SkillOutcome.CriticalSuccess;

    /// <summary>
    /// Gets a value indicating whether this was a marginal success.
    /// </summary>
    public bool IsMarginalSuccess => Outcome == SkillOutcome.MarginalSuccess;

    /// <summary>
    /// Creates a successful leap result.
    /// </summary>
    public static LeapResult Success(
        LeapContext context,
        SkillOutcome outcome,
        int netSuccesses,
        int margin)
    {
        var baseStamina = context.BaseStaminaCost;
        var staminaCost = outcome switch
        {
            SkillOutcome.CriticalSuccess => baseStamina / 2,
            SkillOutcome.MarginalSuccess => baseStamina + 1,
            _ => baseStamina
        };

        var description = outcome switch
        {
            SkillOutcome.CriticalSuccess =>
                "You soar through the air with perfect form, landing gracefully on the other side.",
            SkillOutcome.ExceptionalSuccess =>
                "An impressive leap! You clear the gap with room to spare.",
            SkillOutcome.FullSuccess =>
                "You clear the gap and land solidly on the other side.",
            SkillOutcome.MarginalSuccess =>
                "You barely make it, stumbling slightly as you land on the edge.",
            _ => "You land successfully."
        };

        return new LeapResult(
            Context: context,
            Outcome: outcome,
            NetSuccesses: netSuccesses,
            Margin: margin,
            Landed: true,
            StaminaCost: staminaCost,
            Description: description);
    }

    /// <summary>
    /// Creates a failed leap result (fall into gap).
    /// </summary>
    public static LeapResult Failure(
        LeapContext context,
        SkillOutcome outcome,
        int netSuccesses,
        int margin)
    {
        var fallResult = Domain.ValueObjects.FallResult.FromHeight(
            context.FallDepth,
            FallSource.Leaping,
            triggeredByFumble: false);

        return new LeapResult(
            Context: context,
            Outcome: outcome,
            NetSuccesses: netSuccesses,
            Margin: margin,
            Landed: false,
            FallTriggered: true,
            FallResult: fallResult,
            Description: "You don't quite make it. Your fingers scrape the edge as you fall into the gap.");
    }

    /// <summary>
    /// Creates a fumble result ([The Long Fall]).
    /// </summary>
    public static LeapResult Fumble(
        LeapContext context,
        int netSuccesses,
        int margin)
    {
        var fallResult = Domain.ValueObjects.FallResult.TheLongFall(
            context.FallDepth,
            bonusDamageDice: 1);

        return new LeapResult(
            Context: context,
            Outcome: SkillOutcome.CriticalFailure,
            NetSuccesses: netSuccesses,
            Margin: margin,
            Landed: false,
            FallTriggered: true,
            FallResult: fallResult,
            IsFumble: true,
            BonusDamage: 1,
            StressGained: 2,
            StatusApplied: "Disoriented",
            Description: "You misjudge the leap catastrophically! Tumbling through the air, " +
                        "you land badly, the impact jarring your senses. [Disoriented] for 2 rounds.");
    }

    /// <summary>
    /// Gets a formatted summary of the leap result.
    /// </summary>
    public string ToSummary()
    {
        var outcomeStr = Outcome switch
        {
            SkillOutcome.CriticalSuccess => "CRITICAL SUCCESS",
            SkillOutcome.ExceptionalSuccess => "Exceptional Success",
            SkillOutcome.FullSuccess => "Success",
            SkillOutcome.MarginalSuccess => "Marginal Success",
            SkillOutcome.Failure => "Failure",
            SkillOutcome.CriticalFailure => "FUMBLE - The Long Fall!",
            _ => Outcome.ToString()
        };

        var resultStr = Landed ? "Landed!" : $"Fell {Context.FallDepth}ft";

        var extras = new List<string>();
        if (StaminaCost > 0) extras.Add($"Stamina: {StaminaCost}");
        if (IsFumble)
        {
            extras.Add($"+{BonusDamage}d10 bonus damage");
            extras.Add($"+{StressGained} Stress");
            extras.Add($"[{StatusApplied}] 2 rounds");
        }

        var extrasStr = extras.Count > 0 ? $" ({string.Join(", ", extras)})" : "";

        return $"Leap {Context.DistanceFeet}ft: {outcomeStr} - {resultStr}{extrasStr}";
    }

    /// <inheritdoc/>
    public override string ToString() => ToSummary();
}
```

---

## 8. ILeapingService Interface

### 8.1 Interface Definition

**File:** `src/Core/RuneAndRust.Application/Interfaces/ILeapingService.cs`

```csharp
namespace RuneAndRust.Application.Interfaces;

using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Defines the contract for leaping system operations.
/// </summary>
/// <remarks>
/// <para>
/// The leaping service manages horizontal traversal attempts, including:
/// <list type="bullet">
///   <item><description>Calculating DCs based on distance and modifiers</description></item>
///   <item><description>Processing leap attempts with skill checks</description></item>
///   <item><description>Handling fumble consequences ([The Long Fall])</description></item>
///   <item><description>Calculating stamina costs based on outcome</description></item>
/// </list>
/// </para>
/// </remarks>
public interface ILeapingService
{
    /// <summary>
    /// Attempts a leap with the specified context.
    /// </summary>
    /// <param name="characterId">The ID of the character attempting the leap.</param>
    /// <param name="context">The leap context with all parameters.</param>
    /// <param name="baseDicePool">The character's base dice pool for Acrobatics.</param>
    /// <param name="additionalContext">Optional additional skill context modifiers.</param>
    /// <returns>The result of the leap attempt.</returns>
    LeapResult AttemptLeap(
        string characterId,
        LeapContext context,
        int baseDicePool,
        SkillContext? additionalContext = null);

    /// <summary>
    /// Calculates the DC for a leap with the given parameters.
    /// </summary>
    /// <param name="distanceFeet">The distance to leap in feet.</param>
    /// <param name="hasRunningStart">Whether a running start is available.</param>
    /// <param name="landingType">The type of landing surface.</param>
    /// <param name="isEncumbered">Whether the character is encumbered.</param>
    /// <param name="hasLowGravity">Whether [Low Gravity] applies.</param>
    /// <returns>The final DC for the leap.</returns>
    int CalculateDc(
        int distanceFeet,
        bool hasRunningStart = false,
        LandingType landingType = LandingType.Normal,
        bool isEncumbered = false,
        bool hasLowGravity = false);

    /// <summary>
    /// Determines the leap distance category from feet.
    /// </summary>
    /// <param name="distanceFeet">The distance in feet.</param>
    /// <returns>The LeapDistance category.</returns>
    LeapDistance GetDistanceCategory(int distanceFeet);

    /// <summary>
    /// Gets the base DC for a leap distance category.
    /// </summary>
    /// <param name="distance">The leap distance category.</param>
    /// <returns>The base DC in successes required.</returns>
    int GetBaseDc(LeapDistance distance);

    /// <summary>
    /// Gets the stamina cost for a leap distance.
    /// </summary>
    /// <param name="distance">The leap distance category.</param>
    /// <param name="outcome">The outcome to apply stamina modifiers.</param>
    /// <returns>The final stamina cost.</returns>
    int GetStaminaCost(LeapDistance distance, SkillOutcome outcome);

    /// <summary>
    /// Determines if a leap distance requires Master rank.
    /// </summary>
    /// <param name="distanceFeet">The distance in feet.</param>
    /// <returns>True if Heroic distance requiring Master rank.</returns>
    bool RequiresMasterRank(int distanceFeet);
}
```

---

## 9. LeapingService Implementation

### 9.1 Service Implementation

**File:** `src/Core/RuneAndRust.Application/Services/LeapingService.cs`

```csharp
namespace RuneAndRust.Application.Services;

using Microsoft.Extensions.Logging;
using RuneAndRust.Application.Interfaces;
using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.Extensions;
using RuneAndRust.Domain.ValueObjects;

/// <summary>
/// Implements distance-based leaping mechanics for the Acrobatics skill.
/// </summary>
/// <remarks>
/// <para>
/// The leaping service orchestrates the leaping system:
/// <list type="bullet">
///   <item><description>Distance-to-DC mapping with modifiers</description></item>
///   <item><description>Running start and landing type calculations</description></item>
///   <item><description>Outcome processing with stamina costs</description></item>
///   <item><description>[The Long Fall] fumble triggering</description></item>
/// </list>
/// </para>
/// </remarks>
public sealed class LeapingService : ILeapingService
{
    private readonly IDiceRollerService _diceRoller;
    private readonly IFumbleConsequenceService _fumbleService;
    private readonly ILogger<LeapingService> _logger;

    /// <summary>
    /// The critical success margin threshold.
    /// </summary>
    private const int CriticalSuccessMargin = 5;

    /// <summary>
    /// Stress gained from [The Long Fall] fumble.
    /// </summary>
    private const int TheLongFallStress = 2;

    /// <summary>
    /// Duration of [Disoriented] status from fumble in rounds.
    /// </summary>
    private const int DisorientedDuration = 2;

    /// <summary>
    /// Initializes a new instance of the <see cref="LeapingService"/> class.
    /// </summary>
    /// <param name="diceRoller">The dice rolling service.</param>
    /// <param name="fumbleService">The fumble consequence service.</param>
    /// <param name="logger">The logger instance.</param>
    public LeapingService(
        IDiceRollerService diceRoller,
        IFumbleConsequenceService fumbleService,
        ILogger<LeapingService> logger)
    {
        _diceRoller = diceRoller ?? throw new ArgumentNullException(nameof(diceRoller));
        _fumbleService = fumbleService ?? throw new ArgumentNullException(nameof(fumbleService));
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));
    }

    /// <inheritdoc/>
    public LeapResult AttemptLeap(
        string characterId,
        LeapContext context,
        int baseDicePool,
        SkillContext? additionalContext = null)
    {
        _logger.LogInformation(
            "Character {CharacterId} attempting {Distance}ft leap (DC {Dc})",
            characterId,
            context.DistanceFeet,
            context.FinalDc);

        // Apply additional context modifiers to dice pool
        var additionalDice = additionalContext?.TotalDiceModifier ?? 0;
        var totalDicePool = Math.Max(1, baseDicePool + additionalDice);

        _logger.LogDebug(
            "Leap dice pool: base {Base}d10, additional {Additional}d10 = {Total}d10",
            baseDicePool,
            additionalDice,
            totalDicePool);

        // Perform the dice roll
        var rollResult = _diceRoller.RollDicePool(totalDicePool);

        // Calculate margin
        var margin = rollResult.NetSuccesses - context.FinalDc;
        var outcome = DetermineOutcome(rollResult, margin);

        _logger.LogInformation(
            "Leap result: {Successes} successes vs DC {Dc}, margin {Margin}, outcome {Outcome}",
            rollResult.NetSuccesses,
            context.FinalDc,
            margin,
            outcome);

        // Process the outcome
        var result = ProcessOutcome(characterId, context, outcome, rollResult.NetSuccesses, margin);

        // Handle fumble consequence
        if (result.IsFumble)
        {
            _fumbleService.CreateConsequence(
                characterId,
                "acrobatics-leaping",
                FumbleType.TheLongFall,
                targetId: null,
                context: $"Fell {context.FallDepth}ft with bonus damage and [Disoriented]");

            _logger.LogWarning(
                "Character {CharacterId} triggered [The Long Fall] - fell {Height}ft with bonus damage",
                characterId,
                context.FallDepth);
        }

        return result;
    }

    /// <inheritdoc/>
    public int CalculateDc(
        int distanceFeet,
        bool hasRunningStart = false,
        LandingType landingType = LandingType.Normal,
        bool isEncumbered = false,
        bool hasLowGravity = false)
    {
        var context = new LeapContext(
            DistanceFeet: distanceFeet,
            HasRunningStart: hasRunningStart,
            LandingType: landingType,
            IsEncumbered: isEncumbered,
            HasLowGravity: hasLowGravity);

        return context.FinalDc;
    }

    /// <inheritdoc/>
    public LeapDistance GetDistanceCategory(int distanceFeet)
    {
        return LeapDistanceExtensions.FromFeet(Math.Min(25, Math.Max(1, distanceFeet)));
    }

    /// <inheritdoc/>
    public int GetBaseDc(LeapDistance distance)
    {
        return distance.GetBaseDc();
    }

    /// <inheritdoc/>
    public int GetStaminaCost(LeapDistance distance, SkillOutcome outcome)
    {
        var baseCost = distance.GetBaseStaminaCost();

        return outcome switch
        {
            SkillOutcome.CriticalSuccess => baseCost / 2,
            SkillOutcome.MarginalSuccess => baseCost + 1,
            SkillOutcome.Failure or SkillOutcome.CriticalFailure => 0, // Fall damage instead
            _ => baseCost
        };
    }

    /// <inheritdoc/>
    public bool RequiresMasterRank(int distanceFeet)
    {
        return distanceFeet > 20;
    }

    /// <summary>
    /// Determines the skill outcome based on roll result and margin.
    /// </summary>
    private static SkillOutcome DetermineOutcome(DiceRollResult roll, int margin)
    {
        // Check for fumble first (0 successes + ≥1 botch)
        if (roll.IsFumble)
        {
            return SkillOutcome.CriticalFailure;
        }

        // Check for critical success (margin ≥ 5 OR dice roll critical)
        if (margin >= CriticalSuccessMargin || roll.IsCriticalSuccess)
        {
            return SkillOutcome.CriticalSuccess;
        }

        // Standard success/failure based on margin
        return margin switch
        {
            >= 3 => SkillOutcome.ExceptionalSuccess,
            >= 1 => SkillOutcome.FullSuccess,
            0 => SkillOutcome.MarginalSuccess,
            _ => SkillOutcome.Failure
        };
    }

    /// <summary>
    /// Processes the outcome of a leap attempt and returns the result.
    /// </summary>
    private static LeapResult ProcessOutcome(
        string characterId,
        LeapContext context,
        SkillOutcome outcome,
        int netSuccesses,
        int margin)
    {
        return outcome switch
        {
            SkillOutcome.CriticalFailure => LeapResult.Fumble(context, netSuccesses, margin),
            SkillOutcome.Failure => LeapResult.Failure(context, outcome, netSuccesses, margin),
            _ => LeapResult.Success(context, outcome, netSuccesses, margin)
        };
    }
}
```

---

## 10. TheLongFall Fumble Integration

### 10.1 FumbleType Enum Extension

The `FumbleType.TheLongFall` is defined in v0.15.1b. This section documents its integration with the leaping system.

**From v0.15.1b:**

```csharp
/// <summary>
/// Leaping fumble - fall with bonus damage and disorientation.
/// </summary>
/// <remarks>
/// Effect: Fall into gap with +1d10 bonus damage, gain [Disoriented] for 2 rounds, +2 Stress.
/// Duration: Instant (damage and status applied).
/// Recovery: Wait out [Disoriented] duration.
/// </remarks>
TheLongFall = 7
```

### 10.2 Integration Points

```csharp
// In LeapingService.AttemptLeap when fumble detected:

if (result.IsFumble)
{
    // 1. Create fumble consequence for tracking
    _fumbleService.CreateConsequence(
        characterId,
        "acrobatics-leaping",
        FumbleType.TheLongFall,
        targetId: null,
        context: $"Fell {context.FallDepth}ft with bonus damage and [Disoriented]");

    // 2. Apply stress (handled by SkillStressService in v0.15.1e)
    // StressAmount: 2 (base fumble stress for leaping)

    // 3. Apply [Disoriented] status (handled by StatusEffectService)
    // Duration: 2 rounds
    // Effect: -2d10 to all checks while active

    // 4. Trigger fall damage with bonus (handled by FallDamageService in v0.15.2c)
    // Base damage: (FallDepth / 10) d10
    // Bonus damage: +1d10 from [The Long Fall]
}
```

### 10.3 Disoriented Status Effect

The `[Disoriented]` status effect applied by `TheLongFall`:

| Property | Value |
|----------|-------|
| Status ID | `disoriented` |
| Duration | 2 rounds |
| Effect | -2d10 to all skill checks |
| Removal | Automatic after duration expires |

---

## 11. Configuration

### 11.1 leap-distances.json

**File:** `src/Presentation/RuneAndRust.Console/Configuration/leap-distances.json`

```json
{
  "$schema": "./leap-distances.schema.json",
  "version": "0.15.2b",
  "distanceCategories": {
    "short": {
      "name": "Short",
      "minFeet": 1,
      "maxFeet": 5,
      "baseDc": 1,
      "baseStaminaCost": 1,
      "description": "Trivial for most characters. Small gaps, stepping stones."
    },
    "medium": {
      "name": "Medium",
      "minFeet": 6,
      "maxFeet": 10,
      "baseDc": 2,
      "baseStaminaCost": 1,
      "description": "Standard athletic jump. Most urban environment gaps."
    },
    "long": {
      "name": "Long",
      "minFeet": 11,
      "maxFeet": 15,
      "baseDc": 3,
      "baseStaminaCost": 2,
      "description": "Challenging jump requiring commitment. Rooftop gaps, wide chasms."
    },
    "extreme": {
      "name": "Extreme",
      "minFeet": 16,
      "maxFeet": 20,
      "baseDc": 4,
      "baseStaminaCost": 2,
      "description": "Pushing physical limits. Running start highly recommended."
    },
    "heroic": {
      "name": "Heroic",
      "minFeet": 21,
      "maxFeet": 25,
      "baseDc": 5,
      "baseStaminaCost": 3,
      "description": "Near-impossible without Master rank or specialization abilities.",
      "requiresMasterRank": true
    }
  },
  "dcModifiers": {
    "runningStart": {
      "name": "Running Start",
      "modifier": -1,
      "condition": "10ft clear run-up available",
      "description": "Momentum reduces difficulty"
    },
    "standingJump": {
      "name": "Standing Jump",
      "modifier": 1,
      "condition": "No run-up space available",
      "description": "Lack of momentum increases difficulty"
    },
    "precisionLanding": {
      "name": "Precision Landing",
      "modifier": 1,
      "condition": "Target less than 5ft wide",
      "description": "Small landing area requires accuracy"
    },
    "glitchedLanding": {
      "name": "Glitched Landing",
      "modifier": 2,
      "condition": "Landing zone affected by corruption",
      "description": "Unstable reality affects landing"
    },
    "encumbered": {
      "name": "Encumbered",
      "modifier": 1,
      "condition": "Carrying capacity exceeded",
      "description": "Weight affects jumping ability"
    },
    "lowGravity": {
      "name": "[Low Gravity]",
      "modifier": -1,
      "condition": "Environmental modifier active",
      "description": "Reduced gravity aids jumping"
    },
    "downwardLeap": {
      "name": "Downward Leap",
      "modifier": -1,
      "condition": "Landing zone below takeoff point",
      "description": "Gravity assists the leap"
    }
  },
  "landingTypes": {
    "normal": {
      "name": "Normal",
      "dcModifier": 0,
      "description": "Standard landing on 5ft+ surface"
    },
    "precision": {
      "name": "Precision",
      "dcModifier": 1,
      "description": "Landing on surface less than 5ft wide"
    },
    "glitched": {
      "name": "Glitched",
      "dcModifier": 2,
      "description": "Landing on corruption-affected surface"
    },
    "precisionGlitched": {
      "name": "Precision + Glitched",
      "dcModifier": 3,
      "description": "Precision landing on Glitched surface"
    },
    "downward": {
      "name": "Downward",
      "dcModifier": -1,
      "description": "Landing at lower elevation"
    }
  },
  "outcomes": {
    "criticalSuccess": {
      "staminaMultiplier": 0.5,
      "description": "You soar through the air with perfect form, landing gracefully."
    },
    "success": {
      "staminaMultiplier": 1.0,
      "description": "You clear the gap and land solidly on the other side."
    },
    "marginalSuccess": {
      "staminaModifier": 1,
      "description": "You barely make it, stumbling slightly as you land on the edge."
    },
    "failure": {
      "triggersFall": true,
      "description": "You don't quite make it. Your fingers scrape the edge as you fall."
    },
    "fumble": {
      "fumbleType": "TheLongFall",
      "triggersFall": true,
      "bonusDamageDice": 1,
      "stressGained": 2,
      "statusApplied": "Disoriented",
      "statusDuration": 2,
      "description": "You misjudge the leap catastrophically! [Disoriented] for 2 rounds."
    }
  },
  "defaults": {
    "minimumDc": 1,
    "defaultFallDepth": 20,
    "maximumLeapDistance": 25
  }
}
```

### 11.2 Configuration Schema

**File:** `src/Presentation/RuneAndRust.Console/Configuration/leap-distances.schema.json`

```json
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "leap-distances.schema.json",
  "title": "Leap Distances Configuration",
  "description": "Configuration for leaping system distance categories and modifiers",
  "type": "object",
  "required": ["version", "distanceCategories", "dcModifiers", "landingTypes", "outcomes", "defaults"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Configuration version"
    },
    "distanceCategories": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "required": ["name", "minFeet", "maxFeet", "baseDc", "baseStaminaCost", "description"],
        "properties": {
          "name": { "type": "string" },
          "minFeet": { "type": "integer", "minimum": 1 },
          "maxFeet": { "type": "integer", "minimum": 1 },
          "baseDc": { "type": "integer", "minimum": 1 },
          "baseStaminaCost": { "type": "integer", "minimum": 0 },
          "description": { "type": "string" },
          "requiresMasterRank": { "type": "boolean" }
        }
      }
    },
    "dcModifiers": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "required": ["name", "modifier", "condition", "description"],
        "properties": {
          "name": { "type": "string" },
          "modifier": { "type": "integer" },
          "condition": { "type": "string" },
          "description": { "type": "string" }
        }
      }
    },
    "landingTypes": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "required": ["name", "dcModifier", "description"],
        "properties": {
          "name": { "type": "string" },
          "dcModifier": { "type": "integer" },
          "description": { "type": "string" }
        }
      }
    },
    "outcomes": {
      "type": "object",
      "required": ["criticalSuccess", "success", "marginalSuccess", "failure", "fumble"],
      "additionalProperties": {
        "type": "object",
        "required": ["description"],
        "properties": {
          "staminaMultiplier": { "type": "number" },
          "staminaModifier": { "type": "integer" },
          "triggersFall": { "type": "boolean" },
          "fumbleType": { "type": "string" },
          "bonusDamageDice": { "type": "integer" },
          "stressGained": { "type": "integer" },
          "statusApplied": { "type": "string" },
          "statusDuration": { "type": "integer" },
          "description": { "type": "string" }
        }
      }
    },
    "defaults": {
      "type": "object",
      "required": ["minimumDc", "defaultFallDepth", "maximumLeapDistance"],
      "properties": {
        "minimumDc": { "type": "integer", "minimum": 1 },
        "defaultFallDepth": { "type": "integer", "minimum": 0 },
        "maximumLeapDistance": { "type": "integer", "minimum": 1 }
      }
    }
  }
}
```

---

## 12. Commands

### 12.1 Leap Command

```csharp
/// <summary>
/// Command to attempt a leap across a gap or obstacle.
/// </summary>
/// <param name="DistanceFeet">The distance to leap in feet (optional, uses environment default).</param>
/// <param name="HasRunningStart">Whether to use a running start.</param>
public record LeapCommand(
    int? DistanceFeet = null,
    bool HasRunningStart = false) : GameCommand;
```

### 12.2 Command Parsing

```csharp
// In ConsoleInputHandler.ParseCommand():

"leap" or "jump" => ParseLeapCommand(argument),

private GameCommand ParseLeapCommand(string? argument)
{
    if (string.IsNullOrWhiteSpace(argument))
    {
        // Leap current gap (uses environment default)
        return new LeapCommand();
    }

    var hasRunningStart = argument.Contains("running", StringComparison.OrdinalIgnoreCase) ||
                          argument.Contains("run", StringComparison.OrdinalIgnoreCase);

    // Parse distance: "leap 15ft" or "jump 10"
    var distanceMatch = Regex.Match(argument, @"(\d+)\s*(ft|feet)?", RegexOptions.IgnoreCase);
    if (distanceMatch.Success)
    {
        var distance = int.Parse(distanceMatch.Groups[1].Value);
        return new LeapCommand(DistanceFeet: distance, HasRunningStart: hasRunningStart);
    }

    return new LeapCommand(HasRunningStart: hasRunningStart);
}
```

### 12.3 User Commands

| Command | Description | Example |
|---------|-------------|---------|
| `leap` | Leap across current gap (uses environment distance) | `leap` |
| `leap <distance>` | Leap specified distance | `leap 15ft` |
| `leap running` | Leap with running start | `leap running` |
| `jump <distance>` | Alias for leap | `jump 10ft` |

---

## 13. User-Facing Changes

### 13.1 Display Example - Successful Leap

```
> leap 15ft running

╔══════════════════════════════════════════════════════════════════╗
║                      LEAP ATTEMPT                                ║
╠══════════════════════════════════════════════════════════════════╣
║  Distance: 15ft (Long)                                           ║
║  Base DC: 3                                                      ║
║  Running Start: -1                                               ║
║  Final DC: 2                                                     ║
╚══════════════════════════════════════════════════════════════════╝

Rolling 5d10 vs DC 2...

╔══════════════════════════════════════════════════════════════════╗
║  Result: SUCCESS                                                 ║
╠══════════════════════════════════════════════════════════════════╣
║  Roll: [8, 10, 4, 9, 3] → 3 successes                            ║
║  vs DC 2 (margin: +1)                                            ║
║                                                                  ║
║  You clear the gap and land solidly on the other side.           ║
║                                                                  ║
║  Stamina Cost: 2                                                 ║
╚══════════════════════════════════════════════════════════════════╝
```

### 13.2 Display Example - Critical Success

```
╔══════════════════════════════════════════════════════════════════╗
║  Result: CRITICAL SUCCESS!                                       ║
╠══════════════════════════════════════════════════════════════════╣
║  Roll: [10, 9, 8, 10, 9] → 5 successes                           ║
║  vs DC 2 (margin: +3)                                            ║
║                                                                  ║
║  ✨ You soar through the air with perfect form, landing          ║
║     gracefully on the other side.                                ║
║                                                                  ║
║  Stamina Cost: 1 (halved!)                                       ║
╚══════════════════════════════════════════════════════════════════╝
```

### 13.3 Display Example - Fumble (The Long Fall)

```
╔══════════════════════════════════════════════════════════════════╗
║  Result: FUMBLE - THE LONG FALL!                                 ║
╠══════════════════════════════════════════════════════════════════╣
║  Roll: [1, 3, 4, 2, 5] → 0 successes, 1 botch                    ║
║  vs DC 3                                                         ║
║                                                                  ║
║  ⚠️  You misjudge the leap catastrophically! Tumbling through    ║
║     the air, you land badly, the impact jarring your senses.     ║
║                                                                  ║
║  Fall Height: 20ft                                               ║
║  Fall Damage: 2d10 + 1d10 bonus Bludgeoning                      ║
║  Stress Gained: +2                                               ║
║  Status Applied: [Disoriented] for 2 rounds                      ║
╚══════════════════════════════════════════════════════════════════╝

Rolling fall damage...
```

---

## 14. Logging Specifications

### 14.1 Logging Events

```csharp
// In LeapingService

// Leap attempt start
_logger.LogInformation(
    "Character {CharacterId} attempting {Distance}ft leap (DC {Dc})",
    characterId, context.DistanceFeet, context.FinalDc);

// Dice pool calculation
_logger.LogDebug(
    "Leap dice pool: base {Base}d10, additional {Additional}d10 = {Total}d10",
    baseDicePool, additionalDice, totalDicePool);

// Leap result
_logger.LogInformation(
    "Leap result: {Successes} successes vs DC {Dc}, margin {Margin}, outcome {Outcome}",
    netSuccesses, dc, margin, outcome);

// Fumble triggered
_logger.LogWarning(
    "Character {CharacterId} triggered [The Long Fall] - fell {Height}ft with bonus damage",
    characterId, context.FallDepth);

// Successful leap
_logger.LogInformation(
    "Character {CharacterId} successfully leaped {Distance}ft, stamina cost {Stamina}",
    characterId, context.DistanceFeet, result.StaminaCost);
```

---

## 15. Unit Testing Requirements

### 15.1 Test Specifications (~4 tests)

**File:** `tests/RuneAndRust.Application.Tests/Services/LeapingServiceTests.cs`

```csharp
[TestFixture]
public class LeapingServiceTests
{
    private LeapingService _service;
    private Mock<IDiceRollerService> _mockDiceRoller;
    private Mock<IFumbleConsequenceService> _mockFumbleService;

    [SetUp]
    public void Setup()
    {
        _mockDiceRoller = new Mock<IDiceRollerService>();
        _mockFumbleService = new Mock<IFumbleConsequenceService>();

        _service = new LeapingService(
            _mockDiceRoller.Object,
            _mockFumbleService.Object,
            Mock.Of<ILogger<LeapingService>>());
    }

    /// <summary>
    /// Test 1: Distance correctly sets base DC.
    /// </summary>
    [TestCase(5, 1)]   // Short
    [TestCase(10, 2)]  // Medium
    [TestCase(15, 3)]  // Long
    [TestCase(20, 4)]  // Extreme
    [TestCase(25, 5)]  // Heroic
    public void CalculateDc_GivenDistance_ReturnsCorrectBaseDc(
        int distance, int expectedDc)
    {
        // Act
        var result = _service.CalculateDc(distance);

        // Assert
        Assert.That(result, Is.EqualTo(expectedDc));
    }

    /// <summary>
    /// Test 2: Running start reduces DC.
    /// </summary>
    [Test]
    public void CalculateDc_WithRunningStart_ReducesDcByOne()
    {
        // Arrange
        var distanceFeet = 15; // Base DC 3

        // Act
        var withoutRunning = _service.CalculateDc(distanceFeet, hasRunningStart: false);
        var withRunning = _service.CalculateDc(distanceFeet, hasRunningStart: true);

        // Assert
        Assert.Multiple(() =>
        {
            Assert.That(withoutRunning, Is.EqualTo(3));
            Assert.That(withRunning, Is.EqualTo(2));
            Assert.That(withRunning, Is.EqualTo(withoutRunning - 1));
        });
    }

    /// <summary>
    /// Test 3: Failure triggers fall.
    /// </summary>
    [Test]
    public void AttemptLeap_OnFailure_TriggersFall()
    {
        // Arrange
        var context = LeapContext.Simple(15, fallDepth: 30);

        _mockDiceRoller
            .Setup(x => x.RollDicePool(It.IsAny<int>()))
            .Returns(new DiceRollResult(new[] { 3, 4, 5 }, successCount: 0, botchCount: 0));

        // Act
        var result = _service.AttemptLeap("char-1", context, baseDicePool: 4);

        // Assert
        Assert.Multiple(() =>
        {
            Assert.That(result.Landed, Is.False);
            Assert.That(result.FallTriggered, Is.True);
            Assert.That(result.FallResult, Is.Not.Null);
            Assert.That(result.FallResult!.Value.FallHeight, Is.EqualTo(30));
        });
    }

    /// <summary>
    /// Test 4: Fumble applies bonus damage and stress.
    /// </summary>
    [Test]
    public void AttemptLeap_OnFumble_AppliesBonusDamageAndStress()
    {
        // Arrange
        var context = LeapContext.Simple(15, fallDepth: 20);

        _mockDiceRoller
            .Setup(x => x.RollDicePool(It.IsAny<int>()))
            .Returns(new DiceRollResult(new[] { 1, 3, 4 }, successCount: 0, botchCount: 1)); // Fumble

        // Act
        var result = _service.AttemptLeap("char-1", context, baseDicePool: 4);

        // Assert
        Assert.Multiple(() =>
        {
            Assert.That(result.IsFumble, Is.True);
            Assert.That(result.Outcome, Is.EqualTo(SkillOutcome.CriticalFailure));
            Assert.That(result.BonusDamage, Is.EqualTo(1));
            Assert.That(result.StressGained, Is.EqualTo(2));
            Assert.That(result.StatusApplied, Is.EqualTo("Disoriented"));
            Assert.That(result.FallTriggered, Is.True);
        });

        _mockFumbleService.Verify(
            x => x.CreateConsequence(
                "char-1",
                "acrobatics-leaping",
                FumbleType.TheLongFall,
                It.IsAny<string?>(),
                It.IsAny<string?>()),
            Times.Once);
    }
}
```

---

## 16. Use Cases

### 16.1 Use Case: Simple Leap

**Actor:** Player
**Precondition:** Character is at edge of a gap
**Trigger:** Player issues `leap 10ft` command

**Main Flow:**
1. System determines distance category (Medium, 10ft)
2. System calculates base DC (2)
3. System applies modifiers (none in this case)
4. System performs Acrobatics skill check
5. System determines outcome based on successes vs DC
6. System displays result and applies stamina cost

**Postcondition:** Character on other side (success) or fell (failure)

### 16.2 Use Case: Leap with Running Start

**Actor:** Player
**Precondition:** Character has 10ft clear run-up space
**Trigger:** Player issues `leap 15ft running` command

**Main Flow:**
1. System determines distance category (Long, 15ft)
2. System calculates base DC (3)
3. System applies running start modifier (-1 DC)
4. System calculates final DC (2)
5. System performs Acrobatics skill check
6. System determines outcome
7. System displays result

**Postcondition:** Character completed leap with reduced DC

### 16.3 Use Case: Precision Landing

**Actor:** Player
**Precondition:** Landing zone is small (< 5ft wide)
**Trigger:** Environment triggers precision landing requirement

**Main Flow:**
1. System determines base DC from distance
2. System applies precision landing modifier (+1 DC)
3. System performs skill check against increased DC
4. System determines outcome
5. On failure, character falls

**Postcondition:** Character on narrow ledge (success) or fell (failure)

### 16.4 Use Case: The Long Fall Fumble

**Actor:** Player
**Precondition:** Character attempting leap
**Trigger:** Dice result is fumble (0 successes + ≥1 botch)

**Main Flow:**
1. System detects fumble condition
2. System triggers [The Long Fall] consequence
3. System applies bonus damage (+1d10)
4. System applies stress (+2)
5. System applies [Disoriented] status (2 rounds)
6. System creates FumbleConsequence record
7. Fall damage system processes total damage

**Postcondition:** Character fell with enhanced consequences

---

## 17. Deliverable Checklist

### 17.1 Domain Layer

- [ ] `LeapDistance.cs` - Distance category enum
- [ ] `LeapDistanceExtensions.cs` - Extension methods
- [ ] `LandingType.cs` - Landing type enum
- [ ] `LandingTypeExtensions.cs` - Extension methods
- [ ] `LeapContext.cs` - Context value object
- [ ] `LeapResult.cs` - Result value object

### 17.2 Application Layer

- [ ] `ILeapingService.cs` - Service interface
- [ ] `LeapingService.cs` - Service implementation

### 17.3 Infrastructure Layer

- [ ] `leap-distances.json` - Configuration file
- [ ] `leap-distances.schema.json` - JSON schema

### 17.4 Tests

- [ ] `LeapingServiceTests.cs` - ~4 unit tests

---

## 18. Acceptance Criteria

### 18.1 Distance-to-DC Mapping
- [ ] 5ft (Short) has DC 1
- [ ] 10ft (Medium) has DC 2
- [ ] 15ft (Long) has DC 3
- [ ] 20ft (Extreme) has DC 4
- [ ] 25ft (Heroic) has DC 5

### 18.2 DC Modifiers
- [ ] Running start reduces DC by 1
- [ ] Standing jump increases DC by 1
- [ ] Precision landing increases DC by 1
- [ ] Glitched landing increases DC by 2
- [ ] Encumbered increases DC by 1
- [ ] [Low Gravity] reduces DC by 1
- [ ] Minimum DC is always 1

### 18.3 Outcomes
- [ ] Success (margin ≥ 0) lands character
- [ ] Critical success (margin ≥ 5) halves stamina cost
- [ ] Marginal success (margin = 0) adds +1 stamina
- [ ] Failure (margin < 0) triggers fall
- [ ] Fumble triggers [The Long Fall]

### 18.4 The Long Fall Fumble
- [ ] Applies +1d10 bonus fall damage
- [ ] Applies +2 Stress
- [ ] Applies [Disoriented] for 2 rounds
- [ ] Creates FumbleConsequence record

### 18.5 Quality
- [ ] ~4 unit tests pass
- [ ] Build completes with 0 errors
- [ ] Build completes with 0 warnings

---

## 19. Future Considerations

### 19.1 Deferred to v0.15.2c (Fall Damage System)

- Actual damage roll calculation
- Crash Landing attempt integration
- Damage reduction from Crash Landing successes

### 19.2 Deferred to v0.15.2g (Specialization Integration)

- Gantry-Runner `[Death-Defying Leap]` extends max distance by 10ft
- Gantry-Runner `[Double Jump]` allows mid-air correction once per day
- Myrk-gengr silent landing abilities

### 19.3 Future Enhancements

- Vertical leap mechanics (jumping upward)
- Assisted leaps (thrown by ally)
- Equipment bonuses (Jump Boots, etc.)
- Environmental hazards in landing zones
- Momentum preservation for chained leaps

---

## 20. Implementation Notes

### 20.1 DC Minimum

The leaping service enforces a minimum DC of 1. Even with maximum bonuses (running start, low gravity, downward), the DC cannot go below 1.

### 20.2 Stamina Integration

Stamina costs are calculated but the actual stamina deduction depends on the stamina system implementation. The LeapResult provides the cost; the calling code is responsible for applying it.

### 20.3 Fall Depth

Fall depth is provided in the LeapContext. If not specified, it defaults to 20ft. The actual fall depth should be determined by the environment (gap depth, chasm, etc.).

### 20.4 Heroic Leaps

Heroic leaps (21-25ft) are flagged as requiring Master rank. The service does not enforce this restriction; it's advisory for the UI to warn players.

---

## 21. Document Metadata

| Property | Value |
|----------|-------|
| Document Version | 1.0.0 |
| Last Updated | 2026-01-17 |
| Author | Claude |
| Reviewers | Pending |
| Status | Draft |
| Target Version | 0.15.2b |
| Parent Version | v0.15.2 (Acrobatics Skill Expansion) |
| Prerequisites | v0.15.2a (Climbing System) |

---

*This design specification provides the detailed blueprint for implementing v0.15.2b Leaping System. Implementation should proceed after user approval.*
