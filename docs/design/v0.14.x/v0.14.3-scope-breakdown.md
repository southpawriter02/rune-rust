# v0.14.3 Monster Configuration Schemas - Scope Breakdown

**Version:** 0.14.3
**Theme:** Monster Configuration Schemas
**Prerequisites:** v0.14.2 Complete (Equipment Configuration Schemas)
**Total Estimated Tests:** ~20 new tests

---

## Executive Summary

The Monster Configuration Schemas version creates comprehensive JSON schemas for all monster-related configuration files, enabling full customization of monsters, traits, difficulty tiers, and boss encounters without code changes. This supports modding scenarios like sci-fi enemies, undead hordes, alien creatures, or custom boss mechanics.

The work is divided into **four sub-parts**:

| Part | Name | Focus | Est. Tests |
|------|------|-------|------------|
| v0.14.3a | Monster Schema | monsters.schema.json with stat blocks, AI behaviors, loot tables | ~6 |
| v0.14.3b | Trait Schema | traits.schema.json with stat modifiers, ability grants, resistances | ~5 |
| v0.14.3c | Tier Schema | tiers.schema.json with stat multipliers, loot quality, XP scaling | ~4 |
| v0.14.3d | Boss Schema | bosses.schema.json with phases, enrage, summons, unique loot | ~5 |

---

## Feature Analysis & Categorization

### From v0.14.x-overview.md - Monster Configuration Schemas

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| monsters.schema.json | High | traits, tiers, loot-tables | **v0.14.3a** |
| Stat block definitions | Medium | monsters.schema.json | **v0.14.3a** |
| Ability references | Low | monsters.schema.json | **v0.14.3a** |
| AI behavior patterns | Medium | monsters.schema.json | **v0.14.3a** |
| Loot table references | Low | loot-tables.schema.json | **v0.14.3a** |
| Spawn conditions | Low | monsters.schema.json | **v0.14.3a** |
| traits.schema.json | Medium | None | **v0.14.3b** |
| Stat modifiers (traits) | Low | traits.schema.json | **v0.14.3b** |
| Ability grants | Low | traits.schema.json | **v0.14.3b** |
| Resistance/immunity grants | Low | damage-types.schema.json | **v0.14.3b** |
| Visual modifiers | Low | traits.schema.json | **v0.14.3b** |
| tiers.schema.json | Low | None | **v0.14.3c** |
| Stat multipliers | Low | tiers.schema.json | **v0.14.3c** |
| Loot quality modifiers | Low | tiers.schema.json | **v0.14.3c** |
| XP multipliers | Low | tiers.schema.json | **v0.14.3c** |
| Name prefix/suffix | Low | tiers.schema.json | **v0.14.3c** |
| bosses.schema.json | High | monsters, abilities | **v0.14.3d** |
| Phase definitions | Medium | bosses.schema.json | **v0.14.3d** |
| Enrage mechanics | Medium | bosses.schema.json | **v0.14.3d** |
| Vulnerability windows | Low | bosses.schema.json | **v0.14.3d** |
| Summon configurations | Medium | bosses.schema.json | **v0.14.3d** |
| Unique loot tables | Low | loot-tables.schema.json | **v0.14.3d** |

---

## Existing Infrastructure

### Current Configuration Files

| File | Current State | Schema Exists |
|------|---------------|---------------|
| `config/monsters.json` | 5 monsters (goblin, skeleton, orc, goblin_shaman, slime) | No |
| `config/traits.json` | 5 traits (regenerating, flying, venomous, armored, berserker) | Partial ($schema reference) |
| `config/tiers.json` | 4 tiers (common, named, elite, boss) | Partial ($schema reference) |
| `config/bosses.json` | Does not exist yet | No |

### Current Monster Structure

```json
{
  "id": "goblin",
  "name": "Goblin",
  "description": "A small, green creature...",
  "baseHealth": 30,
  "baseAttack": 8,
  "baseDefense": 2,
  "experienceValue": 25,
  "behavior": "Cowardly",
  "tags": ["humanoid"],
  "canHeal": false,
  "healAmount": null,
  "spawnWeight": 100,
  "initiativeModifier": 1,
  "baseResistances": { "physical": 25, "fire": -50 },
  "possibleTiers": ["common", "named", "elite"],
  "possibleTraits": ["venomous", "berserker"],
  "nameGenerator": {
    "prefixes": ["Gn", "Sn"],
    "suffixes": ["ik", "ob"],
    "titleFormat": "{0} the {1}"
  },
  "lootTable": {
    "entries": [
      { "itemId": "health_potion", "weight": 100, "minQuantity": 1, "maxQuantity": 1, "dropChance": 0.15 }
    ],
    "currencyDrops": [
      { "currencyId": "gold", "minAmount": 5, "maxAmount": 15, "dropChance": 0.80 }
    ]
  }
}
```

### Current Trait Structure

```json
{
  "id": "berserker",
  "name": "Berserker",
  "description": "Deals more damage when health drops below a threshold.",
  "effect": "Berserker",
  "effectValue": 50,
  "triggerThreshold": 30,
  "tags": ["offensive", "triggered"],
  "color": "red",
  "sortOrder": 4
}
```

### Current Tier Structure

```json
{
  "id": "elite",
  "name": "Elite",
  "namePrefix": "Elite",
  "healthMultiplier": 2.0,
  "attackMultiplier": 1.5,
  "defenseMultiplier": 1.5,
  "experienceMultiplier": 3.0,
  "lootMultiplier": 3.0,
  "color": "orange3",
  "spawnWeight": 8,
  "generatesUniqueName": false,
  "sortOrder": 2
}
```

### Key Schema Conventions

- JSON Schema Draft-07 format
- ID pattern: `^[a-z][a-z0-9_]*$` (lowercase with underscores)
- Definitions section for reusable types
- Required fields explicitly listed
- Descriptions on all properties
- Enum validation for categorical values

---

## Phase Definitions

---

## v0.14.3a: Monster Schema

[v0.14.3a Design Specification](v0.14.3a-design-specification.md)

### Overview

Create a comprehensive JSON schema for monster definitions that validates stat blocks, AI behavior patterns, resistance configurations, tier/trait references, name generation, and embedded loot tables.

### Scope

**In Scope:**
- `monsters.schema.json` - Full schema for monster definitions
- Base stat validation (health, attack, defense, experienceValue)
- AI behavior pattern enumeration (Aggressive, Defensive, Cowardly, Support, Chaotic, Tactical)
- Tag array validation (humanoid, undead, ooze, beast, magic, etc.)
- Resistance map validation (damage type -> percentage)
- Tier reference array (references tiers.json)
- Trait reference array (references traits.json)
- Name generator configuration (prefixes, suffixes, titleFormat)
- Embedded loot table structure validation
- Spawn weight and initiative modifier
- Healing capability flags

**Out of Scope:**
- Trait schema (v0.14.3b)
- Tier schema (v0.14.3c)
- Boss schema (v0.14.3d)
- AI behavior execution logic (runtime concern)
- Spawn system logic (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `monsters.schema.json` |
| Schema Definitions | 5 | `MonsterDefinition`, `NameGenerator`, `EmbeddedLootTable`, `LootEntry`, `CurrencyDrop` |
| Configuration Updates | 1 | Update `monsters.json` to reference new schema |
| Unit Tests | ~6 | Schema validation tests |

### Schema Structure

```
monsters.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Monster Configuration"
|-- description: "Schema for monster definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string (optional)
|   +-- monsters: array of MonsterDefinition
|-- required: ["monsters"]
+-- definitions:
    |-- MonsterDefinition
    |   |-- id: string (pattern: ^[a-z][a-z0-9_]*$)
    |   |-- name: string (minLength: 1)
    |   |-- description: string
    |   |-- baseHealth: integer (minimum: 1)
    |   |-- baseAttack: integer (minimum: 0)
    |   |-- baseDefense: integer (minimum: 0)
    |   |-- experienceValue: integer (minimum: 0)
    |   |-- behavior: string (enum: Aggressive, Defensive, Cowardly, Support, Chaotic, Tactical)
    |   |-- tags: array of string
    |   |-- canHeal: boolean (default: false)
    |   |-- healAmount: integer (optional, required if canHeal=true)
    |   |-- spawnWeight: integer (minimum: 0, default: 100)
    |   |-- initiativeModifier: integer (default: 0)
    |   |-- baseResistances: object (damage type -> percentage, optional)
    |   |-- possibleTiers: array of string (tier id references)
    |   |-- possibleTraits: array of string (trait id references)
    |   |-- nameGenerator: NameGenerator (optional)
    |   |-- lootTable: EmbeddedLootTable (optional)
    |   |-- abilityIds: array of string (optional, ability references)
    |   |-- biomeIds: array of string (optional, spawn biome restrictions)
    |   |-- levelRange: LevelRange (optional, spawn level restrictions)
    |   +-- sortOrder: integer (minimum: 0, optional)
    |-- NameGenerator
    |   |-- prefixes: array of string (minItems: 1)
    |   |-- suffixes: array of string (minItems: 1)
    |   +-- titleFormat: string (format pattern with {0}, {1})
    |-- EmbeddedLootTable
    |   |-- entries: array of LootEntry
    |   +-- currencyDrops: array of CurrencyDrop (optional)
    |-- LootEntry
    |   |-- itemId: string (item reference)
    |   |-- weight: integer (minimum: 1, default: 100)
    |   |-- minQuantity: integer (minimum: 1, default: 1)
    |   |-- maxQuantity: integer (minimum: 1, default: 1)
    |   +-- dropChance: number (minimum: 0, maximum: 1, default: 1.0)
    |-- CurrencyDrop
    |   |-- currencyId: string (default: "gold")
    |   |-- minAmount: integer (minimum: 0)
    |   |-- maxAmount: integer (minimum: 0)
    |   +-- dropChance: number (minimum: 0, maximum: 1, default: 1.0)
    +-- LevelRange
        |-- min: integer (minimum: 1, default: 1)
        +-- max: integer (minimum: 1, optional)
```

### AI Behavior Patterns

| Behavior | Description | Typical Monsters |
|----------|-------------|------------------|
| `Aggressive` | Attacks strongest target, pursues relentlessly | Orc, Skeleton |
| `Defensive` | Protects allies, uses defensive abilities | Guardian, Golem |
| `Cowardly` | Flees when low HP, avoids strong enemies | Goblin, Rat |
| `Support` | Heals allies, buffs, stays behind front line | Goblin Shaman, Priest |
| `Chaotic` | Random target selection, unpredictable | Slime, Demon |
| `Tactical` | Prioritizes weak targets, uses abilities strategically | Assassin, Mage |

### Monster Tags

| Tag | Description | Examples |
|-----|-------------|----------|
| `humanoid` | Intelligent bipedal creatures | Goblin, Orc, Bandit |
| `undead` | Animated dead creatures | Skeleton, Zombie, Ghost |
| `beast` | Natural animal creatures | Wolf, Bear, Boar |
| `ooze` | Amorphous blob creatures | Slime, Gelatinous Cube |
| `magic` | Magically inclined creatures | Shaman, Mage, Elemental |
| `construct` | Artificially created creatures | Golem, Automaton |
| `dragon` | Draconic creatures | Drake, Dragon, Wyvern |

### Acceptance Criteria

- [x] `monsters.schema.json` created in `config/schemas/`
- [x] Schema validates existing `monsters.json` without errors
- [x] Base stats validated (health >= 1, attack/defense >= 0)
- [x] Behavior enum validated (6 options)
- [x] Tags validated as array of strings
- [x] Resistance map validated (damage type keys, percentage values)
- [x] Tier/trait references validated as string arrays
- [x] Name generator structure validated (prefixes, suffixes, titleFormat)
- [x] Embedded loot table validated
- [x] ~6 unit tests pass

---

## v0.14.3b: Trait Schema

[v0.14.3b Design Specification](v0.14.3b-design-specification.md)

### Overview

Create a comprehensive JSON schema for monster trait definitions that validates effect types, stat modifiers, ability grants, resistance/immunity modifications, and visual modifiers.

### Scope

**In Scope:**
- `traits.schema.json` - Full schema for trait definitions
- Effect type enumeration (Regeneration, Flying, Venomous, Armored, Berserker, etc.)
- Effect value validation (contextual to effect type)
- Trigger threshold validation (for conditional effects)
- Tag array validation (healing, passive, offensive, defensive, triggered, mobility)
- Visual modifier fields (color, size, descriptor)
- Stat modifier grants (bonus HP, damage, defense, speed)
- Ability grant references (special abilities from traits)
- Resistance/immunity modifiers (damage type protections)

**Out of Scope:**
- Monster schema (v0.14.3a - created first for reference)
- Tier schema (v0.14.3c)
- Trait effect execution logic (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `traits.schema.json` |
| Schema Definitions | 3 | `TraitDefinition`, `StatModifiers`, `ResistanceModifiers` |
| Configuration Updates | 1 | Update `traits.json` to reference new schema |
| Unit Tests | ~5 | Schema validation tests |

### Schema Structure

```
traits.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Monster Trait Configuration"
|-- description: "Schema for monster trait definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string (optional)
|   |-- description: string (file-level description)
|   +-- traits: array of TraitDefinition
|-- required: ["traits"]
+-- definitions:
    |-- TraitDefinition
    |   |-- id: string (pattern: ^[a-z][a-z0-9_]*$)
    |   |-- name: string (minLength: 1)
    |   |-- description: string
    |   |-- effect: string (enum: Regeneration, Flying, Venomous, Armored, Berserker, SpellResistant, Undying, Splitting, Burrowing, Invisible, Teleporting)
    |   |-- effectValue: integer (contextual meaning)
    |   |-- triggerThreshold: integer (optional, for triggered effects)
    |   |-- tags: array of string (enum values)
    |   |-- color: string (display color)
    |   |-- statModifiers: StatModifiers (optional)
    |   |-- resistanceModifiers: ResistanceModifiers (optional)
    |   |-- grantedAbilityIds: array of string (optional)
    |   |-- visualSize: string (enum: Tiny, Small, Medium, Large, Huge, optional)
    |   |-- nameDescriptor: string (optional, e.g., "Poisonous", "Giant")
    |   +-- sortOrder: integer (minimum: 0)
    |-- StatModifiers
    |   |-- bonusHealth: integer (optional)
    |   |-- bonusHealthPercent: number (optional, 0.0-1.0)
    |   |-- bonusAttack: integer (optional)
    |   |-- bonusAttackPercent: number (optional)
    |   |-- bonusDefense: integer (optional)
    |   |-- bonusDefensePercent: number (optional)
    |   |-- bonusSpeed: integer (optional)
    |   +-- bonusInitiative: integer (optional)
    +-- ResistanceModifiers
        |-- resistances: object (damage type -> percentage to add)
        +-- immunities: array of string (damage type ids for 100% resistance)
```

### Effect Types

| Effect | Value Meaning | Trigger |
|--------|---------------|---------|
| `Regeneration` | HP healed per turn | Passive |
| `Flying` | Defense bonus vs melee | Passive |
| `Venomous` | Poison damage on hit | On Attack |
| `Armored` | Flat defense bonus | Passive |
| `Berserker` | Damage bonus % | HP below threshold |
| `SpellResistant` | Magic damage reduction % | Passive |
| `Undying` | Chance to revive at HP | On Death |
| `Splitting` | Spawn count on death | On Death |
| `Burrowing` | Turns invulnerable | Active |
| `Invisible` | Miss chance % | Passive |
| `Teleporting` | Tiles can move | Active |

### Trait Tags

| Tag | Description |
|-----|-------------|
| `passive` | Always active |
| `triggered` | Activates on condition |
| `offensive` | Increases damage output |
| `defensive` | Increases survivability |
| `mobility` | Affects movement |
| `healing` | Restores HP |
| `poison` | Deals poison damage |

### Acceptance Criteria

- [x] `traits.schema.json` created in `config/schemas/`
- [x] Schema validates existing `traits.json` without errors
- [x] Effect enum validated (11 effect types)
- [x] Effect value validated as integer
- [x] Trigger threshold validated as optional integer
- [x] Tags validated as enum array
- [x] Color validated as string
- [x] Stat modifiers validated as optional object
- [x] Resistance modifiers validated as optional object
- [x] ~5 unit tests pass

---

## v0.14.3c: Tier Schema

[v0.14.3c Design Specification](v0.14.3c-design-specification.md)

### Overview

Create a comprehensive JSON schema for monster tier definitions that validates stat multipliers, loot quality scaling, XP rewards, name modifications, and spawn weighting.

### Scope

**In Scope:**
- `tiers.schema.json` - Full schema for tier definitions
- Stat multiplier validation (health, attack, defense, all >= 0)
- Experience multiplier validation
- Loot multiplier validation
- Name prefix/suffix configuration
- Color configuration for display
- Spawn weight for probability
- Unique name generation flag

**Out of Scope:**
- Monster schema (v0.14.3a)
- Trait schema (v0.14.3b)
- Tier application logic (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `tiers.schema.json` |
| Schema Definitions | 1 | `TierDefinition` |
| Configuration Updates | 1 | Update `tiers.json` to reference new schema |
| Unit Tests | ~4 | Schema validation tests |

### Schema Structure

```
tiers.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Monster Tier Configuration"
|-- description: "Schema for monster difficulty tier definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string (optional)
|   |-- description: string (file-level description)
|   +-- tiers: array of TierDefinition
|-- required: ["tiers"]
+-- definitions:
    +-- TierDefinition
        |-- id: string (pattern: ^[a-z][a-z0-9_]*$)
        |-- name: string (minLength: 1)
        |-- namePrefix: string (optional, e.g., "Elite")
        |-- nameSuffix: string (optional, e.g., "Champion")
        |-- healthMultiplier: number (minimum: 0.1, default: 1.0)
        |-- attackMultiplier: number (minimum: 0.1, default: 1.0)
        |-- defenseMultiplier: number (minimum: 0.1, default: 1.0)
        |-- experienceMultiplier: number (minimum: 0.1, default: 1.0)
        |-- lootMultiplier: number (minimum: 0.1, default: 1.0)
        |-- lootQualityBonus: integer (optional, shifts rarity)
        |-- color: string (display color)
        |-- spawnWeight: integer (minimum: 0, default: 100)
        |-- generatesUniqueName: boolean (default: false)
        |-- additionalTraits: array of string (optional, forced traits)
        |-- minimumLevel: integer (optional, level gate)
        +-- sortOrder: integer (minimum: 0)
```

### Tier Examples

| Tier | HP | ATK | DEF | XP | Loot | Spawn |
|------|-----|-----|-----|-----|------|-------|
| `common` | 1.0x | 1.0x | 1.0x | 1.0x | 1.0x | 70% |
| `named` | 1.5x | 1.3x | 1.2x | 2.0x | 2.0x | 20% |
| `elite` | 2.0x | 1.5x | 1.5x | 3.0x | 3.0x | 8% |
| `boss` | 5.0x | 2.0x | 2.0x | 10.0x | 5.0x | 2% |

### Name Generation

| Tier | Prefix | Unique Name | Example Output |
|------|--------|-------------|----------------|
| `common` | None | No | "Goblin" |
| `named` | None | Yes | "Gnik the Fierce" |
| `elite` | "Elite" | No | "Elite Goblin" |
| `boss` | "Boss" | No | "Boss Goblin" |

### Acceptance Criteria

- [x] `tiers.schema.json` created in `config/schemas/`
- [x] Schema validates existing `tiers.json` without errors
- [x] All multipliers validated as >= 0.1
- [x] Name prefix/suffix validated as optional strings
- [x] Color validated as string
- [x] Spawn weight validated as non-negative integer
- [x] Unique name generation flag validated as boolean
- [x] Sort order validated as non-negative integer
- [x] ~4 unit tests pass

---

## v0.14.3d: Boss Schema

[v0.14.3d Design Specification](v0.14.3d-design-specification.md)

### Overview

Create a comprehensive JSON schema for boss encounter definitions that validates phase configurations, health thresholds, ability rotations, enrage mechanics, summon configurations, vulnerability windows, and unique loot tables.

### Scope

**In Scope:**
- `bosses.schema.json` - Full schema for boss definitions
- Phase definition structure (health threshold, abilities, behavior)
- Phase transition configuration
- Enrage mechanic definitions (timer, condition, effects)
- Vulnerability window configuration
- Summon/minion spawn rules
- Unique loot table references
- Boss-specific dialogue/announcements

**Out of Scope:**
- Monster schema (v0.14.3a - bosses reference monsters)
- Phase transition execution logic (runtime concern)
- Enrage timer execution (runtime concern)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| JSON Schemas | 1 | `bosses.schema.json` |
| Schema Definitions | 6 | `BossDefinition`, `BossPhase`, `EnrageConfig`, `SummonConfig`, `VulnerabilityWindow`, `BossAnnouncement` |
| Configuration Updates | 1 | Create `bosses.json` with 2-3 example bosses |
| Unit Tests | ~5 | Schema validation tests |

### Schema Structure

```
bosses.schema.json
|-- $schema: "http://json-schema.org/draft-07/schema#"
|-- title: "Boss Configuration"
|-- description: "Schema for boss encounter definitions"
|-- type: object
|-- properties:
|   |-- $schema: string
|   |-- version: string (optional)
|   +-- bosses: array of BossDefinition
|-- required: ["bosses"]
+-- definitions:
    |-- BossDefinition
    |   |-- id: string (pattern: ^[a-z][a-z0-9_-]*$)
    |   |-- name: string (minLength: 1)
    |   |-- title: string (optional, e.g., "Lord of Bones")
    |   |-- description: string
    |   |-- baseMonsterId: string (references monsters.json)
    |   |-- baseHealth: integer (minimum: 1, overrides monster)
    |   |-- phases: array of BossPhase (minItems: 1)
    |   |-- enrage: EnrageConfig (optional)
    |   |-- summons: array of SummonConfig (optional)
    |   |-- vulnerabilityWindows: array of VulnerabilityWindow (optional)
    |   |-- announcements: array of BossAnnouncement (optional)
    |   |-- uniqueLootTableId: string (optional, references loot-tables)
    |   |-- musicTrackId: string (optional)
    |   |-- arenaRequirements: object (optional, size, terrain)
    |   +-- sortOrder: integer (minimum: 0, optional)
    |-- BossPhase
    |   |-- id: string (pattern: ^[a-z][a-z0-9_]*$)
    |   |-- name: string (e.g., "Phase 1", "Enraged Form")
    |   |-- healthThresholdPercent: number (minimum: 0, maximum: 100)
    |   |-- behavior: string (enum: Aggressive, Defensive, Tactical, Berserk, Summoner)
    |   |-- abilityIds: array of string (abilities available this phase)
    |   |-- abilityRotation: array of string (optional, fixed rotation)
    |   |-- statModifiers: StatModifiers (optional, phase-specific buffs)
    |   |-- transitionAnnouncement: string (optional)
    |   +-- transitionEffect: string (optional, visual effect id)
    |-- EnrageConfig
    |   |-- triggerType: string (enum: Timer, HealthPercent, TurnCount, AllyDeath)
    |   |-- triggerValue: number (timer seconds, health %, turn count)
    |   |-- statMultipliers: object (attack, speed multipliers)
    |   |-- additionalAbilityIds: array of string (optional)
    |   +-- announcement: string (optional)
    |-- SummonConfig
    |   |-- monsterId: string (references monsters.json)
    |   |-- count: QuantityRange
    |   |-- triggerType: string (enum: PhaseStart, Timer, HealthPercent, Random)
    |   |-- triggerValue: number (optional, contextual)
    |   |-- cooldownTurns: integer (optional, turns between summons)
    |   |-- maxActive: integer (optional, cap on active summons)
    |   +-- announcement: string (optional)
    |-- VulnerabilityWindow
    |   |-- id: string
    |   |-- triggerType: string (enum: AfterAbility, PhaseTransition, Timer, HealthPercent)
    |   |-- triggerValue: string or number (ability id or threshold)
    |   |-- durationTurns: integer (minimum: 1)
    |   |-- damageMultiplier: number (minimum: 1.0, default: 2.0)
    |   +-- announcement: string (optional)
    +-- BossAnnouncement
        |-- trigger: string (enum: BattleStart, PhaseTransition, Enrage, LowHealth, Victory, Summon)
        |-- triggerValue: string or number (optional, specific threshold)
        +-- text: string (the announcement text)
```

### Boss Behaviors

| Behavior | Description | When Used |
|----------|-------------|-----------|
| `Aggressive` | Focuses on damage, attacks strongest | Default phase |
| `Defensive` | Uses defensive abilities, heals | Low health phase |
| `Tactical` | Targets weak/dangerous enemies | Strategic phase |
| `Berserk` | All-out attack, ignores defense | Enrage phase |
| `Summoner` | Prioritizes spawning minions | Summon phase |

### Enrage Triggers

| Trigger | Value Meaning | Example |
|---------|---------------|---------|
| `Timer` | Seconds until enrage | 180 (3 minutes) |
| `HealthPercent` | Health % that triggers | 20 (at 20% HP) |
| `TurnCount` | Turns until enrage | 30 turns |
| `AllyDeath` | Triggered when minion dies | N/A |

### Example Boss Structure

```
Skeleton King
|-- Phase 1 (100%-60% HP)
|   |-- Behavior: Tactical
|   |-- Abilities: Bone Throw, Shield Bash
|   +-- Announcement: "You dare challenge me?"
|-- Phase 2 (60%-30% HP)
|   |-- Behavior: Summoner
|   |-- Abilities: Summon Skeletons, Dark Wave
|   |-- Summons: 2-4 Skeletons every 3 turns
|   +-- Announcement: "Rise, my minions!"
|-- Phase 3 (30%-0% HP)
|   |-- Behavior: Berserk
|   |-- Abilities: Bone Storm, Death Strike
|   |-- Vulnerability: After Bone Storm (2 turns, 2x damage)
|   +-- Announcement: "ENOUGH! I will destroy you all!"
+-- Enrage: After 5 minutes, +50% damage, +25% speed
```

### Acceptance Criteria

- [x] `bosses.schema.json` created in `config/schemas/`
- [x] Schema validates with sample boss definitions
- [x] Phase array validated (minimum 1 phase)
- [x] Health threshold validated (0-100%)
- [x] Phase behavior enum validated
- [x] Enrage config validated with trigger types
- [x] Summon config validated with quantity ranges
- [x] Vulnerability window validated with duration
- [x] Announcements validated with trigger types
- [x] Base monster reference validated as string
- [x] ~5 unit tests pass

---

## Dependencies & Prerequisites

```
v0.14.2 (Equipment Configuration Schemas) - REQUIRED
    |
    +-- loot-tables.schema.json available ─────────────────────────────────┐
                                                                           |
                                       v
v0.14.3 (Monster Configuration Schemas)
    |
    |-- v0.14.3a: Monster Schema ─────────────────────────────────────────┐
    |       Dependencies: loot-tables.schema.json (embedded loot ref)      |
    |       Provides: monsters.schema.json                                 |
    |                                                                      |
    |-- v0.14.3b: Trait Schema ───────────────────────────────────────────┤
    |       Dependencies: damage-types.schema.json (resistance refs)       |
    |       Provides: traits.schema.json                                   |
    |                                                                      |
    |-- v0.14.3c: Tier Schema ────────────────────────────────────────────┤
    |       Dependencies: None                                             |
    |       Provides: tiers.schema.json                                    |
    |                                                                      |
    +-- v0.14.3d: Boss Schema ────────────────────────────────────────────┘
            Dependencies: v0.14.3a (monster references), loot-tables
            Provides: bosses.schema.json, bosses.json

Note: v0.14.3a, v0.14.3b, v0.14.3c can be implemented in parallel.
      v0.14.3d depends on v0.14.3a for monster references.
```

---

## Estimated Effort Summary

| Part | New Files | Modified Files | Est. Tests | Complexity |
|------|-----------|----------------|------------|------------|
| v0.14.3a | 1 | 1 | ~6 | High |
| v0.14.3b | 1 | 1 | ~5 | Medium |
| v0.14.3c | 1 | 1 | ~4 | Low |
| v0.14.3d | 2 | 0 | ~5 | High |
| **Total** | **5** | **3** | **~20** | |

---

## Risk Assessment

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Existing monsters.json fails validation | Medium | Low | Review all entries before finalizing schema |
| Boss phase complexity overwhelming | Medium | Medium | Start simple, add advanced features incrementally |
| Embedded loot table redundancy | Low | Low | Allow external loot table references |
| Trait effect enum grows unwieldy | Low | Medium | Group related effects, document clearly |

---

## Design Decisions (Confirmed)

### Schema Standards

| Decision | Value | Notes |
|----------|-------|-------|
| **JSON Schema Version** | Draft-07 | Consistent with v0.14.0-v0.14.2 |
| **ID Pattern** | `^[a-z][a-z0-9_]*$` | Matches existing monster/tier/trait convention |
| **Schema Location** | `config/schemas/` | Centralized schema storage |

### Monster Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Behavior Enum** | 6 behaviors | Aggressive, Defensive, Cowardly, Support, Chaotic, Tactical |
| **Embedded Loot** | Supported | Each monster can have inline loot table |
| **External Loot Ref** | Also supported | Can reference loot-tables.json by ID |
| **Resistance Range** | -100 to 100 | Negative = weakness, positive = resistance |

### Boss Design

| Decision | Value | Notes |
|----------|-------|-------|
| **Minimum Phases** | 1 | Simple bosses can have single phase |
| **Maximum Phases** | Unlimited | Complex bosses can have many phases |
| **Phase Threshold** | Percentage | 0-100, triggers at or below threshold |
| **Enrage Optional** | Yes | Not all bosses need enrage mechanics |

---

## Next Steps

1. **Review & Approve** - Confirm scope breakdown
2. **v0.14.3c Design Spec** - Create tier schema first (simplest, no dependencies)
3. **v0.14.3c Implementation** - Build tiers.schema.json
4. **v0.14.3b Design Spec** - Create trait schema
5. **v0.14.3b Implementation** - Build traits.schema.json
6. **v0.14.3a Design Spec** - Create monster schema
7. **v0.14.3a Implementation** - Build monsters.schema.json
8. **v0.14.3d Design Spec** - Create boss schema (depends on monsters)
9. **v0.14.3d Implementation** - Build bosses.schema.json, bosses.json

---

*This scope breakdown provides a structured approach to implementing v0.14.3 Monster Configuration Schemas. Each sub-part creates a complete, validated JSON schema for monster-related configuration files. The recommended implementation order is v0.14.3c (tiers), v0.14.3b (traits), v0.14.3a (monsters), and finally v0.14.3d (bosses), ensuring dependencies are satisfied and enabling full monster/encounter customization without code changes.*
