# v0.12.1a Design Specification: Achievement Definitions

**Version:** 0.12.1a
**Parent:** v0.12.1 (Achievements & Leaderboards)
**Prerequisites:** v0.12.0c Complete (Statistics View)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [AchievementCategory Enum](#4-achievementcategory-enum)
5. [AchievementTier Enum](#5-achievementtier-enum)
6. [ComparisonOperator Enum](#6-comparisonoperator-enum)
7. [AchievementCondition Record](#7-achievementcondition-record)
8. [AchievementDefinition Entity](#8-achievementdefinition-entity)
9. [IAchievementProvider Interface](#9-iachievementprovider-interface)
10. [AchievementProvider Implementation](#10-achievementprovider-implementation)
11. [Configuration Schema](#11-configuration-schema)
12. [Configuration File](#12-configuration-file)
13. [Logging Specifications](#13-logging-specifications)
14. [Unit Testing Requirements](#14-unit-testing-requirements)
15. [Use Cases](#15-use-cases)
16. [Deliverable Checklist](#16-deliverable-checklist)
17. [Acceptance Criteria](#17-acceptance-criteria)
18. [Dependencies](#18-dependencies)
19. [Future Considerations](#19-future-considerations)

---

## 1. Executive Summary

### Overview

Version 0.12.1a implements achievement definitions for the Achievements & Leaderboards system. This includes the `AchievementDefinition` entity that serves as a template for achievements, the `AchievementCondition` record for specifying unlock conditions based on statistics, supporting enums for categories and tiers, the `IAchievementProvider` interface for data access, and JSON configuration for data-driven achievement content. This foundational system enables the achievement tracking and unlock detection in v0.12.1b.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Domain Entities** | AchievementDefinition |
| **Domain Records** | AchievementCondition |
| **Domain Enums** | AchievementCategory, AchievementTier, ComparisonOperator |
| **Interfaces** | IAchievementProvider |
| **Infrastructure** | AchievementProvider |
| **Configuration** | achievements.json, achievements.schema.json |
| **Tests** | ~12 new unit tests |

### Architectural Significance

This version establishes the **Achievement Definition Pattern** that will be used throughout the achievement system:
- Data-driven achievement definitions loaded from JSON
- Condition-based unlock requirements tied to statistics
- Tiered point system (Bronze 10, Silver 25, Gold 50, Platinum 100)
- Secret achievement support for hidden accomplishments
- Category organization for achievement grouping

---

## 2. Feature Overview

```
v0.12.1a Achievement Definitions Features
├── AchievementDefinition Entity
│   ├── AchievementId (string key)
│   ├── Name, Description
│   ├── Category (AchievementCategory enum)
│   ├── Tier (AchievementTier enum)
│   ├── Points (derived from tier)
│   ├── Conditions (list of AchievementCondition)
│   ├── IsSecret (hidden until unlocked)
│   └── IconPath (optional)
│
├── AchievementCondition Record
│   ├── StatisticName (stat to check)
│   ├── Operator (>=, <=, ==)
│   └── Value (threshold)
│
├── AchievementCategory Enum
│   ├── Combat
│   ├── Exploration
│   ├── Progression
│   ├── Collection
│   ├── Challenge
│   └── Secret
│
├── AchievementTier Enum
│   ├── Bronze (10 points)
│   ├── Silver (25 points)
│   ├── Gold (50 points)
│   └── Platinum (100 points)
│
├── ComparisonOperator Enum
│   ├── GreaterThanOrEqual (>=)
│   ├── LessThanOrEqual (<=)
│   └── Equals (==)
│
├── IAchievementProvider Interface
│   ├── GetAllAchievements()
│   ├── GetAchievementById()
│   ├── GetAchievementsByCategory()
│   └── GetAchievementsByTier()
│
├── AchievementProvider Implementation
│   ├── JSON loading
│   ├── Caching
│   └── Validation
│
└── Configuration
    ├── achievements.json
    └── achievements.schema.json
```

---

## 3. Architecture Diagrams

### 3.1 Achievement Definition Architecture

```
┌─────────────────────────────────────────────────────────────────────┐
│                 ACHIEVEMENT DEFINITION ARCHITECTURE                   │
└─────────────────────────────────────────────────────────────────────┘

     Configuration                    Domain
     ─────────────                    ──────

   achievements.json           ┌─────────────────────────────┐
   ┌───────────────────┐       │   AchievementDefinition     │
   │ {                  │       ├─────────────────────────────┤
   │   "id": "first-   │       │ + Id: Guid                  │
   │         blood",   │ ────▶ │ + AchievementId: string     │
   │   "name": "...",  │       │ + Name: string              │
   │   "category":     │       │ + Description: string       │
   │         "Combat", │       │ + Category: AchievementCat  │
   │   "tier": "Bronze"│       │ + Tier: AchievementTier     │
   │   "conditions":[..]│      │ + Points: int               │
   │ }                  │       │ + Conditions: list          │
   └───────────────────┘       │ + IsSecret: bool            │
                               │ + IconPath: string?         │
                               └─────────────────────────────┘
                                            │
                                            │ contains
                                            ▼
                               ┌─────────────────────────────┐
                               │    AchievementCondition     │
                               ├─────────────────────────────┤
                               │ + StatisticName: string     │
                               │ + Operator: ComparisonOp    │
                               │ + Value: long               │
                               └─────────────────────────────┘
```

### 3.2 Provider Architecture

```
┌─────────────────────────────────────────────────────────────────────┐
│                      PROVIDER ARCHITECTURE                           │
└─────────────────────────────────────────────────────────────────────┘

                        APPLICATION LAYER
                        ─────────────────

    AchievementService                IAchievementProvider
    (v0.12.1b)                        (Interface)
         │                                  │
         │ queries                          │
         ▼                                  │
┌───────────────────────────────────────────┴───────────────────────┐
│                    IAchievementProvider                            │
├───────────────────────────────────────────────────────────────────┤
│ + GetAllAchievements(): IReadOnlyList<AchievementDefinition>      │
│ + GetAchievementById(id): AchievementDefinition?                  │
│ + GetAchievementsByCategory(cat): IReadOnlyList<...>              │
│ + GetAchievementsByTier(tier): IReadOnlyList<...>                 │
└───────────────────────────────────────────────────────────────────┘
                                │
                                │ implements
                                ▼

                        INFRASTRUCTURE LAYER
                        ────────────────────

┌───────────────────────────────────────────────────────────────────┐
│                    AchievementProvider                             │
├───────────────────────────────────────────────────────────────────┤
│ Dependencies:                                                      │
│ - ILogger<AchievementProvider>                                    │
│ - IOptions<AchievementOptions>                                    │
│                                                                    │
│ Private Fields:                                                    │
│ - _achievements: Dictionary<string, AchievementDefinition>        │
│ - _isLoaded: bool                                                  │
│                                                                    │
│ Methods:                                                           │
│ + LoadAchievements()                                              │
│ + GetAllAchievements()                                            │
│ + GetAchievementById(id)                                          │
│ + ValidateAchievements()                                          │
└───────────────────────────────────────────────────────────────────┘
                                │
                                │ reads
                                ▼
┌───────────────────────────────────────────────────────────────────┐
│                    config/achievements.json                        │
├───────────────────────────────────────────────────────────────────┤
│ {                                                                  │
│   "$schema": "./schemas/achievements.schema.json",                 │
│   "achievements": [                                                │
│     { "id": "first-blood", "name": "...", ... },                  │
│     { "id": "monster-slayer", ... }                               │
│   ]                                                                │
│ }                                                                  │
└───────────────────────────────────────────────────────────────────┘
```

### 3.3 Condition Evaluation Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                    CONDITION EVALUATION FLOW                         │
└─────────────────────────────────────────────────────────────────────┘

    (Used by AchievementService in v0.12.1b)

    AchievementDefinition
    ─────────────────────

    "Monster Slayer" Achievement
    ├── Category: Combat
    ├── Tier: Silver (25 pts)
    └── Conditions:
        └── [0] StatisticName: "monstersKilled"
             Operator: GreaterThanOrEqual
             Value: 100


    EVALUATION AGAINST PLAYER STATISTICS
    ─────────────────────────────────────

    ┌─────────────────────────────────────────────────────────────────┐
    │ For each condition in achievement.Conditions:                   │
    │                                                                  │
    │   1. Get statistic value from PlayerStatistics                  │
    │      playerValue = stats.GetStatistic(condition.StatisticName)  │
    │                                                                  │
    │   2. Compare using operator:                                     │
    │      ┌─────────────────────────────────────────────────────────┐│
    │      │ GreaterThanOrEqual: playerValue >= condition.Value      ││
    │      │ LessThanOrEqual:    playerValue <= condition.Value      ││
    │      │ Equals:             playerValue == condition.Value      ││
    │      └─────────────────────────────────────────────────────────┘│
    │                                                                  │
    │   3. All conditions must pass for achievement to unlock         │
    └─────────────────────────────────────────────────────────────────┘


    EXAMPLE
    ───────

    Player has killed 127 monsters

    Condition: monstersKilled >= 100
    Evaluation: 127 >= 100 → TRUE

    → Achievement unlocks!
```

### 3.4 Tier Point System

```
┌─────────────────────────────────────────────────────────────────────┐
│                      TIER POINT SYSTEM                               │
└─────────────────────────────────────────────────────────────────────┘

    TIER DEFINITIONS
    ────────────────

    ┌────────────────────────────────────────────────────────────────┐
    │ Tier      │ Points │ Description          │ Typical Criteria   │
    ├───────────┼────────┼──────────────────────┼────────────────────┤
    │ Bronze    │   10   │ Entry-level          │ First time actions │
    │ Silver    │   25   │ Moderate challenge   │ 10-100 of action   │
    │ Gold      │   50   │ Significant effort   │ 100-500 of action  │
    │ Platinum  │  100   │ Major accomplishment │ 500+ or rare feats │
    └────────────────────────────────────────────────────────────────┘


    POINT CALCULATION
    ─────────────────

    Total Achievement Points = Sum of all unlocked achievement points

    Example:
    ┌────────────────────────────────────────────────────────────────┐
    │ Unlocked Achievements:                                         │
    │                                                                │
    │   First Blood (Bronze)       = 10 pts                         │
    │   Monster Slayer (Silver)    = 25 pts                         │
    │   Room Explorer (Bronze)     = 10 pts                         │
    │   ─────────────────────────────────────                       │
    │   Total                      = 45 pts                         │
    └────────────────────────────────────────────────────────────────┘
```

### 3.5 Clean Architecture Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────┐
│                      CLEAN ARCHITECTURE LAYERS                       │
└─────────────────────────────────────────────────────────────────────┘

    ┌─────────────────────────────────────────────────────────────────┐
    │                      PRESENTATION LAYER                          │
    │                                                                  │
    │  (Achievements View - v0.12.1b)                                  │
    │  - Displays achievements with categories                         │
    │  - Shows locked/unlocked status                                  │
    │  - Displays progress for locked achievements                     │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │                      APPLICATION LAYER                           │
    │                                                                  │
    │  ┌─────────────────────────┐  ┌─────────────────────────────┐   │
    │  │  IAchievementProvider   │  │    AchievementCondition     │   │
    │  │  (interface)            │  │    (record)                 │   │
    │  │                         │  │                             │   │
    │  │ + GetAllAchievements()  │  │ + StatisticName: string     │   │
    │  │ + GetAchievementById()  │  │ + Operator: ComparisonOp    │   │
    │  │ + GetByCategory()       │  │ + Value: long               │   │
    │  │ + GetByTier()           │  │                             │   │
    │  └─────────────────────────┘  └─────────────────────────────┘   │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │                        DOMAIN LAYER                              │
    │                                                                  │
    │  ┌─────────────────────────┐  ┌─────────────────────────────┐   │
    │  │  AchievementDefinition  │  │    AchievementCategory      │   │
    │  │  (entity)               │  │    (enum)                   │   │
    │  │                         │  │                             │   │
    │  │ + Id: Guid              │  │ Combat, Exploration,        │   │
    │  │ + AchievementId: string │  │ Progression, Collection,    │   │
    │  │ + Name: string          │  │ Challenge, Secret           │   │
    │  │ + Category: enum        │  └─────────────────────────────┘   │
    │  │ + Tier: enum            │                                    │
    │  │ + Points: int           │  ┌─────────────────────────────┐   │
    │  │ + Conditions: list      │  │    AchievementTier          │   │
    │  │ + IsSecret: bool        │  │    (enum)                   │   │
    │  └─────────────────────────┘  │                             │   │
    │                               │ Bronze=10, Silver=25,       │   │
    │  ┌─────────────────────────┐  │ Gold=50, Platinum=100       │   │
    │  │   ComparisonOperator    │  └─────────────────────────────┘   │
    │  │   (enum)                │                                    │
    │  │                         │                                    │
    │  │ >=, <=, ==              │                                    │
    │  └─────────────────────────┘                                    │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │                    INFRASTRUCTURE LAYER                          │
    │                                                                  │
    │  ┌─────────────────────────────────────────────────────────┐    │
    │  │                  AchievementProvider                     │    │
    │  │  - Loads achievements.json                               │    │
    │  │  - Validates against schema                              │    │
    │  │  - Caches loaded definitions                             │    │
    │  └─────────────────────────────────────────────────────────┘    │
    └─────────────────────────────────────────────────────────────────┘
```

---

## 4. AchievementCategory Enum

### 4.1 Enum Definition

**File:** `src/Core/RuneAndRust.Domain/Enums/AchievementCategory.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Categories for organizing achievements by gameplay area.
/// </summary>
/// <remarks>
/// <para>Achievement categories help players navigate the achievement list:</para>
/// <list type="bullet">
///   <item><description>Combat: Killing monsters, dealing damage, combat feats</description></item>
///   <item><description>Exploration: Discovering rooms, finding secrets</description></item>
///   <item><description>Progression: Leveling up, gaining XP, completing quests</description></item>
///   <item><description>Collection: Finding items, gathering resources</description></item>
///   <item><description>Challenge: Difficult feats, speed runs, no-death runs</description></item>
///   <item><description>Secret: Hidden achievements revealed only when unlocked</description></item>
/// </list>
/// </remarks>
public enum AchievementCategory
{
    /// <summary>
    /// Achievements related to combat: kills, damage, abilities.
    /// </summary>
    Combat,

    /// <summary>
    /// Achievements related to exploration: rooms, secrets, discoveries.
    /// </summary>
    Exploration,

    /// <summary>
    /// Achievements related to progression: levels, XP, quests.
    /// </summary>
    Progression,

    /// <summary>
    /// Achievements related to collecting: items, gold, resources.
    /// </summary>
    Collection,

    /// <summary>
    /// Achievements for difficult challenges: rare feats, special conditions.
    /// </summary>
    Challenge,

    /// <summary>
    /// Hidden achievements revealed only upon unlock.
    /// </summary>
    Secret
}
```

---

## 5. AchievementTier Enum

### 5.1 Enum Definition

**File:** `src/Core/RuneAndRust.Domain/Enums/AchievementTier.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Tiers of achievements with associated point values.
/// </summary>
/// <remarks>
/// <para>Each tier represents a level of difficulty or rarity:</para>
/// <list type="bullet">
///   <item><description>Bronze (10 pts): Entry-level, first-time accomplishments</description></item>
///   <item><description>Silver (25 pts): Moderate challenge, requires some effort</description></item>
///   <item><description>Gold (50 pts): Significant accomplishment, substantial effort</description></item>
///   <item><description>Platinum (100 pts): Major achievement, rare or difficult feat</description></item>
/// </list>
/// <para>The enum values represent the point values directly.</para>
/// </remarks>
public enum AchievementTier
{
    /// <summary>
    /// Entry-level achievement worth 10 points.
    /// Typically first-time accomplishments.
    /// </summary>
    Bronze = 10,

    /// <summary>
    /// Moderate challenge achievement worth 25 points.
    /// Requires some dedication to unlock.
    /// </summary>
    Silver = 25,

    /// <summary>
    /// Significant achievement worth 50 points.
    /// Requires substantial effort to unlock.
    /// </summary>
    Gold = 50,

    /// <summary>
    /// Major achievement worth 100 points.
    /// Rare or very difficult to unlock.
    /// </summary>
    Platinum = 100
}
```

---

## 6. ComparisonOperator Enum

### 6.1 Enum Definition

**File:** `src/Core/RuneAndRust.Domain/Enums/ComparisonOperator.cs`

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Comparison operators for achievement condition evaluation.
/// </summary>
/// <remarks>
/// <para>Used to compare player statistics against achievement thresholds:</para>
/// <list type="bullet">
///   <item><description>GreaterThanOrEqual: Player value must be >= threshold</description></item>
///   <item><description>LessThanOrEqual: Player value must be <= threshold</description></item>
///   <item><description>Equals: Player value must exactly match threshold</description></item>
/// </list>
/// </remarks>
public enum ComparisonOperator
{
    /// <summary>
    /// Player statistic must be greater than or equal to the threshold.
    /// Most common for cumulative achievements (e.g., "Kill 100 monsters").
    /// </summary>
    GreaterThanOrEqual,

    /// <summary>
    /// Player statistic must be less than or equal to the threshold.
    /// Used for achievements like "Complete with 0 deaths".
    /// </summary>
    LessThanOrEqual,

    /// <summary>
    /// Player statistic must exactly equal the threshold.
    /// Used for specific achievements (e.g., "Reach exactly level 10").
    /// </summary>
    Equals
}
```

---

## 7. AchievementCondition Record

### 7.1 Record Definition

**File:** `src/Core/RuneAndRust.Application/Models/AchievementCondition.cs`

```csharp
namespace RuneAndRust.Application.Models;

using RuneAndRust.Domain.Enums;

/// <summary>
/// Represents a single condition that must be met to unlock an achievement.
/// </summary>
/// <remarks>
/// <para>Conditions are evaluated against player statistics:</para>
/// <list type="bullet">
///   <item><description>StatisticName maps to a property on PlayerStatistics or DiceRollHistory</description></item>
///   <item><description>Operator determines the comparison type</description></item>
///   <item><description>Value is the threshold to compare against</description></item>
/// </list>
/// <para>Multiple conditions on an achievement require ALL to be satisfied (AND logic).</para>
/// </remarks>
/// <param name="StatisticName">The name of the statistic to check (e.g., "monstersKilled", "roomsDiscovered").</param>
/// <param name="Operator">The comparison operator to use.</param>
/// <param name="Value">The threshold value to compare against.</param>
/// <example>
/// <code>
/// // Achievement condition: Kill at least 100 monsters
/// var condition = new AchievementCondition(
///     "monstersKilled",
///     ComparisonOperator.GreaterThanOrEqual,
///     100);
/// </code>
/// </example>
public record AchievementCondition(
    string StatisticName,
    ComparisonOperator Operator,
    long Value)
{
    /// <summary>
    /// Evaluates this condition against a statistic value.
    /// </summary>
    /// <param name="actualValue">The player's current statistic value.</param>
    /// <returns>True if the condition is satisfied.</returns>
    public bool Evaluate(long actualValue)
    {
        return Operator switch
        {
            ComparisonOperator.GreaterThanOrEqual => actualValue >= Value,
            ComparisonOperator.LessThanOrEqual => actualValue <= Value,
            ComparisonOperator.Equals => actualValue == Value,
            _ => false
        };
    }

    /// <summary>
    /// Gets the progress towards this condition as a percentage (0.0 to 1.0).
    /// </summary>
    /// <param name="actualValue">The player's current statistic value.</param>
    /// <returns>Progress as a decimal (capped at 1.0).</returns>
    public double GetProgress(long actualValue)
    {
        if (Value == 0)
        {
            return actualValue == 0 ? 1.0 : 0.0;
        }

        return Operator switch
        {
            ComparisonOperator.GreaterThanOrEqual => Math.Min(1.0, (double)actualValue / Value),
            ComparisonOperator.LessThanOrEqual => actualValue <= Value ? 1.0 : 0.0,
            ComparisonOperator.Equals => actualValue == Value ? 1.0 : 0.0,
            _ => 0.0
        };
    }
}
```

---

## 8. AchievementDefinition Entity

### 8.1 Entity Definition

**File:** `src/Core/RuneAndRust.Domain/Entities/AchievementDefinition.cs`

```csharp
namespace RuneAndRust.Domain.Entities;

using RuneAndRust.Application.Models;
using RuneAndRust.Domain.Enums;
using RuneAndRust.Domain.Interfaces;

/// <summary>
/// Represents the definition of an achievement that can be unlocked by players.
/// </summary>
/// <remarks>
/// <para>Achievement definitions are loaded from JSON configuration and serve as templates.
/// Each definition specifies:</para>
/// <list type="bullet">
///   <item><description>Basic info: ID, name, description</description></item>
///   <item><description>Classification: category and tier</description></item>
///   <item><description>Unlock conditions: list of statistic-based conditions</description></item>
///   <item><description>Secret status: whether hidden until unlocked</description></item>
/// </list>
/// <para>Points are derived from the tier enum value.</para>
/// </remarks>
public class AchievementDefinition : IEntity
{
    private readonly List<AchievementCondition> _conditions = new();

    /// <summary>
    /// Gets the unique identifier for this achievement definition.
    /// </summary>
    public Guid Id { get; private set; }

    /// <summary>
    /// Gets the string identifier used in configuration and lookups.
    /// </summary>
    /// <example>"first-blood", "monster-slayer", "lucky-streak"</example>
    public string AchievementId { get; private set; } = null!;

    /// <summary>
    /// Gets the display name of the achievement.
    /// </summary>
    public string Name { get; private set; } = null!;

    /// <summary>
    /// Gets the description explaining how to unlock the achievement.
    /// </summary>
    public string Description { get; private set; } = null!;

    /// <summary>
    /// Gets the category this achievement belongs to.
    /// </summary>
    public AchievementCategory Category { get; private set; }

    /// <summary>
    /// Gets the tier/difficulty level of this achievement.
    /// </summary>
    public AchievementTier Tier { get; private set; }

    /// <summary>
    /// Gets the point value for unlocking this achievement.
    /// Derived from the tier: Bronze=10, Silver=25, Gold=50, Platinum=100.
    /// </summary>
    public int Points => (int)Tier;

    /// <summary>
    /// Gets the conditions that must be met to unlock this achievement.
    /// All conditions must be satisfied (AND logic).
    /// </summary>
    public IReadOnlyList<AchievementCondition> Conditions => _conditions.AsReadOnly();

    /// <summary>
    /// Gets whether this is a secret achievement.
    /// Secret achievements are hidden in the UI until unlocked.
    /// </summary>
    public bool IsSecret { get; private set; }

    /// <summary>
    /// Gets the optional path to the achievement icon.
    /// </summary>
    public string? IconPath { get; private set; }

    /// <summary>
    /// Private constructor for EF Core and factory method.
    /// </summary>
    private AchievementDefinition() { }

    /// <summary>
    /// Creates a new AchievementDefinition.
    /// </summary>
    /// <param name="achievementId">The string identifier for this achievement.</param>
    /// <param name="name">The display name.</param>
    /// <param name="description">The description of how to unlock.</param>
    /// <param name="category">The achievement category.</param>
    /// <param name="tier">The achievement tier.</param>
    /// <param name="conditions">The unlock conditions.</param>
    /// <param name="isSecret">Whether this is a hidden achievement.</param>
    /// <param name="iconPath">Optional icon path.</param>
    /// <returns>A new AchievementDefinition instance.</returns>
    /// <exception cref="ArgumentException">If achievementId, name, or description is null/empty.</exception>
    /// <exception cref="ArgumentNullException">If conditions is null.</exception>
    public static AchievementDefinition Create(
        string achievementId,
        string name,
        string description,
        AchievementCategory category,
        AchievementTier tier,
        IEnumerable<AchievementCondition> conditions,
        bool isSecret = false,
        string? iconPath = null)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(achievementId);
        ArgumentException.ThrowIfNullOrWhiteSpace(name);
        ArgumentException.ThrowIfNullOrWhiteSpace(description);
        ArgumentNullException.ThrowIfNull(conditions);

        var definition = new AchievementDefinition
        {
            Id = Guid.NewGuid(),
            AchievementId = achievementId,
            Name = name,
            Description = description,
            Category = category,
            Tier = tier,
            IsSecret = isSecret,
            IconPath = iconPath
        };

        definition._conditions.AddRange(conditions);

        return definition;
    }

    /// <summary>
    /// Gets the display name, respecting secret status.
    /// </summary>
    /// <param name="isUnlocked">Whether the achievement is unlocked.</param>
    /// <returns>The name or "???" if secret and locked.</returns>
    public string GetDisplayName(bool isUnlocked)
    {
        return IsSecret && !isUnlocked ? "???" : Name;
    }

    /// <summary>
    /// Gets the display description, respecting secret status.
    /// </summary>
    /// <param name="isUnlocked">Whether the achievement is unlocked.</param>
    /// <returns>The description or "Hidden achievement" if secret and locked.</returns>
    public string GetDisplayDescription(bool isUnlocked)
    {
        return IsSecret && !isUnlocked ? "Hidden achievement - unlock to reveal!" : Description;
    }
}
```

---

## 9. IAchievementProvider Interface

### 9.1 Interface Definition

**File:** `src/Core/RuneAndRust.Application/Interfaces/IAchievementProvider.cs`

```csharp
namespace RuneAndRust.Application.Interfaces;

using RuneAndRust.Domain.Entities;
using RuneAndRust.Domain.Enums;

/// <summary>
/// Provides access to achievement definitions loaded from configuration.
/// </summary>
/// <remarks>
/// <para>This interface abstracts the data source for achievement definitions:</para>
/// <list type="bullet">
///   <item><description>Enables unit testing with mock data</description></item>
///   <item><description>Supports different configuration sources (JSON, database, etc.)</description></item>
///   <item><description>Caches loaded definitions for performance</description></item>
/// </list>
/// </remarks>
public interface IAchievementProvider
{
    /// <summary>
    /// Gets all achievement definitions.
    /// </summary>
    /// <returns>All loaded achievement definitions.</returns>
    IReadOnlyList<AchievementDefinition> GetAllAchievements();

    /// <summary>
    /// Gets an achievement definition by its string ID.
    /// </summary>
    /// <param name="achievementId">The achievement ID to look up.</param>
    /// <returns>The achievement definition, or null if not found.</returns>
    AchievementDefinition? GetAchievementById(string achievementId);

    /// <summary>
    /// Gets all achievements in a specific category.
    /// </summary>
    /// <param name="category">The category to filter by.</param>
    /// <returns>Achievements in the specified category.</returns>
    IReadOnlyList<AchievementDefinition> GetAchievementsByCategory(AchievementCategory category);

    /// <summary>
    /// Gets all achievements of a specific tier.
    /// </summary>
    /// <param name="tier">The tier to filter by.</param>
    /// <returns>Achievements of the specified tier.</returns>
    IReadOnlyList<AchievementDefinition> GetAchievementsByTier(AchievementTier tier);

    /// <summary>
    /// Gets the total number of achievements.
    /// </summary>
    /// <returns>The count of all achievements.</returns>
    int GetAchievementCount();

    /// <summary>
    /// Gets the maximum possible achievement points.
    /// </summary>
    /// <returns>Sum of all achievement point values.</returns>
    int GetMaxPossiblePoints();
}
```

---

## 10. AchievementProvider Implementation

### 10.1 Implementation

**File:** `src/Infrastructure/RuneAndRust.Infrastructure/Providers/AchievementProvider.cs`

```csharp
namespace RuneAndRust.Infrastructure.Providers;

using Microsoft.Extensions.Logging;
using Microsoft.Extensions.Options;
using RuneAndRust.Application.Interfaces;
using RuneAndRust.Application.Models;
using RuneAndRust.Domain.Entities;
using RuneAndRust.Domain.Enums;
using RuneAndRust.Infrastructure.Configuration;
using System.Text.Json;

/// <summary>
/// Provides achievement definitions loaded from JSON configuration.
/// </summary>
/// <remarks>
/// <para>This provider:</para>
/// <list type="bullet">
///   <item><description>Loads achievements from achievements.json on first access</description></item>
///   <item><description>Caches definitions for subsequent requests</description></item>
///   <item><description>Validates loaded data against schema</description></item>
///   <item><description>Logs loading and validation events</description></item>
/// </list>
/// </remarks>
public class AchievementProvider : IAchievementProvider
{
    private readonly ILogger<AchievementProvider> _logger;
    private readonly AchievementOptions _options;
    private readonly Dictionary<string, AchievementDefinition> _achievementsById = new();
    private List<AchievementDefinition>? _achievements;
    private bool _isLoaded;
    private int? _maxPoints;

    private static readonly JsonSerializerOptions JsonOptions = new()
    {
        PropertyNameCaseInsensitive = true
    };

    /// <summary>
    /// Initializes a new instance of the <see cref="AchievementProvider"/> class.
    /// </summary>
    /// <param name="logger">Logger for diagnostics.</param>
    /// <param name="options">Configuration options.</param>
    public AchievementProvider(
        ILogger<AchievementProvider> logger,
        IOptions<AchievementOptions> options)
    {
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));
        _options = options?.Value ?? throw new ArgumentNullException(nameof(options));
    }

    /// <inheritdoc />
    public IReadOnlyList<AchievementDefinition> GetAllAchievements()
    {
        EnsureLoaded();
        return _achievements!.AsReadOnly();
    }

    /// <inheritdoc />
    public AchievementDefinition? GetAchievementById(string achievementId)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(achievementId);
        EnsureLoaded();
        return _achievementsById.GetValueOrDefault(achievementId);
    }

    /// <inheritdoc />
    public IReadOnlyList<AchievementDefinition> GetAchievementsByCategory(
        AchievementCategory category)
    {
        EnsureLoaded();
        return _achievements!
            .Where(a => a.Category == category)
            .ToList()
            .AsReadOnly();
    }

    /// <inheritdoc />
    public IReadOnlyList<AchievementDefinition> GetAchievementsByTier(AchievementTier tier)
    {
        EnsureLoaded();
        return _achievements!
            .Where(a => a.Tier == tier)
            .ToList()
            .AsReadOnly();
    }

    /// <inheritdoc />
    public int GetAchievementCount()
    {
        EnsureLoaded();
        return _achievements!.Count;
    }

    /// <inheritdoc />
    public int GetMaxPossiblePoints()
    {
        EnsureLoaded();
        _maxPoints ??= _achievements!.Sum(a => a.Points);
        return _maxPoints.Value;
    }

    /// <summary>
    /// Ensures achievements are loaded from configuration.
    /// </summary>
    private void EnsureLoaded()
    {
        if (_isLoaded)
        {
            return;
        }

        LoadAchievements();
        _isLoaded = true;
    }

    /// <summary>
    /// Loads achievements from the JSON configuration file.
    /// </summary>
    private void LoadAchievements()
    {
        var filePath = _options.ConfigurationPath;

        _logger.LogInformation("Loading achievements from {FilePath}", filePath);

        if (!File.Exists(filePath))
        {
            _logger.LogWarning(
                "Achievements file not found at {FilePath}, using empty list",
                filePath);
            _achievements = new List<AchievementDefinition>();
            return;
        }

        try
        {
            var json = File.ReadAllText(filePath);
            var data = JsonSerializer.Deserialize<AchievementConfigData>(json, JsonOptions);

            if (data?.Achievements is null)
            {
                _logger.LogWarning("No achievements found in configuration");
                _achievements = new List<AchievementDefinition>();
                return;
            }

            _achievements = new List<AchievementDefinition>();

            foreach (var entry in data.Achievements)
            {
                var definition = CreateDefinitionFromConfig(entry);
                if (definition is not null)
                {
                    _achievements.Add(definition);
                    _achievementsById[definition.AchievementId] = definition;
                }
            }

            _logger.LogInformation(
                "Loaded {Count} achievements ({Points} max points)",
                _achievements.Count,
                _achievements.Sum(a => a.Points));

            ValidateAchievements();
        }
        catch (JsonException ex)
        {
            _logger.LogError(ex, "Failed to parse achievements configuration");
            _achievements = new List<AchievementDefinition>();
        }
    }

    /// <summary>
    /// Creates an AchievementDefinition from configuration data.
    /// </summary>
    private AchievementDefinition? CreateDefinitionFromConfig(AchievementConfigEntry entry)
    {
        if (string.IsNullOrWhiteSpace(entry.Id) ||
            string.IsNullOrWhiteSpace(entry.Name))
        {
            _logger.LogWarning(
                "Skipping invalid achievement entry: missing id or name");
            return null;
        }

        if (!Enum.TryParse<AchievementCategory>(entry.Category, true, out var category))
        {
            _logger.LogWarning(
                "Invalid category '{Category}' for achievement {Id}, defaulting to Combat",
                entry.Category,
                entry.Id);
            category = AchievementCategory.Combat;
        }

        if (!Enum.TryParse<AchievementTier>(entry.Tier, true, out var tier))
        {
            _logger.LogWarning(
                "Invalid tier '{Tier}' for achievement {Id}, defaulting to Bronze",
                entry.Tier,
                entry.Id);
            tier = AchievementTier.Bronze;
        }

        var conditions = entry.Conditions?
            .Select(CreateConditionFromConfig)
            .Where(c => c is not null)
            .Select(c => c!)
            .ToList() ?? new List<AchievementCondition>();

        return AchievementDefinition.Create(
            achievementId: entry.Id,
            name: entry.Name,
            description: entry.Description ?? string.Empty,
            category: category,
            tier: tier,
            conditions: conditions,
            isSecret: entry.IsSecret,
            iconPath: entry.IconPath);
    }

    /// <summary>
    /// Creates an AchievementCondition from configuration data.
    /// </summary>
    private AchievementCondition? CreateConditionFromConfig(ConditionConfigEntry entry)
    {
        if (string.IsNullOrWhiteSpace(entry.Stat))
        {
            return null;
        }

        var op = entry.Operator switch
        {
            ">=" => ComparisonOperator.GreaterThanOrEqual,
            "<=" => ComparisonOperator.LessThanOrEqual,
            "==" => ComparisonOperator.Equals,
            "=" => ComparisonOperator.Equals,
            _ => ComparisonOperator.GreaterThanOrEqual
        };

        return new AchievementCondition(entry.Stat, op, entry.Value);
    }

    /// <summary>
    /// Validates loaded achievements for consistency.
    /// </summary>
    private void ValidateAchievements()
    {
        var duplicates = _achievements!
            .GroupBy(a => a.AchievementId)
            .Where(g => g.Count() > 1)
            .Select(g => g.Key)
            .ToList();

        foreach (var dup in duplicates)
        {
            _logger.LogWarning(
                "Duplicate achievement ID found: {AchievementId}",
                dup);
        }

        var noConditions = _achievements
            .Where(a => a.Conditions.Count == 0)
            .ToList();

        foreach (var achievement in noConditions)
        {
            _logger.LogWarning(
                "Achievement {AchievementId} has no unlock conditions",
                achievement.AchievementId);
        }
    }

    /// <summary>
    /// Configuration data model for deserialization.
    /// </summary>
    private class AchievementConfigData
    {
        public List<AchievementConfigEntry>? Achievements { get; set; }
    }

    /// <summary>
    /// Configuration entry for a single achievement.
    /// </summary>
    private class AchievementConfigEntry
    {
        public string Id { get; set; } = string.Empty;
        public string Name { get; set; } = string.Empty;
        public string? Description { get; set; }
        public string Category { get; set; } = "Combat";
        public string Tier { get; set; } = "Bronze";
        public List<ConditionConfigEntry>? Conditions { get; set; }
        public bool IsSecret { get; set; }
        public string? IconPath { get; set; }
    }

    /// <summary>
    /// Configuration entry for a condition.
    /// </summary>
    private class ConditionConfigEntry
    {
        public string Stat { get; set; } = string.Empty;
        public string Operator { get; set; } = ">=";
        public long Value { get; set; }
    }
}
```

### 10.2 Configuration Options

**File:** `src/Infrastructure/RuneAndRust.Infrastructure/Configuration/AchievementOptions.cs`

```csharp
namespace RuneAndRust.Infrastructure.Configuration;

/// <summary>
/// Configuration options for the achievement system.
/// </summary>
public class AchievementOptions
{
    /// <summary>
    /// Gets or sets the path to the achievements configuration file.
    /// </summary>
    public string ConfigurationPath { get; set; } = "config/achievements.json";
}
```

---

## 11. Configuration Schema

### 11.1 JSON Schema

**File:** `config/schemas/achievements.schema.json`

```json
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "achievements.schema.json",
  "title": "Achievement Definitions",
  "description": "Schema for achievement configuration",
  "type": "object",
  "required": ["achievements"],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "Reference to this schema file"
    },
    "achievements": {
      "type": "array",
      "description": "List of achievement definitions",
      "items": {
        "$ref": "#/$defs/achievement"
      }
    }
  },
  "$defs": {
    "achievement": {
      "type": "object",
      "required": ["id", "name", "description", "category", "tier", "conditions"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the achievement",
          "pattern": "^[a-z0-9-]+$"
        },
        "name": {
          "type": "string",
          "description": "Display name of the achievement"
        },
        "description": {
          "type": "string",
          "description": "Description of how to unlock"
        },
        "category": {
          "type": "string",
          "enum": ["Combat", "Exploration", "Progression", "Collection", "Challenge", "Secret"],
          "description": "Achievement category"
        },
        "tier": {
          "type": "string",
          "enum": ["Bronze", "Silver", "Gold", "Platinum"],
          "description": "Achievement tier/difficulty"
        },
        "conditions": {
          "type": "array",
          "description": "Conditions to unlock (all must be met)",
          "items": {
            "$ref": "#/$defs/condition"
          },
          "minItems": 1
        },
        "isSecret": {
          "type": "boolean",
          "default": false,
          "description": "Whether achievement is hidden until unlocked"
        },
        "iconPath": {
          "type": "string",
          "description": "Optional path to achievement icon"
        }
      }
    },
    "condition": {
      "type": "object",
      "required": ["stat", "operator", "value"],
      "properties": {
        "stat": {
          "type": "string",
          "description": "Statistic name to check"
        },
        "operator": {
          "type": "string",
          "enum": [">=", "<=", "=="],
          "description": "Comparison operator"
        },
        "value": {
          "type": "integer",
          "description": "Threshold value"
        }
      }
    }
  }
}
```

---

## 12. Configuration File

### 12.1 Achievements Configuration

**File:** `config/achievements.json`

```json
{
  "$schema": "./schemas/achievements.schema.json",
  "achievements": [
    {
      "id": "first-blood",
      "name": "First Blood",
      "description": "Defeat your first monster",
      "category": "Combat",
      "tier": "Bronze",
      "conditions": [
        { "stat": "monstersKilled", "operator": ">=", "value": 1 }
      ]
    },
    {
      "id": "monster-hunter",
      "name": "Monster Hunter",
      "description": "Defeat 50 monsters",
      "category": "Combat",
      "tier": "Silver",
      "conditions": [
        { "stat": "monstersKilled", "operator": ">=", "value": 50 }
      ]
    },
    {
      "id": "monster-slayer",
      "name": "Monster Slayer",
      "description": "Defeat 100 monsters",
      "category": "Combat",
      "tier": "Silver",
      "conditions": [
        { "stat": "monstersKilled", "operator": ">=", "value": 100 }
      ]
    },
    {
      "id": "boss-killer",
      "name": "Boss Killer",
      "description": "Defeat your first boss",
      "category": "Combat",
      "tier": "Silver",
      "conditions": [
        { "stat": "bossesKilled", "operator": ">=", "value": 1 }
      ]
    },
    {
      "id": "critical-striker",
      "name": "Critical Striker",
      "description": "Land 25 critical hits",
      "category": "Combat",
      "tier": "Silver",
      "conditions": [
        { "stat": "criticalHits", "operator": ">=", "value": 25 }
      ]
    },
    {
      "id": "room-explorer",
      "name": "Room Explorer",
      "description": "Discover 10 rooms",
      "category": "Exploration",
      "tier": "Bronze",
      "conditions": [
        { "stat": "roomsDiscovered", "operator": ">=", "value": 10 }
      ]
    },
    {
      "id": "secret-seeker",
      "name": "Secret Seeker",
      "description": "Find 5 secrets",
      "category": "Exploration",
      "tier": "Silver",
      "conditions": [
        { "stat": "secretsFound", "operator": ">=", "value": 5 }
      ]
    },
    {
      "id": "treasure-hunter",
      "name": "Treasure Hunter",
      "description": "Open 20 chests",
      "category": "Exploration",
      "tier": "Silver",
      "conditions": [
        { "stat": "chestsOpened", "operator": ">=", "value": 20 }
      ]
    },
    {
      "id": "level-up",
      "name": "Level Up!",
      "description": "Reach level 2",
      "category": "Progression",
      "tier": "Bronze",
      "conditions": [
        { "stat": "levelsGained", "operator": ">=", "value": 1 }
      ]
    },
    {
      "id": "veteran-adventurer",
      "name": "Veteran Adventurer",
      "description": "Reach level 10",
      "category": "Progression",
      "tier": "Gold",
      "conditions": [
        { "stat": "levelsGained", "operator": ">=", "value": 9 }
      ]
    },
    {
      "id": "gold-hoarder",
      "name": "Gold Hoarder",
      "description": "Earn 1000 gold total",
      "category": "Collection",
      "tier": "Silver",
      "conditions": [
        { "stat": "goldEarned", "operator": ">=", "value": 1000 }
      ]
    },
    {
      "id": "item-collector",
      "name": "Item Collector",
      "description": "Find 25 items",
      "category": "Collection",
      "tier": "Silver",
      "conditions": [
        { "stat": "itemsFound", "operator": ">=", "value": 25 }
      ]
    },
    {
      "id": "master-crafter",
      "name": "Master Crafter",
      "description": "Craft 10 items",
      "category": "Collection",
      "tier": "Silver",
      "conditions": [
        { "stat": "itemsCrafted", "operator": ">=", "value": 10 }
      ]
    },
    {
      "id": "nat-twenty",
      "name": "Natural Twenty!",
      "description": "Roll your first natural 20",
      "category": "Challenge",
      "tier": "Bronze",
      "conditions": [
        { "stat": "totalNaturalTwenties", "operator": ">=", "value": 1 }
      ]
    },
    {
      "id": "lucky-streak",
      "name": "Lady Luck's Favorite",
      "description": "Roll a natural 20 five times in a row",
      "category": "Challenge",
      "tier": "Platinum",
      "conditions": [
        { "stat": "longestNat20Streak", "operator": ">=", "value": 5 }
      ],
      "isSecret": true
    },
    {
      "id": "flawless",
      "name": "Flawless Victory",
      "description": "Defeat a boss without taking damage",
      "category": "Challenge",
      "tier": "Gold",
      "conditions": [
        { "stat": "flawlessBossKills", "operator": ">=", "value": 1 }
      ],
      "isSecret": true
    },
    {
      "id": "speedrunner",
      "name": "Speedrunner",
      "description": "Complete the game in under 30 minutes",
      "category": "Challenge",
      "tier": "Platinum",
      "conditions": [
        { "stat": "fastestCompletionMinutes", "operator": "<=", "value": 30 }
      ],
      "isSecret": true
    },
    {
      "id": "dedicated-player",
      "name": "Dedicated Player",
      "description": "Play for 10 hours total",
      "category": "Progression",
      "tier": "Gold",
      "conditions": [
        { "stat": "totalPlaytimeMinutes", "operator": ">=", "value": 600 }
      ]
    }
  ]
}
```

---

## 13. Logging Specifications

### 13.1 Log Levels by Component

| Component | Level | Events |
|-----------|-------|--------|
| `AchievementProvider` | Information | Loading achievements, count loaded |
| `AchievementProvider` | Warning | File not found, invalid entries, duplicates |
| `AchievementProvider` | Error | JSON parse failures |
| `AchievementProvider` | Debug | Individual achievement loading |

### 13.2 Log Message Examples

```csharp
// AchievementProvider - Information
_logger.LogInformation("Loading achievements from {FilePath}", filePath);

_logger.LogInformation(
    "Loaded {Count} achievements ({Points} max points)",
    _achievements.Count,
    _achievements.Sum(a => a.Points));

// AchievementProvider - Warning
_logger.LogWarning(
    "Achievements file not found at {FilePath}, using empty list",
    filePath);

_logger.LogWarning("No achievements found in configuration");

_logger.LogWarning(
    "Skipping invalid achievement entry: missing id or name");

_logger.LogWarning(
    "Invalid category '{Category}' for achievement {Id}, defaulting to Combat",
    entry.Category,
    entry.Id);

_logger.LogWarning(
    "Invalid tier '{Tier}' for achievement {Id}, defaulting to Bronze",
    entry.Tier,
    entry.Id);

_logger.LogWarning(
    "Duplicate achievement ID found: {AchievementId}",
    dup);

_logger.LogWarning(
    "Achievement {AchievementId} has no unlock conditions",
    achievement.AchievementId);

// AchievementProvider - Error
_logger.LogError(ex, "Failed to parse achievements configuration");

// AchievementProvider - Debug
_logger.LogDebug(
    "Loaded achievement: {AchievementId} ({Category}, {Tier})",
    definition.AchievementId,
    definition.Category,
    definition.Tier);
```

---

## 14. Unit Testing Requirements

### 14.1 Test Count by Feature

| Feature | Test Count |
|---------|------------|
| AchievementDefinition Entity | 3 |
| AchievementCondition Record | 3 |
| AchievementProvider | 4 |
| Enum Parsing | 2 |
| **Total** | **~12** |

### 14.2 Test Specifications

**File:** `tests/RuneAndRust.Tests/Domain/AchievementDefinitionTests.cs`

```csharp
[TestFixture]
public class AchievementDefinitionTests
{
    [Test]
    public void Create_WithValidData_ReturnsDefinition();

    [Test]
    public void Points_DerivedFromTier_ReturnsCorrectValue();

    [Test]
    public void GetDisplayName_SecretAndLocked_ReturnsHidden();
}
```

**File:** `tests/RuneAndRust.Tests/Application/AchievementConditionTests.cs`

```csharp
[TestFixture]
public class AchievementConditionTests
{
    [Test]
    [TestCase(100, 50, ComparisonOperator.GreaterThanOrEqual, true)]
    [TestCase(50, 100, ComparisonOperator.GreaterThanOrEqual, false)]
    [TestCase(50, 100, ComparisonOperator.LessThanOrEqual, true)]
    [TestCase(100, 100, ComparisonOperator.Equals, true)]
    public void Evaluate_WithOperator_ReturnsExpectedResult(
        long actual, long threshold, ComparisonOperator op, bool expected);

    [Test]
    public void GetProgress_GreaterThanOrEqual_ReturnsProgressPercentage();

    [Test]
    public void GetProgress_Equals_ReturnsBinaryProgress();
}
```

**File:** `tests/RuneAndRust.Tests/Infrastructure/AchievementProviderTests.cs`

```csharp
[TestFixture]
public class AchievementProviderTests
{
    [Test]
    public void GetAllAchievements_LoadsFromJson();

    [Test]
    public void GetAchievementById_ReturnsCorrectAchievement();

    [Test]
    public void GetAchievementsByCategory_FiltersByCategory();

    [Test]
    public void GetMaxPossiblePoints_SumsAllPoints();
}
```

**File:** `tests/RuneAndRust.Tests/Domain/AchievementEnumTests.cs`

```csharp
[TestFixture]
public class AchievementEnumTests
{
    [Test]
    [TestCase(AchievementTier.Bronze, 10)]
    [TestCase(AchievementTier.Silver, 25)]
    [TestCase(AchievementTier.Gold, 50)]
    [TestCase(AchievementTier.Platinum, 100)]
    public void AchievementTier_HasCorrectPointValue(AchievementTier tier, int expected);

    [Test]
    public void AchievementCategory_HasSixValues();
}
```

---

## 15. Use Cases

### UC-001: Load Achievement Definitions

**Actor:** System (AchievementProvider)
**Flow:** Application starts → AchievementProvider.EnsureLoaded() called → Read achievements.json → Parse JSON → Create AchievementDefinition entities → Cache in dictionary → Log count loaded

### UC-002: Get Achievement by ID

**Actor:** System (AchievementService)
**Flow:** Achievement check needed → GetAchievementById(id) called → EnsureLoaded() → Lookup in dictionary → Return definition or null

### UC-003: Get Achievements by Category

**Actor:** System (AchievementsView)
**Flow:** Display achievements screen → GetAchievementsByCategory(Combat) called → Filter cached list → Return filtered list for display

### UC-004: Get Achievements by Tier

**Actor:** System (AchievementsView)
**Flow:** Filter by tier requested → GetAchievementsByTier(Gold) called → Filter cached list → Return achievements of that tier

### UC-005: Evaluate Achievement Condition

**Actor:** System (AchievementService in v0.12.1b)
**Flow:** Check if condition met → Get player statistic value → Call condition.Evaluate(value) → Compare using operator → Return true/false

---

## 16. Deliverable Checklist

### Domain Layer
- [ ] `AchievementCategory` enum created
- [ ] `AchievementTier` enum created
- [ ] `ComparisonOperator` enum created
- [ ] `AchievementDefinition` entity created

### Application Layer
- [ ] `AchievementCondition` record created
- [ ] `IAchievementProvider` interface created

### Infrastructure Layer
- [ ] `AchievementProvider` implementation created
- [ ] `AchievementOptions` configuration class created

### Configuration Files
- [ ] `config/achievements.json` created with sample achievements
- [ ] `config/schemas/achievements.schema.json` created

### Testing
- [ ] ~12 unit tests implemented
- [ ] All tests passing

---

## 17. Acceptance Criteria

### Functional
- [ ] AchievementDefinition entity stores all required properties
- [ ] AchievementDefinition.Points derives correctly from Tier
- [ ] AchievementTier enum values match point values (10, 25, 50, 100)
- [ ] AchievementCategory enum has 6 values
- [ ] ComparisonOperator enum has 3 values
- [ ] AchievementCondition.Evaluate() works for all operators
- [ ] AchievementCondition.GetProgress() calculates progress correctly
- [ ] AchievementProvider loads achievements from JSON
- [ ] AchievementProvider caches loaded definitions
- [ ] AchievementProvider handles missing file gracefully
- [ ] AchievementProvider logs warnings for invalid entries
- [ ] GetAchievementById returns correct achievement
- [ ] GetAchievementsByCategory filters correctly
- [ ] GetAchievementsByTier filters correctly
- [ ] GetMaxPossiblePoints sums all achievement points
- [ ] Secret achievements return hidden name/description when locked

### Quality
- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] All ~12 unit tests pass
- [ ] Configuration files validate against schema
- [ ] XML documentation complete on all public members

---

## 18. Dependencies

### Required from v0.12.0c

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `PlayerStatistics` | Domain/Entities | Statistic names for conditions |
| `DiceRollHistory` | Domain/Entities | Dice statistic names for conditions |

### Required from Prior Versions

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `IEntity` | Domain/Interfaces | Entity base interface |

### Provides to v0.12.1b

| Type | Usage |
|------|-------|
| `AchievementDefinition` | Templates for checking/unlocking |
| `AchievementCondition` | Evaluated against player stats |
| `AchievementCategory` | Organizing achievements in UI |
| `AchievementTier` | Point values for scoring |
| `ComparisonOperator` | Condition evaluation |
| `IAchievementProvider` | Data access for achievement service |

---

## 19. Future Considerations

### Deferred to v0.12.1b
- **PlayerAchievement Entity**: Tracking unlocked achievements per player
- **Achievement Unlock Detection**: Evaluating conditions against statistics
- **Achievement Notifications**: Pop-up UI on unlock
- **AchievementsCommand**: TUI command to view achievements

### Deferred to v0.12.1c
- **Leaderboards**: Score tracking and ranking

### Out of Scope
- **Online Achievements**: Cloud-synced achievements
- **Achievement Rewards**: Items or bonuses for unlocking
- **Progressive Achievements**: Multi-tier achievements (Bronze → Silver → Gold)
- **Time-Limited Achievements**: Achievements available only during events

---

*Document Version: 1.0*
*Last Updated: 2026-01-16*
*Author: Claude*
