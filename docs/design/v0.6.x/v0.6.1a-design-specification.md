# v0.6.1a Design Specification: Health Bars

**Version:** 0.6.1a
**Parent:** v0.6.1 (Visual Components)
**Prerequisites:** v0.6.0c Complete (Color Themes)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [HealthBar Component](#4-healthbar-component)
5. [ResourceBar Component](#5-resourcebar-component)
6. [Color Thresholds](#6-color-thresholds)
7. [Data Model](#7-data-model)
8. [Configuration](#8-configuration)
9. [Logging Specifications](#9-logging-specifications)
10. [Unit Testing Requirements](#10-unit-testing-requirements)
11. [Use Cases](#11-use-cases)
12. [Deliverable Checklist](#12-deliverable-checklist)
13. [Acceptance Criteria](#13-acceptance-criteria)
14. [Dependencies](#14-dependencies)
15. [Future Considerations](#15-future-considerations)

---

## 1. Executive Summary

### Purpose

The Health Bars system implements visual bar components that display HP, MP, and other resources as filled bar graphics. Bars dynamically change color based on percentage thresholds to indicate danger levels (green → yellow → red), providing instant visual feedback about player status.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Components** | HealthBar, ResourceBar |
| **Enums** | BarStyle (4 styles), BarType (5 types) |
| **Configuration** | ui.json (thresholds section) |
| **Tests** | ~8 new unit tests |

### Architectural Significance

This version establishes the **Visual Bar Pattern** that will be used throughout the game:
- Filled/empty bar rendering with Unicode characters
- Color thresholds for danger indication
- Multiple display styles (Standard, Detailed, Compact, Numeric)

---

## 2. Feature Overview

```
v0.6.1a Features
├── HealthBar Component
│   ├── Bar rendering (█░ characters)
│   ├── Color threshold lookup
│   ├── Labeled format
│   └── Width adaptation
├── ResourceBar Component
│   ├── Generic resource display
│   ├── Custom color support
│   └── Named resources (MP, Rage, Energy)
├── Bar Styles
│   ├── Standard: ████████░░░░
│   ├── Detailed: [████████░░░░] 80/100
│   ├── Compact: ████80
│   └── Numeric: 80/100
├── Color Thresholds
│   ├── Health: Green → Yellow → Red → DarkRed
│   ├── Mana: Blue (constant)
│   ├── Experience: Magenta (constant)
│   └── Stamina: Yellow → Orange
└── Configuration
    ├── Threshold percentages
    ├── Bar characters (Unicode/ASCII)
    └── Blink settings
```

---

## 3. Architecture Diagrams

### 3.1 Health Bar Architecture

```
┌─────────────────────────────────────────────────────────────────────┐
│                    HEALTH BAR ARCHITECTURE                           │
└─────────────────────────────────────────────────────────────────────┘

    DOMAIN                       PRESENTATION                  OUTPUT
    ──────                       ────────────                  ──────

    ┌─────────────┐            ┌──────────────────────┐    ┌───────────────┐
    │   Player    │            │      HealthBar       │───▶│ Sidebar Panel │
    ├─────────────┤            ├──────────────────────┤    └───────────────┘
    │ Health      │◀───────────│ Render()             │
    │ MaxHealth   │            │ GetThresholdColor()  │
    └─────────────┘            │ RenderLabeled()      │
                               └──────────────────────┘
    ┌─────────────┐                     │
    │ ResourcePool│                     │ uses
    ├─────────────┤                     ▼
    │ Current     │            ┌──────────────────────┐
    │ Max         │◀───────────│    ResourceBar       │
    │ Definition  │            ├──────────────────────┤
    └─────────────┘            │ Render()             │
                               │ RenderForType()      │
                               └──────────────────────┘
                                        │
                                        │ uses
                                        ▼
                               ┌──────────────────────┐
                               │  IColorThemeService  │
                               │  (v0.6.0c)           │
                               └──────────────────────┘
```

### 3.2 Bar Rendering Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                      BAR RENDERING FLOW                              │
└─────────────────────────────────────────────────────────────────────┘

    Render(current=80, max=100, width=20)
                    │
                    ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ 1. CALCULATE PERCENTAGE                                        │
    ├───────────────────────────────────────────────────────────────┤
    │ percentage = current / max = 80 / 100 = 0.80 (80%)             │
    └───────────────────────────────────────────────────────────────┘
                    │
                    ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ 2. CALCULATE FILLED WIDTH                                      │
    ├───────────────────────────────────────────────────────────────┤
    │ filledWidth = (int)(percentage * width) = (int)(0.80 * 20) = 16│
    │ emptyWidth = width - filledWidth = 20 - 16 = 4                 │
    └───────────────────────────────────────────────────────────────┘
                    │
                    ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ 3. DETERMINE COLOR                                             │
    ├───────────────────────────────────────────────────────────────┤
    │ 80% > 75% threshold → Color = Green                            │
    └───────────────────────────────────────────────────────────────┘
                    │
                    ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ 4. BUILD BAR STRING                                            │
    ├───────────────────────────────────────────────────────────────┤
    │ filled = new string('█', 16) → ████████████████               │
    │ empty = new string('░', 4)   → ░░░░                            │
    │ result = filled + empty       → ████████████████░░░░           │
    └───────────────────────────────────────────────────────────────┘
                    │
                    ▼
    Output: ████████████████░░░░ (Green)
```

### 3.3 Color Threshold Resolution

```
┌─────────────────────────────────────────────────────────────────────┐
│                   COLOR THRESHOLD RESOLUTION                         │
└─────────────────────────────────────────────────────────────────────┘

    GetThresholdColor(current=25, max=100, BarType.Health)
                    │
                    ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ Calculate percentage: 25%                                      │
    └───────────────────────────────────────────────────────────────┘
                    │
                    ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ Lookup thresholds for BarType.Health:                          │
    │                                                                │
    │   [{ percent: 75, color: Green   }]   ← 25% < 75% ✗           │
    │   [{ percent: 50, color: Yellow  }]   ← 25% < 50% ✗           │
    │   [{ percent: 25, color: Red     }]   ← 25% ≤ 25% ✓ MATCH     │
    │   [{ percent: 10, color: DarkRed }]   ← (would match if <10%) │
    └───────────────────────────────────────────────────────────────┘
                    │
                    ▼
    Return: ConsoleColor.Red
```

---

## 4. HealthBar Component

### 4.1 HealthBar Class

**File:** `src/Presentation/RuneAndRust.TUI/UI/HealthBar.cs`

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Renders visual health and resource bars.
/// </summary>
public class HealthBar
{
    private readonly IColorThemeService _colorService;
    private readonly ITerminalService _terminal;
    private readonly HealthBarConfig _config;
    private readonly ILogger<HealthBar> _logger;
    
    // Default bar characters
    private const char DefaultFilledChar = '█';
    private const char DefaultEmptyChar = '░';
    private const char FallbackFilledChar = '#';
    private const char FallbackEmptyChar = '-';
    
    public HealthBar(
        IColorThemeService colorService,
        ITerminalService terminal,
        IGameConfigurationProvider configProvider,
        ILogger<HealthBar> logger)
    {
        _colorService = colorService;
        _terminal = terminal;
        _config = configProvider.GetHealthBarConfiguration();
        _logger = logger;
    }
    
    /// <summary>
    /// Renders a bar to a string.
    /// </summary>
    /// <param name="current">Current value.</param>
    /// <param name="max">Maximum value.</param>
    /// <param name="width">Bar width in characters.</param>
    /// <param name="style">Display style.</param>
    /// <returns>Rendered bar string.</returns>
    public string Render(int current, int max, int width, BarStyle style = BarStyle.Standard)
    {
        ArgumentOutOfRangeException.ThrowIfNegative(current);
        ArgumentOutOfRangeException.ThrowIfLessThan(max, 1);
        ArgumentOutOfRangeException.ThrowIfLessThan(width, 3);
        
        current = Math.Min(current, max);
        var percentage = (double)current / max;
        
        return style switch
        {
            BarStyle.Standard => RenderStandard(percentage, width),
            BarStyle.Detailed => RenderDetailed(percentage, width, current, max),
            BarStyle.Compact => RenderCompact(percentage, width, current),
            BarStyle.Numeric => $"{current}/{max}",
            _ => RenderStandard(percentage, width)
        };
    }
    
    /// <summary>
    /// Gets the color based on percentage and bar type.
    /// </summary>
    /// <param name="current">Current value.</param>
    /// <param name="max">Maximum value.</param>
    /// <param name="type">Bar type for threshold lookup.</param>
    /// <returns>ConsoleColor for the bar.</returns>
    public ConsoleColor GetThresholdColor(int current, int max, BarType type)
    {
        if (max <= 0) return ConsoleColor.Gray;
        
        var percentage = (int)((double)current / max * 100);
        var thresholds = _config.GetThresholds(type);
        
        foreach (var threshold in thresholds.OrderByDescending(t => t.Percent))
        {
            if (percentage <= threshold.Percent)
            {
                return threshold.Color;
            }
        }
        
        // Default to first threshold color (highest percentage)
        return thresholds.FirstOrDefault()?.Color ?? ConsoleColor.Gray;
    }
    
    /// <summary>
    /// Renders a labeled health bar.
    /// </summary>
    /// <param name="label">Label text (e.g., "HP").</param>
    /// <param name="current">Current value.</param>
    /// <param name="max">Maximum value.</param>
    /// <param name="totalWidth">Total width including label.</param>
    /// <returns>Formatted bar with label.</returns>
    public string RenderLabeled(string label, int current, int max, int totalWidth)
    {
        var labelPart = $"{label}: ";
        var valuePart = $" {current}/{max}";
        var barWidth = totalWidth - labelPart.Length - valuePart.Length;
        
        if (barWidth < 5)
        {
            // Not enough room for bar, show numeric only
            return $"{label}: {current}/{max}";
        }
        
        var bar = Render(current, max, barWidth, BarStyle.Standard);
        return $"{labelPart}{bar}{valuePart}";
    }
    
    /// <summary>
    /// Renders a colored health bar to the terminal.
    /// </summary>
    /// <param name="x">X position.</param>
    /// <param name="y">Y position.</param>
    /// <param name="current">Current value.</param>
    /// <param name="max">Maximum value.</param>
    /// <param name="width">Bar width.</param>
    /// <param name="type">Bar type for color.</param>
    public void RenderColored(int x, int y, int current, int max, int width, BarType type)
    {
        var bar = Render(current, max, width, BarStyle.Standard);
        var color = GetThresholdColor(current, max, type);
        
        _terminal.SetCursorPosition(x, y);
        
        var previousColor = Console.ForegroundColor;
        try
        {
            Console.ForegroundColor = color;
            _terminal.Write(bar);
        }
        finally
        {
            Console.ForegroundColor = previousColor;
        }
    }
    
    private string RenderStandard(double percentage, int width)
    {
        var filledWidth = (int)(percentage * width);
        var emptyWidth = width - filledWidth;
        
        var filled = GetFilledChar();
        var empty = GetEmptyChar();
        
        return new string(filled, filledWidth) + new string(empty, emptyWidth);
    }
    
    private string RenderDetailed(double percentage, int width, int current, int max)
    {
        var innerWidth = width - 2; // Account for brackets
        var bar = RenderStandard(percentage, innerWidth);
        return $"[{bar}] {current}/{max}";
    }
    
    private string RenderCompact(double percentage, int width, int current)
    {
        var valueStr = current.ToString();
        var barWidth = width - valueStr.Length;
        var bar = RenderStandard(percentage, Math.Max(3, barWidth));
        return $"{bar}{valueStr}";
    }
    
    private char GetFilledChar()
    {
        return _terminal.SupportsUnicode 
            ? _config.Characters.Filled 
            : _config.Characters.FilledFallback;
    }
    
    private char GetEmptyChar()
    {
        return _terminal.SupportsUnicode 
            ? _config.Characters.Empty 
            : _config.Characters.EmptyFallback;
    }
}
```

### 4.2 BarStyle Enum

**File:** `src/Presentation/RuneAndRust.TUI/UI/BarStyle.cs`

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Defines display styles for health/resource bars.
/// </summary>
public enum BarStyle
{
    /// <summary>
    /// Simple bar only: ████████░░░░
    /// </summary>
    Standard,
    
    /// <summary>
    /// Bar with brackets and value: [████████░░░░] 80/100
    /// </summary>
    Detailed,
    
    /// <summary>
    /// Short bar with value appended: ████80
    /// </summary>
    Compact,
    
    /// <summary>
    /// Value only, no bar: 80/100
    /// </summary>
    Numeric
}
```

### 4.3 BarType Enum

**File:** `src/Presentation/RuneAndRust.TUI/UI/BarType.cs`

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Defines bar types for color threshold lookup.
/// </summary>
public enum BarType
{
    /// <summary>
    /// Health bar: Green → Yellow → Red → DarkRed
    /// </summary>
    Health,
    
    /// <summary>
    /// Mana bar: Always blue.
    /// </summary>
    Mana,
    
    /// <summary>
    /// Experience bar: Always magenta/purple.
    /// </summary>
    Experience,
    
    /// <summary>
    /// Stamina bar: Yellow → Orange.
    /// </summary>
    Stamina,
    
    /// <summary>
    /// Custom bar type with user-defined colors.
    /// </summary>
    Custom
}
```

---

## 5. ResourceBar Component

### 5.1 ResourceBar Class

**File:** `src/Presentation/RuneAndRust.TUI/UI/ResourceBar.cs`

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Renders bars for various resource types with appropriate colors.
/// </summary>
public class ResourceBar
{
    private readonly HealthBar _healthBar;
    private readonly IColorThemeService _colorService;
    private readonly ILogger<ResourceBar> _logger;
    
    private static readonly Dictionary<string, BarType> ResourceTypeMap = new(StringComparer.OrdinalIgnoreCase)
    {
        ["health"] = BarType.Health,
        ["hp"] = BarType.Health,
        ["mana"] = BarType.Mana,
        ["mp"] = BarType.Mana,
        ["experience"] = BarType.Experience,
        ["xp"] = BarType.Experience,
        ["stamina"] = BarType.Stamina,
        ["energy"] = BarType.Stamina,
        ["rage"] = BarType.Custom,
        ["focus"] = BarType.Custom
    };
    
    private static readonly Dictionary<string, ConsoleColor> CustomResourceColors = new(StringComparer.OrdinalIgnoreCase)
    {
        ["rage"] = ConsoleColor.DarkRed,
        ["focus"] = ConsoleColor.Cyan
    };
    
    public ResourceBar(
        HealthBar healthBar,
        IColorThemeService colorService,
        ILogger<ResourceBar> logger)
    {
        _healthBar = healthBar;
        _colorService = colorService;
        _logger = logger;
    }
    
    /// <summary>
    /// Renders a resource bar for a named resource type.
    /// </summary>
    /// <param name="resourceName">Resource name (e.g., "Mana", "Rage").</param>
    /// <param name="current">Current value.</param>
    /// <param name="max">Maximum value.</param>
    /// <param name="width">Bar width.</param>
    /// <param name="style">Display style.</param>
    /// <returns>Rendered bar string.</returns>
    public string Render(string resourceName, int current, int max, int width, BarStyle style = BarStyle.Standard)
    {
        return _healthBar.Render(current, max, width, style);
    }
    
    /// <summary>
    /// Gets the color for a named resource type.
    /// </summary>
    /// <param name="resourceName">Resource name.</param>
    /// <param name="current">Current value.</param>
    /// <param name="max">Maximum value.</param>
    /// <returns>ConsoleColor for the resource.</returns>
    public ConsoleColor GetColor(string resourceName, int current, int max)
    {
        if (ResourceTypeMap.TryGetValue(resourceName, out var barType))
        {
            if (barType == BarType.Custom && CustomResourceColors.TryGetValue(resourceName, out var customColor))
            {
                return customColor;
            }
            return _healthBar.GetThresholdColor(current, max, barType);
        }
        
        _logger.LogDebug("Unknown resource type '{Resource}', using default color", resourceName);
        return ConsoleColor.Gray;
    }
    
    /// <summary>
    /// Renders a labeled resource bar.
    /// </summary>
    /// <param name="label">Short label (e.g., "MP").</param>
    /// <param name="resourceName">Resource name for color lookup.</param>
    /// <param name="current">Current value.</param>
    /// <param name="max">Maximum value.</param>
    /// <param name="totalWidth">Total width including label.</param>
    /// <returns>Formatted bar with label.</returns>
    public string RenderLabeled(string label, string resourceName, int current, int max, int totalWidth)
    {
        return _healthBar.RenderLabeled(label, current, max, totalWidth);
    }
}
```

---

## 6. Color Thresholds

### 6.1 ColorThreshold Record

**File:** `src/Presentation/RuneAndRust.TUI/Configuration/ColorThreshold.cs`

```csharp
namespace RuneAndRust.Presentation.Configuration;

/// <summary>
/// Represents a color threshold for a bar type.
/// </summary>
/// <param name="Percent">Percentage at or below which this color applies.</param>
/// <param name="Color">ConsoleColor for this threshold.</param>
public record ColorThreshold(int Percent, ConsoleColor Color);
```

### 6.2 HealthBarConfig Record

**File:** `src/Presentation/RuneAndRust.TUI/Configuration/HealthBarConfig.cs`

```csharp
namespace RuneAndRust.Presentation.Configuration;

/// <summary>
/// Configuration for health bar rendering.
/// </summary>
public record HealthBarConfig(
    Dictionary<BarType, List<ColorThreshold>> Thresholds,
    BarCharacters Characters,
    bool EnableBlinking,
    int BlinkThreshold)
{
    /// <summary>
    /// Gets thresholds for a bar type.
    /// </summary>
    public IReadOnlyList<ColorThreshold> GetThresholds(BarType type)
    {
        return Thresholds.TryGetValue(type, out var list) 
            ? list 
            : new List<ColorThreshold> { new(100, ConsoleColor.Gray) };
    }
}

/// <summary>
/// Characters used for bar rendering.
/// </summary>
/// <param name="Filled">Filled portion character (Unicode).</param>
/// <param name="Empty">Empty portion character (Unicode).</param>
/// <param name="FilledFallback">Filled portion fallback (ASCII).</param>
/// <param name="EmptyFallback">Empty portion fallback (ASCII).</param>
public record BarCharacters(
    char Filled = '█',
    char Empty = '░',
    char FilledFallback = '#',
    char EmptyFallback = '-');
```

### 6.3 Default Thresholds

| Bar Type | Percentage | Color | Meaning |
|----------|------------|-------|---------|
| **Health** | >75% | Green | Healthy |
| **Health** | >50% | Yellow | Caution |
| **Health** | >25% | Red | Danger |
| **Health** | ≤25% | DarkRed | Critical |
| **Mana** | Any | Blue | Constant |
| **Experience** | Any | Magenta | Constant |
| **Stamina** | >50% | Yellow | Good |
| **Stamina** | ≤50% | DarkYellow | Low |

---

## 7. Data Model

### 7.1 New Classes

| Class | Layer | Description |
|-------|-------|-------------|
| `HealthBar` | Presentation | HP/resource bar component |
| `ResourceBar` | Presentation | Generic resource bar wrapper |

### 7.2 New Enums

| Enum | Layer | Description |
|------|-------|-------------|
| `BarStyle` | Presentation | Bar display styles (4 values) |
| `BarType` | Presentation | Bar categories for color (5 values) |

### 7.3 New Records

| Record | Layer | Description |
|--------|-------|-------------|
| `ColorThreshold` | Presentation | Threshold percentage + color |
| `HealthBarConfig` | Presentation | Bar configuration |
| `BarCharacters` | Presentation | Unicode/ASCII bar chars |

---

## 8. Configuration

### 8.1 ui.json (healthBars section)

**File:** `config/ui.json`

```json
{
  "$schema": "./schemas/ui.schema.json",
  "healthBars": {
    "thresholds": {
      "health": [
        { "percent": 100, "color": "Green" },
        { "percent": 75, "color": "Green" },
        { "percent": 50, "color": "Yellow" },
        { "percent": 25, "color": "Red" },
        { "percent": 10, "color": "DarkRed" }
      ],
      "mana": [
        { "percent": 100, "color": "Blue" }
      ],
      "experience": [
        { "percent": 100, "color": "Magenta" }
      ],
      "stamina": [
        { "percent": 100, "color": "Yellow" },
        { "percent": 50, "color": "DarkYellow" }
      ]
    },
    "characters": {
      "filled": "█",
      "empty": "░",
      "filledFallback": "#",
      "emptyFallback": "-"
    },
    "enableBlinking": true,
    "blinkThreshold": 10
  }
}
```

### 8.2 Configuration Schema

| Property | Type | Default | Description |
|----------|------|---------|-------------|
| `thresholds.health` | array | (see above) | Health bar color thresholds |
| `thresholds.mana` | array | Blue | Mana bar color (constant) |
| `thresholds.experience` | array | Magenta | XP bar color (constant) |
| `thresholds.stamina` | array | (see above) | Stamina bar thresholds |
| `characters.filled` | char | █ | Unicode filled character |
| `characters.empty` | char | ░ | Unicode empty character |
| `characters.filledFallback` | char | # | ASCII filled character |
| `characters.emptyFallback` | char | - | ASCII empty character |
| `enableBlinking` | bool | true | Enable critical HP blink |
| `blinkThreshold` | int | 10 | % below which to blink |

---

## 9. Logging Specifications

### 9.1 Log Levels by Component

| Component | Level | Events |
|-----------|-------|--------|
| `HealthBar` | Debug | Threshold resolution |
| `ResourceBar` | Debug | Unknown resource type |

### 9.2 Log Message Templates

```csharp
// HealthBar
_logger.LogDebug("Threshold color for {Type} at {Percent}%: {Color}", 
    type, percentage, color);

// ResourceBar
_logger.LogDebug("Unknown resource type '{Resource}', using default color", 
    resourceName);
```

---

## 10. Unit Testing Requirements

### 10.1 Test Count by Feature

| Feature | Test Count |
|---------|------------|
| HealthBar rendering | 4 |
| Color thresholds | 2 |
| ResourceBar | 2 |
| **Total** | **~8** |

### 10.2 Test Specifications

#### HealthBarTests.cs

```csharp
[TestFixture]
public class HealthBarTests
{
    [Test]
    public void Render_AtFullHealth_ReturnsAllFilledCharacters();
    
    [Test]
    public void Render_AtHalfHealth_ReturnsHalfFilledHalfEmpty();
    
    [Test]
    public void Render_AtZeroHealth_ReturnsAllEmptyCharacters();
    
    [Test]
    public void RenderLabeled_WithLabel_IncludesLabelAndValue();
    
    [Test]
    public void GetThresholdColor_AtHighHealth_ReturnsGreen();
    
    [Test]
    public void GetThresholdColor_AtLowHealth_ReturnsRed();
}
```

#### ResourceBarTests.cs

```csharp
[TestFixture]
public class ResourceBarTests
{
    [Test]
    public void GetColor_ForMana_ReturnsBlue();
    
    [Test]
    public void GetColor_ForUnknownResource_ReturnsGray();
}
```

---

## 11. Use Cases

### UC-001: Display Health in Sidebar
**Actor:** UI System
**Flow:** Get player health → HealthBar.Render() → Apply color → Display in sidebar panel

### UC-002: Show Danger Warning
**Actor:** UI System
**Flow:** Player HP drops to 20% → GetThresholdColor() → Returns Red → Bar displays red

### UC-003: Display Mana Bar
**Actor:** UI System
**Flow:** Get player mana pool → ResourceBar.Render("Mana") → Blue bar displayed

### UC-004: Handle Non-Unicode Terminal
**Actor:** System
**Flow:** Terminal.SupportsUnicode=false → Use fallback chars (# and -) → ASCII bar displayed

---

## 12. Deliverable Checklist

### HealthBar Component
- [ ] `HealthBar` class created
- [ ] Render() method for all 4 styles implemented
- [ ] GetThresholdColor() implemented
- [ ] RenderLabeled() implemented
- [ ] RenderColored() implemented
- [ ] Unicode/ASCII fallback implemented

### ResourceBar Component
- [ ] `ResourceBar` class created
- [ ] Render() delegates to HealthBar
- [ ] GetColor() with resource name lookup
- [ ] RenderLabeled() implemented
- [ ] Custom resource colors (Rage, Focus)

### Enums
- [ ] `BarStyle` enum created (4 values)
- [ ] `BarType` enum created (5 values)

### Configuration
- [ ] `ColorThreshold` record created
- [ ] `HealthBarConfig` record created
- [ ] `BarCharacters` record created
- [ ] `ui.json` healthBars section added

### Testing
- [ ] ~8 unit tests implemented
- [ ] All tests passing

---

## 13. Acceptance Criteria

### Functional
- [ ] Health bar renders filled/empty portions correctly
- [ ] Bar color changes based on percentage thresholds
- [ ] Green shown at >75%, Yellow at >50%, Red at >25%
- [ ] Critical health (≤10%) shows DarkRed
- [ ] Mana bar always renders in Blue
- [ ] XP bar always renders in Magenta
- [ ] Standard style: ████████░░░░
- [ ] Detailed style: [████████░░░░] 80/100
- [ ] Compact style: ████80
- [ ] Numeric style: 80/100
- [ ] Fallback characters (# and -) for non-Unicode terminals
- [ ] Labeled bars include label and value text

### Quality
- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] All ~8 unit tests pass
- [ ] XML documentation complete on all public members

---

## 14. Dependencies

### Required from v0.6.0a

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `ITerminalService` | `Application/Interfaces/ITerminalService.cs` | SupportsUnicode check |
| `ScreenLayout` | `Presentation/UI/ScreenLayout.cs` | Sidebar panel rendering |

### Required from v0.6.0c

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `IColorThemeService` | `Application/Interfaces/IColorThemeService.cs` | Color output (optional integration) |

### Provides to v0.6.0b (already complete)

| Type | Usage |
|------|-------|
| `HealthBar` | StatusBar could use visual bars instead of numeric |

### Provides to v0.6.1b/c/d

| Type | Usage |
|------|-------|
| `HealthBar` | Pattern for other visual components |
| `BarStyle` | May be reused for other progress indicators |

---

## 15. Future Considerations

### Deferred to v0.6.1b
- **Room Art**: ASCII room representations (next part)

### Deferred to Future
- **Animated Bars**: Smooth fill/drain animations (v0.7.x GUI)
- **Stacked Bars**: Multiple segments (temp HP + HP)
- **Bar Tooltips**: Hover details in GUI

### Out of Scope
- **Graphical Bars**: Pixel-based rendering (GUI only)
- **Custom User Colors**: User-defined threshold colors

---

## Display Examples

### Sidebar Health Display

```
┌───────────────────────────┐
│       STATUS              │
├───────────────────────────┤
│ HP: ████████████████░░░░  │  [Green - 80%]
│     80/100                │
│                           │
│ MP: ██████████░░░░░░░░░░  │  [Blue - 50%]
│     50/100                │
│                           │
│ XP: ████░░░░░░░░░░░░░░░░  │  [Magenta - 20%]
│     200/1000              │
└───────────────────────────┘
```

### Health States

```
FULL HEALTH:
  HP: ████████████████████ 100/100  [Green]

SLIGHT DAMAGE:
  HP: ████████████████░░░░  80/100  [Green]

MODERATE DAMAGE:
  HP: ██████████░░░░░░░░░░  50/100  [Yellow]

HEAVY DAMAGE:
  HP: █████░░░░░░░░░░░░░░░  25/100  [Red]

CRITICAL:
  HP: ██░░░░░░░░░░░░░░░░░░  10/100  [DarkRed]
```

---

*Document Version: 1.0*
*Last Updated: 2026-01-10*
*Author: Assistant*
