# v0.7.0 Application Shell - Scope Breakdown

**Version:** 0.7.0
**Theme:** Application Shell
**Prerequisites:** v0.6.3b Complete (TUI Enhancements - Tab Completion)
**Total Estimated Tests:** ~20 new tests

---

## Executive Summary

The Application Shell sub-version establishes the Avalonia UI foundation for the game. This includes setting up the Avalonia project, creating the main menu window with game options, implementing the game window layout with panel regions, and building navigation services to move between windows. This phase creates the shell that all subsequent GUI panels integrate into.

Key focus areas:
- **Avalonia Setup**: Project structure and configuration
- **Main Menu**: Title screen with game options
- **Game Window**: Panel-based layout container
- **Navigation**: Window and state management

The work is divided into **three sub-parts**:

| Part | Name | Focus | Est. Tests |
|------|------|-------|------------|
| v0.7.0a | Avalonia Project Setup | Project structure, configuration, base styles | ~5 |
| v0.7.0b | Main Menu Window | Menu options, new/load game, settings | ~8 |
| v0.7.0c | Game Window Layout | Panel regions, navigation, window management | ~7 |

---

## Existing Infrastructure

### Already Implemented (from v0.6.x)

| Feature | Location | Notes |
|---------|----------|-------|
| ColorThemeService | `Application/Services/ColorThemeService.cs` | Theme configuration |
| CommandHistoryService | `Application/Services/CommandHistoryService.cs` | Input history |
| TabCompletionService | `Application/Services/TabCompletionService.cs` | Auto-complete |
| GameSessionService | `Application/Services/GameSessionService.cs` | Game state |
| SaveLoadService | `Application/Services/SaveLoadService.cs` | Persistence |

### Already Implemented (from prior versions)

| Feature | Location | Notes |
|---------|----------|-------|
| Player | `Domain/Entities/Player.cs` | Player entity |
| GameWorld | `Domain/Entities/GameWorld.cs` | World state |
| Configuration loading | `Infrastructure/Configuration/` | JSON config |

### Needs Implementation (v0.7.0)

| Feature | Part | Notes |
|---------|------|-------|
| Avalonia project | v0.7.0a | .csproj, Program.cs |
| App.axaml | v0.7.0a | Application resources |
| Base styles | v0.7.0a | Theme resources |
| MainMenuWindow | v0.7.0b | Main menu view |
| MainMenuViewModel | v0.7.0b | Menu logic |
| GameWindow | v0.7.0c | Game container |
| GameWindowViewModel | v0.7.0c | Game logic |
| INavigationService | v0.7.0c | Window navigation |
| WindowLayoutService | v0.7.0c | Panel management |

---

## Feature Analysis & Categorization

### Project Setup Features

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| Avalonia project creation | Medium | NuGet packages | **v0.7.0a** |
| Application entry point | Low | Avalonia | **v0.7.0a** |
| Base theme/styles | Medium | Avalonia styling | **v0.7.0a** |
| Resource dictionaries | Low | XAML | **v0.7.0a** |

### Main Menu Features

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| Main menu window | Medium | Avalonia | **v0.7.0b** |
| New game button | Low | Navigation | **v0.7.0b** |
| Load game button | Medium | SaveLoadService | **v0.7.0b** |
| Settings window | Medium | Configuration | **v0.7.0b** |
| Quit button | Low | Application | **v0.7.0b** |

### Game Window Features

| Feature | Complexity | Dependencies | Assigned Part |
|---------|------------|--------------|---------------|
| Game window layout | High | Avalonia layouts | **v0.7.0c** |
| Panel regions | Medium | DockPanel/Grid | **v0.7.0c** |
| Navigation service | Medium | Window management | **v0.7.0c** |
| Window state | Low | Avalonia | **v0.7.0c** |

---

## Part Definitions

---

## v0.7.0a: Avalonia Project Setup

[v0.7.0a Design Specification](v0.7.0a-design-specification.md)

### Overview

Create the Avalonia UI project infrastructure including project file configuration, application entry point, base styles/themes, and resource dictionaries. This establishes the foundation that all GUI components build upon.

### Scope

**In Scope:**
- Avalonia project file (`.csproj`)
- `Program.cs` application entry point
- `App.axaml` and `App.axaml.cs` application class
- Avalonia package references
- Base theme resources (`Themes/BaseTheme.axaml`)
- Color palette resource dictionary
- Typography resource dictionary
- Common control styles
- Design-time preview support
- Cross-platform configuration

**Out of Scope:**
- Main menu window (v0.7.0b)
- Game window (v0.7.0c)
- Panel controls (v0.7.1+)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Project Files | 2 | `.csproj`, `Program.cs` |
| Application Files | 2 | `App.axaml`, `App.axaml.cs` |
| Resource Dictionaries | 3 | Theme, colors, typography |
| Unit Tests | ~5 | Application lifecycle tests |

### Project Structure

```
src/Presentation/RuneAndRust.Avalonia/
â”œâ”€â”€ RuneAndRust.Avalonia.csproj
â”œâ”€â”€ Program.cs
â”œâ”€â”€ App.axaml
â”œâ”€â”€ App.axaml.cs
â”œâ”€â”€ Assets/
â”‚   â”œâ”€â”€ Fonts/
â”‚   â”‚   â””â”€â”€ (game fonts)
â”‚   â””â”€â”€ Images/
â”‚       â””â”€â”€ logo.png
â”œâ”€â”€ Themes/
â”‚   â”œâ”€â”€ BaseTheme.axaml
â”‚   â”œâ”€â”€ Colors.axaml
â”‚   â””â”€â”€ Typography.axaml
â”œâ”€â”€ Styles/
â”‚   â”œâ”€â”€ ButtonStyles.axaml
â”‚   â”œâ”€â”€ TextBlockStyles.axaml
â”‚   â””â”€â”€ PanelStyles.axaml
â”œâ”€â”€ Views/
â”‚   â””â”€â”€ (windows and controls)
â”œâ”€â”€ ViewModels/
â”‚   â””â”€â”€ (view models)
â””â”€â”€ Services/
    â””â”€â”€ (GUI-specific services)
```

### Project File Configuration

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <OutputType>WinExe</OutputType>
    <TargetFramework>net8.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <BuiltInComInteropSupport>true</BuiltInComInteropSupport>
    <ApplicationManifest>app.manifest</ApplicationManifest>
    <AvaloniaUseCompiledBindingsByDefault>true</AvaloniaUseCompiledBindingsByDefault>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Avalonia" Version="11.*" />
    <PackageReference Include="Avalonia.Desktop" Version="11.*" />
    <PackageReference Include="Avalonia.Themes.Fluent" Version="11.*" />
    <PackageReference Include="Avalonia.Fonts.Inter" Version="11.*" />
    <PackageReference Include="CommunityToolkit.Mvvm" Version="8.*" />
    <PackageReference Include="Microsoft.Extensions.DependencyInjection" Version="8.*" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\..\Core\RuneAndRust.Application\RuneAndRust.Application.csproj" />
    <ProjectReference Include="..\..\Infrastructure\RuneAndRust.Infrastructure\RuneAndRust.Infrastructure.csproj" />
  </ItemGroup>
</Project>
```

### Application Entry Point

```csharp
namespace RuneAndRust.Avalonia;

public class Program
{
    [STAThread]
    public static void Main(string[] args) => BuildAvaloniaApp()
        .StartWithClassicDesktopLifetime(args);

    public static AppBuilder BuildAvaloniaApp()
        => AppBuilder.Configure<App>()
            .UsePlatformDetect()
            .WithInterFont()
            .LogToTrace();
}
```

### App.axaml Application Resources

```xml
<Application xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="RuneAndRust.Avalonia.App"
             RequestedThemeVariant="Dark">
    
    <Application.Styles>
        <FluentTheme />
        <StyleInclude Source="avares://RuneAndRust.Avalonia/Themes/BaseTheme.axaml" />
        <StyleInclude Source="avares://RuneAndRust.Avalonia/Styles/ButtonStyles.axaml" />
        <StyleInclude Source="avares://RuneAndRust.Avalonia/Styles/TextBlockStyles.axaml" />
        <StyleInclude Source="avares://RuneAndRust.Avalonia/Styles/PanelStyles.axaml" />
    </Application.Styles>
    
    <Application.Resources>
        <ResourceInclude Source="avares://RuneAndRust.Avalonia/Themes/Colors.axaml" />
        <ResourceInclude Source="avares://RuneAndRust.Avalonia/Themes/Typography.axaml" />
    </Application.Resources>
</Application>
```

### Color Palette Resources

```xml
<!-- Themes/Colors.axaml -->
<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    
    <!-- Primary Colors -->
    <Color x:Key="PrimaryColor">#8B4513</Color>        <!-- Saddle Brown -->
    <Color x:Key="PrimaryLightColor">#A0522D</Color>   <!-- Sienna -->
    <Color x:Key="PrimaryDarkColor">#654321</Color>    <!-- Dark Brown -->
    
    <!-- Accent Colors -->
    <Color x:Key="AccentColor">#DAA520</Color>         <!-- Goldenrod -->
    <Color x:Key="AccentLightColor">#FFD700</Color>    <!-- Gold -->
    
    <!-- Background Colors -->
    <Color x:Key="BackgroundColor">#1E1E1E</Color>     <!-- Dark Gray -->
    <Color x:Key="SurfaceColor">#2D2D2D</Color>        <!-- Lighter Gray -->
    <Color x:Key="PanelColor">#252525</Color>          <!-- Panel Background -->
    
    <!-- Text Colors -->
    <Color x:Key="TextPrimaryColor">#E0E0E0</Color>    <!-- Light Gray -->
    <Color x:Key="TextSecondaryColor">#A0A0A0</Color>  <!-- Medium Gray -->
    <Color x:Key="TextMutedColor">#707070</Color>      <!-- Dark Gray -->
    
    <!-- Status Colors -->
    <Color x:Key="HealthColor">#228B22</Color>         <!-- Forest Green -->
    <Color x:Key="HealthLowColor">#FF4500</Color>      <!-- Orange Red -->
    <Color x:Key="HealthCriticalColor">#8B0000</Color> <!-- Dark Red -->
    <Color x:Key="ManaColor">#4169E1</Color>           <!-- Royal Blue -->
    <Color x:Key="XPColor">#9932CC</Color>             <!-- Dark Orchid -->
    
    <!-- Combat Colors -->
    <Color x:Key="HitColor">#FF0000</Color>            <!-- Red -->
    <Color x:Key="MissColor">#808080</Color>           <!-- Gray -->
    <Color x:Key="HealColor">#00FF00</Color>           <!-- Lime -->
    <Color x:Key="CriticalColor">#FF00FF</Color>       <!-- Magenta -->
    
    <!-- Brushes -->
    <SolidColorBrush x:Key="PrimaryBrush" Color="{StaticResource PrimaryColor}" />
    <SolidColorBrush x:Key="AccentBrush" Color="{StaticResource AccentColor}" />
    <SolidColorBrush x:Key="BackgroundBrush" Color="{StaticResource BackgroundColor}" />
    <SolidColorBrush x:Key="PanelBrush" Color="{StaticResource PanelColor}" />
    <SolidColorBrush x:Key="TextPrimaryBrush" Color="{StaticResource TextPrimaryColor}" />
    
</ResourceDictionary>
```

### Acceptance Criteria

- [ ] Avalonia project compiles successfully
- [ ] Application launches without errors
- [ ] FluentTheme applies dark variant
- [ ] Custom color resources load
- [ ] Custom styles apply to controls
- [ ] Design-time preview works
- [ ] Cross-platform builds work (Windows, macOS, Linux)
- [ ] ~5 unit tests pass

---

## v0.7.0b: Main Menu Window

[v0.7.0b Design Specification](v0.7.0b-design-specification.md)

### Overview

Implement the main menu window that displays on application launch. The menu provides options for starting a new game, loading an existing game, opening settings, and quitting the application. This is the entry point for the GUI experience.

### Scope

**In Scope:**
- `MainMenuWindow` Avalonia window
- `MainMenuViewModel` with commands
- Game title/logo display
- New Game button â†’ character creation or start
- Load Game button â†’ save file selection
- Settings button â†’ settings window
- Quit button â†’ application exit
- Version display
- Background styling

**Out of Scope:**
- Game window (v0.7.0c)
- Character creation wizard (v0.8.0)
- Advanced settings (v0.8.0)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Windows | 2 | `MainMenuWindow`, `SettingsWindow` |
| ViewModels | 2 | `MainMenuViewModel`, `SettingsViewModel` |
| Commands | 4 | NewGame, LoadGame, Settings, Quit |
| Unit Tests | ~8 | Menu navigation, command tests |

### Main Menu Window Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                          â”‚
â”‚                                                                          â”‚
â”‚                                                                          â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                   â”‚                                 â”‚                   â”‚
â”‚                   â”‚       â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—     â”‚                   â”‚
â”‚                   â”‚       â•‘                   â•‘     â”‚                   â”‚
â”‚                   â”‚       â•‘  RUNE AND RUST    â•‘     â”‚                   â”‚
â”‚                   â”‚       â•‘                   â•‘     â”‚                   â”‚
â”‚                   â”‚       â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚                   â”‚
â”‚                   â”‚                                 â”‚                   â”‚
â”‚                   â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                   â”‚
â”‚                   â”‚     â”‚     New Game        â”‚     â”‚                   â”‚
â”‚                   â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                   â”‚
â”‚                   â”‚                                 â”‚                   â”‚
â”‚                   â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                   â”‚
â”‚                   â”‚     â”‚     Load Game       â”‚     â”‚                   â”‚
â”‚                   â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                   â”‚
â”‚                   â”‚                                 â”‚                   â”‚
â”‚                   â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                   â”‚
â”‚                   â”‚     â”‚     Settings        â”‚     â”‚                   â”‚
â”‚                   â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                   â”‚
â”‚                   â”‚                                 â”‚                   â”‚
â”‚                   â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                   â”‚
â”‚                   â”‚     â”‚       Quit          â”‚     â”‚                   â”‚
â”‚                   â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                   â”‚
â”‚                   â”‚                                 â”‚                   â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                          â”‚
â”‚                           v0.7.0 - GUI Foundation                        â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### MainMenuViewModel

```csharp
namespace RuneAndRust.Avalonia.ViewModels;

public partial class MainMenuViewModel : ViewModelBase
{
    private readonly INavigationService _navigation;
    private readonly IGameSessionService _gameSession;
    private readonly ISaveLoadService _saveLoad;
    
    [ObservableProperty]
    private string _version = "v0.7.0";
    
    public MainMenuViewModel(
        INavigationService navigation,
        IGameSessionService gameSession,
        ISaveLoadService saveLoad)
    {
        _navigation = navigation;
        _gameSession = gameSession;
        _saveLoad = saveLoad;
    }
    
    [RelayCommand]
    private async Task NewGameAsync()
    {
        await _gameSession.StartNewGameAsync();
        _navigation.NavigateTo<GameWindow>();
    }
    
    [RelayCommand]
    private async Task LoadGameAsync()
    {
        var saveFile = await _navigation.ShowLoadDialogAsync();
        if (saveFile is not null)
        {
            await _gameSession.LoadGameAsync(saveFile);
            _navigation.NavigateTo<GameWindow>();
        }
    }
    
    [RelayCommand]
    private void OpenSettings()
    {
        _navigation.ShowDialog<SettingsWindow>();
    }
    
    [RelayCommand]
    private void Quit()
    {
        if (Application.Current?.ApplicationLifetime is IClassicDesktopStyleApplicationLifetime desktop)
        {
            desktop.Shutdown();
        }
    }
}
```

### Settings Window (Basic)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SETTINGS                                         [X]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Display                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Window Mode:    [Windowed â–¼]                    â”‚   â”‚
â”‚  â”‚ Resolution:     [1280x720 â–¼]                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  Audio                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Master Volume:  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 80%              â”‚   â”‚
â”‚  â”‚ Music Volume:   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] 60%              â”‚   â”‚
â”‚  â”‚ SFX Volume:     [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 80%              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚      Apply       â”‚  â”‚      Cancel      â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Acceptance Criteria

- [ ] Main menu displays on launch
- [ ] Game title displays prominently
- [ ] New Game button starts new game
- [ ] New Game navigates to game window
- [ ] Load Game opens file selection
- [ ] Load Game loads selected save
- [ ] Settings opens settings dialog
- [ ] Settings can be saved/cancelled
- [ ] Quit closes application
- [ ] Version displays at bottom
- [ ] ~8 unit tests pass

---

## v0.7.0c: Game Window Layout

[v0.7.0c Design Specification](v0.7.0c-design-specification.md)

### Overview

Implement the main game window that hosts all game panels. This includes the window layout structure with regions for different panels, navigation service for switching between windows, and window state management.

### Scope

**In Scope:**
- `GameWindow` Avalonia window
- `GameWindowViewModel` with game state
- `INavigationService` interface
- `NavigationService` implementation
- `IWindowLayoutService` interface
- `WindowLayoutService` for panel regions
- Panel placeholder regions
- Window menu bar (File, Game, Help)
- Window resize handling
- Panel visibility management
- Return to main menu

**Out of Scope:**
- Panel content (v0.7.1+)
- Combat grid (v0.7.3)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Windows | 1 | `GameWindow` |
| ViewModels | 1 | `GameWindowViewModel` |
| Services | 2 | `NavigationService`, `WindowLayoutService` |
| Interfaces | 2 | `INavigationService`, `IWindowLayoutService` |
| Unit Tests | ~7 | Navigation, layout tests |

### Game Window Layout Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  File   Game   Help                                      [_]  [â–¡]  [X]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                     â”‚  â”‚                           â”‚ â”‚
â”‚  â”‚           MAIN CONTENT              â”‚  â”‚      RIGHT SIDEBAR        â”‚ â”‚
â”‚  â”‚             REGION                  â”‚  â”‚         REGION            â”‚ â”‚
â”‚  â”‚                                     â”‚  â”‚                           â”‚ â”‚
â”‚  â”‚        (Room Display Panel)         â”‚  â”‚    (Player Status Panel)  â”‚ â”‚
â”‚  â”‚             v0.7.1                  â”‚  â”‚          v0.7.1           â”‚ â”‚
â”‚  â”‚                                     â”‚  â”‚                           â”‚ â”‚
â”‚  â”‚                                     â”‚  â”‚                           â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                     â”‚  â”‚                           â”‚ â”‚
â”‚  â”‚       BOTTOM CONTENT REGION         â”‚  â”‚    (Inventory Panel)      â”‚ â”‚
â”‚  â”‚                                     â”‚  â”‚          v0.7.2           â”‚ â”‚
â”‚  â”‚       (Message Log Panel)           â”‚  â”‚                           â”‚ â”‚
â”‚  â”‚             v0.7.1                  â”‚  â”‚                           â”‚ â”‚
â”‚  â”‚                                     â”‚  â”‚                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                      INPUT REGION (v0.7.2)                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### INavigationService Interface

```csharp
namespace RuneAndRust.Avalonia.Services;

/// <summary>
/// Handles navigation between windows.
/// </summary>
public interface INavigationService
{
    /// <summary>Gets the current window.</summary>
    Window? CurrentWindow { get; }
    
    /// <summary>Navigates to a window type.</summary>
    void NavigateTo<TWindow>() where TWindow : Window;
    
    /// <summary>Shows a dialog window.</summary>
    Task<TResult?> ShowDialogAsync<TWindow, TResult>() where TWindow : Window;
    
    /// <summary>Shows a dialog window (no result).</summary>
    void ShowDialog<TWindow>() where TWindow : Window;
    
    /// <summary>Shows a file open dialog.</summary>
    Task<string?> ShowLoadDialogAsync();
    
    /// <summary>Shows a file save dialog.</summary>
    Task<string?> ShowSaveDialogAsync();
    
    /// <summary>Navigates back to previous window.</summary>
    void NavigateBack();
    
    /// <summary>Closes all windows and returns to main menu.</summary>
    void ReturnToMainMenu();
}
```

### IWindowLayoutService Interface

```csharp
namespace RuneAndRust.Avalonia.Services;

/// <summary>
/// Manages panel regions in the game window.
/// </summary>
public interface IWindowLayoutService
{
    /// <summary>Registers a panel in a region.</summary>
    void RegisterPanel(PanelRegion region, Control panel);
    
    /// <summary>Unregisters a panel from a region.</summary>
    void UnregisterPanel(PanelRegion region);
    
    /// <summary>Gets the panel in a region.</summary>
    Control? GetPanel(PanelRegion region);
    
    /// <summary>Sets panel visibility.</summary>
    void SetPanelVisible(PanelRegion region, bool visible);
    
    /// <summary>Event when layout changes.</summary>
    event Action<PanelRegion>? OnLayoutChanged;
}

public enum PanelRegion
{
    MainContent,      // Room display
    BottomContent,    // Message log
    RightSidebarTop,  // Player status
    RightSidebarBottom, // Inventory
    Input,            // Command input
    CombatOverlay     // Combat grid (overlays main content)
}
```

### GameWindowViewModel

```csharp
namespace RuneAndRust.Avalonia.ViewModels;

public partial class GameWindowViewModel : ViewModelBase
{
    private readonly INavigationService _navigation;
    private readonly IGameSessionService _gameSession;
    private readonly IWindowLayoutService _layout;
    
    [ObservableProperty]
    private bool _isInCombat;
    
    [ObservableProperty]
    private string _windowTitle = "Rune and Rust";
    
    public GameWindowViewModel(
        INavigationService navigation,
        IGameSessionService gameSession,
        IWindowLayoutService layout)
    {
        _navigation = navigation;
        _gameSession = gameSession;
        _layout = layout;
        
        _gameSession.OnCombatStateChanged += HandleCombatStateChanged;
    }
    
    [RelayCommand]
    private void ReturnToMainMenu()
    {
        _navigation.ReturnToMainMenu();
    }
    
    [RelayCommand]
    private async Task SaveGameAsync()
    {
        var path = await _navigation.ShowSaveDialogAsync();
        if (path is not null)
        {
            await _gameSession.SaveGameAsync(path);
        }
    }
    
    [RelayCommand]
    private async Task LoadGameAsync()
    {
        var path = await _navigation.ShowLoadDialogAsync();
        if (path is not null)
        {
            await _gameSession.LoadGameAsync(path);
        }
    }
    
    private void HandleCombatStateChanged(bool inCombat)
    {
        IsInCombat = inCombat;
        _layout.SetPanelVisible(PanelRegion.CombatOverlay, inCombat);
    }
}
```

### Menu Bar Structure

```
File Menu:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ New Game     â”‚
â”‚ ğŸ“‚ Load Game... â”‚
â”‚ ğŸ’¾ Save Game... â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš™ Settings     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âŒ Quit        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Game Menu:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Character    â”‚
â”‚ ğŸ—º Map          â”‚
â”‚ ğŸ“œ Quest Log    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â¸ Pause        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Help Menu:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“– How to Play  â”‚
â”‚ âŒ¨ Controls     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â„¹ About        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Acceptance Criteria

- [ ] Game window opens from main menu
- [ ] Window has proper layout regions
- [ ] Menu bar displays with File/Game/Help
- [ ] Save Game opens save dialog
- [ ] Load Game opens load dialog
- [ ] Return to Main Menu works
- [ ] Window resize adjusts regions
- [ ] Panel regions can hold content
- [ ] Combat overlay region toggles
- [ ] ~7 unit tests pass

---

## Dependencies & Prerequisites

```
v0.6.3b (Tab Completion) - REQUIRED
    â”‚
    â””â”€â”€ CommandHistoryService, TabCompletionService â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            Input handling to adapt for GUI                               â”‚
                                                                          â”‚
v0.7.0 (Application Shell)                                                â”‚
    â”‚                                                                     â”‚
    â”œâ”€â”€ v0.7.0a: Avalonia Project Setup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚       Dependencies: NuGet packages (Avalonia, MVVM)                 â”‚
    â”‚       Provides: App.axaml, themes, styles, Program.cs               â”‚
    â”‚                                                                     â”‚
    â”œâ”€â”€ v0.7.0b: Main Menu Window â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚       Dependencies: v0.7.0a (application base)                      â”‚
    â”‚       Provides: MainMenuWindow, SettingsWindow                      â”‚
    â”‚                                                                     â”‚
    â””â”€â”€ v0.7.0c: Game Window Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            Dependencies: v0.7.0a, v0.7.0b (navigation)
            Provides: GameWindow, NavigationService, WindowLayoutService
```

---

## Estimated Effort Summary

| Part | New Files | Modified Files | Est. Tests | Complexity |
|------|-----------|----------------|------------|------------|
| v0.7.0a | ~8 | ~0 | ~5 | Medium |
| v0.7.0b | ~5 | ~1 | ~8 | Medium |
| v0.7.0c | ~6 | ~1 | ~7 | High |
| **Total** | **~19** | **~2** | **~20** | |

---

## Risk Assessment

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Avalonia learning curve | Medium | Medium | Follow docs, community examples |
| MVVM boilerplate | Low | Medium | Use CommunityToolkit.Mvvm |
| Cross-platform issues | High | Low | Test on all platforms early |
| Theme consistency | Low | Low | Define all colors in resources |

---

## Design Decisions (Confirmed)

### Avalonia Configuration

| Decision | Value | Notes |
|----------|-------|-------|
| **Avalonia Version** | 11.x | Latest stable |
| **Theme Base** | FluentTheme (Dark) | Modern look |
| **MVVM Toolkit** | CommunityToolkit.Mvvm | Source generators |
| **DI Container** | Microsoft.Extensions.DI | Standard .NET DI |

### Window Architecture

| Decision | Value | Notes |
|----------|-------|-------|
| **Navigation** | Window replacement | Not page-based |
| **Layout** | DockPanel + Grid | Flexible regions |
| **Dialogs** | Modal windows | Avalonia dialogs |

### Styling Approach

| Decision | Value | Notes |
|----------|-------|-------|
| **Colors** | Resource dictionary | Centralized |
| **Typography** | Inter font | Avalonia.Fonts.Inter |
| **Game Theme** | Fantasy/Medieval | Brown/gold accents |

---

## Next Steps

1. **Review & Approve** - Confirm scope breakdown
2. **v0.7.0a Design Spec** - Create detailed design for Avalonia Setup
3. **v0.7.0a Implementation** - Create Avalonia project structure
4. **v0.7.0b Design Spec** - Create specification for Main Menu Window
5. **v0.7.0b Implementation** - Build main menu and settings
6. **v0.7.0c Design Spec** - Create specification for Game Window Layout
7. **v0.7.0c Implementation** - Build game window and navigation

---

*This scope breakdown provides a structured approach to implementing v0.7.0 Application Shell. The Avalonia setup establishes the project foundation, the main menu provides the entry point, and the game window layout creates the container for all subsequent panels.*
