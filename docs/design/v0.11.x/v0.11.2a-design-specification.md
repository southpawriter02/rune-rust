# v0.11.2a Design Specification: Crafting Stations

**Version:** 0.11.2a
**Parent:** v0.11.2 (Crafting System)
**Prerequisites:** v0.11.1c Complete (Recipe Discovery)
**Status:** Design In Progress

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [CraftingStationDefinition Entity](#4-craftingstationdefinition-entity)
5. [CraftingStation Entity](#5-craftingstation-entity)
6. [ICraftingStationProvider Interface](#6-icraftingstationprovider-interface)
7. [CraftingStationProvider Implementation](#7-craftingstationprovider-implementation)
8. [Room Integration](#8-room-integration)
9. [Station Commands](#9-station-commands)
10. [Configuration Schema](#10-configuration-schema)
11. [Configuration File](#11-configuration-file)
12. [Logging Specifications](#12-logging-specifications)
13. [Unit Testing Requirements](#13-unit-testing-requirements)
14. [Use Cases](#14-use-cases)
15. [Deliverable Checklist](#15-deliverable-checklist)
16. [Acceptance Criteria](#16-acceptance-criteria)
17. [Dependencies](#17-dependencies)
18. [Future Considerations](#18-future-considerations)

---

## 1. Executive Summary

### Overview

Version 0.11.2a implements Crafting Stations as interactable room features where players can craft items. Each station type supports specific recipe categories and requires a corresponding crafting skill. Stations are defined via JSON configuration and instantiated as room features that players can examine and interact with.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Domain Entities** | CraftingStationDefinition, CraftingStation |
| **Interfaces** | ICraftingStationProvider |
| **Infrastructure** | CraftingStationProvider |
| **Room Integration** | Station spawning, feature support |
| **Configuration** | crafting-stations.json, crafting-stations.schema.json |
| **Tests** | ~10 new unit tests |

### Architectural Significance

This version establishes the **Station-Category Pattern** for crafting:
- Stations are specialized for recipe categories
- Each station links to a crafting skill
- Stations are room features that can be examined and used
- Definition-Instance pattern separates templates from placed stations

---

## 2. Feature Overview

```
v0.11.2a Crafting Stations Features
â”œâ”€â”€ CraftingStationDefinition Entity
â”‚   â”œâ”€â”€ StationId identifier
â”‚   â”œâ”€â”€ Name and description
â”‚   â”œâ”€â”€ SupportedCategories list
â”‚   â”œâ”€â”€ CraftingSkillId reference
â”‚   â””â”€â”€ IconPath for UI
â”œâ”€â”€ CraftingStation Entity
â”‚   â”œâ”€â”€ Extends RoomFeature
â”‚   â”œâ”€â”€ DefinitionId reference
â”‚   â”œâ”€â”€ IsAvailable state
â”‚   â””â”€â”€ Interaction methods
â”œâ”€â”€ ICraftingStationProvider Interface
â”‚   â”œâ”€â”€ GetStation by ID
â”‚   â”œâ”€â”€ GetAllStations
â”‚   â”œâ”€â”€ GetStationsForCategory
â”‚   â”œâ”€â”€ GetCraftingSkill
â”‚   â””â”€â”€ Exists check
â”œâ”€â”€ CraftingStationProvider Implementation
â”‚   â”œâ”€â”€ JSON configuration loading
â”‚   â”œâ”€â”€ Station caching
â”‚   â””â”€â”€ Validation on load
â”œâ”€â”€ Room Integration
â”‚   â”œâ”€â”€ Station feature spawning
â”‚   â”œâ”€â”€ Room description updates
â”‚   â””â”€â”€ Feature interaction
â””â”€â”€ Station Commands
    â”œâ”€â”€ Examine station
    â””â”€â”€ List available recipes
```

---

## 3. Architecture Diagrams

### 3.1 Crafting Station Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CRAFTING STATION ARCHITECTURE                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

     CONFIGURATION                         DOMAIN LAYER
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

   crafting-stations.json          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   CraftingStationDefinition     â”‚
   â”‚ {                    â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚   "id": "anvil",     â”‚         â”‚ + Id: Guid                      â”‚
   â”‚   "name": "Anvil",   â”‚ â”€â”€â”€â”€â”€â”€â–¶ â”‚ + StationId: string             â”‚
   â”‚   "categories": [...],         â”‚ + Name: string                  â”‚
   â”‚   "craftingSkill":   â”‚         â”‚ + Description: string           â”‚
   â”‚     "smithing"       â”‚         â”‚ + SupportedCategories: List     â”‚
   â”‚ }                    â”‚         â”‚ + CraftingSkillId: string       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ + IconPath: string?             â”‚
                                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                    â”‚ + SupportsCategory(cat): bool   â”‚
                                    â”‚ + CanCraftRecipe(recipe): bool  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚ creates
                                                     â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚       CraftingStation           â”‚
                                    â”‚       (Room Feature)            â”‚
                                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                    â”‚ + DefinitionId: string          â”‚
                                    â”‚ + IsAvailable: bool             â”‚
                                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                    â”‚ + SetInUse(): void              â”‚
                                    â”‚ + SetAvailable(): void          â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    APPLICATION LAYER               INFRASTRUCTURE LAYER
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ICraftingStationProvider â”‚    â”‚    CraftingStationProvider      â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ + GetStation(id)         â”‚â—€â”€â”€â”€â”‚ - _stations: Dictionary         â”‚
    â”‚ + GetAllStations()       â”‚    â”‚ - _logger: ILogger              â”‚
    â”‚ + GetStationsForCategory â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ + GetCraftingSkill(id)   â”‚    â”‚ + LoadFromConfiguration()       â”‚
    â”‚ + Exists(id)             â”‚    â”‚ + ValidateStations()            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Station Types Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         STATION TYPES                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ANVIL                   WORKBENCH               ALCHEMY TABLE
    â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     ğŸ”¨      â”‚        â”‚     ğŸªš      â”‚        â”‚     âš—ï¸      â”‚
    â”‚    ANVIL    â”‚        â”‚  WORKBENCH  â”‚        â”‚   ALCHEMY   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Categories:            Categories:            Categories:
    â”œâ”€ Weapon              â”œâ”€ Armor               â”œâ”€ Potion
    â”œâ”€ Tool                â””â”€ Accessory           â””â”€ Consumable
    â””â”€ Material
                           Skill:                 Skill:
    Skill:                 Leatherworking         Alchemy
    Smithing


    ENCHANTING ALTAR        COOKING FIRE
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     âœ¨      â”‚        â”‚     ğŸ”¥      â”‚
    â”‚  ENCHANTING â”‚        â”‚   COOKING   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Categories:            Categories:
    â”œâ”€ Accessory           â””â”€ Consumable
    â”œâ”€ Weapon
    â””â”€ Armor               Skill:
                           Cooking
    Skill:
    Enchanting


    CATEGORY-STATION MAPPING
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Recipe Category â”‚ Compatible Stations                            â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Weapon         â”‚ Anvil, Enchanting Altar                         â”‚
    â”‚ Armor          â”‚ Workbench, Enchanting Altar                     â”‚
    â”‚ Tool           â”‚ Anvil                                           â”‚
    â”‚ Material       â”‚ Anvil                                           â”‚
    â”‚ Potion         â”‚ Alchemy Table                                   â”‚
    â”‚ Consumable     â”‚ Alchemy Table, Cooking Fire                     â”‚
    â”‚ Accessory      â”‚ Workbench, Enchanting Altar                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Room with Crafting Station

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ROOM WITH CRAFTING STATION                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ROOM STRUCTURE
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Room: Blacksmith's Forge                                        â”‚
    â”‚  ID: blacksmith-forge-01                                         â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                  â”‚
    â”‚  Description:                                                    â”‚
    â”‚  The heat from the forge fills the room. Sparks fly as the      â”‚
    â”‚  blacksmith works at his craft.                                  â”‚
    â”‚                                                                  â”‚
    â”‚  Features:                                                       â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
    â”‚  â”‚  [Anvil] - CraftingStation                                   â”‚â”‚
    â”‚  â”‚  â”œâ”€ DefinitionId: "anvil"                                    â”‚â”‚
    â”‚  â”‚  â”œâ”€ IsAvailable: true                                        â”‚â”‚
    â”‚  â”‚  â””â”€ InteractionVerb: "use"                                   â”‚â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
    â”‚                                                                  â”‚
    â”‚  Exits: [North] [South]                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    PLAYER VIEW
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  BLACKSMITH'S FORGE                                               â•‘
    â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
    â•‘                                                                   â•‘
    â•‘  The heat from the forge fills the room. Sparks fly as the       â•‘
    â•‘  blacksmith works at his craft.                                   â•‘
    â•‘                                                                   â•‘
    â•‘  FEATURES:                                                        â•‘
    â•‘  â””â”€ [Anvil] A sturdy anvil for smithing metal items              â•‘
    â•‘             Crafts: Weapons, Tools, Materials                     â•‘
    â•‘                                                                   â•‘
    â•‘  EXITS: North, South                                              â•‘
    â•‘                                                                   â•‘
    â•‘  > examine anvil                                                  â•‘
    â•‘  > craft iron-sword                                               â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 3.4 Layer Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          PRESENTATION LAYER                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ExamineCommand          LookCommand          GameRenderer           â”‚
â”‚  â””â”€ Shows station        â””â”€ Lists features    â””â”€ Renders room       â”‚
â”‚     details                 in room              with stations       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         APPLICATION LAYER                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ICraftingStationProvider        IRoomService                        â”‚
â”‚  â”œâ”€ GetStation(id)               â”œâ”€ GetCurrentRoom(player)          â”‚
â”‚  â”œâ”€ GetAllStations()             â”œâ”€ GetRoomFeatures()               â”‚
â”‚  â”œâ”€ GetStationsForCategory()     â””â”€ HasCraftingStation()            â”‚
â”‚  â””â”€ GetCraftingSkill(id)                                            â”‚
â”‚                                                                      â”‚
â”‚  CraftingStationProvider         RoomService (Extended)              â”‚
â”‚  â””â”€ Loads from JSON              â””â”€ Station feature queries          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DOMAIN LAYER                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CraftingStationDefinition       CraftingStation                     â”‚
â”‚  â”œâ”€ StationId                    â”œâ”€ Extends RoomFeature             â”‚
â”‚  â”œâ”€ Name                         â”œâ”€ DefinitionId                    â”‚
â”‚  â”œâ”€ Description                  â”œâ”€ IsAvailable                     â”‚
â”‚  â”œâ”€ SupportedCategories          â””â”€ SetInUse/SetAvailable           â”‚
â”‚  â””â”€ CraftingSkillId                                                 â”‚
â”‚                                                                      â”‚
â”‚  RecipeCategory (existing)       RoomFeature (existing)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       INFRASTRUCTURE LAYER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  config/crafting-stations.json                                       â”‚
â”‚  config/schemas/crafting-stations.schema.json                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. CraftingStationDefinition Entity

### 4.1 Entity Definition

**File:** `src/Core/RuneAndRust.Domain/Definitions/CraftingStationDefinition.cs`

```csharp
namespace RuneAndRust.Domain.Definitions;

/// <summary>
/// Defines a type of crafting station where players can craft items.
/// </summary>
/// <remarks>
/// Crafting station definitions are templates loaded from configuration.
/// Each station type supports specific recipe categories and requires
/// a corresponding crafting skill for dice check modifiers.
/// </remarks>
public sealed class CraftingStationDefinition : IEntity
{
    /// <summary>
    /// Gets the unique entity identifier.
    /// </summary>
    public Guid Id { get; private set; }

    /// <summary>
    /// Gets the unique station type identifier (e.g., "anvil", "alchemy-table").
    /// </summary>
    public string StationId { get; private set; } = null!;

    /// <summary>
    /// Gets the display name of the station.
    /// </summary>
    public string Name { get; private set; } = null!;

    /// <summary>
    /// Gets the description shown when examining the station.
    /// </summary>
    public string Description { get; private set; } = null!;

    /// <summary>
    /// Gets the recipe categories this station can craft.
    /// </summary>
    public IReadOnlyList<RecipeCategory> SupportedCategories { get; private set; } = [];

    /// <summary>
    /// Gets the skill ID used for crafting checks at this station.
    /// </summary>
    public string CraftingSkillId { get; private set; } = null!;

    /// <summary>
    /// Gets the optional icon path for UI display.
    /// </summary>
    public string? IconPath { get; private set; }

    /// <summary>
    /// Private constructor for factory pattern and serialization.
    /// </summary>
    private CraftingStationDefinition() { }

    /// <summary>
    /// Creates a new crafting station definition.
    /// </summary>
    /// <param name="stationId">The unique station type identifier.</param>
    /// <param name="name">The display name.</param>
    /// <param name="description">The station description.</param>
    /// <param name="supportedCategories">Recipe categories this station supports.</param>
    /// <param name="craftingSkillId">The skill used for crafting checks.</param>
    /// <param name="iconPath">Optional icon path for UI.</param>
    /// <returns>A new CraftingStationDefinition instance.</returns>
    /// <exception cref="ArgumentException">
    /// Thrown when required parameters are null or whitespace.
    /// </exception>
    /// <exception cref="ArgumentOutOfRangeException">
    /// Thrown when supportedCategories is empty.
    /// </exception>
    public static CraftingStationDefinition Create(
        string stationId,
        string name,
        string description,
        IEnumerable<RecipeCategory> supportedCategories,
        string craftingSkillId,
        string? iconPath = null)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(stationId, nameof(stationId));
        ArgumentException.ThrowIfNullOrWhiteSpace(name, nameof(name));
        ArgumentException.ThrowIfNullOrWhiteSpace(description, nameof(description));
        ArgumentException.ThrowIfNullOrWhiteSpace(craftingSkillId, nameof(craftingSkillId));
        ArgumentNullException.ThrowIfNull(supportedCategories, nameof(supportedCategories));

        var categoryList = supportedCategories.ToList();
        if (categoryList.Count == 0)
        {
            throw new ArgumentOutOfRangeException(
                nameof(supportedCategories),
                "Station must support at least one recipe category.");
        }

        return new CraftingStationDefinition
        {
            Id = Guid.NewGuid(),
            StationId = stationId.ToLowerInvariant(),
            Name = name,
            Description = description,
            SupportedCategories = categoryList,
            CraftingSkillId = craftingSkillId.ToLowerInvariant(),
            IconPath = iconPath
        };
    }

    /// <summary>
    /// Checks if this station supports a specific recipe category.
    /// </summary>
    /// <param name="category">The recipe category to check.</param>
    /// <returns>True if the station supports the category; otherwise, false.</returns>
    public bool SupportsCategory(RecipeCategory category)
    {
        return SupportedCategories.Contains(category);
    }

    /// <summary>
    /// Checks if this station can craft a specific recipe.
    /// </summary>
    /// <param name="recipe">The recipe to check.</param>
    /// <returns>True if the station can craft the recipe; otherwise, false.</returns>
    /// <exception cref="ArgumentNullException">
    /// Thrown when recipe is null.
    /// </exception>
    public bool CanCraftRecipe(RecipeDefinition recipe)
    {
        ArgumentNullException.ThrowIfNull(recipe, nameof(recipe));
        return SupportsCategory(recipe.Category);
    }

    /// <summary>
    /// Gets a formatted string of supported categories for display.
    /// </summary>
    /// <returns>A comma-separated list of category names.</returns>
    public string GetCategoriesDisplay()
    {
        return string.Join(", ", SupportedCategories.Select(c => c.ToString()));
    }

    /// <summary>
    /// Creates an instance of this station type for placement in a room.
    /// </summary>
    /// <returns>A new CraftingStation instance.</returns>
    public CraftingStation CreateInstance()
    {
        return CraftingStation.Create(this);
    }
}
```

### 4.2 CraftingStationDefinition Properties

| Property | Type | Description |
|----------|------|-------------|
| `Id` | `Guid` | Unique entity identifier |
| `StationId` | `string` | Station type ID (e.g., "anvil") |
| `Name` | `string` | Display name (e.g., "Anvil") |
| `Description` | `string` | Examination text |
| `SupportedCategories` | `IReadOnlyList<RecipeCategory>` | Categories this station crafts |
| `CraftingSkillId` | `string` | Skill for crafting checks |
| `IconPath` | `string?` | Optional UI icon path |

---

## 5. CraftingStation Entity

### 5.1 Entity Definition

**File:** `src/Core/RuneAndRust.Domain/Entities/CraftingStation.cs`

```csharp
namespace RuneAndRust.Domain.Entities;

/// <summary>
/// A crafting station instance placed in a room.
/// </summary>
/// <remarks>
/// CraftingStation extends RoomFeature to be placed in rooms as an
/// interactable feature. Players can examine stations to see what
/// they craft, and use them to craft items from known recipes.
/// </remarks>
public sealed class CraftingStation : RoomFeature
{
    /// <summary>
    /// Gets the ID of the station definition this instance is based on.
    /// </summary>
    public string DefinitionId { get; private set; } = null!;

    /// <summary>
    /// Gets whether the station is currently available for use.
    /// </summary>
    /// <remarks>
    /// A station becomes unavailable while a player is actively crafting.
    /// This prevents multiple simultaneous crafting operations.
    /// </remarks>
    public bool IsAvailable { get; private set; } = true;

    /// <summary>
    /// Gets the timestamp when the station was last used.
    /// </summary>
    public DateTime? LastUsedAt { get; private set; }

    /// <summary>
    /// Private constructor for factory pattern and serialization.
    /// </summary>
    private CraftingStation() : base() { }

    /// <summary>
    /// Creates a new crafting station instance from a definition.
    /// </summary>
    /// <param name="definition">The station definition to instantiate.</param>
    /// <returns>A new CraftingStation instance.</returns>
    /// <exception cref="ArgumentNullException">
    /// Thrown when definition is null.
    /// </exception>
    public static CraftingStation Create(CraftingStationDefinition definition)
    {
        ArgumentNullException.ThrowIfNull(definition, nameof(definition));

        return new CraftingStation
        {
            Id = Guid.NewGuid(),
            DefinitionId = definition.StationId,
            Name = definition.Name,
            Description = definition.Description,
            FeatureType = RoomFeatureType.CraftingStation,
            IsInteractable = true,
            InteractionVerb = "use",
            IsAvailable = true
        };
    }

    /// <summary>
    /// Creates a crafting station with a custom description.
    /// </summary>
    /// <param name="definition">The station definition.</param>
    /// <param name="customDescription">A custom description for this instance.</param>
    /// <returns>A new CraftingStation instance with custom description.</returns>
    public static CraftingStation Create(
        CraftingStationDefinition definition,
        string customDescription)
    {
        var station = Create(definition);
        station.Description = customDescription;
        return station;
    }

    /// <summary>
    /// Marks the station as in use (unavailable for other crafting).
    /// </summary>
    public void SetInUse()
    {
        IsAvailable = false;
        LastUsedAt = DateTime.UtcNow;
    }

    /// <summary>
    /// Marks the station as available for use.
    /// </summary>
    public void SetAvailable()
    {
        IsAvailable = true;
    }

    /// <summary>
    /// Gets a description of the station's current status.
    /// </summary>
    /// <returns>A status string.</returns>
    public string GetStatusDescription()
    {
        return IsAvailable
            ? "The station is ready for use."
            : "The station is currently in use.";
    }

    /// <summary>
    /// Gets the interaction prompt for this station.
    /// </summary>
    /// <returns>The interaction prompt text.</returns>
    public override string GetInteractionPrompt()
    {
        return IsAvailable
            ? $"Type 'craft <recipe>' to craft at this {Name}."
            : $"The {Name} is currently in use.";
    }
}
```

### 5.2 RoomFeatureType Enum Extension

**File:** `src/Core/RuneAndRust.Domain/Enums/RoomFeatureType.cs` (Extension)

```csharp
namespace RuneAndRust.Domain.Enums;

/// <summary>
/// Types of features that can be found in rooms.
/// </summary>
public enum RoomFeatureType
{
    /// <summary>Generic interactable feature.</summary>
    Generic = 0,

    /// <summary>A container that can be searched.</summary>
    Container,

    /// <summary>A door or passage.</summary>
    Door,

    /// <summary>A trap that can be triggered.</summary>
    Trap,

    /// <summary>A crafting station for making items.</summary>
    CraftingStation,

    /// <summary>A resource node that can be gathered.</summary>
    ResourceNode,

    /// <summary>An NPC that can be interacted with.</summary>
    Npc
}
```

### 5.3 CraftingStation Properties

| Property | Type | Description |
|----------|------|-------------|
| `Id` | `Guid` | Unique instance identifier |
| `DefinitionId` | `string` | Reference to station definition |
| `Name` | `string` | Display name |
| `Description` | `string` | Examination text |
| `FeatureType` | `RoomFeatureType` | Always CraftingStation |
| `IsInteractable` | `bool` | Always true |
| `InteractionVerb` | `string` | Always "use" |
| `IsAvailable` | `bool` | Whether station can be used |
| `LastUsedAt` | `DateTime?` | Last usage timestamp |

---

## 6. ICraftingStationProvider Interface

### 6.1 Interface Definition

**File:** `src/Core/RuneAndRust.Application/Interfaces/ICraftingStationProvider.cs`

```csharp
namespace RuneAndRust.Application.Interfaces;

/// <summary>
/// Provides access to crafting station definitions.
/// </summary>
public interface ICraftingStationProvider
{
    /// <summary>
    /// Gets a crafting station definition by ID.
    /// </summary>
    /// <param name="stationId">The station identifier.</param>
    /// <returns>The station definition, or null if not found.</returns>
    CraftingStationDefinition? GetStation(string stationId);

    /// <summary>
    /// Gets all crafting station definitions.
    /// </summary>
    /// <returns>A read-only list of all station definitions.</returns>
    IReadOnlyList<CraftingStationDefinition> GetAllStations();

    /// <summary>
    /// Gets all stations that support a specific recipe category.
    /// </summary>
    /// <param name="category">The recipe category.</param>
    /// <returns>Stations that can craft recipes in this category.</returns>
    IReadOnlyList<CraftingStationDefinition> GetStationsForCategory(RecipeCategory category);

    /// <summary>
    /// Gets the crafting skill ID for a station.
    /// </summary>
    /// <param name="stationId">The station identifier.</param>
    /// <returns>The skill ID, or null if station not found.</returns>
    string? GetCraftingSkill(string stationId);

    /// <summary>
    /// Checks if a station definition exists.
    /// </summary>
    /// <param name="stationId">The station identifier.</param>
    /// <returns>True if the station exists; otherwise, false.</returns>
    bool Exists(string stationId);

    /// <summary>
    /// Gets the total count of station definitions.
    /// </summary>
    /// <returns>The number of defined stations.</returns>
    int GetStationCount();

    /// <summary>
    /// Gets stations that use a specific crafting skill.
    /// </summary>
    /// <param name="skillId">The skill identifier.</param>
    /// <returns>Stations that use this skill for crafting checks.</returns>
    IReadOnlyList<CraftingStationDefinition> GetStationsBySkill(string skillId);
}
```

---

## 7. CraftingStationProvider Implementation

### 7.1 Provider Implementation

**File:** `src/Infrastructure/RuneAndRust.Infrastructure/Providers/CraftingStationProvider.cs`

```csharp
namespace RuneAndRust.Infrastructure.Providers;

/// <summary>
/// Provides crafting station definitions loaded from JSON configuration.
/// </summary>
public sealed class CraftingStationProvider : ICraftingStationProvider
{
    private readonly Dictionary<string, CraftingStationDefinition> _stations;
    private readonly ILogger<CraftingStationProvider> _logger;

    /// <summary>
    /// Initializes a new instance of CraftingStationProvider.
    /// </summary>
    /// <param name="settings">The crafting station settings from configuration.</param>
    /// <param name="logger">The logger instance.</param>
    /// <exception cref="ArgumentNullException">
    /// Thrown when settings or logger is null.
    /// </exception>
    public CraftingStationProvider(
        IOptions<CraftingStationSettings> settings,
        ILogger<CraftingStationProvider> logger)
    {
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));

        var config = settings?.Value ?? throw new ArgumentNullException(nameof(settings));

        _stations = new Dictionary<string, CraftingStationDefinition>(
            StringComparer.OrdinalIgnoreCase);

        LoadStations(config.Stations);
        ValidateStations();

        _logger.LogInformation(
            "Loaded {Count} crafting station definitions",
            _stations.Count);
    }

    /// <inheritdoc />
    public CraftingStationDefinition? GetStation(string stationId)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(stationId, nameof(stationId));

        return _stations.GetValueOrDefault(stationId.ToLowerInvariant());
    }

    /// <inheritdoc />
    public IReadOnlyList<CraftingStationDefinition> GetAllStations()
    {
        return _stations.Values.ToList();
    }

    /// <inheritdoc />
    public IReadOnlyList<CraftingStationDefinition> GetStationsForCategory(RecipeCategory category)
    {
        return _stations.Values
            .Where(s => s.SupportsCategory(category))
            .ToList();
    }

    /// <inheritdoc />
    public string? GetCraftingSkill(string stationId)
    {
        var station = GetStation(stationId);
        return station?.CraftingSkillId;
    }

    /// <inheritdoc />
    public bool Exists(string stationId)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(stationId, nameof(stationId));
        return _stations.ContainsKey(stationId.ToLowerInvariant());
    }

    /// <inheritdoc />
    public int GetStationCount()
    {
        return _stations.Count;
    }

    /// <inheritdoc />
    public IReadOnlyList<CraftingStationDefinition> GetStationsBySkill(string skillId)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(skillId, nameof(skillId));

        var normalizedSkillId = skillId.ToLowerInvariant();
        return _stations.Values
            .Where(s => s.CraftingSkillId.Equals(normalizedSkillId, StringComparison.OrdinalIgnoreCase))
            .ToList();
    }

    /// <summary>
    /// Loads station definitions from configuration.
    /// </summary>
    private void LoadStations(IEnumerable<CraftingStationConfig> stationConfigs)
    {
        foreach (var config in stationConfigs)
        {
            try
            {
                var categories = config.SupportedCategories
                    .Select(c => Enum.Parse<RecipeCategory>(c, ignoreCase: true))
                    .ToList();

                var station = CraftingStationDefinition.Create(
                    config.Id,
                    config.Name,
                    config.Description,
                    categories,
                    config.CraftingSkill,
                    config.Icon);

                _stations[station.StationId] = station;

                _logger.LogDebug(
                    "Loaded crafting station: {StationId} ({Categories})",
                    station.StationId,
                    station.GetCategoriesDisplay());
            }
            catch (Exception ex)
            {
                _logger.LogError(
                    ex,
                    "Failed to load crafting station: {StationId}",
                    config.Id);
            }
        }
    }

    /// <summary>
    /// Validates loaded station definitions.
    /// </summary>
    private void ValidateStations()
    {
        // Ensure we have at least one station
        if (_stations.Count == 0)
        {
            _logger.LogWarning("No crafting stations loaded from configuration");
        }

        // Log any categories without stations
        var allCategories = Enum.GetValues<RecipeCategory>();
        foreach (var category in allCategories)
        {
            var stationsForCategory = GetStationsForCategory(category);
            if (stationsForCategory.Count == 0)
            {
                _logger.LogDebug(
                    "No crafting stations support category: {Category}",
                    category);
            }
        }
    }
}
```

### 7.2 Configuration Settings Class

**File:** `src/Infrastructure/RuneAndRust.Infrastructure/Configuration/CraftingStationSettings.cs`

```csharp
namespace RuneAndRust.Infrastructure.Configuration;

/// <summary>
/// Settings for crafting station configuration.
/// </summary>
public sealed class CraftingStationSettings
{
    /// <summary>
    /// Gets or sets the list of crafting station configurations.
    /// </summary>
    public List<CraftingStationConfig> Stations { get; set; } = [];
}

/// <summary>
/// Configuration for a single crafting station.
/// </summary>
public sealed class CraftingStationConfig
{
    /// <summary>
    /// Gets or sets the station identifier.
    /// </summary>
    public string Id { get; set; } = null!;

    /// <summary>
    /// Gets or sets the display name.
    /// </summary>
    public string Name { get; set; } = null!;

    /// <summary>
    /// Gets or sets the station description.
    /// </summary>
    public string Description { get; set; } = null!;

    /// <summary>
    /// Gets or sets the supported recipe categories.
    /// </summary>
    public List<string> SupportedCategories { get; set; } = [];

    /// <summary>
    /// Gets or sets the crafting skill for this station.
    /// </summary>
    public string CraftingSkill { get; set; } = null!;

    /// <summary>
    /// Gets or sets the optional icon path.
    /// </summary>
    public string? Icon { get; set; }
}
```

---

## 8. Room Integration

### 8.1 Room Extension Methods

**File:** `src/Core/RuneAndRust.Domain/Extensions/RoomExtensions.cs`

```csharp
namespace RuneAndRust.Domain.Extensions;

/// <summary>
/// Extension methods for Room entity.
/// </summary>
public static class RoomExtensions
{
    /// <summary>
    /// Gets all crafting stations in the room.
    /// </summary>
    /// <param name="room">The room to search.</param>
    /// <returns>All crafting stations in the room.</returns>
    public static IReadOnlyList<CraftingStation> GetCraftingStations(this Room room)
    {
        ArgumentNullException.ThrowIfNull(room, nameof(room));
        return room.Features.OfType<CraftingStation>().ToList();
    }

    /// <summary>
    /// Gets the first available crafting station in the room.
    /// </summary>
    /// <param name="room">The room to search.</param>
    /// <returns>An available crafting station, or null if none available.</returns>
    public static CraftingStation? GetAvailableCraftingStation(this Room room)
    {
        return room.GetCraftingStations()
            .FirstOrDefault(s => s.IsAvailable);
    }

    /// <summary>
    /// Gets a specific crafting station by definition ID.
    /// </summary>
    /// <param name="room">The room to search.</param>
    /// <param name="definitionId">The station definition ID.</param>
    /// <returns>The matching station, or null if not found.</returns>
    public static CraftingStation? GetCraftingStation(this Room room, string definitionId)
    {
        ArgumentException.ThrowIfNullOrWhiteSpace(definitionId, nameof(definitionId));

        return room.GetCraftingStations()
            .FirstOrDefault(s => s.DefinitionId.Equals(
                definitionId,
                StringComparison.OrdinalIgnoreCase));
    }

    /// <summary>
    /// Checks if the room has any crafting station.
    /// </summary>
    /// <param name="room">The room to check.</param>
    /// <returns>True if the room has at least one crafting station.</returns>
    public static bool HasCraftingStation(this Room room)
    {
        return room.GetCraftingStations().Count > 0;
    }

    /// <summary>
    /// Checks if the room has an available crafting station.
    /// </summary>
    /// <param name="room">The room to check.</param>
    /// <returns>True if the room has an available station.</returns>
    public static bool HasAvailableCraftingStation(this Room room)
    {
        return room.GetAvailableCraftingStation() is not null;
    }

    /// <summary>
    /// Adds a crafting station to the room.
    /// </summary>
    /// <param name="room">The room to add to.</param>
    /// <param name="station">The station to add.</param>
    public static void AddCraftingStation(this Room room, CraftingStation station)
    {
        ArgumentNullException.ThrowIfNull(room, nameof(room));
        ArgumentNullException.ThrowIfNull(station, nameof(station));

        room.AddFeature(station);
    }
}
```

### 8.2 Room Spawning Integration

**File:** `src/Core/RuneAndRust.Application/Services/RoomGenerationService.cs` (Extension)

```csharp
namespace RuneAndRust.Application.Services;

public partial class RoomGenerationService
{
    private readonly ICraftingStationProvider _craftingStationProvider;

    /// <summary>
    /// Spawns a crafting station in a room based on room type.
    /// </summary>
    /// <param name="room">The room to add the station to.</param>
    /// <param name="stationId">The station definition ID to spawn.</param>
    /// <returns>True if the station was added; otherwise, false.</returns>
    public bool SpawnCraftingStation(Room room, string stationId)
    {
        var definition = _craftingStationProvider.GetStation(stationId);
        if (definition is null)
        {
            _logger.LogWarning(
                "Cannot spawn unknown crafting station: {StationId}",
                stationId);
            return false;
        }

        var station = definition.CreateInstance();
        room.AddCraftingStation(station);

        _logger.LogDebug(
            "Spawned crafting station {StationId} in room {RoomId}",
            stationId,
            room.Id);

        return true;
    }

    /// <summary>
    /// Spawns a crafting station with a custom description.
    /// </summary>
    /// <param name="room">The room to add the station to.</param>
    /// <param name="stationId">The station definition ID.</param>
    /// <param name="customDescription">Custom description for this instance.</param>
    /// <returns>True if the station was added; otherwise, false.</returns>
    public bool SpawnCraftingStation(Room room, string stationId, string customDescription)
    {
        var definition = _craftingStationProvider.GetStation(stationId);
        if (definition is null)
        {
            _logger.LogWarning(
                "Cannot spawn unknown crafting station: {StationId}",
                stationId);
            return false;
        }

        var station = CraftingStation.Create(definition, customDescription);
        room.AddCraftingStation(station);

        _logger.LogDebug(
            "Spawned custom crafting station {StationId} in room {RoomId}",
            stationId,
            room.Id);

        return true;
    }
}
```

---

## 9. Station Commands

### 9.1 ExamineCommand Extension

**File:** `src/Presentation/RuneAndRust.Presentation/Commands/ExamineCommand.cs` (Extension)

```csharp
namespace RuneAndRust.Presentation.Commands;

public partial class ExamineCommand
{
    private readonly ICraftingStationProvider _craftingStationProvider;

    /// <summary>
    /// Handles examining a crafting station.
    /// </summary>
    private CommandResult ExamineCraftingStation(CraftingStation station)
    {
        var definition = _craftingStationProvider.GetStation(station.DefinitionId);
        if (definition is null)
        {
            return CommandResult.Info($"{station.Name}\n\n{station.Description}");
        }

        var output = new StringBuilder();
        output.AppendLine($"â•â•â• {station.Name.ToUpperInvariant()} â•â•â•");
        output.AppendLine();
        output.AppendLine(station.Description);
        output.AppendLine();
        output.AppendLine("CRAFTING INFO:");
        output.AppendLine($"  Categories: {definition.GetCategoriesDisplay()}");
        output.AppendLine($"  Skill: {definition.CraftingSkillId.ToTitleCase()}");
        output.AppendLine();
        output.AppendLine($"Status: {station.GetStatusDescription()}");
        output.AppendLine();
        output.AppendLine(station.GetInteractionPrompt());

        return CommandResult.Success(output.ToString());
    }
}
```

### 9.2 Examine Station UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     EXAMINE STATION OUTPUT                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    > examine anvil

    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  â•â•â• ANVIL â•â•â•                                                    â•‘
    â•‘                                                                   â•‘
    â•‘  A sturdy anvil for smithing metal items. The surface is         â•‘
    â•‘  scarred from countless hammerings but remains serviceable.      â•‘
    â•‘                                                                   â•‘
    â•‘  CRAFTING INFO:                                                   â•‘
    â•‘    Categories: Weapon, Tool, Material                             â•‘
    â•‘    Skill: Smithing                                                â•‘
    â•‘                                                                   â•‘
    â•‘  Status: The station is ready for use.                           â•‘
    â•‘                                                                   â•‘
    â•‘  Type 'craft <recipe>' to craft at this Anvil.                   â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


    > examine alchemy-table

    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  â•â•â• ALCHEMY TABLE â•â•â•                                            â•‘
    â•‘                                                                   â•‘
    â•‘  A table with bubbling vials for brewing potions. Various        â•‘
    â•‘  herbs and reagents are scattered across its surface.            â•‘
    â•‘                                                                   â•‘
    â•‘  CRAFTING INFO:                                                   â•‘
    â•‘    Categories: Potion, Consumable                                 â•‘
    â•‘    Skill: Alchemy                                                 â•‘
    â•‘                                                                   â•‘
    â•‘  Status: The station is currently in use.                        â•‘
    â•‘                                                                   â•‘
    â•‘  The Alchemy Table is currently in use.                          â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 10. Configuration Schema

### 10.1 Crafting Stations Schema

**File:** `config/schemas/crafting-stations.schema.json`

```json
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://runeandrust.game/schemas/crafting-stations.schema.json",
  "title": "Crafting Stations Configuration",
  "description": "Configuration for crafting station definitions",
  "type": "object",
  "required": ["stations"],
  "properties": {
    "stations": {
      "type": "array",
      "description": "List of crafting station definitions",
      "items": {
        "$ref": "#/$defs/craftingStationConfig"
      },
      "minItems": 1
    }
  },
  "$defs": {
    "craftingStationConfig": {
      "type": "object",
      "description": "Configuration for a single crafting station",
      "required": ["id", "name", "description", "supportedCategories", "craftingSkill"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the station type",
          "minLength": 1,
          "pattern": "^[a-z0-9-]+$"
        },
        "name": {
          "type": "string",
          "description": "Display name for the station",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "description": "Description shown when examining the station",
          "minLength": 1
        },
        "supportedCategories": {
          "type": "array",
          "description": "Recipe categories this station can craft",
          "items": {
            "type": "string",
            "enum": ["Weapon", "Armor", "Potion", "Consumable", "Accessory", "Tool", "Material"]
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "craftingSkill": {
          "type": "string",
          "description": "The skill used for crafting checks at this station",
          "minLength": 1,
          "pattern": "^[a-z]+$"
        },
        "icon": {
          "type": "string",
          "description": "Optional path to the station icon",
          "pattern": "^icons/.*\\.(png|jpg|svg)$"
        }
      }
    }
  }
}
```

---

## 11. Configuration File

### 11.1 Crafting Stations Configuration

**File:** `config/crafting-stations.json`

```json
{
  "$schema": "./schemas/crafting-stations.schema.json",
  "stations": [
    {
      "id": "anvil",
      "name": "Anvil",
      "description": "A sturdy anvil for smithing metal items. The surface is scarred from countless hammerings but remains serviceable.",
      "supportedCategories": ["Weapon", "Tool", "Material"],
      "craftingSkill": "smithing",
      "icon": "icons/stations/anvil.png"
    },
    {
      "id": "workbench",
      "name": "Workbench",
      "description": "A well-worn workbench for crafting armor and leather goods. Various tools hang from hooks along its edge.",
      "supportedCategories": ["Armor", "Accessory"],
      "craftingSkill": "leatherworking",
      "icon": "icons/stations/workbench.png"
    },
    {
      "id": "alchemy-table",
      "name": "Alchemy Table",
      "description": "A table covered with bubbling vials and mysterious reagents. The air smells of herbs and sulfur.",
      "supportedCategories": ["Potion", "Consumable"],
      "craftingSkill": "alchemy",
      "icon": "icons/stations/alchemy_table.png"
    },
    {
      "id": "enchanting-altar",
      "name": "Enchanting Altar",
      "description": "A mystical altar inscribed with arcane runes. Faint magical energy pulses from its surface.",
      "supportedCategories": ["Accessory", "Weapon", "Armor"],
      "craftingSkill": "enchanting",
      "icon": "icons/stations/enchanting_altar.png"
    },
    {
      "id": "cooking-fire",
      "name": "Cooking Fire",
      "description": "A simple fire pit with a spit for cooking. Embers glow warmly beneath the grate.",
      "supportedCategories": ["Consumable"],
      "craftingSkill": "cooking",
      "icon": "icons/stations/cooking_fire.png"
    }
  ]
}
```

### 11.2 Configuration Properties

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `id` | string | Yes | Unique station identifier |
| `name` | string | Yes | Display name |
| `description` | string | Yes | Examination text |
| `supportedCategories` | string[] | Yes | Recipe categories (Weapon, Armor, etc.) |
| `craftingSkill` | string | Yes | Skill for crafting checks |
| `icon` | string | No | Path to station icon |

---

## 12. Logging Specifications

### 12.1 Log Levels by Component

| Component | Level | Events |
|-----------|-------|--------|
| `CraftingStationProvider` | Information | Configuration loaded (count) |
| `CraftingStationProvider` | Debug | Individual station loaded, categories |
| `CraftingStationProvider` | Warning | No stations loaded, category without stations |
| `CraftingStationProvider` | Error | Failed to load station from config |
| `RoomGenerationService` | Debug | Station spawned in room |
| `RoomGenerationService` | Warning | Cannot spawn unknown station |
| `ExamineCommand` | Debug | Examining crafting station |

### 12.2 Log Message Templates

```csharp
// CraftingStationProvider
_logger.LogInformation(
    "Loaded {Count} crafting station definitions",
    _stations.Count);

_logger.LogDebug(
    "Loaded crafting station: {StationId} ({Categories})",
    station.StationId,
    station.GetCategoriesDisplay());

_logger.LogWarning(
    "No crafting stations loaded from configuration");

_logger.LogDebug(
    "No crafting stations support category: {Category}",
    category);

_logger.LogError(
    ex,
    "Failed to load crafting station: {StationId}",
    config.Id);

// RoomGenerationService
_logger.LogDebug(
    "Spawned crafting station {StationId} in room {RoomId}",
    stationId,
    room.Id);

_logger.LogWarning(
    "Cannot spawn unknown crafting station: {StationId}",
    stationId);

// ExamineCommand
_logger.LogDebug(
    "Player {PlayerName} examining crafting station: {StationName}",
    player.Name,
    station.Name);
```

---

## 13. Unit Testing Requirements

### 13.1 Test Count by Feature

| Feature | Test Count |
|---------|------------|
| CraftingStationDefinition | ~3 |
| CraftingStation | ~2 |
| CraftingStationProvider | ~3 |
| Room Extensions | ~2 |
| **Total** | **~10** |

### 13.2 CraftingStationDefinitionTests

**File:** `tests/RuneAndRust.Tests/Domain/Definitions/CraftingStationDefinitionTests.cs`

```csharp
[TestFixture]
public class CraftingStationDefinitionTests
{
    [Test]
    public void Create_WithValidParameters_ReturnsDefinitionWithCorrectProperties()
    {
        // Arrange
        var stationId = "anvil";
        var name = "Anvil";
        var description = "A sturdy anvil";
        var categories = new[] { RecipeCategory.Weapon, RecipeCategory.Tool };
        var skillId = "smithing";

        // Act
        var definition = CraftingStationDefinition.Create(
            stationId,
            name,
            description,
            categories,
            skillId);

        // Assert
        Assert.Multiple(() =>
        {
            Assert.That(definition.StationId, Is.EqualTo("anvil"));
            Assert.That(definition.Name, Is.EqualTo("Anvil"));
            Assert.That(definition.CraftingSkillId, Is.EqualTo("smithing"));
            Assert.That(definition.SupportedCategories, Has.Count.EqualTo(2));
            Assert.That(definition.SupportedCategories, Contains.Item(RecipeCategory.Weapon));
            Assert.That(definition.SupportedCategories, Contains.Item(RecipeCategory.Tool));
        });
    }

    [Test]
    public void Create_WithEmptyCategories_ThrowsArgumentOutOfRangeException()
    {
        // Act & Assert
        Assert.Throws<ArgumentOutOfRangeException>(() =>
            CraftingStationDefinition.Create(
                "test",
                "Test Station",
                "Description",
                Array.Empty<RecipeCategory>(),
                "smithing"));
    }

    [Test]
    public void SupportsCategory_WithSupportedCategory_ReturnsTrue()
    {
        // Arrange
        var definition = CraftingStationDefinition.Create(
            "anvil",
            "Anvil",
            "Description",
            new[] { RecipeCategory.Weapon, RecipeCategory.Tool },
            "smithing");

        // Act & Assert
        Assert.Multiple(() =>
        {
            Assert.That(definition.SupportsCategory(RecipeCategory.Weapon), Is.True);
            Assert.That(definition.SupportsCategory(RecipeCategory.Tool), Is.True);
            Assert.That(definition.SupportsCategory(RecipeCategory.Potion), Is.False);
        });
    }

    [Test]
    public void CreateInstance_ReturnsValidCraftingStation()
    {
        // Arrange
        var definition = CraftingStationDefinition.Create(
            "anvil",
            "Anvil",
            "A sturdy anvil",
            new[] { RecipeCategory.Weapon },
            "smithing");

        // Act
        var station = definition.CreateInstance();

        // Assert
        Assert.Multiple(() =>
        {
            Assert.That(station, Is.Not.Null);
            Assert.That(station.DefinitionId, Is.EqualTo("anvil"));
            Assert.That(station.Name, Is.EqualTo("Anvil"));
            Assert.That(station.IsAvailable, Is.True);
        });
    }
}
```

### 13.3 CraftingStationTests

**File:** `tests/RuneAndRust.Tests/Domain/Entities/CraftingStationTests.cs`

```csharp
[TestFixture]
public class CraftingStationTests
{
    [Test]
    public void Create_FromDefinition_SetsCorrectProperties()
    {
        // Arrange
        var definition = CraftingStationDefinition.Create(
            "alchemy-table",
            "Alchemy Table",
            "For brewing potions",
            new[] { RecipeCategory.Potion },
            "alchemy");

        // Act
        var station = CraftingStation.Create(definition);

        // Assert
        Assert.Multiple(() =>
        {
            Assert.That(station.DefinitionId, Is.EqualTo("alchemy-table"));
            Assert.That(station.Name, Is.EqualTo("Alchemy Table"));
            Assert.That(station.Description, Is.EqualTo("For brewing potions"));
            Assert.That(station.FeatureType, Is.EqualTo(RoomFeatureType.CraftingStation));
            Assert.That(station.IsInteractable, Is.True);
            Assert.That(station.InteractionVerb, Is.EqualTo("use"));
            Assert.That(station.IsAvailable, Is.True);
        });
    }

    [Test]
    public void SetInUse_SetsIsAvailableToFalse()
    {
        // Arrange
        var definition = CraftingStationDefinition.Create(
            "anvil", "Anvil", "Desc",
            new[] { RecipeCategory.Weapon }, "smithing");
        var station = CraftingStation.Create(definition);

        // Act
        station.SetInUse();

        // Assert
        Assert.Multiple(() =>
        {
            Assert.That(station.IsAvailable, Is.False);
            Assert.That(station.LastUsedAt, Is.Not.Null);
        });
    }

    [Test]
    public void SetAvailable_RestoresAvailability()
    {
        // Arrange
        var definition = CraftingStationDefinition.Create(
            "anvil", "Anvil", "Desc",
            new[] { RecipeCategory.Weapon }, "smithing");
        var station = CraftingStation.Create(definition);
        station.SetInUse();

        // Act
        station.SetAvailable();

        // Assert
        Assert.That(station.IsAvailable, Is.True);
    }
}
```

### 13.4 CraftingStationProviderTests

**File:** `tests/RuneAndRust.Tests/Infrastructure/Providers/CraftingStationProviderTests.cs`

```csharp
[TestFixture]
public class CraftingStationProviderTests
{
    private CraftingStationProvider _provider;

    [SetUp]
    public void SetUp()
    {
        var settings = CreateTestSettings();
        _provider = new CraftingStationProvider(
            Options.Create(settings),
            Mock.Of<ILogger<CraftingStationProvider>>());
    }

    [Test]
    public void GetStation_WithValidId_ReturnsStation()
    {
        // Act
        var station = _provider.GetStation("anvil");

        // Assert
        Assert.That(station, Is.Not.Null);
        Assert.That(station!.StationId, Is.EqualTo("anvil"));
    }

    [Test]
    public void GetStation_WithInvalidId_ReturnsNull()
    {
        // Act
        var station = _provider.GetStation("nonexistent");

        // Assert
        Assert.That(station, Is.Null);
    }

    [Test]
    public void GetStationsForCategory_ReturnsMatchingStations()
    {
        // Act
        var weaponStations = _provider.GetStationsForCategory(RecipeCategory.Weapon);

        // Assert
        Assert.That(weaponStations, Is.Not.Empty);
        Assert.That(weaponStations.All(s => s.SupportsCategory(RecipeCategory.Weapon)), Is.True);
    }

    [Test]
    public void GetCraftingSkill_WithValidStation_ReturnsSkill()
    {
        // Act
        var skill = _provider.GetCraftingSkill("alchemy-table");

        // Assert
        Assert.That(skill, Is.EqualTo("alchemy"));
    }

    [Test]
    public void Exists_WithValidStation_ReturnsTrue()
    {
        // Act & Assert
        Assert.Multiple(() =>
        {
            Assert.That(_provider.Exists("anvil"), Is.True);
            Assert.That(_provider.Exists("ANVIL"), Is.True); // Case insensitive
            Assert.That(_provider.Exists("nonexistent"), Is.False);
        });
    }

    private static CraftingStationSettings CreateTestSettings()
    {
        return new CraftingStationSettings
        {
            Stations =
            [
                new CraftingStationConfig
                {
                    Id = "anvil",
                    Name = "Anvil",
                    Description = "A sturdy anvil",
                    SupportedCategories = ["Weapon", "Tool", "Material"],
                    CraftingSkill = "smithing"
                },
                new CraftingStationConfig
                {
                    Id = "alchemy-table",
                    Name = "Alchemy Table",
                    Description = "For brewing potions",
                    SupportedCategories = ["Potion", "Consumable"],
                    CraftingSkill = "alchemy"
                }
            ]
        };
    }
}
```

### 13.5 RoomExtensionsTests

**File:** `tests/RuneAndRust.Tests/Domain/Extensions/RoomExtensionsTests.cs`

```csharp
[TestFixture]
public class RoomExtensionsTests
{
    [Test]
    public void GetCraftingStations_WithStations_ReturnsStations()
    {
        // Arrange
        var room = Room.Create("test-room", "Test Room", "Description");
        var definition = CraftingStationDefinition.Create(
            "anvil", "Anvil", "Desc",
            new[] { RecipeCategory.Weapon }, "smithing");
        var station = CraftingStation.Create(definition);
        room.AddCraftingStation(station);

        // Act
        var stations = room.GetCraftingStations();

        // Assert
        Assert.That(stations, Has.Count.EqualTo(1));
        Assert.That(stations[0].DefinitionId, Is.EqualTo("anvil"));
    }

    [Test]
    public void HasCraftingStation_WithStation_ReturnsTrue()
    {
        // Arrange
        var room = Room.Create("test-room", "Test Room", "Description");
        var definition = CraftingStationDefinition.Create(
            "anvil", "Anvil", "Desc",
            new[] { RecipeCategory.Weapon }, "smithing");
        room.AddCraftingStation(CraftingStation.Create(definition));

        // Act & Assert
        Assert.That(room.HasCraftingStation(), Is.True);
    }

    [Test]
    public void GetAvailableCraftingStation_WhenStationInUse_ReturnsNull()
    {
        // Arrange
        var room = Room.Create("test-room", "Test Room", "Description");
        var definition = CraftingStationDefinition.Create(
            "anvil", "Anvil", "Desc",
            new[] { RecipeCategory.Weapon }, "smithing");
        var station = CraftingStation.Create(definition);
        station.SetInUse();
        room.AddCraftingStation(station);

        // Act
        var available = room.GetAvailableCraftingStation();

        // Assert
        Assert.That(available, Is.Null);
    }
}
```

---

## 14. Use Cases

### 14.1 UC-001: Enter Room with Crafting Station

**Actor:** Player
**Preconditions:** Room contains a crafting station
**Flow:**
1. Player enters room
2. System describes room with station feature
3. Player sees station in feature list
4. Station status (available/in use) is displayed

**Outcome:** Player aware of crafting station in room

```
    > go north
           â”‚
           â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  BLACKSMITH'S FORGE                                               â•‘
    â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
    â•‘                                                                   â•‘
    â•‘  The heat from the forge fills the room. Sparks fly as the       â•‘
    â•‘  blacksmith works at his craft.                                   â•‘
    â•‘                                                                   â•‘
    â•‘  FEATURES:                                                        â•‘
    â•‘  â””â”€ [Anvil] A sturdy anvil for smithing metal items              â•‘
    â•‘                                                                   â•‘
    â•‘  EXITS: North, South                                              â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 14.2 UC-002: Examine Crafting Station

**Actor:** Player
**Preconditions:** Player is in a room with a crafting station
**Flow:**
1. Player issues `examine anvil` command
2. System retrieves station definition
3. System displays station details including:
   - Description
   - Supported categories
   - Required skill
   - Current availability
4. System shows interaction prompt

**Outcome:** Player learns station capabilities

```
    > examine anvil
           â”‚
           â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  â•â•â• ANVIL â•â•â•                                                    â•‘
    â•‘                                                                   â•‘
    â•‘  A sturdy anvil for smithing metal items. The surface is         â•‘
    â•‘  scarred from countless hammerings but remains serviceable.      â•‘
    â•‘                                                                   â•‘
    â•‘  CRAFTING INFO:                                                   â•‘
    â•‘    Categories: Weapon, Tool, Material                             â•‘
    â•‘    Skill: Smithing                                                â•‘
    â•‘                                                                   â•‘
    â•‘  Status: The station is ready for use.                           â•‘
    â•‘                                                                   â•‘
    â•‘  Type 'craft <recipe>' to craft at this Anvil.                   â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 14.3 UC-003: Query Stations for Category

**Actor:** System
**Preconditions:** Crafting stations loaded from configuration
**Flow:**
1. System needs to find stations for a recipe category
2. System calls `GetStationsForCategory(category)`
3. Provider filters stations by supported categories
4. System receives list of compatible stations

**Outcome:** System knows which stations can craft the category

```
    GetStationsForCategory(RecipeCategory.Weapon)
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Filter stations where SupportedCategories contains Weapon      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Results:                                                        â”‚
    â”‚  â”œâ”€ Anvil (Weapon, Tool, Material)                              â”‚
    â”‚  â””â”€ Enchanting Altar (Accessory, Weapon, Armor)                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 14.4 UC-004: Spawn Station in Generated Room

**Actor:** System (Room Generation)
**Preconditions:** Room being generated needs a crafting station
**Flow:**
1. Room generator determines room type needs a station
2. System calls `SpawnCraftingStation(room, stationId)`
3. Provider retrieves station definition
4. System creates station instance from definition
5. Station added to room features

**Outcome:** Room generated with appropriate crafting station

```
    GenerateBlacksmithRoom()
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  1. Create Room("blacksmith-forge", "Blacksmith's Forge", ...)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  2. SpawnCraftingStation(room, "anvil")                         â”‚
    â”‚     â””â”€ GetStation("anvil") â†’ definition                         â”‚
    â”‚     â””â”€ definition.CreateInstance() â†’ station                    â”‚
    â”‚     â””â”€ room.AddCraftingStation(station)                         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  3. Room now has Anvil crafting station feature                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 14.5 UC-005: Check Station Availability

**Actor:** System (Crafting Service)
**Preconditions:** Player attempting to craft
**Flow:**
1. System gets current room from player
2. System calls `GetAvailableCraftingStation()`
3. If available station found, crafting proceeds
4. If no available station, crafting blocked with message

**Outcome:** System determines if crafting can proceed

```
    CanCraft(player, recipeId)
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  1. Get current room                                            â”‚
    â”‚     room = sessionService.GetCurrentRoom(player)                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  2. Check for available station                                 â”‚
    â”‚     station = room.GetAvailableCraftingStation()                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
     â”‚           â”‚
  Station     No Station
  Found       Available
     â”‚           â”‚
     â–¼           â–¼
  Continue    Return Error:
  to next     "You need to be at
  validation   a crafting station."
```

---

## 15. Deliverable Checklist

### Domain Layer

- [ ] `CraftingStationDefinition` entity in `Domain/Definitions/`
- [ ] `CraftingStation` entity in `Domain/Entities/`
- [ ] `RoomFeatureType.CraftingStation` enum value
- [ ] `RoomExtensions` for station queries

### Application Layer

- [ ] `ICraftingStationProvider` interface
- [ ] Room service station integration

### Infrastructure Layer

- [ ] `CraftingStationProvider` implementation
- [ ] `CraftingStationSettings` configuration class
- [ ] `CraftingStationConfig` configuration class

### Presentation Layer

- [ ] `ExamineCommand` station handling extension

### Configuration Files

- [ ] `config/crafting-stations.json` created
- [ ] `config/schemas/crafting-stations.schema.json` created
- [ ] Schema validates against configuration
- [ ] 5 station types defined (anvil, workbench, alchemy-table, enchanting-altar, cooking-fire)

### Testing

- [ ] `CraftingStationDefinitionTests` (~3 tests)
- [ ] `CraftingStationTests` (~2 tests)
- [ ] `CraftingStationProviderTests` (~3 tests)
- [ ] `RoomExtensionsTests` (~2 tests)
- [ ] All ~10 unit tests passing

---

## 16. Acceptance Criteria

### Functional

- [ ] CraftingStationDefinition loads from JSON configuration
- [ ] CraftingStationDefinition stores supported recipe categories
- [ ] CraftingStationDefinition links to crafting skill
- [ ] CraftingStation creates from definition
- [ ] CraftingStation tracks availability state
- [ ] SetInUse() marks station as unavailable
- [ ] SetAvailable() restores station availability
- [ ] GetStationsForCategory() filters correctly
- [ ] GetCraftingSkill() returns correct skill
- [ ] Exists() checks case-insensitively
- [ ] Room extension methods work correctly
- [ ] Examining station shows crafting info
- [ ] Station spawning in rooms works

### Quality

- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] All ~10 unit tests pass
- [ ] Configuration files validate against schemas
- [ ] XML documentation complete for all public types
- [ ] Logging follows established patterns

### Configuration

- [ ] 5 station types defined
- [ ] All 7 recipe categories covered by at least one station
- [ ] Station icons referenced (paths only)

---

## 17. Dependencies

### 17.1 Required from v0.11.1

| Type | Location | Usage |
|------|----------|-------|
| `RecipeCategory` | `Domain/Enums/RecipeCategory.cs` | Category filtering |
| `RecipeDefinition` | `Domain/Definitions/RecipeDefinition.cs` | Recipe compatibility |

### 17.2 Required from Prior Versions

| Type | Location | Usage |
|------|----------|-------|
| `Room` | `Domain/Entities/Room.cs` | Station placement |
| `RoomFeature` | `Domain/Entities/RoomFeature.cs` | Base class for CraftingStation |
| `IEntity` | `Domain/Common/IEntity.cs` | Entity interface |
| `ExamineCommand` | `Presentation/Commands/ExamineCommand.cs` | Station examination |

### 17.3 Provides to v0.11.2b

| Type | Usage |
|------|-------|
| `CraftingStationDefinition` | Station validation for crafting |
| `CraftingStation` | Room feature for crafting location |
| `ICraftingStationProvider` | Station lookups during crafting |
| Room extensions | Finding stations in current room |

---

## 18. Future Considerations

### Deferred to v0.11.2b (Crafting Service)

- **Actual Crafting**: Using stations to craft items
- **Dice Checks**: Rolling against recipe DC
- **Resource Consumption**: Removing ingredients
- **Item Creation**: Creating crafted items

### Deferred to v0.11.2c (Quality System)

- **Quality Tiers**: Standard, Fine, Masterwork, Legendary
- **Roll Margin Effects**: Better rolls = better quality
- **Quality Stat Bonuses**: Enhanced item stats

### Deferred to Later Versions

- **Station Upgrades**: Improving station quality
- **Station Durability**: Wear and repair mechanics
- **Station Ownership**: Player-owned stations
- **Portable Stations**: Stations that can be carried
- **Station Animations**: Visual effects during crafting

### Out of Scope

- **Multiplayer Stations**: Shared station access
- **Station Minigames**: Interactive crafting gameplay
- **Station NPCs**: NPCs that use stations

---

*Document Version: 1.0*
*Last Updated: 2025-01-16*
*Author: Claude (AI Assistant)*
