# v0.19.2 Svartalfheim & Helheim Implementation - Scope Breakdown

**Version:** 0.19.2
**Theme:** Svartalfheim & Helheim (The Dvergr Forges & The Gangrenous Gut)
**Prerequisites:** v0.19.1 (Midgard Implementation)
**Total Estimated Tests:** ~24 new tests

---

## Executive Summary

v0.19.2 implements two interconnected realms: Svartalfheim (manufacturing) and Helheim (waste reclamation). These realms share a unique connection through Garm's Watch. This version introduces TotalDarkness and ToxicAtmosphere environmental mechanics.

| Phase    | Name                   | Focus                                                | Est. Tests |
| -------- | ---------------------- | ---------------------------------------------------- | ---------- |
| v0.19.2a | Svartalfheim & Helheim | Both realm definitions, zones, hazards, Garm's Watch | ~24        |

---

## Feature Analysis & Categorization

| Feature                      | Complexity | Dependencies           | Assigned Phase |
| ---------------------------- | ---------- | ---------------------- | -------------- |
| Svartalfheim BiomeDefinition | Medium     | BiomeDefinition entity | **v0.19.2a**   |
| Helheim BiomeDefinition      | Medium     | BiomeDefinition entity | **v0.19.2a**   |
| TotalDarkness Mechanics      | High       | EnvironmentalCondition | **v0.19.2a**   |
| ToxicAtmosphere Mechanics    | High       | EnvironmentalCondition | **v0.19.2a**   |
| Garm's Watch Zone            | High       | BiomeZone, both realms | **v0.19.2a**   |

---

## Phase Definitions

## v0.19.2a: Svartalfheim & Helheim Implementation

### Scope

**In Scope:**

- Svartalfheim `BiomeDefinition` (Deck 06 — Manufacturing)
- Helheim `BiomeDefinition` (Deck 09 — Waste Reclamation)
- Svartalfheim zones: The Bright Halls, The Black Veins, Forge Core
- Helheim zones: Upper Bile, The Dissolution Pits, Garm's Watch
- TotalDarkness environmental condition
- ToxicAtmosphere environmental condition
- Garm's Watch as shared transition zone

**Out of Scope:**

- Other realm implementations (v0.19.3+)
- Light source item mechanics
- Hallucination effect implementation

### Key Deliverables

| Type                     | Count | Details                         |
| ------------------------ | ----- | ------------------------------- |
| Configuration            | 2     | svartalfheim.json, helheim.json |
| BiomeDefinitions         | 2     | Svartalfheim, Helheim           |
| Zone Definitions         | 6     | 3 per realm                     |
| Environmental Conditions | 2     | TotalDarkness, ToxicAtmosphere  |
| Unit Tests               | ~24   |                                 |

### Acceptance Criteria

- [ ] Svartalfheim BiomeDefinition loads with all properties
- [ ] Helheim BiomeDefinition loads with all properties
- [ ] The Black Veins zone returns TotalDarkness DC 16
- [ ] The Dissolution Pits zone returns ToxicAtmosphere DC 20
- [ ] Garm's Watch zone has no active environmental hazard
- [ ] Forge Core zone returns IntenseHeat DC 12
- [ ] ~24 unit tests pass

---

## Realm Specifications

### Svartalfheim — Deck 06: The Dvergr Forges

| Property           | Value         |
| ------------------ | ------------- |
| Temperature        | 25°C          |
| Aetheric Intensity | 0.4           |
| Humidity           | 30%           |
| Light Level        | 0.3           |
| Scale Factor       | 0.9           |
| Corrosion Rate     | 0.1           |
| Primary Condition  | TotalDarkness |
| Vertical Range     | Z: -2 to 0    |

**Zones:**

- **The Bright Halls** — Trade halls, Light: 0.6, No hazard
- **The Black Veins** — Mining tunnels, Light: 0.0, TotalDarkness DC 16
- **Forge Core** — Sacred forges, Temp: 45°C, IntenseHeat DC 12

### Helheim — Deck 09: The Gangrenous Gut

| Property           | Value           |
| ------------------ | --------------- |
| Temperature        | 28°C            |
| Aetheric Intensity | 0.2             |
| Humidity           | 90%             |
| Light Level        | 0.4             |
| Scale Factor       | 1.0             |
| Corrosion Rate     | 0.8             |
| Primary Condition  | ToxicAtmosphere |
| Vertical Range     | Z: -3 to -1     |

**Zones:**

- **Upper Bile** — Surface processing, ToxicAtmosphere DC 12
- **The Dissolution Pits** — Active recycling, ToxicAtmosphere DC 20, 3d8 damage
- **Garm's Watch** — Fortified checkpoint, shared zone, no hazard

---

## Dependencies & Prerequisites

```
v0.19.1 (Midgard) - REQUIRED
    │
    └── Baseline realm implementation pattern
            │
            ▼
v0.19.0 (Core Infrastructure) - REQUIRED
    │
    ├── RealmId.Svartalfheim, RealmId.Helheim
    ├── EnvironmentalConditionType.TotalDarkness
    ├── EnvironmentalConditionType.ToxicAtmosphere
    └── BiomeDefinition, BiomeZone entities
            │
            ▼
v0.19.2 (Svartalfheim & Helheim)
```

---

## Risk Assessment

| Risk                                   | Impact | Probability | Mitigation                           |
| -------------------------------------- | ------ | ----------- | ------------------------------------ |
| TotalDarkness vision mechanics complex | Medium | Medium      | Defer vision system to v0.20.x       |
| ToxicAtmosphere hallucination effects  | Medium | Medium      | Defer to Status Effect system        |
| Garm's Watch dual-realm assignment     | Low    | Low         | Administrative assignment to Helheim |

---

## Design Decisions (Confirmed)

| Decision                  | Value   | Notes                           |
| ------------------------- | ------- | ------------------------------- |
| Svartalfheim scale factor | 0.9     | Slightly smaller Dvergr tunnels |
| Helheim corrosion rate    | 0.8     | Extreme equipment damage        |
| Black Veins DC            | 16      | Base 12 + 4 modifier            |
| Dissolution Pits DC       | 20      | Base 14 + 6 modifier            |
| Garm's Watch admin        | Helheim | Shared with Svartalfheim flag   |

---

## Unit Testing Requirements (~24 tests)

### Svartalfheim Tests (~8)

- GetBiome returns valid definition
- Base properties correct (Temp=25, Light=0.3, Scale=0.9)
- Three zones returned
- Black Veins has TotalDarkness DC 16
- Forge Core has IntenseHeat DC 12

### Helheim Tests (~8)

- GetBiome returns valid definition
- Base properties correct (Temp=28, Corrosion=0.8)
- Three zones returned
- Dissolution Pits has ToxicAtmosphere DC 20
- Dissolution Pits damage override = "3d8"

### Garm's Watch Tests (~4)

- No environmental condition
- SharedWith = Svartalfheim
- Reduced corrosion rate

### Environmental Condition Tests (~4)

- TotalDarkness base DC = 12
- ToxicAtmosphere base DC = 14
- Mitigation reduces effects

---

## Architecture Diagram

```
┌─────────────────────────────────────────────────────────────────┐
│              v0.19.2 Svartalfheim & Helheim                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌──────────────────────┐    ┌──────────────────────┐          │
│  │    SVARTALFHEIM      │    │       HELHEIM        │          │
│  │    (Deck 06)         │    │      (Deck 09)       │          │
│  │                      │    │                      │          │
│  │  • Bright Halls      │    │  • Upper Bile        │          │
│  │  • Black Veins DC16  │    │  • Dissolution DC20  │          │
│  │  • Forge Core DC12   │    │                      │          │
│  │                      │    │                      │          │
│  └──────────┬───────────┘    └──────────┬───────────┘          │
│             └─────────┐     ┌───────────┘                       │
│                       ▼     ▼                                    │
│             ┌──────────────────────┐                            │
│             │    GARM'S WATCH      │                            │
│             │  (Shared Checkpoint) │                            │
│             └──────────────────────┘                            │
└─────────────────────────────────────────────────────────────────┘
```

---

## Deliverable Checklist

### Configuration

- [ ] `svartalfheim.json` complete with all zones
- [ ] `helheim.json` complete with all zones
- [ ] Garm's Watch zone (shared, no hazard)
- [ ] JSON validates against biomes.schema.json

### Tests

- [ ] Svartalfheim tests (~8)
- [ ] Helheim tests (~8)
- [ ] Garm's Watch tests (~4)
- [ ] Environmental condition tests (~4)

---

_This scope breakdown provides a structured approach to implementing v0.19.2 Svartalfheim & Helheim._
