# v0.14.5c Design Specification: Crafting Recipe Schema

**Version:** 0.14.5c
**Parent:** v0.14.5 (Economy Configuration Schemas)
**Prerequisites:** v0.14.4 Complete (Environment Configuration Schemas)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Recipe Schema Root Definition](#4-recipe-schema-root-definition)
   - 4.1 [Root Configuration Properties](#41-root-configuration-properties)
   - 4.2 [RecipeDefinition Schema](#42-recipedefinition-schema)
5. [Recipe Identity and Display](#5-recipe-identity-and-display)
   - 5.1 [Recipe Identification](#51-recipe-identification)
   - 5.2 [Recipe Categories](#52-recipe-categories)
   - 5.3 [Display Properties](#53-display-properties)
6. [Material Requirements Configuration](#6-material-requirements-configuration)
   - 6.1 [MaterialRequirement Definition](#61-materialrequirement-definition)
   - 6.2 [Consumed vs Non-Consumed Materials](#62-consumed-vs-non-consumed-materials)
   - 6.3 [Material Examples](#63-material-examples)
7. [Skill Requirements Configuration](#7-skill-requirements-configuration)
   - 7.1 [SkillRequirement Definition](#71-skillrequirement-definition)
   - 7.2 [Skill Check Mechanics](#72-skill-check-mechanics)
   - 7.3 [Minimum Level vs DC](#73-minimum-level-vs-dc)
8. [Output Configuration](#8-output-configuration)
   - 8.1 [OutputDefinition Schema](#81-outputdefinition-schema)
   - 8.2 [QuantityRange Definition](#82-quantityrange-definition)
   - 8.3 [QualityVariance Definition](#83-qualityvariance-definition)
   - 8.4 [BonusOutput Definition](#84-bonusoutput-definition)
9. [Crafting Conditions](#9-crafting-conditions)
   - 9.1 [Station Requirements](#91-station-requirements)
   - 9.2 [Crafting Time](#92-crafting-time)
   - 9.3 [Failure Mechanics](#93-failure-mechanics)
10. [Discovery Configuration](#10-discovery-configuration)
    - 10.1 [DiscoveryCondition Definition](#101-discoverycondition-definition)
    - 10.2 [Discovery Types](#102-discovery-types)
    - 10.3 [Known By Default Flag](#103-known-by-default-flag)
11. [Validation Rules](#11-validation-rules)
    - 11.1 [ID Pattern Validation](#111-id-pattern-validation)
    - 11.2 [Range Validation](#112-range-validation)
    - 11.3 [Required Fields](#113-required-fields)
    - 11.4 [Enum Validation](#114-enum-validation)
12. [Configuration Schema](#12-configuration-schema)
13. [Configuration File](#13-configuration-file)
14. [Data Model Changes](#14-data-model-changes)
15. [Logging Specifications](#15-logging-specifications)
16. [Unit Testing Requirements](#16-unit-testing-requirements)
17. [Use Cases](#17-use-cases)
18. [Deliverable Checklist](#18-deliverable-checklist)
19. [Acceptance Criteria](#19-acceptance-criteria)
20. [Dependencies](#20-dependencies)
21. [Future Considerations](#21-future-considerations)

---

## 1. Executive Summary

Version 0.14.5c introduces the **Crafting Recipe Schema** (`recipes.schema.json`), which validates crafting recipe definitions including material requirements, skill checks, output items, station requirements, and discovery conditions. This schema enables full customization of crafting systems without code changes, supporting modding scenarios such as alchemical brewing systems, blacksmithing progression, magical enchanting, or survival-style cooking mechanics.

The Crafting Recipe Schema creates both a new schema file and a new `recipes.json` configuration file with example recipes. This version establishes patterns for item transformation and resource consumption that will be referenced by future gameplay systems.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Schema Files** | `recipes.schema.json` |
| **Schema Definitions** | `RecipeDefinition`, `MaterialRequirement`, `SkillRequirement`, `OutputDefinition`, `QuantityRange`, `QualityVariance`, `BonusOutput`, `DiscoveryCondition` |
| **Configuration Files** | Create new `recipes.json` with example recipes |
| **Tests** | ~6 new unit tests |

### Architectural Significance

This version provides:
- **Material requirement validation** - Item references with quantities and consumption flags
- **Skill check validation** - DC-based or minimum level requirements
- **Output definition validation** - Quantity ranges with quality variance
- **Discovery condition validation** - Multiple paths to learn recipes
- **Station requirement validation** - Crafting location restrictions
- **Failure mechanics validation** - Failure chance and alternative outputs

### Relationship to Other Schemas

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                  v0.14.5 ECONOMY CONFIGURATION SCHEMAS                       │
└─────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────────────┐
  │  v0.14.5a: currency.schema.json                                         │
  │  v0.14.5b: resources.schema.json                                        │
  │  v0.14.5c: recipes.schema.json ◀── THIS VERSION                         │
  │  v0.14.5d: vendors.schema.json                                          │
  └─────────────────────────────────────────────────────────────────────────┘

  Cross-references:
  • recipes.json → materials[].itemId references items.json
  • recipes.json → skillRequirements[].skillId references skills.json
  • recipes.json → output.itemId references items.json
  • recipes.json → stationRequired references interactive-objects.json
  • vendors.json → may reference recipe scrolls (v0.14.5d)

  Shared definitions:
  • ID pattern: ^[a-z][a-z0-9-]*$ (lowercase kebab-case)
  • Schema location: config/schemas/
  • Recipes structure: Array of recipe definitions
```

---

## 2. Feature Overview

```
v0.14.5c Crafting Recipe Schema Features
├── recipes.schema.json
│   ├── Root Configuration Properties
│   │   ├── $schema (string, optional)
│   │   ├── version (string, optional)
│   │   └── recipes (array of RecipeDefinition, required)
│   └── Definitions
│       ├── RecipeDefinition
│       │   ├── id (string, kebab-case pattern, required)
│       │   ├── name (string, minLength: 1, required)
│       │   ├── description (string, required)
│       │   ├── category (enum: 9 categories, required)
│       │   ├── materials (array of MaterialRequirement, minItems: 1, required)
│       │   ├── skillRequirements (array of SkillRequirement, optional)
│       │   ├── output (OutputDefinition, required)
│       │   ├── stationRequired (string, optional)
│       │   ├── craftingTime (integer, optional)
│       │   ├── discoveryCondition (DiscoveryCondition, optional)
│       │   ├── isKnownByDefault (boolean, default: false)
│       │   ├── failureChance (number, 0-1, default: 0)
│       │   ├── failureOutput (OutputDefinition, optional)
│       │   ├── experienceReward (integer, optional)
│       │   └── sortOrder (integer, minimum: 0, optional)
│       ├── MaterialRequirement
│       │   ├── itemId (string, required)
│       │   ├── quantity (integer, minimum: 1, default: 1)
│       │   └── isConsumed (boolean, default: true)
│       ├── SkillRequirement
│       │   ├── skillId (string, required)
│       │   ├── minimumLevel (integer, optional)
│       │   └── dc (integer, optional)
│       ├── OutputDefinition
│       │   ├── itemId (string, required)
│       │   ├── quantity (QuantityRange, required)
│       │   ├── qualityVariance (QualityVariance, optional)
│       │   └── bonusOutputs (array of BonusOutput, optional)
│       ├── QuantityRange
│       │   ├── min (integer, minimum: 1, default: 1)
│       │   └── max (integer, minimum: 1, default: 1)
│       ├── QualityVariance
│       │   ├── baseQuality (enum: 5 quality tiers, required)
│       │   ├── upgradeChance (number, 0-1, optional)
│       │   └── criticalUpgradeChance (number, 0-1, optional)
│       ├── BonusOutput
│       │   ├── itemId (string, required)
│       │   ├── quantity (integer, minimum: 1, required)
│       │   └── chance (number, 0-1, required)
│       └── DiscoveryCondition
│           ├── type (enum: 6 discovery types, required)
│           ├── questId (string, optional)
│           ├── requiredLevel (integer, optional)
│           ├── teacherNpcId (string, optional)
│           ├── itemId (string, optional)
│           └── locationId (string, optional)
├── Validation Rules
│   ├── Recipe ID Pattern Validation (kebab-case)
│   ├── Category Enum Validation (9 categories)
│   ├── Materials Array Validation (minItems: 1)
│   ├── Quantity Range Validation (min >= 1, max >= min)
│   ├── Quality Tier Enum Validation (5 tiers)
│   ├── Discovery Type Enum Validation (6 types)
│   ├── Failure Chance Range Validation (0-1)
│   └── Required Fields Enforced
└── Configuration Files
    ├── recipes.schema.json created in config/schemas/
    └── recipes.json created with example recipes
```

---

## 3. Architecture Diagrams

### 3.1 Recipe Definition Structure Overview

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        RECIPE DEFINITION STRUCTURE                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                       RECIPE DEFINITION                              │    │
│  │                                                                      │    │
│  │  id: "health-potion-basic"                                           │    │
│  │  name: "Basic Health Potion"                                         │    │
│  │  description: "A simple restorative elixir..."                       │    │
│  │  category: "Alchemy"                                                 │    │
│  │                                                                      │    │
│  │  ┌───────────────────────────────────────────────────────────────┐  │    │
│  │  │  MATERIAL REQUIREMENTS                                         │  │    │
│  │  │  ┌─────────────────────────────────────────────────────────┐  │  │    │
│  │  │  │ materials: [                                            │  │  │    │
│  │  │  │   { itemId: "herb-bloodmoss", quantity: 2, consumed: true }│ │    │
│  │  │  │   { itemId: "vial-empty", quantity: 1, consumed: true }  │  │  │    │
│  │  │  │   { itemId: "tool-mortar-pestle", quantity: 1, consumed: false }│ │ │
│  │  │  │ ]                                                       │  │  │    │
│  │  │  └─────────────────────────────────────────────────────────┘  │  │    │
│  │  └───────────────────────────────────────────────────────────────┘  │    │
│  │                                                                      │    │
│  │  ┌───────────────────────────────────────────────────────────────┐  │    │
│  │  │  SKILL REQUIREMENTS (optional)                                 │  │    │
│  │  │  ┌─────────────────────────────────────────────────────────┐  │  │    │
│  │  │  │ skillRequirements: [                                    │  │  │    │
│  │  │  │   { skillId: "alchemy", minimumLevel: 1 }               │  │  │    │
│  │  │  │ ]                                                       │  │  │    │
│  │  │  └─────────────────────────────────────────────────────────┘  │  │    │
│  │  └───────────────────────────────────────────────────────────────┘  │    │
│  │                                                                      │    │
│  │  ┌───────────────────────────────────────────────────────────────┐  │    │
│  │  │  OUTPUT DEFINITION                                             │  │    │
│  │  │  ┌─────────────────────────────────────────────────────────┐  │  │    │
│  │  │  │ output: {                                               │  │  │    │
│  │  │  │   itemId: "potion-health-basic",                        │  │  │    │
│  │  │  │   quantity: { min: 1, max: 1 },                         │  │  │    │
│  │  │  │   qualityVariance: {                                    │  │  │    │
│  │  │  │     baseQuality: "Common",                              │  │  │    │
│  │  │  │     upgradeChance: 0.1                                  │  │  │    │
│  │  │  │   }                                                     │  │  │    │
│  │  │  │ }                                                       │  │  │    │
│  │  │  └─────────────────────────────────────────────────────────┘  │  │    │
│  │  └───────────────────────────────────────────────────────────────┘  │    │
│  │                                                                      │    │
│  │  ┌───────────────────────────────────────────────────────────────┐  │    │
│  │  │  CRAFTING CONDITIONS                                           │  │    │
│  │  │  ┌─────────────────────────────────────────────────────────┐  │  │    │
│  │  │  │ stationRequired: "alchemy-table"                        │  │  │    │
│  │  │  │ craftingTime: 2        (turns to complete)              │  │  │    │
│  │  │  │ failureChance: 0.1     (10% chance to fail)             │  │  │    │
│  │  │  │ failureOutput: { itemId: "residue-alchemical", ... }    │  │  │    │
│  │  │  └─────────────────────────────────────────────────────────┘  │  │    │
│  │  └───────────────────────────────────────────────────────────────┘  │    │
│  │                                                                      │    │
│  │  ┌───────────────────────────────────────────────────────────────┐  │    │
│  │  │  DISCOVERY & KNOWLEDGE                                         │  │    │
│  │  │  ┌─────────────────────────────────────────────────────────┐  │  │    │
│  │  │  │ isKnownByDefault: false                                 │  │  │    │
│  │  │  │ discoveryCondition: {                                   │  │  │    │
│  │  │  │   type: "Teacher",                                      │  │  │    │
│  │  │  │   teacherNpcId: "alchemist-master"                      │  │  │    │
│  │  │  │ }                                                       │  │  │    │
│  │  │  │ experienceReward: 10   (crafting XP gained)             │  │  │    │
│  │  │  └─────────────────────────────────────────────────────────┘  │  │    │
│  │  └───────────────────────────────────────────────────────────────┘  │    │
│  │                                                                      │    │
│  │  sortOrder: 0                                                        │    │
│  │                                                                      │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 Schema Validation Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         SCHEMA VALIDATION FLOW                               │
└─────────────────────────────────────────────────────────────────────────────┘

    User edits recipes.json
           │
           ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                          IDE/EDITOR                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│  1. Reads $schema property from config file                                  │
│  2. Loads recipes.schema.json from config/schemas/                           │
│  3. Validates content against schema                                         │
└─────────────────────────────────────────────────────────────────────────────┘
           │
           ├─── Valid ───▶ Green checkmark, autocomplete works
           │
           └─── Invalid ─▶ Error underlines with messages:
                           • "category must be one of: Alchemy, Smithing, ..."
                           • "materials must have at least 1 item"
                           • "failureChance must be between 0 and 1"
                           • "baseQuality must be one of: Common, Uncommon, ..."
```

### 3.3 Recipe Category System

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        RECIPE CATEGORY SYSTEM                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                        │ │
│  │  CATEGORY           │ TYPICAL OUTPUTS           │ TYPICAL STATIONS     │ │
│  │  ──────────────────┼───────────────────────────┼───────────────────── │ │
│  │                                                                        │ │
│  │  Alchemy            │ Potions, Elixirs, Oils    │ Alchemy Table        │ │
│  │  ├── Health Potion                                                     │ │
│  │  ├── Mana Elixir                                                       │ │
│  │  └── Poison Coating                                                    │ │
│  │                                                                        │ │
│  │  Smithing           │ Weapons, Armor, Tools     │ Forge, Anvil         │ │
│  │  ├── Iron Sword                                                        │ │
│  │  ├── Steel Plate                                                       │ │
│  │  └── Mining Pick                                                       │ │
│  │                                                                        │ │
│  │  Enchanting         │ Magical Items, Scrolls    │ Enchanting Table     │ │
│  │  ├── +1 Fire Damage                                                    │ │
│  │  ├── Glyph of Warding                                                  │ │
│  │  └── Soul Gem Binding                                                  │ │
│  │                                                                        │ │
│  │  Cooking            │ Food, Buffs, Rations      │ Campfire, Kitchen    │ │
│  │  ├── Grilled Meat                                                      │ │
│  │  ├── Hearty Stew                                                       │ │
│  │  └── Traveler's Rations                                                │ │
│  │                                                                        │ │
│  │  Leatherworking     │ Leather Armor, Bags       │ Tanning Rack         │ │
│  │  ├── Leather Armor                                                     │ │
│  │  ├── Traveling Pack                                                    │ │
│  │  └── Quiver                                                            │ │
│  │                                                                        │ │
│  │  Tailoring          │ Cloth Armor, Cloaks       │ Loom                 │ │
│  │  ├── Mage Robes                                                        │ │
│  │  ├── Silk Cloak                                                        │ │
│  │  └── Enchanted Bandages                                                │ │
│  │                                                                        │ │
│  │  Jewelcrafting      │ Rings, Amulets, Gems      │ Jeweler's Bench      │ │
│  │  ├── Silver Ring                                                       │ │
│  │  ├── Ruby Amulet                                                       │ │
│  │  └── Cut Diamond                                                       │ │
│  │                                                                        │ │
│  │  Engineering        │ Gadgets, Traps, Devices   │ Workbench            │ │
│  │  ├── Mechanical Trap                                                   │ │
│  │  ├── Grappling Hook                                                    │ │
│  │  └── Clockwork Companion                                               │ │
│  │                                                                        │ │
│  │  Inscription        │ Scrolls, Glyphs, Tomes    │ Scribe's Desk        │ │
│  │  ├── Scroll of Fireball                                                │ │
│  │  ├── Runic Inscription                                                 │ │
│  │  └── Spellbook Page                                                    │ │
│  │                                                                        │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 Quality Variance System

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        QUALITY VARIANCE SYSTEM                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  QUALITY TIERS                                                               │
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                        │ │
│  │  Tier         │ Color   │ Stat Bonus │ Rarity                          │ │
│  │  ─────────────┼─────────┼────────────┼──────────────────────────────── │ │
│  │  Common       │ White   │ +0%        │ Standard crafting result        │ │
│  │  Uncommon     │ Green   │ +10%       │ Good crafting roll              │ │
│  │  Rare         │ Blue    │ +25%       │ Excellent crafting              │ │
│  │  Epic         │ Purple  │ +50%       │ Near-perfect crafting           │ │
│  │  Legendary    │ Orange  │ +100%      │ Masterwork crafting             │ │
│  │                                                                        │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│  QUALITY UPGRADE FLOW                                                        │
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                        │ │
│  │  Craft Attempt                                                         │ │
│  │        │                                                               │ │
│  │        ▼                                                               │ │
│  │  ┌─────────────────────────────────────────────────────────────────┐  │ │
│  │  │  Roll for Critical Upgrade (criticalUpgradeChance)              │  │ │
│  │  └─────────────────────────────────────────────────────────────────┘  │ │
│  │        │                                                               │ │
│  │        ├── Success ──▶ Upgrade quality by 2 tiers (max Legendary)     │ │
│  │        │                                                               │ │
│  │        └── Failure                                                     │ │
│  │              │                                                         │ │
│  │              ▼                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────┐  │ │
│  │  │  Roll for Standard Upgrade (upgradeChance)                      │  │ │
│  │  └─────────────────────────────────────────────────────────────────┘  │ │
│  │              │                                                         │ │
│  │              ├── Success ──▶ Upgrade quality by 1 tier               │ │
│  │              │                                                         │ │
│  │              └── Failure ──▶ Base quality (as configured)            │ │
│  │                                                                        │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│  EXAMPLE CONFIGURATION                                                       │
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                        │ │
│  │  "qualityVariance": {                                                  │ │
│  │      "baseQuality": "Common",                                          │ │
│  │      "upgradeChance": 0.15,            // 15% chance for +1 tier       │ │
│  │      "criticalUpgradeChance": 0.02     // 2% chance for +2 tiers       │ │
│  │  }                                                                     │ │
│  │                                                                        │ │
│  │  Possible Outcomes:                                                    │ │
│  │  • 83% → Common (base)                                                 │ │
│  │  • 15% → Uncommon (upgrade)                                            │ │
│  │  • 2%  → Rare (critical upgrade)                                       │ │
│  │                                                                        │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.5 Discovery Condition System

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       DISCOVERY CONDITION SYSTEM                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  DISCOVERY TYPES                                                             │
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                        │ │
│  │  Type         │ Trigger                    │ Example                   │ │
│  │  ─────────────┼────────────────────────────┼───────────────────────── │ │
│  │                                                                        │ │
│  │  Default      │ Known from game start      │ Basic Torch recipe        │ │
│  │               │ (use isKnownByDefault)     │                           │ │
│  │                                                                        │ │
│  │  Quest        │ Complete specific quest    │ "Alchemist's Secret"      │ │
│  │               │ (questId required)         │ quest rewards recipe      │ │
│  │                                                                        │ │
│  │  Level        │ Reach character level      │ Iron Sword at level 5     │ │
│  │               │ (requiredLevel required)   │                           │ │
│  │                                                                        │ │
│  │  Teacher      │ Purchase from NPC trainer  │ Master Smith teaches      │ │
│  │               │ (teacherNpcId required)    │ Steel Plate recipe        │ │
│  │                                                                        │ │
│  │  Item         │ Find recipe scroll/book    │ "Recipe: Health Potion"   │ │
│  │               │ (itemId required)          │ consumable item           │ │
│  │                                                                        │ │
│  │  Exploration  │ Discover in location       │ Ancient recipe found      │ │
│  │               │ (locationId required)      │ in Forgotten Ruins        │ │
│  │                                                                        │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│  DISCOVERY FLOW EXAMPLES                                                     │
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                        │ │
│  │  QUEST DISCOVERY                                                       │ │
│  │  ─────────────────                                                     │ │
│  │                                                                        │ │
│  │  ┌──────────────┐    ┌──────────────┐    ┌──────────────────────────┐ │ │
│  │  │ Accept Quest │ ─▶ │ Complete     │ ─▶ │ Recipe Added to          │ │ │
│  │  │ "Herb Lore"  │    │ Objectives   │    │ Known Recipes            │ │ │
│  │  └──────────────┘    └──────────────┘    └──────────────────────────┘ │ │
│  │                                                                        │ │
│  │  TEACHER DISCOVERY                                                     │ │
│  │  ──────────────────                                                    │ │
│  │                                                                        │ │
│  │  ┌──────────────┐    ┌──────────────┐    ┌──────────────────────────┐ │ │
│  │  │ Visit NPC    │ ─▶ │ Pay Gold or  │ ─▶ │ Recipe Added to          │ │ │
│  │  │ Trainer      │    │ Complete Task│    │ Known Recipes            │ │ │
│  │  └──────────────┘    └──────────────┘    └──────────────────────────┘ │ │
│  │                                                                        │ │
│  │  ITEM DISCOVERY                                                        │ │
│  │  ───────────────                                                       │ │
│  │                                                                        │ │
│  │  ┌──────────────┐    ┌──────────────┐    ┌──────────────────────────┐ │ │
│  │  │ Find Recipe  │ ─▶ │ Use/Read     │ ─▶ │ Recipe Added to          │ │ │
│  │  │ Scroll       │    │ Item         │    │ Known Recipes            │ │ │
│  │  └──────────────┘    └──────────────┘    └──────────────────────────┘ │ │
│  │                                                                        │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.6 Crafting Flow Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           CRAFTING FLOW                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Player Initiates Crafting                                                   │
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │  CHECK: Recipe Known?                                                   ││
│  │  • Is recipe in player's known recipes list?                            ││
│  │  • Is isKnownByDefault = true?                                          ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│           │                                                                  │
│           ├─── No ────▶ "You don't know this recipe" → END                  │
│           │                                                                  │
│           ▼ Yes                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │  CHECK: Station Available?                                              ││
│  │  • Is stationRequired null? → Skip                                      ││
│  │  • Is player at required station?                                       ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│           │                                                                  │
│           ├─── No ────▶ "Requires [station]" → END                          │
│           │                                                                  │
│           ▼ Yes                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │  CHECK: Materials Available?                                            ││
│  │  • For each material in materials[]:                                    ││
│  │    - Does player have itemId × quantity?                                ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│           │                                                                  │
│           ├─── No ────▶ "Missing materials: [list]" → END                   │
│           │                                                                  │
│           ▼ Yes                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │  CHECK: Skill Requirements Met?                                         ││
│  │  • For each skill in skillRequirements[]:                               ││
│  │    - If minimumLevel set: player skill >= minimumLevel?                 ││
│  │    - If dc set: roll skill check vs DC                                  ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│           │                                                                  │
│           ├─── No ────▶ "Skill too low" or "Skill check failed" → END       │
│           │                                                                  │
│           ▼ Yes                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │  CONSUME MATERIALS                                                      ││
│  │  • For each material where isConsumed = true:                           ││
│  │    - Remove itemId × quantity from inventory                            ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │  WAIT: Crafting Time                                                    ││
│  │  • If craftingTime set: wait N turns                                    ││
│  │  • If null: instant crafting                                            ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │  ROLL: Failure Check                                                    ││
│  │  • Random(0,1) < failureChance?                                         ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│           │                                                                  │
│           ├─── Yes (Failed) ────▶ Give failureOutput (if set) → END         │
│           │                                                                  │
│           ▼ No (Success)                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │  DETERMINE: Output Quantity                                             ││
│  │  • Roll between quantity.min and quantity.max                           ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │  DETERMINE: Output Quality                                              ││
│  │  • Roll criticalUpgradeChance → +2 tiers                                ││
│  │  • Roll upgradeChance → +1 tier                                         ││
│  │  • Otherwise → baseQuality                                              ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │  ROLL: Bonus Outputs                                                    ││
│  │  • For each bonusOutput:                                                ││
│  │    - Random(0,1) < chance? → Add to output                              ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│           │                                                                  │
│           ▼                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │  GRANT: Experience & Items                                              ││
│  │  • Add output items to inventory                                        ││
│  │  • Add experienceReward to crafting XP                                  ││
│  │  • Display success message                                              ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│           │                                                                  │
│           ▼                                                                  │
│        END                                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.7 File Layer Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            CONFIG LAYER                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  config/                                                                     │
│  ├── recipes.json ◀────────────────────────────┐                            │
│  │   {                                          │ references                 │
│  │     "$schema": "./schemas/recipes.schema.json",                           │
│  │     "recipes": [                             │                            │
│  │       {                                      │                            │
│  │         "id": "health-potion-basic",         │                            │
│  │         "name": "Basic Health Potion",       │                            │
│  │         "category": "Alchemy",               │                            │
│  │         "materials": [                       │                            │
│  │           { "itemId": "herb-bloodmoss", ... }│ → items.json               │
│  │         ],                                   │                            │
│  │         "skillRequirements": [               │                            │
│  │           { "skillId": "alchemy", ... }      │ → skills.json              │
│  │         ],                                   │                            │
│  │         "output": { ... },                   │                            │
│  │         "stationRequired": "alchemy-table",  │ → interactive-objects.json │
│  │         "discoveryCondition": { ... }        │                            │
│  │       },                                     │                            │
│  │       ...                                    │                            │
│  │     ]                                        │                            │
│  │   }                                          │                            │
│  │                                              │                            │
│  ├── items.json (referenced by materials)       │                            │
│  ├── skills.json (referenced by skillRequirements)                          │
│  ├── interactive-objects.json (referenced by stationRequired)               │
│  │                                              │                            │
│  └── schemas/                                   │                            │
│      └── recipes.schema.json ──────────────────┘                            │
│          {                                                                   │
│            "$schema": "http://json-schema.org/draft-07/schema#",            │
│            "definitions": {                                                  │
│              "RecipeDefinition": {...},                                      │
│              "MaterialRequirement": {...},                                   │
│              "SkillRequirement": {...},                                      │
│              "OutputDefinition": {...},                                      │
│              "QuantityRange": {...},                                         │
│              "QualityVariance": {...},                                       │
│              "BonusOutput": {...},                                           │
│              "DiscoveryCondition": {...}                                     │
│            }                                                                 │
│          }                                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Recipe Schema Root Definition

### 4.1 Root Configuration Properties

**File:** `config/schemas/recipes.schema.json`

The recipe schema follows JSON Schema Draft-07 specification, providing comprehensive validation for crafting recipe configuration files.

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Crafting Recipe Configuration",
    "description": "Schema for crafting recipe definitions including materials, skills, outputs, stations, and discovery conditions.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+$"
        },
        "recipes": {
            "type": "array",
            "description": "List of crafting recipe definitions",
            "items": {
                "$ref": "#/definitions/RecipeDefinition"
            },
            "minItems": 1
        }
    },
    "required": ["recipes"],
    "additionalProperties": false,
    "definitions": {
        "RecipeDefinition": { ... },
        "MaterialRequirement": { ... },
        "SkillRequirement": { ... },
        "OutputDefinition": { ... },
        "QuantityRange": { ... },
        "QualityVariance": { ... },
        "BonusOutput": { ... },
        "DiscoveryCondition": { ... }
    }
}
```

### 4.2 RecipeDefinition Schema

The `RecipeDefinition` object defines a complete crafting recipe with all its requirements and outputs.

```json
"RecipeDefinition": {
    "type": "object",
    "description": "A crafting recipe with materials, skills, output, and discovery conditions",
    "properties": {
        "id": {
            "type": "string",
            "description": "Unique identifier for the recipe (lowercase kebab-case)",
            "pattern": "^[a-z][a-z0-9-]*$",
            "minLength": 1,
            "maxLength": 50
        },
        "name": {
            "type": "string",
            "description": "Display name for the recipe",
            "minLength": 1,
            "maxLength": 100
        },
        "description": {
            "type": "string",
            "description": "Flavor text describing the recipe and its result"
        },
        "category": {
            "type": "string",
            "description": "Crafting category this recipe belongs to",
            "enum": ["Alchemy", "Smithing", "Enchanting", "Cooking", "Leatherworking", "Tailoring", "Jewelcrafting", "Engineering", "Inscription"]
        },
        "materials": {
            "type": "array",
            "description": "Required materials to craft this recipe",
            "items": {
                "$ref": "#/definitions/MaterialRequirement"
            },
            "minItems": 1
        },
        "skillRequirements": {
            "type": "array",
            "description": "Optional skill requirements to craft this recipe",
            "items": {
                "$ref": "#/definitions/SkillRequirement"
            }
        },
        "output": {
            "$ref": "#/definitions/OutputDefinition",
            "description": "The item(s) produced by this recipe"
        },
        "stationRequired": {
            "type": "string",
            "description": "ID of the crafting station required (references interactive-objects.json)",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "craftingTime": {
            "type": "integer",
            "description": "Number of turns required to complete crafting",
            "minimum": 1
        },
        "discoveryCondition": {
            "$ref": "#/definitions/DiscoveryCondition",
            "description": "How this recipe is learned/discovered"
        },
        "isKnownByDefault": {
            "type": "boolean",
            "description": "If true, all characters know this recipe from the start",
            "default": false
        },
        "failureChance": {
            "type": "number",
            "description": "Probability of crafting failure (0.0 to 1.0)",
            "minimum": 0,
            "maximum": 1,
            "default": 0
        },
        "failureOutput": {
            "$ref": "#/definitions/OutputDefinition",
            "description": "Optional alternative output when crafting fails"
        },
        "experienceReward": {
            "type": "integer",
            "description": "Crafting experience points awarded on success",
            "minimum": 0
        },
        "sortOrder": {
            "type": "integer",
            "description": "Order for display sorting within category",
            "minimum": 0
        }
    },
    "required": ["id", "name", "description", "category", "materials", "output"],
    "additionalProperties": false
}
```

---

## 5. Recipe Identity and Display

### 5.1 Recipe Identification

Each recipe requires a unique identifier following the kebab-case pattern.

```json
"id": {
    "type": "string",
    "description": "Unique identifier for the recipe (lowercase kebab-case)",
    "pattern": "^[a-z][a-z0-9-]*$",
    "minLength": 1,
    "maxLength": 50
}
```

**Valid IDs:**
- `health-potion-basic`
- `iron-sword`
- `enchant-fire-1`
- `grilled-meat`
- `leather-armor-set`

**Invalid IDs:**
- `Health_Potion` (uppercase and underscore)
- `123recipe` (starts with number)
- `iron sword` (contains space)

### 5.2 Recipe Categories

Recipes are organized into 9 crafting categories.

```json
"category": {
    "type": "string",
    "description": "Crafting category this recipe belongs to",
    "enum": ["Alchemy", "Smithing", "Enchanting", "Cooking", "Leatherworking", "Tailoring", "Jewelcrafting", "Engineering", "Inscription"]
}
```

| Category | Description | Typical Station |
|----------|-------------|-----------------|
| `Alchemy` | Potions, elixirs, oils, poisons | Alchemy Table |
| `Smithing` | Weapons, armor, tools, metal items | Forge/Anvil |
| `Enchanting` | Magical enhancements, enchanted items | Enchanting Table |
| `Cooking` | Food, drinks, consumable buffs | Campfire/Kitchen |
| `Leatherworking` | Leather armor, bags, straps | Tanning Rack |
| `Tailoring` | Cloth armor, cloaks, bags | Loom |
| `Jewelcrafting` | Rings, amulets, gem cutting | Jeweler's Bench |
| `Engineering` | Gadgets, traps, mechanical devices | Workbench |
| `Inscription` | Scrolls, glyphs, written magic | Scribe's Desk |

### 5.3 Display Properties

**Name:**
```json
"name": {
    "type": "string",
    "description": "Display name for the recipe",
    "minLength": 1,
    "maxLength": 100
}
```

**Description:**
```json
"description": {
    "type": "string",
    "description": "Flavor text describing the recipe and its result"
}
```

**Sort Order:**
```json
"sortOrder": {
    "type": "integer",
    "description": "Order for display sorting within category",
    "minimum": 0
}
```

---

## 6. Material Requirements Configuration

### 6.1 MaterialRequirement Definition

The `MaterialRequirement` object defines a required ingredient for the recipe.

```json
"MaterialRequirement": {
    "type": "object",
    "description": "A required material for crafting",
    "properties": {
        "itemId": {
            "type": "string",
            "description": "ID of the required item (references items.json)",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "quantity": {
            "type": "integer",
            "description": "Number of items required",
            "minimum": 1,
            "default": 1
        },
        "isConsumed": {
            "type": "boolean",
            "description": "Whether the material is consumed during crafting",
            "default": true
        }
    },
    "required": ["itemId"],
    "additionalProperties": false
}
```

### 6.2 Consumed vs Non-Consumed Materials

| isConsumed | Behavior | Use Case |
|------------|----------|----------|
| `true` (default) | Material removed from inventory | Herbs, ores, reagents |
| `false` | Material remains in inventory | Tools, molds, catalysts |

**Non-Consumed Material Examples:**
- Mortar and Pestle (Alchemy)
- Blacksmith's Hammer (Smithing)
- Enchanting Focus Crystal (Enchanting)
- Cooking Pot (Cooking)
- Jeweler's Loupe (Jewelcrafting)

### 6.3 Material Examples

**Alchemy Recipe Materials:**
```json
"materials": [
    { "itemId": "herb-bloodmoss", "quantity": 2, "isConsumed": true },
    { "itemId": "vial-empty", "quantity": 1, "isConsumed": true },
    { "itemId": "tool-mortar-pestle", "quantity": 1, "isConsumed": false }
]
```

**Smithing Recipe Materials:**
```json
"materials": [
    { "itemId": "ingot-iron", "quantity": 3, "isConsumed": true },
    { "itemId": "leather-strips", "quantity": 1, "isConsumed": true },
    { "itemId": "tool-smithing-hammer", "quantity": 1, "isConsumed": false }
]
```

---

## 7. Skill Requirements Configuration

### 7.1 SkillRequirement Definition

The `SkillRequirement` object defines skill-based prerequisites for crafting.

```json
"SkillRequirement": {
    "type": "object",
    "description": "A skill requirement for crafting",
    "properties": {
        "skillId": {
            "type": "string",
            "description": "ID of the required skill (references skills.json)",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "minimumLevel": {
            "type": "integer",
            "description": "Minimum skill level required to attempt crafting",
            "minimum": 1
        },
        "dc": {
            "type": "integer",
            "description": "Difficulty class for skill check (if check required)",
            "minimum": 1
        }
    },
    "required": ["skillId"],
    "additionalProperties": false
}
```

### 7.2 Skill Check Mechanics

**Two Approaches:**

1. **Minimum Level (Gate):** Player must have at least the specified skill level to attempt crafting. No roll required.

2. **Difficulty Class (Check):** Player rolls a skill check against the DC. Failure means crafting fails.

### 7.3 Minimum Level vs DC

| Approach | When to Use | Example |
|----------|-------------|---------|
| `minimumLevel` only | Simple gate, always succeeds | Basic recipes |
| `dc` only | Skill check, can fail | Challenging recipes |
| Both | Gate + check | Advanced recipes |

**Examples:**

**Basic Recipe (Gate Only):**
```json
"skillRequirements": [
    { "skillId": "alchemy", "minimumLevel": 1 }
]
```

**Challenging Recipe (Check Only):**
```json
"skillRequirements": [
    { "skillId": "smithing", "dc": 15 }
]
```

**Advanced Recipe (Gate + Check):**
```json
"skillRequirements": [
    { "skillId": "enchanting", "minimumLevel": 5, "dc": 18 }
]
```

---

## 8. Output Configuration

### 8.1 OutputDefinition Schema

The `OutputDefinition` object defines what is produced by the recipe.

```json
"OutputDefinition": {
    "type": "object",
    "description": "The output produced by crafting",
    "properties": {
        "itemId": {
            "type": "string",
            "description": "ID of the item produced (references items.json)",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "quantity": {
            "$ref": "#/definitions/QuantityRange",
            "description": "How many items are produced"
        },
        "qualityVariance": {
            "$ref": "#/definitions/QualityVariance",
            "description": "Optional quality tier variance"
        },
        "bonusOutputs": {
            "type": "array",
            "description": "Optional additional outputs with chance",
            "items": {
                "$ref": "#/definitions/BonusOutput"
            }
        }
    },
    "required": ["itemId", "quantity"],
    "additionalProperties": false
}
```

### 8.2 QuantityRange Definition

The `QuantityRange` object defines the minimum and maximum output quantity.

```json
"QuantityRange": {
    "type": "object",
    "description": "A range of possible quantities",
    "properties": {
        "min": {
            "type": "integer",
            "description": "Minimum quantity produced",
            "minimum": 1,
            "default": 1
        },
        "max": {
            "type": "integer",
            "description": "Maximum quantity produced",
            "minimum": 1,
            "default": 1
        }
    },
    "additionalProperties": false
}
```

**Examples:**

| Recipe Type | min | max | Behavior |
|-------------|-----|-----|----------|
| Single item | 1 | 1 | Always produces 1 |
| Batch | 2 | 4 | Produces 2-4 randomly |
| Variable yield | 1 | 3 | Produces 1-3 randomly |

### 8.3 QualityVariance Definition

The `QualityVariance` object defines how output quality can vary.

```json
"QualityVariance": {
    "type": "object",
    "description": "Configuration for quality tier variance",
    "properties": {
        "baseQuality": {
            "type": "string",
            "description": "The default quality tier",
            "enum": ["Common", "Uncommon", "Rare", "Epic", "Legendary"]
        },
        "upgradeChance": {
            "type": "number",
            "description": "Probability of upgrading quality by one tier",
            "minimum": 0,
            "maximum": 1
        },
        "criticalUpgradeChance": {
            "type": "number",
            "description": "Probability of upgrading quality by two tiers",
            "minimum": 0,
            "maximum": 1
        }
    },
    "required": ["baseQuality"],
    "additionalProperties": false
}
```

**Quality Tier Progression:**
```
Common → Uncommon → Rare → Epic → Legendary
```

### 8.4 BonusOutput Definition

The `BonusOutput` object defines optional additional items with a chance to be produced.

```json
"BonusOutput": {
    "type": "object",
    "description": "An optional bonus item produced with a chance",
    "properties": {
        "itemId": {
            "type": "string",
            "description": "ID of the bonus item",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "quantity": {
            "type": "integer",
            "description": "Number of bonus items produced",
            "minimum": 1
        },
        "chance": {
            "type": "number",
            "description": "Probability of receiving this bonus (0.0 to 1.0)",
            "minimum": 0,
            "maximum": 1
        }
    },
    "required": ["itemId", "quantity", "chance"],
    "additionalProperties": false
}
```

**Example:**
```json
"bonusOutputs": [
    { "itemId": "residue-alchemical", "quantity": 1, "chance": 0.25 },
    { "itemId": "essence-rare", "quantity": 1, "chance": 0.05 }
]
```

---

## 9. Crafting Conditions

### 9.1 Station Requirements

The optional `stationRequired` field specifies a crafting station the player must be at.

```json
"stationRequired": {
    "type": "string",
    "description": "ID of the crafting station required (references interactive-objects.json)",
    "pattern": "^[a-z][a-z0-9-]*$"
}
```

**Common Stations by Category:**

| Category | Station ID | Station Name |
|----------|------------|--------------|
| Alchemy | `alchemy-table` | Alchemy Table |
| Smithing | `forge-basic` | Blacksmith's Forge |
| Enchanting | `enchanting-table` | Enchanting Table |
| Cooking | `campfire` | Campfire |
| Cooking | `kitchen-stove` | Kitchen Stove |
| Leatherworking | `tanning-rack` | Tanning Rack |
| Tailoring | `loom-basic` | Weaver's Loom |
| Jewelcrafting | `jeweler-bench` | Jeweler's Bench |
| Engineering | `workbench` | Workbench |
| Inscription | `scribe-desk` | Scribe's Desk |

**No Station Required:**
If `stationRequired` is null/omitted, the recipe can be crafted anywhere.

### 9.2 Crafting Time

The optional `craftingTime` field specifies how many turns crafting takes.

```json
"craftingTime": {
    "type": "integer",
    "description": "Number of turns required to complete crafting",
    "minimum": 1
}
```

| Crafting Time | Use Case |
|---------------|----------|
| Not set / null | Instant crafting |
| 1 | Quick crafting (one turn) |
| 2-5 | Standard crafting |
| 5+ | Complex/slow crafting |

### 9.3 Failure Mechanics

**Failure Chance:**
```json
"failureChance": {
    "type": "number",
    "description": "Probability of crafting failure (0.0 to 1.0)",
    "minimum": 0,
    "maximum": 1,
    "default": 0
}
```

**Failure Output:**
```json
"failureOutput": {
    "$ref": "#/definitions/OutputDefinition",
    "description": "Optional alternative output when crafting fails"
}
```

**Failure Behavior:**

| Scenario | Behavior |
|----------|----------|
| `failureChance: 0` | Never fails (default) |
| `failureChance > 0`, no `failureOutput` | Materials consumed, nothing produced |
| `failureChance > 0`, with `failureOutput` | Materials consumed, failure item produced |

**Example with Failure:**
```json
{
    "id": "potion-explosive",
    "failureChance": 0.15,
    "failureOutput": {
        "itemId": "residue-volatile",
        "quantity": { "min": 1, "max": 1 }
    }
}
```

---

## 10. Discovery Configuration

### 10.1 DiscoveryCondition Definition

The `DiscoveryCondition` object defines how a recipe is learned.

```json
"DiscoveryCondition": {
    "type": "object",
    "description": "How this recipe is discovered/learned",
    "properties": {
        "type": {
            "type": "string",
            "description": "The type of discovery condition",
            "enum": ["Quest", "Level", "Teacher", "Item", "Exploration", "Default"]
        },
        "questId": {
            "type": "string",
            "description": "Quest ID that rewards this recipe (for Quest type)",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "requiredLevel": {
            "type": "integer",
            "description": "Character level required to learn (for Level type)",
            "minimum": 1
        },
        "teacherNpcId": {
            "type": "string",
            "description": "NPC ID that teaches this recipe (for Teacher type)",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "itemId": {
            "type": "string",
            "description": "Recipe scroll/book item ID (for Item type)",
            "pattern": "^[a-z][a-z0-9-]*$"
        },
        "locationId": {
            "type": "string",
            "description": "Location ID where recipe is discovered (for Exploration type)",
            "pattern": "^[a-z][a-z0-9-]*$"
        }
    },
    "required": ["type"],
    "additionalProperties": false
}
```

### 10.2 Discovery Types

| Type | Required Field | Description |
|------|----------------|-------------|
| `Default` | None | Recipe is known from the start (use `isKnownByDefault` instead) |
| `Quest` | `questId` | Learned upon completing the specified quest |
| `Level` | `requiredLevel` | Automatically learned at character level |
| `Teacher` | `teacherNpcId` | Purchased/learned from an NPC trainer |
| `Item` | `itemId` | Learned by using a recipe scroll or book |
| `Exploration` | `locationId` | Discovered when visiting a location |

**Examples:**

**Quest Discovery:**
```json
"discoveryCondition": {
    "type": "Quest",
    "questId": "quest-alchemist-apprentice"
}
```

**Level Discovery:**
```json
"discoveryCondition": {
    "type": "Level",
    "requiredLevel": 10
}
```

**Teacher Discovery:**
```json
"discoveryCondition": {
    "type": "Teacher",
    "teacherNpcId": "npc-master-smith"
}
```

**Item Discovery:**
```json
"discoveryCondition": {
    "type": "Item",
    "itemId": "recipe-scroll-health-potion"
}
```

**Exploration Discovery:**
```json
"discoveryCondition": {
    "type": "Exploration",
    "locationId": "location-forgotten-ruins"
}
```

### 10.3 Known By Default Flag

The `isKnownByDefault` flag allows recipes to be known without a discovery condition.

```json
"isKnownByDefault": {
    "type": "boolean",
    "description": "If true, all characters know this recipe from the start",
    "default": false
}
```

**Usage:**
- Set `isKnownByDefault: true` for basic recipes everyone should know
- Use `discoveryCondition` for recipes that must be learned
- If both are set, `isKnownByDefault: true` takes precedence

---

## 11. Validation Rules

### 11.1 ID Pattern Validation

| Property | Pattern | Description |
|----------|---------|-------------|
| `RecipeDefinition.id` | `^[a-z][a-z0-9-]*$` | Lowercase kebab-case |
| `MaterialRequirement.itemId` | `^[a-z][a-z0-9-]*$` | References items.json |
| `SkillRequirement.skillId` | `^[a-z][a-z0-9-]*$` | References skills.json |
| `OutputDefinition.itemId` | `^[a-z][a-z0-9-]*$` | References items.json |
| `BonusOutput.itemId` | `^[a-z][a-z0-9-]*$` | References items.json |
| `stationRequired` | `^[a-z][a-z0-9-]*$` | References interactive-objects.json |
| `DiscoveryCondition.*Id` | `^[a-z][a-z0-9-]*$` | Various references |

### 11.2 Range Validation

| Property | Range | Validation Error |
|----------|-------|------------------|
| `MaterialRequirement.quantity` | >= 1 | "quantity must be >= 1" |
| `SkillRequirement.minimumLevel` | >= 1 | "minimumLevel must be >= 1" |
| `SkillRequirement.dc` | >= 1 | "dc must be >= 1" |
| `QuantityRange.min` | >= 1 | "min must be >= 1" |
| `QuantityRange.max` | >= 1 | "max must be >= 1" |
| `BonusOutput.quantity` | >= 1 | "quantity must be >= 1" |
| `BonusOutput.chance` | 0-1 | "chance must be between 0 and 1" |
| `failureChance` | 0-1 | "failureChance must be between 0 and 1" |
| `upgradeChance` | 0-1 | "upgradeChance must be between 0 and 1" |
| `criticalUpgradeChance` | 0-1 | "criticalUpgradeChance must be between 0 and 1" |
| `craftingTime` | >= 1 | "craftingTime must be >= 1" |
| `experienceReward` | >= 0 | "experienceReward must be >= 0" |
| `sortOrder` | >= 0 | "sortOrder must be >= 0" |

### 11.3 Required Fields

| Definition | Required Fields |
|------------|-----------------|
| `RecipeDefinition` | id, name, description, category, materials, output |
| `MaterialRequirement` | itemId |
| `SkillRequirement` | skillId |
| `OutputDefinition` | itemId, quantity |
| `QuantityRange` | (none - defaults used) |
| `QualityVariance` | baseQuality |
| `BonusOutput` | itemId, quantity, chance |
| `DiscoveryCondition` | type |

### 11.4 Enum Validation

| Enum | Values |
|------|--------|
| `category` | Alchemy, Smithing, Enchanting, Cooking, Leatherworking, Tailoring, Jewelcrafting, Engineering, Inscription |
| `baseQuality` | Common, Uncommon, Rare, Epic, Legendary |
| `DiscoveryCondition.type` | Quest, Level, Teacher, Item, Exploration, Default |

---

## 12. Configuration Schema

### Complete Recipe Schema File

**File:** `config/schemas/recipes.schema.json`

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Crafting Recipe Configuration",
    "description": "Schema for crafting recipe definitions including materials, skills, outputs, stations, and discovery conditions.",
    "type": "object",
    "properties": {
        "$schema": {
            "type": "string",
            "description": "Reference to the JSON schema file for validation"
        },
        "version": {
            "type": "string",
            "description": "Optional version identifier for the configuration file",
            "pattern": "^[0-9]+\\.[0-9]+$"
        },
        "recipes": {
            "type": "array",
            "description": "List of crafting recipe definitions",
            "items": {
                "$ref": "#/definitions/RecipeDefinition"
            },
            "minItems": 1
        }
    },
    "required": ["recipes"],
    "additionalProperties": false,
    "definitions": {
        "RecipeDefinition": {
            "type": "object",
            "description": "A crafting recipe with materials, skills, output, and discovery conditions",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Unique identifier for the recipe (lowercase kebab-case)",
                    "pattern": "^[a-z][a-z0-9-]*$",
                    "minLength": 1,
                    "maxLength": 50
                },
                "name": {
                    "type": "string",
                    "description": "Display name for the recipe",
                    "minLength": 1,
                    "maxLength": 100
                },
                "description": {
                    "type": "string",
                    "description": "Flavor text describing the recipe and its result"
                },
                "category": {
                    "type": "string",
                    "description": "Crafting category this recipe belongs to",
                    "enum": ["Alchemy", "Smithing", "Enchanting", "Cooking", "Leatherworking", "Tailoring", "Jewelcrafting", "Engineering", "Inscription"]
                },
                "materials": {
                    "type": "array",
                    "description": "Required materials to craft this recipe",
                    "items": {
                        "$ref": "#/definitions/MaterialRequirement"
                    },
                    "minItems": 1
                },
                "skillRequirements": {
                    "type": "array",
                    "description": "Optional skill requirements to craft this recipe",
                    "items": {
                        "$ref": "#/definitions/SkillRequirement"
                    }
                },
                "output": {
                    "$ref": "#/definitions/OutputDefinition",
                    "description": "The item(s) produced by this recipe"
                },
                "stationRequired": {
                    "type": "string",
                    "description": "ID of the crafting station required (references interactive-objects.json)",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "craftingTime": {
                    "type": "integer",
                    "description": "Number of turns required to complete crafting",
                    "minimum": 1
                },
                "discoveryCondition": {
                    "$ref": "#/definitions/DiscoveryCondition",
                    "description": "How this recipe is learned/discovered"
                },
                "isKnownByDefault": {
                    "type": "boolean",
                    "description": "If true, all characters know this recipe from the start",
                    "default": false
                },
                "failureChance": {
                    "type": "number",
                    "description": "Probability of crafting failure (0.0 to 1.0)",
                    "minimum": 0,
                    "maximum": 1,
                    "default": 0
                },
                "failureOutput": {
                    "$ref": "#/definitions/OutputDefinition",
                    "description": "Optional alternative output when crafting fails"
                },
                "experienceReward": {
                    "type": "integer",
                    "description": "Crafting experience points awarded on success",
                    "minimum": 0
                },
                "sortOrder": {
                    "type": "integer",
                    "description": "Order for display sorting within category",
                    "minimum": 0
                }
            },
            "required": ["id", "name", "description", "category", "materials", "output"],
            "additionalProperties": false
        },
        "MaterialRequirement": {
            "type": "object",
            "description": "A required material for crafting",
            "properties": {
                "itemId": {
                    "type": "string",
                    "description": "ID of the required item (references items.json)",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "quantity": {
                    "type": "integer",
                    "description": "Number of items required",
                    "minimum": 1,
                    "default": 1
                },
                "isConsumed": {
                    "type": "boolean",
                    "description": "Whether the material is consumed during crafting",
                    "default": true
                }
            },
            "required": ["itemId"],
            "additionalProperties": false
        },
        "SkillRequirement": {
            "type": "object",
            "description": "A skill requirement for crafting",
            "properties": {
                "skillId": {
                    "type": "string",
                    "description": "ID of the required skill (references skills.json)",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "minimumLevel": {
                    "type": "integer",
                    "description": "Minimum skill level required to attempt crafting",
                    "minimum": 1
                },
                "dc": {
                    "type": "integer",
                    "description": "Difficulty class for skill check (if check required)",
                    "minimum": 1
                }
            },
            "required": ["skillId"],
            "additionalProperties": false
        },
        "OutputDefinition": {
            "type": "object",
            "description": "The output produced by crafting",
            "properties": {
                "itemId": {
                    "type": "string",
                    "description": "ID of the item produced (references items.json)",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "quantity": {
                    "$ref": "#/definitions/QuantityRange",
                    "description": "How many items are produced"
                },
                "qualityVariance": {
                    "$ref": "#/definitions/QualityVariance",
                    "description": "Optional quality tier variance"
                },
                "bonusOutputs": {
                    "type": "array",
                    "description": "Optional additional outputs with chance",
                    "items": {
                        "$ref": "#/definitions/BonusOutput"
                    }
                }
            },
            "required": ["itemId", "quantity"],
            "additionalProperties": false
        },
        "QuantityRange": {
            "type": "object",
            "description": "A range of possible quantities",
            "properties": {
                "min": {
                    "type": "integer",
                    "description": "Minimum quantity produced",
                    "minimum": 1,
                    "default": 1
                },
                "max": {
                    "type": "integer",
                    "description": "Maximum quantity produced",
                    "minimum": 1,
                    "default": 1
                }
            },
            "additionalProperties": false
        },
        "QualityVariance": {
            "type": "object",
            "description": "Configuration for quality tier variance",
            "properties": {
                "baseQuality": {
                    "type": "string",
                    "description": "The default quality tier",
                    "enum": ["Common", "Uncommon", "Rare", "Epic", "Legendary"]
                },
                "upgradeChance": {
                    "type": "number",
                    "description": "Probability of upgrading quality by one tier",
                    "minimum": 0,
                    "maximum": 1
                },
                "criticalUpgradeChance": {
                    "type": "number",
                    "description": "Probability of upgrading quality by two tiers",
                    "minimum": 0,
                    "maximum": 1
                }
            },
            "required": ["baseQuality"],
            "additionalProperties": false
        },
        "BonusOutput": {
            "type": "object",
            "description": "An optional bonus item produced with a chance",
            "properties": {
                "itemId": {
                    "type": "string",
                    "description": "ID of the bonus item",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "quantity": {
                    "type": "integer",
                    "description": "Number of bonus items produced",
                    "minimum": 1
                },
                "chance": {
                    "type": "number",
                    "description": "Probability of receiving this bonus (0.0 to 1.0)",
                    "minimum": 0,
                    "maximum": 1
                }
            },
            "required": ["itemId", "quantity", "chance"],
            "additionalProperties": false
        },
        "DiscoveryCondition": {
            "type": "object",
            "description": "How this recipe is discovered/learned",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "The type of discovery condition",
                    "enum": ["Quest", "Level", "Teacher", "Item", "Exploration", "Default"]
                },
                "questId": {
                    "type": "string",
                    "description": "Quest ID that rewards this recipe (for Quest type)",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "requiredLevel": {
                    "type": "integer",
                    "description": "Character level required to learn (for Level type)",
                    "minimum": 1
                },
                "teacherNpcId": {
                    "type": "string",
                    "description": "NPC ID that teaches this recipe (for Teacher type)",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "itemId": {
                    "type": "string",
                    "description": "Recipe scroll/book item ID (for Item type)",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "locationId": {
                    "type": "string",
                    "description": "Location ID where recipe is discovered (for Exploration type)",
                    "pattern": "^[a-z][a-z0-9-]*$"
                }
            },
            "required": ["type"],
            "additionalProperties": false
        }
    }
}
```

---

## 13. Configuration File

### New recipes.json

Create a new `recipes.json` configuration file with example recipes demonstrating various features.

**File:** `config/recipes.json`

```json
{
    "$schema": "./schemas/recipes.schema.json",
    "recipes": [
        {
            "id": "health-potion-basic",
            "name": "Basic Health Potion",
            "description": "A simple restorative elixir that heals minor wounds.",
            "category": "Alchemy",
            "materials": [
                { "itemId": "herb-bloodmoss", "quantity": 2 },
                { "itemId": "vial-empty", "quantity": 1 }
            ],
            "skillRequirements": [
                { "skillId": "alchemy", "minimumLevel": 1 }
            ],
            "output": {
                "itemId": "potion-health-basic",
                "quantity": { "min": 1, "max": 1 },
                "qualityVariance": {
                    "baseQuality": "Common",
                    "upgradeChance": 0.1
                }
            },
            "stationRequired": "alchemy-table",
            "isKnownByDefault": true,
            "experienceReward": 10,
            "sortOrder": 0
        },
        {
            "id": "iron-sword",
            "name": "Iron Sword",
            "description": "A reliable blade forged from iron ingots.",
            "category": "Smithing",
            "materials": [
                { "itemId": "ingot-iron", "quantity": 3 },
                { "itemId": "leather-strips", "quantity": 1 }
            ],
            "skillRequirements": [
                { "skillId": "smithing", "minimumLevel": 2 }
            ],
            "output": {
                "itemId": "weapon-sword-iron",
                "quantity": { "min": 1, "max": 1 },
                "qualityVariance": {
                    "baseQuality": "Common",
                    "upgradeChance": 0.15,
                    "criticalUpgradeChance": 0.02
                }
            },
            "stationRequired": "forge-basic",
            "craftingTime": 3,
            "discoveryCondition": {
                "type": "Teacher",
                "teacherNpcId": "npc-blacksmith-village"
            },
            "failureChance": 0.05,
            "experienceReward": 25,
            "sortOrder": 0
        },
        {
            "id": "grilled-meat",
            "name": "Grilled Meat",
            "description": "Simple but hearty cooked meat that restores health.",
            "category": "Cooking",
            "materials": [
                { "itemId": "meat-raw", "quantity": 1 }
            ],
            "output": {
                "itemId": "food-grilled-meat",
                "quantity": { "min": 1, "max": 1 }
            },
            "stationRequired": "campfire",
            "isKnownByDefault": true,
            "experienceReward": 5,
            "sortOrder": 0
        },
        {
            "id": "enchant-fire-weapon",
            "name": "Fiery Enchantment",
            "description": "Imbue a weapon with the power of flame.",
            "category": "Enchanting",
            "materials": [
                { "itemId": "gem-ruby", "quantity": 1 },
                { "itemId": "dust-arcane", "quantity": 3 },
                { "itemId": "catalyst-enchanting", "quantity": 1, "isConsumed": false }
            ],
            "skillRequirements": [
                { "skillId": "enchanting", "minimumLevel": 3, "dc": 12 }
            ],
            "output": {
                "itemId": "enchantment-fire-1",
                "quantity": { "min": 1, "max": 1 }
            },
            "stationRequired": "enchanting-table",
            "craftingTime": 5,
            "discoveryCondition": {
                "type": "Quest",
                "questId": "quest-secrets-of-flame"
            },
            "failureChance": 0.2,
            "failureOutput": {
                "itemId": "residue-magical",
                "quantity": { "min": 1, "max": 2 }
            },
            "experienceReward": 50,
            "sortOrder": 0
        },
        {
            "id": "leather-armor-basic",
            "name": "Basic Leather Armor",
            "description": "Light protective armor crafted from tanned hides.",
            "category": "Leatherworking",
            "materials": [
                { "itemId": "leather-cured", "quantity": 4 },
                { "itemId": "thread-sinew", "quantity": 2 }
            ],
            "skillRequirements": [
                { "skillId": "leatherworking", "minimumLevel": 1 }
            ],
            "output": {
                "itemId": "armor-leather-basic",
                "quantity": { "min": 1, "max": 1 },
                "qualityVariance": {
                    "baseQuality": "Common",
                    "upgradeChance": 0.1
                }
            },
            "stationRequired": "tanning-rack",
            "craftingTime": 2,
            "isKnownByDefault": true,
            "experienceReward": 20,
            "sortOrder": 0
        }
    ]
}
```

---

## 14. Data Model Changes

### No Domain Changes Required

This phase creates a JSON Schema file and a new configuration file. No changes to domain entities, services, or application layer are required.

| Layer | Changes |
|-------|---------|
| Domain | None |
| Application | None |
| Infrastructure | None |
| Configuration | One schema file added, one config file created |

### Schema as Documentation

The schema serves as:
- **Validation contract** for recipe configuration
- **IDE documentation** via description fields
- **Modding reference** for custom recipe creation
- **Design specification** for crafting mechanics

---

## 15. Logging Specifications

### No Runtime Logging Required

Schema validation occurs at design-time in IDE/editors, not at runtime. No logging infrastructure changes are needed for this phase.

| Component | Level | Events |
|-----------|-------|--------|
| N/A | N/A | Schema validation is IDE-based |

---

## 16. Unit Testing Requirements

### Test Count by Feature

| Feature | Test Count |
|---------|------------|
| Schema Valid Structure | ~1 |
| Category Enum Validation | ~1 |
| Materials Array Validation | ~1 |
| Quantity Range Validation | ~1 |
| Quality Tier Enum Validation | ~1 |
| Discovery Type Enum Validation | ~1 |
| **Total** | **~6** |

### Test Descriptions

#### RecipeSchemaTests.cs

```csharp
[TestFixture]
public class RecipeSchemaTests
{
    /// <summary>
    /// Verifies the schema file is valid JSON Schema Draft-07.
    /// </summary>
    [Test]
    public void Schema_IsValidJsonSchemaDraft07();

    /// <summary>
    /// Verifies the recipes.json validates against the schema without errors.
    /// </summary>
    [Test]
    public void RecipesJson_ValidatesAgainstSchema();

    /// <summary>
    /// Verifies category must be one of the 9 allowed values.
    /// </summary>
    [Test]
    public void Category_InvalidValue_FailsValidation();

    /// <summary>
    /// Verifies materials array must have at least one item.
    /// </summary>
    [Test]
    public void Materials_EmptyArray_FailsValidation();

    /// <summary>
    /// Verifies baseQuality must be one of the 5 quality tiers.
    /// </summary>
    [Test]
    public void QualityVariance_InvalidTier_FailsValidation();

    /// <summary>
    /// Verifies discovery type must be one of the 6 allowed values.
    /// </summary>
    [Test]
    public void DiscoveryCondition_InvalidType_FailsValidation();
}
```

### Test Implementation Notes

Tests should use a JSON Schema validation library (e.g., `NJsonSchema` for C#) to:
1. Load the schema file
2. Validate test JSON documents
3. Assert expected validation results

---

## 17. Use Cases

### UC-001: Load Recipe Configuration

**Actor:** Game System
**Flow:** System starts → Loads `recipes.json` → Schema validates content → Recipes available for crafting system

### UC-002: Edit Recipes in IDE

**Actor:** Developer/Modder
**Flow:** Opens `recipes.json` in VS Code → IDE loads schema → Autocomplete suggests properties → Validation errors shown inline

### UC-003: Add New Recipe

**Actor:** Modder
**Flow:** Adds new recipe object to `recipes` array → Sets id, name, description, category → Configures materials and output → IDE validates structure

### UC-004: Configure Complex Recipe with Skill Check

**Actor:** Modder
**Flow:** Creates advanced recipe → Adds skillRequirements with DC → Sets failureChance and failureOutput → Configures qualityVariance → IDE validates structure

### UC-005: Create Recipe with Discovery Condition

**Actor:** Modder
**Flow:** Creates hidden recipe → Sets isKnownByDefault: false → Configures discoveryCondition with type and required field → IDE validates structure

### UC-006: Invalid Category Error

**Actor:** Modder
**Flow:** Sets category to "Brewing" (invalid) → IDE shows error "category must be one of: Alchemy, Smithing, ..." → Modder corrects to valid value

---

## 18. Deliverable Checklist

### Schema Files
- [ ] `config/schemas/recipes.schema.json` created
- [ ] Schema follows JSON Schema Draft-07 format
- [ ] Schema includes all 8 definitions

### Schema Definitions
- [ ] `RecipeDefinition` - Main recipe structure
- [ ] `MaterialRequirement` - Required materials
- [ ] `SkillRequirement` - Skill prerequisites
- [ ] `OutputDefinition` - Crafting output
- [ ] `QuantityRange` - Min/max quantities
- [ ] `QualityVariance` - Quality tier variance
- [ ] `BonusOutput` - Optional bonus items
- [ ] `DiscoveryCondition` - Recipe learning conditions

### Validation Rules
- [ ] Recipe ID pattern validation: `^[a-z][a-z0-9-]*$`
- [ ] Category enum validation (9 categories)
- [ ] Materials array validation (minItems: 1)
- [ ] Quantity validation (>= 1)
- [ ] Quality tier enum validation (5 tiers)
- [ ] Discovery type enum validation (6 types)
- [ ] Failure chance range validation (0-1)
- [ ] Required fields enforced for all definitions

### Configuration Files
- [ ] `recipes.json` created with example recipes
- [ ] At least 5 example recipes included
- [ ] Examples cover multiple categories
- [ ] Examples demonstrate various features

### Testing
- [ ] ~6 unit tests implemented
- [ ] All tests passing
- [ ] Tests cover happy path and error cases

### Documentation
- [ ] Schema properties have descriptions
- [ ] This design specification complete

---

## 19. Acceptance Criteria

### Functional
- [ ] `recipes.schema.json` created in `config/schemas/` directory
- [ ] `recipes.json` created in `config/` directory
- [ ] Schema validates `recipes.json` without errors
- [ ] ID pattern validated (lowercase kebab-case)
- [ ] Category enum validated (9 categories)
- [ ] Materials array validated (minItems: 1)
- [ ] Skill requirements validated with skillId, minimumLevel, dc
- [ ] Output validated with itemId, quantity range
- [ ] Quality variance validated with enum and chance ranges
- [ ] Bonus outputs validated with chance range
- [ ] Station requirement validated as optional string
- [ ] Discovery condition validated with type enum
- [ ] Failure chance validated (0-1 range)
- [ ] VS Code provides autocomplete when schema linked

### Quality
- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] ~6 unit tests pass
- [ ] Schema file is valid JSON
- [ ] All schema properties have descriptions

---

## 20. Dependencies

### Required from Prior Versions

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| items.json | config/ | Referenced by materials[].itemId, output.itemId |
| skills.json | config/ | Referenced by skillRequirements[].skillId |
| interactive-objects.json | config/ | Referenced by stationRequired |

### Provides to Future Versions

| Type | Usage |
|------|-------|
| `recipes.schema.json` | Validates recipe configuration |
| `recipes.json` | Example recipes for crafting system |
| Recipe IDs | Referenced by vendor inventory (v0.14.5d) |
| Recipe structure | Pattern for item transformation systems |

### Implementation Order Note

**v0.14.5c depends on prior v0.14.x schemas** for item and skill references. It should be implemented after v0.14.5a and v0.14.5b, though those two can be parallel.

---

## 21. Future Considerations

### Deferred to Future Versions

- **Cross-reference validation**: Validating itemId exists in items.json
- **Cross-reference validation**: Validating skillId exists in skills.json
- **Cross-reference validation**: Validating stationRequired exists in interactive-objects.json
- **Crafting runtime logic**: Application-level crafting execution
- **Recipe book UI**: Interface for browsing known recipes
- **Crafting queue system**: Multiple items in progress

### Out of Scope

- **Currency schema** (v0.14.5a) - Gold, silver, copper
- **Resource schema** (v0.14.5b) - Class resources
- **Vendor schema** (v0.14.5d) - Shop inventories
- **Runtime crafting operations**: Application-level crafting (domain logic)
- **Crafting balance tuning**: Specific material quantities (design decisions)

### Potential Future Enhancements

If the crafting system expands, consider adding to the schema:

**Tool Proficiency:**
```json
"toolProficiency": {
    "type": "string",
    "description": "Required tool proficiency to craft",
    "enum": ["None", "Basic", "Journeyman", "Expert", "Master"]
}
```

**Batch Crafting:**
```json
"batchSize": {
    "type": "integer",
    "description": "Number of items crafted per attempt",
    "minimum": 1,
    "default": 1
}
```

**Resource Costs:**
```json
"resourceCosts": {
    "type": "array",
    "description": "Class resources consumed during crafting",
    "items": {
        "type": "object",
        "properties": {
            "resourceId": { "type": "string" },
            "amount": { "type": "integer" }
        }
    }
}
```

**Seasonal Availability:**
```json
"seasonalAvailability": {
    "type": "array",
    "description": "Seasons when this recipe can be crafted",
    "items": {
        "type": "string",
        "enum": ["Spring", "Summer", "Autumn", "Winter"]
    }
}
```

**Recipe Prerequisites:**
```json
"prerequisiteRecipes": {
    "type": "array",
    "description": "Recipes that must be known before learning this one",
    "items": {
        "type": "string",
        "pattern": "^[a-z][a-z0-9-]*$"
    }
}
```

**Crafting Specializations:**
```json
"specialization": {
    "type": "string",
    "description": "Crafting specialization required",
    "enum": ["None", "Weaponsmith", "Armorsmith", "Potion Master", "Enchanter"]
}
```

---

*Document Version: 1.0*
*Last Updated: 2026-01-17*
*Author: Claude*
