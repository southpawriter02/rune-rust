# v0.0.11 Descriptors & Ambience - Scope Breakdown

**Version:** 0.0.11
**Theme:** Descriptors & Ambience
**Prerequisites:** v0.0.10 Complete (Documentation & Polish)
**Total Estimated Tests:** ~65 new tests

---

## Executive Summary

The Descriptors & Ambience version transforms the existing basic descriptor system into a comprehensive environmental storytelling engine. This version expands descriptor categories, adds environmental coherence constraints, and provides rich sensory variety for combat, abilities, rooms, objects, and ambient atmosphere.

Key focus areas:
- **Environment Coherence**: Prevent conflicting descriptors (no ice + lava rooms)
- **Descriptor Categories**: Group descriptors by mutually exclusive categories
- **Sensory Layers**: Lighting, sound, smell, temperature, weather
- **Combat Variety**: Rich attack, defense, and death descriptions
- **Interactive Objects**: Describe interactable environment elements
- **Ambient Events**: Random atmospheric events during exploration

The work is divided into **four sub-phases**:

| Phase | Name | Focus | Est. Tests |
|-------|------|-------|------------|
| v0.0.11a | Descriptor Framework Expansion | Categories, coherence, exclusion rules, environment biomes | ~18 |
| v0.0.11b | Combat & Ability Descriptors | Attack variations, ability effects, death descriptions | ~15 |
| v0.0.11c | Environmental & Sensory Descriptors | Lighting, sounds, smells, temperature, weather, time | ~18 |
| v0.0.11d | Interactive Objects & Polish | Object descriptions, ambient events, integration | ~14 |

---

## Existing Infrastructure

### Already Implemented

| Feature | Location | Notes |
|---------|----------|-------|
| DescriptorService | `Application/Services/DescriptorService.cs` | Weighted selection, theme support, recent tracking |
| DescriptorConfiguration | `Application/Configuration/DescriptorConfiguration.cs` | Pool/descriptor classes |
| Environmental descriptors | `config/descriptors/environmental.json` | Lighting, sounds, smells, temperature |
| Combat descriptors | `config/descriptors/combat.json` | Hit descriptions |
| Ability descriptors | `config/descriptors/abilities.json` | Ability flavor text |
| Theme configuration | `config/themes.json` | Theme overrides, excluded/emphasized terms |
| Tag-based filtering | DescriptorService | Tags on descriptors for context |
| Damage-percent context | DescriptorService | MinDamagePercent/MaxDamagePercent |

### Needs Implementation (v0.0.11)

| Feature | Phase | Notes |
|---------|-------|-------|
| Environment categories | v0.0.11a | Mutually exclusive groupings (biome, climate, etc.) |
| Coherence validation | v0.0.11a | Prevent conflicting descriptors |
| Category exclusion rules | v0.0.11a | Define which categories conflict |
| Biome system | v0.0.11a | Cave, dungeon, forest, volcanic, frozen, etc. |
| Attack variation library | v0.0.11b | Weapon-specific hit descriptions |
| Ability effect descriptions | v0.0.11b | Visual/audio effects for abilities |
| Death description variety | v0.0.11b | Monster and player death flavors |
| Extended lighting system | v0.0.11c | Light sources, darkness levels, time-of-day |
| Rich sound ambience | v0.0.11c | Layered ambient sounds |
| Smell descriptors | v0.0.11c | Environment-appropriate smells |
| Temperature system | v0.0.11c | Climate integration |
| Weather system | v0.0.11c | Indoor/outdoor weather effects |
| Interactive objects | v0.0.11d | Describable, examinable objects |
| Ambient events | v0.0.11d | Random atmospheric occurrences |
| Descriptor caching | v0.0.11d | Performance optimization |

---

## Feature Analysis & Categorization

### Framework Features

| Feature | Complexity | Dependencies | Assigned Phase |
|---------|------------|--------------|----------------|
| Environment categories | High | DescriptorService | **v0.0.11a** |
| Coherence validation | High | Categories | **v0.0.11a** |
| Category exclusion rules | Medium | Categories | **v0.0.11a** |
| Biome definitions | Medium | Categories | **v0.0.11a** |
| Environment context | Medium | Biomes | **v0.0.11a** |

### Combat Features

| Feature | Complexity | Dependencies | Assigned Phase |
|---------|------------|--------------|----------------|
| Weapon-type hit descriptions | Medium | Damage types (v0.0.9) | **v0.0.11b** |
| Critical hit descriptions | Low | Combat descriptors | **v0.0.11b** |
| Miss descriptions | Low | Combat descriptors | **v0.0.11b** |
| Death descriptions | Medium | Monster definitions | **v0.0.11b** |
| Ability effect descriptions | Medium | Ability system (v0.0.4) | **v0.0.11b** |
| Status effect descriptions | Medium | Status effects (v0.0.6) | **v0.0.11b** |

### Sensory Features

| Feature | Complexity | Dependencies | Assigned Phase |
|---------|------------|--------------|----------------|
| Light source types | Medium | Room system | **v0.0.11c** |
| Darkness levels | Medium | Lighting | **v0.0.11c** |
| Layered sound ambience | Medium | Environmental descriptors | **v0.0.11c** |
| Smell intensity | Low | Environmental descriptors | **v0.0.11c** |
| Temperature effects | Medium | Climate categories | **v0.0.11c** |
| Weather conditions | Medium | Outdoor/indoor categories | **v0.0.11c** |
| Time-of-day effects | Low | Lighting | **v0.0.11c** |

### Object & Integration Features

| Feature | Complexity | Dependencies | Assigned Phase |
|---------|------------|--------------|----------------|
| Interactive object descriptors | Medium | Room items | **v0.0.11d** |
| Object examination responses | Medium | Object descriptors | **v0.0.11d** |
| Ambient events | Medium | Environmental descriptors | **v0.0.11d** |
| Descriptor caching | Medium | Performance | **v0.0.11d** |
| Full integration testing | Low | All v0.0.11 | **v0.0.11d** |

---

## Phase Definitions

---

## v0.0.11a: Descriptor Framework Expansion

[v0.0.11a Design Specification](v0.0.11a-design-specification.md)

### Overview

Expand the descriptor framework to support environment categories, coherence validation, and biome-based descriptor selection. This prevents incoherent environments (rooms described as both frozen and volcanic) and enables rich, consistent atmosphere generation.

### Scope

**In Scope:**
- `EnvironmentCategory` enum/definition (Biome, Climate, Lighting, Era, Condition)
- `EnvironmentCategoryValue` definitions within categories
- `CategoryExclusionRule` for conflicting values
- `BiomeDefinition` entity for environment types (cave, dungeon, forest, volcanic, frozen, swamp)
- `EnvironmentContext` value object for room-level environment state
- Coherence validation service
- Descriptor filtering by environment context
- Category-aware descriptor selection
- Biome-specific descriptor pools

**Out of Scope:**
- Combat descriptors (v0.0.11b)
- Sensory descriptors (v0.0.11c)
- Interactive objects (v0.0.11d)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Entities | 2 | `BiomeDefinition`, `EnvironmentCategory` |
| Value Objects | 2 | `EnvironmentContext`, `CategoryExclusionRule` |
| Services | 1 | `EnvironmentCoherenceService` |
| Configuration | 2 | `biomes.json`, `environment-categories.json` |
| Unit Tests | ~18 | Coherence and category tests |

### Environment Categories

| Category | Values | Exclusions |
|----------|--------|------------|
| **Biome** | Cave, Dungeon, Forest, Volcanic, Frozen, Swamp, Desert, Ruins | None (one per room) |
| **Climate** | Freezing, Cold, Temperate, Warm, Hot, Scorching | Freezing ↔ Hot/Scorching |
| **Era** | Ancient, Medieval, Decayed, Pristine | Ancient ↔ Pristine |
| **Condition** | Flooded, Burning, Collapsed, Overgrown, Infested | Flooded ↔ Burning |
| **Lighting** | Pitch Black, Dim, Normal, Bright, Blinding | Pitch Black ↔ Bright/Blinding |

### Coherence Rules

```csharp
// Example: EnvironmentContext validates coherence
public record EnvironmentContext(
    string Biome,
    string Climate,
    string Era,
    string? Condition,
    string Lighting)
{
    public bool IsCoherent() =>
        !HasConflictingCategories();
}

// Conflicting combinations blocked:
// - Frozen biome + Scorching climate
// - Flooded condition + Burning condition
// - Volcanic biome + Freezing climate
```

### Biome-Specific Descriptors

Each biome provides default descriptors for:
- Lighting preferences (volcanic = dim orange glow, frozen = pale blue light)
- Sound pools (cave = dripping water, forest = rustling leaves)
- Smell pools (swamp = decay, volcanic = sulfur)
- Temperature defaults

### Acceptance Criteria

- [x] Environment categories defined and configurable
- [x] Category exclusion rules prevent incoherent combinations
- [x] Biome definitions load from configuration
- [x] EnvironmentContext tracks room environment state
- [x] Descriptor selection respects environment context
- [x] Coherence validation service rejects conflicting contexts
- [x] ~18 unit tests pass (29 tests implemented)

---

## v0.0.11b: Combat & Ability Descriptors

[v0.0.11b Design Specification](v0.0.11b-design-specification.md)

### Overview

Expand combat descriptor variety with weapon-specific attacks, ability effects, and death descriptions. This creates dynamic, varied combat narration that changes based on weapon type, damage amount, and ability used.

### Scope

**In Scope:**
- Weapon-type hit descriptor pools (sword, axe, bow, staff, dagger, etc.)
- Damage-tier descriptors (glancing, solid, devastating, lethal)
- Critical hit and miss descriptions
- Monster death descriptions by type
- Player near-death and death descriptions
- Ability activation descriptions (visual/audio effects)
- Ability effect descriptions (on-hit, on-target)
- Status effect application/removal descriptions
- Damage type flavor text (fire sears, ice freezes, poison burns)

**Out of Scope:**
- Environmental descriptors (v0.0.11c)
- Interactive objects (v0.0.11d)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Configuration | 3 | `combat-hits.json`, `combat-deaths.json`, `ability-effects.json` |
| Service Extensions | 2 | `DescriptorService` combat methods, damage type integration |
| Descriptor Pools | ~20 | Weapon types, damage tiers, death variations |
| Unit Tests | ~15 | Combat descriptor selection tests |

### Weapon-Type Descriptors

| Weapon Type | Hit Examples |
|-------------|--------------|
| Sword | "slashes across", "drives the blade into", "cleaves through" |
| Axe | "hews into", "chops at", "buries the axe head in" |
| Bow | "arrow pierces", "shaft buries itself in", "arrow finds its mark in" |
| Staff | "cracks against", "sweeps into", "brings the staff down upon" |
| Dagger | "stabs into", "slips the blade between", "opens a wound in" |
| Fist | "hammers into", "crashes a fist into", "pummels" |

### Damage-Tier Descriptors

| Tier | Damage % | Examples |
|------|----------|----------|
| Glancing | 0-15% | "barely scratches", "grazes", "deflects off" |
| Light | 15-30% | "finds purchase", "connects", "lands a blow" |
| Solid | 30-50% | "strikes true", "lands solidly", "connects with force" |
| Heavy | 50-75% | "crashes into", "smashes against", "strikes hard" |
| Devastating | 75-90% | "devastates", "shatters", "tears through" |
| Lethal | 90-100% | "cleaves through", "destroys", "ends" |

### Death Descriptions

Monster deaths vary by type:
- **Humanoid**: "crumples to the ground", "falls lifeless"
- **Undead**: "collapses into bones", "the unholy light fades from its eyes"
- **Beast**: "lets out a final howl", "slumps motionless"
- **Construct**: "shatters into fragments", "grinds to a halt"

### Ability Effect Descriptions

```json
{
    "ability_activation": {
        "fireball": {
            "visual": "Flames gather in your palm, swirling into a roaring sphere",
            "audio": "A crackling roar builds as fire takes shape"
        }
    },
    "ability_impact": {
        "fireball": {
            "hit": "engulfs {target} in searing flames",
            "aoe": "The explosion washes over everything nearby"
        }
    }
}
```

### Acceptance Criteria

- [x] Weapon-specific hit descriptors implemented (8 weapon types)
- [x] Damage-tier descriptors scale with damage percentage (6 tiers)
- [x] Critical hit and miss descriptions vary
- [x] Monster death descriptions match monster type (6 categories)
- [x] Ability activation descriptions added
- [x] Ability effect descriptions show on target
- [x] Status effect descriptions implemented
- [x] Damage type flavor text integrated
- [x] ~15 unit tests pass (16 tests implemented)

---

## v0.0.11c: Environmental & Sensory Descriptors

[v0.0.11c Design Specification](v0.0.11c-design-specification.md)

### Overview

Create a rich sensory layer system with detailed lighting, ambient sounds, smells, temperature sensations, and weather effects. Each sense provides distinct, coherent descriptors based on the environment context established in v0.0.11a.

### Scope

**In Scope:**
- Light source types (torch, crystal, bioluminescence, sunlight, magical)
- Darkness levels (pitch black, dim, shadowy, normal, bright, blinding)
- Layered ambient sound system (distant, nearby, immediate)
- Smell descriptor pools by biome
- Smell intensity levels (faint, noticeable, strong, overwhelming)
- Temperature sensation descriptors
- Weather conditions (indoor: drafts, drips; outdoor: rain, wind, snow, storm)
- Time-of-day effects (dawn, day, dusk, night)
- Sensory combination generator

**Out of Scope:**
- Interactive objects (v0.0.11d)
- Game mechanics based on senses (future version)

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Configuration | 4 | `lighting.json`, `sounds.json`, `smells.json`, `weather.json` |
| Service Extensions | 1 | `SensoryDescriptorService` |
| Descriptor Pools | ~30 | Light sources, sounds, smells, weather |
| Unit Tests | ~18 | Sensory descriptor tests |

### Lighting System

| Light Source | Visual Description | Atmosphere |
|--------------|-------------------|------------|
| Torch | "flickering orange light", "dancing shadows" | Warm, uncertain |
| Crystal | "steady blue-white glow", "crystalline radiance" | Magical, serene |
| Bioluminescence | "eerie green phosphorescence", "fungal glow" | Alien, otherworldly |
| Sunlight | "warm golden rays", "bright daylight" | Safe, natural |
| Magical | "pulsing arcane light", "sourceless illumination" | Mysterious, arcane |

### Layered Sound System

Sounds organized by distance:
- **Distant**: Background atmosphere (wind, thunder, echoes)
- **Nearby**: Room-level sounds (dripping, footsteps, breathing)
- **Immediate**: Close sounds (your heartbeat, your breathing, nearby creatures)

### Smell Intensity

| Intensity | Description Pattern |
|-----------|-------------------|
| Faint | "A hint of {smell} lingers in the air" |
| Noticeable | "The smell of {smell} fills your nostrils" |
| Strong | "The pungent odor of {smell} assaults your senses" |
| Overwhelming | "The reek of {smell} is nearly unbearable" |

### Weather Conditions

| Weather | Indoor Effects | Outdoor Effects |
|---------|---------------|-----------------|
| Rain | "Water seeps through cracks" | "Rain patters against you" |
| Wind | "Drafts whistle through gaps" | "Wind howls around you" |
| Storm | "Thunder rumbles overhead" | "Lightning illuminates the sky" |
| Snow | "Cold drafts carry snowflakes" | "Snow swirls around you" |
| Fog | "Mist creeps under doors" | "Dense fog limits visibility" |

### Sensory Combination

```csharp
// Generate coherent multi-sense description
public SensoryDescription GenerateSensoryDescription(EnvironmentContext context)
{
    return new SensoryDescription
    {
        Lighting = GetLightingDescription(context),
        Sounds = GetLayeredSounds(context),
        Smell = GetSmellDescription(context),
        Temperature = GetTemperatureDescription(context),
        Weather = GetWeatherDescription(context)
    };
}
```

### Acceptance Criteria

- [x] Light source types defined with descriptions
- [x] Darkness levels affect descriptor selection
- [x] Layered sound system implemented
- [x] Smell pools organized by biome
- [x] Smell intensity levels work correctly
- [x] Temperature descriptors match climate
- [x] Weather conditions affect descriptions
- [x] Time-of-day effects implemented
- [x] Sensory combination generates coherent output
- [x] ~18 unit tests pass (25 tests implemented)

---

## v0.0.11d: Interactive Objects & Polish

[v0.0.11d Design Specification](v0.0.11d-design-specification.md)

### Overview

Add descriptors for interactive objects, implement ambient events, optimize descriptor caching, and integrate all descriptor systems into a cohesive experience.

### Scope

**In Scope:**
- Interactive object descriptor pools (doors, chests, levers, statues, altars)
- Object state descriptors (locked, open, broken, activated)
- Object examination responses
- Ambient event system (random atmospheric occurrences)
- Ambient event triggers (time-based, combat-based, exploration-based)
- Descriptor caching for performance
- Full system integration
- Descriptor library expansion (additional variety)

**Out of Scope:**
- Object interaction mechanics (existing item system)
- New game mechanics

### Key Deliverables

| Type | Count | Details |
|------|-------|---------|
| Configuration | 2 | `objects.json` (expanded), `ambient-events.json` |
| Services | 1 | `AmbientEventService` |
| Service Extensions | 1 | `DescriptorService` caching |
| Descriptor Pools | ~15 | Object types, ambient events |
| Unit Tests | ~14 | Object and event tests |

### Interactive Object Descriptors

| Object Type | States | Examination |
|-------------|--------|-------------|
| Door | Closed, Open, Locked, Barred, Broken | Material, age, markings |
| Chest | Closed, Open, Locked, Trapped, Empty | Size, craftsmanship, wear |
| Lever | Up, Down, Stuck, Broken | Mechanism type, rust level |
| Statue | Intact, Damaged, Defaced, Magical | Subject, craftsmanship, inscriptions |
| Altar | Active, Inactive, Desecrated, Blessed | Deity, offerings, condition |

### Object State Descriptions

```json
{
    "door": {
        "closed": [
            "A heavy wooden door bars your path",
            "An iron-banded door stands before you",
            "A stone door blocks the passage"
        ],
        "locked": [
            "The door is firmly locked",
            "A sturdy lock secures this door",
            "You hear the click of a lock refusing to budge"
        ]
    }
}
```

### Ambient Events

Random atmospheric occurrences that add life:

| Event Type | Trigger | Examples |
|------------|---------|----------|
| Sound | Random (exploration) | "A distant scream echoes...", "Something heavy falls nearby" |
| Visual | Random (exploration) | "Shadows shift at the corner of your vision", "A torch flickers and dies" |
| Creature | Combat/exploration | "Rats scatter as you approach", "Bats flutter overhead" |
| Environmental | Biome-specific | "Water drips from stalactites", "Wind howls through cracks" |

### Descriptor Caching

```csharp
// Cache frequently-used descriptor pools
public class CachedDescriptorService : DescriptorService
{
    private readonly IMemoryCache _cache;
    private readonly TimeSpan _cacheExpiration = TimeSpan.FromMinutes(5);

    protected override DescriptorPool GetPool(string poolPath)
    {
        return _cache.GetOrCreate(poolPath, entry =>
        {
            entry.AbsoluteExpirationRelativeToNow = _cacheExpiration;
            return base.GetPool(poolPath);
        });
    }
}
```

### Integration Points

- Room descriptions use environment context + sensory layers
- Combat uses weapon-type + damage-tier descriptors
- Abilities use activation + effect descriptors
- Examine command uses object descriptors
- Exploration triggers ambient events

### Acceptance Criteria

- [x] Interactive object descriptors implemented (8 object types)
- [x] Object state descriptions vary appropriately (21 states)
- [x] Object examination provides rich detail (3 depth levels)
- [x] Ambient event system triggers randomly
- [x] Ambient events match environment context (biome-specific pools)
- [x] Descriptor caching improves performance (IMemoryCache with 5-minute sliding expiration)
- [x] All descriptor systems integrate smoothly
- [x] ~14 unit tests pass (33 tests implemented)

---

## Dependencies & Prerequisites

```
v0.0.10 (Documentation & Polish) - REQUIRED
    │
    └── DescriptorService, themes, logging ──────────────────────┐
                                                                  │
                                                                  ▼
v0.0.11 (Descriptors & Ambience)
    │
    ├── v0.0.11a: Descriptor Framework Expansion ─────────────────┐
    │       Dependencies: None (can start immediately)            │
    │                                                             │
    ├── v0.0.11b: Combat & Ability Descriptors ───────────────────┤
    │       Dependencies: v0.0.11a (environment context)          │
    │                     v0.0.9 (damage types)                   │
    │                     v0.0.6 (status effects)                 │
    │                                                             │
    ├── v0.0.11c: Environmental & Sensory Descriptors ────────────┤
    │       Dependencies: v0.0.11a (environment context, biomes)  │
    │                                                             │
    └── v0.0.11d: Interactive Objects & Polish ───────────────────┘
            Dependencies: v0.0.11a, v0.0.11b, v0.0.11c
```

**Note:** v0.0.11b and v0.0.11c can be developed in parallel after v0.0.11a is complete. v0.0.11d integrates all previous phases.

---

## Estimated Effort Summary

| Phase | New Files | Modified Files | Est. Tests | Complexity |
|-------|-----------|----------------|------------|------------|
| v0.0.11a | ~6 | ~3 | ~18 | High |
| v0.0.11b | ~4 | ~2 | ~15 | Medium |
| v0.0.11c | ~5 | ~2 | ~18 | Medium |
| v0.0.11d | ~4 | ~4 | ~14 | Medium |
| **Total** | **~19** | **~11** | **~65** | |

---

## Risk Assessment

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Coherence rules too restrictive | Medium | Medium | Allow override flags, soft warnings |
| Descriptor variety insufficient | Medium | Low | Community contributions, modular config |
| Performance with many descriptors | Medium | Low | Caching, lazy loading |
| Conflicting biome definitions | Low | Medium | Clear documentation, validation |
| Integration complexity | Medium | Medium | Phased integration testing |

---

## Design Decisions

### Environment Categories

| Decision | Value | Notes |
|----------|-------|-------|
| **Category model** | Configurable definitions | Not hardcoded enums |
| **Exclusion rules** | Configuration-driven | Allows customization |
| **Default enforcement** | Soft (warnings) | Hard (errors) optional |
| **Biome source** | JSON configuration | Data-driven |

### Combat Descriptors

| Decision | Value | Notes |
|----------|-------|-------|
| **Damage tiers** | 6 levels (0-15, 15-30, 30-50, 50-75, 75-90, 90-100) | Clear differentiation |
| **Weapon types** | Configurable pool keys | Extensible |
| **Death variations** | By monster category | Not per-monster |
| **Critical/miss** | Separate pools | Distinct flavor |

### Sensory Descriptors

| Decision | Value | Notes |
|----------|-------|-------|
| **Sound layers** | 3 (distant, nearby, immediate) | Depth without complexity |
| **Smell intensity** | 4 levels | Sufficient variety |
| **Weather** | Indoor/outdoor variants | Context-aware |
| **Time-of-day** | 4 periods (dawn, day, dusk, night) | Simple cycle |

### Object Descriptors

| Decision | Value | Notes |
|----------|-------|-------|
| **Object states** | Per-type definitions | Flexible |
| **Examination depth** | 3 levels (glance, look, examine) | Progressive detail |
| **Ambient events** | Random with context filter | Immersive |
| **Caching strategy** | Memory cache with TTL | Simple, effective |

---

## Files Summary

### Files to Create (New)

| Phase | File | Purpose |
|-------|------|---------|
| 11a | `BiomeDefinition.cs` | Biome entity |
| 11a | `EnvironmentCategory.cs` | Category definitions |
| 11a | `EnvironmentContext.cs` | Room environment state |
| 11a | `CategoryExclusionRule.cs` | Conflict rules |
| 11a | `EnvironmentCoherenceService.cs` | Validation service |
| 11a | `config/biomes.json` | Biome definitions |
| 11a | `config/environment-categories.json` | Category definitions |
| 11b | `config/descriptors/combat-hits.json` | Weapon-type hits |
| 11b | `config/descriptors/combat-deaths.json` | Death variations |
| 11b | `config/descriptors/ability-effects.json` | Ability flavor |
| 11c | `SensoryDescriptorService.cs` | Sensory combination |
| 11c | `config/descriptors/lighting.json` | Light sources |
| 11c | `config/descriptors/weather.json` | Weather conditions |
| 11d | `AmbientEventService.cs` | Ambient events |
| 11d | `config/ambient-events.json` | Event definitions |

### Files to Modify

| Phase | File | Changes |
|-------|------|---------|
| 11a | `DescriptorService.cs` | Add environment context support |
| 11a | `Room.cs` | Add EnvironmentContext property |
| 11a | `DescriptorConfiguration.cs` | Add category support |
| 11b | `DescriptorService.cs` | Add combat descriptor methods |
| 11b | `CombatService.cs` | Use combat descriptors |
| 11c | `DescriptorService.cs` | Add sensory methods |
| 11d | `DescriptorService.cs` | Add caching |
| 11d | `GameView.cs` | Trigger ambient events |

---

## Final Metrics

| Metric | Before v0.0.11 | After v0.0.11 |
|--------|----------------|---------------|
| Descriptor pools | ~10 | ~60 |
| Descriptor entries | ~100 | ~500+ |
| Environment categories | 0 | 5 |
| Biome definitions | 0 | 8+ |
| Coherence rules | 0 | ~10 |
| Sensory layers | 1 | 5 |
| Ambient events | 0 | 20+ |
| Unit tests (descriptor) | ~5 | ~70 |

---

## Next Steps

1. **Review & Approve** - Confirm scope breakdown
2. **v0.0.11a Design Spec** - Create environment category specification
3. **Implement v0.0.11a** - Build coherence framework
4. **v0.0.11b Design Spec** - Create combat descriptor specification
5. **v0.0.11c Design Spec** - Create sensory descriptor specification (can parallel 11b)
6. **Implement v0.0.11b & 11c** - Build descriptor libraries
7. **v0.0.11d Design Spec** - Create integration specification
8. **Implement v0.0.11d** - Integrate and polish

---

*This scope breakdown establishes a comprehensive descriptor and ambience system that prevents incoherent environments while providing rich, varied atmospheric text. The category/exclusion system ensures that rooms won't be described as both frozen and volcanic, while the expanded descriptor libraries provide immersive variety for combat, exploration, and environmental storytelling.*
