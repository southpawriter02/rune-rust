# v0.8.3b Changelog: Overlay Refinement

**Version:** 0.8.3b  
**Phase:** Overlay Refinement  
**Date:** 2026-01-16  
**Status:** ✅ Complete

---

## Summary

Implements enhanced combat grid overlays with gradient-based movement range visualization and a quick-slot bar for ability/item shortcuts (keys 1-8).

---

## Added

### Presentation Layer - Controls

| Control | Description |
|---------|-------------|
| `MovementRangeOverlay` | Gradient opacity overlay (0.7 near → 0.2 far) |
| `PathPreviewOverlay` | Dotted path on hover with cost display |
| `QuickSlotControl` | Individual slot with icon, keybind, cooldown |
| `QuickSlotBar` | Container for 8 quick slots |

**MovementRangeOverlay Properties:**
- `ReachablePositions` — List of valid movement cells
- `Origin` — Player's current position
- `MaxDistance` — Maximum movement range
- `OverlayColor` — Configurable highlight color

**QuickSlotControl Properties:**
- `SlotNumber` — 1-8
- `Icon` — Ability/item icon
- `IsOnCooldown` — Cooldown state
- `CooldownRemaining` — Remaining time

### Presentation Layer - ViewModels

| ViewModel | Description |
|-----------|-------------|
| `QuickSlotViewModel` | Slot assignment and state |
| `QuickSlotBarViewModel` | 8 slots with keyboard handling |

**QuickSlotBarViewModel Features:**
- `UseSlot(int)` — Activate slot 1-8
- `HandleKeyPress(Key)` — Keyboard 1-8, NumPad1-8
- `AbilityUsed` / `ItemUsed` — Events for integration

### Presentation Layer - Styles

| File | Description |
|------|-------------|
| `CombatOverlayStyles.axaml` | Quick-slot bar, control templates, hints |

---

## Gradient Opacity Formula

```
opacity = 0.7 - (0.5 × distance / maxDistance)
```

| Distance | Opacity |
|----------|---------|
| 0 (origin) | 0.70 |
| 1 | 0.60 |
| 2 | 0.50 |
| 3 | 0.40 |
| 4 | 0.30 |
| 5+ (max) | 0.20 |

---

## Test Results

| Category | Tests |
|----------|-------|
| MovementRangeOverlayTests | 5 |
| QuickSlotViewModelTests | 5 |
| QuickSlotBarViewModelTests | 8 |
| **Total new** | **18** |

---

## Files Changed

### New Files
- `src/Presentation/.../Controls/MovementRangeOverlay.cs`
- `src/Presentation/.../Controls/PathPreviewOverlay.cs`
- `src/Presentation/.../Controls/QuickSlotControl.cs`
- `src/Presentation/.../Controls/QuickSlotBar.axaml`
- `src/Presentation/.../Controls/QuickSlotBar.axaml.cs`
- `src/Presentation/.../ViewModels/QuickSlotViewModel.cs`
- `src/Presentation/.../ViewModels/QuickSlotBarViewModel.cs`
- `src/Presentation/.../Styles/CombatOverlayStyles.axaml`
- `tests/.../Controls/MovementRangeOverlayTests.cs`
- `tests/.../ViewModels/QuickSlotViewModelTests.cs`
- `tests/.../ViewModels/QuickSlotBarViewModelTests.cs`

---

## Next Steps

- **v0.8.3c** — Combat Summary (battle log panel, XP/loot summary)
