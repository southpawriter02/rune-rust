# v0.15.0d Changelog

## Summary
Introduces contested checks (two-party net success comparison) and extended checks (multi-round success accumulation) building on v0.15.0c success-counting mechanics.

## Added

### Domain Layer - Enums
- **`ContestedOutcome`** enum in `Domain/Enums/` - 6 contested check outcomes:
  - `InitiatorWins` - Initiator has more net successes
  - `DefenderWins` - Defender has more net successes
  - `Tie` - Equal net successes (initiator gets minor advantage)
  - `BothFumble` - Both fumbled (mutual failure)
  - `InitiatorFumble` - Initiator fumbled (defender auto-wins)
  - `DefenderFumble` - Defender fumbled (initiator auto-wins)

- **`ExtendedCheckStatus`** enum in `Domain/Enums/` - 5 extended check states:
  - `InProgress` - Check still active
  - `Succeeded` - Target successes reached
  - `Failed` - Rounds exhausted
  - `CatastrophicFailure` - 3 consecutive fumbles
  - `Abandoned` - Player chose to stop

### Domain Layer - Constants
- **`ExtendedCheckConstants`** in `Domain/Constants/`:
  - `FumblePenalty = 2` - Accumulated successes lost per fumble
  - `CatastrophicFumbleThreshold = 3` - Consecutive fumbles for disaster
  - `DefaultMaxRounds = 10` - Default round limit
  - `MinimumTargetSuccesses = 1` - Validation minimum

### Domain Layer - Value Objects
- **`ContestedCheckResult`** in `Domain/ValueObjects/`:
  - Properties: InitiatorId, DefenderId, InitiatorRoll, DefenderRoll, Outcome, Margin
  - Computed: WinnerId, HasWinner, HadFumble, IsMutualFumble, IsTie
  - Static `DetermineOutcome()` method for resolution logic

### Domain Layer - Entities
- **`ExtendedCheckState`** in `Domain/Entities/`:
  - Factory `Create()` method with validation
  - `ProcessRound()` - accumulates successes, handles fumbles
  - `Abandon()` - marks check as abandoned
  - Properties: AccumulatedSuccesses, RoundsRemaining, ConsecutiveFumbles, Status
  - Computed: Progress, IsActive, IsComplete, IsAtRisk, SuccessesNeeded

### Application Layer - SkillCheckService Extensions
- **`ResolveContestedCheck()`** - New contested check method returning structured result
- **`StartExtendedCheck()`** - Creates new extended check state
- **`PerformExtendedCheckRound()`** - Processes one round of extended check
- **`AbandonExtendedCheck()`** - Abandons in-progress extended check
- Comprehensive logging with IGameEventLogger integration

### Unit Tests
- **`ContestedCheckResultTests.cs`** - 9 tests for contested check mechanics
- **`ExtendedCheckStateTests.cs`** - 14 tests for extended check mechanics

## Verification
- Build: **0 errors, 0 warnings**
- Tests: **23 passing** (ContestedCheckResultTests + ExtendedCheckStateTests)
