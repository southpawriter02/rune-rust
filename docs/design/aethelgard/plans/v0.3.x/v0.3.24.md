Here is the comprehensive implementation plan for v0.3.24: The Precursor (Deprecation & Cleanup).
This is the final housekeeping milestone before the massive content expansion of The Saga (v0.4.0). It focuses on paying down technical debt accumulated during the "Walking Skeleton" and "Long Polish" phases, ensuring the codebase is lean, stable, and ready for production-level content injection.
To manage the distinct tasks of code hygiene and release engineering, this version is split into two sub-versions:
	•	v0.3.24a: The Broom (Deprecation Cleanup) – Removing legacy code, test harnesses, and hardcoded artifacts.
	•	v0.3.24b: The Golden Master (Alpha Packaging) – Version stamping, build configuration, and release preparation.

v0.3.24a: The Broom (Deprecation Cleanup)
Goal: Remove all code paths marked [Obsolete], delete temporary test assets (like the "Training Dummy" logic), and ensure debug commands are stripped or locked behind #if DEBUG directives.
1. Architecture & Data Flow
	•	Audit Strategy:
	◦	Static Analysis: Use Roslyn analyzers to identify unused private members and [Obsolete] usage.
	◦	Runtime Check: Verify that no "Test" entities (e.g., RoomTemplate.TestChamber) appear in the production generation tables.
	•	Debug Isolation:
	◦	Wrap DebugConsoleService registration in Program.cs with #if DEBUG or a configuration flag check EnableDebugTools.
	◦	Ensure CheatService cannot be instantiated in Release builds.
Data Flow: Cleanup Process
	1	Identify: Scan solution for GenerateTestMapAsync (Legacy v0.0.5) [Source 1523].
	2	Verify: Check references. Is it only used in Tests?
	3	Action:
	◦	If yes: Move code to RuneAndRust.Tests.Common.
	◦	If no: Refactor consumer to use DungeonGenerator.GenerateDungeonAsync.
	4	Delete: Remove the method from RuneAndRust.Engine.
2. Logic Decision Trees
A. Obsolete Code Removal Logic Input: Method M marked [Obsolete]
	1	Check Usage: Find All References.
	2	References Exist?
	◦	Yes: Update call sites to use the new implementation (e.g., replace Console.WriteLine with IPresenter.Write).
	◦	No: Delete Method.
	3	Is Method Public Interface?
	◦	Yes: Determine if breaking change is acceptable (Yes for v0.4.0 Alpha).
B. Debug Command Safety Input: User enters "/god"
	1	Environment Check: Is Build Release?
	◦	Yes: Return "Unknown command." (Do not acknowledge cheat exists).
	◦	No: Proceed to CheatService.
3. Code Implementation
A. Debug Isolation (Program.cs) File: RuneAndRust.Terminal/Program.cs
// Only register cheat services in Debug builds or if explicitly enabled via config
#if DEBUG
    services.AddSingleton<IDebugConsoleService, DebugConsoleService>();
    services.AddSingleton<ICheatService, CheatService>();
#endif
B. Version Info Injection File: RuneAndRust.Core/Constants/BuildInfo.cs
public static class BuildInfo
{
    public const string Version = "0.4.0-alpha";
    public const string Codename = "The Saga";
    public static readonly DateTime BuildDate = DateTime.UtcNow;

    public static bool IsDebug =>
#if DEBUG
        true;
#else
        false;
#endif
}
4. Deliverable Checklist (v0.3.24a)
	•	Cleanup:
	◦	[ ] Remove GenerateTestMapAsync from DungeonGenerator.
	◦	[ ] Remove hardcoded "Training Dummy" creation from CombatService (rely purely on EnemyFactory).
	◦	[ ] Remove any Console.WriteLine calls in Engine layer (strict enforcement of ILogger).
	•	Safety:
	◦	[ ] Wrap CheatService in #if DEBUG.
	◦	[ ] Ensure SeedManager uses a random seed by default in Release mode.
	•	Tests:
	◦	[ ] Verify tests pass without the legacy "Test Room" assets.

v0.3.24b: The Golden Master (Alpha Packaging)
Goal: Prepare the application for "Release" distribution. This involves setting the version to v0.4.0, configuring production logging levels, and verifying the database migration pipeline from a fresh install.
1. Architecture & Data Flow
	•	Versioning: Establish a centralized BuildInfo source used by TitleScreen, CrashHandler, and SaveFiles (to detect save incompatibility).
	•	Logging Policy:
	◦	Dev: MinimumLevel.Verbose (File + Console).
	◦	Prod: MinimumLevel.Information (File only), MinimumLevel.Warning (Console).
2. Logic Decision Trees
A. Save Migration Logic Input: Loading SaveFile
	1	Check Version: Read SaveGame.GameVersion.
	2	Comparison:
	◦	If SaveVersion < 0.4.0: Reject (Alpha wipe). Show "Incompatible Save (Pre-Alpha)".
	◦	If SaveVersion == 0.4.0: Load.
	◦	If SaveVersion > 0.4.0: Warn "Save from newer version".
3. Code Implementation
A. Production Logging Config File: RuneAndRust.Terminal/Program.cs
var logConfig = new LoggerConfiguration();

#if DEBUG
    logConfig.MinimumLevel.Verbose().WriteTo.Console();
#else
    logConfig.MinimumLevel.Information()
             .WriteTo.File("logs/game.log", rollingInterval: RollingInterval.Day)
             .WriteTo.Console(restrictedToMinimumLevel: LogEventLevel.Warning);
#endif
4. Deliverable Checklist (v0.3.24b)
	•	Configuration:
	◦	[ ] Update .csproj AssemblyVersion to 0.4.0.0.
	◦	[ ] Set appsettings.json default log level to Information.
	•	Database:
	◦	[ ] Squash all v0.0.x - v0.3.x migrations into a single Initial_v0_4_0 migration.
	◦	[ ] Verify dotnet ef database update runs cleanly on an empty DB.
	•	Deployment:
	◦	[ ] Create publish.sh script (dotnet publish -c Release -r win-x64 / linux-x64).

5. Logging Requirements
System
Event
Level
Message Template
Properties
System
Startup
Info
"Rune & Rust {Version} ({Codename}) Initialized. Env: {Env}"
Version, Codename, Env
System
Deprecation
Warning
"Access to deprecated feature {Feature} denied in Release."
Feature

6. Testing Strategy
Unit Tests (ArchitectureTests.cs):
	•	No_Console_Write_In_Engine: Reflection scan of RuneAndRust.Engine assembly to ensure System.Console is not referenced.
	•	Version_Format: Assert BuildInfo.Version matches regex \d+\.\d+\.\d+(-[a-z]+)?.
Integration Tests (ReleaseReadinessTests.cs):
	•	Fresh_Install_Migration:
	1	Drop Test Database.
	2	Run context.Database.Migrate().
	3	Assert Database created and Seeders ran successfully.
	•	Debug_Commands_Disabled:
	◦	(Run in Release config)
	◦	Input /god.
	◦	Assert output contains "Unknown command".

7. Draft Changelog (v0.3.24)
# Changelog: v0.3.24 - The Precursor

**Release Date:** 2026-03-XX

## Summary
The final update of the "Long Polish" milestone cleans up the codebase and prepares the engine for the v0.4.0 Alpha release. It removes deprecated testing scaffolding, secures debug commands, and finalizes the database schema.

## Changes
- **Cleanup:** Removed legacy `GenerateTestMapAsync` and hardcoded enemy definitions.
- **Security:** Debug commands (`/god`, `/tp`) are now disabled in Release builds.
- **Architecture:** Consolidated database migrations into a clean v0.4.0 baseline.
- **UI:** Added version number and codename ("The Saga") to the Title Screen.
- **Logging:** Configured reduced logging noise for production builds.

## Breaking Changes
- **Save Wipe:** All save files from v0.3.x are incompatible with v0.4.0 due to schema consolidation.