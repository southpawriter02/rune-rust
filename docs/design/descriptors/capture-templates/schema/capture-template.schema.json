{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://runeandrust.game/schemas/capture-template.schema.json",
  "title": "Capture Template Collection",
  "description": "Schema for Data Capture template files in Rune & Rust. All content must follow AAM-VOICE Layer 2 (Diagnostic) constraints and Domain 4 compliance (no precision measurements).",
  "type": "object",
  "required": ["$schema", "category", "version", "templates"],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "Reference to this schema file"
    },
    "category": {
      "type": "string",
      "description": "Category identifier matching the filename (kebab-case)",
      "pattern": "^[a-z][a-z0-9-]*$",
      "examples": ["rusted-servitor", "blighted-creature", "ancient-ruin"]
    },
    "version": {
      "type": "string",
      "description": "Schema version for migration tracking (semver format)",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "examples": ["1.0.0"]
    },
    "description": {
      "type": "string",
      "description": "Human-readable description of this category for content authors"
    },
    "matchKeywords": {
      "type": "array",
      "description": "Default keywords for all templates in this category (can be overridden per-template)",
      "items": {
        "type": "string",
        "minLength": 2
      },
      "minItems": 1
    },
    "templates": {
      "type": "array",
      "description": "Array of capture templates in this category",
      "items": { "$ref": "#/$defs/captureTemplate" },
      "minItems": 1
    }
  },
  "$defs": {
    "captureTemplate": {
      "type": "object",
      "description": "A single Data Capture template definition",
      "required": ["id", "type", "fragmentContent", "source"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique template identifier (kebab-case, globally unique across all files)",
          "pattern": "^[a-z][a-z0-9-]*$",
          "examples": ["servitor-fungal-infection", "container-note-fragment"]
        },
        "type": {
          "type": "string",
          "description": "Capture type classification from CaptureType enum",
          "enum": [
            "TextFragment",
            "EchoRecording",
            "VisualRecord",
            "Specimen",
            "OralHistory",
            "RunicTrace"
          ]
        },
        "fragmentContent": {
          "type": "string",
          "description": "The lore text content of this fragment. Must follow Domain 4 constraints (no precision measurements like percentages, exact distances, or technical specifications).",
          "minLength": 20,
          "maxLength": 1000
        },
        "source": {
          "type": "string",
          "description": "Description of where/how the fragment was discovered (displayed in UI)",
          "minLength": 5,
          "maxLength": 100,
          "examples": ["Servitor examination", "Found in container", "Wall inscription"]
        },
        "matchKeywords": {
          "type": "array",
          "description": "Keywords for Codex auto-assignment. If provided, overrides category-level matchKeywords.",
          "items": {
            "type": "string",
            "minLength": 2
          },
          "minItems": 1
        },
        "quality": {
          "type": "integer",
          "description": "Quality value affecting Legend rewards. Higher values grant more progress toward unlocking Codex entries.",
          "minimum": 1,
          "maximum": 100,
          "default": 15
        },
        "tags": {
          "type": "array",
          "description": "Optional metadata tags for filtering and categorization (not displayed in-game)",
          "items": { "type": "string" },
          "examples": [["aesir", "pre-glitch"], ["blight", "creature"]]
        },
        "domain4Notes": {
          "type": "string",
          "description": "Author notes on Domain 4 compliance. For internal documentation only, not displayed in-game."
        }
      }
    }
  }
}
