<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:RuneAndRust.Presentation.Gui.ViewModels"
        xmlns:models="using:RuneAndRust.Presentation.Gui.Models"
        x:Class="RuneAndRust.Presentation.Gui.Views.ShopWindow"
        x:DataType="vm:ShopWindowViewModel"
        Title="Shop"
        Width="750" Height="600"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        ShowInTaskbar="False"
        Background="#1E1E1E">
    
    <Design.DataContext>
        <vm:ShopWindowViewModel />
    </Design.DataContext>
    
    <Grid RowDefinitions="Auto,*,Auto,Auto">
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#2D2D2D" Padding="16,12">
            <TextBlock Text="{Binding ShopName}" FontWeight="Bold" FontSize="16" />
        </Border>
        
        <!-- Inventory Panels -->
        <Grid Grid.Row="1" ColumnDefinitions="*,*">
            
            <!-- Shop Inventory (Left) -->
            <Border Grid.Column="0" Background="#1A1A1A" Margin="8" CornerRadius="4">
                <Grid RowDefinitions="Auto,*">
                    <TextBlock Grid.Row="0" Text="SHOP INVENTORY" 
                               FontWeight="SemiBold" Foreground="#4CAF50" Margin="12,8" />
                    
                    <ScrollViewer Grid.Row="1" Padding="8">
                        <ItemsControl ItemsSource="{Binding ShopItems}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Padding="8,6" CornerRadius="4" Margin="0,2" Cursor="Hand"
                                            Background="{Binding IsSelected, Converter={StaticResource BoolToBrushConverter}}"
                                            PointerPressed="OnShopItemPressed">
                                        <Grid ColumnDefinitions="Auto,*,Auto">
                                            <TextBlock Grid.Column="0" Text="{Binding Icon}" 
                                                       FontSize="16" Margin="0,0,8,0" />
                                            <TextBlock Grid.Column="1" Text="{Binding Name}" 
                                                       TextTrimming="CharacterEllipsis" />
                                            <TextBlock Grid.Column="2" Text="{Binding BuyPriceText}" 
                                                       Foreground="Gold" Margin="8,0,0,0" />
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>
            
            <!-- Player Inventory (Right) -->
            <Border Grid.Column="1" Background="#1A1A1A" Margin="8" CornerRadius="4">
                <Grid RowDefinitions="Auto,*">
                    <TextBlock Grid.Row="0" Text="YOUR INVENTORY" 
                               FontWeight="SemiBold" Foreground="#3F51B5" Margin="12,8" />
                    
                    <ScrollViewer Grid.Row="1" Padding="8">
                        <ItemsControl ItemsSource="{Binding PlayerItems}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Padding="8,6" CornerRadius="4" Margin="0,2" Cursor="Hand"
                                            Background="{Binding IsSelected, Converter={StaticResource BoolToBrushConverter}}"
                                            PointerPressed="OnPlayerItemPressed">
                                        <Grid ColumnDefinitions="Auto,*,Auto">
                                            <TextBlock Grid.Column="0" Text="{Binding Icon}" 
                                                       FontSize="16" Margin="0,0,8,0" />
                                            <TextBlock Grid.Column="1" Text="{Binding Name}" 
                                                       TextTrimming="CharacterEllipsis" />
                                            <TextBlock Grid.Column="2" Text="{Binding SellPriceText}" 
                                                       Foreground="#888888" Margin="8,0,0,0" />
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>
            
        </Grid>
        
        <!-- Selected Item Details -->
        <Border Grid.Row="2" Background="#252526" Margin="8,0,8,8" Padding="12" CornerRadius="4"
                IsVisible="{Binding HasSelectedItem}">
            <Grid ColumnDefinitions="*,Auto">
                <StackPanel Grid.Column="0">
                    <TextBlock Text="{Binding SelectedItemName}" FontWeight="Bold" FontSize="14" />
                    <TextBlock Text="{Binding SelectedItemStats}" Foreground="#888888" Margin="0,4,0,0" />
                    <TextBlock Text="{Binding SelectedItemDescription}" TextWrapping="Wrap" 
                               Foreground="#CCCCCC" Margin="0,8,0,0" />
                </StackPanel>
                
                <!-- Comparison Panel -->
                <Border Grid.Column="1" Background="#1A1A1A" CornerRadius="4" Padding="12" 
                        Width="250" Margin="12,0,0,0"
                        IsVisible="{Binding HasComparison}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="vs. " Foreground="#888888" />
                            <TextBlock Text="{Binding Comparison.ComparedTo}" />
                        </StackPanel>
                        <ItemsControl ItemsSource="{Binding Comparison.Lines}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="models:ComparisonLine">
                                    <Grid ColumnDefinitions="Auto,*,Auto" Margin="0,2">
                                        <TextBlock Grid.Column="0" Text="{Binding Stat}" 
                                                   Foreground="#888888" Margin="0,0,12,0" />
                                        <TextBlock Grid.Column="1" Text="{Binding ComparisonText}" />
                                        <TextBlock Grid.Column="2" Text="{Binding ResultIndicator}" 
                                                   Margin="8,0,0,0" />
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
        
        <!-- Footer -->
        <Border Grid.Row="3" Background="#252526" Padding="16,12">
            <Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto">
                
                <!-- Gold Display -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="ðŸ’°" FontSize="18" Margin="0,0,8,0" />
                    <TextBlock Text="Gold:" Foreground="#888888" Margin="0,0,8,0" />
                    <TextBlock Text="{Binding PlayerGold}" Foreground="Gold" FontWeight="Bold" />
                </StackPanel>
                
                <!-- Transaction Message -->
                <TextBlock Grid.Column="1" Text="{Binding TransactionMessage}"
                           HorizontalAlignment="Center" VerticalAlignment="Center" />
                
                <!-- Buy Button -->
                <Button Grid.Column="2" Content="{Binding BuyButtonText}"
                        Command="{Binding BuyCommand}" IsEnabled="{Binding CanBuy}"
                        Background="#4CAF50" Foreground="White" Padding="16,8" Margin="0,0,8,0" />
                
                <!-- Sell Button -->
                <Button Grid.Column="3" Content="{Binding SellButtonText}"
                        Command="{Binding SellCommand}" IsEnabled="{Binding CanSell}"
                        Background="#FF9800" Foreground="White" Padding="16,8" Margin="0,0,8,0" />
                
                <!-- Close Button -->
                <Button Grid.Column="4" Content="CLOSE"
                        Command="{Binding CloseCommand}" Padding="16,8" />
                
            </Grid>
        </Border>
        
    </Grid>
</Window>
