# v0.6.0c Design Specification: Color Themes

**Version:** 0.6.0c
**Parent:** v0.6.0 (Core UI Framework)
**Prerequisites:** v0.6.0b Complete (Status Bar)
**Status:** Design Complete

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Feature Overview](#2-feature-overview)
3. [Architecture Diagrams](#3-architecture-diagrams)
4. [Color Theme Service](#4-color-theme-service)
5. [Message Types](#5-message-types)
6. [Theme Configuration](#6-theme-configuration)
7. [Data Model](#7-data-model)
8. [Configuration Files](#8-configuration-files)
9. [Logging Specifications](#9-logging-specifications)
10. [Unit Testing Requirements](#10-unit-testing-requirements)
11. [Use Cases](#11-use-cases)
12. [Deliverable Checklist](#12-deliverable-checklist)
13. [Acceptance Criteria](#13-acceptance-criteria)
14. [Dependencies](#14-dependencies)
15. [Future Considerations](#15-future-considerations)

---

## 1. Executive Summary

### Purpose

The Color Themes system provides configurable color styling for all game output, enhancing visual clarity and immersion. Themes define colors for different message types (combat, loot, system), enabling consistent styled output across the TUI. The system includes a default dark theme, an optional light theme, and fallback handling for terminals without color support.

### Key Deliverables

| Category | Items |
|----------|-------|
| **Interfaces** | IColorThemeService |
| **Services** | ColorThemeService |
| **Value Objects** | ColorThemeConfig, ColoredText |
| **Enums** | MessageType (17 values) |
| **Configuration** | themes.json with dark/light themes |
| **Tests** | ~10 new unit tests |

### Architectural Significance

This version establishes the **Themed Output Pattern** that will be used throughout the game:
- All player-facing text uses MessageType for consistent coloring
- Themes are data-driven via JSON configuration
- Color fallback ensures compatibility with limited terminals

---

## 2. Feature Overview

```
v0.6.0c Features
├── IColorThemeService Interface
│   ├── CurrentTheme property
│   ├── SetTheme() method
│   ├── GetColor() method
│   ├── AvailableThemes property
│   ├── WriteColored() method
│   └── WriteColoredAt() method
├── ColorThemeService Implementation
│   ├── Theme loading from JSON
│   ├── Theme switching
│   ├── Color lookup by MessageType
│   ├── Console color application
│   └── Color fallback for limited terminals
├── MessageType Enum
│   ├── System messages (Default, Info, Warning, Error)
│   ├── Combat messages (Hit, Miss, Heal, Damage, Critical)
│   ├── Loot messages (Common, Uncommon, Rare, Epic, Legendary)
│   └── Other (Dialogue, Description, Command, Success, Failure)
├── Theme Configuration
│   ├── Dark theme (default)
│   ├── Light theme (optional)
│   └── Message color mappings
└── ColoredText Value Object
    ├── Text content
    ├── MessageType
    └── Factory methods
```

---

## 3. Architecture Diagrams

### 3.1 Color Theme Architecture

```
┌─────────────────────────────────────────────────────────────────────┐
│                    COLOR THEME ARCHITECTURE                          │
└─────────────────────────────────────────────────────────────────────┘

    CONFIGURATION                 APPLICATION                  OUTPUT
    ─────────────                 ───────────                  ──────

    ┌─────────────────┐      ┌──────────────────────┐    ┌───────────────┐
    │   themes.json   │─────▶│   IColorThemeService │───▶│ Console       │
    ├─────────────────┤      ├──────────────────────┤    │ (Colored)     │
    │ themes:         │      │ CurrentTheme         │    └───────────────┘
    │   dark:         │      │ SetTheme()           │
    │     combat-hit  │      │ GetColor()           │
    │     combat-miss │      │ WriteColored()       │
    │     loot-rare   │      │ WriteColoredAt()     │
    │   light:        │      │ AvailableThemes      │
    │     ...         │      └──────────────────────┘
    └─────────────────┘                │
                                       │ uses
                                       ▼
                          ┌──────────────────────┐
                          │   ITerminalService   │
                          │   (v0.6.0a)          │
                          ├──────────────────────┤
                          │ SupportsColor        │
                          │ Write()              │
                          │ SetCursorPosition()  │
                          └──────────────────────┘
```

### 3.2 Color Resolution Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                     COLOR RESOLUTION FLOW                            │
└─────────────────────────────────────────────────────────────────────┘

    WriteColored("You deal 25 damage!", MessageType.CombatDamage)
                          │
                          ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ 1. CHECK COLOR SUPPORT                                         │
    ├───────────────────────────────────────────────────────────────┤
    │ IF _terminal.SupportsColor == false:                          │
    │   → Write text without color                                   │
    │   → RETURN                                                     │
    └───────────────────────────────────────────────────────────────┘
                          │ supports color
                          ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ 2. RESOLVE COLOR FROM THEME                                    │
    ├───────────────────────────────────────────────────────────────┤
    │ color = _currentTheme.MessageColors[MessageType.CombatDamage] │
    │ → ConsoleColor.DarkRed                                        │
    └───────────────────────────────────────────────────────────────┘
                          │
                          ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ 3. APPLY COLOR AND WRITE                                       │
    ├───────────────────────────────────────────────────────────────┤
    │ Console.ForegroundColor = ConsoleColor.DarkRed                │
    │ _terminal.Write("You deal 25 damage!")                        │
    │ Console.ResetColor()                                          │
    └───────────────────────────────────────────────────────────────┘
```

### 3.3 Theme Loading Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                      THEME LOADING FLOW                              │
└─────────────────────────────────────────────────────────────────────┘

    Application Start
           │
           ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ 1. LOAD THEMES.JSON                                            │
    ├───────────────────────────────────────────────────────────────┤
    │ Load config/themes.json                                        │
    │ Parse into ColorThemeConfig                                    │
    │ Validate all MessageTypes have colors                          │
    └───────────────────────────────────────────────────────────────┘
           │
           ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ 2. SET DEFAULT THEME                                           │
    ├───────────────────────────────────────────────────────────────┤
    │ Read config.defaultTheme → "dark"                              │
    │ Set CurrentTheme = themes["dark"]                              │
    └───────────────────────────────────────────────────────────────┘
           │
           ▼
    ┌───────────────────────────────────────────────────────────────┐
    │ 3. REGISTER AVAILABLE THEMES                                   │
    ├───────────────────────────────────────────────────────────────┤
    │ AvailableThemes = ["dark", "light"]                           │
    └───────────────────────────────────────────────────────────────┘
           │
           ▼
    Ready for Colored Output
```

---

## 4. Color Theme Service

### 4.1 IColorThemeService Interface

**File:** `src/Core/RuneAndRust.Application/Interfaces/IColorThemeService.cs`

```csharp
namespace RuneAndRust.Application.Interfaces;

/// <summary>
/// Manages color themes for styled console output.
/// </summary>
public interface IColorThemeService
{
    /// <summary>
    /// Gets the current theme name.
    /// </summary>
    string CurrentTheme { get; }
    
    /// <summary>
    /// Sets the active theme.
    /// </summary>
    /// <param name="themeName">Theme name to activate.</param>
    /// <exception cref="ArgumentException">Theme not found.</exception>
    void SetTheme(string themeName);
    
    /// <summary>
    /// Gets the color for a message type.
    /// </summary>
    /// <param name="type">The message type.</param>
    /// <returns>ConsoleColor for the type.</returns>
    ConsoleColor GetColor(MessageType type);
    
    /// <summary>
    /// Gets available theme names.
    /// </summary>
    IReadOnlyList<string> AvailableThemes { get; }
    
    /// <summary>
    /// Writes colored text to the terminal at current position.
    /// </summary>
    /// <param name="text">Text to write.</param>
    /// <param name="type">Message type for color.</param>
    void WriteColored(string text, MessageType type);
    
    /// <summary>
    /// Writes colored text to a specific position.
    /// </summary>
    /// <param name="x">Column position.</param>
    /// <param name="y">Row position.</param>
    /// <param name="text">Text to write.</param>
    /// <param name="type">Message type for color.</param>
    void WriteColoredAt(int x, int y, string text, MessageType type);
}
```

### 4.2 ColorThemeService Implementation

**File:** `src/Infrastructure/RuneAndRust.Infrastructure/Services/ColorThemeService.cs`

```csharp
namespace RuneAndRust.Infrastructure.Services;

/// <summary>
/// Manages color themes for styled console output.
/// </summary>
public class ColorThemeService : IColorThemeService
{
    private readonly ITerminalService _terminal;
    private readonly ILogger<ColorThemeService> _logger;
    private readonly Dictionary<string, ThemeDefinition> _themes;
    
    private ThemeDefinition _currentTheme;
    
    public string CurrentTheme => _currentTheme.Name;
    public IReadOnlyList<string> AvailableThemes { get; }
    
    public ColorThemeService(
        ITerminalService terminal,
        IGameConfigurationProvider configProvider,
        ILogger<ColorThemeService> logger)
    {
        _terminal = terminal;
        _logger = logger;
        
        var config = configProvider.GetThemeConfiguration();
        _themes = config.Themes.ToDictionary(t => t.Key, t => t.Value);
        AvailableThemes = _themes.Keys.ToList();
        
        // Set default theme
        if (!_themes.TryGetValue(config.DefaultTheme, out _currentTheme!))
        {
            _currentTheme = _themes.Values.First();
            _logger.LogWarning("Default theme '{Default}' not found, using '{Fallback}'",
                config.DefaultTheme, _currentTheme.Name);
        }
        
        _logger.LogInformation("ColorThemeService initialized with theme '{Theme}'",
            _currentTheme.Name);
    }
    
    public void SetTheme(string themeName)
    {
        if (!_themes.TryGetValue(themeName.ToLowerInvariant(), out var theme))
        {
            throw new ArgumentException($"Theme '{themeName}' not found. " +
                $"Available: {string.Join(", ", AvailableThemes)}");
        }
        
        _currentTheme = theme;
        _logger.LogInformation("Theme changed to '{Theme}'", themeName);
    }
    
    public ConsoleColor GetColor(MessageType type)
    {
        if (_currentTheme.MessageColors.TryGetValue(type, out var color))
        {
            return color;
        }
        
        _logger.LogDebug("No color defined for {Type}, using default", type);
        return _currentTheme.Foreground;
    }
    
    public void WriteColored(string text, MessageType type)
    {
        if (!_terminal.SupportsColor)
        {
            _terminal.Write(text);
            return;
        }
        
        var previousColor = Console.ForegroundColor;
        try
        {
            Console.ForegroundColor = GetColor(type);
            _terminal.Write(text);
        }
        finally
        {
            Console.ForegroundColor = previousColor;
        }
    }
    
    public void WriteColoredAt(int x, int y, string text, MessageType type)
    {
        _terminal.SetCursorPosition(x, y);
        WriteColored(text, type);
    }
}
```

### 4.3 ThemeDefinition Record

**File:** `src/Infrastructure/RuneAndRust.Infrastructure/Configuration/ThemeDefinition.cs`

```csharp
namespace RuneAndRust.Infrastructure.Configuration;

/// <summary>
/// Represents a complete color theme definition.
/// </summary>
public record ThemeDefinition(
    string Name,
    ConsoleColor Background,
    ConsoleColor Foreground,
    Dictionary<MessageType, ConsoleColor> MessageColors);
```

---

## 5. Message Types

### 5.1 MessageType Enum

**File:** `src/Core/RuneAndRust.Application/Enums/MessageType.cs`

```csharp
namespace RuneAndRust.Application.Enums;

/// <summary>
/// Defines message types for color mapping.
/// </summary>
public enum MessageType
{
    // ──────────────────────────────────────────
    // SYSTEM MESSAGES
    // ──────────────────────────────────────────
    
    /// <summary>Default text color.</summary>
    Default,
    
    /// <summary>Informational messages.</summary>
    Info,
    
    /// <summary>Warning messages.</summary>
    Warning,
    
    /// <summary>Error messages.</summary>
    Error,
    
    // ──────────────────────────────────────────
    // COMBAT MESSAGES
    // ──────────────────────────────────────────
    
    /// <summary>Successful attack hits.</summary>
    CombatHit,
    
    /// <summary>Missed attacks.</summary>
    CombatMiss,
    
    /// <summary>Healing effects.</summary>
    CombatHeal,
    
    /// <summary>Damage dealt/received.</summary>
    CombatDamage,
    
    /// <summary>Critical hits.</summary>
    CombatCritical,
    
    // ──────────────────────────────────────────
    // LOOT/ITEM RARITY
    // ──────────────────────────────────────────
    
    /// <summary>Common quality items.</summary>
    LootCommon,
    
    /// <summary>Uncommon quality items.</summary>
    LootUncommon,
    
    /// <summary>Rare quality items.</summary>
    LootRare,
    
    /// <summary>Epic quality items.</summary>
    LootEpic,
    
    /// <summary>Legendary quality items.</summary>
    LootLegendary,
    
    // ──────────────────────────────────────────
    // OTHER
    // ──────────────────────────────────────────
    
    /// <summary>NPC dialogue.</summary>
    Dialogue,
    
    /// <summary>Descriptive/environmental text.</summary>
    Description,
    
    /// <summary>Command echo/prompts.</summary>
    Command,
    
    /// <summary>Success messages.</summary>
    Success,
    
    /// <summary>Failure messages.</summary>
    Failure
}
```

### 5.2 Message Type Categories

| Category | Types | Typical Colors (Dark Theme) |
|----------|-------|----------------------------|
| **System** | Default, Info, Warning, Error | Gray, Cyan, Yellow, Red |
| **Combat** | Hit, Miss, Heal, Damage, Critical | Red, DarkGray, Green, DarkRed, Magenta |
| **Loot** | Common→Legendary | White, Green, Blue, Magenta, Yellow |
| **Other** | Dialogue, Description, Command, Success, Failure | Yellow, DarkGray, White, Green, Red |

---

## 6. Theme Configuration

### 6.1 ColoredText Value Object

**File:** `src/Presentation/RuneAndRust.TUI/UI/ColoredText.cs`

```csharp
namespace RuneAndRust.Presentation.UI;

/// <summary>
/// Represents text with associated color information.
/// </summary>
/// <param name="Text">The text content.</param>
/// <param name="Type">The message type for color lookup.</param>
/// <param name="ExplicitColor">Optional explicit color override.</param>
public readonly record struct ColoredText(
    string Text,
    MessageType Type,
    ConsoleColor? ExplicitColor = null)
{
    /// <summary>Creates default colored text.</summary>
    public static ColoredText Default(string text) => new(text, MessageType.Default);
    
    /// <summary>Creates info colored text.</summary>
    public static ColoredText Info(string text) => new(text, MessageType.Info);
    
    /// <summary>Creates warning colored text.</summary>
    public static ColoredText Warning(string text) => new(text, MessageType.Warning);
    
    /// <summary>Creates error colored text.</summary>
    public static ColoredText Error(string text) => new(text, MessageType.Error);
    
    /// <summary>Creates combat hit colored text.</summary>
    public static ColoredText CombatHit(string text) => new(text, MessageType.CombatHit);
    
    /// <summary>Creates combat miss colored text.</summary>
    public static ColoredText CombatMiss(string text) => new(text, MessageType.CombatMiss);
    
    /// <summary>Creates combat heal colored text.</summary>
    public static ColoredText CombatHeal(string text) => new(text, MessageType.CombatHeal);
    
    /// <summary>Creates combat damage colored text.</summary>
    public static ColoredText CombatDamage(string text) => new(text, MessageType.CombatDamage);
    
    /// <summary>Creates critical hit colored text.</summary>
    public static ColoredText CombatCritical(string text) => new(text, MessageType.CombatCritical);
    
    /// <summary>Creates common loot colored text.</summary>
    public static ColoredText LootCommon(string text) => new(text, MessageType.LootCommon);
    
    /// <summary>Creates uncommon loot colored text.</summary>
    public static ColoredText LootUncommon(string text) => new(text, MessageType.LootUncommon);
    
    /// <summary>Creates rare loot colored text.</summary>
    public static ColoredText LootRare(string text) => new(text, MessageType.LootRare);
    
    /// <summary>Creates epic loot colored text.</summary>
    public static ColoredText LootEpic(string text) => new(text, MessageType.LootEpic);
    
    /// <summary>Creates legendary loot colored text.</summary>
    public static ColoredText LootLegendary(string text) => new(text, MessageType.LootLegendary);
    
    /// <summary>Creates dialogue colored text.</summary>
    public static ColoredText Dialogue(string text) => new(text, MessageType.Dialogue);
    
    /// <summary>Creates description colored text.</summary>
    public static ColoredText Description(string text) => new(text, MessageType.Description);
    
    /// <summary>Creates success colored text.</summary>
    public static ColoredText Success(string text) => new(text, MessageType.Success);
    
    /// <summary>Creates failure colored text.</summary>
    public static ColoredText Failure(string text) => new(text, MessageType.Failure);
}
```

---

## 7. Data Model

### 7.1 New Interfaces

| Interface | Layer | Description |
|-----------|-------|-------------|
| `IColorThemeService` | Application | Color theme management |

### 7.2 New Services

| Service | Layer | Description |
|---------|-------|-------------|
| `ColorThemeService` | Infrastructure | Theme implementation |

### 7.3 New Value Objects

| Value Object | Layer | Description |
|--------------|-------|-------------|
| `ColoredText` | Presentation | Text with color info |
| `ThemeDefinition` | Infrastructure | Theme data |

### 7.4 New Enums

| Enum | Layer | Description |
|------|-------|-------------|
| `MessageType` | Application | Message categories for coloring |

---

## 8. Configuration Files

### 8.1 themes.json

**File:** `config/themes.json`

```json
{
  "$schema": "./schemas/themes.schema.json",
  "defaultTheme": "dark",
  "themes": {
    "dark": {
      "name": "Dark Theme",
      "background": "Black",
      "foreground": "Gray",
      "messageColors": {
        "default": "Gray",
        "info": "Cyan",
        "warning": "Yellow",
        "error": "Red",
        "combat-hit": "Red",
        "combat-miss": "DarkGray",
        "combat-heal": "Green",
        "combat-damage": "DarkRed",
        "combat-critical": "Magenta",
        "loot-common": "White",
        "loot-uncommon": "Green",
        "loot-rare": "Blue",
        "loot-epic": "Magenta",
        "loot-legendary": "Yellow",
        "dialogue": "Yellow",
        "description": "DarkGray",
        "command": "White",
        "success": "Green",
        "failure": "Red"
      }
    },
    "light": {
      "name": "Light Theme",
      "background": "White",
      "foreground": "Black",
      "messageColors": {
        "default": "Black",
        "info": "DarkCyan",
        "warning": "DarkYellow",
        "error": "DarkRed",
        "combat-hit": "DarkRed",
        "combat-miss": "Gray",
        "combat-heal": "DarkGreen",
        "combat-damage": "Red",
        "combat-critical": "DarkMagenta",
        "loot-common": "Black",
        "loot-uncommon": "DarkGreen",
        "loot-rare": "DarkBlue",
        "loot-epic": "DarkMagenta",
        "loot-legendary": "DarkYellow",
        "dialogue": "DarkYellow",
        "description": "Gray",
        "command": "Black",
        "success": "DarkGreen",
        "failure": "DarkRed"
      }
    }
  }
}
```

### 8.2 Configuration Schema

| Property | Type | Description |
|----------|------|-------------|
| `defaultTheme` | string | Theme to use on startup |
| `themes` | object | Map of theme name to definition |
| `themes.*.name` | string | Display name for theme |
| `themes.*.background` | ConsoleColor | Background color |
| `themes.*.foreground` | ConsoleColor | Default text color |
| `themes.*.messageColors` | object | MessageType → ConsoleColor mapping |

### 8.3 Valid ConsoleColor Values

```
Black, DarkBlue, DarkGreen, DarkCyan, DarkRed, DarkMagenta, DarkYellow, Gray,
DarkGray, Blue, Green, Cyan, Red, Magenta, Yellow, White
```

---

## 9. Logging Specifications

### 9.1 Log Levels by Component

| Component | Level | Events |
|-----------|-------|--------|
| `ColorThemeService` | Information | Initialization, theme change |
| `ColorThemeService` | Warning | Default theme not found |
| `ColorThemeService` | Debug | Color lookup fallback |

### 9.2 Log Message Templates

```csharp
// ColorThemeService
_logger.LogInformation("ColorThemeService initialized with theme '{Theme}'", themeName);
_logger.LogInformation("Theme changed to '{Theme}'", themeName);
_logger.LogWarning("Default theme '{Default}' not found, using '{Fallback}'", defaultTheme, fallback);
_logger.LogDebug("No color defined for {Type}, using default", messageType);
```

---

## 10. Unit Testing Requirements

### 10.1 Test Count by Feature

| Feature | Test Count |
|---------|------------|
| ColorThemeService | 5 |
| MessageType coverage | 2 |
| ColoredText factory | 3 |
| **Total** | **~10** |

### 10.2 Test Specifications

#### ColorThemeServiceTests.cs

```csharp
[TestFixture]
public class ColorThemeServiceTests
{
    [Test]
    public void Constructor_LoadsDefaultTheme();
    
    [Test]
    public void SetTheme_WithValidTheme_ChangesCurrentTheme();
    
    [Test]
    public void SetTheme_WithInvalidTheme_ThrowsArgumentException();
    
    [Test]
    public void GetColor_WithDefinedType_ReturnsCorrectColor();
    
    [Test]
    public void GetColor_WithUndefinedType_ReturnsForegroundColor();
    
    [Test]
    public void WriteColored_WhenColorNotSupported_WritesPlainText();
    
    [Test]
    public void AvailableThemes_ReturnsAllThemeNames();
}
```

#### ColoredTextTests.cs

```csharp
[TestFixture]
public class ColoredTextTests
{
    [Test]
    public void FactoryMethods_SetCorrectMessageType();
    
    [Test]
    public void ExplicitColor_OverridesMessageType();
    
    [Test]
    public void Default_CreatesWithDefaultType();
}
```

---

## 11. Use Cases

### UC-001: Initialize Color Theme
**Actor:** System
**Flow:** App start → Load themes.json → Set default theme → Service ready

### UC-002: Write Combat Message
**Actor:** Combat System
**Flow:** Attack hits → WriteColored("25 damage!", CombatDamage) → Red text displayed

### UC-003: Display Loot Rarity
**Actor:** Loot System
**Flow:** Item found → WriteColored("Legendary Sword", LootLegendary) → Yellow text displayed

### UC-004: Change Theme
**Actor:** Player (via settings)
**Flow:** Select "light" → SetTheme("light") → All subsequent text uses light colors

### UC-005: Fallback on Limited Terminal
**Actor:** System
**Flow:** Terminal.SupportsColor=false → WriteColored() → Plain text (no color codes)

---

## 12. Deliverable Checklist

### Color Theme Service
- [ ] `IColorThemeService` interface created
- [ ] `ColorThemeService` implementation created
- [ ] CurrentTheme property implemented
- [ ] SetTheme() method implemented
- [ ] GetColor() method implemented
- [ ] AvailableThemes property implemented
- [ ] WriteColored() method implemented
- [ ] WriteColoredAt() method implemented
- [ ] Color fallback for non-color terminals implemented

### Message Types
- [ ] `MessageType` enum created
- [ ] All 17 message types defined
- [ ] XML documentation for each value

### Value Objects
- [ ] `ColoredText` record struct created
- [ ] Factory methods for all message types
- [ ] ExplicitColor override support

### Configuration
- [ ] `ThemeDefinition` record created
- [ ] `config/themes.json` created
- [ ] Dark theme with all 17 colors
- [ ] Light theme with all 17 colors
- [ ] `config/schemas/themes.schema.json` created

### Testing
- [ ] ~10 unit tests implemented
- [ ] All tests passing

---

## 13. Acceptance Criteria

### Functional
- [ ] Themes load from JSON configuration correctly
- [ ] Default theme applies on startup
- [ ] Theme can be changed at runtime via SetTheme()
- [ ] All 17 MessageTypes map to colors in each theme
- [ ] GetColor() returns correct color for each type
- [ ] WriteColored() outputs text with correct color
- [ ] WriteColoredAt() positions cursor and writes colored text
- [ ] Color fallback works for terminals without color support
- [ ] AvailableThemes lists all loaded themes
- [ ] Invalid theme name throws ArgumentException

### Combat Message Colors
- [ ] CombatHit displays in damage color (Red)
- [ ] CombatMiss displays in subdued color (DarkGray)
- [ ] CombatHeal displays in healing color (Green)
- [ ] CombatCritical displays in critical color (Magenta)

### Loot Rarity Colors
- [ ] LootCommon displays in neutral color (White)
- [ ] LootUncommon displays in green
- [ ] LootRare displays in blue
- [ ] LootEpic displays in magenta/purple
- [ ] LootLegendary displays in gold/yellow

### Quality
- [ ] Build succeeds with 0 errors
- [ ] Build succeeds with 0 warnings
- [ ] All ~10 unit tests pass
- [ ] XML documentation complete on all public members

---

## 14. Dependencies

### Required from v0.6.0a

| Type | Location | Usage in this phase |
|------|----------|---------------------|
| `ITerminalService` | `Application/Interfaces/ITerminalService.cs` | Write operations, color support check |
| `TerminalService.SupportsColor` | `Infrastructure/Services/TerminalService.cs` | Fallback decision |

### Required from Prior Versions

| Type | Location | Usage |
|------|----------|-------|
| `IGameConfigurationProvider` | `Application/Interfaces/IGameConfigurationProvider.cs` | Load themes.json |

### Provides to Future Versions

| Type | Usage |
|------|-------|
| `IColorThemeService` | All future UI components use for colored output |
| `MessageType` | Standard message categorization |
| `ColoredText` | Typed colored text throughout game |

---

## 15. Future Considerations

### Deferred to v0.6.1
- **Status Bar Coloring**: Apply colors to status bar values (HP red when low)

### Out of Scope
- **Custom User Themes**: User-editable theme files (future settings version)
- **RGB/256-Color Support**: Extended color palette (terminal compatibility concerns)
- **Theme Preview**: In-game theme preview before apply (future UI version)
- **Per-Element Color Override**: Individual element color customization

---

## Display Examples

### Combat Output with Colors

```
COMBAT OUTPUT (Dark Theme):
───────────────────────────

You attack the Skeleton!            [Default - Gray]
  * SLASH *                         [CombatHit - Red]
  ──────▶ 12 damage!                [CombatDamage - DarkRed]

Skeleton attacks you!               [Default - Gray]
  MISS!                             [CombatMiss - DarkGray]
The Skeleton's attack misses.       [Description - DarkGray]

You cast Healing Light!             [Default - Gray]
  +15 HP                            [CombatHeal - Green]

CRITICAL HIT!                       [CombatCritical - Magenta]
  ──────▶ 24 damage!                [CombatDamage - DarkRed]

You found: Legendary Sword          [LootLegendary - Yellow]
```

### Loot Rarity Colors

```
LOOT DISPLAY (Dark Theme):
──────────────────────────

You found:
  • Worn Dagger                     [LootCommon - White]
  • Steel Shortsword                [LootUncommon - Green]
  • Enchanted Blade                 [LootRare - Blue]
  • Dragonslayer                    [LootEpic - Magenta]
  • Excalibur                       [LootLegendary - Yellow]
```

---

*Document Version: 1.0*
*Last Updated: 2026-01-10*
*Author: Assistant*
